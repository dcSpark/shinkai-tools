{"type":"Deno","content":[{"name":"PDF Whitepaper Analyzer","homepage":null,"author":"@@official.shinkai","version":"1.0.0","mcp_enabled":null,"js_code":"import {\n  shinkaiLlmPromptProcessor,\n  smartSearchEngine,\n} from \"./shinkai-local-tools.ts\";\nimport * as pdfjsLib from \"npm:pdfjs-dist\";\nimport { getAssetPaths } from \"./shinkai-local-support.ts\";\n\ntype CONFIG = { analysisGuide: string };\ntype INPUTS = { pdfUrl: string };\ntype OUTPUT = { projectAndAuthors: string; analysis: string; reviews: string };\n\nexport async function run(config: CONFIG, inputs: INPUTS): Promise<OUTPUT> {\n  const { pdfUrl } = inputs;\n\n  console.log(`pdf url ${pdfUrl}`);\n\n  // Fetch the PDF file from the URL\n  const response = await fetch(pdfUrl);\n  if (!response.ok) {\n    throw new Error(`Failed to download PDF from ${pdfUrl}`);\n  }\n  const pdfData = await response.arrayBuffer();\n\n  // Convert PDF data to text\n  const pdfText = await extractTextFromPdf(pdfData);\n\n  console.log(`pdf text ${pdfText.slice(0, 30)}`);\n\n  let analysisGuide = config.analysisGuide;\n\n  if (!analysisGuide) {\n    const assets = await getAssetPaths();\n    const analysisGuideFilePath = assets.find((f) =>\n      f.match(/analysis-guide.txt$/)\n    );\n    analysisGuide = await Deno.readTextFile(analysisGuideFilePath);\n  }\n\n  console.log(`analysis guide ${analysisGuide}`);\n\n  // Analyze the text using the LLM\n  const projectAndAuthorsResult = await shinkaiLlmPromptProcessor({\n    format: \"text\",\n    prompt: `\n        Get the project name, company and authors of the following whitepaper. Be very brief\n  \n        <whitepaper-content>\n        Whitepaper content: ${pdfText}\n        </whitepaper-content>`,\n  });\n\n  console.log(`project and authors ${projectAndAuthorsResult.message}`);\n\n  // Analyze the text using the LLM\n  const analysisResult = await shinkaiLlmPromptProcessor({\n    format: \"text\",\n    prompt: `\n        Analyze the whitepaper content according to the following rules:\n\n        <analysis-guide>\n        ${analysisGuide}\n        </analysis-guide>\n        \n        <whitepaper-content>\n        Whitepaper content: ${pdfText}\n        </whitepaper-content>`,\n  });\n\n  console.log(`analysis result ${analysisResult.message}`);\n\n  // Search for reviews using Smart Search Engine\n  const reviewsResult = await smartSearchEngine({\n    question: `Reviews for ${projectAndAuthorsResult.message}`,\n  });\n\n  console.log(`reviews result ${reviewsResult}`);\n\n  return {\n    projectAndAuthors: projectAndAuthorsResult.message,\n    analysis: analysisResult.message,\n    reviews: reviewsResult.response,\n  };\n}\n\nasync function extractTextFromPdf(pdfData: ArrayBuffer): Promise<string> {\n  const loadingTask = pdfjsLib.getDocument({ data: pdfData });\n  const pdfDocument = await loadingTask.promise;\n  let fullText = \"\";\n\n  for (let pageNumber = 1; pageNumber <= pdfDocument.numPages; pageNumber++) {\n    const page = await pdfDocument.getPage(pageNumber);\n    const textContent = await page.getTextContent();\n    const pageText = textContent.items.map((item) => item.str).join(\" \");\n    fullText += pageText + \"\\n\";\n  }\n\n  return fullText;\n}\n","tools":["local:::__official_shinkai:::shinkai_llm_prompt_processor","local:::__official_shinkai:::smart_search_engine"],"config":[{"BasicConfig":{"key_name":"analysisGuide","description":"A guide for analyzing the PDF text.","required":false,"type":null,"key_value":null}}],"description":"A tool to analyze PDF documents by extracting text and processing it with language models and search engines.","keywords":["PDF","analysis","LLM","text extraction"],"input_args":{"type":"object","properties":{"pdfUrl":{"type":"string","description":"The URL of the PDF to analyze."}},"required":["pdfUrl"]},"output_arg":{"json":""},"activated":false,"embedding":[0.42375737,-0.18645777,0.14724825,-0.21015653,0.22784863,0.29003918,-0.57678616,-0.21879974,0.10944264,0.12880427,0.4733245,1.3133537,0.13136369,-0.36716202,0.5679573,-0.75806916,-0.25032815,-0.31613585,-1.7855432,0.24915332,0.26952305,0.56006986,-0.08893911,-0.049721837,0.34354258,0.24089208,-0.35112602,-0.6841923,-0.7493488,-1.3009453,0.95947397,0.24493656,-0.5892897,0.07536,-0.35289302,-0.25575542,0.62036365,0.3329478,-0.42019817,-0.63270575,0.00015013292,0.2590321,-0.52726173,0.08920063,-0.04434792,-0.6277883,0.50406325,-0.33968714,0.85962653,0.6592404,-1.0668802,-0.8318733,-0.20916818,-0.61804664,-0.086205006,-0.29176635,-0.07572802,0.023590982,0.26709053,-0.08268465,-0.23825851,-0.21699458,-3.0817695,-0.3877506,0.1059022,0.34657788,-0.02933973,-0.051486377,-0.010260357,0.5920958,-0.04325363,-0.19587104,0.04932476,-0.011173122,-0.09144734,-0.6953508,0.34441096,0.34462,0.8393513,-0.81612486,-0.3834802,0.690423,-0.09529088,0.31140807,-1.0950733,0.20191467,-0.3363079,-0.49370015,0.5272528,0.21716723,-0.6337499,-0.31011727,-0.3941562,-0.0647092,-0.27871335,0.21747108,0.04547861,0.6248123,0.15718374,2.7923238,0.6300574,0.08008355,0.27600446,-1.7191945,-0.04766249,-0.4639434,0.056217264,-0.4457572,0.43601793,0.13016474,0.37175965,-0.28736216,-0.63935184,0.19221947,-0.2727265,0.0749314,-0.86119586,0.20707059,0.13728459,0.5602233,-0.17943221,0.7684284,-0.31233165,-0.865451,-0.08373076,0.20781842,-0.009156082,0.25129554,0.4451707,-0.3511398,-0.023663796,0.31242216,-0.98472977,-0.06797423,-0.26782325,0.2996266,0.28573537,-0.79465437,0.0448322,-0.4596036,0.17926256,-1.0905737,0.6339855,0.6009332,0.86294603,0.54312855,-0.06786849,-0.19868436,0.08050875,-0.76209605,-0.0045816004,0.67428845,-0.1726023,-0.17236489,0.43654114,-0.21121447,-0.8479095,-0.21435502,-0.2030215,0.20129973,-0.18287434,-0.18875466,0.25637144,0.850514,0.014945034,-0.5153165,0.7327838,-0.47494748,0.3973681,-0.075827844,0.830197,0.35900936,0.63317865,0.73856145,-0.164969,-0.36912024,0.032725632,-0.0123060495,0.09190877,-1.3089765,0.68946314,0.8113196,-0.29581147,-0.81602514,0.192291,0.5896828,0.42641285,-0.4115461,0.4835912,1.0596296,-0.4650938,1.8142253,-0.61881727,-0.1788819,-0.02773535,-0.2110355,0.13162556,0.58560276,0.05119736,-0.13736804,-0.013674624,-0.591712,-0.504009,0.28546262,0.23612893,0.4463737,-0.14216605,-0.19515458,0.2097601,-0.524024,0.04879974,-0.4292806,0.4742134,0.34923014,0.5837507,0.57404333,-0.085578546,0.37784478,-0.10392004,0.22074956,0.20997694,-0.5529129,-0.47950107,-0.42001256,-1.1538466,0.72477514,-0.049236458,0.57166344,-0.61849254,0.17486534,0.80978626,1.2742634,1.3213191,0.81873107,0.5206903,-0.52121705,0.1602664,0.5901084,-0.11245852,-0.35813248,0.87437737,-0.44804367,-0.53864473,0.40912312,-0.11255136,-0.25173706,-0.1384977,0.49726176,0.49662417,1.5866754,0.35765165,-0.33934537,0.16439159,0.9960882,0.62658215,-0.3199617,-1.9716216,0.012725892,-0.65828675,-0.21630251,0.16336828,0.15586522,0.86616296,0.73621297,0.062480927,-0.36474335,-1.0040486,-0.5789988,0.14053014,0.44949386,-0.5117867,0.24645966,0.3847617,-0.27842736,-0.13939384,0.18735188,0.25232494,0.36086902,-0.8962752,-0.71759385,-0.45837438,0.11429602,0.46854562,-0.09037717,-0.53611803,0.60022295,0.18064189,-0.2903148,-0.23950043,0.73154277,-0.551445,-0.6742419,-0.5990051,0.5508864,1.8638152,0.16978586,0.41551408,0.5094377,0.28641114,-0.35719442,-0.18056461,0.034041777,-0.3813551,0.14268245,0.00045461953,-0.65907854,0.60789627,-0.2877113,-0.76052535,0.035148088,-1.7919188,0.52198714,1.1645927,0.15588579,0.68458134,-0.53833884,0.65221703,0.2937163,0.22612627,-2.5049052,-0.37190446,0.61856514,0.73468894,-0.71865666,-0.04704818,0.4281823,0.20521161,-0.20831192,-0.2038942,1.1103925,-0.41726774,-0.4606145,-0.1467527,-0.33671612,0.34271652,0.32419473,0.016101616,-0.46437362,-0.5918701,-0.30106375,0.47975597,1.0111042,0.3407232,0.10148811,0.31490114,0.26794305,-0.4284218,-1.0192485,0.3666651,0.16379417,-0.5775557,0.9204585,0.37709492,-0.48036522,0.7807327,-0.13814995,0.20858473,-0.075942114,-0.17950103,2.2901006,-0.027012475,-0.24532464,-0.49778655,-0.17343292,-0.17954138,0.2291627,0.7177601,-0.7676049,-0.41627026,0.15327428,0.40075746,-0.07538534,0.7980149,0.051851057,0.7105674,0.17425692,-0.23426366,0.38491067,0.09354155,0.081872806,0.33148158,-0.3559881,-0.80922246,0.44244438],"result":{"type":"object","properties":{"analysis":{"description":"The analysis of the PDF content based on the guide.","type":"string"},"projectAndAuthors":{"description":"The project name, company, and authors extracted from the PDF.","type":"string"},"reviews":{"description":"Reviews related to the project and authors.","type":"string"}},"required":["projectAndAuthors","analysis","reviews"]},"sql_tables":[],"sql_queries":[],"file_inbox":null,"oauth":[],"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}