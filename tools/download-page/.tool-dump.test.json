{"type":"Deno","content":[{"name":"Download Pages","homepage":null,"author":"@@official.shinkai","version":"1.0.0","mcp_enabled":null,"js_code":"\nimport chromePaths from 'npm:chrome-paths@1.0.1';\nimport TurndownService from 'npm:turndown@7.2.0';\nimport { addExtra } from 'npm:puppeteer-extra@3.3.6';\nimport rebrowserPuppeteer from 'npm:rebrowser-puppeteer@23.10.1';\nimport StealthPlugin from 'npm:puppeteer-extra-plugin-stealth@2.11.2';\n\nimport { getHomePath } from './shinkai-local-support.ts';\n\ntype Configurations = {\n  chromePath?: string;\n};\n\ntype Parameters = {\n  url: string;\n  incognito?: boolean;\n};\n\ntype Result = { markdown: string };\n\nexport type Run<C extends Record<string, any>, I extends Record<string, any>, R extends Record<string, any>> = (config: C, inputs: I) => Promise<R>;\n\nconst puppeteer = addExtra(rebrowserPuppeteer as any);\nconst pluginStealth = StealthPlugin();\npluginStealth.enabledEvasions.delete('chrome.loadTimes');\npluginStealth.enabledEvasions.delete('chrome.runtime');\npuppeteer.use(pluginStealth);\n\nexport const run: Run<Configurations, Parameters, Result> = async (\n  configurations: Configurations,\n  parameters: Parameters,\n): Promise<Result> => {\n  const chromePath =\n    configurations?.chromePath ||\n    Deno.env.get('CHROME_PATH') ||\n    chromePaths.chrome ||\n    chromePaths.chromium;\n  if (!chromePath) {\n    throw new Error('Chrome path not found');\n  }\n  console.log({ chromePath })\n  const browser = await puppeteer.launch({\n    executablePath: chromePath,\n    args: ['--disable-blink-features=AutomationControlled'],\n  });\n\n  const page = await browser.newPage();\n  \n  console.log(\"Navigating to website...\");\n  await page.goto(parameters.url);\n  \n  console.log('Waiting for the page to load...');\n  await page.waitForNetworkIdle();\n  \n  console.log('Extracting HTML content...');\n  const html = await page.content();\n\n  console.log('Closing browser...');\n  await browser.close();\n\n  console.log('Saving HTML to file...');\n  const safeFileName = parameters.url.replace(/\\./g, '_').replace(/[^a-zA-Z0-9_-]/g, '');\n  const safeDate = new Date().toISOString().replace(/[:.]/g, '-');\n  Deno.writeTextFileSync(await getHomePath() + `/raw.${safeFileName}.${safeDate}.html`, html);\n\n  console.log('Converting HTML to Markdown...');\n  const turndownService = new TurndownService();\n  const markdown = turndownService\n    .remove(['script', 'style', 'title'])\n    .turndown(html);\n  return Promise.resolve({ markdown });\n};\n","tools":[],"config":[{"BasicConfig":{"key_name":"chromePath","description":"The path to the Chrome executable","required":false,"type":null,"key_value":null}}],"description":"Downloads a URL and converts its HTML content to Markdown","keywords":["HTML to Markdown","web page downloader","content conversion","URL to Markdown"],"input_args":{"type":"object","properties":{"url":{"type":"string","description":"A URL of a web page to download"}},"required":["url"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.022946829,0.34381884,-0.26844275,-0.27371684,-0.63786596,-0.077388965,-1.0741701,0.15612188,0.3712316,0.019210929,0.20699088,0.27346998,-0.0068287784,0.5289115,0.64143103,-0.33675304,0.049980827,-0.9366757,-1.4171226,-0.11439512,-0.23222074,1.0892045,0.21176681,0.558589,0.12249744,-0.06504961,0.14889742,-0.5123954,-0.9607804,-2.0346377,0.7374732,0.45415962,-0.08879958,-0.7438626,0.4841356,-0.5847591,0.05952605,-0.5028562,-0.18208043,-0.32283583,0.09395297,-0.6391643,-0.13306043,-0.3551469,0.26407665,0.25499135,0.011918714,-0.10362013,0.7161349,0.2803571,-0.34595007,-0.70875204,-0.32803735,-0.16871314,-0.38074058,-0.05410556,-0.40573466,0.08279312,0.10304983,0.11238555,-0.22170037,0.31628847,-4.125783,0.270582,0.5812584,0.39317906,-0.090235315,-0.13729244,-0.23152556,0.06304251,0.22836584,-0.21436404,-0.16337165,-0.2835358,-0.073743045,-0.78332347,0.62603647,-0.18972105,-0.07183124,-0.81091934,0.026310656,0.8740335,0.061695836,0.58595204,-0.5559431,0.34131712,0.046688497,-0.4119326,0.31359228,-0.012398639,0.36861542,-0.90574026,-0.079670876,0.59806794,-0.4545676,0.041984703,-0.10476503,0.24574724,0.11746684,3.1754003,0.8004565,-0.02362926,0.79567945,-0.7409715,-0.0015231222,-0.31116694,-0.03905439,0.100143574,0.5764713,0.1580261,0.6539495,-0.540072,-0.02009131,0.018231444,0.35732335,-0.64377284,-0.84614956,-0.22347859,0.7505755,0.8297397,-0.49696812,0.5932014,-0.009048907,-0.20882955,0.19743799,0.16070975,-0.15498245,0.3443059,0.18223697,0.038467675,0.4846679,-0.36107266,-0.5905132,0.32662883,0.7022205,0.23815143,0.1493884,-0.784935,0.34118685,-0.7625433,0.20190193,-1.0105621,0.11652627,0.55782676,0.34350356,0.52308226,0.085021615,0.6408286,-0.4686932,-0.3003796,0.12343067,0.44904214,-0.48348582,-0.4255155,0.7493981,-0.068703175,-0.40754765,-0.24525023,-0.16917104,0.5213759,-0.45208377,-0.60273373,0.27832678,0.70409,0.1879408,-0.3494008,0.04679133,0.2279287,0.6455559,0.4515498,0.47489107,-0.23555446,-0.09194834,-0.37621564,0.19022991,-0.01326004,-0.27138466,-0.5616965,-0.069588155,-0.6528013,0.39446348,0.48985216,-0.58242905,-0.45990384,-0.0021556467,0.2877324,0.3323442,0.29181805,0.84042484,0.7593725,-0.28627172,1.5633782,-1.0325398,-0.4383052,-0.39912716,-0.1411121,0.17643593,0.6572122,0.34548995,0.090402566,0.023084648,-0.3968925,0.40664846,-0.13829176,-0.35579103,-0.02137369,0.45453966,0.026286887,0.1807084,-0.4468818,0.2768875,-0.7330557,1.1665187,0.29305723,0.4087359,-0.35211176,-0.25454146,0.4094335,0.24552906,0.51213753,0.109222576,0.28174528,-0.19503474,-0.4798454,-0.4018009,0.26752314,0.14516628,0.028452508,-0.5201542,-0.12782407,0.6917724,0.45508537,0.034498267,1.0407476,1.0184871,0.19386175,-0.26991785,0.83740044,0.2021083,-0.63280255,0.19426501,-0.16443643,-0.13586605,-0.2541504,-0.23962355,-1.1849339,-0.13075744,0.3317999,0.464216,1.7477694,0.7732576,0.50684917,0.6597192,0.048807405,0.275646,0.06420753,-2.2019653,-0.26727983,-0.23604417,1.2128738,-0.1723581,0.44226468,0.12744176,0.022325318,-0.27233982,-0.37659532,-0.43479314,-1.0615114,-0.35049418,0.31623024,-0.3561879,0.45113283,0.30079025,-0.043216214,0.0189383,0.5011257,0.62644756,-0.31872714,-0.7229205,-0.66905355,0.3286179,-0.17081146,0.51189375,0.00035933405,-0.11079882,-0.35901827,0.13391446,0.4440757,-0.06833183,0.27587682,0.05118815,-0.49455154,-0.063031435,0.890435,1.6144503,-0.18539041,-0.059640083,-0.35622042,-0.58149016,-0.21123032,-0.23915797,0.3232164,-0.1386219,-0.22850609,-0.93266356,-0.2988434,0.4721129,-0.49585438,-0.15201718,0.017822694,-0.3236276,-0.07768361,0.09430583,-0.2440862,0.60910565,-0.5914928,-0.25932926,0.04718837,-0.2053824,-1.7100704,-0.5064798,0.0048392448,0.1384448,-0.19248742,-0.68149966,0.9359569,-0.18324956,-0.1639604,-0.21525855,1.584038,0.6231641,-0.6041917,-0.65245986,0.42160633,0.6597297,-0.17010805,-0.07763846,-0.46514735,-0.671803,0.03413592,0.91783994,1.7945828,0.045251474,0.01465896,0.19732703,0.24998116,-0.85081595,-1.5588313,-0.1637356,-0.26551872,-0.16853385,0.29292727,-0.6097475,-0.13227093,0.5266274,0.6968675,-0.31066948,-0.06724076,-0.79396677,2.2658772,0.15179229,0.057424508,-0.032428704,-0.1228091,-0.060772292,0.18688609,0.7259608,-0.540104,-0.56575376,-0.29296643,0.26694325,-0.19538909,0.35717276,0.41084152,0.62253696,0.33918393,0.23005287,0.5998906,0.20575108,0.5416323,0.43301636,0.21810022,-0.47689104,0.1965549],"result":{"type":"object","properties":{"markdown":{"description":"The Markdown content converted from the web page","type":"string"}},"required":["markdown"]},"sql_tables":null,"sql_queries":null,"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}