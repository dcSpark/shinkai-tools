{"type":"Python","content":[{"version":"1.0.0","name":"macos-finder","homepage":null,"author":"@@official.shinkai","mcp_enabled":null,"py_code":"# /// script\n# dependencies = [\n#   \"requests\",\n# ]\n# ///\n\nfrom typing import Dict, Any, Optional, List\nimport subprocess\nimport os\nfrom dataclasses import dataclass\n\n@dataclass\nclass CONFIG:\n    pass\n\n@dataclass\nclass INPUTS:\n    command: str\n    query: Optional[str] = None  # For searchFiles\n    location: Optional[str] = None  # For searchFiles\n    file_path: Optional[str] = None  # For quickLookFile\n\n@dataclass\nclass OUTPUT:\n    result: str = \"\"\n\nasync def run_applescript(script: str) -> str:\n    \"\"\"Helper function to run AppleScript and return its output.\"\"\"\n    try:\n        result = subprocess.run(['osascript', '-e', script], \n                              capture_output=True, \n                              text=True, \n                              check=True)\n        return result.stdout.strip()\n    except subprocess.CalledProcessError as e:\n        return f\"Error: {e.stderr.strip()}\"\n\nasync def run(config: CONFIG, inputs: INPUTS) -> OUTPUT:\n    output = OUTPUT()\n    script = \"\"\n\n    # Validate inputs first\n    if inputs.command == \"quickLookFile\":\n        if not inputs.file_path:\n            raise ValueError('Missing \"file_path\" for quickLookFile')\n    elif inputs.command == \"searchFiles\":\n        if not inputs.query:\n            raise ValueError('Missing \"query\" for searchFiles')\n\n    if inputs.command == \"getSelectedFiles\":\n        script = \"\"\"\n            tell application \"Finder\"\n                try\n                    set selectedItems to selection\n                    if selectedItems is {} then\n                        return \"No items selected\"\n                    end if\n                    set itemPaths to \"\"\n                    repeat with theItem in selectedItems\n                        set itemPaths to itemPaths & (POSIX path of (theItem as alias)) & linefeed\n                    end repeat\n                    return itemPaths\n                on error errMsg\n                    return \"Failed to get selected files: \" & errMsg\n                end try\n            end tell\n        \"\"\"\n\n    elif inputs.command == \"searchFiles\":\n        search_location = inputs.location or \"~\"\n        # Expand the path before passing it to AppleScript\n        expanded_path = os.path.expanduser(search_location)\n        script = f\"\"\"\n            tell application \"Finder\"\n                try\n                    set searchPath to POSIX file \"{expanded_path}\"\n                    set theFiles to every file of (searchPath as alias) whose name contains \"{inputs.query}\"\n                    set resultList to \"\"\n                    repeat with aFile in theFiles\n                        set resultList to resultList & (POSIX path of (aFile as alias)) & return\n                    end repeat\n                    if resultList is \"\" then\n                        return \"No files found matching '{inputs.query}' in '{search_location}'\"\n                    end if\n                    return resultList\n                on error errMsg\n                    return \"Failed to search files: \" & errMsg\n                end try\n            end tell\n        \"\"\"\n\n    elif inputs.command == \"quickLookFile\":\n        # We can safely use file_path here since we validated it above\n        abs_path = os.path.abspath(os.path.expanduser(inputs.file_path))\n        script = f\"\"\"\n            tell application \"Finder\"\n                try\n                    set targetFile to (POSIX file \"{abs_path}\") as alias\n                    select targetFile\n                    activate\n                    tell application \"System Events\"\n                        keystroke space\n                    end tell\n                    return \"Quick Look preview opened for {inputs.file_path}\"\n                on error errMsg\n                    return \"Failed to open Quick Look: \" & errMsg\n                end try\n            end tell\n        \"\"\"\n\n    else:\n        raise ValueError(f\"Unknown command: {inputs.command}\")\n\n    output.result = await run_applescript(script)\n    return output ","tools":[],"config":[],"description":"Manage files in Finder via AppleScript","keywords":["macos","finder","files","automation","applescript"],"input_args":{"type":"object","properties":{"query":{"type":"string","description":"Search term for searchFiles"},"command":{"type":"string","description":"Command to execute: getSelectedFiles to list selected items, searchFiles to find files, quickLookFile to preview"},"file_path":{"type":"string","description":"Path for quickLookFile"},"location":{"type":"string","description":"Search location (default = ~) for searchFiles"}},"required":["command"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.25752363,-0.4046635,0.34747702,-0.37816808,0.6030868,-0.23188394,-0.26365978,-0.0234458,0.1977046,0.056408975,-0.16395937,0.27194893,-0.43879816,0.086076364,0.2758165,-0.58879846,-0.5312454,-0.4374338,-0.332236,-0.0764587,0.16449396,1.066603,-0.13843486,0.15328749,0.24373835,0.31511557,-0.6758774,-0.30048698,-1.4349937,-2.0558062,-0.17455295,0.8446351,0.12730195,0.22001868,0.121361434,-0.16435802,-0.28050622,0.16530088,-0.5822668,-0.48112613,0.2189273,0.3708687,0.3161458,-0.24895713,0.29656202,-0.70289445,0.9155945,-0.3404527,0.9345054,0.76970005,-0.8346257,-0.59332424,0.5878615,-0.4219225,-0.18021399,0.30282813,0.045629855,0.042770732,0.026634874,-0.20495643,-0.47052255,-0.054853484,-3.727979,-0.6407495,0.53425,0.3869049,0.4795311,0.072590575,0.4175218,0.4407552,-0.16427633,0.21140502,-0.089918196,0.44565803,0.044359207,-1.0452434,-0.4588731,0.1134563,0.6250712,-0.61285627,-0.1362578,0.55195117,-0.58082473,0.39817518,-1.149353,0.009097666,-0.678198,-0.58479863,0.052022483,-0.04278612,-0.33755863,0.36782956,0.20548208,0.23258862,0.1773282,0.3607344,-0.27370152,0.24539745,-0.40960878,2.926035,0.8226562,0.18553528,0.5499705,-0.64052767,-0.4106645,-0.50752985,-0.1310361,0.38430503,-0.33494955,0.08892413,-0.20995629,0.28340462,0.0057853013,0.25480676,0.2414211,0.11277537,0.16676548,0.20124988,0.012703833,0.5021938,-0.54309034,0.3170906,-0.90722954,-0.16549078,-1.3165927,-0.43613362,-0.5632224,0.35137767,0.61925346,-0.686401,0.6148266,-0.31909105,-0.80329525,-0.0812657,0.3456455,0.036458347,-0.2574154,-0.42292067,-0.4915526,-0.21142918,-0.20159629,-1.4993306,0.76363087,0.39776242,-0.2582968,0.23044254,0.6918963,-0.24480924,-0.35271955,-0.6044658,-0.8153843,0.34436172,-0.09627784,0.14006278,0.5424345,-0.13297066,-0.9302183,-0.08888352,0.025287606,0.52481973,-0.31118324,-0.190635,0.93856245,0.73771805,0.32559988,-0.6380252,0.37728304,-0.45730233,0.8181686,-0.019784959,0.32772928,-0.47499517,0.36737582,0.6118965,-0.49916285,0.75877875,-0.92401206,-0.3033407,-0.12058319,-0.53555495,0.54669285,0.31488878,-0.07564389,-0.44189882,-0.20335127,0.32894012,0.80412596,0.13519725,0.3937001,0.75469553,-0.29263848,2.0734177,-0.90280885,-0.13778386,0.114459455,0.35219294,0.11621073,0.9896794,-0.067079484,0.13711491,-0.4245097,-0.1922263,0.0953913,0.41992027,0.2081531,-0.12911421,0.8086786,0.22236322,-0.43003708,-0.28699726,0.10196978,0.12802526,0.47470012,0.3995201,-0.1074588,0.6239502,-0.07771675,-0.09872764,0.28875735,0.7477472,0.13971122,0.1528821,-0.99291104,-0.32929486,0.06979291,-0.7330453,0.7628893,-0.43698227,-0.06306963,-0.18481083,0.095765896,0.5497028,0.62818664,-0.016928285,0.5165967,-0.33614862,-0.15555552,0.20592532,-0.07072796,-1.0397495,0.40752617,-0.06314005,-0.24818054,-0.4929409,-0.11078793,-0.28488138,-0.098243155,-0.19688386,0.32917017,1.4239087,0.49236906,1.1343617,-0.4482686,0.51419437,-0.63322985,0.13211249,-1.2030838,0.19051667,-0.045046274,-0.3055924,0.4318598,-0.31139904,0.37739602,0.54794157,-0.6053437,-0.056772623,-0.059654146,-0.18698543,0.51710576,0.20602074,-0.49746016,0.8263294,-0.06763865,-0.10342272,-0.4687598,0.083573096,-0.11941414,-0.35243773,-0.45230672,-0.44015545,-0.4410051,-0.11477498,0.5812389,-0.17565747,-0.37053448,-0.47597036,-0.1699664,-0.16993198,-0.30967772,-0.41726527,-0.55979156,-1.0387943,0.25750002,0.54505527,2.4724767,0.13813631,0.083955236,0.83419883,0.2188626,-0.39736032,0.2424925,-0.3843171,-0.18949647,-0.35165462,-0.88203514,0.15038541,0.78093106,-0.2931209,-0.33363357,1.0743815,-0.309638,0.8545035,0.66806465,-0.33406767,1.23661,-0.36796215,0.48951256,0.56397855,-0.18237199,-1.6161402,-0.24543034,-0.4699193,0.26114517,-0.4103408,0.08837629,0.6951798,0.39117497,0.22769168,-0.07882688,0.96938026,0.95178336,-0.26455948,-0.5369335,-0.52131915,0.8587334,0.52392036,0.41575864,0.56134886,-0.49449474,0.15594353,0.8912561,1.957726,-0.3383509,0.017618513,0.6011402,-0.29715866,-0.75879055,-1.5036004,0.1239153,-0.2317982,-0.47775802,0.6951067,0.43506736,-0.599131,0.59798425,1.0394067,-0.6504647,0.21168816,-0.71717113,1.5544761,-0.19733879,0.058509134,-0.487807,-0.07586911,0.5182724,-0.11744103,0.68951225,-0.5410746,-0.34126347,0.1253524,-0.088585556,-0.54248977,0.4422634,0.5643187,0.15918635,1.2776746,-0.44541988,0.55850494,0.04230556,-0.10267139,0.654575,0.09469363,-0.4018825,-0.36215222],"result":{"type":"object","properties":{"result":{"description":"Output text from AppleScript","type":"string"}},"required":["result"]},"sql_tables":null,"sql_queries":null,"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}