{"type":"Deno","content":[{"name":"PDF Whitepaper Analyzer","homepage":null,"author":"@@official.shinkai","version":"1.0.0","js_code":"import {\n  shinkaiLlmPromptProcessor,\n  smartSearchEngine,\n} from \"./shinkai-local-tools.ts\";\nimport * as pdfjsLib from \"npm:pdfjs-dist\";\nimport { getAssetPaths } from \"./shinkai-local-support.ts\";\n\ntype CONFIG = { analysisGuide: string };\ntype INPUTS = { pdfUrl: string };\ntype OUTPUT = { projectAndAuthors: string; analysis: string; reviews: string };\n\nexport async function run(config: CONFIG, inputs: INPUTS): Promise<OUTPUT> {\n  const { pdfUrl } = inputs;\n\n  console.log(`pdf url ${pdfUrl}`);\n\n  // Fetch the PDF file from the URL\n  const response = await fetch(pdfUrl);\n  if (!response.ok) {\n    throw new Error(`Failed to download PDF from ${pdfUrl}`);\n  }\n  const pdfData = await response.arrayBuffer();\n\n  // Convert PDF data to text\n  const pdfText = await extractTextFromPdf(pdfData);\n\n  console.log(`pdf text ${pdfText.slice(0, 30)}`);\n\n  let analysisGuide = config.analysisGuide;\n\n  if (!analysisGuide) {\n    const assets = await getAssetPaths();\n    const analysisGuideFilePath = assets.find((f) =>\n      f.match(/analysis-guide.txt$/)\n    );\n    analysisGuide = await Deno.readTextFile(analysisGuideFilePath);\n  }\n\n  console.log(`analysis guide ${analysisGuide}`);\n\n  // Analyze the text using the LLM\n  const projectAndAuthorsResult = await shinkaiLlmPromptProcessor({\n    format: \"text\",\n    prompt: `\n        Get the project name, company and authors of the following whitepaper. Be very brief\n  \n        <whitepaper-content>\n        Whitepaper content: ${pdfText}\n        </whitepaper-content>`,\n  });\n\n  console.log(`project and authors ${projectAndAuthorsResult.message}`);\n\n  // Analyze the text using the LLM\n  const analysisResult = await shinkaiLlmPromptProcessor({\n    format: \"text\",\n    prompt: `\n        Analyze the whitepaper content according to the following rules:\n\n        <analysis-guide>\n        ${analysisGuide}\n        </analysis-guide>\n        \n        <whitepaper-content>\n        Whitepaper content: ${pdfText}\n        </whitepaper-content>`,\n  });\n\n  console.log(`analysis result ${analysisResult.message}`);\n\n  // Search for reviews using Smart Search Engine\n  const reviewsResult = await smartSearchEngine({\n    question: `Reviews for ${projectAndAuthorsResult.message}`,\n  });\n\n  console.log(`reviews result ${reviewsResult}`);\n\n  return {\n    projectAndAuthors: projectAndAuthorsResult.message,\n    analysis: analysisResult.message,\n    reviews: reviewsResult.response,\n  };\n}\n\nasync function extractTextFromPdf(pdfData: ArrayBuffer): Promise<string> {\n  const loadingTask = pdfjsLib.getDocument({ data: pdfData });\n  const pdfDocument = await loadingTask.promise;\n  let fullText = \"\";\n\n  for (let pageNumber = 1; pageNumber <= pdfDocument.numPages; pageNumber++) {\n    const page = await pdfDocument.getPage(pageNumber);\n    const textContent = await page.getTextContent();\n    const pageText = textContent.items.map((item) => item.str).join(\" \");\n    fullText += pageText + \"\\n\";\n  }\n\n  return fullText;\n}\n","tools":["local:::__official_shinkai:::shinkai_llm_prompt_processor","local:::__official_shinkai:::smart_search_engine"],"config":[{"BasicConfig":{"key_name":"analysisGuide","description":"A guide for analyzing the PDF text.","required":false,"type":null,"key_value":null}}],"description":"A tool to analyze PDF documents by extracting text and processing it with language models and search engines.","keywords":["PDF","analysis","LLM","text extraction"],"input_args":{"type":"object","properties":{"pdfUrl":{"type":"string","description":"The URL of the PDF to analyze."}},"required":["pdfUrl"]},"output_arg":{"json":""},"activated":false,"embedding":[0.423801,-0.18661551,0.14740321,-0.21021657,0.2278818,0.28988475,-0.5767361,-0.21860981,0.109322,0.12868044,0.47303757,1.313076,0.13153777,-0.36706194,0.56782466,-0.7581509,-0.25041258,-0.31603357,-1.7853222,0.2492243,0.2694835,0.5600167,-0.08883495,-0.049936995,0.34359953,0.24093749,-0.35112393,-0.68394846,-0.7492186,-1.3010757,0.95929813,0.24476412,-0.58917207,0.075369984,-0.35283852,-0.2555589,0.62021214,0.33296323,-0.4202263,-0.63267183,0.000099236146,0.25902525,-0.5275457,0.08927413,-0.044439066,-0.62775064,0.50406915,-0.33963057,0.859649,0.6590482,-1.0668613,-0.8318907,-0.20911285,-0.61807513,-0.086136535,-0.29180205,-0.07561545,0.02365366,0.26683575,-0.08259273,-0.23851821,-0.21702337,-3.0817094,-0.3874015,0.10594146,0.3465618,-0.029480089,-0.051645692,-0.010131778,0.5918666,-0.043313637,-0.19580863,0.04939098,-0.011303268,-0.09142475,-0.69524276,0.34452948,0.34466004,0.83948207,-0.8162254,-0.38352877,0.6903696,-0.09521622,0.31146595,-1.094966,0.20196973,-0.33626658,-0.49363735,0.5273453,0.2171903,-0.63370913,-0.31022105,-0.3941659,-0.06499996,-0.2786642,0.21727021,0.045667518,0.6248698,0.15733406,2.792425,0.6301035,0.08007787,0.27595815,-1.7194163,-0.047613107,-0.46405682,0.05620605,-0.4460201,0.43595257,0.12987407,0.37177145,-0.28716576,-0.6394141,0.19208035,-0.27262115,0.07505621,-0.8613373,0.20704614,0.13719912,0.5603191,-0.17948009,0.7685074,-0.31248397,-0.8654645,-0.08383871,0.20769623,-0.0090949945,0.2512917,0.445126,-0.3512571,-0.023572527,0.31242687,-0.9847715,-0.06780011,-0.2677668,0.29966518,0.2856505,-0.7946645,0.044808395,-0.45959628,0.17919566,-1.0906861,0.6340593,0.6007818,0.863003,0.5429886,-0.06800261,-0.19870651,0.080376014,-0.7620275,-0.0042867884,0.6745558,-0.17252941,-0.1723623,0.43647486,-0.21111995,-0.8479472,-0.21439767,-0.20320551,0.20114255,-0.18280613,-0.18839835,0.25635353,0.8504807,0.0150042735,-0.51529294,0.73277676,-0.47498158,0.39714795,-0.07564016,0.8301492,0.35916013,0.63306344,0.7385807,-0.16462137,-0.3691845,0.032864794,-0.012212515,0.091847286,-1.308934,0.68939096,0.8114922,-0.29564184,-0.8161719,0.19247653,0.58967364,0.4265096,-0.41143748,0.48370355,1.0594572,-0.46510467,1.8141197,-0.61873496,-0.17882644,-0.027515868,-0.21109244,0.13165145,0.5855315,0.051036257,-0.13736159,-0.01353436,-0.59186155,-0.5038435,0.28547877,0.23611003,0.44645697,-0.14217097,-0.19551809,0.20959555,-0.5239158,0.04895185,-0.42941114,0.47424668,0.3490289,0.58387184,0.5742148,-0.08558759,0.37780565,-0.10374281,0.22071931,0.2099933,-0.5528973,-0.47962803,-0.42011556,-1.1539658,0.7248661,-0.049257856,0.5715247,-0.6184034,0.17467473,0.80966955,1.2742238,1.3213712,0.8188781,0.5204153,-0.5211242,0.16042206,0.59029627,-0.11247,-0.35830078,0.8744217,-0.44799873,-0.5385826,0.40918392,-0.11247939,-0.25163686,-0.13864158,0.49717063,0.4967139,1.586834,0.35764632,-0.33911622,0.16447768,0.9958485,0.6266255,-0.31995282,-1.9713733,0.01292535,-0.65813947,-0.21632215,0.16340303,0.15583912,0.86624587,0.7362063,0.062435333,-0.36476678,-1.0041244,-0.5792632,0.14043859,0.44960043,-0.51179194,0.24634427,0.3848244,-0.27847302,-0.13927141,0.18724105,0.25224146,0.3607922,-0.89649963,-0.71734756,-0.45854676,0.114145294,0.46868375,-0.09050551,-0.53591275,0.6001377,0.18057255,-0.29024947,-0.23951545,0.7314774,-0.5513221,-0.6741692,-0.5990145,0.55093145,1.8638138,0.16945218,0.41566065,0.50961834,0.28646687,-0.35741496,-0.18059477,0.03376765,-0.3810205,0.14249843,0.00034691393,-0.65900254,0.6077259,-0.2875925,-0.7607901,0.035151318,-1.7917153,0.5219402,1.164646,0.15583147,0.6847468,-0.5383456,0.65216804,0.29364157,0.22634937,-2.5049176,-0.3717611,0.6184735,0.734782,-0.7185792,-0.047098216,0.428109,0.20516175,-0.20852953,-0.20402047,1.110489,-0.41724426,-0.46064445,-0.14657271,-0.33685136,0.34284657,0.32416087,0.016230216,-0.46435413,-0.59177846,-0.3010303,0.47956303,1.011297,0.34073123,0.10133377,0.3148754,0.26785016,-0.42839426,-1.0192035,0.3667863,0.16388375,-0.57759154,0.9200919,0.37698573,-0.48049492,0.7809755,-0.13812333,0.20862332,-0.075822785,-0.1794264,2.2901664,-0.026986262,-0.24533013,-0.4977291,-0.17354402,-0.17954573,0.22924568,0.7177709,-0.76750237,-0.41624683,0.15332016,0.40053388,-0.07546927,0.79797614,0.051635575,0.71071714,0.17427203,-0.2339786,0.385182,0.09358862,0.0818937,0.33147013,-0.35623392,-0.8089209,0.44256473],"result":{"type":"object","properties":{"analysis":{"description":"The analysis of the PDF content based on the guide.","type":"string"},"projectAndAuthors":{"description":"The project name, company, and authors extracted from the PDF.","type":"string"},"reviews":{"description":"Reviews related to the project and authors.","type":"string"}},"required":["projectAndAuthors","analysis","reviews"]},"sql_tables":[],"sql_queries":[],"file_inbox":null,"oauth":[],"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}