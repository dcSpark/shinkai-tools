{"type":"Python","content":[{"version":"1.0.0","name":"macos-iterm","homepage":null,"author":"@@official.shinkai","py_code":"# /// script\n# dependencies = [\n#   \"requests\",\n# ]\n# ///\n\nfrom typing import Dict, Any, Optional, List\nimport subprocess\n\nclass CONFIG:\n    pass\n\nclass INPUTS:\n    command: str\n    cmd: Optional[str] = None  # for runCommand\n    new_window: Optional[bool] = False  # for runCommand\n\nclass OUTPUT:\n    result: str\n\nasync def run_applescript(script: str) -> str:\n    \"\"\"Helper function to run AppleScript and return its output.\"\"\"\n    try:\n        result = subprocess.run(['osascript', '-e', script], \n                              capture_output=True, \n                              text=True, \n                              check=True)\n        return result.stdout.strip()\n    except subprocess.CalledProcessError as e:\n        return f\"Error: {e.stderr.strip()}\"\n\nasync def ensure_iterm_window() -> str:\n    \"\"\"Ensures iTerm is running and has at least one window open.\"\"\"\n    script = \"\"\"\n        tell application \"iTerm2\"\n            activate\n            if windows count = 0 then\n                create window with default profile\n            end if\n            return \"Window ready\"\n        end tell\n    \"\"\"\n    return await run_applescript(script)\n\nasync def run(config: CONFIG, inputs: INPUTS) -> OUTPUT:\n    output = OUTPUT()\n    \n    # First ensure iTerm is running with a window\n    await ensure_iterm_window()\n    \n    script = \"\"\n\n    if inputs.command == \"pasteClipboard\":\n        script = \"\"\"\n            tell application \"iTerm2\"\n                tell current window\n                    tell current session\n                        write contents of the clipboard\n                    end tell\n                end tell\n            end tell\n            return \"Pasted clipboard to iTerm\"\n        \"\"\"\n\n    elif inputs.command == \"runCommand\":\n        if not inputs.cmd:\n            raise ValueError('Missing \"cmd\" for runCommand')\n            \n        # Escape double quotes in the command\n        escaped_cmd = inputs.cmd.replace('\"', '\\\\\"')\n        \n        if inputs.new_window:\n            script = f'''\n                tell application \"iTerm2\"\n                    create window with default profile\n                    tell current window\n                        tell current session\n                            write text \"{escaped_cmd}\"\n                        end tell\n                    end tell\n                    return \"Ran '{escaped_cmd}' in new iTerm window\"\n                end tell\n            '''\n        else:\n            script = f'''\n                tell application \"iTerm2\"\n                    tell current window\n                        tell current session\n                            write text \"{escaped_cmd}\"\n                        end tell\n                    end tell\n                    return \"Ran '{escaped_cmd}' in existing iTerm window\"\n                end tell\n            '''\n\n    else:\n        raise ValueError(f\"Unknown command: {inputs.command}\")\n\n    output.result = await run_applescript(script)\n    return output ","tools":[],"config":[],"description":"Control iTerm via AppleScript","keywords":["macos","iterm","terminal","automation","applescript"],"input_args":{"type":"object","properties":{"cmd":{"type":"string","description":"Command to run if using runCommand"},"command":{"type":"string","description":"Command to execute: pasteClipboard to paste clipboard content, runCommand to execute shell command"},"new_window":{"type":"boolean","description":"Whether to run command in a new window (default false)"}},"required":["command"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.6174755,-0.10309458,0.010183305,-0.31834206,-0.08121098,0.19517013,-0.09264413,0.04734598,0.29301354,0.30429864,-0.012572861,0.037306793,-0.40109852,0.2642547,0.0013151579,-0.70791274,-0.313662,-0.66830313,-0.70859575,-0.38552466,0.2572361,0.28641635,-0.19604886,-0.0404628,0.11432397,0.38421094,-0.19052394,0.22292067,-1.3799169,-2.1068676,-0.25813872,0.3993243,-0.03514892,0.13849594,-0.1904093,-1.1226226,-0.38102463,-0.13450454,-0.6861593,-0.647355,0.45747322,0.35654905,-0.051792856,-0.260364,0.68724,-0.09858716,0.82055575,-0.5064329,0.601179,0.5684559,-0.5474684,-0.52430147,0.17014003,-0.019049902,-0.58533406,0.31526875,0.07959847,-0.05551634,-0.09156948,-0.16857171,-0.03332394,0.35673505,-4.1163435,-0.1489222,1.1198908,-0.035632454,0.15390892,0.23636034,-0.11852927,0.072838664,0.40649733,0.30904025,-0.06998034,0.4720339,0.41449472,-0.98029286,-0.3070209,0.478896,0.58512694,-0.56922626,-0.062576905,0.7126153,-0.17032115,-0.032055683,-0.9244113,0.51239955,-0.6096387,-0.4537453,-0.04547119,0.08163945,0.08844346,-0.07285814,0.109334655,-0.21316978,0.039276455,0.5096647,-0.19740672,0.1447122,-0.10284018,3.109328,0.5850906,-0.015131518,0.17572555,-0.4436378,-0.51616794,-0.25449115,0.011239093,-0.005214827,-0.43275085,0.2728721,-0.18768878,0.467139,-0.12070134,0.09391321,0.5411091,0.16121054,0.1519401,-0.037980285,-0.04936352,0.4888931,-0.41648605,0.19727302,-0.80401313,-0.49781388,-1.1088655,-0.11403142,-0.4691572,0.31150275,0.305837,-0.38708234,0.4045537,-0.32221872,-0.32715958,0.34671634,0.51094884,0.45165837,-0.07846424,-0.5938791,0.013920974,-0.00488209,0.25761598,-1.7855788,0.89477307,0.017984655,0.4662076,0.26771885,0.6330695,-0.24875367,-0.22465557,0.08668608,-0.5709328,0.38508564,-0.39794052,-0.037522897,0.9063665,0.17758325,-0.2692448,0.21427932,-0.4035367,0.6222892,-0.008219169,-0.33759564,1.069496,0.80398124,0.2776436,-0.6656463,0.09172675,-0.3496636,0.3661678,-0.39034656,0.088766545,-0.4489012,0.24632321,0.37643343,-0.6936422,0.27188963,-0.55628705,0.13196155,0.25030014,-0.41390958,0.18951394,0.3556518,-0.9234025,-0.043805122,0.11053245,0.36798695,0.397567,0.24759284,0.054455433,0.40296456,-0.46848747,2.0453608,-0.59835476,0.03492228,-0.4247686,0.45046794,0.37628353,0.91560394,-0.2369592,0.0037251534,-0.68596685,-0.3514743,-0.3759088,0.34257093,0.32342023,-0.23859759,1.0434635,0.20557326,0.12989253,0.33369854,-0.11686689,-0.48135272,0.14448729,0.49639574,0.48684287,0.20864473,-0.26369554,-0.019567285,-0.056562297,0.6564734,0.5632012,-0.1725021,-0.86003417,-0.2882439,-0.28188026,-0.33912158,-0.06767427,-0.16208762,-0.34860298,-0.080663905,0.50671846,0.47952116,0.5085754,0.03933747,0.42298466,-0.17161417,-0.065992706,0.4263408,0.3117239,-0.41104326,0.07161869,-0.24649274,0.39141834,-0.26129794,0.42540818,-0.31021482,-0.40936893,-0.36517745,-0.3202133,1.3853469,0.20964858,0.7021725,0.27666622,0.16957258,-0.5147544,0.3988086,-1.2691921,0.1926929,-0.44863874,0.47350213,0.7383211,-0.15082371,0.4831315,0.5796599,-0.78885734,-0.16844004,0.016800163,-0.4414662,0.14244431,0.16770548,-0.8583368,1.1228079,0.21425827,-0.2771502,-0.086184025,-0.2269722,-0.06604016,-0.4067682,0.013880953,-0.81326306,-0.3841389,0.00923996,0.19185586,0.13103765,-0.07389329,-0.31770116,-0.39048794,-0.3919552,0.13909422,-0.63280547,0.06403939,-0.79131603,0.4204365,0.21849704,2.4867263,0.69769275,-0.21658237,0.69849306,0.0067717335,0.12140106,0.19902977,-0.16750559,-0.33714226,-0.27400294,-1.0052856,-0.13770725,0.8760103,-0.52045566,-0.54221034,0.6615481,-0.72376573,0.46295732,0.4700818,-0.15590191,1.8594447,0.38746962,0.22704828,0.46409577,-0.05237993,-2.0490143,-0.9042422,-0.37603226,0.1873344,-0.14486441,-0.051087897,0.70532364,0.5666112,0.37357363,-0.20944834,0.93652666,0.83086145,0.09310629,0.020360555,0.12195497,0.5679636,0.5421683,0.2800897,0.324405,-0.8445316,-0.4360096,0.7327486,1.8568959,-0.26396152,0.04444551,0.63763106,-0.17076984,-1.0801939,-1.4623474,0.12062667,-0.00891684,-0.08617131,0.773773,0.13750616,-0.38238683,0.43025035,1.0923655,-0.6615346,-0.03005803,-0.75259745,1.431675,0.156892,0.42069682,-0.6139147,0.21374904,0.25251937,-0.11718467,0.8359698,-0.6549975,-0.082368955,0.36641213,0.23211274,-0.15371099,0.39907396,0.4413237,0.365576,0.4443518,-0.5699567,0.20593901,0.1493851,-0.18153134,0.14191115,-0.33885658,-0.7665816,-0.0007169023],"result":{"type":"object","properties":{"result":{"description":"Message describing what happened","type":"string"}},"required":["result"]},"sql_tables":null,"sql_queries":null,"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}