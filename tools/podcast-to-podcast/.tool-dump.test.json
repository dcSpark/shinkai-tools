{"type":"Deno","content":[{"name":"Podcast to Podcast","homepage":null,"author":"@@official.shinkai","version":"1.0.0","js_code":"import { YoutubeTranscript } from 'npm:youtube-transcript';\nimport { getHomePath } from './shinkai-local-support.ts'\nimport { shinkaiLlmPromptProcessor, elevenLabsTextToSpeech } from './shinkai-local-tools.ts';\n\ntype CONFIG = {};\ntype INPUTS = {\n  youtubeUrlOrId: string;\n};\ntype OUTPUT = {\n    audiotext: string,\n    audioFilePath: string,\n};\n\nexport async function run(config: CONFIG, inputs: INPUTS): Promise<OUTPUT> {\n  const { youtubeUrlOrId } = inputs;\n  if (!youtubeUrlOrId) throw new Error(\"Missing input.youtubeUrlOrId\")\n  // Step 1: Fetch the transcript from YouTube\n  const transcript: {text: string, duration: number, offset: number}[] = await YoutubeTranscript.fetchTranscript(youtubeUrlOrId);\n  /*\n  [...\n  {\n    text: \"better the performance the easier it is\",\n    duration: 4.08,\n    offset: 223.92,\n    lang: \"en\"\n  },\n  {\n    text: \"for me to watch yeah if I catch myself\",\n    duration: 4.36,\n    offset: 225.2,\n    lang: \"en\"\n  },\n  ...]\n  */\n  const total_duration = transcript[transcript.length - 1].offset + transcript[transcript.length - 1].duration;\n  console.log(`Total duration: ${total_duration}`);\n  // Step 2: Flatten the transcript into a string\n  const flatten_transcript = transcript.map(segment => segment.text).join(' ');\n\n  // Step 3: Get the prompt structure and voice prompt from files\n  const homePath = await getHomePath();\n  const promptStructureFilePath = `${homePath}/podcast.analysis.md`;\n  const voicePromptFilePath = `${homePath}/podcast.story.md`;\n\n  const promptStructure = await Deno.readTextFile(promptStructureFilePath);\n  const voicePrompt = await Deno.readTextFile(voicePromptFilePath);\n\n  // Step 4: Create a transcript summary with the llm-processor\n  const summarizePrompt = `\n    Summarize a text following these guidelines and structure:\n        <guidelines>\n        ${promptStructure}\n        </guidelines>\n        This is the text to summarize, please don't hallucinate and make sure you follow the guidelines:\n        <text>\n        ${flatten_transcript}\n        </text>\n  `;\n\n  const { message: transcriptSummary } = await shinkaiLlmPromptProcessor({\n    prompt: summarizePrompt,\n    format: 'text',\n  });\n\n  // Step 5: Generate the podcast by using the llm-processor\n  const narratePrompt = `\n      Narrate a text using the following guidelines\n        <guidelines>\n        # [IMPORTANT] Your main objective in terms of length is to keep the podcast lenght in about 5 minutes and shorter than the original text.\n        ${voicePrompt}\n        </guidelines>\n        The text to narrate is the following:\n        <text>\n        ${transcriptSummary}\n        </text>\n    `;\n\n  const { message: podcast } = await shinkaiLlmPromptProcessor({\n    prompt: narratePrompt,\n    format: 'markdown',\n  });\n  \n  const audioData = await elevenLabsTextToSpeech({\n    text: podcast\n  });\n\n  return {\n    audiotext: podcast,\n    audioFilePath: audioData.audio_file,\n  };\n}","tools":["local:::__official_shinkai:::shinkai_llm_prompt_processor","local:::__official_shinkai:::eleven_labs_text_to_speech"],"config":[],"description":"Converts a YouTube video transcript into a podcast using LLM processing.","keywords":["YouTube","transcript","podcast","converter","shinkai"],"input_args":{"type":"object","properties":{"youtubeUrlOrId":{"type":"string","description":"The YouTube URL or video ID"}},"required":["youtubeUrlOrId"]},"output_arg":{"json":""},"activated":false,"embedding":[0.46618938,0.64287466,-0.39460942,-0.68833095,-0.633925,-0.038053773,-0.9691118,0.10444933,-0.21802923,0.11967294,-0.44526365,1.2321461,-0.0037087305,0.12567014,-0.29091632,0.013069354,0.08166208,-0.7721939,-1.3971748,-0.21916243,-0.11133471,0.17329547,0.15524049,0.23032627,-0.083049916,0.31464124,0.25404778,-0.4364921,-0.57237375,-1.9306434,0.72475684,0.5900172,0.42332146,-0.17464715,-0.24554706,-0.9090138,-0.593923,0.12958306,-0.36103258,0.25185215,0.17348781,0.02890112,-0.6086497,0.1574963,-0.26010203,-0.38041475,0.7616571,-0.38047844,1.3495153,0.05397944,-0.84243107,-0.30115485,-0.038829025,-0.0075116567,-0.32643124,-1.1679004,-0.13259652,0.0014736839,0.56188834,0.029170198,0.21738583,-0.09406267,-3.7389588,-0.25589463,0.46586868,-0.21320686,-0.039139315,-0.016795166,0.25152355,0.18723622,-0.4013294,-0.1854777,-0.66279846,0.34056228,-0.18817541,-0.47800004,-0.20036747,-0.32774192,0.49299318,-0.4703033,0.53931737,-0.025903061,0.20626074,-0.43222395,-0.6800598,0.7841139,-0.7214324,-0.5450764,0.120521516,0.24287435,0.017260486,-0.38861364,1.0523157,-0.09929781,-0.31958577,-0.33142966,0.21190031,-0.053631037,0.25675535,2.8638172,0.5286593,-0.011510994,0.40182832,-0.91278464,0.12548351,-0.68683004,0.46246478,-0.16253108,0.6015411,0.10530927,0.73650813,-0.23037416,0.21714889,0.21003813,0.21873008,0.67361367,-0.14614943,-0.2121757,0.016691446,0.21157996,-0.43889964,-0.11807029,-0.23317777,-0.16076568,-0.60663337,-0.25218624,-0.19453482,0.11377968,0.37887645,-0.39855626,0.40920347,-0.34786025,-0.27948156,0.22925551,0.5119221,0.048596375,0.7847168,-1.0545493,-0.043226473,-0.36568153,0.16337302,-1.6932174,0.48366553,-0.23646462,0.8809137,-0.066939175,-0.48409453,0.39024383,-0.2959111,-0.26760328,0.04944551,0.7304692,0.16666824,-0.115825795,1.1847802,-0.30466706,-0.49689883,-0.80684227,-0.66979074,0.2726157,-0.18352923,-0.10842139,0.1862054,-0.0041895956,0.38039237,-0.18913227,0.60929626,0.41226822,0.6329284,0.036096524,0.52150697,-0.1376867,0.17768402,0.5584603,-0.2124981,-0.52891135,-0.65500104,0.29028982,0.3232489,0.1126425,0.42609203,0.22422074,-0.51573414,-0.10615403,-0.5562604,0.74750656,0.21618697,0.11200308,0.78520644,0.8638811,-0.37831914,1.7871898,-1.1602719,-0.18255801,-0.30313638,0.27381128,0.19101177,0.77150863,0.38641497,0.16728549,-0.30743125,0.14790922,-0.073408455,-0.07069963,-0.34390944,-0.7346075,-0.294118,0.945307,-0.2492824,-0.35732105,0.466656,-0.04014848,0.32288238,0.5382913,0.1001863,0.27142102,0.047813304,0.18679005,-0.7102538,0.23507006,0.49604136,0.23701957,0.06218846,-0.683635,-0.04391142,0.6754131,-0.8014778,0.22475524,0.01319753,-0.1553412,0.63962567,1.1392677,-0.16047496,1.220647,0.7629658,0.36884424,0.14951116,0.39189488,0.30455992,-0.8684064,0.06074622,0.0509396,0.0024019256,-0.21200404,0.18713239,-0.6244685,-0.021490555,0.3230233,-0.3683283,1.7617736,0.20509991,0.5854257,0.5491551,0.41769353,0.29901263,0.053844374,-1.1844125,0.5057905,-0.21942326,0.2890931,-0.41169062,0.41480222,0.078387804,0.5317506,0.13593051,-0.523671,-1.138671,-0.46437657,0.14090258,-0.103696465,-0.12751749,0.24691725,-0.18800831,0.109375805,-0.2879892,0.22438528,0.35582227,-0.10133623,-0.4643866,-0.6869685,0.5957567,0.19177195,0.16639334,0.031551413,-0.5839558,0.33522213,-0.1595141,-0.2667196,-0.7327596,0.34137523,-0.3971499,-0.6551238,-0.8978485,-0.00041882694,1.9727756,0.06321761,-0.06729707,0.57428604,0.23705085,0.032135416,-0.47515216,0.17360938,0.064557746,-0.03458213,-0.740869,-0.4845976,0.6100257,-0.5646932,0.21650383,0.6629491,0.11820831,0.27276868,0.13227542,-0.2735511,0.53410774,-0.28117663,0.14582595,0.78974354,-0.2207418,-2.626886,-0.23336533,-0.39901412,-0.30336386,-0.31535894,0.27292392,0.61566603,-0.48675868,0.37856305,-0.3220306,1.3104153,0.25386354,-0.045244683,-0.14235485,0.56067544,0.80621934,0.24637097,-0.3329793,-0.60190654,-1.0608948,-0.19221419,-0.050373495,1.1459801,0.5643946,0.5596533,-0.058411546,-0.22222623,-0.37580281,-0.8951451,0.67590106,-0.21489045,-0.26415443,0.40776122,0.1399086,-0.24110901,0.4432743,0.9420772,0.162136,0.07527378,-0.08882707,1.6065369,0.25304663,-0.13589215,-0.20474148,0.44570905,-0.17580867,-0.5638516,0.23713736,-0.905015,0.48122227,-0.0325566,0.6618496,-0.32030547,0.6192063,0.15090111,0.68707234,0.724214,0.2502168,0.6663929,0.081420794,-0.13482459,-0.2487632,-0.06984337,-0.24689126,0.21940918],"result":{"type":"object","properties":{"podcast":{"description":"The generated podcast content in Buffer format","nullable":true,"type":"string"}},"required":["podcast"]},"sql_tables":[],"sql_queries":[],"file_inbox":null,"oauth":[],"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}