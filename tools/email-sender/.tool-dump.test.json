{"type":"Python","content":[{"version":"1.0.0","name":"Send Email","homepage":null,"author":"@@official.shinkai","py_code":"from typing import Any, Optional, List, Dict\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom datetime import datetime\nimport logging\n\n# Configure logging\nlogging.basicConfig(level=logging.ERROR, format='%(asctime)s - %(levelname)s - %(message)s')\n\nclass CONFIG:\n    smtp_server: str\n    port: int = 465  # Default port for SMTP\n    sender_email: str\n    sender_password: str\n    ssl: bool = True  # New flag to specify SSL usage for SMTP\n\nclass INPUTS:\n    recipient_email: str\n    subject: str\n    body: str\n\nclass OUTPUT:\n    status: str\n    message: str\n\n\nasync def run(config: CONFIG, inputs: INPUTS) -> OUTPUT:\n    output = OUTPUT()\n    output.status = \"failed\"\n    output.message = \"\"\n\n    msg = MIMEMultipart()\n    msg['From'] = config.sender_email\n    msg['To'] = inputs.recipient_email\n    msg['Subject'] = inputs.subject\n    msg['Date'] = datetime.now().strftime('%a, %d %b %Y %H:%M:%S %z')\n\n    msg.attach(MIMEText(inputs.body, 'plain'))\n\n    try:\n        # Use SSL if the ssl flag is set to True\n        if config.ssl:\n            with smtplib.SMTP_SSL(config.smtp_server, config.port) as server:\n                server.login(config.sender_email, config.sender_password)\n                server.send_message(msg)\n        else:\n            with smtplib.SMTP(config.smtp_server, config.port) as server:\n                try:\n                    server.starttls()  # Upgrade to a secure connection\n                except Exception as e:\n                    logging.error(f\"Failed to upgrade to a secure connection: {e}\")\n                # Attempt to login and send the message regardless of starttls success\n                server.login(config.sender_email, config.sender_password)\n                server.send_message(msg)\n\n        output.status = \"success\"\n        output.message = \"Email sent successfully\"\n    except Exception as e:\n        output.message = f\"An error occurred: {e}\"\n\n    return output","tools":[],"config":[{"BasicConfig":{"key_name":"smtp_server","description":"The SMTP server address","required":true,"type":null,"key_value":null}},{"BasicConfig":{"key_name":"port","description":"The SMTP server port","required":false,"type":null,"key_value":null}},{"BasicConfig":{"key_name":"sender_email","description":"The sender's email address","required":true,"type":null,"key_value":null}},{"BasicConfig":{"key_name":"sender_password","description":"The sender's email password","required":true,"type":null,"key_value":null}},{"BasicConfig":{"key_name":"ssl","description":"Whether to use SSL for the SMTP connection (defaults to true)","required":false,"type":null,"key_value":null}}],"description":"Sends an email using SMTP.","keywords":["email","smtp","send","notification"],"input_args":{"type":"object","properties":{"body":{"type":"string","description":"The email body"},"subject":{"type":"string","description":"The email subject"},"recipient_email":{"type":"string","description":"The recipient's email address"}},"required":["recipient_email","subject","body"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.16863883,0.36951548,0.0710708,-0.36373425,-0.14536303,0.2146287,-0.50722194,0.1676828,0.2184625,-0.04377217,-0.085600205,0.34219766,-0.36027485,-0.18785664,0.55667514,-0.691538,0.2247413,-0.8311942,-1.5291927,-0.047287576,-0.6570787,0.70218843,0.47352836,0.18740639,-0.17268768,0.29156917,0.6691437,-0.07875953,-1.2676071,-1.8487979,-0.081507675,1.0741738,-0.56719506,0.19950143,0.16902098,-0.33455634,-0.26199192,-0.09675157,-0.47350892,-0.37621498,0.17657778,-0.88388574,-0.61456853,0.14724383,0.0047138403,-0.07347565,0.18744619,-0.009305887,0.48106268,0.6018966,-0.39029375,-0.52880675,-0.04798488,0.3419745,-0.5091409,0.012889862,0.24974045,-0.07357307,0.08554194,0.07949574,-0.16837044,0.3805329,-4.0146613,0.44082963,0.19260548,-0.05207956,0.013428052,-0.056233037,-0.08819136,-0.5272552,0.47180402,-0.060578555,-0.7489064,1.1056236,0.5340901,-0.6931602,-0.31226557,-0.03932616,0.5956225,0.09799042,0.30966645,0.8742893,-0.17315604,0.75597227,-0.9725792,0.6906055,-0.1251234,-0.1491244,0.42240295,0.3407192,-0.44704607,-0.40117118,0.1866251,-0.06991961,-0.19835445,-0.20955215,-0.26118103,0.12725456,0.22721684,2.7749872,0.5122516,-0.015306573,0.60036194,-1.0183859,-0.014407955,-0.2569119,-0.47032169,-0.886011,-0.30298057,-0.7121273,-0.0036273357,0.12116812,0.10482912,-0.24737927,0.46679825,-0.045558598,-0.35440093,0.36716238,-0.065571554,1.0201825,-0.24053283,0.1286274,-0.5494258,-0.35711333,0.12258132,0.15131353,-0.32479504,0.105600774,-0.13950256,0.27332562,0.65994203,-0.780461,-0.21348491,-0.20567286,0.23244157,0.11215775,0.40510517,-0.52354896,0.06681162,-0.41453093,0.59581953,-2.140505,1.3061415,0.75075674,0.672057,-0.10104084,0.10604617,-0.1125272,-0.42605418,-0.07585393,-0.33421445,0.093503065,0.20071425,0.42282313,0.75608283,-0.15237688,-0.121898524,0.5767451,-0.09775403,0.007833563,-0.13465671,0.14342043,-0.09603147,0.28792357,0.030869912,-1.0182501,-0.090522915,0.38259473,-0.30252847,-0.07191988,0.25874224,-0.30134445,-0.30062976,0.3386175,-0.184572,-0.13463037,0.21865469,0.14952739,0.44614434,-0.5275878,0.44001737,0.48307657,-0.20029795,-0.20540681,0.009874843,0.62023115,0.29343334,-0.26610968,1.1866063,0.20866166,-0.86935693,1.194493,-0.70958436,-0.67053705,0.16449386,0.15501787,-0.2732337,0.5001677,0.40268838,0.05267391,-0.28818738,-0.25627786,0.3237739,0.20661367,-0.114382796,-0.3155887,0.036046203,0.09303906,0.045092113,-0.38759232,0.16511068,-0.2412476,0.20692427,-0.00802502,0.3642635,0.5850683,-0.76512456,0.46202484,-0.28010985,0.5700413,0.4096586,0.3902241,-0.42495793,-0.43494877,-0.30588314,0.48026097,-0.12984975,0.49075717,-0.29071864,-0.42085195,0.30260554,0.8222282,0.19941153,1.315254,0.30886918,0.17627637,-0.24155778,0.49255127,0.6639385,-0.1827571,0.02121464,0.09293347,0.13839658,0.035679504,0.73405087,-0.6335372,0.5251611,0.31011373,-0.091499746,1.8595266,0.7143397,0.5168366,0.03708881,0.507861,0.18957117,0.1983318,-1.0314994,-0.33044,-0.82924306,0.99074227,0.2815774,-0.07468645,0.74307996,0.36426264,-0.22649744,-0.05202507,-0.6921822,-0.802549,-0.31213802,-0.084367484,-0.5192693,0.41364402,-0.29686666,0.43975556,-0.17650422,-0.6930386,0.47838062,0.33172914,-0.058259707,-0.7303181,-0.099644355,0.015148858,0.5009095,-0.14864665,-0.14669248,-0.6800788,0.20073141,-0.40443534,-0.14989856,0.3386585,0.045613185,-0.7879523,-0.5424034,0.5760776,2.0714297,0.2327904,0.22501259,0.56382495,0.12127443,0.39556783,0.14754608,-0.019769825,-0.5407266,-0.3219013,-0.83585715,-0.34718287,0.026048623,-0.7465372,-0.07637849,-0.033146467,0.01799985,-0.18363564,0.2644258,0.12561584,0.59224236,0.30794838,-0.24934794,0.04864285,0.03341459,-2.4325747,0.01822721,0.2530063,-0.18837038,-0.44696414,-0.8883713,0.09524957,-0.016613895,0.104276374,-0.38413656,1.4529321,-0.11070707,-0.43041483,0.35400572,0.08043813,0.8491075,-0.1862826,0.22454764,-0.31269205,-0.97372025,-0.42027125,1.1249119,2.2466652,0.0023729801,-0.026027378,-0.16045304,-0.1841715,-0.3728962,-1.1865739,0.40547544,-0.17469762,-0.17986779,0.22225553,-0.09583995,-0.24011159,-0.623016,0.5858946,-0.058788326,-0.21884863,-0.63768953,1.4557298,0.05939327,0.680458,-0.681359,-0.2196953,-0.097733356,-0.13278785,0.22399272,-0.040767163,-0.50004923,0.57334274,0.268478,0.117074646,0.31567943,0.21000771,0.35896412,0.3529358,-0.12819107,0.7792076,1.001332,0.45549732,0.33468097,0.6633587,-0.7268323,0.1314122],"result":{"type":"object","properties":{"message":{"description":"A message indicating the result of the operation","type":"string"},"status":{"description":"The status of the email sending operation ('success' or 'failed')","type":"string"}},"required":["status","message"]},"sql_tables":[],"sql_queries":[],"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}