import * as playwright from 'npm:playwright@1.48.2';
import chromePaths from 'npm:chrome-paths@1.0.1';

// Remove later. It's for debugging.
import { Buffer } from 'node:buffer';

type Configurations = {
  chromePath?: string;
};
type Parameters = {};
type Result = {
  assetsToSupply: { asset: string; apy: string }[];
  assetsToBorrow: { asset: string; apy: string }[];
};

export const run: Run<Configurations, Parameters, Result> = async (
  configurations,
  _parameters,
): Promise<Result> => {
  const browser = await playwright['chromium'].launch({
    executablePath: configurations?.chromePath || chromePaths.chrome,
  });
  const context = await browser.newContext({
    viewport: { width: 1280, height: 800 }, // Set viewport size
  });

  const page = await context.newPage();
  await page.goto(
    'https://staging.aave.com/?marketName=proto_arbitrum_sepolia_v3',
  );

  await page.evaluate((scriptContent) => {
    const script = document.createElement('script');
    script.textContent = scriptContent;
    document.head.appendChild(script);
    console.log('Viem script injected');
  }, Buffer.from(viemScriptContent, 'base64').toString('utf-8'));

  // Click the "Opt-out" button
  // Wait for the "Opt-out" button to appear and click it
  await page.waitForSelector('#rcc-decline-button > p');
  await page.click('#rcc-decline-button > p');

  // Click the wallet button
  await page.waitForSelector('#wallet-button');
  await page.click('#wallet-button');

  // Click the "Browser wallet" button
  const browserWalletButton = page.locator(
    'body > div:nth-child(20) > div[class*="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1"] > div[class*="MuiBox-root"] > button:nth-child(2)',
  );

  await browserWalletButton.waitFor({ state: 'visible' });
  console.log('Browser wallet button is visible');
  await browserWalletButton.click();

  // Wait for 120 seconds
  await page.waitForTimeout(3000);
  console.log('Waited for 3 seconds');

  await browser.close();
  return Promise.resolve({ assetsToSupply: [], assetsToBorrow: [] });
};

export const definition: ToolDefinition<typeof run> = {
  id: 'shinkai-tool-get-loan-state',
  name: 'Shinkai: Current Aave Loan State',
  description:
    'Tool for requesting a loan on Aave, including selecting assets to supply and borrow with their APYs',
  author: 'Shinkai',
  keywords: ['aave', 'market', 'extractor', 'shinkai'],
  configurations: {
    type: 'object',
    properties: {
      chromePath: { type: 'string', nullable: true },
    },
    required: [],
  },
  parameters: {
    type: 'object',
    properties: {},
    required: [],
  },
  result: {
    type: 'object',
    properties: {
      assetsToSupply: {
        type: 'array',
        items: {
          type: 'object',
          properties: {
            asset: { type: 'string' },
            apy: { type: 'string' },
          },
          required: ['asset', 'apy'],
        },
      },
      assetsToBorrow: {
        type: 'array',
        items: {
          type: 'object',
          properties: {
            asset: { type: 'string' },
            apy: { type: 'string' },
          },
          required: ['asset', 'apy'],
        },
      },
    },
    required: ['assetsToSupply', 'assetsToBorrow'],
  },
};

// attach-viem-script-content
const viemScriptContent =
  'KCgpID0+IHsKICB2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogIHZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwogIHZhciBfX2VzbSA9IChmbiwgcmVzKSA9PiBmdW5jdGlvbiBfX2luaXQoKSB7CiAgICByZXR1cm4gZm4gJiYgKHJlcyA9ICgwLCBmbltfX2dldE93blByb3BOYW1lcyhmbilbMF1dKShmbiA9IDApKSwgcmVzOwogIH07CiAgdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgICBmb3IgKHZhciBuYW1lIGluIGFsbCkKICAgICAgX19kZWZQcm9wKHRhcmdldCwgbmFtZSwgeyBnZXQ6IGFsbFtuYW1lXSwgZW51bWVyYWJsZTogdHJ1ZSB9KTsKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzCiAgdmFyIHZlcnNpb247CiAgdmFyIGluaXRfdmVyc2lvbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbiA9ICIxLjAuNiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcwogIHZhciBCYXNlRXJyb3I7CiAgdmFyIGluaXRfZXJyb3JzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcyIoKSB7CiAgICAgIGluaXRfdmVyc2lvbigpOwogICAgICBCYXNlRXJyb3IgPSBjbGFzcyBfQmFzZUVycm9yIGV4dGVuZHMgRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHNob3J0TWVzc2FnZSwgYXJncyA9IHt9KSB7CiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRldGFpbHMgOiBhcmdzLmNhdXNlPy5tZXNzYWdlID8gYXJncy5jYXVzZS5tZXNzYWdlIDogYXJncy5kZXRhaWxzOwogICAgICAgICAgY29uc3QgZG9jc1BhdGg5ID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRvY3NQYXRoIHx8IGFyZ3MuZG9jc1BhdGggOiBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgY29uc3QgbWVzc2FnZSA9IFsKICAgICAgICAgICAgc2hvcnRNZXNzYWdlIHx8ICJBbiBlcnJvciBvY2N1cnJlZC4iLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgLi4uYXJncy5tZXRhTWVzc2FnZXMgPyBbLi4uYXJncy5tZXRhTWVzc2FnZXMsICIiXSA6IFtdLAogICAgICAgICAgICAuLi5kb2NzUGF0aDkgPyBbYERvY3M6IGh0dHBzOi8vYWJpdHlwZS5kZXYke2RvY3NQYXRoOX1gXSA6IFtdLAogICAgICAgICAgICAuLi5kZXRhaWxzID8gW2BEZXRhaWxzOiAke2RldGFpbHN9YF0gOiBbXSwKICAgICAgICAgICAgYFZlcnNpb246IGFiaXR5cGVAJHt2ZXJzaW9ufWAKICAgICAgICAgIF0uam9pbigiXG4iKTsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkZXRhaWxzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZG9jc1BhdGgiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtZXRhTWVzc2FnZXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaG9ydE1lc3NhZ2UiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkFiaVR5cGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKGFyZ3MuY2F1c2UpCiAgICAgICAgICAgIHRoaXMuY2F1c2UgPSBhcmdzLmNhdXNlOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5zaG9ydE1lc3NhZ2UgPSBzaG9ydE1lc3NhZ2U7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9yZWdleC5qcwogIGZ1bmN0aW9uIGV4ZWNUeXBlZChyZWdleCwgc3RyaW5nKSB7CiAgICBjb25zdCBtYXRjaCA9IHJlZ2V4LmV4ZWMoc3RyaW5nKTsKICAgIHJldHVybiBtYXRjaD8uZ3JvdXBzOwogIH0KICB2YXIgYnl0ZXNSZWdleCwgaW50ZWdlclJlZ2V4LCBpc1R1cGxlUmVnZXg7CiAgdmFyIGluaXRfcmVnZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vcmVnZXguanMiKCkgewogICAgICBieXRlc1JlZ2V4ID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgICAgIGludGVnZXJSZWdleCA9IC9edT9pbnQoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKICAgICAgaXNUdXBsZVJlZ2V4ID0gL15cKC4rP1wpLio/JC87CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaVBhcmFtZXRlci5qcwogIGZ1bmN0aW9uIGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpIHsKICAgIGxldCB0eXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBpZiAodHVwbGVSZWdleC50ZXN0KGFiaVBhcmFtZXRlci50eXBlKSAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKSB7CiAgICAgIHR5cGUgPSAiKCI7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzW2ldOwogICAgICAgIHR5cGUgKz0gZm9ybWF0QWJpUGFyYW1ldGVyKGNvbXBvbmVudCk7CiAgICAgICAgaWYgKGkgPCBsZW5ndGggLSAxKQogICAgICAgICAgdHlwZSArPSAiLCAiOwogICAgICB9CiAgICAgIGNvbnN0IHJlc3VsdCA9IGV4ZWNUeXBlZCh0dXBsZVJlZ2V4LCBhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIHR5cGUgKz0gYCkke3Jlc3VsdD8uYXJyYXkgPz8gIiJ9YDsKICAgICAgcmV0dXJuIGZvcm1hdEFiaVBhcmFtZXRlcih7CiAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICB9CiAgICBpZiAoImluZGV4ZWQiIGluIGFiaVBhcmFtZXRlciAmJiBhYmlQYXJhbWV0ZXIuaW5kZXhlZCkKICAgICAgdHlwZSA9IGAke3R5cGV9IGluZGV4ZWRgOwogICAgaWYgKGFiaVBhcmFtZXRlci5uYW1lKQogICAgICByZXR1cm4gYCR7dHlwZX0gJHthYmlQYXJhbWV0ZXIubmFtZX1gOwogICAgcmV0dXJuIHR5cGU7CiAgfQogIHZhciB0dXBsZVJlZ2V4OwogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIHR1cGxlUmVnZXggPSAvXnR1cGxlKD88YXJyYXk+KFxbKFxkKilcXSkqKSQvOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpUGFyYW1ldGVycyhhYmlQYXJhbWV0ZXJzKSB7CiAgICBsZXQgcGFyYW1zID0gIiI7CiAgICBjb25zdCBsZW5ndGggPSBhYmlQYXJhbWV0ZXJzLmxlbmd0aDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gYWJpUGFyYW1ldGVyc1tpXTsKICAgICAgcGFyYW1zICs9IGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpOwogICAgICBpZiAoaSAhPT0gbGVuZ3RoIC0gMSkKICAgICAgICBwYXJhbXMgKz0gIiwgIjsKICAgIH0KICAgIHJldHVybiBwYXJhbXM7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpUGFyYW1ldGVycy5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVyKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaUl0ZW0uanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtKGFiaUl0ZW0pIHsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiBgZnVuY3Rpb24gJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cyl9KSR7YWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgJiYgYWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgIT09ICJub25wYXlhYmxlIiA/IGAgJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eX1gIDogIiJ9JHthYmlJdGVtLm91dHB1dHMubGVuZ3RoID8gYCByZXR1cm5zICgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5vdXRwdXRzKX0pYCA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICByZXR1cm4gYGV2ZW50ICR7YWJpSXRlbS5uYW1lfSgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMpfSlgOwogICAgaWYgKGFiaUl0ZW0udHlwZSA9PT0gImVycm9yIikKICAgICAgcmV0dXJuIGBlcnJvciAke2FiaUl0ZW0ubmFtZX0oJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pYDsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJjb25zdHJ1Y3RvciIpCiAgICAgIHJldHVybiBgY29uc3RydWN0b3IoJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInBheWFibGUiID8gIiBwYXlhYmxlIiA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZmFsbGJhY2siKQogICAgICByZXR1cm4gImZhbGxiYWNrKCkiOwogICAgcmV0dXJuICJyZWNlaXZlKCkgZXh0ZXJuYWwgcGF5YWJsZSI7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaUl0ZW0gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpSXRlbS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVycygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMKICBmdW5jdGlvbiBpc0Vycm9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGVycm9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGVycm9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXZlbnRTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBleGVjVHlwZWQoZXZlbnRTaWduYXR1cmVSZWdleCwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LnRlc3Qoc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGV4ZWNUeXBlZChmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBzdHJ1Y3RTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKHN0cnVjdFNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRmFsbGJhY2tTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZmFsbGJhY2tTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzUmVjZWl2ZVNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiByZWNlaXZlU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICB2YXIgZXJyb3JTaWduYXR1cmVSZWdleCwgZXZlbnRTaWduYXR1cmVSZWdleCwgZnVuY3Rpb25TaWduYXR1cmVSZWdleCwgc3RydWN0U2lnbmF0dXJlUmVnZXgsIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIGZhbGxiYWNrU2lnbmF0dXJlUmVnZXgsIHJlY2VpdmVTaWduYXR1cmVSZWdleCwgbW9kaWZpZXJzLCBldmVudE1vZGlmaWVycywgZnVuY3Rpb25Nb2RpZmllcnM7CiAgdmFyIGluaXRfc2lnbmF0dXJlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGVycm9yU2lnbmF0dXJlUmVnZXggPSAvXmVycm9yICg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKVwoKD88cGFyYW1ldGVycz4uKj8pXCkkLzsKICAgICAgZXZlbnRTaWduYXR1cmVSZWdleCA9IC9eZXZlbnQgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopXCgoPzxwYXJhbWV0ZXJzPi4qPylcKSQvOwogICAgICBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4ID0gL15mdW5jdGlvbiAoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKilcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86ICg/PHNjb3BlPmV4dGVybmFsfHB1YmxpY3sxfSkpPyg/OiAoPzxzdGF0ZU11dGFiaWxpdHk+cHVyZXx2aWV3fG5vbnBheWFibGV8cGF5YWJsZXsxfSkpPyg/OiByZXR1cm5zXHM/XCgoPzxyZXR1cm5zPi4qPylcKSk/JC87CiAgICAgIHN0cnVjdFNpZ25hdHVyZVJlZ2V4ID0gL15zdHJ1Y3QgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopIFx7KD88cHJvcGVydGllcz4uKj8pXH0kLzsKICAgICAgY29uc3RydWN0b3JTaWduYXR1cmVSZWdleCA9IC9eY29uc3RydWN0b3JcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86XHMoPzxzdGF0ZU11dGFiaWxpdHk+cGF5YWJsZXsxfSkpPyQvOwogICAgICBmYWxsYmFja1NpZ25hdHVyZVJlZ2V4ID0gL15mYWxsYmFja1woXCkgZXh0ZXJuYWwoPzpccyg/PHN0YXRlTXV0YWJpbGl0eT5wYXlhYmxlezF9KSk/JC87CiAgICAgIHJlY2VpdmVTaWduYXR1cmVSZWdleCA9IC9ecmVjZWl2ZVwoXCkgZXh0ZXJuYWwgcGF5YWJsZSQvOwogICAgICBtb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgIm1lbW9yeSIsCiAgICAgICAgImluZGV4ZWQiLAogICAgICAgICJzdG9yYWdlIiwKICAgICAgICAiY2FsbGRhdGEiCiAgICAgIF0pOwogICAgICBldmVudE1vZGlmaWVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsiaW5kZXhlZCJdKTsKICAgICAgZnVuY3Rpb25Nb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgImNhbGxkYXRhIiwKICAgICAgICAibWVtb3J5IiwKICAgICAgICAic3RvcmFnZSIKICAgICAgXSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzCiAgdmFyIEludmFsaWRBYmlJdGVtRXJyb3IsIFVua25vd25UeXBlRXJyb3IsIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcjsKICB2YXIgaW5pdF9hYmlJdGVtID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZEFiaUl0ZW1FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNpZ25hdHVyZSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBpdGVtLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogYHBhcnNlQWJpSXRlbSgke0pTT04uc3RyaW5naWZ5KHNpZ25hdHVyZSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaWl0ZW0tMSIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRBYmlJdGVtRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25UeXBlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0eXBlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHR5cGUuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgVHlwZSAiJHt0eXBlfSIgaXMgbm90IGEgdmFsaWQgQUJJIHR5cGUuIFBlcmhhcHMgeW91IGZvcmdvdCB0byBpbmNsdWRlIGEgc3RydWN0IHNpZ25hdHVyZT9gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIlVua25vd25UeXBlRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIlVua25vd24gdHlwZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BUeXBlICIke3R5cGV9IiBpcyBub3QgYSB2YWxpZCBBQkkgdHlwZS5gXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNvbGlkaXR5VHlwZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvYWJpUGFyYW1ldGVyLmpzCiAgdmFyIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvciwgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwgSW52YWxpZFBhcmFtZXRlckVycm9yLCBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvciwgSW52YWxpZE1vZGlmaWVyRXJyb3IsIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I7CiAgdmFyIGluaXRfYWJpUGFyYW1ldGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXIoJHtKU09OLnN0cmluZ2lmeShwYXJhbSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaXBhcmFtZXRlci0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW1zIH0pIHsKICAgICAgICAgIHN1cGVyKCJGYWlsZWQgdG8gcGFyc2UgQUJJIHBhcmFtZXRlcnMuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXJzKCR7SlNPTi5zdHJpbmdpZnkocGFyYW1zLCBudWxsLCAyKX0pYCwKICAgICAgICAgICAgZG9jc1BhdGg6ICIvYXBpL2h1bWFuI3BhcnNlYWJpcGFyYW1ldGVycy0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFBhcmFtZXRlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0gfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkUGFyYW1ldGVyRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIG5hbWUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgIiR7bmFtZX0iIGlzIGEgcHJvdGVjdGVkIFNvbGlkaXR5IGtleXdvcmQuIE1vcmUgaW5mbzogaHR0cHM6Ly9kb2NzLnNvbGlkaXR5bGFuZy5vcmcvZW4vbGF0ZXN0L2NoZWF0c2hlZXQuaHRtbGAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRNb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRNb2RpZmllckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gLAogICAgICAgICAgICAgIGBEYXRhIGxvY2F0aW9uIGNhbiBvbmx5IGJlIHNwZWNpZmllZCBmb3IgYXJyYXksIHN0cnVjdCwgb3IgbWFwcGluZyB0eXBlcywgYnV0ICIke21vZGlmaWVyfSIgd2FzIGdpdmVuLmAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEZ1bmN0aW9uTW9kaWZpZXJFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEFiaVR5cGVQYXJhbWV0ZXJFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGFiaVBhcmFtZXRlciB9KSB7CiAgICAgICAgICBzdXBlcigiSW52YWxpZCBBQkkgcGFyYW1ldGVyLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogSlNPTi5zdHJpbmdpZnkoYWJpUGFyYW1ldGVyLCBudWxsLCAyKSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkFCSSBwYXJhbWV0ZXIgdHlwZSBpcyBpbnZhbGlkLiJdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkQWJpVHlwZVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc2lnbmF0dXJlLmpzCiAgdmFyIEludmFsaWRTaWduYXR1cmVFcnJvciwgVW5rbm93blNpZ25hdHVyZUVycm9yLCBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I7CiAgdmFyIGluaXRfc2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9zaWduYXR1cmUuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkU2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgJHt0eXBlfSBzaWduYXR1cmUuYCwgewogICAgICAgICAgICBkZXRhaWxzOiBzaWduYXR1cmUKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgVW5rbm93blNpZ25hdHVyZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2lnbmF0dXJlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNpZ25hdHVyZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgc3RydWN0IHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIk5vIHByb3BlcnRpZXMgZXhpc3QuIl0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZXJyb3JzL3N0cnVjdC5qcwogIHZhciBDaXJjdWxhclJlZmVyZW5jZUVycm9yOwogIHZhciBpbml0X3N0cnVjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3RydWN0LmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgQ2lyY3VsYXJSZWZlcmVuY2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIkNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3RlZC4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BTdHJ1Y3QgIiR7dHlwZX0iIGlzIGEgY2lyY3VsYXIgcmVmZXJlbmNlLmBdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJDaXJjdWxhclJlZmVyZW5jZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzCiAgdmFyIEludmFsaWRQYXJlbnRoZXNpc0Vycm9yOwogIHZhciBpbml0X3NwbGl0UGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjdXJyZW50LCBkZXB0aCB9KSB7CiAgICAgICAgICBzdXBlcigiVW5iYWxhbmNlZCBwYXJlbnRoZXNlcy4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGAiJHtjdXJyZW50LnRyaW0oKX0iIGhhcyB0b28gbWFueSAke2RlcHRoID4gMCA/ICJvcGVuaW5nIiA6ICJjbG9zaW5nIn0gcGFyZW50aGVzZXMuYAogICAgICAgICAgICBdLAogICAgICAgICAgICBkZXRhaWxzOiBgRGVwdGggIiR7ZGVwdGh9ImAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRQYXJlbnRoZXNpc0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL2NhY2hlLmpzCiAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVyQ2FjaGVLZXkocGFyYW0sIHR5cGUpIHsKICAgIGlmICh0eXBlKQogICAgICByZXR1cm4gYCR7dHlwZX06JHtwYXJhbX1gOwogICAgcmV0dXJuIHBhcmFtOwogIH0KICB2YXIgcGFyYW1ldGVyQ2FjaGU7CiAgdmFyIGluaXRfY2FjaGUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9jYWNoZS5qcyIoKSB7CiAgICAgIHBhcmFtZXRlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoWwogICAgICAgIC8vIFVubmFtZWQKICAgICAgICBbImFkZHJlc3MiLCB7IHR5cGU6ICJhZGRyZXNzIiB9XSwKICAgICAgICBbImJvb2wiLCB7IHR5cGU6ICJib29sIiB9XSwKICAgICAgICBbImJ5dGVzIiwgeyB0eXBlOiAiYnl0ZXMiIH1dLAogICAgICAgIFsiYnl0ZXMzMiIsIHsgdHlwZTogImJ5dGVzMzIiIH1dLAogICAgICAgIFsiaW50IiwgeyB0eXBlOiAiaW50MjU2IiB9XSwKICAgICAgICBbImludDI1NiIsIHsgdHlwZTogImludDI1NiIgfV0sCiAgICAgICAgWyJzdHJpbmciLCB7IHR5cGU6ICJzdHJpbmciIH1dLAogICAgICAgIFsidWludCIsIHsgdHlwZTogInVpbnQyNTYiIH1dLAogICAgICAgIFsidWludDgiLCB7IHR5cGU6ICJ1aW50OCIgfV0sCiAgICAgICAgWyJ1aW50MTYiLCB7IHR5cGU6ICJ1aW50MTYiIH1dLAogICAgICAgIFsidWludDI0IiwgeyB0eXBlOiAidWludDI0IiB9XSwKICAgICAgICBbInVpbnQzMiIsIHsgdHlwZTogInVpbnQzMiIgfV0sCiAgICAgICAgWyJ1aW50NjQiLCB7IHR5cGU6ICJ1aW50NjQiIH1dLAogICAgICAgIFsidWludDk2IiwgeyB0eXBlOiAidWludDk2IiB9XSwKICAgICAgICBbInVpbnQxMTIiLCB7IHR5cGU6ICJ1aW50MTEyIiB9XSwKICAgICAgICBbInVpbnQxNjAiLCB7IHR5cGU6ICJ1aW50MTYwIiB9XSwKICAgICAgICBbInVpbnQxOTIiLCB7IHR5cGU6ICJ1aW50MTkyIiB9XSwKICAgICAgICBbInVpbnQyNTYiLCB7IHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAvLyBOYW1lZAogICAgICAgIFsiYWRkcmVzcyBvd25lciIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAib3duZXIiIH1dLAogICAgICAgIFsiYWRkcmVzcyB0byIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAidG8iIH1dLAogICAgICAgIFsiYm9vbCBhcHByb3ZlZCIsIHsgdHlwZTogImJvb2wiLCBuYW1lOiAiYXBwcm92ZWQiIH1dLAogICAgICAgIFsiYnl0ZXMgX2RhdGEiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJfZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBkYXRhIiwgeyB0eXBlOiAiYnl0ZXMiLCBuYW1lOiAiZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBzaWduYXR1cmUiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJzaWduYXR1cmUiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBoYXNoIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJoYXNoIiB9XSwKICAgICAgICBbImJ5dGVzMzIgciIsIHsgdHlwZTogImJ5dGVzMzIiLCBuYW1lOiAiciIgfV0sCiAgICAgICAgWyJieXRlczMyIHJvb3QiLCB7IHR5cGU6ICJieXRlczMyIiwgbmFtZTogInJvb3QiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBzIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJzIiB9XSwKICAgICAgICBbInN0cmluZyBuYW1lIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogIm5hbWUiIH1dLAogICAgICAgIFsic3RyaW5nIHN5bWJvbCIsIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJzeW1ib2wiIH1dLAogICAgICAgIFsic3RyaW5nIHRva2VuVVJJIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInRva2VuVVJJIiB9XSwKICAgICAgICBbInVpbnQgdG9rZW5JZCIsIHsgdHlwZTogInVpbnQyNTYiLCBuYW1lOiAidG9rZW5JZCIgfV0sCiAgICAgICAgWyJ1aW50OCB2IiwgeyB0eXBlOiAidWludDgiLCBuYW1lOiAidiIgfV0sCiAgICAgICAgWyJ1aW50MjU2IGJhbGFuY2UiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogImJhbGFuY2UiIH1dLAogICAgICAgIFsidWludDI1NiB0b2tlbklkIiwgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiB9XSwKICAgICAgICBbInVpbnQyNTYgdmFsdWUiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogInZhbHVlIiB9XSwKICAgICAgICAvLyBJbmRleGVkCiAgICAgICAgWwogICAgICAgICAgImV2ZW50OmFkZHJlc3MgaW5kZXhlZCBmcm9tIiwKICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAiZnJvbSIsIGluZGV4ZWQ6IHRydWUgfQogICAgICAgIF0sCiAgICAgICAgWyJldmVudDphZGRyZXNzIGluZGV4ZWQgdG8iLCB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInRvIiwgaW5kZXhlZDogdHJ1ZSB9XSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludCBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludDI1NiBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXQogICAgICBdKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcwogIGZ1bmN0aW9uIHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZSwgc3RydWN0cyA9IHt9KSB7CiAgICBpZiAoaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpKSB7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSk7CiAgICAgIGlmICghbWF0Y2gpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSwgdHlwZTogImZ1bmN0aW9uIiB9KTsKICAgICAgY29uc3QgaW5wdXRQYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGlucHV0cyA9IFtdOwogICAgICBjb25zdCBpbnB1dExlbmd0aCA9IGlucHV0UGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSsrKSB7CiAgICAgICAgaW5wdXRzLnB1c2gocGFyc2VBYmlQYXJhbWV0ZXIoaW5wdXRQYXJhbXNbaV0sIHsKICAgICAgICAgIG1vZGlmaWVyczogZnVuY3Rpb25Nb2RpZmllcnMsCiAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0pKTsKICAgICAgfQogICAgICBjb25zdCBvdXRwdXRzID0gW107CiAgICAgIGlmIChtYXRjaC5yZXR1cm5zKSB7CiAgICAgICAgY29uc3Qgb3V0cHV0UGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnJldHVybnMpOwogICAgICAgIGNvbnN0IG91dHB1dExlbmd0aCA9IG91dHB1dFBhcmFtcy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRwdXRMZW5ndGg7IGkrKykgewogICAgICAgICAgb3V0cHV0cy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKG91dHB1dFBhcmFtc1tpXSwgewogICAgICAgICAgICBtb2RpZmllcnM6IGZ1bmN0aW9uTW9kaWZpZXJzLAogICAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbWF0Y2gubmFtZSwKICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHMsCiAgICAgICAgb3V0cHV0cwogICAgICB9OwogICAgfQogICAgaWYgKGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJldmVudCIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgewogICAgICAgICAgbW9kaWZpZXJzOiBldmVudE1vZGlmaWVycywKICAgICAgICAgIHN0cnVjdHMsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiB7IG5hbWU6IG1hdGNoLm5hbWUsIHR5cGU6ICJldmVudCIsIGlucHV0czogYWJpUGFyYW1ldGVycyB9OwogICAgfQogICAgaWYgKGlzRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFcnJvclNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJlcnJvciIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgeyBzdHJ1Y3RzLCB0eXBlOiAiZXJyb3IiIH0pKTsKICAgICAgfQogICAgICByZXR1cm4geyBuYW1lOiBtYXRjaC5uYW1lLCB0eXBlOiAiZXJyb3IiLCBpbnB1dHM6IGFiaVBhcmFtZXRlcnMgfTsKICAgIH0KICAgIGlmIChpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkpIHsKICAgICAgY29uc3QgbWF0Y2ggPSBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgaWYgKCFtYXRjaCkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFNpZ25hdHVyZUVycm9yKHsgc2lnbmF0dXJlLCB0eXBlOiAiY29uc3RydWN0b3IiIH0pOwogICAgICBjb25zdCBwYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlcnMgPSBbXTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cywgdHlwZTogImNvbnN0cnVjdG9yIiB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHM6IGFiaVBhcmFtZXRlcnMKICAgICAgfTsKICAgIH0KICAgIGlmIChpc0ZhbGxiYWNrU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHR5cGU6ICJmYWxsYmFjayIgfTsKICAgIGlmIChpc1JlY2VpdmVTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAicmVjZWl2ZSIsCiAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIKICAgICAgfTsKICAgIHRocm93IG5ldyBVbmtub3duU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUgfSk7CiAgfQogIGZ1bmN0aW9uIHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCBvcHRpb25zKSB7CiAgICBjb25zdCBwYXJhbWV0ZXJDYWNoZUtleSA9IGdldFBhcmFtZXRlckNhY2hlS2V5KHBhcmFtLCBvcHRpb25zPy50eXBlKTsKICAgIGlmIChwYXJhbWV0ZXJDYWNoZS5oYXMocGFyYW1ldGVyQ2FjaGVLZXkpKQogICAgICByZXR1cm4gcGFyYW1ldGVyQ2FjaGUuZ2V0KHBhcmFtZXRlckNhY2hlS2V5KTsKICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChwYXJhbSk7CiAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZChpc1R1cGxlID8gYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXggOiBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgcGFyYW0pOwogICAgaWYgKCFtYXRjaCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbWV0ZXJFcnJvcih7IHBhcmFtIH0pOwogICAgaWYgKG1hdGNoLm5hbWUgJiYgaXNTb2xpZGl0eUtleXdvcmQobWF0Y2gubmFtZSkpCiAgICAgIHRocm93IG5ldyBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvcih7IHBhcmFtLCBuYW1lOiBtYXRjaC5uYW1lIH0pOwogICAgY29uc3QgbmFtZSA9IG1hdGNoLm5hbWUgPyB7IG5hbWU6IG1hdGNoLm5hbWUgfSA6IHt9OwogICAgY29uc3QgaW5kZXhlZCA9IG1hdGNoLm1vZGlmaWVyID09PSAiaW5kZXhlZCIgPyB7IGluZGV4ZWQ6IHRydWUgfSA6IHt9OwogICAgY29uc3Qgc3RydWN0cyA9IG9wdGlvbnM/LnN0cnVjdHMgPz8ge307CiAgICBsZXQgdHlwZTsKICAgIGxldCBjb21wb25lbnRzID0ge307CiAgICBpZiAoaXNUdXBsZSkgewogICAgICB0eXBlID0gInR1cGxlIjsKICAgICAgY29uc3QgcGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnR5cGUpOwogICAgICBjb25zdCBjb21wb25lbnRzXyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50c18ucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cyB9KSk7CiAgICAgIH0KICAgICAgY29tcG9uZW50cyA9IHsgY29tcG9uZW50czogY29tcG9uZW50c18gfTsKICAgIH0gZWxzZSBpZiAobWF0Y2gudHlwZSBpbiBzdHJ1Y3RzKSB7CiAgICAgIHR5cGUgPSAidHVwbGUiOwogICAgICBjb21wb25lbnRzID0geyBjb21wb25lbnRzOiBzdHJ1Y3RzW21hdGNoLnR5cGVdIH07CiAgICB9IGVsc2UgaWYgKGR5bmFtaWNJbnRlZ2VyUmVnZXgudGVzdChtYXRjaC50eXBlKSkgewogICAgICB0eXBlID0gYCR7bWF0Y2gudHlwZX0yNTZgOwogICAgfSBlbHNlIHsKICAgICAgdHlwZSA9IG1hdGNoLnR5cGU7CiAgICAgIGlmICghKG9wdGlvbnM/LnR5cGUgPT09ICJzdHJ1Y3QiKSAmJiAhaXNTb2xpZGl0eVR5cGUodHlwZSkpCiAgICAgICAgdGhyb3cgbmV3IFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcih7IHR5cGUgfSk7CiAgICB9CiAgICBpZiAobWF0Y2gubW9kaWZpZXIpIHsKICAgICAgaWYgKCFvcHRpb25zPy5tb2RpZmllcnM/Lmhhcz8uKG1hdGNoLm1vZGlmaWVyKSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE1vZGlmaWVyRXJyb3IoewogICAgICAgICAgcGFyYW0sCiAgICAgICAgICB0eXBlOiBvcHRpb25zPy50eXBlLAogICAgICAgICAgbW9kaWZpZXI6IG1hdGNoLm1vZGlmaWVyCiAgICAgICAgfSk7CiAgICAgIGlmIChmdW5jdGlvbk1vZGlmaWVycy5oYXMobWF0Y2gubW9kaWZpZXIpICYmICFpc1ZhbGlkRGF0YUxvY2F0aW9uKHR5cGUsICEhbWF0Y2guYXJyYXkpKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yKHsKICAgICAgICAgIHBhcmFtLAogICAgICAgICAgdHlwZTogb3B0aW9ucz8udHlwZSwKICAgICAgICAgIG1vZGlmaWVyOiBtYXRjaC5tb2RpZmllcgogICAgICAgIH0pOwogICAgfQogICAgY29uc3QgYWJpUGFyYW1ldGVyID0gewogICAgICB0eXBlOiBgJHt0eXBlfSR7bWF0Y2guYXJyYXkgPz8gIiJ9YCwKICAgICAgLi4ubmFtZSwKICAgICAgLi4uaW5kZXhlZCwKICAgICAgLi4uY29tcG9uZW50cwogICAgfTsKICAgIHBhcmFtZXRlckNhY2hlLnNldChwYXJhbWV0ZXJDYWNoZUtleSwgYWJpUGFyYW1ldGVyKTsKICAgIHJldHVybiBhYmlQYXJhbWV0ZXI7CiAgfQogIGZ1bmN0aW9uIHNwbGl0UGFyYW1ldGVycyhwYXJhbXMsIHJlc3VsdCA9IFtdLCBjdXJyZW50ID0gIiIsIGRlcHRoID0gMCkgewogICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLnRyaW0oKS5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGNoYXIgPSBwYXJhbXNbaV07CiAgICAgIGNvbnN0IHRhaWwgPSBwYXJhbXMuc2xpY2UoaSArIDEpOwogICAgICBzd2l0Y2ggKGNoYXIpIHsKICAgICAgICBjYXNlICIsIjoKICAgICAgICAgIHJldHVybiBkZXB0aCA9PT0gMCA/IHNwbGl0UGFyYW1ldGVycyh0YWlsLCBbLi4ucmVzdWx0LCBjdXJyZW50LnRyaW0oKV0pIDogc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGgpOwogICAgICAgIGNhc2UgIigiOgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoICsgMSk7CiAgICAgICAgY2FzZSAiKSI6CiAgICAgICAgICByZXR1cm4gc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGggLSAxKTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoKTsKICAgICAgfQogICAgfQogICAgaWYgKGN1cnJlbnQgPT09ICIiKQogICAgICByZXR1cm4gcmVzdWx0OwogICAgaWYgKGRlcHRoICE9PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IoeyBjdXJyZW50LCBkZXB0aCB9KTsKICAgIHJlc3VsdC5wdXNoKGN1cnJlbnQudHJpbSgpKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGlzU29saWRpdHlUeXBlKHR5cGUpIHsKICAgIHJldHVybiB0eXBlID09PSAiYWRkcmVzcyIgfHwgdHlwZSA9PT0gImJvb2wiIHx8IHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgdHlwZSA9PT0gInN0cmluZyIgfHwgYnl0ZXNSZWdleC50ZXN0KHR5cGUpIHx8IGludGVnZXJSZWdleC50ZXN0KHR5cGUpOwogIH0KICBmdW5jdGlvbiBpc1NvbGlkaXR5S2V5d29yZChuYW1lKSB7CiAgICByZXR1cm4gbmFtZSA9PT0gImFkZHJlc3MiIHx8IG5hbWUgPT09ICJib29sIiB8fCBuYW1lID09PSAiZnVuY3Rpb24iIHx8IG5hbWUgPT09ICJzdHJpbmciIHx8IG5hbWUgPT09ICJ0dXBsZSIgfHwgYnl0ZXNSZWdleC50ZXN0KG5hbWUpIHx8IGludGVnZXJSZWdleC50ZXN0KG5hbWUpIHx8IHByb3RlY3RlZEtleXdvcmRzUmVnZXgudGVzdChuYW1lKTsKICB9CiAgZnVuY3Rpb24gaXNWYWxpZERhdGFMb2NhdGlvbih0eXBlLCBpc0FycmF5KSB7CiAgICByZXR1cm4gaXNBcnJheSB8fCB0eXBlID09PSAiYnl0ZXMiIHx8IHR5cGUgPT09ICJzdHJpbmciIHx8IHR5cGUgPT09ICJ0dXBsZSI7CiAgfQogIHZhciBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXgsIGR5bmFtaWNJbnRlZ2VyUmVnZXgsIHByb3RlY3RlZEtleXdvcmRzUmVnZXg7CiAgdmFyIGluaXRfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcyIoKSB7CiAgICAgIGluaXRfcmVnZXgoKTsKICAgICAgaW5pdF9hYmlJdGVtKCk7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlKCk7CiAgICAgIGluaXRfc3BsaXRQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfY2FjaGUoKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGFiaVBhcmFtZXRlcldpdGhvdXRUdXBsZVJlZ2V4ID0gL14oPzx0eXBlPlthLXpBLVokX11bYS16QS1aMC05JF9dKikoPzxhcnJheT4oPzpcW1xkKj9cXSkrPyk/KD86XHMoPzxtb2RpZmllcj5jYWxsZGF0YXxpbmRleGVkfG1lbW9yeXxzdG9yYWdlezF9KSk/KD86XHMoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKikpPyQvOwogICAgICBhYmlQYXJhbWV0ZXJXaXRoVHVwbGVSZWdleCA9IC9eXCgoPzx0eXBlPi4rPylcKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8oPzpccyg/PG1vZGlmaWVyPmNhbGxkYXRhfGluZGV4ZWR8bWVtb3J5fHN0b3JhZ2V7MX0pKT8oPzpccyg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSk/JC87CiAgICAgIGR5bmFtaWNJbnRlZ2VyUmVnZXggPSAvXnU/aW50JC87CiAgICAgIHByb3RlY3RlZEtleXdvcmRzUmVnZXggPSAvXig/OmFmdGVyfGFsaWFzfGFub255bW91c3xhcHBseXxhdXRvfGJ5dGV8Y2FsbGRhdGF8Y2FzZXxjYXRjaHxjb25zdGFudHxjb3B5b2Z8ZGVmYXVsdHxkZWZpbmVkfGVycm9yfGV2ZW50fGV4dGVybmFsfGZhbHNlfGZpbmFsfGZ1bmN0aW9ufGltbXV0YWJsZXxpbXBsZW1lbnRzfGlufGluZGV4ZWR8aW5saW5lfGludGVybmFsfGxldHxtYXBwaW5nfG1hdGNofG1lbW9yeXxtdXRhYmxlfG51bGx8b2Z8b3ZlcnJpZGV8cGFydGlhbHxwcml2YXRlfHByb21pc2V8cHVibGljfHB1cmV8cmVmZXJlbmNlfHJlbG9jYXRhYmxlfHJldHVybnxyZXR1cm5zfHNpemVvZnxzdGF0aWN8c3RvcmFnZXxzdHJ1Y3R8c3VwZXJ8c3VwcG9ydHN8c3dpdGNofHRoaXN8dHJ1ZXx0cnl8dHlwZWRlZnx0eXBlb2Z8dmFyfHZpZXd8dmlydHVhbCkkLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9zdHJ1Y3RzLmpzCiAgZnVuY3Rpb24gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpIHsKICAgIGNvbnN0IHNoYWxsb3dTdHJ1Y3RzID0ge307CiAgICBjb25zdCBzaWduYXR1cmVzTGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZXNMZW5ndGg7IGkrKykgewogICAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVzW2ldOwogICAgICBpZiAoIWlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgICAgY29udGludWU7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJzdHJ1Y3QiIH0pOwogICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbWF0Y2gucHJvcGVydGllcy5zcGxpdCgiOyIpOwogICAgICBjb25zdCBjb21wb25lbnRzID0gW107CiAgICAgIGNvbnN0IHByb3BlcnRpZXNMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBwcm9wZXJ0aWVzTGVuZ3RoOyBrKyspIHsKICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnRpZXNba107CiAgICAgICAgY29uc3QgdHJpbW1lZCA9IHByb3BlcnR5LnRyaW0oKTsKICAgICAgICBpZiAoIXRyaW1tZWQpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBjb25zdCBhYmlQYXJhbWV0ZXIgPSBwYXJzZUFiaVBhcmFtZXRlcih0cmltbWVkLCB7CiAgICAgICAgICB0eXBlOiAic3RydWN0IgogICAgICAgIH0pOwogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICB9CiAgICAgIGlmICghY29tcG9uZW50cy5sZW5ndGgpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSB9KTsKICAgICAgc2hhbGxvd1N0cnVjdHNbbWF0Y2gubmFtZV0gPSBjb21wb25lbnRzOwogICAgfQogICAgY29uc3QgcmVzb2x2ZWRTdHJ1Y3RzID0ge307CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoc2hhbGxvd1N0cnVjdHMpOwogICAgY29uc3QgZW50cmllc0xlbmd0aCA9IGVudHJpZXMubGVuZ3RoOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzTGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW25hbWUsIHBhcmFtZXRlcnNdID0gZW50cmllc1tpXTsKICAgICAgcmVzb2x2ZWRTdHJ1Y3RzW25hbWVdID0gcmVzb2x2ZVN0cnVjdHMocGFyYW1ldGVycywgc2hhbGxvd1N0cnVjdHMpOwogICAgfQogICAgcmV0dXJuIHJlc29sdmVkU3RydWN0czsKICB9CiAgZnVuY3Rpb24gcmVzb2x2ZVN0cnVjdHMoYWJpUGFyYW1ldGVycywgc3RydWN0cywgYW5jZXN0b3JzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSkgewogICAgY29uc3QgY29tcG9uZW50cyA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gYWJpUGFyYW1ldGVycy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlciA9IGFiaVBhcmFtZXRlcnNbaV07CiAgICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIGlmIChpc1R1cGxlKQogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICBlbHNlIHsKICAgICAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZCh0eXBlV2l0aG91dFR1cGxlUmVnZXgsIGFiaVBhcmFtZXRlci50eXBlKTsKICAgICAgICBpZiAoIW1hdGNoPy50eXBlKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IoeyBhYmlQYXJhbWV0ZXIgfSk7CiAgICAgICAgY29uc3QgeyBhcnJheSwgdHlwZSB9ID0gbWF0Y2g7CiAgICAgICAgaWYgKHR5cGUgaW4gc3RydWN0cykgewogICAgICAgICAgaWYgKGFuY2VzdG9ycy5oYXModHlwZSkpCiAgICAgICAgICAgIHRocm93IG5ldyBDaXJjdWxhclJlZmVyZW5jZUVycm9yKHsgdHlwZSB9KTsKICAgICAgICAgIGNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgICAgIC4uLmFiaVBhcmFtZXRlciwKICAgICAgICAgICAgdHlwZTogYHR1cGxlJHthcnJheSA/PyAiIn1gLAogICAgICAgICAgICBjb21wb25lbnRzOiByZXNvbHZlU3RydWN0cyhzdHJ1Y3RzW3R5cGVdID8/IFtdLCBzdHJ1Y3RzLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbLi4uYW5jZXN0b3JzLCB0eXBlXSkpCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzU29saWRpdHlUeXBlKHR5cGUpKQogICAgICAgICAgICBjb21wb25lbnRzLnB1c2goYWJpUGFyYW1ldGVyKTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgdGhyb3cgbmV3IFVua25vd25UeXBlRXJyb3IoeyB0eXBlIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbXBvbmVudHM7CiAgfQogIHZhciB0eXBlV2l0aG91dFR1cGxlUmVnZXg7CiAgdmFyIGluaXRfc3RydWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3N0cnVjdHMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGluaXRfYWJpSXRlbSgpOwogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZSgpOwogICAgICBpbml0X3N0cnVjdCgpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgICB0eXBlV2l0aG91dFR1cGxlUmVnZXggPSAvXig/PHR5cGU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8kLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMKICBmdW5jdGlvbiBwYXJzZUFiaShzaWduYXR1cmVzKSB7CiAgICBjb25zdCBzdHJ1Y3RzID0gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpOwogICAgY29uc3QgYWJpMiA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHNpZ25hdHVyZXNbaV07CiAgICAgIGlmIChpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpKQogICAgICAgIGNvbnRpbnVlOwogICAgICBhYmkyLnB1c2gocGFyc2VTaWduYXR1cmUoc2lnbmF0dXJlLCBzdHJ1Y3RzKSk7CiAgICB9CiAgICByZXR1cm4gYWJpMjsKICB9CiAgdmFyIGluaXRfcGFyc2VBYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMiKCkgewogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmlJdGVtLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlJdGVtKHNpZ25hdHVyZSkgewogICAgbGV0IGFiaUl0ZW07CiAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gInN0cmluZyIpCiAgICAgIGFiaUl0ZW0gPSBwYXJzZVNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMoc2lnbmF0dXJlKTsKICAgICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZV8gPSBzaWduYXR1cmVbaV07CiAgICAgICAgaWYgKGlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZV8pKQogICAgICAgICAgY29udGludWU7CiAgICAgICAgYWJpSXRlbSA9IHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZV8sIHN0cnVjdHMpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpSXRlbUVycm9yKHsgc2lnbmF0dXJlIH0pOwogICAgcmV0dXJuIGFiaUl0ZW07CiAgfQogIHZhciBpbml0X3BhcnNlQWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGluaXRfc3RydWN0cygpOwogICAgICBpbml0X3V0aWxzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL3BhcnNlQWJpUGFyYW1ldGVyLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlQYXJhbWV0ZXIyKHBhcmFtKSB7CiAgICBsZXQgYWJpUGFyYW1ldGVyOwogICAgaWYgKHR5cGVvZiBwYXJhbSA9PT0gInN0cmluZyIpCiAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCB7CiAgICAgICAgbW9kaWZpZXJzCiAgICAgIH0pOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW0pOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbS5sZW5ndGg7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBwYXJhbVtpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHNpZ25hdHVyZSwgeyBtb2RpZmllcnMsIHN0cnVjdHMgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFiaVBhcmFtZXRlckVycm9yKHsgcGFyYW0gfSk7CiAgICByZXR1cm4gYWJpUGFyYW1ldGVyOwogIH0KICB2YXIgaW5pdF9wYXJzZUFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlci5qcyIoKSB7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlcygpOwogICAgICBpbml0X3N0cnVjdHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMKICBmdW5jdGlvbiBwYXJzZUFiaVBhcmFtZXRlcnMocGFyYW1zKSB7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJzID0gW107CiAgICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNwbGl0UGFyYW1ldGVycyhwYXJhbXMpOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbWV0ZXJzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2ldLCB7IG1vZGlmaWVycyB9KSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW1zKTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHBhcmFtc1tpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzcGxpdFBhcmFtZXRlcnMoc2lnbmF0dXJlKTsKICAgICAgICBjb25zdCBsZW5ndGgyID0gcGFyYW1ldGVycy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBsZW5ndGgyOyBrKyspIHsKICAgICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2tdLCB7IG1vZGlmaWVycywgc3RydWN0cyB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoYWJpUGFyYW1ldGVycy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yKHsgcGFyYW1zIH0pOwogICAgcmV0dXJuIGFiaVBhcmFtZXRlcnM7CiAgfQogIHZhciBpbml0X3BhcnNlQWJpUGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMiKCkgewogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzCiAgdmFyIGluaXRfZXhwb3J0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzIigpIHsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtKCk7CiAgICAgIGluaXRfcGFyc2VBYmkoKTsKICAgICAgaW5pdF9wYXJzZUFiaUl0ZW0oKTsKICAgICAgaW5pdF9wYXJzZUFiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3BhcnNlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9hYmlQYXJhbWV0ZXIoKTsKICAgICAgaW5pdF9zaWduYXR1cmUoKTsKICAgICAgaW5pdF9zcGxpdFBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9zdHJ1Y3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZSA9IGZhbHNlIH0gPSB7fSkgewogICAgaWYgKGFiaUl0ZW0udHlwZSAhPT0gImZ1bmN0aW9uIiAmJiBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIgJiYgYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IoYWJpSXRlbS50eXBlKTsKICAgIHJldHVybiBgJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1zKGFiaUl0ZW0uaW5wdXRzLCB7IGluY2x1ZGVOYW1lIH0pfSlgOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lID0gZmFsc2UgfSA9IHt9KSB7CiAgICBpZiAoIXBhcmFtcykKICAgICAgcmV0dXJuICIiOwogICAgcmV0dXJuIHBhcmFtcy5tYXAoKHBhcmFtKSA9PiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSkuam9pbihpbmNsdWRlTmFtZSA/ICIsICIgOiAiLCIpOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ0dXBsZSIpKSB7CiAgICAgIHJldHVybiBgKCR7Zm9ybWF0QWJpUGFyYW1zKHBhcmFtLmNvbXBvbmVudHMsIHsgaW5jbHVkZU5hbWUgfSl9KSR7cGFyYW0udHlwZS5zbGljZSgidHVwbGUiLmxlbmd0aCl9YDsKICAgIH0KICAgIHJldHVybiBwYXJhbS50eXBlICsgKGluY2x1ZGVOYW1lICYmIHBhcmFtLm5hbWUgPyBgICR7cGFyYW0ubmFtZX1gIDogIiIpOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2Zvcm1hdEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0hleC5qcwogIGZ1bmN0aW9uIGlzSGV4KHZhbHVlLCB7IHN0cmljdCA9IHRydWUgfSA9IHt9KSB7CiAgICBpZiAoIXZhbHVlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0cmljdCA/IC9eMHhbMC05YS1mQS1GXSokLy50ZXN0KHZhbHVlKSA6IHZhbHVlLnN0YXJ0c1dpdGgoIjB4Iik7CiAgfQogIHZhciBpbml0X2lzSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL2lzSGV4LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvc2l6ZS5qcwogIGZ1bmN0aW9uIHNpemUodmFsdWUpIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIpOwogICAgcmV0dXJuIHZhbHVlLmxlbmd0aDsKICB9CiAgdmFyIGluaXRfc2l6ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zaXplLmpzIigpIHsKICAgICAgaW5pdF9pc0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3ZlcnNpb24uanMKICB2YXIgdmVyc2lvbjI7CiAgdmFyIGluaXRfdmVyc2lvbjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbjIgPSAiMi4yMS40MCI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmFzZS5qcwogIGZ1bmN0aW9uIHNldEVycm9yQ29uZmlnKGNvbmZpZykgewogICAgZXJyb3JDb25maWcgPSBjb25maWc7CiAgfQogIGZ1bmN0aW9uIHdhbGsoZXJyLCBmbikgewogICAgaWYgKGZuPy4oZXJyKSkKICAgICAgcmV0dXJuIGVycjsKICAgIGlmIChlcnIgJiYgdHlwZW9mIGVyciA9PT0gIm9iamVjdCIgJiYgImNhdXNlIiBpbiBlcnIgJiYgZXJyLmNhdXNlICE9PSB2b2lkIDApCiAgICAgIHJldHVybiB3YWxrKGVyci5jYXVzZSwgZm4pOwogICAgcmV0dXJuIGZuID8gbnVsbCA6IGVycjsKICB9CiAgdmFyIGVycm9yQ29uZmlnLCBCYXNlRXJyb3IyOwogIHZhciBpbml0X2Jhc2UgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9iYXNlLmpzIigpIHsKICAgICAgaW5pdF92ZXJzaW9uMigpOwogICAgICBlcnJvckNvbmZpZyA9IHsKICAgICAgICBnZXREb2NzVXJsOiAoeyBkb2NzQmFzZVVybCwgZG9jc1BhdGg6IGRvY3NQYXRoOSA9ICIiLCBkb2NzU2x1ZyB9KSA9PiBkb2NzUGF0aDkgPyBgJHtkb2NzQmFzZVVybCA/PyAiaHR0cHM6Ly92aWVtLnNoIn0ke2RvY3NQYXRoOX0ke2RvY3NTbHVnID8gYCMke2RvY3NTbHVnfWAgOiAiIn1gIDogdm9pZCAwLAogICAgICAgIHZlcnNpb246IGB2aWVtQCR7dmVyc2lvbjJ9YAogICAgICB9OwogICAgICBCYXNlRXJyb3IyID0gY2xhc3MgX0Jhc2VFcnJvciBleHRlbmRzIEVycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaG9ydE1lc3NhZ2UsIGFyZ3MgPSB7fSkgewogICAgICAgICAgY29uc3QgZGV0YWlscyA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kZXRhaWxzOwogICAgICAgICAgICBpZiAoYXJncy5jYXVzZT8ubWVzc2FnZSkKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5tZXNzYWdlOwogICAgICAgICAgICByZXR1cm4gYXJncy5kZXRhaWxzOwogICAgICAgICAgfSkoKTsKICAgICAgICAgIGNvbnN0IGRvY3NQYXRoOSA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kb2NzUGF0aCB8fCBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgICByZXR1cm4gYXJncy5kb2NzUGF0aDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBkb2NzVXJsID0gZXJyb3JDb25maWcuZ2V0RG9jc1VybD8uKHsgLi4uYXJncywgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KTsKICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBbCiAgICAgICAgICAgIHNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQuIiwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgIC4uLmFyZ3MubWV0YU1lc3NhZ2VzID8gWy4uLmFyZ3MubWV0YU1lc3NhZ2VzLCAiIl0gOiBbXSwKICAgICAgICAgICAgLi4uZG9jc1VybCA/IFtgRG9jczogJHtkb2NzVXJsfWBdIDogW10sCiAgICAgICAgICAgIC4uLmRldGFpbHMgPyBbYERldGFpbHM6ICR7ZGV0YWlsc31gXSA6IFtdLAogICAgICAgICAgICAuLi5lcnJvckNvbmZpZy52ZXJzaW9uID8gW2BWZXJzaW9uOiAke2Vycm9yQ29uZmlnLnZlcnNpb259YF0gOiBbXQogICAgICAgICAgXS5qb2luKCJcbiIpOwogICAgICAgICAgc3VwZXIobWVzc2FnZSwgYXJncy5jYXVzZSA/IHsgY2F1c2U6IGFyZ3MuY2F1c2UgfSA6IHZvaWQgMCk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkb2NzUGF0aCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm1ldGFNZXNzYWdlcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNob3J0TWVzc2FnZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInZlcnNpb24iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkJhc2VFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5uYW1lID0gYXJncy5uYW1lID8/IHRoaXMubmFtZTsKICAgICAgICAgIHRoaXMuc2hvcnRNZXNzYWdlID0gc2hvcnRNZXNzYWdlOwogICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjI7CiAgICAgICAgfQogICAgICAgIHdhbGsoZm4pIHsKICAgICAgICAgIHJldHVybiB3YWxrKHRoaXMsIGZuKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYWJpLmpzCiAgdmFyIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvciwgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciwgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yLCBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvciwgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yLCBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IsIEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvciwgQWJpRXJyb3JOb3RGb3VuZEVycm9yLCBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsIEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlFdmVudE5vdEZvdW5kRXJyb3IsIEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25PdXRwdXRzTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlJdGVtQW1iaWd1aXR5RXJyb3IsIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsIERlY29kZUxvZ0RhdGFNaXNtYXRjaCwgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gsIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciwgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yLCBJbnZhbGlkQXJyYXlFcnJvciwgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IsIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZTsKICB2YXIgaW5pdF9hYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hYmkuanMiKCkgewogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICAiQSBjb25zdHJ1Y3RvciB3YXMgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgY29uc3RydWN0b3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJDb25zdHJ1Y3RvciBhcmd1bWVudHMgd2VyZSBwcm92aWRlZCAoYGFyZ3NgKSwgYnV0IGEgY29uc3RydWN0b3IgcGFyYW1ldGVycyAoYGlucHV0c2ApIHdlcmUgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSwgYW5kIHRoYXQgdGhlIGBpbnB1dHNgIGF0dHJpYnV0ZSBvbiB0aGUgY29uc3RydWN0b3IgZXhpc3RzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyBpbnZhbGlkLmAsCiAgICAgICAgICAgICJTaXplIG11c3QgYmUgaW4gaW5jcmVtZW50cyBvZiAzMiBieXRlcyAoc2l6ZSAlIDMyID09PSAwKS4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYERhdGE6ICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWBdLAogICAgICAgICAgICBuYW1lOiAiQWJpRGVjb2RpbmdEYXRhU2l6ZUludmFsaWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZGF0YSwgcGFyYW1zLCBzaXplOiBzaXplMyB9KSB7CiAgICAgICAgICBzdXBlcihbYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIGdpdmVuIHBhcmFtZXRlcnMuYF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgUGFyYW1zOiAoJHtmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSlgLAogICAgICAgICAgICAgIGBEYXRhOiAgICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWAKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJwYXJhbXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICAgICAgICAgIHRoaXMuc2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKCdDYW5ub3QgZGVjb2RlIHplcm8gZGF0YSAoIjB4Iikgd2l0aCBBQkkgcGFyYW1ldGVycy4nLCB7CiAgICAgICAgICAgIG5hbWU6ICJBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkTGVuZ3RoLCBnaXZlbkxlbmd0aCwgdHlwZSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBQkkgZW5jb2RpbmcgYXJyYXkgbGVuZ3RoIG1pc21hdGNoIGZvciB0eXBlICR7dHlwZX0uYCwKICAgICAgICAgICAgYEV4cGVjdGVkIGxlbmd0aDogJHtleHBlY3RlZExlbmd0aH1gLAogICAgICAgICAgICBgR2l2ZW4gbGVuZ3RoOiAke2dpdmVuTGVuZ3RofWAKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgb2YgYnl0ZXMgIiR7dmFsdWV9IiAoYnl0ZXMke3NpemUodmFsdWUpfSkgZG9lcyBub3QgbWF0Y2ggZXhwZWN0ZWQgc2l6ZSAoYnl0ZXMke2V4cGVjdGVkU2l6ZX0pLmAsIHsgbmFtZTogIkFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZXhwZWN0ZWRMZW5ndGgsIGdpdmVuTGVuZ3RoIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkFCSSBlbmNvZGluZyBwYXJhbXMvdmFsdWVzIGxlbmd0aCBtaXNtYXRjaC4iLAogICAgICAgICAgICBgRXhwZWN0ZWQgbGVuZ3RoIChwYXJhbXMpOiAke2V4cGVjdGVkTGVuZ3RofWAsCiAgICAgICAgICAgIGBHaXZlbiBsZW5ndGggKHZhbHVlcyk6ICR7Z2l2ZW5MZW5ndGh9YAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBcmd1bWVudHMgKFxgYXJnc1xgKSB3ZXJlIHByb3ZpZGVkIHRvICIke2Vycm9yTmFtZX0iLCBidXQgIiR7ZXJyb3JOYW1lfSIgb24gdGhlIEFCSSBkb2VzIG5vdCBjb250YWluIGFueSBwYXJhbWV0ZXJzIChcYGlucHV0c1xgKS5gLAogICAgICAgICAgICAiQ2Fubm90IGVuY29kZSBlcnJvciByZXN1bHQgd2l0aG91dCBrbm93aW5nIHdoYXQgdGhlIHBhcmFtZXRlciB0eXBlcyBhcmUuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgaW5wdXRzIGV4aXN0IG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGVycm9yTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXJyb3IgJHtlcnJvck5hbWUgPyBgIiR7ZXJyb3JOYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHNpZ25hdHVyZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYEVuY29kZWQgZXJyb3Igc2lnbmF0dXJlICIke3NpZ25hdHVyZX0iIG5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIsCiAgICAgICAgICAgIGBZb3UgY2FuIGxvb2sgdXAgdGhlIGRlY29kZWQgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaWduYXR1cmUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGV4dHJhY3QgZXZlbnQgc2lnbmF0dXJlIGZyb20gZW1wdHkgdG9waWNzLiIsIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaWduYXR1cmUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFbmNvZGVkIGV2ZW50IHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBub3QgZm91bmQgb24gQUJJLmAsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGV2ZW50IGV4aXN0cyBvbiBpdC4iLAogICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBzaWduYXR1cmUgaGVyZTogaHR0cHM6Ly9vcGVuY2hhaW4ueHl6L3NpZ25hdHVyZXM/cXVlcnk9JHtzaWduYXR1cmV9LmAKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXZlbnQgJHtldmVudE5hbWUgPyBgIiR7ZXZlbnROYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXZlbnQgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnROb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRnVuY3Rpb24gJHtmdW5jdGlvbk5hbWUgPyBgIiR7ZnVuY3Rpb25OYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZnVuY3Rpb24gZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBGdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiBkb2VzIG5vdCBjb250YWluIGFueSBcYG91dHB1dHNcYCBvbiBBQkkuYCwKICAgICAgICAgICAgIkNhbm5vdCBkZWNvZGUgZnVuY3Rpb24gcmVzdWx0IHdpdGhvdXQga25vd2luZyB3aGF0IHRoZSBwYXJhbWV0ZXIgdHlwZXMgYXJlLiIsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGZ1bmN0aW9uIGV4aXN0cyBvbiBpdC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRW5jb2RlZCBmdW5jdGlvbiBzaWduYXR1cmUgIiR7c2lnbmF0dXJlfSIgbm90IGZvdW5kIG9uIEFCSS5gLAogICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBmdW5jdGlvbiBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgYFlvdSBjYW4gbG9vayB1cCB0aGUgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpSXRlbUFtYmlndWl0eUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih4LCB5KSB7CiAgICAgICAgICBzdXBlcigiRm91bmQgYW1iaWd1b3VzIHR5cGVzIGluIG92ZXJsb2FkZWQgQUJJIGl0ZW1zLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYFxgJHt4LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHguYWJpSXRlbSl9XGAsIGFuZGAsCiAgICAgICAgICAgICAgYFxgJHt5LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHkuYWJpSXRlbSl9XGBgLAogICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICJUaGVzZSB0eXBlcyBlbmNvZGUgZGlmZmVyZW50bHkgYW5kIGNhbm5vdCBiZSBkaXN0aW5ndWlzaGVkIGF0IHJ1bnRpbWUuIiwKICAgICAgICAgICAgICAiUmVtb3ZlIG9uZSBvZiB0aGUgYW1iaWd1b3VzIGl0ZW1zIGluIHRoZSBBQkkuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQWJpSXRlbUFtYmlndWl0eUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgZ2l2ZW5TaXplIH0pIHsKICAgICAgICAgIHN1cGVyKGBFeHBlY3RlZCBieXRlcyR7ZXhwZWN0ZWRTaXplfSwgZ290IGJ5dGVzJHtnaXZlblNpemV9LmAsIHsKICAgICAgICAgICAgbmFtZTogIkJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIERlY29kZUxvZ0RhdGFNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBkYXRhLCBwYXJhbXMsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIG5vbi1pbmRleGVkIGV2ZW50IHBhcmFtZXRlcnMuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBQYXJhbXM6ICgke2Zvcm1hdEFiaVBhcmFtcyhwYXJhbXMsIHsgaW5jbHVkZU5hbWU6IHRydWUgfSl9KWAsCiAgICAgICAgICAgICAgYERhdGE6ICAgJHtkYXRhfSAoJHtzaXplM30gYnl0ZXMpYAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiRGVjb2RlTG9nRGF0YU1pc21hdGNoIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkYXRhIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyYW1zIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2l6ZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaUl0ZW0gPSBhYmlJdGVtOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwogICAgICAgICAgdGhpcy5zaXplID0gc2l6ZTM7CiAgICAgICAgfQogICAgICB9OwogICAgICBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFeHBlY3RlZCBhIHRvcGljIGZvciBpbmRleGVkIGV2ZW50IHBhcmFtZXRlciR7cGFyYW0ubmFtZSA/IGAgIiR7cGFyYW0ubmFtZX0iYCA6ICIifSBvbiBldmVudCAiJHtmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSIuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCIgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5hYmlJdGVtID0gYWJpSXRlbTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGVuY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRW5jb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRGVjb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBcnJheUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkgewogICAgICAgICAgc3VwZXIoW2BWYWx1ZSAiJHt2YWx1ZX0iIGlzIG5vdCBhIHZhbGlkIGFycmF5LmBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBcnJheUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlZmluaXRpb24gdHlwZS5gLAogICAgICAgICAgICAnVmFsaWQgdHlwZXM6ICJmdW5jdGlvbiIsICJldmVudCIsICJlcnJvciInCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsgbmFtZTogIkludmFsaWREZWZpbml0aW9uVHlwZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZSA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHBhY2tlZCBlbmNvZGluZy5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZGF0YS5qcwogIHZhciBTbGljZU9mZnNldE91dE9mQm91bmRzRXJyb3IsIFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3I7CiAgdmFyIGluaXRfZGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2RhdGEuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCwgcG9zaXRpb24sIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTbGljZSAke3Bvc2l0aW9uID09PSAic3RhcnQiID8gInN0YXJ0aW5nIiA6ICJlbmRpbmcifSBhdCBvZmZzZXQgIiR7b2Zmc2V0fSIgaXMgb3V0LW9mLWJvdW5kcyAoc2l6ZTogJHtzaXplM30pLmAsIHsgbmFtZTogIlNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gc2l6ZSAoJHtzaXplM30pIGV4Y2VlZHMgcGFkZGluZyBzaXplICgke3RhcmdldFNpemV9KS5gLCB7IG5hbWU6ICJTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gaXMgZXhwZWN0ZWQgdG8gYmUgJHt0YXJnZXRTaXplfSAke3R5cGV9IGxvbmcsIGJ1dCBpcyAke3NpemUzfSAke3R5cGV9IGxvbmcuYCwgeyBuYW1lOiAiSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvcGFkLmpzCiAgZnVuY3Rpb24gcGFkKGhleE9yQnl0ZXMsIHsgZGlyLCBzaXplOiBzaXplMyA9IDMyIH0gPSB7fSkgewogICAgaWYgKHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHBhZEhleChoZXhPckJ5dGVzLCB7IGRpciwgc2l6ZTogc2l6ZTMgfSk7CiAgICByZXR1cm4gcGFkQnl0ZXMoaGV4T3JCeXRlcywgeyBkaXIsIHNpemU6IHNpemUzIH0pOwogIH0KICBmdW5jdGlvbiBwYWRIZXgoaGV4XywgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBoZXhfOwogICAgY29uc3QgaGV4ID0gaGV4Xy5yZXBsYWNlKCIweCIsICIiKTsKICAgIGlmIChoZXgubGVuZ3RoID4gc2l6ZTMgKiAyKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBNYXRoLmNlaWwoaGV4Lmxlbmd0aCAvIDIpLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJoZXgiCiAgICAgIH0pOwogICAgcmV0dXJuIGAweCR7aGV4W2RpciA9PT0gInJpZ2h0IiA/ICJwYWRFbmQiIDogInBhZFN0YXJ0Il0oc2l6ZTMgKiAyLCAiMCIpfWA7CiAgfQogIGZ1bmN0aW9uIHBhZEJ5dGVzKGJ5dGVzMiwgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBieXRlczI7CiAgICBpZiAoYnl0ZXMyLmxlbmd0aCA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBieXRlczIubGVuZ3RoLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgfSk7CiAgICBjb25zdCBwYWRkZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KHNpemUzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTM7IGkrKykgewogICAgICBjb25zdCBwYWRFbmQgPSBkaXIgPT09ICJyaWdodCI7CiAgICAgIHBhZGRlZEJ5dGVzW3BhZEVuZCA/IGkgOiBzaXplMyAtIGkgLSAxXSA9IGJ5dGVzMltwYWRFbmQgPyBpIDogYnl0ZXMyLmxlbmd0aCAtIGkgLSAxXTsKICAgIH0KICAgIHJldHVybiBwYWRkZWRCeXRlczsKICB9CiAgdmFyIGluaXRfcGFkID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3BhZC5qcyIoKSB7CiAgICAgIGluaXRfZGF0YSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2VuY29kaW5nLmpzCiAgdmFyIEludGVnZXJPdXRPZlJhbmdlRXJyb3IsIEludmFsaWRCeXRlc0Jvb2xlYW5FcnJvciwgSW52YWxpZEhleEJvb2xlYW5FcnJvciwgSW52YWxpZEhleFZhbHVlRXJyb3IsIFNpemVPdmVyZmxvd0Vycm9yOwogIHZhciBpbml0X2VuY29kaW5nID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZW5jb2RpbmcuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW50ZWdlck91dE9mUmFuZ2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBtYXgsIG1pbiwgc2lnbmVkLCBzaXplOiBzaXplMywgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYE51bWJlciAiJHt2YWx1ZX0iIGlzIG5vdCBpbiBzYWZlICR7c2l6ZTMgPyBgJHtzaXplMyAqIDh9LWJpdCAke3NpZ25lZCA/ICJzaWduZWQiIDogInVuc2lnbmVkIn0gYCA6ICIifWludGVnZXIgcmFuZ2UgJHttYXggPyBgKCR7bWlufSB0byAke21heH0pYCA6IGAoYWJvdmUgJHttaW59KWB9YCwgeyBuYW1lOiAiSW50ZWdlck91dE9mUmFuZ2VFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGJ5dGVzMikgewogICAgICAgICAgc3VwZXIoYEJ5dGVzIHZhbHVlICIke2J5dGVzMn0iIGlzIG5vdCBhIHZhbGlkIGJvb2xlYW4uIFRoZSBieXRlcyBhcnJheSBtdXN0IGNvbnRhaW4gYSBzaW5nbGUgYnl0ZSBvZiBlaXRoZXIgYSAwIG9yIDEgdmFsdWUuYCwgewogICAgICAgICAgICBuYW1lOiAiSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihoZXgpIHsKICAgICAgICAgIHN1cGVyKGBIZXggdmFsdWUgIiR7aGV4fSIgaXMgbm90IGEgdmFsaWQgYm9vbGVhbi4gVGhlIGhleCB2YWx1ZSBtdXN0IGJlICIweDAiIChmYWxzZSkgb3IgIjB4MSIgKHRydWUpLmAsIHsgbmFtZTogIkludmFsaWRIZXhCb29sZWFuRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEhleFZhbHVlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7CiAgICAgICAgICBzdXBlcihgSGV4IHZhbHVlICIke3ZhbHVlfSIgaXMgYW4gb2RkIGxlbmd0aCAoJHt2YWx1ZS5sZW5ndGh9KS4gSXQgbXVzdCBiZSBhbiBldmVuIGxlbmd0aC5gLCB7IG5hbWU6ICJJbnZhbGlkSGV4VmFsdWVFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplT3ZlcmZsb3dFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBnaXZlblNpemUsIG1heFNpemUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgY2Fubm90IGV4Y2VlZCAke21heFNpemV9IGJ5dGVzLiBHaXZlbiBzaXplOiAke2dpdmVuU2l6ZX0gYnl0ZXMuYCwgeyBuYW1lOiAiU2l6ZU92ZXJmbG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvdHJpbS5qcwogIGZ1bmN0aW9uIHRyaW0oaGV4T3JCeXRlcywgeyBkaXIgPSAibGVmdCIgfSA9IHt9KSB7CiAgICBsZXQgZGF0YSA9IHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIiA/IGhleE9yQnl0ZXMucmVwbGFjZSgiMHgiLCAiIikgOiBoZXhPckJ5dGVzOwogICAgbGV0IHNsaWNlTGVuZ3RoID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgaWYgKGRhdGFbZGlyID09PSAibGVmdCIgPyBpIDogZGF0YS5sZW5ndGggLSBpIC0gMV0udG9TdHJpbmcoKSA9PT0gIjAiKQogICAgICAgIHNsaWNlTGVuZ3RoKys7CiAgICAgIGVsc2UKICAgICAgICBicmVhazsKICAgIH0KICAgIGRhdGEgPSBkaXIgPT09ICJsZWZ0IiA/IGRhdGEuc2xpY2Uoc2xpY2VMZW5ndGgpIDogZGF0YS5zbGljZSgwLCBkYXRhLmxlbmd0aCAtIHNsaWNlTGVuZ3RoKTsKICAgIGlmICh0eXBlb2YgaGV4T3JCeXRlcyA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKGRhdGEubGVuZ3RoID09PSAxICYmIGRpciA9PT0gInJpZ2h0IikKICAgICAgICBkYXRhID0gYCR7ZGF0YX0wYDsKICAgICAgcmV0dXJuIGAweCR7ZGF0YS5sZW5ndGggJSAyID09PSAxID8gYDAke2RhdGF9YCA6IGRhdGF9YDsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICB2YXIgaW5pdF90cmltID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3RyaW0uanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUhleC5qcwogIGZ1bmN0aW9uIGFzc2VydFNpemUoaGV4T3JCeXRlcywgeyBzaXplOiBzaXplMyB9KSB7CiAgICBpZiAoc2l6ZShoZXhPckJ5dGVzKSA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZU92ZXJmbG93RXJyb3IoewogICAgICAgIGdpdmVuU2l6ZTogc2l6ZShoZXhPckJ5dGVzKSwKICAgICAgICBtYXhTaXplOiBzaXplMwogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gZnJvbUhleChoZXgsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBoZXhUb051bWJlcihoZXgsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gaGV4VG9TdHJpbmcoaGV4LCBvcHRzKTsKICAgIGlmICh0byA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gaGV4VG9Cb29sKGhleCwgb3B0cyk7CiAgICByZXR1cm4gaGV4VG9CeXRlcyhoZXgsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBoZXhUb0JpZ0ludChoZXgsIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQgfSA9IG9wdHM7CiAgICBpZiAob3B0cy5zaXplKQogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICBjb25zdCB2YWx1ZSA9IEJpZ0ludChoZXgpOwogICAgaWYgKCFzaWduZWQpCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIGNvbnN0IHNpemUzID0gKGhleC5sZW5ndGggLSAyKSAvIDI7CiAgICBjb25zdCBtYXggPSAoMW4gPDwgQmlnSW50KHNpemUzKSAqIDhuIC0gMW4pIC0gMW47CiAgICBpZiAodmFsdWUgPD0gbWF4KQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgLSBCaWdJbnQoYDB4JHsiZiIucGFkU3RhcnQoc2l6ZTMgKiAyLCAiZiIpfWApIC0gMW47CiAgfQogIGZ1bmN0aW9uIGhleFRvQm9vbChoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHRyaW0oaGV4KTsKICAgIH0KICAgIGlmICh0cmltKGhleCkgPT09ICIweDAwIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKHRyaW0oaGV4KSA9PT0gIjB4MDEiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHRocm93IG5ldyBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yKGhleCk7CiAgfQogIGZ1bmN0aW9uIGhleFRvTnVtYmVyKGhleCwgb3B0cyA9IHt9KSB7CiAgICByZXR1cm4gTnVtYmVyKGhleFRvQmlnSW50KGhleCwgb3B0cykpOwogIH0KICBmdW5jdGlvbiBoZXhUb1N0cmluZyhoZXgsIG9wdHMgPSB7fSkgewogICAgbGV0IGJ5dGVzMiA9IGhleFRvQnl0ZXMoaGV4KTsKICAgIGlmIChvcHRzLnNpemUpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21IZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21IZXguanMiKCkgewogICAgICBpbml0X2VuY29kaW5nKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcwogIGZ1bmN0aW9uIHRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiIHx8IHR5cGVvZiB2YWx1ZSA9PT0gImJpZ2ludCIpCiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgb3B0cyk7CiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gc3RyaW5nVG9IZXgodmFsdWUsIG9wdHMpOwogICAgfQogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvSGV4KHZhbHVlLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgZnVuY3Rpb24gYm9vbFRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IGhleCA9IGAweCR7TnVtYmVyKHZhbHVlKX1gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgfQogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb0hleCh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBsZXQgc3RyaW5nID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIHN0cmluZyArPSBoZXhlc1t2YWx1ZVtpXV07CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgke3N0cmluZ31gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleCh2YWx1ZV8sIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQsIHNpemU6IHNpemUzIH0gPSBvcHRzOwogICAgY29uc3QgdmFsdWUgPSBCaWdJbnQodmFsdWVfKTsKICAgIGxldCBtYXhWYWx1ZTsKICAgIGlmIChzaXplMykgewogICAgICBpZiAoc2lnbmVkKQogICAgICAgIG1heFZhbHVlID0gKDFuIDw8IEJpZ0ludChzaXplMykgKiA4biAtIDFuKSAtIDFuOwogICAgICBlbHNlCiAgICAgICAgbWF4VmFsdWUgPSAybiAqKiAoQmlnSW50KHNpemUzKSAqIDhuKSAtIDFuOwogICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWVfID09PSAibnVtYmVyIikgewogICAgICBtYXhWYWx1ZSA9IEJpZ0ludChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7CiAgICB9CiAgICBjb25zdCBtaW5WYWx1ZSA9IHR5cGVvZiBtYXhWYWx1ZSA9PT0gImJpZ2ludCIgJiYgc2lnbmVkID8gLW1heFZhbHVlIC0gMW4gOiAwOwogICAgaWYgKG1heFZhbHVlICYmIHZhbHVlID4gbWF4VmFsdWUgfHwgdmFsdWUgPCBtaW5WYWx1ZSkgewogICAgICBjb25zdCBzdWZmaXggPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/ICJuIiA6ICIiOwogICAgICB0aHJvdyBuZXcgSW50ZWdlck91dE9mUmFuZ2VFcnJvcih7CiAgICAgICAgbWF4OiBtYXhWYWx1ZSA/IGAke21heFZhbHVlfSR7c3VmZml4fWAgOiB2b2lkIDAsCiAgICAgICAgbWluOiBgJHttaW5WYWx1ZX0ke3N1ZmZpeH1gLAogICAgICAgIHNpZ25lZCwKICAgICAgICBzaXplOiBzaXplMywKICAgICAgICB2YWx1ZTogYCR7dmFsdWVffSR7c3VmZml4fWAKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgkeyhzaWduZWQgJiYgdmFsdWUgPCAwID8gKDFuIDw8IEJpZ0ludChzaXplMyAqIDgpKSArIEJpZ0ludCh2YWx1ZSkgOiB2YWx1ZSkudG9TdHJpbmcoMTYpfWA7CiAgICBpZiAoc2l6ZTMpCiAgICAgIHJldHVybiBwYWQoaGV4LCB7IHNpemU6IHNpemUzIH0pOwogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9IZXgodmFsdWVfLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IHZhbHVlID0gZW5jb2Rlci5lbmNvZGUodmFsdWVfKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgdmFyIGhleGVzLCBlbmNvZGVyOwogIHZhciBpbml0X3RvSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcyIoKSB7CiAgICAgIGluaXRfZW5jb2RpbmcoKTsKICAgICAgaW5pdF9wYWQoKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGhleGVzID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoX3YsIGkpID0+IGkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIikpOwogICAgICBlbmNvZGVyID0gLyogQF9fUFVSRV9fICovIG5ldyBUZXh0RW5jb2RlcigpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvdG9CeXRlcy5qcwogIGZ1bmN0aW9uIHRvQnl0ZXModmFsdWUsIG9wdHMgPSB7fSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgfHwgdHlwZW9mIHZhbHVlID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIG51bWJlclRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKGlzSGV4KHZhbHVlKSkKICAgICAgcmV0dXJuIGhleFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModmFsdWUsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBib29sVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBuZXcgVWludDhBcnJheSgxKTsKICAgIGJ5dGVzMlswXSA9IE51bWJlcih2YWx1ZSk7CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSA9PT0gIm51bWJlciIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICByZXR1cm4gcGFkKGJ5dGVzMiwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICBmdW5jdGlvbiBjaGFyQ29kZVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLnplcm8gJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5uaW5lKQogICAgICByZXR1cm4gY2hhciAtIGNoYXJDb2RlTWFwLnplcm87CiAgICBpZiAoY2hhciA+PSBjaGFyQ29kZU1hcC5BICYmIGNoYXIgPD0gY2hhckNvZGVNYXAuRikKICAgICAgcmV0dXJuIGNoYXIgLSAoY2hhckNvZGVNYXAuQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLmEgJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5mKQogICAgICByZXR1cm4gY2hhciAtIChjaGFyQ29kZU1hcC5hIC0gMTApOwogICAgcmV0dXJuIHZvaWQgMDsKICB9CiAgZnVuY3Rpb24gaGV4VG9CeXRlcyhoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICBsZXQgaGV4U3RyaW5nID0gaGV4LnNsaWNlKDIpOwogICAgaWYgKGhleFN0cmluZy5sZW5ndGggJSAyKQogICAgICBoZXhTdHJpbmcgPSBgMCR7aGV4U3RyaW5nfWA7CiAgICBjb25zdCBsZW5ndGggPSBoZXhTdHJpbmcubGVuZ3RoIC8gMjsKICAgIGNvbnN0IGJ5dGVzMiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICBmb3IgKGxldCBpbmRleDIgPSAwLCBqID0gMDsgaW5kZXgyIDwgbGVuZ3RoOyBpbmRleDIrKykgewogICAgICBjb25zdCBuaWJibGVMZWZ0ID0gY2hhckNvZGVUb0Jhc2UxNihoZXhTdHJpbmcuY2hhckNvZGVBdChqKyspKTsKICAgICAgY29uc3QgbmliYmxlUmlnaHQgPSBjaGFyQ29kZVRvQmFzZTE2KGhleFN0cmluZy5jaGFyQ29kZUF0KGorKykpOwogICAgICBpZiAobmliYmxlTGVmdCA9PT0gdm9pZCAwIHx8IG5pYmJsZVJpZ2h0ID09PSB2b2lkIDApIHsKICAgICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBieXRlIHNlcXVlbmNlICgiJHtoZXhTdHJpbmdbaiAtIDJdfSR7aGV4U3RyaW5nW2ogLSAxXX0iIGluICIke2hleFN0cmluZ30iKS5gKTsKICAgICAgfQogICAgICBieXRlczJbaW5kZXgyXSA9IG5pYmJsZUxlZnQgKiAxNiArIG5pYmJsZVJpZ2h0OwogICAgfQogICAgcmV0dXJuIGJ5dGVzMjsKICB9CiAgZnVuY3Rpb24gbnVtYmVyVG9CeXRlcyh2YWx1ZSwgb3B0cykgewogICAgY29uc3QgaGV4ID0gbnVtYmVyVG9IZXgodmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoaGV4KTsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBlbmNvZGVyMi5lbmNvZGUodmFsdWUpOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChieXRlczIsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICB2YXIgZW5jb2RlcjIsIGNoYXJDb2RlTWFwOwogIHZhciBpbml0X3RvQnl0ZXMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvQnl0ZXMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X2Zyb21IZXgoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgICBlbmNvZGVyMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVGV4dEVuY29kZXIoKTsKICAgICAgY2hhckNvZGVNYXAgPSB7CiAgICAgICAgemVybzogNDgsCiAgICAgICAgbmluZTogNTcsCiAgICAgICAgQTogNjUsCiAgICAgICAgRjogNzAsCiAgICAgICAgYTogOTcsCiAgICAgICAgZjogMTAyCiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzCiAgZnVuY3Rpb24gbnVtYmVyKG4pIHsKICAgIGlmICghTnVtYmVyLmlzU2FmZUludGVnZXIobikgfHwgbiA8IDApCiAgICAgIHRocm93IG5ldyBFcnJvcihgcG9zaXRpdmUgaW50ZWdlciBleHBlY3RlZCwgbm90ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gaXNCeXRlcyhhKSB7CiAgICByZXR1cm4gYSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgYSAhPSBudWxsICYmIHR5cGVvZiBhID09PSAib2JqZWN0IiAmJiBhLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CiAgZnVuY3Rpb24gYnl0ZXMoYiwgLi4ubGVuZ3RocykgewogICAgaWYgKCFpc0J5dGVzKGIpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIlVpbnQ4QXJyYXkgZXhwZWN0ZWQiKTsKICAgIGlmIChsZW5ndGhzLmxlbmd0aCA+IDAgJiYgIWxlbmd0aHMuaW5jbHVkZXMoYi5sZW5ndGgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYFVpbnQ4QXJyYXkgZXhwZWN0ZWQgb2YgbGVuZ3RoICR7bGVuZ3Roc30sIG5vdCBvZiBsZW5ndGg9JHtiLmxlbmd0aH1gKTsKICB9CiAgZnVuY3Rpb24gaGFzaChoKSB7CiAgICBpZiAodHlwZW9mIGggIT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mIGguY3JlYXRlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggc2hvdWxkIGJlIHdyYXBwZWQgYnkgdXRpbHMud3JhcENvbnN0cnVjdG9yIik7CiAgICBudW1iZXIoaC5vdXRwdXRMZW4pOwogICAgbnVtYmVyKGguYmxvY2tMZW4pOwogIH0KICBmdW5jdGlvbiBleGlzdHMoaW5zdGFuY2UsIGNoZWNrRmluaXNoZWQgPSB0cnVlKSB7CiAgICBpZiAoaW5zdGFuY2UuZGVzdHJveWVkKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggaW5zdGFuY2UgaGFzIGJlZW4gZGVzdHJveWVkIik7CiAgICBpZiAoY2hlY2tGaW5pc2hlZCAmJiBpbnN0YW5jZS5maW5pc2hlZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJIYXNoI2RpZ2VzdCgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIik7CiAgfQogIGZ1bmN0aW9uIG91dHB1dChvdXQsIGluc3RhbmNlKSB7CiAgICBieXRlcyhvdXQpOwogICAgY29uc3QgbWluID0gaW5zdGFuY2Uub3V0cHV0TGVuOwogICAgaWYgKG91dC5sZW5ndGggPCBtaW4pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBkaWdlc3RJbnRvKCkgZXhwZWN0cyBvdXRwdXQgYnVmZmVyIG9mIGxlbmd0aCBhdCBsZWFzdCAke21pbn1gKTsKICAgIH0KICB9CiAgdmFyIGluaXRfYXNzZXJ0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL191NjQuanMKICBmdW5jdGlvbiBmcm9tQmlnKG4sIGxlID0gZmFsc2UpIHsKICAgIGlmIChsZSkKICAgICAgcmV0dXJuIHsgaDogTnVtYmVyKG4gJiBVMzJfTUFTSzY0KSwgbDogTnVtYmVyKG4gPj4gXzMybiAmIFUzMl9NQVNLNjQpIH07CiAgICByZXR1cm4geyBoOiBOdW1iZXIobiA+PiBfMzJuICYgVTMyX01BU0s2NCkgfCAwLCBsOiBOdW1iZXIobiAmIFUzMl9NQVNLNjQpIHwgMCB9OwogIH0KICBmdW5jdGlvbiBzcGxpdChsc3QsIGxlID0gZmFsc2UpIHsKICAgIGxldCBBaCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGxldCBBbCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbHN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgaCwgbCB9ID0gZnJvbUJpZyhsc3RbaV0sIGxlKTsKICAgICAgW0FoW2ldLCBBbFtpXV0gPSBbaCwgbF07CiAgICB9CiAgICByZXR1cm4gW0FoLCBBbF07CiAgfQogIHZhciBVMzJfTUFTSzY0LCBfMzJuLCByb3RsU0gsIHJvdGxTTCwgcm90bEJILCByb3RsQkw7CiAgdmFyIGluaXRfdTY0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fdTY0LmpzIigpIHsKICAgICAgVTMyX01BU0s2NCA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMiAqKiAzMiAtIDEpOwogICAgICBfMzJuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgzMik7CiAgICAgIHJvdGxTSCA9IChoLCBsLCBzKSA9PiBoIDw8IHMgfCBsID4+PiAzMiAtIHM7CiAgICAgIHJvdGxTTCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgfCBoID4+PiAzMiAtIHM7CiAgICAgIHJvdGxCSCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgLSAzMiB8IGggPj4+IDY0IC0gczsKICAgICAgcm90bEJMID0gKGgsIGwsIHMpID0+IGggPDwgcyAtIDMyIHwgbCA+Pj4gNjQgLSBzOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vY3J5cHRvLmpzCiAgdmFyIGNyeXB0bzsKICB2YXIgaW5pdF9jcnlwdG8gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2NyeXB0by5qcyIoKSB7CiAgICAgIGNyeXB0byA9IHR5cGVvZiBnbG9iYWxUaGlzID09PSAib2JqZWN0IiAmJiAiY3J5cHRvIiBpbiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcy5jcnlwdG8gOiB2b2lkIDA7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS91dGlscy5qcwogIGZ1bmN0aW9uIGJ5dGVTd2FwMzIoYXJyKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBieXRlU3dhcChhcnJbaV0pOwogICAgfQogIH0KICBmdW5jdGlvbiB1dGY4VG9CeXRlcyhzdHIpIHsKICAgIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKGB1dGY4VG9CeXRlcyBleHBlY3RlZCBzdHJpbmcsIGdvdCAke3R5cGVvZiBzdHJ9YCk7CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHN0cikpOwogIH0KICBmdW5jdGlvbiB0b0J5dGVzMihkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKQogICAgICBkYXRhID0gdXRmOFRvQnl0ZXMoZGF0YSk7CiAgICBieXRlcyhkYXRhKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlcyguLi5hcnJheXMpIHsKICAgIGxldCBzdW0gPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgYnl0ZXMoYSk7CiAgICAgIHN1bSArPSBhLmxlbmd0aDsKICAgIH0KICAgIGNvbnN0IHJlcyA9IG5ldyBVaW50OEFycmF5KHN1bSk7CiAgICBmb3IgKGxldCBpID0gMCwgcGFkMiA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgcmVzLnNldChhLCBwYWQyKTsKICAgICAgcGFkMiArPSBhLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHdyYXBDb25zdHJ1Y3RvcihoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnKSA9PiBoYXNoQ29ucygpLnVwZGF0ZSh0b0J5dGVzMihtc2cpKS5kaWdlc3QoKTsKICAgIGNvbnN0IHRtcCA9IGhhc2hDb25zKCk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAoKSA9PiBoYXNoQ29ucygpOwogICAgcmV0dXJuIGhhc2hDOwogIH0KICBmdW5jdGlvbiB3cmFwWE9GQ29uc3RydWN0b3JXaXRoT3B0cyhoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnLCBvcHRzKSA9PiBoYXNoQ29ucyhvcHRzKS51cGRhdGUodG9CeXRlczIobXNnKSkuZGlnZXN0KCk7CiAgICBjb25zdCB0bXAgPSBoYXNoQ29ucyh7fSk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAob3B0cykgPT4gaGFzaENvbnMob3B0cyk7CiAgICByZXR1cm4gaGFzaEM7CiAgfQogIGZ1bmN0aW9uIHJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoID0gMzIpIHsKICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoYnl0ZXNMZW5ndGgpKTsKICAgIH0KICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5yYW5kb21CeXRlcyA9PT0gImZ1bmN0aW9uIikgewogICAgICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoKTsKICAgIH0KICAgIHRocm93IG5ldyBFcnJvcigiY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtdXN0IGJlIGRlZmluZWQiKTsKICB9CiAgdmFyIHUzMiwgY3JlYXRlVmlldywgcm90ciwgcm90bCwgaXNMRSwgYnl0ZVN3YXAsIEhhc2gsIHRvU3RyOwogIHZhciBpbml0X3V0aWxzMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vdXRpbHMuanMiKCkgewogICAgICBpbml0X2NyeXB0bygpOwogICAgICBpbml0X2Fzc2VydCgpOwogICAgICB1MzIgPSAoYXJyKSA9PiBuZXcgVWludDMyQXJyYXkoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIE1hdGguZmxvb3IoYXJyLmJ5dGVMZW5ndGggLyA0KSk7CiAgICAgIGNyZWF0ZVZpZXcgPSAoYXJyKSA9PiBuZXcgRGF0YVZpZXcoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTsKICAgICAgcm90ciA9ICh3b3JkLCBzaGlmdCkgPT4gd29yZCA8PCAzMiAtIHNoaWZ0IHwgd29yZCA+Pj4gc2hpZnQ7CiAgICAgIHJvdGwgPSAod29yZCwgc2hpZnQpID0+IHdvcmQgPDwgc2hpZnQgfCB3b3JkID4+PiAzMiAtIHNoaWZ0ID4+PiAwOwogICAgICBpc0xFID0gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQzMkFycmF5KFsyODc0NTQwMjBdKS5idWZmZXIpWzBdID09PSA2ODsKICAgICAgYnl0ZVN3YXAgPSAod29yZCkgPT4gd29yZCA8PCAyNCAmIDQyNzgxOTAwODAgfCB3b3JkIDw8IDggJiAxNjcxMTY4MCB8IHdvcmQgPj4+IDggJiA2NTI4MCB8IHdvcmQgPj4+IDI0ICYgMjU1OwogICAgICBIYXNoID0gY2xhc3MgewogICAgICAgIC8vIFNhZmUgdmVyc2lvbiB0aGF0IGNsb25lcyBpbnRlcm5hbCBzdGF0ZQogICAgICAgIGNsb25lKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lSW50bygpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdG9TdHIgPSB7fS50b1N0cmluZzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTMuanMKICBmdW5jdGlvbiBrZWNjYWtQKHMsIHJvdW5kcyA9IDI0KSB7CiAgICBjb25zdCBCID0gbmV3IFVpbnQzMkFycmF5KDUgKiAyKTsKICAgIGZvciAobGV0IHJvdW5kID0gMjQgLSByb3VuZHM7IHJvdW5kIDwgMjQ7IHJvdW5kKyspIHsKICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgIEJbeF0gPSBzW3hdIF4gc1t4ICsgMTBdIF4gc1t4ICsgMjBdIF4gc1t4ICsgMzBdIF4gc1t4ICsgNDBdOwogICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4ICs9IDIpIHsKICAgICAgICBjb25zdCBpZHgxID0gKHggKyA4KSAlIDEwOwogICAgICAgIGNvbnN0IGlkeDAgPSAoeCArIDIpICUgMTA7CiAgICAgICAgY29uc3QgQjAgPSBCW2lkeDBdOwogICAgICAgIGNvbnN0IEIxID0gQltpZHgwICsgMV07CiAgICAgICAgY29uc3QgVGggPSByb3RsSChCMCwgQjEsIDEpIF4gQltpZHgxXTsKICAgICAgICBjb25zdCBUbCA9IHJvdGxMKEIwLCBCMSwgMSkgXiBCW2lkeDEgKyAxXTsKICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IDUwOyB5ICs9IDEwKSB7CiAgICAgICAgICBzW3ggKyB5XSBePSBUaDsKICAgICAgICAgIHNbeCArIHkgKyAxXSBePSBUbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IGN1ckggPSBzWzJdOwogICAgICBsZXQgY3VyTCA9IHNbM107CiAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgMjQ7IHQrKykgewogICAgICAgIGNvbnN0IHNoaWZ0ID0gU0hBM19ST1RMW3RdOwogICAgICAgIGNvbnN0IFRoID0gcm90bEgoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFRsID0gcm90bEwoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFBJID0gU0hBM19QSVt0XTsKICAgICAgICBjdXJIID0gc1tQSV07CiAgICAgICAgY3VyTCA9IHNbUEkgKyAxXTsKICAgICAgICBzW1BJXSA9IFRoOwogICAgICAgIHNbUEkgKyAxXSA9IFRsOwogICAgICB9CiAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgNTA7IHkgKz0gMTApIHsKICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4KyspCiAgICAgICAgICBCW3hdID0gc1t5ICsgeF07CiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgICAgc1t5ICsgeF0gXj0gfkJbKHggKyAyKSAlIDEwXSAmIEJbKHggKyA0KSAlIDEwXTsKICAgICAgfQogICAgICBzWzBdIF49IFNIQTNfSU9UQV9IW3JvdW5kXTsKICAgICAgc1sxXSBePSBTSEEzX0lPVEFfTFtyb3VuZF07CiAgICB9CiAgICBCLmZpbGwoMCk7CiAgfQogIHZhciBTSEEzX1BJLCBTSEEzX1JPVEwsIF9TSEEzX0lPVEEsIF8wbiwgXzFuLCBfMm4sIF83biwgXzI1Nm4sIF8weDcxbiwgU0hBM19JT1RBX0gsIFNIQTNfSU9UQV9MLCByb3RsSCwgcm90bEwsIEtlY2NhaywgZ2VuLCBzaGEzXzIyNCwgc2hhM18yNTYsIHNoYTNfMzg0LCBzaGEzXzUxMiwga2VjY2FrXzIyNCwga2VjY2FrXzI1Niwga2VjY2FrXzM4NCwga2VjY2FrXzUxMiwgZ2VuU2hha2UsIHNoYWtlMTI4LCBzaGFrZTI1NjsKICB2YXIgaW5pdF9zaGEzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9zaGEzLmpzIigpIHsKICAgICAgaW5pdF9hc3NlcnQoKTsKICAgICAgaW5pdF91NjQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBM19QSSA9IFtdOwogICAgICBTSEEzX1JPVEwgPSBbXTsKICAgICAgX1NIQTNfSU9UQSA9IFtdOwogICAgICBfMG4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDApOwogICAgICBfMW4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDIpOwogICAgICBfN24gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDcpOwogICAgICBfMjU2biA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMjU2KTsKICAgICAgXzB4NzFuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgxMTMpOwogICAgICBmb3IgKGxldCByb3VuZCA9IDAsIFIgPSBfMW4sIHggPSAxLCB5ID0gMDsgcm91bmQgPCAyNDsgcm91bmQrKykgewogICAgICAgIFt4LCB5XSA9IFt5LCAoMiAqIHggKyAzICogeSkgJSA1XTsKICAgICAgICBTSEEzX1BJLnB1c2goMiAqICg1ICogeSArIHgpKTsKICAgICAgICBTSEEzX1JPVEwucHVzaCgocm91bmQgKyAxKSAqIChyb3VuZCArIDIpIC8gMiAlIDY0KTsKICAgICAgICBsZXQgdCA9IF8wbjsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDc7IGorKykgewogICAgICAgICAgUiA9IChSIDw8IF8xbiBeIChSID4+IF83bikgKiBfMHg3MW4pICUgXzI1Nm47CiAgICAgICAgICBpZiAoUiAmIF8ybikKICAgICAgICAgICAgdCBePSBfMW4gPDwgKF8xbiA8PCAvKiBAX19QVVJFX18gKi8gQmlnSW50KGopKSAtIF8xbjsKICAgICAgICB9CiAgICAgICAgX1NIQTNfSU9UQS5wdXNoKHQpOwogICAgICB9CiAgICAgIFtTSEEzX0lPVEFfSCwgU0hBM19JT1RBX0xdID0gLyogQF9fUFVSRV9fICovIHNwbGl0KF9TSEEzX0lPVEEsIHRydWUpOwogICAgICByb3RsSCA9IChoLCBsLCBzKSA9PiBzID4gMzIgPyByb3RsQkgoaCwgbCwgcykgOiByb3RsU0goaCwgbCwgcyk7CiAgICAgIHJvdGxMID0gKGgsIGwsIHMpID0+IHMgPiAzMiA/IHJvdGxCTChoLCBsLCBzKSA6IHJvdGxTTChoLCBsLCBzKTsKICAgICAgS2VjY2FrID0gY2xhc3MgX0tlY2NhayBleHRlbmRzIEhhc2ggewogICAgICAgIC8vIE5PVEU6IHdlIGFjY2VwdCBhcmd1bWVudHMgaW4gYnl0ZXMgaW5zdGVhZCBvZiBiaXRzIGhlcmUuCiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCBlbmFibGVYT0YgPSBmYWxzZSwgcm91bmRzID0gMjQpIHsKICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICB0aGlzLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0aGlzLnN1ZmZpeCA9IHN1ZmZpeDsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5lbmFibGVYT0YgPSBlbmFibGVYT0Y7CiAgICAgICAgICB0aGlzLnJvdW5kcyA9IHJvdW5kczsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMucG9zT3V0ID0gMDsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBudW1iZXIob3V0cHV0TGVuKTsKICAgICAgICAgIGlmICgwID49IHRoaXMuYmxvY2tMZW4gfHwgdGhpcy5ibG9ja0xlbiA+PSAyMDApCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiU2hhMyBzdXBwb3J0cyBvbmx5IGtlY2Nhay1mMTYwMCBmdW5jdGlvbiIpOwogICAgICAgICAgdGhpcy5zdGF0ZSA9IG5ldyBVaW50OEFycmF5KDIwMCk7CiAgICAgICAgICB0aGlzLnN0YXRlMzIgPSB1MzIodGhpcy5zdGF0ZSk7CiAgICAgICAgfQogICAgICAgIGtlY2NhaygpIHsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAga2VjY2FrUCh0aGlzLnN0YXRlMzIsIHRoaXMucm91bmRzKTsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAgdGhpcy5wb3NPdXQgPSAwOwogICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgc3RhdGUgfSA9IHRoaXM7CiAgICAgICAgICBkYXRhID0gdG9CeXRlczIoZGF0YSk7CiAgICAgICAgICBjb25zdCBsZW4gPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDA7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGNvbnN0IHRha2UgPSBNYXRoLm1pbihibG9ja0xlbiAtIHRoaXMucG9zLCBsZW4gLSBwb3MpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRha2U7IGkrKykKICAgICAgICAgICAgICBzdGF0ZVt0aGlzLnBvcysrXSBePSBkYXRhW3BvcysrXTsKICAgICAgICAgICAgaWYgKHRoaXMucG9zID09PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGZpbmlzaCgpIHsKICAgICAgICAgIGlmICh0aGlzLmZpbmlzaGVkKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHsgc3RhdGUsIHN1ZmZpeCwgcG9zLCBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIHN0YXRlW3Bvc10gXj0gc3VmZml4OwogICAgICAgICAgaWYgKChzdWZmaXggJiAxMjgpICE9PSAwICYmIHBvcyA9PT0gYmxvY2tMZW4gLSAxKQogICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgc3RhdGVbYmxvY2tMZW4gLSAxXSBePSAxMjg7CiAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgIH0KICAgICAgICB3cml0ZUludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcywgZmFsc2UpOwogICAgICAgICAgYnl0ZXMob3V0KTsKICAgICAgICAgIHRoaXMuZmluaXNoKCk7CiAgICAgICAgICBjb25zdCBidWZmZXJPdXQgPSB0aGlzLnN0YXRlOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDAsIGxlbiA9IG91dC5sZW5ndGg7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnBvc091dCA+PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvc091dCwgbGVuIC0gcG9zKTsKICAgICAgICAgICAgb3V0LnNldChidWZmZXJPdXQuc3ViYXJyYXkodGhpcy5wb3NPdXQsIHRoaXMucG9zT3V0ICsgdGFrZSksIHBvcyk7CiAgICAgICAgICAgIHRoaXMucG9zT3V0ICs9IHRha2U7CiAgICAgICAgICAgIHBvcyArPSB0YWtlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICB9CiAgICAgICAgeG9mSW50byhvdXQpIHsKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVYT0YpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiWE9GIGlzIG5vdCBwb3NzaWJsZSBmb3IgdGhpcyBpbnN0YW5jZSIpOwogICAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVJbnRvKG91dCk7CiAgICAgICAgfQogICAgICAgIHhvZihieXRlczIpIHsKICAgICAgICAgIG51bWJlcihieXRlczIpOwogICAgICAgICAgcmV0dXJuIHRoaXMueG9mSW50byhuZXcgVWludDhBcnJheShieXRlczIpKTsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIG91dHB1dChvdXQsIHRoaXMpOwogICAgICAgICAgaWYgKHRoaXMuZmluaXNoZWQpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiZGlnZXN0KCkgd2FzIGFscmVhZHkgY2FsbGVkIik7CiAgICAgICAgICB0aGlzLndyaXRlSW50byhvdXQpOwogICAgICAgICAgdGhpcy5kZXN0cm95KCk7CiAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5kaWdlc3RJbnRvKG5ldyBVaW50OEFycmF5KHRoaXMub3V0cHV0TGVuKSk7CiAgICAgICAgfQogICAgICAgIGRlc3Ryb3koKSB7CiAgICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7CiAgICAgICAgICB0aGlzLnN0YXRlLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIGNvbnN0IHsgYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCByb3VuZHMsIGVuYWJsZVhPRiB9ID0gdGhpczsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyBfS2VjY2FrKGJsb2NrTGVuLCBzdWZmaXgsIG91dHB1dExlbiwgZW5hYmxlWE9GLCByb3VuZHMpKTsKICAgICAgICAgIHRvLnN0YXRlMzIuc2V0KHRoaXMuc3RhdGUzMik7CiAgICAgICAgICB0by5wb3MgPSB0aGlzLnBvczsKICAgICAgICAgIHRvLnBvc091dCA9IHRoaXMucG9zT3V0OwogICAgICAgICAgdG8uZmluaXNoZWQgPSB0aGlzLmZpbmlzaGVkOwogICAgICAgICAgdG8ucm91bmRzID0gcm91bmRzOwogICAgICAgICAgdG8uc3VmZml4ID0gc3VmZml4OwogICAgICAgICAgdG8ub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdG8uZW5hYmxlWE9GID0gZW5hYmxlWE9GOwogICAgICAgICAgdG8uZGVzdHJveWVkID0gdGhpcy5kZXN0cm95ZWQ7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgICBnZW4gPSAoc3VmZml4LCBibG9ja0xlbiwgb3V0cHV0TGVuKSA9PiB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IEtlY2NhayhibG9ja0xlbiwgc3VmZml4LCBvdXRwdXRMZW4pKTsKICAgICAgc2hhM18yMjQgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDE0NCwgMjI0IC8gOCk7CiAgICAgIHNoYTNfMjU2ID0gLyogQF9fUFVSRV9fICovIGdlbig2LCAxMzYsIDI1NiAvIDgpOwogICAgICBzaGEzXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oNiwgMTA0LCAzODQgLyA4KTsKICAgICAgc2hhM181MTIgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDcyLCA1MTIgLyA4KTsKICAgICAga2VjY2FrXzIyNCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTQ0LCAyMjQgLyA4KTsKICAgICAga2VjY2FrXzI1NiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTM2LCAyNTYgLyA4KTsKICAgICAga2VjY2FrXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTA0LCAzODQgLyA4KTsKICAgICAga2VjY2FrXzUxMiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgNzIsIDUxMiAvIDgpOwogICAgICBnZW5TaGFrZSA9IChzdWZmaXgsIGJsb2NrTGVuLCBvdXRwdXRMZW4pID0+IHdyYXBYT0ZDb25zdHJ1Y3RvcldpdGhPcHRzKChvcHRzID0ge30pID0+IG5ldyBLZWNjYWsoYmxvY2tMZW4sIHN1ZmZpeCwgb3B0cy5ka0xlbiA9PT0gdm9pZCAwID8gb3V0cHV0TGVuIDogb3B0cy5ka0xlbiwgdHJ1ZSkpOwogICAgICBzaGFrZTEyOCA9IC8qIEBfX1BVUkVfXyAqLyBnZW5TaGFrZSgzMSwgMTY4LCAxMjggLyA4KTsKICAgICAgc2hha2UyNTYgPSAvKiBAX19QVVJFX18gKi8gZ2VuU2hha2UoMzEsIDEzNiwgMjU2IC8gOCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2tlY2NhazI1Ni5qcwogIGZ1bmN0aW9uIGtlY2NhazI1Nih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IGtlY2Nha18yNTYoaXNIZXgodmFsdWUsIHsgc3RyaWN0OiBmYWxzZSB9KSA/IHRvQnl0ZXModmFsdWUpIDogdmFsdWUpOwogICAgaWYgKHRvID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gYnl0ZXMyOwogICAgcmV0dXJuIHRvSGV4KGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2tlY2NhazI1NiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9rZWNjYWsyNTYuanMiKCkgewogICAgICBpbml0X3NoYTMoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzCiAgZnVuY3Rpb24gaGFzaFNpZ25hdHVyZShzaWcpIHsKICAgIHJldHVybiBoYXNoMihzaWcpOwogIH0KICB2YXIgaGFzaDI7CiAgdmFyIGluaXRfaGFzaFNpZ25hdHVyZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfa2VjY2FrMjU2KCk7CiAgICAgIGhhc2gyID0gKHZhbHVlKSA9PiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9ub3JtYWxpemVTaWduYXR1cmUuanMKICBmdW5jdGlvbiBub3JtYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGxldCBjdXJyZW50ID0gIiI7CiAgICBsZXQgbGV2ZWwgPSAwOwogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgbGV0IHZhbGlkID0gZmFsc2U7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGFyID0gc2lnbmF0dXJlW2ldOwogICAgICBpZiAoWyIoIiwgIikiLCAiLCJdLmluY2x1ZGVzKGNoYXIpKQogICAgICAgIGFjdGl2ZSA9IHRydWU7CiAgICAgIGlmIChjaGFyID09PSAiKCIpCiAgICAgICAgbGV2ZWwrKzsKICAgICAgaWYgKGNoYXIgPT09ICIpIikKICAgICAgICBsZXZlbC0tOwogICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKGxldmVsID09PSAwKSB7CiAgICAgICAgaWYgKGNoYXIgPT09ICIgIiAmJiBbImV2ZW50IiwgImZ1bmN0aW9uIiwgIiJdLmluY2x1ZGVzKHJlc3VsdCkpCiAgICAgICAgICByZXN1bHQgPSAiIjsKICAgICAgICBlbHNlIHsKICAgICAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICAgICAgaWYgKGNoYXIgPT09ICIpIikgewogICAgICAgICAgICB2YWxpZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoY2hhciA9PT0gIiAiKSB7CiAgICAgICAgaWYgKHNpZ25hdHVyZVtpIC0gMV0gIT09ICIsIiAmJiBjdXJyZW50ICE9PSAiLCIgJiYgY3VycmVudCAhPT0gIiwoIikgewogICAgICAgICAgY3VycmVudCA9ICIiOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICBjdXJyZW50ICs9IGNoYXI7CiAgICB9CiAgICBpZiAoIXZhbGlkKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiVW5hYmxlIHRvIG5vcm1hbGl6ZSBzaWduYXR1cmUuIik7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgaW5pdF9ub3JtYWxpemVTaWduYXR1cmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvbm9ybWFsaXplU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzCiAgdmFyIHRvU2lnbmF0dXJlOwogIHZhciBpbml0X3RvU2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9leHBvcnRzKCk7CiAgICAgIGluaXRfbm9ybWFsaXplU2lnbmF0dXJlKCk7CiAgICAgIHRvU2lnbmF0dXJlID0gKGRlZikgPT4gewogICAgICAgIGNvbnN0IGRlZl8gPSAoKCkgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiBkZWYgPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gZGVmOwogICAgICAgICAgcmV0dXJuIGZvcm1hdEFiaUl0ZW0oZGVmKTsKICAgICAgICB9KSgpOwogICAgICAgIHJldHVybiBub3JtYWxpemVTaWduYXR1cmUoZGVmXyk7CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcwogIGZ1bmN0aW9uIHRvU2lnbmF0dXJlSGFzaChmbikgewogICAgcmV0dXJuIGhhc2hTaWduYXR1cmUodG9TaWduYXR1cmUoZm4pKTsKICB9CiAgdmFyIGluaXRfdG9TaWduYXR1cmVIYXNoID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcyIoKSB7CiAgICAgIGluaXRfaGFzaFNpZ25hdHVyZSgpOwogICAgICBpbml0X3RvU2lnbmF0dXJlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcwogIHZhciB0b0V2ZW50U2VsZWN0b3I7CiAgdmFyIGluaXRfdG9FdmVudFNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CiAgICAgIHRvRXZlbnRTZWxlY3RvciA9IHRvU2lnbmF0dXJlSGFzaDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hZGRyZXNzLmpzCiAgdmFyIEludmFsaWRBZGRyZXNzRXJyb3I7CiAgdmFyIGluaXRfYWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FkZHJlc3MuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW52YWxpZEFkZHJlc3NFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBBZGRyZXNzICIke2FkZHJlc3N9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIi0gQWRkcmVzcyBtdXN0IGJlIGEgaGV4IHZhbHVlIG9mIDIwIGJ5dGVzICg0MCBoZXggY2hhcmFjdGVycykuIiwKICAgICAgICAgICAgICAiLSBBZGRyZXNzIG11c3QgbWF0Y2ggaXRzIGNoZWNrc3VtIGNvdW50ZXJwYXJ0LiIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBZGRyZXNzRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9scnUuanMKICB2YXIgTHJ1TWFwOwogIHZhciBpbml0X2xydSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbHJ1LmpzIigpIHsKICAgICAgTHJ1TWFwID0gY2xhc3MgZXh0ZW5kcyBNYXAgewogICAgICAgIGNvbnN0cnVjdG9yKHNpemUzKSB7CiAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtYXhTaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMubWF4U2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgICBnZXQoa2V5KSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHN1cGVyLmdldChrZXkpOwogICAgICAgICAgaWYgKHN1cGVyLmhhcyhrZXkpICYmIHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgdGhpcy5kZWxldGUoa2V5KTsKICAgICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgICBzZXQoa2V5LCB2YWx1ZSkgewogICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgaWYgKHRoaXMubWF4U2l6ZSAmJiB0aGlzLnNpemUgPiB0aGlzLm1heFNpemUpIHsKICAgICAgICAgICAgY29uc3QgZmlyc3RLZXkgPSB0aGlzLmtleXMoKS5uZXh0KCkudmFsdWU7CiAgICAgICAgICAgIGlmIChmaXJzdEtleSkKICAgICAgICAgICAgICB0aGlzLmRlbGV0ZShmaXJzdEtleSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldEFkZHJlc3MuanMKICBmdW5jdGlvbiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzc18sIGNoYWluSWQpIHsKICAgIGlmIChjaGVja3N1bUFkZHJlc3NDYWNoZS5oYXMoYCR7YWRkcmVzc199LiR7Y2hhaW5JZH1gKSkKICAgICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzc0NhY2hlLmdldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWApOwogICAgY29uc3QgaGV4QWRkcmVzcyA9IGNoYWluSWQgPyBgJHtjaGFpbklkfSR7YWRkcmVzc18udG9Mb3dlckNhc2UoKX1gIDogYWRkcmVzc18uc3Vic3RyaW5nKDIpLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGhleEFkZHJlc3MpLCAiYnl0ZXMiKTsKICAgIGNvbnN0IGFkZHJlc3MgPSAoY2hhaW5JZCA/IGhleEFkZHJlc3Muc3Vic3RyaW5nKGAke2NoYWluSWR9MHhgLmxlbmd0aCkgOiBoZXhBZGRyZXNzKS5zcGxpdCgiIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQwOyBpICs9IDIpIHsKICAgICAgaWYgKGhhc2gzW2kgPj4gMV0gPj4gNCA+PSA4ICYmIGFkZHJlc3NbaV0pIHsKICAgICAgICBhZGRyZXNzW2ldID0gYWRkcmVzc1tpXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICAgIGlmICgoaGFzaDNbaSA+PiAxXSAmIDE1KSA+PSA4ICYmIGFkZHJlc3NbaSArIDFdKSB7CiAgICAgICAgYWRkcmVzc1tpICsgMV0gPSBhZGRyZXNzW2kgKyAxXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICB9CiAgICBjb25zdCByZXN1bHQgPSBgMHgke2FkZHJlc3Muam9pbigiIil9YDsKICAgIGNoZWNrc3VtQWRkcmVzc0NhY2hlLnNldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWAsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICBmdW5jdGlvbiBnZXRBZGRyZXNzKGFkZHJlc3MsIGNoYWluSWQpIHsKICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhhZGRyZXNzLCBjaGFpbklkKTsKICB9CiAgdmFyIGNoZWNrc3VtQWRkcmVzc0NhY2hlOwogIHZhciBpbml0X2dldEFkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvZ2V0QWRkcmVzcy5qcyIoKSB7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF9rZWNjYWsyNTYoKTsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9pc0FkZHJlc3MoKTsKICAgICAgY2hlY2tzdW1BZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzCiAgZnVuY3Rpb24gaXNBZGRyZXNzKGFkZHJlc3MsIG9wdGlvbnMpIHsKICAgIGNvbnN0IHsgc3RyaWN0ID0gdHJ1ZSB9ID0gb3B0aW9ucyA/PyB7fTsKICAgIGNvbnN0IGNhY2hlS2V5MiA9IGAke2FkZHJlc3N9LiR7c3RyaWN0fWA7CiAgICBpZiAoaXNBZGRyZXNzQ2FjaGUuaGFzKGNhY2hlS2V5MikpCiAgICAgIHJldHVybiBpc0FkZHJlc3NDYWNoZS5nZXQoY2FjaGVLZXkyKTsKICAgIGNvbnN0IHJlc3VsdCA9ICgoKSA9PiB7CiAgICAgIGlmICghYWRkcmVzc1JlZ2V4LnRlc3QoYWRkcmVzcykpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcy50b0xvd2VyQ2FzZSgpID09PSBhZGRyZXNzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHJldHVybiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzcykgPT09IGFkZHJlc3M7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGlzQWRkcmVzc0NhY2hlLnNldChjYWNoZUtleTIsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgYWRkcmVzc1JlZ2V4LCBpc0FkZHJlc3NDYWNoZTsKICB2YXIgaW5pdF9pc0FkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzIigpIHsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGFkZHJlc3NSZWdleCA9IC9eMHhbYS1mQS1GMC05XXs0MH0kLzsKICAgICAgaXNBZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvY29uY2F0LmpzCiAgZnVuY3Rpb24gY29uY2F0KHZhbHVlcykgewogICAgaWYgKHR5cGVvZiB2YWx1ZXNbMF0gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gY29uY2F0SGV4KHZhbHVlcyk7CiAgICByZXR1cm4gY29uY2F0Qnl0ZXMyKHZhbHVlcyk7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEJ5dGVzMih2YWx1ZXMpIHsKICAgIGxldCBsZW5ndGggPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIGxlbmd0aCArPSBhcnIubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIHJlc3VsdC5zZXQoYXJyLCBvZmZzZXQpOwogICAgICBvZmZzZXQgKz0gYXJyLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEhleCh2YWx1ZXMpIHsKICAgIHJldHVybiBgMHgke3ZhbHVlcy5yZWR1Y2UoKGFjYywgeCkgPT4gYWNjICsgeC5yZXBsYWNlKCIweCIsICIiKSwgIiIpfWA7CiAgfQogIHZhciBpbml0X2NvbmNhdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9jb25jYXQuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zbGljZS5qcwogIGZ1bmN0aW9uIHNsaWNlKHZhbHVlLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gc2xpY2VIZXgodmFsdWUsIHN0YXJ0LCBlbmQsIHsKICAgICAgICBzdHJpY3QKICAgICAgfSk7CiAgICByZXR1cm4gc2xpY2VCeXRlcyh2YWx1ZSwgc3RhcnQsIGVuZCwgewogICAgICBzdHJpY3QKICAgIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZSwgc3RhcnQpIHsKICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICJudW1iZXIiICYmIHN0YXJ0ID4gMCAmJiBzdGFydCA+IHNpemUodmFsdWUpIC0gMSkKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBzdGFydCwKICAgICAgICBwb3NpdGlvbjogInN0YXJ0IiwKICAgICAgICBzaXplOiBzaXplKHZhbHVlKQogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKSB7CiAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAibnVtYmVyIiAmJiB0eXBlb2YgZW5kID09PSAibnVtYmVyIiAmJiBzaXplKHZhbHVlKSAhPT0gZW5kIC0gc3RhcnQpIHsKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBlbmQsCiAgICAgICAgcG9zaXRpb246ICJlbmQiLAogICAgICAgIHNpemU6IHNpemUodmFsdWUpCiAgICAgIH0pOwogICAgfQogIH0KICBmdW5jdGlvbiBzbGljZUJ5dGVzKHZhbHVlXywgc3RhcnQsIGVuZCwgeyBzdHJpY3QgfSA9IHt9KSB7CiAgICBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZV8sIHN0YXJ0KTsKICAgIGNvbnN0IHZhbHVlID0gdmFsdWVfLnNsaWNlKHN0YXJ0LCBlbmQpOwogICAgaWYgKHN0cmljdCkKICAgICAgYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgZnVuY3Rpb24gc2xpY2VIZXgodmFsdWVfLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGFzc2VydFN0YXJ0T2Zmc2V0KHZhbHVlXywgc3RhcnQpOwogICAgY29uc3QgdmFsdWUgPSBgMHgke3ZhbHVlXy5yZXBsYWNlKCIweCIsICIiKS5zbGljZSgoc3RhcnQgPz8gMCkgKiAyLCAoZW5kID8/IHZhbHVlXy5sZW5ndGgpICogMil9YDsKICAgIGlmIChzdHJpY3QpCiAgICAgIGFzc2VydEVuZE9mZnNldCh2YWx1ZSwgc3RhcnQsIGVuZCk7CiAgICByZXR1cm4gdmFsdWU7CiAgfQogIHZhciBpbml0X3NsaWNlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3NsaWNlLmpzIigpIHsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfaXNIZXgoKTsKICAgICAgaW5pdF9zaXplKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlQWJpUGFyYW1ldGVycy5qcwogIGZ1bmN0aW9uIGVuY29kZUFiaVBhcmFtZXRlcnMocGFyYW1zLCB2YWx1ZXMpIHsKICAgIGlmIChwYXJhbXMubGVuZ3RoICE9PSB2YWx1ZXMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogcGFyYW1zLmxlbmd0aCwKICAgICAgICBnaXZlbkxlbmd0aDogdmFsdWVzLmxlbmd0aAogICAgICB9KTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gcHJlcGFyZVBhcmFtcyh7CiAgICAgIHBhcmFtcywKICAgICAgdmFsdWVzCiAgICB9KTsKICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gIjB4IjsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBwcmVwYXJlUGFyYW1zKHsgcGFyYW1zLCB2YWx1ZXMgfSkgewogICAgY29uc3QgcHJlcGFyZWRQYXJhbXMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZVBhcmFtKHsgcGFyYW06IHBhcmFtc1tpXSwgdmFsdWU6IHZhbHVlc1tpXSB9KSk7CiAgICB9CiAgICByZXR1cm4gcHJlcGFyZWRQYXJhbXM7CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVQYXJhbSh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbTogeyAuLi5wYXJhbSwgdHlwZSB9IH0pOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIpIHsKICAgICAgcmV0dXJuIGVuY29kZVR1cGxlKHZhbHVlLCB7CiAgICAgICAgcGFyYW0KICAgICAgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIHJldHVybiBlbmNvZGVBZGRyZXNzKHZhbHVlKTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAiYm9vbCIpIHsKICAgICAgcmV0dXJuIGVuY29kZUJvb2wodmFsdWUpOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgidWludCIpIHx8IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50IikpIHsKICAgICAgY29uc3Qgc2lnbmVkID0gcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKTsKICAgICAgcmV0dXJuIGVuY29kZU51bWJlcih2YWx1ZSwgeyBzaWduZWQgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJieXRlcyIpKSB7CiAgICAgIHJldHVybiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gZW5jb2RlU3RyaW5nKHZhbHVlKTsKICAgIH0KICAgIHRocm93IG5ldyBJbnZhbGlkQWJpRW5jb2RpbmdUeXBlRXJyb3IocGFyYW0udHlwZSwgewogICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L2VuY29kZUFiaVBhcmFtZXRlcnMiCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSB7CiAgICBsZXQgc3RhdGljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKQogICAgICAgIHN0YXRpY1NpemUgKz0gMzI7CiAgICAgIGVsc2UKICAgICAgICBzdGF0aWNTaXplICs9IHNpemUoZW5jb2RlZCk7CiAgICB9CiAgICBjb25zdCBzdGF0aWNQYXJhbXMgPSBbXTsKICAgIGNvbnN0IGR5bmFtaWNQYXJhbXMgPSBbXTsKICAgIGxldCBkeW5hbWljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKSB7CiAgICAgICAgc3RhdGljUGFyYW1zLnB1c2gobnVtYmVyVG9IZXgoc3RhdGljU2l6ZSArIGR5bmFtaWNTaXplLCB7IHNpemU6IDMyIH0pKTsKICAgICAgICBkeW5hbWljUGFyYW1zLnB1c2goZW5jb2RlZCk7CiAgICAgICAgZHluYW1pY1NpemUgKz0gc2l6ZShlbmNvZGVkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGF0aWNQYXJhbXMucHVzaChlbmNvZGVkKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbmNhdChbLi4uc3RhdGljUGFyYW1zLCAuLi5keW5hbWljUGFyYW1zXSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFkZHJlc3ModmFsdWUpIHsKICAgIGlmICghaXNBZGRyZXNzKHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgIHJldHVybiB7IGR5bmFtaWM6IGZhbHNlLCBlbmNvZGVkOiBwYWRIZXgodmFsdWUudG9Mb3dlckNhc2UoKSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbSB9KSB7CiAgICBjb25zdCBkeW5hbWljID0gbGVuZ3RoID09PSBudWxsOwogICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBcnJheUVycm9yKHZhbHVlKTsKICAgIGlmICghZHluYW1pYyAmJiB2YWx1ZS5sZW5ndGggIT09IGxlbmd0aCkKICAgICAgdGhyb3cgbmV3IEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogbGVuZ3RoLAogICAgICAgIGdpdmVuTGVuZ3RoOiB2YWx1ZS5sZW5ndGgsCiAgICAgICAgdHlwZTogYCR7cGFyYW0udHlwZX1bJHtsZW5ndGh9XWAKICAgICAgfSk7CiAgICBsZXQgZHluYW1pY0NoaWxkID0gZmFsc2U7CiAgICBjb25zdCBwcmVwYXJlZFBhcmFtcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBwcmVwYXJlZFBhcmFtID0gcHJlcGFyZVBhcmFtKHsgcGFyYW0sIHZhbHVlOiB2YWx1ZVtpXSB9KTsKICAgICAgaWYgKHByZXBhcmVkUGFyYW0uZHluYW1pYykKICAgICAgICBkeW5hbWljQ2hpbGQgPSB0cnVlOwogICAgICBwcmVwYXJlZFBhcmFtcy5wdXNoKHByZXBhcmVkUGFyYW0pOwogICAgfQogICAgaWYgKGR5bmFtaWMgfHwgZHluYW1pY0NoaWxkKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgICBpZiAoZHluYW1pYykgewogICAgICAgIGNvbnN0IGxlbmd0aDIgPSBudW1iZXJUb0hleChwcmVwYXJlZFBhcmFtcy5sZW5ndGgsIHsgc2l6ZTogMzIgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgICBlbmNvZGVkOiBwcmVwYXJlZFBhcmFtcy5sZW5ndGggPiAwID8gY29uY2F0KFtsZW5ndGgyLCBkYXRhXSkgOiBsZW5ndGgyCiAgICAgICAgfTsKICAgICAgfQogICAgICBpZiAoZHluYW1pY0NoaWxkKQogICAgICAgIHJldHVybiB7IGR5bmFtaWM6IHRydWUsIGVuY29kZWQ6IGRhdGEgfTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBjb25jYXQocHJlcGFyZWRQYXJhbXMubWFwKCh7IGVuY29kZWQgfSkgPT4gZW5jb2RlZCkpCiAgICB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KSB7CiAgICBjb25zdCBbLCBwYXJhbVNpemVdID0gcGFyYW0udHlwZS5zcGxpdCgiYnl0ZXMiKTsKICAgIGNvbnN0IGJ5dGVzU2l6ZSA9IHNpemUodmFsdWUpOwogICAgaWYgKCFwYXJhbVNpemUpIHsKICAgICAgbGV0IHZhbHVlXyA9IHZhbHVlOwogICAgICBpZiAoYnl0ZXNTaXplICUgMzIgIT09IDApCiAgICAgICAgdmFsdWVfID0gcGFkSGV4KHZhbHVlXywgewogICAgICAgICAgZGlyOiAicmlnaHQiLAogICAgICAgICAgc2l6ZTogTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIgLyAzMikgKiAzMgogICAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgZW5jb2RlZDogY29uY2F0KFtwYWRIZXgobnVtYmVyVG9IZXgoYnl0ZXNTaXplLCB7IHNpemU6IDMyIH0pKSwgdmFsdWVfXSkKICAgICAgfTsKICAgIH0KICAgIGlmIChieXRlc1NpemUgIT09IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIgfSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQm9vbCh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBib29sZWFuIHZhbHVlOiAiJHt2YWx1ZX0iICh0eXBlOiAke3R5cGVvZiB2YWx1ZX0pLiBFeHBlY3RlZDogXGB0cnVlXGAgb3IgXGBmYWxzZVxgLmApOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleChib29sVG9IZXgodmFsdWUpKSB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVOdW1iZXIodmFsdWUsIHsgc2lnbmVkIH0pIHsKICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IDMyLAogICAgICAgIHNpZ25lZAogICAgICB9KQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlU3RyaW5nKHZhbHVlKSB7CiAgICBjb25zdCBoZXhWYWx1ZSA9IHN0cmluZ1RvSGV4KHZhbHVlKTsKICAgIGNvbnN0IHBhcnRzTGVuZ3RoID0gTWF0aC5jZWlsKHNpemUoaGV4VmFsdWUpIC8gMzIpOwogICAgY29uc3QgcGFydHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHNMZW5ndGg7IGkrKykgewogICAgICBwYXJ0cy5wdXNoKHBhZEhleChzbGljZShoZXhWYWx1ZSwgaSAqIDMyLCAoaSArIDEpICogMzIpLCB7CiAgICAgICAgZGlyOiAicmlnaHQiCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgIGVuY29kZWQ6IGNvbmNhdChbCiAgICAgICAgcGFkSGV4KG51bWJlclRvSGV4KHNpemUoaGV4VmFsdWUpLCB7IHNpemU6IDMyIH0pKSwKICAgICAgICAuLi5wYXJ0cwogICAgICBdKQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlVHVwbGUodmFsdWUsIHsgcGFyYW0gfSkgewogICAgbGV0IGR5bmFtaWMgPSBmYWxzZTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcGFyYW1fID0gcGFyYW0uY29tcG9uZW50c1tpXTsKICAgICAgY29uc3QgaW5kZXgyID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBpIDogcGFyYW1fLm5hbWU7CiAgICAgIGNvbnN0IHByZXBhcmVkUGFyYW0gPSBwcmVwYXJlUGFyYW0oewogICAgICAgIHBhcmFtOiBwYXJhbV8sCiAgICAgICAgdmFsdWU6IHZhbHVlW2luZGV4Ml0KICAgICAgfSk7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZWRQYXJhbSk7CiAgICAgIGlmIChwcmVwYXJlZFBhcmFtLmR5bmFtaWMpCiAgICAgICAgZHluYW1pYyA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gewogICAgICBkeW5hbWljLAogICAgICBlbmNvZGVkOiBkeW5hbWljID8gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSA6IGNvbmNhdChwcmVwYXJlZFBhcmFtcy5tYXAoKHsgZW5jb2RlZCB9KSA9PiBlbmNvZGVkKSkKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldEFycmF5Q29tcG9uZW50cyh0eXBlKSB7CiAgICBjb25zdCBtYXRjaGVzID0gdHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pOwogICAgcmV0dXJuIG1hdGNoZXMgPyAoCiAgICAgIC8vIFJldHVybiBgbnVsbGAgaWYgdGhlIGFycmF5IGlzIGR5bmFtaWMuCiAgICAgIFttYXRjaGVzWzJdID8gTnVtYmVyKG1hdGNoZXNbMl0pIDogbnVsbCwgbWF0Y2hlc1sxXV0KICAgICkgOiB2b2lkIDA7CiAgfQogIHZhciBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcwogIHZhciB0b0Z1bmN0aW9uU2VsZWN0b3I7CiAgdmFyIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfc2xpY2UoKTsKICAgICAgaW5pdF90b1NpZ25hdHVyZUhhc2goKTsKICAgICAgdG9GdW5jdGlvblNlbGVjdG9yID0gKGZuKSA9PiBzbGljZSh0b1NpZ25hdHVyZUhhc2goZm4pLCAwLCA0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9nZXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZ2V0QWJpSXRlbShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncyA9IFtdLCBuYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaXNTZWxlY3RvciA9IGlzSGV4KG5hbWUsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgIGNvbnN0IGFiaUl0ZW1zID0gYWJpMi5maWx0ZXIoKGFiaUl0ZW0pID0+IHsKICAgICAgaWYgKGlzU2VsZWN0b3IpIHsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgICAgcmV0dXJuIHRvRnVuY3Rpb25TZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICAgICAgcmV0dXJuIHRvRXZlbnRTZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuICJuYW1lIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0ubmFtZSA9PT0gbmFtZTsKICAgIH0pOwogICAgaWYgKGFiaUl0ZW1zLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGlmIChhYmlJdGVtcy5sZW5ndGggPT09IDEpCiAgICAgIHJldHVybiBhYmlJdGVtc1swXTsKICAgIGxldCBtYXRjaGVkQWJpSXRlbSA9IHZvaWQgMDsKICAgIGZvciAoY29uc3QgYWJpSXRlbSBvZiBhYmlJdGVtcykgewogICAgICBpZiAoISgiaW5wdXRzIiBpbiBhYmlJdGVtKSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKSB7CiAgICAgICAgaWYgKCFhYmlJdGVtLmlucHV0cyB8fCBhYmlJdGVtLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgICAgICByZXR1cm4gYWJpSXRlbTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoICE9PSBhcmdzLmxlbmd0aCkKICAgICAgICBjb250aW51ZTsKICAgICAgY29uc3QgbWF0Y2hlZCA9IGFyZ3MuZXZlcnkoKGFyZywgaW5kZXgyKSA9PiB7CiAgICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gImlucHV0cyIgaW4gYWJpSXRlbSAmJiBhYmlJdGVtLmlucHV0c1tpbmRleDJdOwogICAgICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcik7CiAgICAgIH0pOwogICAgICBpZiAobWF0Y2hlZCkgewogICAgICAgIGlmIChtYXRjaGVkQWJpSXRlbSAmJiAiaW5wdXRzIiBpbiBtYXRjaGVkQWJpSXRlbSAmJiBtYXRjaGVkQWJpSXRlbS5pbnB1dHMpIHsKICAgICAgICAgIGNvbnN0IGFtYmlndW91c1R5cGVzID0gZ2V0QW1iaWd1b3VzVHlwZXMoYWJpSXRlbS5pbnB1dHMsIG1hdGNoZWRBYmlJdGVtLmlucHV0cywgYXJncyk7CiAgICAgICAgICBpZiAoYW1iaWd1b3VzVHlwZXMpCiAgICAgICAgICAgIHRocm93IG5ldyBBYmlJdGVtQW1iaWd1aXR5RXJyb3IoewogICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgdHlwZTogYW1iaWd1b3VzVHlwZXNbMF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIGFiaUl0ZW06IG1hdGNoZWRBYmlJdGVtLAogICAgICAgICAgICAgIHR5cGU6IGFtYmlndW91c1R5cGVzWzFdCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBtYXRjaGVkQWJpSXRlbSA9IGFiaUl0ZW07CiAgICAgIH0KICAgIH0KICAgIGlmIChtYXRjaGVkQWJpSXRlbSkKICAgICAgcmV0dXJuIG1hdGNoZWRBYmlJdGVtOwogICAgcmV0dXJuIGFiaUl0ZW1zWzBdOwogIH0KICBmdW5jdGlvbiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcikgewogICAgY29uc3QgYXJnVHlwZSA9IHR5cGVvZiBhcmc7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJUeXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBzd2l0Y2ggKGFiaVBhcmFtZXRlclR5cGUpIHsKICAgICAgY2FzZSAiYWRkcmVzcyI6CiAgICAgICAgcmV0dXJuIGlzQWRkcmVzcyhhcmcsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgICAgY2FzZSAiYm9vbCI6CiAgICAgICAgcmV0dXJuIGFyZ1R5cGUgPT09ICJib29sZWFuIjsKICAgICAgY2FzZSAiZnVuY3Rpb24iOgogICAgICAgIHJldHVybiBhcmdUeXBlID09PSAic3RyaW5nIjsKICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyI7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBpZiAoYWJpUGFyYW1ldGVyVHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoYWJpUGFyYW1ldGVyLmNvbXBvbmVudHMpLmV2ZXJ5KChjb21wb25lbnQsIGluZGV4MikgPT4gewogICAgICAgICAgICByZXR1cm4gaXNBcmdPZlR5cGUoT2JqZWN0LnZhbHVlcyhhcmcpW2luZGV4Ml0sIGNvbXBvbmVudCk7CiAgICAgICAgICB9KTsKICAgICAgICBpZiAoL151P2ludCg4fDE2fDI0fDMyfDQwfDQ4fDU2fDY0fDcyfDgwfDg4fDk2fDEwNHwxMTJ8MTIwfDEyOHwxMzZ8MTQ0fDE1MnwxNjB8MTY4fDE3NnwxODR8MTkyfDIwMHwyMDh8MjE2fDIyNHwyMzJ8MjQwfDI0OHwyNTYpPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gIm51bWJlciIgfHwgYXJnVHlwZSA9PT0gImJpZ2ludCI7CiAgICAgICAgaWYgKC9eYnl0ZXMoWzEtOV18MVswLTldfDJbMC05XXwzWzAtMl0pPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyIgfHwgYXJnIGluc3RhbmNlb2YgVWludDhBcnJheTsKICAgICAgICBpZiAoL1thLXpdK1sxLTldezAsM30oXFtbMC05XXswLH1cXSkrJC8udGVzdChhYmlQYXJhbWV0ZXJUeXBlKSkgewogICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXJnKSAmJiBhcmcuZXZlcnkoKHgpID0+IGlzQXJnT2ZUeXBlKHgsIHsKICAgICAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgICAgICAvLyBQb3Agb2ZmIGBbXWAgb3IgYFtNXWAgZnJvbSBlbmQgb2YgdHlwZQogICAgICAgICAgICB0eXBlOiBhYmlQYXJhbWV0ZXJUeXBlLnJlcGxhY2UoLyhcW1swLTldezAsfVxdKSQvLCAiIikKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlcnMsIHRhcmdldFBhcmFtZXRlcnMsIGFyZ3MpIHsKICAgIGZvciAoY29uc3QgcGFyYW1ldGVySW5kZXggaW4gc291cmNlUGFyYW1ldGVycykgewogICAgICBjb25zdCBzb3VyY2VQYXJhbWV0ZXIgPSBzb3VyY2VQYXJhbWV0ZXJzW3BhcmFtZXRlckluZGV4XTsKICAgICAgY29uc3QgdGFyZ2V0UGFyYW1ldGVyID0gdGFyZ2V0UGFyYW1ldGVyc1twYXJhbWV0ZXJJbmRleF07CiAgICAgIGlmIChzb3VyY2VQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiB0YXJnZXRQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gc291cmNlUGFyYW1ldGVyICYmICJjb21wb25lbnRzIiBpbiB0YXJnZXRQYXJhbWV0ZXIpCiAgICAgICAgcmV0dXJuIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlci5jb21wb25lbnRzLCB0YXJnZXRQYXJhbWV0ZXIuY29tcG9uZW50cywgYXJnc1twYXJhbWV0ZXJJbmRleF0pOwogICAgICBjb25zdCB0eXBlcyA9IFtzb3VyY2VQYXJhbWV0ZXIudHlwZSwgdGFyZ2V0UGFyYW1ldGVyLnR5cGVdOwogICAgICBjb25zdCBhbWJpZ3VvdXMgPSAoKCkgPT4gewogICAgICAgIGlmICh0eXBlcy5pbmNsdWRlcygiYWRkcmVzcyIpICYmIHR5cGVzLmluY2x1ZGVzKCJieXRlczIwIikpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAodHlwZXMuaW5jbHVkZXMoImFkZHJlc3MiKSAmJiB0eXBlcy5pbmNsdWRlcygic3RyaW5nIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgaWYgKHR5cGVzLmluY2x1ZGVzKCJhZGRyZXNzIikgJiYgdHlwZXMuaW5jbHVkZXMoImJ5dGVzIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KSgpOwogICAgICBpZiAoYW1iaWd1b3VzKQogICAgICAgIHJldHVybiB0eXBlczsKICAgIH0KICAgIHJldHVybjsKICB9CiAgdmFyIGluaXRfZ2V0QWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2dldEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2lzSGV4KCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9wYXJzZUFjY291bnQuanMKICBmdW5jdGlvbiBwYXJzZUFjY291bnQoYWNjb3VudCkgewogICAgaWYgKHR5cGVvZiBhY2NvdW50ID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHsgYWRkcmVzczogYWNjb3VudCwgdHlwZTogImpzb24tcnBjIiB9OwogICAgcmV0dXJuIGFjY291bnQ7CiAgfQogIHZhciBpbml0X3BhcnNlQWNjb3VudCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcGFyc2VBY2NvdW50LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhLmpzCiAgZnVuY3Rpb24gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7CiAgICAgICAgYWJpOiBhYmkyLAogICAgICAgIGFyZ3MsCiAgICAgICAgbmFtZTogZnVuY3Rpb25OYW1lCiAgICAgIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoMiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGgyIH0pOwogICAgcmV0dXJuIHsKICAgICAgYWJpOiBbYWJpSXRlbV0sCiAgICAgIGZ1bmN0aW9uTmFtZTogdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pKQogICAgfTsKICB9CiAgdmFyIGRvY3NQYXRoMjsKICB2YXIgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YS5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGRvY3NQYXRoMiA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVGdW5jdGlvbkRhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uRGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lIH0gPSAoKCkgPT4gewogICAgICBpZiAocGFyYW1ldGVycy5hYmkubGVuZ3RoID09PSAxICYmIHBhcmFtZXRlcnMuZnVuY3Rpb25OYW1lPy5zdGFydHNXaXRoKCIweCIpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzOwogICAgICByZXR1cm4gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKTsKICAgIH0pKCk7CiAgICBjb25zdCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IGZ1bmN0aW9uTmFtZTsKICAgIGNvbnN0IGRhdGEgPSAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzID8gZW5jb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cywgYXJncyA/PyBbXSkgOiB2b2lkIDA7CiAgICByZXR1cm4gY29uY2F0SGV4KFtzaWduYXR1cmUsIGRhdGEgPz8gIjB4Il0pOwogIH0KICB2YXIgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVGdW5jdGlvbkRhdGEuanMiKCkgewogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMKICB2YXIgcGFuaWNSZWFzb25zLCBzb2xpZGl0eUVycm9yLCBzb2xpZGl0eVBhbmljOwogIHZhciBpbml0X3NvbGlkaXR5ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMiKCkgewogICAgICBwYW5pY1JlYXNvbnMgPSB7CiAgICAgICAgMTogIkFuIGBhc3NlcnRgIGNvbmRpdGlvbiBmYWlsZWQuIiwKICAgICAgICAxNzogIkFyaXRobWV0aWMgb3BlcmF0aW9uIHJlc3VsdGVkIGluIHVuZGVyZmxvdyBvciBvdmVyZmxvdy4iLAogICAgICAgIDE4OiAiRGl2aXNpb24gb3IgbW9kdWxvIGJ5IHplcm8gKGUuZy4gYDUgLyAwYCBvciBgMjMgJSAwYCkuIiwKICAgICAgICAzMzogIkF0dGVtcHRlZCB0byBjb252ZXJ0IHRvIGFuIGludmFsaWQgdHlwZS4iLAogICAgICAgIDM0OiAiQXR0ZW1wdGVkIHRvIGFjY2VzcyBhIHN0b3JhZ2UgYnl0ZSBhcnJheSB0aGF0IGlzIGluY29ycmVjdGx5IGVuY29kZWQuIiwKICAgICAgICA0OTogIlBlcmZvcm1lZCBgLnBvcCgpYCBvbiBhbiBlbXB0eSBhcnJheSIsCiAgICAgICAgNTA6ICJBcnJheSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLiIsCiAgICAgICAgNjU6ICJBbGxvY2F0ZWQgdG9vIG11Y2ggbWVtb3J5IG9yIGNyZWF0ZWQgYW4gYXJyYXkgd2hpY2ggaXMgdG9vIGxhcmdlLiIsCiAgICAgICAgODE6ICJBdHRlbXB0ZWQgdG8gY2FsbCBhIHplcm8taW5pdGlhbGl6ZWQgdmFyaWFibGUgb2YgaW50ZXJuYWwgZnVuY3Rpb24gdHlwZS4iCiAgICAgIH07CiAgICAgIHNvbGlkaXR5RXJyb3IgPSB7CiAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICJtZXNzYWdlIiwKICAgICAgICAgICAgdHlwZTogInN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFcnJvciIsCiAgICAgICAgdHlwZTogImVycm9yIgogICAgICB9OwogICAgICBzb2xpZGl0eVBhbmljID0gewogICAgICAgIGlucHV0czogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAicmVhc29uIiwKICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBuYW1lOiAiUGFuaWMiLAogICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jdXJzb3IuanMKICB2YXIgTmVnYXRpdmVPZmZzZXRFcnJvciwgUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yLCBSZWN1cnNpdmVSZWFkTGltaXRFeGNlZWRlZEVycm9yOwogIHZhciBpbml0X2N1cnNvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBOZWdhdGl2ZU9mZnNldEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCB9KSB7CiAgICAgICAgICBzdXBlcihgT2Zmc2V0IFxgJHtvZmZzZXR9XGAgY2Fubm90IGJlIG5lZ2F0aXZlLmAsIHsKICAgICAgICAgICAgbmFtZTogIk5lZ2F0aXZlT2Zmc2V0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFBvc2l0aW9uT3V0T2ZCb3VuZHNFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBsZW5ndGgsIHBvc2l0aW9uIH0pIHsKICAgICAgICAgIHN1cGVyKGBQb3NpdGlvbiBcYCR7cG9zaXRpb259XGAgaXMgb3V0IG9mIGJvdW5kcyAoXGAwIDwgcG9zaXRpb24gPCAke2xlbmd0aH1cYCkuYCwgeyBuYW1lOiAiUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY291bnQsIGxpbWl0IH0pIHsKICAgICAgICAgIHN1cGVyKGBSZWN1cnNpdmUgcmVhZCBsaW1pdCBvZiBcYCR7bGltaXR9XGAgZXhjZWVkZWQgKHJlY3Vyc2l2ZSByZWFkIGNvdW50OiBcYCR7Y291bnR9XGApLmAsIHsgbmFtZTogIlJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUN1cnNvcihieXRlczIsIHsgcmVjdXJzaXZlUmVhZExpbWl0ID0gODE5MiB9ID0ge30pIHsKICAgIGNvbnN0IGN1cnNvciA9IE9iamVjdC5jcmVhdGUoc3RhdGljQ3Vyc29yKTsKICAgIGN1cnNvci5ieXRlcyA9IGJ5dGVzMjsKICAgIGN1cnNvci5kYXRhVmlldyA9IG5ldyBEYXRhVmlldyhieXRlczIuYnVmZmVyLCBieXRlczIuYnl0ZU9mZnNldCwgYnl0ZXMyLmJ5dGVMZW5ndGgpOwogICAgY3Vyc29yLnBvc2l0aW9uUmVhZENvdW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGN1cnNvci5yZWN1cnNpdmVSZWFkTGltaXQgPSByZWN1cnNpdmVSZWFkTGltaXQ7CiAgICByZXR1cm4gY3Vyc29yOwogIH0KICB2YXIgc3RhdGljQ3Vyc29yOwogIHZhciBpbml0X2N1cnNvcjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfY3Vyc29yKCk7CiAgICAgIHN0YXRpY0N1cnNvciA9IHsKICAgICAgICBieXRlczogbmV3IFVpbnQ4QXJyYXkoKSwKICAgICAgICBkYXRhVmlldzogbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigwKSksCiAgICAgICAgcG9zaXRpb246IDAsCiAgICAgICAgcG9zaXRpb25SZWFkQ291bnQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksCiAgICAgICAgcmVjdXJzaXZlUmVhZENvdW50OiAwLAogICAgICAgIHJlY3Vyc2l2ZVJlYWRMaW1pdDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLAogICAgICAgIGFzc2VydFJlYWRMaW1pdCgpIHsKICAgICAgICAgIGlmICh0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCA+PSB0aGlzLnJlY3Vyc2l2ZVJlYWRMaW1pdCkKICAgICAgICAgICAgdGhyb3cgbmV3IFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IoewogICAgICAgICAgICAgIGNvdW50OiB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCArIDEsCiAgICAgICAgICAgICAgbGltaXQ6IHRoaXMucmVjdXJzaXZlUmVhZExpbWl0CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pIHsKICAgICAgICAgIGlmIChwb3NpdGlvbiA8IDAgfHwgcG9zaXRpb24gPiB0aGlzLmJ5dGVzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgIHRocm93IG5ldyBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IoewogICAgICAgICAgICAgIGxlbmd0aDogdGhpcy5ieXRlcy5sZW5ndGgsCiAgICAgICAgICAgICAgcG9zaXRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBkZWNyZW1lbnRQb3NpdGlvbihvZmZzZXQpIHsKICAgICAgICAgIGlmIChvZmZzZXQgPCAwKQogICAgICAgICAgICB0aHJvdyBuZXcgTmVnYXRpdmVPZmZzZXRFcnJvcih7IG9mZnNldCB9KTsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiAtIG9mZnNldDsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgZ2V0UmVhZENvdW50KHBvc2l0aW9uKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvblJlYWRDb3VudC5nZXQocG9zaXRpb24gfHwgdGhpcy5wb3NpdGlvbikgfHwgMDsKICAgICAgICB9LAogICAgICAgIGluY3JlbWVudFBvc2l0aW9uKG9mZnNldCkgewogICAgICAgICAgaWYgKG9mZnNldCA8IDApCiAgICAgICAgICAgIHRocm93IG5ldyBOZWdhdGl2ZU9mZnNldEVycm9yKHsgb2Zmc2V0IH0pOwogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uICsgb2Zmc2V0OwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0Qnl0ZShwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzW3Bvc2l0aW9uXTsKICAgICAgICB9LAogICAgICAgIGluc3BlY3RCeXRlcyhsZW5ndGgsIHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyBsZW5ndGggLSAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLnN1YmFycmF5KHBvc2l0aW9uLCBwb3NpdGlvbiArIGxlbmd0aCk7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDgocG9zaXRpb25fKSB7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBvc2l0aW9uXyA/PyB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICByZXR1cm4gdGhpcy5ieXRlc1twb3NpdGlvbl07CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDE2KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFWaWV3LmdldFVpbnQxNihwb3NpdGlvbik7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDI0KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAyKTsKICAgICAgICAgIHJldHVybiAodGhpcy5kYXRhVmlldy5nZXRVaW50MTYocG9zaXRpb24pIDw8IDgpICsgdGhpcy5kYXRhVmlldy5nZXRVaW50OChwb3NpdGlvbiArIDIpOwogICAgICAgIH0sCiAgICAgICAgaW5zcGVjdFVpbnQzMihwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uICsgMyk7CiAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhVmlldy5nZXRVaW50MzIocG9zaXRpb24pOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGUoYnl0ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSBieXRlOwogICAgICAgICAgdGhpcy5wb3NpdGlvbisrOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGVzKGJ5dGVzMikgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgYnl0ZXMyLmxlbmd0aCAtIDEpOwogICAgICAgICAgdGhpcy5ieXRlcy5zZXQoYnl0ZXMyLCB0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gYnl0ZXMyLmxlbmd0aDsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50OCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSB2YWx1ZTsKICAgICAgICAgIHRoaXMucG9zaXRpb24rKzsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50MTYodmFsdWUpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24odGhpcy5wb3NpdGlvbiArIDEpOwogICAgICAgICAgdGhpcy5kYXRhVmlldy5zZXRVaW50MTYodGhpcy5wb3NpdGlvbiwgdmFsdWUpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAyOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQyNCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMik7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQxNih0aGlzLnBvc2l0aW9uLCB2YWx1ZSA+PiA4KTsKICAgICAgICAgIHRoaXMuZGF0YVZpZXcuc2V0VWludDgodGhpcy5wb3NpdGlvbiArIDIsIHZhbHVlICYgfjQyOTQ5NjcwNDApOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAzOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQzMih2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMyk7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQzMih0aGlzLnBvc2l0aW9uLCB2YWx1ZSk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDQ7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZSgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RCeXRlKCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uKys7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZXMobGVuZ3RoLCBzaXplMykgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdEJ5dGVzKGxlbmd0aCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IHNpemUzID8/IGxlbmd0aDsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50OCgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50OCgpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAxOwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgcmVhZFVpbnQxNigpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50MTYoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gMjsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50MjQoKSB7CiAgICAgICAgICB0aGlzLmFzc2VydFJlYWRMaW1pdCgpOwogICAgICAgICAgdGhpcy5fdG91Y2goKTsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5pbnNwZWN0VWludDI0KCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDM7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkVWludDMyKCkgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdFVpbnQzMigpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSA0OwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgZ2V0IHJlbWFpbmluZygpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMucG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBzZXRQb3NpdGlvbihwb3NpdGlvbikgewogICAgICAgICAgY29uc3Qgb2xkUG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgICByZXR1cm4gKCkgPT4gdGhpcy5wb3NpdGlvbiA9IG9sZFBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgX3RvdWNoKCkgewogICAgICAgICAgaWYgKHRoaXMucmVjdXJzaXZlUmVhZExpbWl0ID09PSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNvdW50ID0gdGhpcy5nZXRSZWFkQ291bnQoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb25SZWFkQ291bnQuc2V0KHRoaXMucG9zaXRpb24sIGNvdW50ICsgMSk7CiAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCsrOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21CeXRlcy5qcwogIGZ1bmN0aW9uIGZyb21CeXRlcyhieXRlczIsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBieXRlc1RvTnVtYmVyKGJ5dGVzMiwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJiaWdpbnQiKQogICAgICByZXR1cm4gYnl0ZXNUb0JpZ0ludChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYm9vbGVhbiIpCiAgICAgIHJldHVybiBieXRlc1RvQm9vbChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGJ5dGVzVG9TdHJpbmcoYnl0ZXMyLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KGJ5dGVzMiwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9CaWdJbnQoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9Cb29sKGJ5dGVzXywgb3B0cyA9IHt9KSB7CiAgICBsZXQgYnl0ZXMyID0gYnl0ZXNfOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgYnl0ZXMyID0gdHJpbShieXRlczIpOwogICAgfQogICAgaWYgKGJ5dGVzMi5sZW5ndGggPiAxIHx8IGJ5dGVzMlswXSA+IDEpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IoYnl0ZXMyKTsKICAgIHJldHVybiBCb29sZWFuKGJ5dGVzMlswXSk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9OdW1iZXIoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvTnVtYmVyKGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXNfLCBvcHRzID0ge30pIHsKICAgIGxldCBieXRlczIgPSBieXRlc187CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21CeXRlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUJ5dGVzLmpzIigpIHsKICAgICAgaW5pdF9lbmNvZGluZygpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZGVjb2RlQWJpUGFyYW1ldGVycyhwYXJhbXMsIGRhdGEpIHsKICAgIGNvbnN0IGJ5dGVzMiA9IHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiA/IGhleFRvQnl0ZXMoZGF0YSkgOiBkYXRhOwogICAgY29uc3QgY3Vyc29yID0gY3JlYXRlQ3Vyc29yKGJ5dGVzMik7CiAgICBpZiAoc2l6ZShieXRlczIpID09PSAwICYmIHBhcmFtcy5sZW5ndGggPiAwKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBpZiAoc2l6ZShkYXRhKSAmJiBzaXplKGRhdGEpIDwgMzIpCiAgICAgIHRocm93IG5ldyBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvcih7CiAgICAgICAgZGF0YTogdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciID8gZGF0YSA6IGJ5dGVzVG9IZXgoZGF0YSksCiAgICAgICAgcGFyYW1zLAogICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgfSk7CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWVzID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7ICsraSkgewogICAgICBjb25zdCBwYXJhbSA9IHBhcmFtc1tpXTsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKGNvbnN1bWVkKTsKICAgICAgY29uc3QgW2RhdGEyLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgcGFyYW0sIHsKICAgICAgICBzdGF0aWNQb3NpdGlvbjogMAogICAgICB9KTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgICB2YWx1ZXMucHVzaChkYXRhMik7CiAgICB9CiAgICByZXR1cm4gdmFsdWVzOwogIH0KICBmdW5jdGlvbiBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZGVjb2RlQXJyYXkoY3Vyc29yLCB7IC4uLnBhcmFtLCB0eXBlIH0sIHsgbGVuZ3RoLCBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gZGVjb2RlVHVwbGUoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIGlmIChwYXJhbS50eXBlID09PSAiYWRkcmVzcyIpCiAgICAgIHJldHVybiBkZWNvZGVBZGRyZXNzKGN1cnNvcik7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImJvb2wiKQogICAgICByZXR1cm4gZGVjb2RlQm9vbChjdXJzb3IpOwogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiYnl0ZXMiKSkKICAgICAgcmV0dXJuIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgcmV0dXJuIGRlY29kZU51bWJlcihjdXJzb3IsIHBhcmFtKTsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGRlY29kZVN0cmluZyhjdXJzb3IsIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICB0aHJvdyBuZXcgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yKHBhcmFtLnR5cGUsIHsKICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVBYmlQYXJhbWV0ZXJzIgogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGRlY29kZUFkZHJlc3MoY3Vyc29yKSB7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFtjaGVja3N1bUFkZHJlc3MoYnl0ZXNUb0hleChzbGljZUJ5dGVzKHZhbHVlLCAtMjApKSksIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlQXJyYXkoY3Vyc29yLCBwYXJhbSwgeyBsZW5ndGgsIHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGlmICghbGVuZ3RoKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3Qgc3RhcnRPZkRhdGEgPSBzdGFydCArIHNpemVPZkxlbmd0aDsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0KTsKICAgICAgY29uc3QgbGVuZ3RoMiA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZMZW5ndGgpKTsKICAgICAgY29uc3QgZHluYW1pY0NoaWxkID0gaGFzRHluYW1pY0NoaWxkKHBhcmFtKTsKICAgICAgbGV0IGNvbnN1bWVkMiA9IDA7CiAgICAgIGNvbnN0IHZhbHVlMiA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDI7ICsraSkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydE9mRGF0YSArIChkeW5hbWljQ2hpbGQgPyBpICogMzIgOiBjb25zdW1lZDIpKTsKICAgICAgICBjb25zdCBbZGF0YSwgY29uc3VtZWRfXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnRPZkRhdGEKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZDIgKz0gY29uc3VtZWRfOwogICAgICAgIHZhbHVlMi5wdXNoKGRhdGEpOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZTIsIDMyXTsKICAgIH0KICAgIGlmIChoYXNEeW5hbWljQ2hpbGQocGFyYW0pKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3QgdmFsdWUyID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhcnQgKyBpICogMzIpOwogICAgICAgIGNvbnN0IFtkYXRhXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICB2YWx1ZTIucHVzaChkYXRhKTsKICAgICAgfQogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbdmFsdWUyLCAzMl07CiAgICB9CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWUgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgY29uc3QgW2RhdGEsIGNvbnN1bWVkX10gPSBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgewogICAgICAgIHN0YXRpY1Bvc2l0aW9uOiBzdGF0aWNQb3NpdGlvbiArIGNvbnN1bWVkCiAgICAgIH0pOwogICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgIHZhbHVlLnB1c2goZGF0YSk7CiAgICB9CiAgICByZXR1cm4gW3ZhbHVlLCBjb25zdW1lZF07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJvb2woY3Vyc29yKSB7CiAgICByZXR1cm4gW2J5dGVzVG9Cb29sKGN1cnNvci5yZWFkQnl0ZXMoMzIpLCB7IHNpemU6IDMyIH0pLCAzMl07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSkgewogICAgY29uc3QgW18sIHNpemUzXSA9IHBhcmFtLnR5cGUuc3BsaXQoImJ5dGVzIik7CiAgICBpZiAoIXNpemUzKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyBvZmZzZXQpOwogICAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgICAgaWYgKGxlbmd0aCA9PT0gMCkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgICByZXR1cm4gWyIweCIsIDMyXTsKICAgICAgfQogICAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbYnl0ZXNUb0hleChkYXRhKSwgMzJdOwogICAgfQogICAgY29uc3QgdmFsdWUgPSBieXRlc1RvSGV4KGN1cnNvci5yZWFkQnl0ZXMoTnVtYmVyLnBhcnNlSW50KHNpemUzKSwgMzIpKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlTnVtYmVyKGN1cnNvciwgcGFyYW0pIHsKICAgIGNvbnN0IHNpZ25lZCA9IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50Iik7CiAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChwYXJhbS50eXBlLnNwbGl0KCJpbnQiKVsxXSB8fCAiMjU2Iik7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFsKICAgICAgc2l6ZTMgPiA0OCA/IGJ5dGVzVG9CaWdJbnQodmFsdWUsIHsgc2lnbmVkIH0pIDogYnl0ZXNUb051bWJlcih2YWx1ZSwgeyBzaWduZWQgfSksCiAgICAgIDMyCiAgICBdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVUdXBsZShjdXJzb3IsIHBhcmFtLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IGhhc1VubmFtZWRDaGlsZCA9IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoID09PSAwIHx8IHBhcmFtLmNvbXBvbmVudHMuc29tZSgoeyBuYW1lIH0pID0+ICFuYW1lKTsKICAgIGNvbnN0IHZhbHVlID0gaGFzVW5uYW1lZENoaWxkID8gW10gOiB7fTsKICAgIGxldCBjb25zdW1lZCA9IDA7CiAgICBpZiAoaGFzRHluYW1pY0NoaWxkKHBhcmFtKSkgewogICAgICBjb25zdCBvZmZzZXQgPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoc2l6ZU9mT2Zmc2V0KSk7CiAgICAgIGNvbnN0IHN0YXJ0ID0gc3RhdGljUG9zaXRpb24gKyBvZmZzZXQ7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW0uY29tcG9uZW50cy5sZW5ndGg7ICsraSkgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0ICsgY29uc3VtZWQpOwogICAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgICAgdmFsdWVbaGFzVW5uYW1lZENoaWxkID8gaSA6IGNvbXBvbmVudD8ubmFtZV0gPSBkYXRhOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZSwgMzJdOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbS5jb21wb25lbnRzLmxlbmd0aDsgKytpKSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgc3RhdGljUG9zaXRpb24KICAgICAgfSk7CiAgICAgIHZhbHVlW2hhc1VubmFtZWRDaGlsZCA/IGkgOiBjb21wb25lbnQ/Lm5hbWVdID0gZGF0YTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgfQogICAgcmV0dXJuIFt2YWx1ZSwgY29uc3VtZWRdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVTdHJpbmcoY3Vyc29yLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydCk7CiAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXRpY1Bvc2l0aW9uICsgMzIpOwogICAgICByZXR1cm4gWyIiLCAzMl07CiAgICB9CiAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgsIDMyKTsKICAgIGNvbnN0IHZhbHVlID0gYnl0ZXNUb1N0cmluZyh0cmltKGRhdGEpKTsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gaGFzRHluYW1pY0NoaWxkKHBhcmFtKSB7CiAgICBjb25zdCB7IHR5cGUgfSA9IHBhcmFtOwogICAgaWYgKHR5cGUgPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlLmVuZHNXaXRoKCJbXSIpKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gcGFyYW0uY29tcG9uZW50cz8uc29tZShoYXNEeW5hbWljQ2hpbGQpOwogICAgY29uc3QgYXJyYXlDb21wb25lbnRzID0gZ2V0QXJyYXlDb21wb25lbnRzKHBhcmFtLnR5cGUpOwogICAgaWYgKGFycmF5Q29tcG9uZW50cyAmJiBoYXNEeW5hbWljQ2hpbGQoeyAuLi5wYXJhbSwgdHlwZTogYXJyYXlDb21wb25lbnRzWzFdIH0pKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgdmFyIHNpemVPZkxlbmd0aCwgc2l6ZU9mT2Zmc2V0OwogIHZhciBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGluaXRfY3Vyc29yMigpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tQnl0ZXMoKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIHNpemVPZkxlbmd0aCA9IDMyOwogICAgICBzaXplT2ZPZmZzZXQgPSAzMjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVFcnJvclJlc3VsdC5qcwogIGZ1bmN0aW9uIGRlY29kZUVycm9yUmVzdWx0KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlID0gc2xpY2UoZGF0YSwgMCwgNCk7CiAgICBpZiAoc2lnbmF0dXJlID09PSAiMHgiKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBjb25zdCBhYmlfID0gWy4uLmFiaTIgfHwgW10sIHNvbGlkaXR5RXJyb3IsIHNvbGlkaXR5UGFuaWNdOwogICAgY29uc3QgYWJpSXRlbSA9IGFiaV8uZmluZCgoeCkgPT4geC50eXBlID09PSAiZXJyb3IiICYmIHNpZ25hdHVyZSA9PT0gdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKHgpKSk7CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVFcnJvclJlc3VsdCIKICAgICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmlJdGVtLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzICYmIGFiaUl0ZW0uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzLCBzbGljZShkYXRhLCA0KSkgOiB2b2lkIDAsCiAgICAgIGVycm9yTmFtZTogYWJpSXRlbS5uYW1lCiAgICB9OwogIH0KICB2YXIgaW5pdF9kZWNvZGVFcnJvclJlc3VsdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUVycm9yUmVzdWx0LmpzIigpIHsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X3NsaWNlKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zdHJpbmdpZnkuanMKICB2YXIgc3RyaW5naWZ5OwogIHZhciBpbml0X3N0cmluZ2lmeSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc3RyaW5naWZ5LmpzIigpIHsKICAgICAgc3RyaW5naWZ5ID0gKHZhbHVlLCByZXBsYWNlciwgc3BhY2UpID0+IEpTT04uc3RyaW5naWZ5KHZhbHVlLCAoa2V5LCB2YWx1ZV8pID0+IHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/IHZhbHVlXy50b1N0cmluZygpIDogdmFsdWVfOwogICAgICAgIHJldHVybiB0eXBlb2YgcmVwbGFjZXIgPT09ICJmdW5jdGlvbiIgPyByZXBsYWNlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7CiAgICAgIH0sIHNwYWNlKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoeyBhYmlJdGVtLCBhcmdzLCBpbmNsdWRlRnVuY3Rpb25OYW1lID0gdHJ1ZSwgaW5jbHVkZU5hbWUgPSBmYWxzZSB9KSB7CiAgICBpZiAoISgibmFtZSIgaW4gYWJpSXRlbSkpCiAgICAgIHJldHVybjsKICAgIGlmICghKCJpbnB1dHMiIGluIGFiaUl0ZW0pKQogICAgICByZXR1cm47CiAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICByZXR1cm47CiAgICByZXR1cm4gYCR7aW5jbHVkZUZ1bmN0aW9uTmFtZSA/IGFiaUl0ZW0ubmFtZSA6ICIifSgke2FiaUl0ZW0uaW5wdXRzLm1hcCgoaW5wdXQsIGkpID0+IGAke2luY2x1ZGVOYW1lICYmIGlucHV0Lm5hbWUgPyBgJHtpbnB1dC5uYW1lfTogYCA6ICIifSR7dHlwZW9mIGFyZ3NbaV0gPT09ICJvYmplY3QiID8gc3RyaW5naWZ5KGFyZ3NbaV0pIDogYXJnc1tpXX1gKS5qb2luKCIsICIpfSlgOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMiKCkgewogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3VuaXQuanMKICB2YXIgZXRoZXJVbml0cywgZ3dlaVVuaXRzLCB3ZWlVbml0czsKICB2YXIgaW5pdF91bml0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvdW5pdC5qcyIoKSB7CiAgICAgIGV0aGVyVW5pdHMgPSB7CiAgICAgICAgZ3dlaTogOSwKICAgICAgICB3ZWk6IDE4CiAgICAgIH07CiAgICAgIGd3ZWlVbml0cyA9IHsKICAgICAgICBldGhlcjogLTksCiAgICAgICAgd2VpOiA5CiAgICAgIH07CiAgICAgIHdlaVVuaXRzID0gewogICAgICAgIGV0aGVyOiAtMTgsCiAgICAgICAgZ3dlaTogLTkKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0VW5pdHMuanMKICBmdW5jdGlvbiBmb3JtYXRVbml0cyh2YWx1ZSwgZGVjaW1hbHMpIHsKICAgIGxldCBkaXNwbGF5ID0gdmFsdWUudG9TdHJpbmcoKTsKICAgIGNvbnN0IG5lZ2F0aXZlID0gZGlzcGxheS5zdGFydHNXaXRoKCItIik7CiAgICBpZiAobmVnYXRpdmUpCiAgICAgIGRpc3BsYXkgPSBkaXNwbGF5LnNsaWNlKDEpOwogICAgZGlzcGxheSA9IGRpc3BsYXkucGFkU3RhcnQoZGVjaW1hbHMsICIwIik7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uXSA9IFsKICAgICAgZGlzcGxheS5zbGljZSgwLCBkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKSwKICAgICAgZGlzcGxheS5zbGljZShkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKQogICAgXTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICByZXR1cm4gYCR7bmVnYXRpdmUgPyAiLSIgOiAiIn0ke2ludGVnZXIgfHwgIjAifSR7ZnJhY3Rpb24gPyBgLiR7ZnJhY3Rpb259YCA6ICIifWA7CiAgfQogIHZhciBpbml0X2Zvcm1hdFVuaXRzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdFVuaXRzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0RXRoZXIuanMKICBmdW5jdGlvbiBmb3JtYXRFdGhlcih3ZWksIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIGZvcm1hdFVuaXRzKHdlaSwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEV0aGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdEV0aGVyLmpzIigpIHsKICAgICAgaW5pdF91bml0KCk7CiAgICAgIGluaXRfZm9ybWF0VW5pdHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcwogIGZ1bmN0aW9uIGZvcm1hdEd3ZWkod2VpLCB1bml0ID0gIndlaSIpIHsKICAgIHJldHVybiBmb3JtYXRVbml0cyh3ZWksIGd3ZWlVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEd3ZWkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcyIoKSB7CiAgICAgIGluaXRfdW5pdCgpOwogICAgICBpbml0X2Zvcm1hdFVuaXRzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvc3RhdGVPdmVycmlkZS5qcwogIGZ1bmN0aW9uIHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZU1hcHBpbmcpIHsKICAgIHJldHVybiBzdGF0ZU1hcHBpbmcucmVkdWNlKChwcmV0dHksIHsgc2xvdCwgdmFsdWUgfSkgPT4gewogICAgICByZXR1cm4gYCR7cHJldHR5fSAgICAgICAgJHtzbG90fTogJHt2YWx1ZX0KYDsKICAgIH0sICIiKTsKICB9CiAgZnVuY3Rpb24gcHJldHR5U3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKSB7CiAgICByZXR1cm4gc3RhdGVPdmVycmlkZS5yZWR1Y2UoKHByZXR0eSwgeyBhZGRyZXNzLCAuLi5zdGF0ZSB9KSA9PiB7CiAgICAgIGxldCB2YWwgPSBgJHtwcmV0dHl9ICAgICR7YWRkcmVzc306CmA7CiAgICAgIGlmIChzdGF0ZS5ub25jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIG5vbmNlOiAke3N0YXRlLm5vbmNlfQpgOwogICAgICBpZiAoc3RhdGUuYmFsYW5jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIGJhbGFuY2U6ICR7c3RhdGUuYmFsYW5jZX0KYDsKICAgICAgaWYgKHN0YXRlLmNvZGUpCiAgICAgICAgdmFsICs9IGAgICAgICBjb2RlOiAke3N0YXRlLmNvZGV9CmA7CiAgICAgIGlmIChzdGF0ZS5zdGF0ZSkgewogICAgICAgIHZhbCArPSAiICAgICAgc3RhdGU6XG4iOwogICAgICAgIHZhbCArPSBwcmV0dHlTdGF0ZU1hcHBpbmcoc3RhdGUuc3RhdGUpOwogICAgICB9CiAgICAgIGlmIChzdGF0ZS5zdGF0ZURpZmYpIHsKICAgICAgICB2YWwgKz0gIiAgICAgIHN0YXRlRGlmZjpcbiI7CiAgICAgICAgdmFsICs9IHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZS5zdGF0ZURpZmYpOwogICAgICB9CiAgICAgIHJldHVybiB2YWw7CiAgICB9LCAiICBTdGF0ZSBPdmVycmlkZTpcbiIpLnNsaWNlKDAsIC0xKTsKICB9CiAgdmFyIEFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IsIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3I7CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWNjb3VudFN0YXRlQ29uZmxpY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTdGF0ZSBmb3IgYWNjb3VudCAiJHthZGRyZXNzfSIgaXMgc2V0IG11bHRpcGxlIHRpbWVzLmAsIHsKICAgICAgICAgICAgbmFtZTogIkFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoInN0YXRlIGFuZCBzdGF0ZURpZmYgYXJlIHNldCBvbiB0aGUgc2FtZSBhY2NvdW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIlN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdHJhbnNhY3Rpb24uanMKICBmdW5jdGlvbiBwcmV0dHlQcmludChhcmdzKSB7CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoYXJncykubWFwKChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgfHwgdmFsdWUgPT09IGZhbHNlKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gW2tleSwgdmFsdWVdOwogICAgfSkuZmlsdGVyKEJvb2xlYW4pOwogICAgY29uc3QgbWF4TGVuZ3RoID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2tleV0pID0+IE1hdGgubWF4KGFjYywga2V5Lmxlbmd0aCksIDApOwogICAgcmV0dXJuIGVudHJpZXMubWFwKChba2V5LCB2YWx1ZV0pID0+IGAgICR7YCR7a2V5fTpgLnBhZEVuZChtYXhMZW5ndGggKyAxKX0gICR7dmFsdWV9YCkuam9pbigiXG4iKTsKICB9CiAgdmFyIEZlZUNvbmZsaWN0RXJyb3IsIEludmFsaWRMZWdhY3lWRXJyb3IsIEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsIEludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yLCBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLCBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IsIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb24gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc2FjdGlvbi5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBGZWVDb25mbGljdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkNhbm5vdCBzcGVjaWZ5IGJvdGggYSBgZ2FzUHJpY2VgIGFuZCBhIGBtYXhGZWVQZXJHYXNgL2BtYXhQcmlvcml0eUZlZVBlckdhc2AuIiwKICAgICAgICAgICAgIlVzZSBgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGZvciBFSVAtMTU1OSBjb21wYXRpYmxlIG5ldHdvcmtzLCBhbmQgYGdhc1ByaWNlYCBmb3Igb3RoZXJzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiRmVlQ29uZmxpY3RFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkTGVnYWN5VkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHYgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgXGB2XGAgdmFsdWUgIiR7dn0iLiBFeHBlY3RlZCAyNyBvciAyOC5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkTGVnYWN5VkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXphYmxlVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0cmFuc2FjdGlvbiB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGluZmVyIGEgdHJhbnNhY3Rpb24gdHlwZSBmcm9tIHByb3ZpZGVkIHRyYW5zYWN0aW9uLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlByb3ZpZGVkIFRyYW5zYWN0aW9uOiIsCiAgICAgICAgICAgICAgInsiLAogICAgICAgICAgICAgIHByZXR0eVByaW50KHRyYW5zYWN0aW9uKSwKICAgICAgICAgICAgICAifSIsCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgIlRvIGluZmVyIHRoZSB0eXBlLCBlaXRoZXIgcHJvdmlkZToiLAogICAgICAgICAgICAgICItIGEgYHR5cGVgIHRvIHRoZSBUcmFuc2FjdGlvbiwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC0xNTU5IFRyYW5zYWN0aW9uIHdpdGggYG1heEZlZVBlckdhc2AsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtMjkzMCBUcmFuc2FjdGlvbiB3aXRoIGBnYXNQcmljZWAgJiBgYWNjZXNzTGlzdGAsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtNDg0NCBUcmFuc2FjdGlvbiB3aXRoIGBibG9ic2AsIGBibG9iVmVyc2lvbmVkSGFzaGVzYCwgYHNpZGVjYXJzYCwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC03NzAyIFRyYW5zYWN0aW9uIHdpdGggYGF1dGhvcml6YXRpb25MaXN0YCwgb3IiLAogICAgICAgICAgICAgICItIGEgTGVnYWN5IFRyYW5zYWN0aW9uIHdpdGggYGdhc1ByaWNlYCIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNlcmlhbGl6ZWRUeXBlIH0pIHsKICAgICAgICAgIHN1cGVyKGBTZXJpYWxpemVkIHRyYW5zYWN0aW9uIHR5cGUgIiR7c2VyaWFsaXplZFR5cGV9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUeXBlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFR5cGUgPSBzZXJpYWxpemVkVHlwZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhdHRyaWJ1dGVzLCBzZXJpYWxpemVkVHJhbnNhY3Rpb24sIHR5cGUgfSkgewogICAgICAgICAgY29uc3QgbWlzc2luZyA9IE9iamVjdC5lbnRyaWVzKGF0dHJpYnV0ZXMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB0eXBlb2YgdmFsdWUgPT09ICJ1bmRlZmluZWQiID8ga2V5IDogdm9pZCAwKS5maWx0ZXIoQm9vbGVhbik7CiAgICAgICAgICBzdXBlcihgSW52YWxpZCBzZXJpYWxpemVkIHRyYW5zYWN0aW9uIG9mIHR5cGUgIiR7dHlwZX0iIHdhcyBwcm92aWRlZC5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBTZXJpYWxpemVkIFRyYW5zYWN0aW9uOiAiJHtzZXJpYWxpemVkVHJhbnNhY3Rpb259ImAsCiAgICAgICAgICAgICAgbWlzc2luZy5sZW5ndGggPiAwID8gYE1pc3NpbmcgQXR0cmlidXRlczogJHttaXNzaW5nLmpvaW4oIiwgIil9YCA6ICIiCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUcmFuc2FjdGlvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInR5cGUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBzZXJpYWxpemVkVHJhbnNhY3Rpb247CiAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc3RvcmFnZUtleSB9KSB7CiAgICAgICAgICBzdXBlcihgU2l6ZSBmb3Igc3RvcmFnZSBrZXkgIiR7c3RvcmFnZUtleX0iIGlzIGludmFsaWQuIEV4cGVjdGVkIDMyIGJ5dGVzLiBHb3QgJHtNYXRoLmZsb29yKChzdG9yYWdlS2V5Lmxlbmd0aCAtIDIpIC8gMil9IGJ5dGVzLmAsIHsgbmFtZTogIkludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGNoYWluLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlIH0pIHsKICAgICAgICAgIGNvbnN0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGNoYWluOiBjaGFpbiAmJiBgJHtjaGFpbj8ubmFtZX0gKGlkOiAke2NoYWluPy5pZH0pYCwKICAgICAgICAgICAgZnJvbTogYWNjb3VudD8uYWRkcmVzcywKICAgICAgICAgICAgdG8sCiAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgdmFsdWUgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEV0aGVyKHZhbHVlKX0gJHtjaGFpbj8ubmF0aXZlQ3VycmVuY3k/LnN5bWJvbCB8fCAiRVRIIn1gLAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBnYXMsCiAgICAgICAgICAgIGdhc1ByaWNlOiB0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEd3ZWkoZ2FzUHJpY2UpfSBnd2VpYCwKICAgICAgICAgICAgbWF4RmVlUGVyR2FzOiB0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heEZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgICAgIG5vbmNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgLi4uY2F1c2UubWV0YU1lc3NhZ2VzID8gWy4uLmNhdXNlLm1ldGFNZXNzYWdlcywgIiAiXSA6IFtdLAogICAgICAgICAgICAgICJSZXF1ZXN0IEFyZ3VtZW50czoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2F1c2UgPSBjYXVzZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgICAgICAgbGV0IGlkZW50aWZpZXIgPSAiVHJhbnNhY3Rpb24iOwogICAgICAgICAgaWYgKGJsb2NrVGFnICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIHRpbWUgIiR7YmxvY2tUYWd9IiBhdCBpbmRleCAiJHtpbmRleDJ9ImA7CiAgICAgICAgICBpZiAoYmxvY2tIYXNoICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIGhhc2ggIiR7YmxvY2tIYXNofSIgYXQgaW5kZXggIiR7aW5kZXgyfSJgOwogICAgICAgICAgaWYgKGJsb2NrTnVtYmVyICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIG51bWJlciAiJHtibG9ja051bWJlcn0iIGF0IGluZGV4ICIke2luZGV4Mn0iYDsKICAgICAgICAgIGlmIChoYXNoMykKICAgICAgICAgICAgaWRlbnRpZmllciA9IGBUcmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9ImA7CiAgICAgICAgICBzdXBlcihgJHtpZGVudGlmaWVyfSBjb3VsZCBub3QgYmUgZm91bmQuYCwgewogICAgICAgICAgICBuYW1lOiAiVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzIH0pIHsKICAgICAgICAgIHN1cGVyKGBUcmFuc2FjdGlvbiByZWNlaXB0IHdpdGggaGFzaCAiJHtoYXNoM30iIGNvdWxkIG5vdCBiZSBmb3VuZC4gVGhlIFRyYW5zYWN0aW9uIG1heSBub3QgYmUgcHJvY2Vzc2VkIG9uIGEgYmxvY2sgeWV0LmAsIHsKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMgfSkgewogICAgICAgICAgc3VwZXIoYFRpbWVkIG91dCB3aGlsZSB3YWl0aW5nIGZvciB0cmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9IiB0byBiZSBjb25maXJtZWQuYCwgeyBuYW1lOiAiV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzCiAgdmFyIGdldENvbnRyYWN0QWRkcmVzcywgZ2V0VXJsOwogIHZhciBpbml0X3V0aWxzMyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzIigpIHsKICAgICAgZ2V0Q29udHJhY3RBZGRyZXNzID0gKGFkZHJlc3MpID0+IGFkZHJlc3M7CiAgICAgIGdldFVybCA9ICh1cmwpID0+IHVybDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jb250cmFjdC5qcwogIHZhciBDYWxsRXhlY3V0aW9uRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25FeGVjdXRpb25FcnJvciwgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25aZXJvRGF0YUVycm9yLCBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciwgUmF3Q29udHJhY3RFcnJvcjsKICB2YXIgaW5pdF9jb250cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NvbnRyYWN0LmpzIigpIHsKICAgICAgaW5pdF9wYXJzZUFjY291bnQoKTsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBDYWxsRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQ6IGFjY291bnRfLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBjaGFpbiwgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSB9KSB7CiAgICAgICAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgICAgICAgbGV0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgIHRvLAogICAgICAgICAgICB2YWx1ZTogdHlwZW9mIHZhbHVlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRFdGhlcih2YWx1ZSl9ICR7Y2hhaW4/Lm5hdGl2ZUN1cnJlbmN5Py5zeW1ib2wgfHwgIkVUSCJ9YCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgZ2FzLAogICAgICAgICAgICBnYXNQcmljZTogdHlwZW9mIGdhc1ByaWNlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKGdhc1ByaWNlKX0gZ3dlaWAsCiAgICAgICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXM6IHR5cGVvZiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhQcmlvcml0eUZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBub25jZQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoc3RhdGVPdmVycmlkZSkgewogICAgICAgICAgICBwcmV0dHlBcmdzICs9IGAKJHtwcmV0dHlTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpfWA7CiAgICAgICAgICB9CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIC4uLmNhdXNlLm1ldGFNZXNzYWdlcyA/IFsuLi5jYXVzZS5tZXRhTWVzc2FnZXMsICIgIl0gOiBbXSwKICAgICAgICAgICAgICAiUmF3IENhbGwgQXJndW1lbnRzOiIsCiAgICAgICAgICAgICAgcHJldHR5QXJncwogICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKSwKICAgICAgICAgICAgbmFtZTogIkNhbGxFeGVjdXRpb25FcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFiaTogYWJpMiwgYXJncywgY29udHJhY3RBZGRyZXNzLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBmdW5jdGlvbk5hbWUsIHNlbmRlciB9KSB7CiAgICAgICAgICBjb25zdCBhYmlJdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICAgICAgY29uc3QgZm9ybWF0dGVkQXJncyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoewogICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICBhcmdzLAogICAgICAgICAgICBpbmNsdWRlRnVuY3Rpb25OYW1lOiBmYWxzZSwKICAgICAgICAgICAgaW5jbHVkZU5hbWU6IGZhbHNlCiAgICAgICAgICB9KSA6IHZvaWQgMDsKICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uV2l0aFBhcmFtcyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pIDogdm9pZCAwOwogICAgICAgICAgY29uc3QgcHJldHR5QXJncyA9IHByZXR0eVByaW50KHsKICAgICAgICAgICAgYWRkcmVzczogY29udHJhY3RBZGRyZXNzICYmIGdldENvbnRyYWN0QWRkcmVzcyhjb250cmFjdEFkZHJlc3MpLAogICAgICAgICAgICBmdW5jdGlvbjogZnVuY3Rpb25XaXRoUGFyYW1zLAogICAgICAgICAgICBhcmdzOiBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgJiYgYCR7Wy4uLkFycmF5KGZ1bmN0aW9uTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAsCiAgICAgICAgICAgIHNlbmRlcgogICAgICAgICAgfSk7CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UgfHwgYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZXhlY3V0aW5nIHRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9Ii5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAgICAgcHJldHR5QXJncyAmJiAiQ29udHJhY3QgQ2FsbDoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWJpIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29udHJhY3RBZGRyZXNzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZm9ybWF0dGVkQXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImZ1bmN0aW9uTmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlbmRlciIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaSA9IGFiaTI7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzOwogICAgICAgICAgdGhpcy5jYXVzZSA9IGNhdXNlOwogICAgICAgICAgdGhpcy5jb250cmFjdEFkZHJlc3MgPSBjb250cmFjdEFkZHJlc3M7CiAgICAgICAgICB0aGlzLmZ1bmN0aW9uTmFtZSA9IGZ1bmN0aW9uTmFtZTsKICAgICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYWJpOiBhYmkyLCBkYXRhLCBmdW5jdGlvbk5hbWUsIG1lc3NhZ2UgfSkgewogICAgICAgICAgbGV0IGNhdXNlOwogICAgICAgICAgbGV0IGRlY29kZWREYXRhID0gdm9pZCAwOwogICAgICAgICAgbGV0IG1ldGFNZXNzYWdlczsKICAgICAgICAgIGxldCByZWFzb247CiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhICE9PSAiMHgiKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZGVjb2RlZERhdGEgPSBkZWNvZGVFcnJvclJlc3VsdCh7IGFiaTogYWJpMiwgZGF0YSB9KTsKICAgICAgICAgICAgICBjb25zdCB7IGFiaUl0ZW0sIGVycm9yTmFtZSwgYXJnczogZXJyb3JBcmdzIH0gPSBkZWNvZGVkRGF0YTsKICAgICAgICAgICAgICBpZiAoZXJyb3JOYW1lID09PSAiRXJyb3IiKSB7CiAgICAgICAgICAgICAgICByZWFzb24gPSBlcnJvckFyZ3NbMF07CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvck5hbWUgPT09ICJQYW5pYyIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFtmaXJzdEFyZ10gPSBlcnJvckFyZ3M7CiAgICAgICAgICAgICAgICByZWFzb24gPSBwYW5pY1JlYXNvbnNbZmlyc3RBcmddOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zdCBlcnJvcldpdGhQYXJhbXMgPSBhYmlJdGVtID8gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZTogdHJ1ZSB9KSA6IHZvaWQgMDsKICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEFyZ3MgPSBhYmlJdGVtICYmIGVycm9yQXJncyA/IGZvcm1hdEFiaUl0ZW1XaXRoQXJncyh7CiAgICAgICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgICAgIGFyZ3M6IGVycm9yQXJncywKICAgICAgICAgICAgICAgICAgaW5jbHVkZUZ1bmN0aW9uTmFtZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVOYW1lOiBmYWxzZQogICAgICAgICAgICAgICAgfSkgOiB2b2lkIDA7CiAgICAgICAgICAgICAgICBtZXRhTWVzc2FnZXMgPSBbCiAgICAgICAgICAgICAgICAgIGVycm9yV2l0aFBhcmFtcyA/IGBFcnJvcjogJHtlcnJvcldpdGhQYXJhbXN9YCA6ICIiLAogICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgPyBgICAgICAgICR7Wy4uLkFycmF5KGVycm9yTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAgOiAiIgogICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIGNhdXNlID0gZXJyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UpCiAgICAgICAgICAgIHJlYXNvbiA9IG1lc3NhZ2U7CiAgICAgICAgICBsZXQgc2lnbmF0dXJlOwogICAgICAgICAgaWYgKGNhdXNlIGluc3RhbmNlb2YgQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yKSB7CiAgICAgICAgICAgIHNpZ25hdHVyZSA9IGNhdXNlLnNpZ25hdHVyZTsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzID0gWwogICAgICAgICAgICAgIGBVbmFibGUgdG8gZGVjb2RlIHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBhcyBpdCB3YXMgbm90IGZvdW5kIG9uIHRoZSBwcm92aWRlZCBBQkkuYCwKICAgICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBlcnJvciBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBkZWNvZGVkIHNpZ25hdHVyZSBoZXJlOiBodHRwczovL29wZW5jaGFpbi54eXovc2lnbmF0dXJlcz9xdWVyeT0ke3NpZ25hdHVyZX0uYAogICAgICAgICAgICBdOwogICAgICAgICAgfQogICAgICAgICAgc3VwZXIocmVhc29uICYmIHJlYXNvbiAhPT0gImV4ZWN1dGlvbiByZXZlcnRlZCIgfHwgc2lnbmF0dXJlID8gWwogICAgICAgICAgICBgVGhlIGNvbnRyYWN0IGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iIHJldmVydGVkIHdpdGggdGhlIGZvbGxvd2luZyAke3NpZ25hdHVyZSA/ICJzaWduYXR1cmUiIDogInJlYXNvbiJ9OmAsCiAgICAgICAgICAgIHJlYXNvbiB8fCBzaWduYXR1cmUKICAgICAgICAgIF0uam9pbigiXG4iKSA6IGBUaGUgY29udHJhY3QgZnVuY3Rpb24gIiR7ZnVuY3Rpb25OYW1lfSIgcmV2ZXJ0ZWQuYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzLAogICAgICAgICAgICBuYW1lOiAiQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInJlYXNvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNpZ25hdHVyZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBkZWNvZGVkRGF0YTsKICAgICAgICAgIHRoaXMucmVhc29uID0gcmVhc29uOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBmdW5jdGlvbk5hbWUgfSkgewogICAgICAgICAgc3VwZXIoYFRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiByZXR1cm5lZCBubyBkYXRhICgiMHgiKS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgICJUaGlzIGNvdWxkIGJlIGR1ZSB0byBhbnkgb2YgdGhlIGZvbGxvd2luZzoiLAogICAgICAgICAgICAgIGAgIC0gVGhlIGNvbnRyYWN0IGRvZXMgbm90IGhhdmUgdGhlIGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iLGAsCiAgICAgICAgICAgICAgIiAgLSBUaGUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhlIGNvbnRyYWN0IGZ1bmN0aW9uIG1heSBiZSBpbnZhbGlkLCBvciIsCiAgICAgICAgICAgICAgIiAgLSBUaGUgYWRkcmVzcyBpcyBub3QgYSBjb250cmFjdC4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZmFjdG9yeSB9KSB7CiAgICAgICAgICBzdXBlcihgRGVwbG95bWVudCBmb3IgY291bnRlcmZhY3R1YWwgY29udHJhY3QgY2FsbCBmYWlsZWQke2ZhY3RvcnkgPyBgIGZvciBmYWN0b3J5ICIke2ZhY3Rvcnl9Ii5gIDogIiJ9YCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiUGxlYXNlIGVuc3VyZToiLAogICAgICAgICAgICAgICItIFRoZSBgZmFjdG9yeWAgaXMgYSB2YWxpZCBjb250cmFjdCBkZXBsb3ltZW50IGZhY3RvcnkgKGllLiBDcmVhdGUyIEZhY3RvcnksIEVSQy00MzM3IEZhY3RvcnksIGV0YykuIiwKICAgICAgICAgICAgICAiLSBUaGUgYGZhY3RvcnlEYXRhYCBpcyBhIHZhbGlkIGVuY29kZWQgZnVuY3Rpb24gY2FsbCBmb3IgY29udHJhY3QgZGVwbG95bWVudCBmdW5jdGlvbiBvbiB0aGUgZmFjdG9yeS4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgUmF3Q29udHJhY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBkYXRhLCBtZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UgfHwgIiIsIHsgbmFtZTogIlJhd0NvbnRyYWN0RXJyb3IiIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjb2RlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogMwogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcwogIHZhciBIdHRwUmVxdWVzdEVycm9yLCBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IsIFJwY1JlcXVlc3RFcnJvciwgU29ja2V0Q2xvc2VkRXJyb3IsIFRpbWVvdXRFcnJvcjsKICB2YXIgaW5pdF9yZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfc3RyaW5naWZ5KCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBIdHRwUmVxdWVzdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGJvZHksIGNhdXNlLCBkZXRhaWxzLCBoZWFkZXJzLCBzdGF0dXMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiSFRUUCByZXF1ZXN0IGZhaWxlZC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkZXRhaWxzLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBzdGF0dXMgJiYgYFN0YXR1czogJHtzdGF0dXN9YCwKICAgICAgICAgICAgICBgVVJMOiAke2dldFVybCh1cmwpfWAsCiAgICAgICAgICAgICAgYm9keSAmJiBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSHR0cFJlcXVlc3RFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJib2R5IiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaGVhZGVycyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInN0YXR1cyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInVybCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmJvZHkgPSBib2R5OwogICAgICAgICAgdGhpcy5oZWFkZXJzID0gaGVhZGVyczsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICAgICAgdGhpcy51cmwgPSB1cmw7CiAgICAgICAgfQogICAgICB9OwogICAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYm9keSwgY2F1c2UsIGRldGFpbHMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiV2ViU29ja2V0IHJlcXVlc3QgZmFpbGVkLiIsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRldGFpbHMsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBVUkw6ICR7Z2V0VXJsKHVybCl9YCwKICAgICAgICAgICAgICBib2R5ICYmIGBSZXF1ZXN0IGJvZHk6ICR7c3RyaW5naWZ5KGJvZHkpfWAKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJXZWJTb2NrZXRSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJwY1JlcXVlc3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCBlcnJvciwgdXJsIH0pIHsKICAgICAgICAgIHN1cGVyKCJSUEMgUmVxdWVzdCBmYWlsZWQuIiwgewogICAgICAgICAgICBjYXVzZTogZXJyb3IsCiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BVUkw6ICR7Z2V0VXJsKHVybCl9YCwgYFJlcXVlc3QgYm9keTogJHtzdHJpbmdpZnkoYm9keSl9YF0sCiAgICAgICAgICAgIG5hbWU6ICJScGNSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNvZGUgPSBlcnJvci5jb2RlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgU29ja2V0Q2xvc2VkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgdXJsIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoIlRoZSBzb2NrZXQgaGFzIGJlZW4gY2xvc2VkLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbdXJsICYmIGBVUkw6ICR7Z2V0VXJsKHVybCl9YF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiU29ja2V0Q2xvc2VkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRpbWVvdXRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCB1cmwgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSByZXF1ZXN0IHRvb2sgdG9vIGxvbmcgdG8gcmVzcG9uZC4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6ICJUaGUgcmVxdWVzdCB0aW1lZCBvdXQuIiwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYFVSTDogJHtnZXRVcmwodXJsKX1gLCBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gXSwKICAgICAgICAgICAgbmFtZTogIlRpbWVvdXRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMKICB2YXIgdW5rbm93bkVycm9yQ29kZSwgUnBjRXJyb3IsIFByb3ZpZGVyUnBjRXJyb3IsIFBhcnNlUnBjRXJyb3IsIEludmFsaWRSZXF1ZXN0UnBjRXJyb3IsIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IsIEludmFsaWRQYXJhbXNScGNFcnJvciwgSW50ZXJuYWxScGNFcnJvciwgSW52YWxpZElucHV0UnBjRXJyb3IsIFJlc291cmNlTm90Rm91bmRScGNFcnJvciwgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLCBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yLCBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IsIEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLCBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IsIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsIENoYWluRGlzY29ubmVjdGVkRXJyb3IsIFN3aXRjaENoYWluRXJyb3IsIFVua25vd25ScGNFcnJvcjsKICB2YXIgaW5pdF9ycGMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIHVua25vd25FcnJvckNvZGUgPSAtMTsKICAgICAgUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGNvZGUsIGRvY3NQYXRoOiBkb2NzUGF0aDksIG1ldGFNZXNzYWdlcywgbmFtZSwgc2hvcnRNZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKHNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBtZXRhTWVzc2FnZXMgfHwgY2F1c2U/Lm1ldGFNZXNzYWdlcywKICAgICAgICAgICAgbmFtZTogbmFtZSB8fCAiUnBjRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lIHx8IGNhdXNlLm5hbWU7CiAgICAgICAgICB0aGlzLmNvZGUgPSBjYXVzZSBpbnN0YW5jZW9mIFJwY1JlcXVlc3RFcnJvciA/IGNhdXNlLmNvZGUgOiBjb2RlID8/IHVua25vd25FcnJvckNvZGU7CiAgICAgICAgfQogICAgICB9OwogICAgICBQcm92aWRlclJwY0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIG9wdGlvbnMpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCBvcHRpb25zKTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBvcHRpb25zLmRhdGE7CiAgICAgICAgfQogICAgICB9OwogICAgICBQYXJzZVJwY0Vycm9yID0gY2xhc3MgX1BhcnNlUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9QYXJzZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJQYXJzZVJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSW52YWxpZCBKU09OIHdhcyByZWNlaXZlZCBieSB0aGUgc2VydmVyLiBBbiBlcnJvciBvY2N1cnJlZCBvbiB0aGUgc2VydmVyIHdoaWxlIHBhcnNpbmcgdGhlIEpTT04gdGV4dC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZVJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNzAwCiAgICAgIH0pOwogICAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRSZXF1ZXN0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkUmVxdWVzdFJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkUmVxdWVzdFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSlNPTiBpcyBub3QgYSB2YWxpZCByZXF1ZXN0IG9iamVjdC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNjAwCiAgICAgIH0pOwogICAgICBNZXRob2ROb3RGb3VuZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIHsgbWV0aG9kIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIk1ldGhvZE5vdEZvdW5kUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgbWV0aG9kJHttZXRob2QgPyBgICIke21ldGhvZH0iYCA6ICIifSBkb2VzIG5vdCBleGlzdCAvIGlzIG5vdCBhdmFpbGFibGUuYAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWV0aG9kTm90Rm91bmRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMQogICAgICB9KTsKICAgICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRQYXJhbXNScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludmFsaWRQYXJhbXNScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiBbCiAgICAgICAgICAgICAgIkludmFsaWQgcGFyYW1ldGVycyB3ZXJlIHByb3ZpZGVkIHRvIHRoZSBSUEMgbWV0aG9kLiIsCiAgICAgICAgICAgICAgIkRvdWJsZSBjaGVjayB5b3UgaGF2ZSBwcm92aWRlZCB0aGUgY29ycmVjdCBwYXJhbWV0ZXJzLiIKICAgICAgICAgICAgXS5qb2luKCJcbiIpCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUGFyYW1zUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzI2MDIKICAgICAgfSk7CiAgICAgIEludGVybmFsUnBjRXJyb3IgPSBjbGFzcyBfSW50ZXJuYWxScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludGVybmFsUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkludGVybmFsUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBpbnRlcm5hbCBlcnJvciB3YXMgcmVjZWl2ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZXJuYWxScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMwogICAgICB9KTsKICAgICAgSW52YWxpZElucHV0UnBjRXJyb3IgPSBjbGFzcyBfSW52YWxpZElucHV0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkSW5wdXRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZElucHV0UnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IFsKICAgICAgICAgICAgICAiTWlzc2luZyBvciBpbnZhbGlkIHBhcmFtZXRlcnMuIiwKICAgICAgICAgICAgICAiRG91YmxlIGNoZWNrIHlvdSBoYXZlIHByb3ZpZGVkIHRoZSBjb3JyZWN0IHBhcmFtZXRlcnMuIgogICAgICAgICAgICBdLmpvaW4oIlxuIikKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludmFsaWRJbnB1dFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyZTMKICAgICAgfSk7CiAgICAgIFJlc291cmNlTm90Rm91bmRScGNFcnJvciA9IGNsYXNzIF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlJlc291cmNlTm90Rm91bmRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlJlcXVlc3RlZCByZXNvdXJjZSBub3QgZm91bmQuIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDAxCiAgICAgIH0pOwogICAgICBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IgPSBjbGFzcyBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJSZXF1ZXN0ZWQgcmVzb3VyY2Ugbm90IGF2YWlsYWJsZS4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDIKICAgICAgfSk7CiAgICAgIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciA9IGNsYXNzIF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRyYW5zYWN0aW9uIGNyZWF0aW9uIGZhaWxlZC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDMKICAgICAgfSk7CiAgICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IG1ldGhvZCB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9NZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBNZXRob2Qke21ldGhvZCA/IGAgIiR7bWV0aG9kfSJgIDogIiJ9IGlzIG5vdCBpbXBsZW1lbnRlZC5gCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjAwNAogICAgICB9KTsKICAgICAgTGltaXRFeGNlZWRlZFJwY0Vycm9yID0gY2xhc3MgX0xpbWl0RXhjZWVkZWRScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0xpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTGltaXRFeGNlZWRlZFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiUmVxdWVzdCBleGNlZWRzIGRlZmluZWQgbGltaXQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGltaXRFeGNlZWRlZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA1CiAgICAgIH0pOwogICAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJWZXJzaW9uIG9mIEpTT04tUlBDIHByb3RvY29sIGlzIG5vdCBzdXBwb3J0ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA2CiAgICAgIH0pOwogICAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBfVXNlclJlamVjdGVkUmVxdWVzdEVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9Vc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlVzZXIgcmVqZWN0ZWQgdGhlIHJlcXVlc3QuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogNDAwMQogICAgICB9KTsKICAgICAgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciA9IGNsYXNzIF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiVGhlIHJlcXVlc3RlZCBtZXRob2QgYW5kL29yIGFjY291bnQgaGFzIG5vdCBiZWVuIGF1dGhvcml6ZWQgYnkgdGhlIHVzZXIuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQxMDAKICAgICAgfSk7CiAgICAgIFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciA9IGNsYXNzIF9VbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSwgeyBtZXRob2QgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgUHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgcmVxdWVzdGVkIG1ldGhvZCR7bWV0aG9kID8gYCAiICR7bWV0aG9kfSJgIDogIiJ9LmAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQyMDAKICAgICAgfSk7CiAgICAgIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IgPSBjbGFzcyBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciBleHRlbmRzIFByb3ZpZGVyUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRoZSBQcm92aWRlciBpcyBkaXNjb25uZWN0ZWQgZnJvbSBhbGwgY2hhaW5zLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAwCiAgICAgIH0pOwogICAgICBDaGFpbkRpc2Nvbm5lY3RlZEVycm9yID0gY2xhc3MgX0NoYWluRGlzY29ubmVjdGVkRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0NoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkNoYWluRGlzY29ubmVjdGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJUaGUgUHJvdmlkZXIgaXMgbm90IGNvbm5lY3RlZCB0byB0aGUgcmVxdWVzdGVkIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENoYWluRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAxCiAgICAgIH0pOwogICAgICBTd2l0Y2hDaGFpbkVycm9yID0gY2xhc3MgX1N3aXRjaENoYWluRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX1N3aXRjaENoYWluRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlN3aXRjaENoYWluRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGF0dGVtcHRpbmcgdG8gc3dpdGNoIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN3aXRjaENoYWluRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAyCiAgICAgIH0pOwogICAgICBVbmtub3duUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgbmFtZTogIlVua25vd25ScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIkFuIHVua25vd24gUlBDIGVycm9yIG9jY3VycmVkLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL19tZC5qcwogIGZ1bmN0aW9uIHNldEJpZ1VpbnQ2NCh2aWV3LCBieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpIHsKICAgIGlmICh0eXBlb2Ygdmlldy5zZXRCaWdVaW50NjQgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiB2aWV3LnNldEJpZ1VpbnQ2NChieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpOwogICAgY29uc3QgXzMybjIgPSBCaWdJbnQoMzIpOwogICAgY29uc3QgX3UzMl9tYXggPSBCaWdJbnQoNDI5NDk2NzI5NSk7CiAgICBjb25zdCB3aCA9IE51bWJlcih2YWx1ZSA+PiBfMzJuMiAmIF91MzJfbWF4KTsKICAgIGNvbnN0IHdsID0gTnVtYmVyKHZhbHVlICYgX3UzMl9tYXgpOwogICAgY29uc3QgaCA9IGlzTEUyID8gNCA6IDA7CiAgICBjb25zdCBsID0gaXNMRTIgPyAwIDogNDsKICAgIHZpZXcuc2V0VWludDMyKGJ5dGVPZmZzZXQgKyBoLCB3aCwgaXNMRTIpOwogICAgdmlldy5zZXRVaW50MzIoYnl0ZU9mZnNldCArIGwsIHdsLCBpc0xFMik7CiAgfQogIHZhciBDaGksIE1haiwgSGFzaE1EOwogIHZhciBpbml0X21kID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fbWQuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBDaGkgPSAoYSwgYiwgYykgPT4gYSAmIGIgXiB+YSAmIGM7CiAgICAgIE1haiA9IChhLCBiLCBjKSA9PiBhICYgYiBeIGEgJiBjIF4gYiAmIGM7CiAgICAgIEhhc2hNRCA9IGNsYXNzIGV4dGVuZHMgSGFzaCB7CiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIG91dHB1dExlbiwgcGFkT2Zmc2V0LCBpc0xFMikgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSBibG9ja0xlbjsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5wYWRPZmZzZXQgPSBwYWRPZmZzZXQ7CiAgICAgICAgICB0aGlzLmlzTEUgPSBpc0xFMjsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubGVuZ3RoID0gMDsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGJsb2NrTGVuKTsKICAgICAgICAgIHRoaXMudmlldyA9IGNyZWF0ZVZpZXcodGhpcy5idWZmZXIpOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyB2aWV3LCBidWZmZXI6IGJ1ZmZlcjIsIGJsb2NrTGVuIH0gPSB0aGlzOwogICAgICAgICAgZGF0YSA9IHRvQnl0ZXMyKGRhdGEpOwogICAgICAgICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7CiAgICAgICAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47ICkgewogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvcywgbGVuIC0gcG9zKTsKICAgICAgICAgICAgaWYgKHRha2UgPT09IGJsb2NrTGVuKSB7CiAgICAgICAgICAgICAgY29uc3QgZGF0YVZpZXcgPSBjcmVhdGVWaWV3KGRhdGEpOwogICAgICAgICAgICAgIGZvciAoOyBibG9ja0xlbiA8PSBsZW4gLSBwb3M7IHBvcyArPSBibG9ja0xlbikKICAgICAgICAgICAgICAgIHRoaXMucHJvY2VzcyhkYXRhVmlldywgcG9zKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWZmZXIyLnNldChkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgdGFrZSksIHRoaXMucG9zKTsKICAgICAgICAgICAgdGhpcy5wb3MgKz0gdGFrZTsKICAgICAgICAgICAgcG9zICs9IHRha2U7CiAgICAgICAgICAgIGlmICh0aGlzLnBvcyA9PT0gYmxvY2tMZW4pIHsKICAgICAgICAgICAgICB0aGlzLnByb2Nlc3ModmlldywgMCk7CiAgICAgICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmxlbmd0aCArPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIHRoaXMucm91bmRDbGVhbigpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdEludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcyk7CiAgICAgICAgICBvdXRwdXQob3V0LCB0aGlzKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlOwogICAgICAgICAgY29uc3QgeyBidWZmZXI6IGJ1ZmZlcjIsIHZpZXcsIGJsb2NrTGVuLCBpc0xFOiBpc0xFMiB9ID0gdGhpczsKICAgICAgICAgIGxldCB7IHBvcyB9ID0gdGhpczsKICAgICAgICAgIGJ1ZmZlcjJbcG9zKytdID0gMTI4OwogICAgICAgICAgdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zKS5maWxsKDApOwogICAgICAgICAgaWYgKHRoaXMucGFkT2Zmc2V0ID4gYmxvY2tMZW4gLSBwb3MpIHsKICAgICAgICAgICAgdGhpcy5wcm9jZXNzKHZpZXcsIDApOwogICAgICAgICAgICBwb3MgPSAwOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChsZXQgaSA9IHBvczsgaSA8IGJsb2NrTGVuOyBpKyspCiAgICAgICAgICAgIGJ1ZmZlcjJbaV0gPSAwOwogICAgICAgICAgc2V0QmlnVWludDY0KHZpZXcsIGJsb2NrTGVuIC0gOCwgQmlnSW50KHRoaXMubGVuZ3RoICogOCksIGlzTEUyKTsKICAgICAgICAgIHRoaXMucHJvY2Vzcyh2aWV3LCAwKTsKICAgICAgICAgIGNvbnN0IG92aWV3ID0gY3JlYXRlVmlldyhvdXQpOwogICAgICAgICAgY29uc3QgbGVuID0gdGhpcy5vdXRwdXRMZW47CiAgICAgICAgICBpZiAobGVuICUgNCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIHNob3VsZCBiZSBhbGlnbmVkIHRvIDMyYml0Iik7CiAgICAgICAgICBjb25zdCBvdXRMZW4gPSBsZW4gLyA0OwogICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLmdldCgpOwogICAgICAgICAgaWYgKG91dExlbiA+IHN0YXRlLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIGJpZ2dlciB0aGFuIHN0YXRlIik7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG91dExlbjsgaSsrKQogICAgICAgICAgICBvdmlldy5zZXRVaW50MzIoNCAqIGksIHN0YXRlW2ldLCBpc0xFMik7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdCgpIHsKICAgICAgICAgIGNvbnN0IHsgYnVmZmVyOiBidWZmZXIyLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8oYnVmZmVyMik7CiAgICAgICAgICBjb25zdCByZXMgPSBidWZmZXIyLnNsaWNlKDAsIG91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRlc3Ryb3koKTsKICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkpOwogICAgICAgICAgdG8uc2V0KC4uLnRoaXMuZ2V0KCkpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgYnVmZmVyOiBidWZmZXIyLCBsZW5ndGgsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIHBvcyB9ID0gdGhpczsKICAgICAgICAgIHRvLmxlbmd0aCA9IGxlbmd0aDsKICAgICAgICAgIHRvLnBvcyA9IHBvczsKICAgICAgICAgIHRvLmZpbmlzaGVkID0gZmluaXNoZWQ7CiAgICAgICAgICB0by5kZXN0cm95ZWQgPSBkZXN0cm95ZWQ7CiAgICAgICAgICBpZiAobGVuZ3RoICUgYmxvY2tMZW4pCiAgICAgICAgICAgIHRvLmJ1ZmZlci5zZXQoYnVmZmVyMik7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhMjU2LmpzCiAgdmFyIFNIQTI1Nl9LLCBTSEEyNTZfSVYsIFNIQTI1Nl9XLCBTSEEyNTYsIHNoYTI1NjsKICB2YXIgaW5pdF9zaGEyNTYgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTI1Ni5qcyIoKSB7CiAgICAgIGluaXRfbWQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBMjU2X0sgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgICAgICAxMTE2MzUyNDA4LAogICAgICAgIDE4OTk0NDc0NDEsCiAgICAgICAgMzA0OTMyMzQ3MSwKICAgICAgICAzOTIxMDA5NTczLAogICAgICAgIDk2MTk4NzE2MywKICAgICAgICAxNTA4OTcwOTkzLAogICAgICAgIDI0NTM2MzU3NDgsCiAgICAgICAgMjg3MDc2MzIyMSwKICAgICAgICAzNjI0MzgxMDgwLAogICAgICAgIDMxMDU5ODQwMSwKICAgICAgICA2MDcyMjUyNzgsCiAgICAgICAgMTQyNjg4MTk4NywKICAgICAgICAxOTI1MDc4Mzg4LAogICAgICAgIDIxNjIwNzgyMDYsCiAgICAgICAgMjYxNDg4ODEwMywKICAgICAgICAzMjQ4MjIyNTgwLAogICAgICAgIDM4MzUzOTA0MDEsCiAgICAgICAgNDAyMjIyNDc3NCwKICAgICAgICAyNjQzNDcwNzgsCiAgICAgICAgNjA0ODA3NjI4LAogICAgICAgIDc3MDI1NTk4MywKICAgICAgICAxMjQ5MTUwMTIyLAogICAgICAgIDE1NTUwODE2OTIsCiAgICAgICAgMTk5NjA2NDk4NiwKICAgICAgICAyNTU0MjIwODgyLAogICAgICAgIDI4MjE4MzQzNDksCiAgICAgICAgMjk1Mjk5NjgwOCwKICAgICAgICAzMjEwMzEzNjcxLAogICAgICAgIDMzMzY1NzE4OTEsCiAgICAgICAgMzU4NDUyODcxMSwKICAgICAgICAxMTM5MjY5OTMsCiAgICAgICAgMzM4MjQxODk1LAogICAgICAgIDY2NjMwNzIwNSwKICAgICAgICA3NzM1Mjk5MTIsCiAgICAgICAgMTI5NDc1NzM3MiwKICAgICAgICAxMzk2MTgyMjkxLAogICAgICAgIDE2OTUxODM3MDAsCiAgICAgICAgMTk4NjY2MTA1MSwKICAgICAgICAyMTc3MDI2MzUwLAogICAgICAgIDI0NTY5NTYwMzcsCiAgICAgICAgMjczMDQ4NTkyMSwKICAgICAgICAyODIwMzAyNDExLAogICAgICAgIDMyNTk3MzA4MDAsCiAgICAgICAgMzM0NTc2NDc3MSwKICAgICAgICAzNTE2MDY1ODE3LAogICAgICAgIDM2MDAzNTI4MDQsCiAgICAgICAgNDA5NDU3MTkwOSwKICAgICAgICAyNzU0MjMzNDQsCiAgICAgICAgNDMwMjI3NzM0LAogICAgICAgIDUwNjk0ODYxNiwKICAgICAgICA2NTkwNjA1NTYsCiAgICAgICAgODgzOTk3ODc3LAogICAgICAgIDk1ODEzOTU3MSwKICAgICAgICAxMzIyODIyMjE4LAogICAgICAgIDE1MzcwMDIwNjMsCiAgICAgICAgMTc0Nzg3Mzc3OSwKICAgICAgICAxOTU1NTYyMjIyLAogICAgICAgIDIwMjQxMDQ4MTUsCiAgICAgICAgMjIyNzczMDQ1MiwKICAgICAgICAyMzYxODUyNDI0LAogICAgICAgIDI0Mjg0MzY0NzQsCiAgICAgICAgMjc1NjczNDE4NywKICAgICAgICAzMjA0MDMxNDc5LAogICAgICAgIDMzMjkzMjUyOTgKICAgICAgXSk7CiAgICAgIFNIQTI1Nl9JViA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgICAgIDE3NzkwMzM3MDMsCiAgICAgICAgMzE0NDEzNDI3NywKICAgICAgICAxMDEzOTA0MjQyLAogICAgICAgIDI3NzM0ODA3NjIsCiAgICAgICAgMTM1OTg5MzExOSwKICAgICAgICAyNjAwODIyOTI0LAogICAgICAgIDUyODczNDYzNSwKICAgICAgICAxNTQxNDU5MjI1CiAgICAgIF0pOwogICAgICBTSEEyNTZfVyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoNjQpOwogICAgICBTSEEyNTYgPSBjbGFzcyBleHRlbmRzIEhhc2hNRCB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcig2NCwgMzIsIDgsIGZhbHNlKTsKICAgICAgICAgIHRoaXMuQSA9IFNIQTI1Nl9JVlswXSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBTSEEyNTZfSVZbMV0gfCAwOwogICAgICAgICAgdGhpcy5DID0gU0hBMjU2X0lWWzJdIHwgMDsKICAgICAgICAgIHRoaXMuRCA9IFNIQTI1Nl9JVlszXSB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBTSEEyNTZfSVZbNF0gfCAwOwogICAgICAgICAgdGhpcy5GID0gU0hBMjU2X0lWWzVdIHwgMDsKICAgICAgICAgIHRoaXMuRyA9IFNIQTI1Nl9JVls2XSB8IDA7CiAgICAgICAgICB0aGlzLkggPSBTSEEyNTZfSVZbN10gfCAwOwogICAgICAgIH0KICAgICAgICBnZXQoKSB7CiAgICAgICAgICBjb25zdCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICByZXR1cm4gW0EsIEIsIEMsIEQsIEUsIEYsIEcsIEhdOwogICAgICAgIH0KICAgICAgICAvLyBwcmV0dGllci1pZ25vcmUKICAgICAgICBzZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCkgewogICAgICAgICAgdGhpcy5BID0gQSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBCIHwgMDsKICAgICAgICAgIHRoaXMuQyA9IEMgfCAwOwogICAgICAgICAgdGhpcy5EID0gRCB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBFIHwgMDsKICAgICAgICAgIHRoaXMuRiA9IEYgfCAwOwogICAgICAgICAgdGhpcy5HID0gRyB8IDA7CiAgICAgICAgICB0aGlzLkggPSBIIHwgMDsKICAgICAgICB9CiAgICAgICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKywgb2Zmc2V0ICs9IDQpCiAgICAgICAgICAgIFNIQTI1Nl9XW2ldID0gdmlldy5nZXRVaW50MzIob2Zmc2V0LCBmYWxzZSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA2NDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IFcxNSA9IFNIQTI1Nl9XW2kgLSAxNV07CiAgICAgICAgICAgIGNvbnN0IFcyID0gU0hBMjU2X1dbaSAtIDJdOwogICAgICAgICAgICBjb25zdCBzMCA9IHJvdHIoVzE1LCA3KSBeIHJvdHIoVzE1LCAxOCkgXiBXMTUgPj4+IDM7CiAgICAgICAgICAgIGNvbnN0IHMxID0gcm90cihXMiwgMTcpIF4gcm90cihXMiwgMTkpIF4gVzIgPj4+IDEwOwogICAgICAgICAgICBTSEEyNTZfV1tpXSA9IHMxICsgU0hBMjU2X1dbaSAtIDddICsgczAgKyBTSEEyNTZfV1tpIC0gMTZdIHwgMDsKICAgICAgICAgIH0KICAgICAgICAgIGxldCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY0OyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc2lnbWExID0gcm90cihFLCA2KSBeIHJvdHIoRSwgMTEpIF4gcm90cihFLCAyNSk7CiAgICAgICAgICAgIGNvbnN0IFQxID0gSCArIHNpZ21hMSArIENoaShFLCBGLCBHKSArIFNIQTI1Nl9LW2ldICsgU0hBMjU2X1dbaV0gfCAwOwogICAgICAgICAgICBjb25zdCBzaWdtYTAgPSByb3RyKEEsIDIpIF4gcm90cihBLCAxMykgXiByb3RyKEEsIDIyKTsKICAgICAgICAgICAgY29uc3QgVDIgPSBzaWdtYTAgKyBNYWooQSwgQiwgQykgfCAwOwogICAgICAgICAgICBIID0gRzsKICAgICAgICAgICAgRyA9IEY7CiAgICAgICAgICAgIEYgPSBFOwogICAgICAgICAgICBFID0gRCArIFQxIHwgMDsKICAgICAgICAgICAgRCA9IEM7CiAgICAgICAgICAgIEMgPSBCOwogICAgICAgICAgICBCID0gQTsKICAgICAgICAgICAgQSA9IFQxICsgVDIgfCAwOwogICAgICAgICAgfQogICAgICAgICAgQSA9IEEgKyB0aGlzLkEgfCAwOwogICAgICAgICAgQiA9IEIgKyB0aGlzLkIgfCAwOwogICAgICAgICAgQyA9IEMgKyB0aGlzLkMgfCAwOwogICAgICAgICAgRCA9IEQgKyB0aGlzLkQgfCAwOwogICAgICAgICAgRSA9IEUgKyB0aGlzLkUgfCAwOwogICAgICAgICAgRiA9IEYgKyB0aGlzLkYgfCAwOwogICAgICAgICAgRyA9IEcgKyB0aGlzLkcgfCAwOwogICAgICAgICAgSCA9IEggKyB0aGlzLkggfCAwOwogICAgICAgICAgdGhpcy5zZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCk7CiAgICAgICAgfQogICAgICAgIHJvdW5kQ2xlYW4oKSB7CiAgICAgICAgICBTSEEyNTZfVy5maWxsKDApOwogICAgICAgIH0KICAgICAgICBkZXN0cm95KCkgewogICAgICAgICAgdGhpcy5zZXQoMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCk7CiAgICAgICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgc2hhMjU2ID0gLyogQF9fUFVSRV9fICovIHdyYXBDb25zdHJ1Y3RvcigoKSA9PiBuZXcgU0hBMjU2KCkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vaG1hYy5qcwogIHZhciBITUFDLCBobWFjOwogIHZhciBpbml0X2htYWMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2htYWMuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBITUFDID0gY2xhc3MgZXh0ZW5kcyBIYXNoIHsKICAgICAgICBjb25zdHJ1Y3RvcihoYXNoMywgX2tleSkgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBoYXNoKGhhc2gzKTsKICAgICAgICAgIGNvbnN0IGtleSA9IHRvQnl0ZXMyKF9rZXkpOwogICAgICAgICAgdGhpcy5pSGFzaCA9IGhhc2gzLmNyZWF0ZSgpOwogICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmlIYXNoLnVwZGF0ZSAhPT0gImZ1bmN0aW9uIikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBpbnN0YW5jZSBvZiBjbGFzcyB3aGljaCBleHRlbmRzIHV0aWxzLkhhc2giKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSB0aGlzLmlIYXNoLmJsb2NrTGVuOwogICAgICAgICAgdGhpcy5vdXRwdXRMZW4gPSB0aGlzLmlIYXNoLm91dHB1dExlbjsKICAgICAgICAgIGNvbnN0IGJsb2NrTGVuID0gdGhpcy5ibG9ja0xlbjsKICAgICAgICAgIGNvbnN0IHBhZDIgPSBuZXcgVWludDhBcnJheShibG9ja0xlbik7CiAgICAgICAgICBwYWQyLnNldChrZXkubGVuZ3RoID4gYmxvY2tMZW4gPyBoYXNoMy5jcmVhdGUoKS51cGRhdGUoa2V5KS5kaWdlc3QoKSA6IGtleSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZDIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHBhZDJbaV0gXj0gNTQ7CiAgICAgICAgICB0aGlzLmlIYXNoLnVwZGF0ZShwYWQyKTsKICAgICAgICAgIHRoaXMub0hhc2ggPSBoYXNoMy5jcmVhdGUoKTsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFkMi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcGFkMltpXSBePSA1NCBeIDkyOwogICAgICAgICAgdGhpcy5vSGFzaC51cGRhdGUocGFkMik7CiAgICAgICAgICBwYWQyLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZShidWYpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIHRoaXMuaUhhc2gudXBkYXRlKGJ1Zik7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIGJ5dGVzKG91dCwgdGhpcy5vdXRwdXRMZW4pOwogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLmlIYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMub0hhc2gudXBkYXRlKG91dCk7CiAgICAgICAgICB0aGlzLm9IYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICBjb25zdCBvdXQgPSBuZXcgVWludDhBcnJheSh0aGlzLm9IYXNoLm91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLCB7fSkpOwogICAgICAgICAgY29uc3QgeyBvSGFzaCwgaUhhc2gsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIGJsb2NrTGVuLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0byA9IHRvOwogICAgICAgICAgdG8uZmluaXNoZWQgPSBmaW5pc2hlZDsKICAgICAgICAgIHRvLmRlc3Ryb3llZCA9IGRlc3Ryb3llZDsKICAgICAgICAgIHRvLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0by5vdXRwdXRMZW4gPSBvdXRwdXRMZW47CiAgICAgICAgICB0by5vSGFzaCA9IG9IYXNoLl9jbG9uZUludG8odG8ub0hhc2gpOwogICAgICAgICAgdG8uaUhhc2ggPSBpSGFzaC5fY2xvbmVJbnRvKHRvLmlIYXNoKTsKICAgICAgICAgIHJldHVybiB0bzsKICAgICAgICB9CiAgICAgICAgZGVzdHJveSgpIHsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMub0hhc2guZGVzdHJveSgpOwogICAgICAgICAgdGhpcy5pSGFzaC5kZXN0cm95KCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBobWFjID0gKGhhc2gzLCBrZXksIG1lc3NhZ2UpID0+IG5ldyBITUFDKGhhc2gzLCBrZXkpLnVwZGF0ZShtZXNzYWdlKS5kaWdlc3QoKTsKICAgICAgaG1hYy5jcmVhdGUgPSAoaGFzaDMsIGtleSkgPT4gbmV3IEhNQUMoaGFzaDMsIGtleSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qcwogIHZhciB1dGlsc19leHBvcnRzID0ge307CiAgX19leHBvcnQodXRpbHNfZXhwb3J0cywgewogICAgYUluUmFuZ2U6ICgpID0+IGFJblJhbmdlLAogICAgYWJvb2w6ICgpID0+IGFib29sLAogICAgYWJ5dGVzOiAoKSA9PiBhYnl0ZXMsCiAgICBiaXRHZXQ6ICgpID0+IGJpdEdldCwKICAgIGJpdExlbjogKCkgPT4gYml0TGVuLAogICAgYml0TWFzazogKCkgPT4gYml0TWFzaywKICAgIGJpdFNldDogKCkgPT4gYml0U2V0LAogICAgYnl0ZXNUb0hleDogKCkgPT4gYnl0ZXNUb0hleDIsCiAgICBieXRlc1RvTnVtYmVyQkU6ICgpID0+IGJ5dGVzVG9OdW1iZXJCRSwKICAgIGJ5dGVzVG9OdW1iZXJMRTogKCkgPT4gYnl0ZXNUb051bWJlckxFLAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMywKICAgIGNyZWF0ZUhtYWNEcmJnOiAoKSA9PiBjcmVhdGVIbWFjRHJiZywKICAgIGVuc3VyZUJ5dGVzOiAoKSA9PiBlbnN1cmVCeXRlcywKICAgIGVxdWFsQnl0ZXM6ICgpID0+IGVxdWFsQnl0ZXMsCiAgICBoZXhUb0J5dGVzOiAoKSA9PiBoZXhUb0J5dGVzMiwKICAgIGhleFRvTnVtYmVyOiAoKSA9PiBoZXhUb051bWJlcjIsCiAgICBpblJhbmdlOiAoKSA9PiBpblJhbmdlLAogICAgaXNCeXRlczogKCkgPT4gaXNCeXRlczIsCiAgICBtZW1vaXplZDogKCkgPT4gbWVtb2l6ZWQsCiAgICBub3RJbXBsZW1lbnRlZDogKCkgPT4gbm90SW1wbGVtZW50ZWQsCiAgICBudW1iZXJUb0J5dGVzQkU6ICgpID0+IG51bWJlclRvQnl0ZXNCRSwKICAgIG51bWJlclRvQnl0ZXNMRTogKCkgPT4gbnVtYmVyVG9CeXRlc0xFLAogICAgbnVtYmVyVG9IZXhVbnBhZGRlZDogKCkgPT4gbnVtYmVyVG9IZXhVbnBhZGRlZCwKICAgIG51bWJlclRvVmFyQnl0ZXNCRTogKCkgPT4gbnVtYmVyVG9WYXJCeXRlc0JFLAogICAgdXRmOFRvQnl0ZXM6ICgpID0+IHV0ZjhUb0J5dGVzMiwKICAgIHZhbGlkYXRlT2JqZWN0OiAoKSA9PiB2YWxpZGF0ZU9iamVjdAogIH0pOwogIGZ1bmN0aW9uIGlzQnl0ZXMyKGEpIHsKICAgIHJldHVybiBhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBhICE9IG51bGwgJiYgdHlwZW9mIGEgPT09ICJvYmplY3QiICYmIGEuY29uc3RydWN0b3IubmFtZSA9PT0gIlVpbnQ4QXJyYXkiOwogIH0KICBmdW5jdGlvbiBhYnl0ZXMoaXRlbSkgewogICAgaWYgKCFpc0J5dGVzMihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVaW50OEFycmF5IGV4cGVjdGVkIik7CiAgfQogIGZ1bmN0aW9uIGFib29sKHRpdGxlLCB2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IG11c3QgYmUgdmFsaWQgYm9vbGVhbiwgZ290ICIke3ZhbHVlfSIuYCk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9IZXgyKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICBsZXQgaGV4ID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ5dGVzMi5sZW5ndGg7IGkrKykgewogICAgICBoZXggKz0gaGV4ZXMyW2J5dGVzMltpXV07CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleFVucGFkZGVkKG51bTIpIHsKICAgIGNvbnN0IGhleCA9IG51bTIudG9TdHJpbmcoMTYpOwogICAgcmV0dXJuIGhleC5sZW5ndGggJiAxID8gYDAke2hleH1gIDogaGV4OwogIH0KICBmdW5jdGlvbiBoZXhUb051bWJlcjIoaGV4KSB7CiAgICBpZiAodHlwZW9mIGhleCAhPT0gInN0cmluZyIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGV4IHN0cmluZyBleHBlY3RlZCwgZ290ICIgKyB0eXBlb2YgaGV4KTsKICAgIHJldHVybiBCaWdJbnQoaGV4ID09PSAiIiA/ICIwIiA6IGAweCR7aGV4fWApOwogIH0KICBmdW5jdGlvbiBhc2NpaVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fMCAmJiBjaGFyIDw9IGFzY2lpcy5fOSkKICAgICAgcmV0dXJuIGNoYXIgLSBhc2NpaXMuXzA7CiAgICBpZiAoY2hhciA+PSBhc2NpaXMuX0EgJiYgY2hhciA8PSBhc2NpaXMuX0YpCiAgICAgIHJldHVybiBjaGFyIC0gKGFzY2lpcy5fQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fYSAmJiBjaGFyIDw9IGFzY2lpcy5fZikKICAgICAgcmV0dXJuIGNoYXIgLSAoYXNjaWlzLl9hIC0gMTApOwogICAgcmV0dXJuOwogIH0KICBmdW5jdGlvbiBoZXhUb0J5dGVzMihoZXgpIHsKICAgIGlmICh0eXBlb2YgaGV4ICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgIiArIHR5cGVvZiBoZXgpOwogICAgY29uc3QgaGwgPSBoZXgubGVuZ3RoOwogICAgY29uc3QgYWwgPSBobCAvIDI7CiAgICBpZiAoaGwgJSAyKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInBhZGRlZCBoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgdW5wYWRkZWQgaGV4IG9mIGxlbmd0aCAiICsgaGwpOwogICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShhbCk7CiAgICBmb3IgKGxldCBhaSA9IDAsIGhpID0gMDsgYWkgPCBhbDsgYWkrKywgaGkgKz0gMikgewogICAgICBjb25zdCBuMSA9IGFzY2lpVG9CYXNlMTYoaGV4LmNoYXJDb2RlQXQoaGkpKTsKICAgICAgY29uc3QgbjIgPSBhc2NpaVRvQmFzZTE2KGhleC5jaGFyQ29kZUF0KGhpICsgMSkpOwogICAgICBpZiAobjEgPT09IHZvaWQgMCB8fCBuMiA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc3QgY2hhciA9IGhleFtoaV0gKyBoZXhbaGkgKyAxXTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2hleCBzdHJpbmcgZXhwZWN0ZWQsIGdvdCBub24taGV4IGNoYXJhY3RlciAiJyArIGNoYXIgKyAnIiBhdCBpbmRleCAnICsgaGkpOwogICAgICB9CiAgICAgIGFycmF5W2FpXSA9IG4xICogMTYgKyBuMjsKICAgIH0KICAgIHJldHVybiBhcnJheTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckJFKGJ5dGVzMikgewogICAgcmV0dXJuIGhleFRvTnVtYmVyMihieXRlc1RvSGV4MihieXRlczIpKTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIyKGJ5dGVzVG9IZXgyKFVpbnQ4QXJyYXkuZnJvbShieXRlczIpLnJldmVyc2UoKSkpOwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobi50b1N0cmluZygxNikucGFkU3RhcnQobGVuICogMiwgIjAiKSk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvQnl0ZXNMRShuLCBsZW4pIHsKICAgIHJldHVybiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKS5yZXZlcnNlKCk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvVmFyQnl0ZXNCRShuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobnVtYmVyVG9IZXhVbnBhZGRlZChuKSk7CiAgfQogIGZ1bmN0aW9uIGVuc3VyZUJ5dGVzKHRpdGxlLCBoZXgsIGV4cGVjdGVkTGVuZ3RoKSB7CiAgICBsZXQgcmVzOwogICAgaWYgKHR5cGVvZiBoZXggPT09ICJzdHJpbmciKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcmVzID0gaGV4VG9CeXRlczIoaGV4KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSB2YWxpZCBoZXggc3RyaW5nLCBnb3QgIiR7aGV4fSIuIENhdXNlOiAke2V9YCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNCeXRlczIoaGV4KSkgewogICAgICByZXMgPSBVaW50OEFycmF5LmZyb20oaGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSBoZXggc3RyaW5nIG9yIFVpbnQ4QXJyYXlgKTsKICAgIH0KICAgIGNvbnN0IGxlbiA9IHJlcy5sZW5ndGg7CiAgICBpZiAodHlwZW9mIGV4cGVjdGVkTGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW4gIT09IGV4cGVjdGVkTGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IGV4cGVjdGVkICR7ZXhwZWN0ZWRMZW5ndGh9IGJ5dGVzLCBnb3QgJHtsZW59YCk7CiAgICByZXR1cm4gcmVzOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlczMoLi4uYXJyYXlzKSB7CiAgICBsZXQgc3VtID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGEgPSBhcnJheXNbaV07CiAgICAgIGFieXRlcyhhKTsKICAgICAgc3VtICs9IGEubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzID0gbmV3IFVpbnQ4QXJyYXkoc3VtKTsKICAgIGZvciAobGV0IGkgPSAwLCBwYWQyID0gMDsgaSA8IGFycmF5cy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBhID0gYXJyYXlzW2ldOwogICAgICByZXMuc2V0KGEsIHBhZDIpOwogICAgICBwYWQyICs9IGEubGVuZ3RoOwogICAgfQogICAgcmV0dXJuIHJlczsKICB9CiAgZnVuY3Rpb24gZXF1YWxCeXRlcyhhLCBiKSB7CiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBsZXQgZGlmZiA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspCiAgICAgIGRpZmYgfD0gYVtpXSBeIGJbaV07CiAgICByZXR1cm4gZGlmZiA9PT0gMDsKICB9CiAgZnVuY3Rpb24gdXRmOFRvQnl0ZXMyKHN0cikgewogICAgaWYgKHR5cGVvZiBzdHIgIT09ICJzdHJpbmciKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYHV0ZjhUb0J5dGVzIGV4cGVjdGVkIHN0cmluZywgZ290ICR7dHlwZW9mIHN0cn1gKTsKICAgIHJldHVybiBuZXcgVWludDhBcnJheShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc3RyKSk7CiAgfQogIGZ1bmN0aW9uIGluUmFuZ2UobiwgbWluLCBtYXgpIHsKICAgIHJldHVybiBpc1Bvc0JpZyhuKSAmJiBpc1Bvc0JpZyhtaW4pICYmIGlzUG9zQmlnKG1heCkgJiYgbWluIDw9IG4gJiYgbiA8IG1heDsKICB9CiAgZnVuY3Rpb24gYUluUmFuZ2UodGl0bGUsIG4sIG1pbiwgbWF4KSB7CiAgICBpZiAoIWluUmFuZ2UobiwgbWluLCBtYXgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkIHZhbGlkICR7dGl0bGV9OiAke21pbn0gPD0gbiA8ICR7bWF4fSwgZ290ICR7dHlwZW9mIG59ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gYml0TGVuKG4pIHsKICAgIGxldCBsZW47CiAgICBmb3IgKGxlbiA9IDA7IG4gPiBfMG4yOyBuID4+PSBfMW4yLCBsZW4gKz0gMSkKICAgICAgOwogICAgcmV0dXJuIGxlbjsKICB9CiAgZnVuY3Rpb24gYml0R2V0KG4sIHBvcykgewogICAgcmV0dXJuIG4gPj4gQmlnSW50KHBvcykgJiBfMW4yOwogIH0KICBmdW5jdGlvbiBiaXRTZXQobiwgcG9zLCB2YWx1ZSkgewogICAgcmV0dXJuIG4gfCAodmFsdWUgPyBfMW4yIDogXzBuMikgPDwgQmlnSW50KHBvcyk7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUhtYWNEcmJnKGhhc2hMZW4sIHFCeXRlTGVuLCBobWFjRm4pIHsKICAgIGlmICh0eXBlb2YgaGFzaExlbiAhPT0gIm51bWJlciIgfHwgaGFzaExlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGFzaExlbiBtdXN0IGJlIGEgbnVtYmVyIik7CiAgICBpZiAodHlwZW9mIHFCeXRlTGVuICE9PSAibnVtYmVyIiB8fCBxQnl0ZUxlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigicUJ5dGVMZW4gbXVzdCBiZSBhIG51bWJlciIpOwogICAgaWYgKHR5cGVvZiBobWFjRm4gIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaG1hY0ZuIG11c3QgYmUgYSBmdW5jdGlvbiIpOwogICAgbGV0IHYgPSB1OG4oaGFzaExlbik7CiAgICBsZXQgayA9IHU4bihoYXNoTGVuKTsKICAgIGxldCBpID0gMDsKICAgIGNvbnN0IHJlc2V0MiA9ICgpID0+IHsKICAgICAgdi5maWxsKDEpOwogICAgICBrLmZpbGwoMCk7CiAgICAgIGkgPSAwOwogICAgfTsKICAgIGNvbnN0IGggPSAoLi4uYikgPT4gaG1hY0ZuKGssIHYsIC4uLmIpOwogICAgY29uc3QgcmVzZWVkID0gKHNlZWQgPSB1OG4oKSkgPT4gewogICAgICBrID0gaCh1OGZyKFswXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgICBpZiAoc2VlZC5sZW5ndGggPT09IDApCiAgICAgICAgcmV0dXJuOwogICAgICBrID0gaCh1OGZyKFsxXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgfTsKICAgIGNvbnN0IGdlbjIgPSAoKSA9PiB7CiAgICAgIGlmIChpKysgPj0gMWUzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiZHJiZzogdHJpZWQgMTAwMCB2YWx1ZXMiKTsKICAgICAgbGV0IGxlbiA9IDA7CiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICB3aGlsZSAobGVuIDwgcUJ5dGVMZW4pIHsKICAgICAgICB2ID0gaCgpOwogICAgICAgIGNvbnN0IHNsID0gdi5zbGljZSgpOwogICAgICAgIG91dC5wdXNoKHNsKTsKICAgICAgICBsZW4gKz0gdi5sZW5ndGg7CiAgICAgIH0KICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyguLi5vdXQpOwogICAgfTsKICAgIGNvbnN0IGdlblVudGlsID0gKHNlZWQsIHByZWQpID0+IHsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJlc2VlZChzZWVkKTsKICAgICAgbGV0IHJlcyA9IHZvaWQgMDsKICAgICAgd2hpbGUgKCEocmVzID0gcHJlZChnZW4yKCkpKSkKICAgICAgICByZXNlZWQoKTsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgcmV0dXJuIGdlblVudGlsOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdChvYmplY3QsIHZhbGlkYXRvcnMsIG9wdFZhbGlkYXRvcnMgPSB7fSkgewogICAgY29uc3QgY2hlY2tGaWVsZCA9IChmaWVsZE5hbWUsIHR5cGUsIGlzT3B0aW9uYWwpID0+IHsKICAgICAgY29uc3QgY2hlY2tWYWwgPSB2YWxpZGF0b3JGbnNbdHlwZV07CiAgICAgIGlmICh0eXBlb2YgY2hlY2tWYWwgIT09ICJmdW5jdGlvbiIpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbGlkYXRvciAiJHt0eXBlfSIsIGV4cGVjdGVkIGZ1bmN0aW9uYCk7CiAgICAgIGNvbnN0IHZhbCA9IG9iamVjdFtmaWVsZE5hbWVdOwogICAgICBpZiAoaXNPcHRpb25hbCAmJiB2YWwgPT09IHZvaWQgMCkKICAgICAgICByZXR1cm47CiAgICAgIGlmICghY2hlY2tWYWwodmFsLCBvYmplY3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHBhcmFtICR7U3RyaW5nKGZpZWxkTmFtZSl9PSR7dmFsfSAoJHt0eXBlb2YgdmFsfSksIGV4cGVjdGVkICR7dHlwZX1gKTsKICAgICAgfQogICAgfTsKICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgdHlwZV0gb2YgT2JqZWN0LmVudHJpZXModmFsaWRhdG9ycykpCiAgICAgIGNoZWNrRmllbGQoZmllbGROYW1lLCB0eXBlLCBmYWxzZSk7CiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIHR5cGVdIG9mIE9iamVjdC5lbnRyaWVzKG9wdFZhbGlkYXRvcnMpKQogICAgICBjaGVja0ZpZWxkKGZpZWxkTmFtZSwgdHlwZSwgdHJ1ZSk7CiAgICByZXR1cm4gb2JqZWN0OwogIH0KICBmdW5jdGlvbiBtZW1vaXplZChmbikgewogICAgY29uc3QgbWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgICByZXR1cm4gKGFyZywgLi4uYXJncykgPT4gewogICAgICBjb25zdCB2YWwgPSBtYXAuZ2V0KGFyZyk7CiAgICAgIGlmICh2YWwgIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gdmFsOwogICAgICBjb25zdCBjb21wdXRlZCA9IGZuKGFyZywgLi4uYXJncyk7CiAgICAgIG1hcC5zZXQoYXJnLCBjb21wdXRlZCk7CiAgICAgIHJldHVybiBjb21wdXRlZDsKICAgIH07CiAgfQogIHZhciBfMG4yLCBfMW4yLCBfMm4yLCBoZXhlczIsIGFzY2lpcywgaXNQb3NCaWcsIGJpdE1hc2ssIHU4biwgdThmciwgdmFsaWRhdG9yRm5zLCBub3RJbXBsZW1lbnRlZDsKICB2YXIgaW5pdF91dGlsczQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3V0aWxzLmpzIigpIHsKICAgICAgXzBuMiA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMCk7CiAgICAgIF8xbjIgPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4yID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgyKTsKICAgICAgaGV4ZXMyID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoXywgaSkgPT4gaS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKSk7CiAgICAgIGFzY2lpcyA9IHsgXzA6IDQ4LCBfOTogNTcsIF9BOiA2NSwgX0Y6IDcwLCBfYTogOTcsIF9mOiAxMDIgfTsKICAgICAgaXNQb3NCaWcgPSAobikgPT4gdHlwZW9mIG4gPT09ICJiaWdpbnQiICYmIF8wbjIgPD0gbjsKICAgICAgYml0TWFzayA9IChuKSA9PiAoXzJuMiA8PCBCaWdJbnQobiAtIDEpKSAtIF8xbjI7CiAgICAgIHU4biA9IChkYXRhKSA9PiBuZXcgVWludDhBcnJheShkYXRhKTsKICAgICAgdThmciA9IChhcnIpID0+IFVpbnQ4QXJyYXkuZnJvbShhcnIpOwogICAgICB2YWxpZGF0b3JGbnMgPSB7CiAgICAgICAgYmlnaW50OiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYmlnaW50IiwKICAgICAgICBmdW5jdGlvbjogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiwKICAgICAgICBib29sZWFuOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYm9vbGVhbiIsCiAgICAgICAgc3RyaW5nOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAic3RyaW5nIiwKICAgICAgICBzdHJpbmdPclVpbnQ4QXJyYXk6ICh2YWwpID0+IHR5cGVvZiB2YWwgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHZhbCksCiAgICAgICAgaXNTYWZlSW50ZWdlcjogKHZhbCkgPT4gTnVtYmVyLmlzU2FmZUludGVnZXIodmFsKSwKICAgICAgICBhcnJheTogKHZhbCkgPT4gQXJyYXkuaXNBcnJheSh2YWwpLAogICAgICAgIGZpZWxkOiAodmFsLCBvYmplY3QpID0+IG9iamVjdC5GcC5pc1ZhbGlkKHZhbCksCiAgICAgICAgaGFzaDogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiAmJiBOdW1iZXIuaXNTYWZlSW50ZWdlcih2YWwub3V0cHV0TGVuKQogICAgICB9OwogICAgICBub3RJbXBsZW1lbnRlZCA9ICgpID0+IHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpOwogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvbW9kdWxhci5qcwogIGZ1bmN0aW9uIG1vZChhLCBiKSB7CiAgICBjb25zdCByZXN1bHQgPSBhICUgYjsKICAgIHJldHVybiByZXN1bHQgPj0gXzBuMyA/IHJlc3VsdCA6IGIgKyByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIHBvdyhudW0yLCBwb3dlciwgbW9kdWxvKSB7CiAgICBpZiAobW9kdWxvIDw9IF8wbjMgfHwgcG93ZXIgPCBfMG4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIHBvd2VyL21vZHVsbyA+IDAiKTsKICAgIGlmIChtb2R1bG8gPT09IF8xbjMpCiAgICAgIHJldHVybiBfMG4zOwogICAgbGV0IHJlcyA9IF8xbjM7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcmVzID0gcmVzICogbnVtMiAlIG1vZHVsbzsKICAgICAgbnVtMiA9IG51bTIgKiBudW0yICUgbW9kdWxvOwogICAgICBwb3dlciA+Pj0gXzFuMzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHBvdzIoeCwgcG93ZXIsIG1vZHVsbykgewogICAgbGV0IHJlcyA9IHg7CiAgICB3aGlsZSAocG93ZXItLSA+IF8wbjMpIHsKICAgICAgcmVzICo9IHJlczsKICAgICAgcmVzICU9IG1vZHVsbzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIGludmVydChudW1iZXIyLCBtb2R1bG8pIHsKICAgIGlmIChudW1iZXIyID09PSBfMG4zIHx8IG1vZHVsbyA8PSBfMG4zKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgaW52ZXJ0OiBleHBlY3RlZCBwb3NpdGl2ZSBpbnRlZ2VycywgZ290IG49JHtudW1iZXIyfSBtb2Q9JHttb2R1bG99YCk7CiAgICB9CiAgICBsZXQgYSA9IG1vZChudW1iZXIyLCBtb2R1bG8pOwogICAgbGV0IGIgPSBtb2R1bG87CiAgICBsZXQgeCA9IF8wbjMsIHkgPSBfMW4zLCB1ID0gXzFuMywgdiA9IF8wbjM7CiAgICB3aGlsZSAoYSAhPT0gXzBuMykgewogICAgICBjb25zdCBxID0gYiAvIGE7CiAgICAgIGNvbnN0IHIgPSBiICUgYTsKICAgICAgY29uc3QgbSA9IHggLSB1ICogcTsKICAgICAgY29uc3QgbiA9IHkgLSB2ICogcTsKICAgICAgYiA9IGEsIGEgPSByLCB4ID0gdSwgeSA9IHYsIHUgPSBtLCB2ID0gbjsKICAgIH0KICAgIGNvbnN0IGdjZCA9IGI7CiAgICBpZiAoZ2NkICE9PSBfMW4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImludmVydDogZG9lcyBub3QgZXhpc3QiKTsKICAgIHJldHVybiBtb2QoeCwgbW9kdWxvKTsKICB9CiAgZnVuY3Rpb24gdG9uZWxsaVNoYW5rcyhQKSB7CiAgICBjb25zdCBsZWdlbmRyZUMgPSAoUCAtIF8xbjMpIC8gXzJuMzsKICAgIGxldCBRLCBTLCBaOwogICAgZm9yIChRID0gUCAtIF8xbjMsIFMgPSAwOyBRICUgXzJuMyA9PT0gXzBuMzsgUSAvPSBfMm4zLCBTKyspCiAgICAgIDsKICAgIGZvciAoWiA9IF8ybjM7IFogPCBQICYmIHBvdyhaLCBsZWdlbmRyZUMsIFApICE9PSBQIC0gXzFuMzsgWisrKQogICAgICA7CiAgICBpZiAoUyA9PT0gMSkgewogICAgICBjb25zdCBwMWRpdjQgPSAoUCArIF8xbjMpIC8gXzRuOwogICAgICByZXR1cm4gZnVuY3Rpb24gdG9uZWxsaUZhc3QoRnAyLCBuKSB7CiAgICAgICAgY29uc3Qgcm9vdDIgPSBGcDIucG93KG4sIHAxZGl2NCk7CiAgICAgICAgaWYgKCFGcDIuZXFsKEZwMi5zcXIocm9vdDIpLCBuKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgICAgICByZXR1cm4gcm9vdDI7CiAgICAgIH07CiAgICB9CiAgICBjb25zdCBRMWRpdjIgPSAoUSArIF8xbjMpIC8gXzJuMzsKICAgIHJldHVybiBmdW5jdGlvbiB0b25lbGxpU2xvdyhGcDIsIG4pIHsKICAgICAgaWYgKEZwMi5wb3cobiwgbGVnZW5kcmVDKSA9PT0gRnAyLm5lZyhGcDIuT05FKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgIGxldCByID0gUzsKICAgICAgbGV0IGcgPSBGcDIucG93KEZwMi5tdWwoRnAyLk9ORSwgWiksIFEpOwogICAgICBsZXQgeCA9IEZwMi5wb3cobiwgUTFkaXYyKTsKICAgICAgbGV0IGIgPSBGcDIucG93KG4sIFEpOwogICAgICB3aGlsZSAoIUZwMi5lcWwoYiwgRnAyLk9ORSkpIHsKICAgICAgICBpZiAoRnAyLmVxbChiLCBGcDIuWkVSTykpCiAgICAgICAgICByZXR1cm4gRnAyLlpFUk87CiAgICAgICAgbGV0IG0gPSAxOwogICAgICAgIGZvciAobGV0IHQyID0gRnAyLnNxcihiKTsgbSA8IHI7IG0rKykgewogICAgICAgICAgaWYgKEZwMi5lcWwodDIsIEZwMi5PTkUpKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIHQyID0gRnAyLnNxcih0Mik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGdlID0gRnAyLnBvdyhnLCBfMW4zIDw8IEJpZ0ludChyIC0gbSAtIDEpKTsKICAgICAgICBnID0gRnAyLnNxcihnZSk7CiAgICAgICAgeCA9IEZwMi5tdWwoeCwgZ2UpOwogICAgICAgIGIgPSBGcDIubXVsKGIsIGcpOwogICAgICAgIHIgPSBtOwogICAgICB9CiAgICAgIHJldHVybiB4OwogICAgfTsKICB9CiAgZnVuY3Rpb24gRnBTcXJ0KFApIHsKICAgIGlmIChQICUgXzRuID09PSBfM24pIHsKICAgICAgY29uc3QgcDFkaXY0ID0gKFAgKyBfMW4zKSAvIF80bjsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNxcnQzbW9kNChGcDIsIG4pIHsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5wb3cobiwgcDFkaXY0KTsKICAgICAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihyb290MiksIG4pKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBzcXVhcmUgcm9vdCIpOwogICAgICAgIHJldHVybiByb290MjsKICAgICAgfTsKICAgIH0KICAgIGlmIChQICUgXzhuID09PSBfNW4pIHsKICAgICAgY29uc3QgYzEgPSAoUCAtIF81bikgLyBfOG47CiAgICAgIHJldHVybiBmdW5jdGlvbiBzcXJ0NW1vZDgoRnAyLCBuKSB7CiAgICAgICAgY29uc3QgbjIgPSBGcDIubXVsKG4sIF8ybjMpOwogICAgICAgIGNvbnN0IHYgPSBGcDIucG93KG4yLCBjMSk7CiAgICAgICAgY29uc3QgbnYgPSBGcDIubXVsKG4sIHYpOwogICAgICAgIGNvbnN0IGkgPSBGcDIubXVsKEZwMi5tdWwobnYsIF8ybjMpLCB2KTsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5tdWwobnYsIEZwMi5zdWIoaSwgRnAyLk9ORSkpOwogICAgICAgIGlmICghRnAyLmVxbChGcDIuc3FyKHJvb3QyKSwgbikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgICAgcmV0dXJuIHJvb3QyOwogICAgICB9OwogICAgfQogICAgaWYgKFAgJSBfMTZuID09PSBfOW4pIHsKICAgIH0KICAgIHJldHVybiB0b25lbGxpU2hhbmtzKFApOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7CiAgICBjb25zdCBpbml0aWFsID0gewogICAgICBPUkRFUjogImJpZ2ludCIsCiAgICAgIE1BU0s6ICJiaWdpbnQiLAogICAgICBCWVRFUzogImlzU2FmZUludGVnZXIiLAogICAgICBCSVRTOiAiaXNTYWZlSW50ZWdlciIKICAgIH07CiAgICBjb25zdCBvcHRzID0gRklFTERfRklFTERTLnJlZHVjZSgobWFwLCB2YWwpID0+IHsKICAgICAgbWFwW3ZhbF0gPSAiZnVuY3Rpb24iOwogICAgICByZXR1cm4gbWFwOwogICAgfSwgaW5pdGlhbCk7CiAgICByZXR1cm4gdmFsaWRhdGVPYmplY3QoZmllbGQsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBGcFBvdyhmMiwgbnVtMiwgcG93ZXIpIHsKICAgIGlmIChwb3dlciA8IF8wbjMpCiAgICAgIHRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgcG93ZXIgPiAwIik7CiAgICBpZiAocG93ZXIgPT09IF8wbjMpCiAgICAgIHJldHVybiBmMi5PTkU7CiAgICBpZiAocG93ZXIgPT09IF8xbjMpCiAgICAgIHJldHVybiBudW0yOwogICAgbGV0IHAgPSBmMi5PTkU7CiAgICBsZXQgZCA9IG51bTI7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcCA9IGYyLm11bChwLCBkKTsKICAgICAgZCA9IGYyLnNxcihkKTsKICAgICAgcG93ZXIgPj49IF8xbjM7CiAgICB9CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gRnBJbnZlcnRCYXRjaChmMiwgbnVtcykgewogICAgY29uc3QgdG1wID0gbmV3IEFycmF5KG51bXMubGVuZ3RoKTsKICAgIGNvbnN0IGxhc3RNdWx0aXBsaWVkID0gbnVtcy5yZWR1Y2UoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGFjYzsKICAgICAgcmV0dXJuIGYyLm11bChhY2MsIG51bTIpOwogICAgfSwgZjIuT05FKTsKICAgIGNvbnN0IGludmVydGVkID0gZjIuaW52KGxhc3RNdWx0aXBsaWVkKTsKICAgIG51bXMucmVkdWNlUmlnaHQoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGYyLm11bChhY2MsIHRtcFtpXSk7CiAgICAgIHJldHVybiBmMi5tdWwoYWNjLCBudW0yKTsKICAgIH0sIGludmVydGVkKTsKICAgIHJldHVybiB0bXA7CiAgfQogIGZ1bmN0aW9uIG5MZW5ndGgobiwgbkJpdExlbmd0aCkgewogICAgY29uc3QgX25CaXRMZW5ndGggPSBuQml0TGVuZ3RoICE9PSB2b2lkIDAgPyBuQml0TGVuZ3RoIDogbi50b1N0cmluZygyKS5sZW5ndGg7CiAgICBjb25zdCBuQnl0ZUxlbmd0aCA9IE1hdGguY2VpbChfbkJpdExlbmd0aCAvIDgpOwogICAgcmV0dXJuIHsgbkJpdExlbmd0aDogX25CaXRMZW5ndGgsIG5CeXRlTGVuZ3RoIH07CiAgfQogIGZ1bmN0aW9uIEZpZWxkKE9SREVSLCBiaXRMZW4yLCBpc0xFMiA9IGZhbHNlLCByZWRlZiA9IHt9KSB7CiAgICBpZiAoT1JERVIgPD0gXzBuMykKICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBGaWVsZCBPUkRFUiA+IDAsIGdvdCAke09SREVSfWApOwogICAgY29uc3QgeyBuQml0TGVuZ3RoOiBCSVRTLCBuQnl0ZUxlbmd0aDogQllURVMgfSA9IG5MZW5ndGgoT1JERVIsIGJpdExlbjIpOwogICAgaWYgKEJZVEVTID4gMjA0OCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGaWVsZCBsZW5ndGhzIG92ZXIgMjA0OCBieXRlcyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgY29uc3Qgc3FydFAgPSBGcFNxcnQoT1JERVIpOwogICAgY29uc3QgZjIgPSBPYmplY3QuZnJlZXplKHsKICAgICAgT1JERVIsCiAgICAgIEJJVFMsCiAgICAgIEJZVEVTLAogICAgICBNQVNLOiBiaXRNYXNrKEJJVFMpLAogICAgICBaRVJPOiBfMG4zLAogICAgICBPTkU6IF8xbjMsCiAgICAgIGNyZWF0ZTogKG51bTIpID0+IG1vZChudW0yLCBPUkRFUiksCiAgICAgIGlzVmFsaWQ6IChudW0yKSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiBudW0yICE9PSAiYmlnaW50IikKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBmaWVsZCBlbGVtZW50OiBleHBlY3RlZCBiaWdpbnQsIGdvdCAke3R5cGVvZiBudW0yfWApOwogICAgICAgIHJldHVybiBfMG4zIDw9IG51bTIgJiYgbnVtMiA8IE9SREVSOwogICAgICB9LAogICAgICBpczA6IChudW0yKSA9PiBudW0yID09PSBfMG4zLAogICAgICBpc09kZDogKG51bTIpID0+IChudW0yICYgXzFuMykgPT09IF8xbjMsCiAgICAgIG5lZzogKG51bTIpID0+IG1vZCgtbnVtMiwgT1JERVIpLAogICAgICBlcWw6IChsaHMsIHJocykgPT4gbGhzID09PSByaHMsCiAgICAgIHNxcjogKG51bTIpID0+IG1vZChudW0yICogbnVtMiwgT1JERVIpLAogICAgICBhZGQ6IChsaHMsIHJocykgPT4gbW9kKGxocyArIHJocywgT1JERVIpLAogICAgICBzdWI6IChsaHMsIHJocykgPT4gbW9kKGxocyAtIHJocywgT1JERVIpLAogICAgICBtdWw6IChsaHMsIHJocykgPT4gbW9kKGxocyAqIHJocywgT1JERVIpLAogICAgICBwb3c6IChudW0yLCBwb3dlcikgPT4gRnBQb3coZjIsIG51bTIsIHBvd2VyKSwKICAgICAgZGl2OiAobGhzLCByaHMpID0+IG1vZChsaHMgKiBpbnZlcnQocmhzLCBPUkRFUiksIE9SREVSKSwKICAgICAgLy8gU2FtZSBhcyBhYm92ZSwgYnV0IGRvZXNuJ3Qgbm9ybWFsaXplCiAgICAgIHNxck46IChudW0yKSA9PiBudW0yICogbnVtMiwKICAgICAgYWRkTjogKGxocywgcmhzKSA9PiBsaHMgKyByaHMsCiAgICAgIHN1Yk46IChsaHMsIHJocykgPT4gbGhzIC0gcmhzLAogICAgICBtdWxOOiAobGhzLCByaHMpID0+IGxocyAqIHJocywKICAgICAgaW52OiAobnVtMikgPT4gaW52ZXJ0KG51bTIsIE9SREVSKSwKICAgICAgc3FydDogcmVkZWYuc3FydCB8fCAoKG4pID0+IHNxcnRQKGYyLCBuKSksCiAgICAgIGludmVydEJhdGNoOiAobHN0KSA9PiBGcEludmVydEJhdGNoKGYyLCBsc3QpLAogICAgICAvLyBUT0RPOiBkbyB3ZSByZWFsbHkgbmVlZCBjb25zdGFudCBjbW92PwogICAgICAvLyBXZSBkb24ndCBoYXZlIGNvbnN0LXRpbWUgYmlnaW50cyBhbnl3YXksIHNvIHByb2JhYmx5IHdpbGwgYmUgbm90IHZlcnkgdXNlZnVsCiAgICAgIGNtb3Y6IChhLCBiLCBjKSA9PiBjID8gYiA6IGEsCiAgICAgIHRvQnl0ZXM6IChudW0yKSA9PiBpc0xFMiA/IG51bWJlclRvQnl0ZXNMRShudW0yLCBCWVRFUykgOiBudW1iZXJUb0J5dGVzQkUobnVtMiwgQllURVMpLAogICAgICBmcm9tQnl0ZXM6IChieXRlczIpID0+IHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCAhPT0gQllURVMpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZwLmZyb21CeXRlczogZXhwZWN0ZWQgJHtCWVRFU30sIGdvdCAke2J5dGVzMi5sZW5ndGh9YCk7CiAgICAgICAgcmV0dXJuIGlzTEUyID8gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgOiBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShmMik7CiAgfQogIGZ1bmN0aW9uIGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcikgewogICAgaWYgKHR5cGVvZiBmaWVsZE9yZGVyICE9PSAiYmlnaW50IikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaWVsZCBvcmRlciBtdXN0IGJlIGJpZ2ludCIpOwogICAgY29uc3QgYml0TGVuZ3RoID0gZmllbGRPcmRlci50b1N0cmluZygyKS5sZW5ndGg7CiAgICByZXR1cm4gTWF0aC5jZWlsKGJpdExlbmd0aCAvIDgpOwogIH0KICBmdW5jdGlvbiBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpIHsKICAgIGNvbnN0IGxlbmd0aCA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICByZXR1cm4gbGVuZ3RoICsgTWF0aC5jZWlsKGxlbmd0aCAvIDIpOwogIH0KICBmdW5jdGlvbiBtYXBIYXNoVG9GaWVsZChrZXksIGZpZWxkT3JkZXIsIGlzTEUyID0gZmFsc2UpIHsKICAgIGNvbnN0IGxlbiA9IGtleS5sZW5ndGg7CiAgICBjb25zdCBmaWVsZExlbiA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICBjb25zdCBtaW5MZW4gPSBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpOwogICAgaWYgKGxlbiA8IDE2IHx8IGxlbiA8IG1pbkxlbiB8fCBsZW4gPiAxMDI0KQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkICR7bWluTGVufS0xMDI0IGJ5dGVzIG9mIGlucHV0LCBnb3QgJHtsZW59YCk7CiAgICBjb25zdCBudW0yID0gaXNMRTIgPyBieXRlc1RvTnVtYmVyQkUoa2V5KSA6IGJ5dGVzVG9OdW1iZXJMRShrZXkpOwogICAgY29uc3QgcmVkdWNlZCA9IG1vZChudW0yLCBmaWVsZE9yZGVyIC0gXzFuMykgKyBfMW4zOwogICAgcmV0dXJuIGlzTEUyID8gbnVtYmVyVG9CeXRlc0xFKHJlZHVjZWQsIGZpZWxkTGVuKSA6IG51bWJlclRvQnl0ZXNCRShyZWR1Y2VkLCBmaWVsZExlbik7CiAgfQogIHZhciBfMG4zLCBfMW4zLCBfMm4zLCBfM24sIF80biwgXzVuLCBfOG4sIF85biwgXzE2biwgRklFTERfRklFTERTOwogIHZhciBpbml0X21vZHVsYXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L21vZHVsYXIuanMiKCkgewogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBfMG4zID0gQmlnSW50KDApOwogICAgICBfMW4zID0gQmlnSW50KDEpOwogICAgICBfMm4zID0gQmlnSW50KDIpOwogICAgICBfM24gPSBCaWdJbnQoMyk7CiAgICAgIF80biA9IEJpZ0ludCg0KTsKICAgICAgXzVuID0gQmlnSW50KDUpOwogICAgICBfOG4gPSBCaWdJbnQoOCk7CiAgICAgIF85biA9IEJpZ0ludCg5KTsKICAgICAgXzE2biA9IEJpZ0ludCgxNik7CiAgICAgIEZJRUxEX0ZJRUxEUyA9IFsKICAgICAgICAiY3JlYXRlIiwKICAgICAgICAiaXNWYWxpZCIsCiAgICAgICAgImlzMCIsCiAgICAgICAgIm5lZyIsCiAgICAgICAgImludiIsCiAgICAgICAgInNxcnQiLAogICAgICAgICJzcXIiLAogICAgICAgICJlcWwiLAogICAgICAgICJhZGQiLAogICAgICAgICJzdWIiLAogICAgICAgICJtdWwiLAogICAgICAgICJwb3ciLAogICAgICAgICJkaXYiLAogICAgICAgICJhZGROIiwKICAgICAgICAic3ViTiIsCiAgICAgICAgIm11bE4iLAogICAgICAgICJzcXJOIgogICAgICBdOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvY3VydmUuanMKICBmdW5jdGlvbiB3TkFGKGMsIGJpdHMpIHsKICAgIGNvbnN0IGNvbnN0VGltZU5lZ2F0ZSA9IChjb25kaXRpb24sIGl0ZW0pID0+IHsKICAgICAgY29uc3QgbmVnID0gaXRlbS5uZWdhdGUoKTsKICAgICAgcmV0dXJuIGNvbmRpdGlvbiA/IG5lZyA6IGl0ZW07CiAgICB9OwogICAgY29uc3QgdmFsaWRhdGVXID0gKFcpID0+IHsKICAgICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihXKSB8fCBXIDw9IDAgfHwgVyA+IGJpdHMpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBXcm9uZyB3aW5kb3cgc2l6ZT0ke1d9LCBzaG91bGQgYmUgWzEuLiR7Yml0c31dYCk7CiAgICB9OwogICAgY29uc3Qgb3B0cyA9IChXKSA9PiB7CiAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgY29uc3Qgd2luZG93cyA9IE1hdGguY2VpbChiaXRzIC8gVykgKyAxOwogICAgICBjb25zdCB3aW5kb3dTaXplID0gMiAqKiAoVyAtIDEpOwogICAgICByZXR1cm4geyB3aW5kb3dzLCB3aW5kb3dTaXplIH07CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgY29uc3RUaW1lTmVnYXRlLAogICAgICAvLyBub24tY29uc3QgdGltZSBtdWx0aXBsaWNhdGlvbiBsYWRkZXIKICAgICAgdW5zYWZlTGFkZGVyKGVsbSwgbikgewogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBkID0gZWxtOwogICAgICAgIHdoaWxlIChuID4gXzBuNCkgewogICAgICAgICAgaWYgKG4gJiBfMW40KQogICAgICAgICAgICBwID0gcC5hZGQoZCk7CiAgICAgICAgICBkID0gZC5kb3VibGUoKTsKICAgICAgICAgIG4gPj49IF8xbjQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwOwogICAgICB9LAogICAgICAvKioKICAgICAgICogQ3JlYXRlcyBhIHdOQUYgcHJlY29tcHV0YXRpb24gd2luZG93LiBVc2VkIGZvciBjYWNoaW5nLgogICAgICAgKiBEZWZhdWx0IHdpbmRvdyBzaXplIGlzIHNldCBieSBgdXRpbHMucHJlY29tcHV0ZSgpYCBhbmQgaXMgZXF1YWwgdG8gOC4KICAgICAgICogTnVtYmVyIG9mIHByZWNvbXB1dGVkIHBvaW50cyBkZXBlbmRzIG9uIHRoZSBjdXJ2ZSBzaXplOgogICAgICAgKiAyXijwnZGK4oiSMSkgKiAoTWF0aC5jZWlsKPCdkZsgLyDwnZGKKSArIDEpLCB3aGVyZToKICAgICAgICogLSDwnZGKIGlzIHRoZSB3aW5kb3cgc2l6ZQogICAgICAgKiAtIPCdkZsgaXMgdGhlIGJpdGxlbmd0aCBvZiB0aGUgY3VydmUgb3JkZXIuCiAgICAgICAqIEZvciBhIDI1Ni1iaXQgY3VydmUgYW5kIHdpbmRvdyBzaXplIDgsIHRoZSBudW1iZXIgb2YgcHJlY29tcHV0ZWQgcG9pbnRzIGlzIDEyOCAqIDMzID0gNDIyNC4KICAgICAgICogQHJldHVybnMgcHJlY29tcHV0ZWQgcG9pbnQgdGFibGVzIGZsYXR0ZW5lZCB0byBhIHNpbmdsZSBhcnJheQogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZVdpbmRvdyhlbG0sIFcpIHsKICAgICAgICBjb25zdCB7IHdpbmRvd3MsIHdpbmRvd1NpemUgfSA9IG9wdHMoVyk7CiAgICAgICAgY29uc3QgcG9pbnRzID0gW107CiAgICAgICAgbGV0IHAgPSBlbG07CiAgICAgICAgbGV0IGJhc2UyID0gcDsKICAgICAgICBmb3IgKGxldCB3aW5kb3cyID0gMDsgd2luZG93MiA8IHdpbmRvd3M7IHdpbmRvdzIrKykgewogICAgICAgICAgYmFzZTIgPSBwOwogICAgICAgICAgcG9pbnRzLnB1c2goYmFzZTIpOwogICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB3aW5kb3dTaXplOyBpKyspIHsKICAgICAgICAgICAgYmFzZTIgPSBiYXNlMi5hZGQocCk7CiAgICAgICAgICAgIHBvaW50cy5wdXNoKGJhc2UyKTsKICAgICAgICAgIH0KICAgICAgICAgIHAgPSBiYXNlMi5kb3VibGUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBvaW50czsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIEltcGxlbWVudHMgZWMgbXVsdGlwbGljYXRpb24gdXNpbmcgcHJlY29tcHV0ZWQgdGFibGVzIGFuZCB3LWFyeSBub24tYWRqYWNlbnQgZm9ybS4KICAgICAgICogQHBhcmFtIFcgd2luZG93IHNpemUKICAgICAgICogQHBhcmFtIHByZWNvbXB1dGVzIHByZWNvbXB1dGVkIHRhYmxlcwogICAgICAgKiBAcGFyYW0gbiBzY2FsYXIgKHdlIGRvbid0IGNoZWNrIGhlcmUsIGJ1dCBzaG91bGQgYmUgbGVzcyB0aGFuIGN1cnZlIG9yZGVyKQogICAgICAgKiBAcmV0dXJucyByZWFsIGFuZCBmYWtlIChmb3IgY29uc3QtdGltZSkgcG9pbnRzCiAgICAgICAqLwogICAgICB3TkFGKFcsIHByZWNvbXB1dGVzLCBuKSB7CiAgICAgICAgY29uc3QgeyB3aW5kb3dzLCB3aW5kb3dTaXplIH0gPSBvcHRzKFcpOwogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBmMiA9IGMuQkFTRTsKICAgICAgICBjb25zdCBtYXNrID0gQmlnSW50KDIgKiogVyAtIDEpOwogICAgICAgIGNvbnN0IG1heE51bWJlciA9IDIgKiogVzsKICAgICAgICBjb25zdCBzaGlmdEJ5ID0gQmlnSW50KFcpOwogICAgICAgIGZvciAobGV0IHdpbmRvdzIgPSAwOyB3aW5kb3cyIDwgd2luZG93czsgd2luZG93MisrKSB7CiAgICAgICAgICBjb25zdCBvZmZzZXQgPSB3aW5kb3cyICogd2luZG93U2l6ZTsKICAgICAgICAgIGxldCB3Yml0cyA9IE51bWJlcihuICYgbWFzayk7CiAgICAgICAgICBuID4+PSBzaGlmdEJ5OwogICAgICAgICAgaWYgKHdiaXRzID4gd2luZG93U2l6ZSkgewogICAgICAgICAgICB3Yml0cyAtPSBtYXhOdW1iZXI7CiAgICAgICAgICAgIG4gKz0gXzFuNDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IG9mZnNldDEgPSBvZmZzZXQ7CiAgICAgICAgICBjb25zdCBvZmZzZXQyID0gb2Zmc2V0ICsgTWF0aC5hYnMod2JpdHMpIC0gMTsKICAgICAgICAgIGNvbnN0IGNvbmQxID0gd2luZG93MiAlIDIgIT09IDA7CiAgICAgICAgICBjb25zdCBjb25kMiA9IHdiaXRzIDwgMDsKICAgICAgICAgIGlmICh3Yml0cyA9PT0gMCkgewogICAgICAgICAgICBmMiA9IGYyLmFkZChjb25zdFRpbWVOZWdhdGUoY29uZDEsIHByZWNvbXB1dGVzW29mZnNldDFdKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwID0gcC5hZGQoY29uc3RUaW1lTmVnYXRlKGNvbmQyLCBwcmVjb21wdXRlc1tvZmZzZXQyXSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4geyBwLCBmOiBmMiB9OwogICAgICB9LAogICAgICB3TkFGQ2FjaGVkKFAsIG4sIHRyYW5zZm9ybSkgewogICAgICAgIGNvbnN0IFcgPSBwb2ludFdpbmRvd1NpemVzLmdldChQKSB8fCAxOwogICAgICAgIGxldCBjb21wID0gcG9pbnRQcmVjb21wdXRlcy5nZXQoUCk7CiAgICAgICAgaWYgKCFjb21wKSB7CiAgICAgICAgICBjb21wID0gdGhpcy5wcmVjb21wdXRlV2luZG93KFAsIFcpOwogICAgICAgICAgaWYgKFcgIT09IDEpCiAgICAgICAgICAgIHBvaW50UHJlY29tcHV0ZXMuc2V0KFAsIHRyYW5zZm9ybShjb21wKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLndOQUYoVywgY29tcCwgbik7CiAgICAgIH0sCiAgICAgIC8vIFdlIGNhbGN1bGF0ZSBwcmVjb21wdXRlcyBmb3IgZWxsaXB0aWMgY3VydmUgcG9pbnQgbXVsdGlwbGljYXRpb24KICAgICAgLy8gdXNpbmcgd2luZG93ZWQgbWV0aG9kLiBUaGlzIHNwZWNpZmllcyB3aW5kb3cgc2l6ZSBhbmQKICAgICAgLy8gc3RvcmVzIHByZWNvbXB1dGVkIHZhbHVlcy4gVXN1YWxseSBvbmx5IGJhc2UgcG9pbnQgd291bGQgYmUgcHJlY29tcHV0ZWQuCiAgICAgIHNldFdpbmRvd1NpemUoUCwgVykgewogICAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgICBwb2ludFdpbmRvd1NpemVzLnNldChQLCBXKTsKICAgICAgICBwb2ludFByZWNvbXB1dGVzLmRlbGV0ZShQKTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gcGlwcGVuZ2VyKGMsIGZpZWxkLCBwb2ludHMsIHNjYWxhcnMpIHsKICAgIGlmICghQXJyYXkuaXNBcnJheShwb2ludHMpIHx8ICFBcnJheS5pc0FycmF5KHNjYWxhcnMpIHx8IHNjYWxhcnMubGVuZ3RoICE9PSBwb2ludHMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImFycmF5cyBvZiBwb2ludHMgYW5kIHNjYWxhcnMgbXVzdCBoYXZlIGVxdWFsIGxlbmd0aCIpOwogICAgc2NhbGFycy5mb3JFYWNoKChzLCBpKSA9PiB7CiAgICAgIGlmICghZmllbGQuaXNWYWxpZChzKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHNjYWxhciBhdCBpbmRleCAke2l9YCk7CiAgICB9KTsKICAgIHBvaW50cy5mb3JFYWNoKChwLCBpKSA9PiB7CiAgICAgIGlmICghKHAgaW5zdGFuY2VvZiBjKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHBvaW50IGF0IGluZGV4ICR7aX1gKTsKICAgIH0pOwogICAgY29uc3Qgd2JpdHMgPSBiaXRMZW4oQmlnSW50KHBvaW50cy5sZW5ndGgpKTsKICAgIGNvbnN0IHdpbmRvd1NpemUgPSB3Yml0cyA+IDEyID8gd2JpdHMgLSAzIDogd2JpdHMgPiA0ID8gd2JpdHMgLSAyIDogd2JpdHMgPyAyIDogMTsKICAgIGNvbnN0IE1BU0sgPSAoMSA8PCB3aW5kb3dTaXplKSAtIDE7CiAgICBjb25zdCBidWNrZXRzID0gbmV3IEFycmF5KE1BU0sgKyAxKS5maWxsKGMuWkVSTyk7CiAgICBjb25zdCBsYXN0Qml0cyA9IE1hdGguZmxvb3IoKGZpZWxkLkJJVFMgLSAxKSAvIHdpbmRvd1NpemUpICogd2luZG93U2l6ZTsKICAgIGxldCBzdW0gPSBjLlpFUk87CiAgICBmb3IgKGxldCBpID0gbGFzdEJpdHM7IGkgPj0gMDsgaSAtPSB3aW5kb3dTaXplKSB7CiAgICAgIGJ1Y2tldHMuZmlsbChjLlpFUk8pOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNjYWxhcnMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjb25zdCBzY2FsYXIgPSBzY2FsYXJzW2pdOwogICAgICAgIGNvbnN0IHdiaXRzMiA9IE51bWJlcihzY2FsYXIgPj4gQmlnSW50KGkpICYgQmlnSW50KE1BU0spKTsKICAgICAgICBidWNrZXRzW3diaXRzMl0gPSBidWNrZXRzW3diaXRzMl0uYWRkKHBvaW50c1tqXSk7CiAgICAgIH0KICAgICAgbGV0IHJlc0kgPSBjLlpFUk87CiAgICAgIGZvciAobGV0IGogPSBidWNrZXRzLmxlbmd0aCAtIDEsIHN1bUkgPSBjLlpFUk87IGogPiAwOyBqLS0pIHsKICAgICAgICBzdW1JID0gc3VtSS5hZGQoYnVja2V0c1tqXSk7CiAgICAgICAgcmVzSSA9IHJlc0kuYWRkKHN1bUkpOwogICAgICB9CiAgICAgIHN1bSA9IHN1bS5hZGQocmVzSSk7CiAgICAgIGlmIChpICE9PSAwKQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2luZG93U2l6ZTsgaisrKQogICAgICAgICAgc3VtID0gc3VtLmRvdWJsZSgpOwogICAgfQogICAgcmV0dXJuIHN1bTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVCYXNpYyhjdXJ2ZSkgewogICAgdmFsaWRhdGVGaWVsZChjdXJ2ZS5GcCk7CiAgICB2YWxpZGF0ZU9iamVjdChjdXJ2ZSwgewogICAgICBuOiAiYmlnaW50IiwKICAgICAgaDogImJpZ2ludCIsCiAgICAgIEd4OiAiZmllbGQiLAogICAgICBHeTogImZpZWxkIgogICAgfSwgewogICAgICBuQml0TGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIG5CeXRlTGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoewogICAgICAuLi5uTGVuZ3RoKGN1cnZlLm4sIGN1cnZlLm5CaXRMZW5ndGgpLAogICAgICAuLi5jdXJ2ZSwKICAgICAgLi4ueyBwOiBjdXJ2ZS5GcC5PUkRFUiB9CiAgICB9KTsKICB9CiAgdmFyIF8wbjQsIF8xbjQsIHBvaW50UHJlY29tcHV0ZXMsIHBvaW50V2luZG93U2l6ZXM7CiAgdmFyIGluaXRfY3VydmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzIigpIHsKICAgICAgaW5pdF9tb2R1bGFyKCk7CiAgICAgIGluaXRfdXRpbHM0KCk7CiAgICAgIF8wbjQgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjQgPSBCaWdJbnQoMSk7CiAgICAgIHBvaW50UHJlY29tcHV0ZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICAgICAgcG9pbnRXaW5kb3dTaXplcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3Qvd2VpZXJzdHJhc3MuanMKICBmdW5jdGlvbiB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cykgewogICAgaWYgKG9wdHMubG93UyAhPT0gdm9pZCAwKQogICAgICBhYm9vbCgibG93UyIsIG9wdHMubG93Uyk7CiAgICBpZiAob3B0cy5wcmVoYXNoICE9PSB2b2lkIDApCiAgICAgIGFib29sKCJwcmVoYXNoIiwgb3B0cy5wcmVoYXNoKTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVQb2ludE9wdHMoY3VydmUpIHsKICAgIGNvbnN0IG9wdHMgPSB2YWxpZGF0ZUJhc2ljKGN1cnZlKTsKICAgIHZhbGlkYXRlT2JqZWN0KG9wdHMsIHsKICAgICAgYTogImZpZWxkIiwKICAgICAgYjogImZpZWxkIgogICAgfSwgewogICAgICBhbGxvd2VkUHJpdmF0ZUtleUxlbmd0aHM6ICJhcnJheSIsCiAgICAgIHdyYXBQcml2YXRlS2V5OiAiYm9vbGVhbiIsCiAgICAgIGlzVG9yc2lvbkZyZWU6ICJmdW5jdGlvbiIsCiAgICAgIGNsZWFyQ29mYWN0b3I6ICJmdW5jdGlvbiIsCiAgICAgIGFsbG93SW5maW5pdHlQb2ludDogImJvb2xlYW4iLAogICAgICBmcm9tQnl0ZXM6ICJmdW5jdGlvbiIsCiAgICAgIHRvQnl0ZXM6ICJmdW5jdGlvbiIKICAgIH0pOwogICAgY29uc3QgeyBlbmRvLCBGcDogRnAyLCBhIH0gPSBvcHRzOwogICAgaWYgKGVuZG8pIHsKICAgICAgaWYgKCFGcDIuZXFsKGEsIEZwMi5aRVJPKSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRW5kb21vcnBoaXNtIGNhbiBvbmx5IGJlIGRlZmluZWQgZm9yIEtvYmxpdHogY3VydmVzIHRoYXQgaGF2ZSBhPTAiKTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIGVuZG8gIT09ICJvYmplY3QiIHx8IHR5cGVvZiBlbmRvLmJldGEgIT09ICJiaWdpbnQiIHx8IHR5cGVvZiBlbmRvLnNwbGl0U2NhbGFyICE9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBlbmRvbW9ycGhpc20gd2l0aCBiZXRhOiBiaWdpbnQgYW5kIHNwbGl0U2NhbGFyOiBmdW5jdGlvbiIpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLm9wdHMgfSk7CiAgfQogIGZ1bmN0aW9uIHdlaWVyc3RyYXNzUG9pbnRzKG9wdHMpIHsKICAgIGNvbnN0IENVUlZFID0gdmFsaWRhdGVQb2ludE9wdHMob3B0cyk7CiAgICBjb25zdCB7IEZwOiBGcDIgfSA9IENVUlZFOwogICAgY29uc3QgRm4gPSBGaWVsZChDVVJWRS5uLCBDVVJWRS5uQml0TGVuZ3RoKTsKICAgIGNvbnN0IHRvQnl0ZXMzID0gQ1VSVkUudG9CeXRlcyB8fCAoKF9jLCBwb2ludCwgX2lzQ29tcHJlc3NlZCkgPT4gewogICAgICBjb25zdCBhID0gcG9pbnQudG9BZmZpbmUoKTsKICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyhVaW50OEFycmF5LmZyb20oWzRdKSwgRnAyLnRvQnl0ZXMoYS54KSwgRnAyLnRvQnl0ZXMoYS55KSk7CiAgICB9KTsKICAgIGNvbnN0IGZyb21CeXRlczIgPSBDVVJWRS5mcm9tQnl0ZXMgfHwgKChieXRlczIpID0+IHsKICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgY29uc3QgeCA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheSgwLCBGcDIuQllURVMpKTsKICAgICAgY29uc3QgeSA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheShGcDIuQllURVMsIDIgKiBGcDIuQllURVMpKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfSk7CiAgICBmdW5jdGlvbiB3ZWllcnN0cmFzc0VxdWF0aW9uKHgpIHsKICAgICAgY29uc3QgeyBhLCBiIH0gPSBDVVJWRTsKICAgICAgY29uc3QgeDIgPSBGcDIuc3FyKHgpOwogICAgICBjb25zdCB4MyA9IEZwMi5tdWwoeDIsIHgpOwogICAgICByZXR1cm4gRnAyLmFkZChGcDIuYWRkKHgzLCBGcDIubXVsKHgsIGEpKSwgYik7CiAgICB9CiAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihDVVJWRS5HeSksIHdlaWVyc3RyYXNzRXF1YXRpb24oQ1VSVkUuR3gpKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgZ2VuZXJhdG9yIHBvaW50OiBlcXVhdGlvbiBsZWZ0ICE9IHJpZ2h0Iik7CiAgICBmdW5jdGlvbiBpc1dpdGhpbkN1cnZlT3JkZXIobnVtMikgewogICAgICByZXR1cm4gaW5SYW5nZShudW0yLCBfMW41LCBDVVJWRS5uKTsKICAgIH0KICAgIGZ1bmN0aW9uIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIoa2V5KSB7CiAgICAgIGNvbnN0IHsgYWxsb3dlZFByaXZhdGVLZXlMZW5ndGhzOiBsZW5ndGhzLCBuQnl0ZUxlbmd0aCwgd3JhcFByaXZhdGVLZXksIG46IE4gfSA9IENVUlZFOwogICAgICBpZiAobGVuZ3RocyAmJiB0eXBlb2Yga2V5ICE9PSAiYmlnaW50IikgewogICAgICAgIGlmIChpc0J5dGVzMihrZXkpKQogICAgICAgICAga2V5ID0gYnl0ZXNUb0hleDIoa2V5KTsKICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gInN0cmluZyIgfHwgIWxlbmd0aHMuaW5jbHVkZXMoa2V5Lmxlbmd0aCkpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQga2V5Iik7CiAgICAgICAga2V5ID0ga2V5LnBhZFN0YXJ0KG5CeXRlTGVuZ3RoICogMiwgIjAiKTsKICAgICAgfQogICAgICBsZXQgbnVtMjsKICAgICAgdHJ5IHsKICAgICAgICBudW0yID0gdHlwZW9mIGtleSA9PT0gImJpZ2ludCIgPyBrZXkgOiBieXRlc1RvTnVtYmVyQkUoZW5zdXJlQnl0ZXMoInByaXZhdGUga2V5Iiwga2V5LCBuQnl0ZUxlbmd0aCkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgcHJpdmF0ZSBrZXkgbXVzdCBiZSAke25CeXRlTGVuZ3RofSBieXRlcywgaGV4IG9yIGJpZ2ludCwgbm90ICR7dHlwZW9mIGtleX1gKTsKICAgICAgfQogICAgICBpZiAod3JhcFByaXZhdGVLZXkpCiAgICAgICAgbnVtMiA9IG1vZChudW0yLCBOKTsKICAgICAgYUluUmFuZ2UoInByaXZhdGUga2V5IiwgbnVtMiwgXzFuNSwgTik7CiAgICAgIHJldHVybiBudW0yOwogICAgfQogICAgZnVuY3Rpb24gYXNzZXJ0UHJqUG9pbnQob3RoZXIpIHsKICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQb2ludDIpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvamVjdGl2ZVBvaW50IGV4cGVjdGVkIik7CiAgICB9CiAgICBjb25zdCB0b0FmZmluZU1lbW8gPSBtZW1vaXplZCgocCwgaXopID0+IHsKICAgICAgY29uc3QgeyBweDogeCwgcHk6IHksIHB6OiB6IH0gPSBwOwogICAgICBpZiAoRnAyLmVxbCh6LCBGcDIuT05FKSkKICAgICAgICByZXR1cm4geyB4LCB5IH07CiAgICAgIGNvbnN0IGlzMCA9IHAuaXMwKCk7CiAgICAgIGlmIChpeiA9PSBudWxsKQogICAgICAgIGl6ID0gaXMwID8gRnAyLk9ORSA6IEZwMi5pbnYoeik7CiAgICAgIGNvbnN0IGF4ID0gRnAyLm11bCh4LCBpeik7CiAgICAgIGNvbnN0IGF5ID0gRnAyLm11bCh5LCBpeik7CiAgICAgIGNvbnN0IHp6ID0gRnAyLm11bCh6LCBpeik7CiAgICAgIGlmIChpczApCiAgICAgICAgcmV0dXJuIHsgeDogRnAyLlpFUk8sIHk6IEZwMi5aRVJPIH07CiAgICAgIGlmICghRnAyLmVxbCh6eiwgRnAyLk9ORSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZaIHdhcyBpbnZhbGlkIik7CiAgICAgIHJldHVybiB7IHg6IGF4LCB5OiBheSB9OwogICAgfSk7CiAgICBjb25zdCBhc3NlcnRWYWxpZE1lbW8gPSBtZW1vaXplZCgocCkgPT4gewogICAgICBpZiAocC5pczAoKSkgewogICAgICAgIGlmIChDVVJWRS5hbGxvd0luZmluaXR5UG9pbnQgJiYgIUZwMi5pczAocC5weSkpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IFpFUk8iKTsKICAgICAgfQogICAgICBjb25zdCB7IHgsIHkgfSA9IHAudG9BZmZpbmUoKTsKICAgICAgaWYgKCFGcDIuaXNWYWxpZCh4KSB8fCAhRnAyLmlzVmFsaWQoeSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IHggb3IgeSBub3QgRkUiKTsKICAgICAgY29uc3QgbGVmdCA9IEZwMi5zcXIoeSk7CiAgICAgIGNvbnN0IHJpZ2h0ID0gd2VpZXJzdHJhc3NFcXVhdGlvbih4KTsKICAgICAgaWYgKCFGcDIuZXFsKGxlZnQsIHJpZ2h0KSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImJhZCBwb2ludDogZXF1YXRpb24gbGVmdCAhPSByaWdodCIpOwogICAgICBpZiAoIXAuaXNUb3JzaW9uRnJlZSgpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiYmFkIHBvaW50OiBub3QgaW4gcHJpbWUtb3JkZXIgc3ViZ3JvdXAiKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKICAgIGNsYXNzIFBvaW50MiB7CiAgICAgIGNvbnN0cnVjdG9yKHB4LCBweSwgcHopIHsKICAgICAgICB0aGlzLnB4ID0gcHg7CiAgICAgICAgdGhpcy5weSA9IHB5OwogICAgICAgIHRoaXMucHogPSBwejsKICAgICAgICBpZiAocHggPT0gbnVsbCB8fCAhRnAyLmlzVmFsaWQocHgpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJ4IHJlcXVpcmVkIik7CiAgICAgICAgaWYgKHB5ID09IG51bGwgfHwgIUZwMi5pc1ZhbGlkKHB5KSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigieSByZXF1aXJlZCIpOwogICAgICAgIGlmIChweiA9PSBudWxsIHx8ICFGcDIuaXNWYWxpZChweikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInogcmVxdWlyZWQiKTsKICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMpOwogICAgICB9CiAgICAgIC8vIERvZXMgbm90IHZhbGlkYXRlIGlmIHRoZSBwb2ludCBpcyBvbi1jdXJ2ZS4KICAgICAgLy8gVXNlIGZyb21IZXggaW5zdGVhZCwgb3IgY2FsbCBhc3NlcnRWYWxpZGl0eSgpIGxhdGVyLgogICAgICBzdGF0aWMgZnJvbUFmZmluZShwKSB7CiAgICAgICAgY29uc3QgeyB4LCB5IH0gPSBwIHx8IHt9OwogICAgICAgIGlmICghcCB8fCAhRnAyLmlzVmFsaWQoeCkgfHwgIUZwMi5pc1ZhbGlkKHkpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGFmZmluZSBwb2ludCIpOwogICAgICAgIGlmIChwIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJwcm9qZWN0aXZlIHBvaW50IG5vdCBhbGxvd2VkIik7CiAgICAgICAgY29uc3QgaXMwID0gKGkpID0+IEZwMi5lcWwoaSwgRnAyLlpFUk8pOwogICAgICAgIGlmIChpczAoeCkgJiYgaXMwKHkpKQogICAgICAgICAgcmV0dXJuIFBvaW50Mi5aRVJPOwogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHgsIHksIEZwMi5PTkUpOwogICAgICB9CiAgICAgIGdldCB4KCkgewogICAgICAgIHJldHVybiB0aGlzLnRvQWZmaW5lKCkueDsKICAgICAgfQogICAgICBnZXQgeSgpIHsKICAgICAgICByZXR1cm4gdGhpcy50b0FmZmluZSgpLnk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIFRha2VzIGEgYnVuY2ggb2YgUHJvamVjdGl2ZSBQb2ludHMgYnV0IGV4ZWN1dGVzIG9ubHkgb25lCiAgICAgICAqIGludmVyc2lvbiBvbiBhbGwgb2YgdGhlbS4gSW52ZXJzaW9uIGlzIHZlcnkgc2xvdyBvcGVyYXRpb24sCiAgICAgICAqIHNvIHRoaXMgaW1wcm92ZXMgcGVyZm9ybWFuY2UgbWFzc2l2ZWx5LgogICAgICAgKiBPcHRpbWl6YXRpb246IGNvbnZlcnRzIGEgbGlzdCBvZiBwcm9qZWN0aXZlIHBvaW50cyB0byBhIGxpc3Qgb2YgaWRlbnRpY2FsIHBvaW50cyB3aXRoIFo9MS4KICAgICAgICovCiAgICAgIHN0YXRpYyBub3JtYWxpemVaKHBvaW50cykgewogICAgICAgIGNvbnN0IHRvSW52ID0gRnAyLmludmVydEJhdGNoKHBvaW50cy5tYXAoKHApID0+IHAucHopKTsKICAgICAgICByZXR1cm4gcG9pbnRzLm1hcCgocCwgaSkgPT4gcC50b0FmZmluZSh0b0ludltpXSkpLm1hcChQb2ludDIuZnJvbUFmZmluZSk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIENvbnZlcnRzIGhhc2ggc3RyaW5nIG9yIFVpbnQ4QXJyYXkgdG8gUG9pbnQuCiAgICAgICAqIEBwYXJhbSBoZXggc2hvcnQvbG9uZyBFQ0RTQSBoZXgKICAgICAgICovCiAgICAgIHN0YXRpYyBmcm9tSGV4KGhleCkgewogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShmcm9tQnl0ZXMyKGVuc3VyZUJ5dGVzKCJwb2ludEhleCIsIGhleCkpKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0KICAgICAgLy8gTXVsdGlwbGllcyBnZW5lcmF0b3IgcG9pbnQgYnkgcHJpdmF0ZUtleS4KICAgICAgc3RhdGljIGZyb21Qcml2YXRlS2V5KHByaXZhdGVLZXkpIHsKICAgICAgICByZXR1cm4gUG9pbnQyLkJBU0UubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlS2V5KSk7CiAgICAgIH0KICAgICAgLy8gTXVsdGlzY2FsYXIgTXVsdGlwbGljYXRpb24KICAgICAgc3RhdGljIG1zbShwb2ludHMsIHNjYWxhcnMpIHsKICAgICAgICByZXR1cm4gcGlwcGVuZ2VyKFBvaW50MiwgRm4sIHBvaW50cywgc2NhbGFycyk7CiAgICAgIH0KICAgICAgLy8gIlByaXZhdGUgbWV0aG9kIiwgZG9uJ3QgdXNlIGl0IGRpcmVjdGx5CiAgICAgIF9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpIHsKICAgICAgICB3bmFmLnNldFdpbmRvd1NpemUodGhpcywgd2luZG93U2l6ZSk7CiAgICAgIH0KICAgICAgLy8gQSBwb2ludCBvbiBjdXJ2ZSBpcyB2YWxpZCBpZiBpdCBjb25mb3JtcyB0byBlcXVhdGlvbi4KICAgICAgYXNzZXJ0VmFsaWRpdHkoKSB7CiAgICAgICAgYXNzZXJ0VmFsaWRNZW1vKHRoaXMpOwogICAgICB9CiAgICAgIGhhc0V2ZW5ZKCkgewogICAgICAgIGNvbnN0IHsgeSB9ID0gdGhpcy50b0FmZmluZSgpOwogICAgICAgIGlmIChGcDIuaXNPZGQpCiAgICAgICAgICByZXR1cm4gIUZwMi5pc09kZCh5KTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZpZWxkIGRvZXNuJ3Qgc3VwcG9ydCBpc09kZCIpOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb21wYXJlIG9uZSBwb2ludCB0byBhbm90aGVyLgogICAgICAgKi8KICAgICAgZXF1YWxzKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGNvbnN0IFUxID0gRnAyLmVxbChGcDIubXVsKFgxLCBaMiksIEZwMi5tdWwoWDIsIFoxKSk7CiAgICAgICAgY29uc3QgVTIgPSBGcDIuZXFsKEZwMi5tdWwoWTEsIFoyKSwgRnAyLm11bChZMiwgWjEpKTsKICAgICAgICByZXR1cm4gVTEgJiYgVTI7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIEZsaXBzIHBvaW50IHRvIG9uZSBjb3JyZXNwb25kaW5nIHRvICh4LCAteSkgaW4gQWZmaW5lIGNvb3JkaW5hdGVzLgogICAgICAgKi8KICAgICAgbmVnYXRlKCkgewogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHRoaXMucHgsIEZwMi5uZWcodGhpcy5weSksIHRoaXMucHopOwogICAgICB9CiAgICAgIC8vIFJlbmVzLUNvc3RlbGxvLUJhdGluYSBleGNlcHRpb24tZnJlZSBkb3VibGluZyBmb3JtdWxhLgogICAgICAvLyBUaGVyZSBpcyAzMCUgZmFzdGVyIEphY29iaWFuIGZvcm11bGEsIGJ1dCBpdCBpcyBub3QgY29tcGxldGUuCiAgICAgIC8vIGh0dHBzOi8vZXByaW50LmlhY3Iub3JnLzIwMTUvMTA2MCwgYWxnb3JpdGhtIDMKICAgICAgLy8gQ29zdDogOE0gKyAzUyArIDMqYSArIDIqYjMgKyAxNWFkZC4KICAgICAgZG91YmxlKCkgewogICAgICAgIGNvbnN0IHsgYSwgYiB9ID0gQ1VSVkU7CiAgICAgICAgY29uc3QgYjMyID0gRnAyLm11bChiLCBfM24yKTsKICAgICAgICBjb25zdCB7IHB4OiBYMSwgcHk6IFkxLCBwejogWjEgfSA9IHRoaXM7CiAgICAgICAgbGV0IFgzID0gRnAyLlpFUk8sIFkzID0gRnAyLlpFUk8sIFozID0gRnAyLlpFUk87CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDEpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkxKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMSk7CiAgICAgICAgbGV0IHQzID0gRnAyLm11bChYMSwgWTEpOwogICAgICAgIHQzID0gRnAyLmFkZCh0MywgdDMpOwogICAgICAgIFozID0gRnAyLm11bChYMSwgWjEpOwogICAgICAgIFozID0gRnAyLmFkZChaMywgWjMpOwogICAgICAgIFgzID0gRnAyLm11bChhLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKGIzMiwgdDIpOwogICAgICAgIFkzID0gRnAyLmFkZChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLnN1Yih0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLmFkZCh0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLm11bChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLm11bCh0MywgWDMpOwogICAgICAgIFozID0gRnAyLm11bChiMzIsIFozKTsKICAgICAgICB0MiA9IEZwMi5tdWwoYSwgdDIpOwogICAgICAgIHQzID0gRnAyLnN1Yih0MCwgdDIpOwogICAgICAgIHQzID0gRnAyLm11bChhLCB0Myk7CiAgICAgICAgdDMgPSBGcDIuYWRkKHQzLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKFozLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQwLCB0Myk7CiAgICAgICAgWTMgPSBGcDIuYWRkKFkzLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKFkxLCBaMSk7CiAgICAgICAgdDIgPSBGcDIuYWRkKHQyLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQyLCB0Myk7CiAgICAgICAgWDMgPSBGcDIuc3ViKFgzLCB0MCk7CiAgICAgICAgWjMgPSBGcDIubXVsKHQyLCB0MSk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgcmV0dXJuIG5ldyBQb2ludDIoWDMsIFkzLCBaMyk7CiAgICAgIH0KICAgICAgLy8gUmVuZXMtQ29zdGVsbG8tQmF0aW5hIGV4Y2VwdGlvbi1mcmVlIGFkZGl0aW9uIGZvcm11bGEuCiAgICAgIC8vIFRoZXJlIGlzIDMwJSBmYXN0ZXIgSmFjb2JpYW4gZm9ybXVsYSwgYnV0IGl0IGlzIG5vdCBjb21wbGV0ZS4KICAgICAgLy8gaHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAxNS8xMDYwLCBhbGdvcml0aG0gMQogICAgICAvLyBDb3N0OiAxMk0gKyAwUyArIDMqYSArIDMqYjMgKyAyM2FkZC4KICAgICAgYWRkKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGxldCBYMyA9IEZwMi5aRVJPLCBZMyA9IEZwMi5aRVJPLCBaMyA9IEZwMi5aRVJPOwogICAgICAgIGNvbnN0IGEgPSBDVVJWRS5hOwogICAgICAgIGNvbnN0IGIzMiA9IEZwMi5tdWwoQ1VSVkUuYiwgXzNuMik7CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDIpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkyKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMik7CiAgICAgICAgbGV0IHQzID0gRnAyLmFkZChYMSwgWTEpOwogICAgICAgIGxldCB0NCA9IEZwMi5hZGQoWDIsIFkyKTsKICAgICAgICB0MyA9IEZwMi5tdWwodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQodDAsIHQxKTsKICAgICAgICB0MyA9IEZwMi5zdWIodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQoWDEsIFoxKTsKICAgICAgICBsZXQgdDUgPSBGcDIuYWRkKFgyLCBaMik7CiAgICAgICAgdDQgPSBGcDIubXVsKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDQgPSBGcDIuc3ViKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKFkxLCBaMSk7CiAgICAgICAgWDMgPSBGcDIuYWRkKFkyLCBaMik7CiAgICAgICAgdDUgPSBGcDIubXVsKHQ1LCBYMyk7CiAgICAgICAgWDMgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDUgPSBGcDIuc3ViKHQ1LCBYMyk7CiAgICAgICAgWjMgPSBGcDIubXVsKGEsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwoYjMyLCB0Mik7CiAgICAgICAgWjMgPSBGcDIuYWRkKFgzLCBaMyk7CiAgICAgICAgWDMgPSBGcDIuc3ViKHQxLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQxLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKFgzLCBaMyk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5tdWwoYjMyLCB0NCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDIgPSBGcDIuc3ViKHQwLCB0Mik7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5hZGQodDQsIHQyKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDEsIHQ0KTsKICAgICAgICBZMyA9IEZwMi5hZGQoWTMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDUsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwodDMsIFgzKTsKICAgICAgICBYMyA9IEZwMi5zdWIoWDMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDMsIHQxKTsKICAgICAgICBaMyA9IEZwMi5tdWwodDUsIFozKTsKICAgICAgICBaMyA9IEZwMi5hZGQoWjMsIHQwKTsKICAgICAgICByZXR1cm4gbmV3IFBvaW50MihYMywgWTMsIFozKTsKICAgICAgfQogICAgICBzdWJ0cmFjdChvdGhlcikgewogICAgICAgIHJldHVybiB0aGlzLmFkZChvdGhlci5uZWdhdGUoKSk7CiAgICAgIH0KICAgICAgaXMwKCkgewogICAgICAgIHJldHVybiB0aGlzLmVxdWFscyhQb2ludDIuWkVSTyk7CiAgICAgIH0KICAgICAgd05BRihuKSB7CiAgICAgICAgcmV0dXJuIHduYWYud05BRkNhY2hlZCh0aGlzLCBuLCBQb2ludDIubm9ybWFsaXplWik7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIE5vbi1jb25zdGFudC10aW1lIG11bHRpcGxpY2F0aW9uLiBVc2VzIGRvdWJsZS1hbmQtYWRkIGFsZ29yaXRobS4KICAgICAgICogSXQncyBmYXN0ZXIsIGJ1dCBzaG91bGQgb25seSBiZSB1c2VkIHdoZW4geW91IGRvbid0IGNhcmUgYWJvdXQKICAgICAgICogYW4gZXhwb3NlZCBwcml2YXRlIGtleSBlLmcuIHNpZyB2ZXJpZmljYXRpb24sIHdoaWNoIHdvcmtzIG92ZXIgKnB1YmxpYyoga2V5cy4KICAgICAgICovCiAgICAgIG11bHRpcGx5VW5zYWZlKHNjKSB7CiAgICAgICAgYUluUmFuZ2UoInNjYWxhciIsIHNjLCBfMG41LCBDVVJWRS5uKTsKICAgICAgICBjb25zdCBJID0gUG9pbnQyLlpFUk87CiAgICAgICAgaWYgKHNjID09PSBfMG41KQogICAgICAgICAgcmV0dXJuIEk7CiAgICAgICAgaWYgKHNjID09PSBfMW41KQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgY29uc3QgeyBlbmRvIH0gPSBDVVJWRTsKICAgICAgICBpZiAoIWVuZG8pCiAgICAgICAgICByZXR1cm4gd25hZi51bnNhZmVMYWRkZXIodGhpcywgc2MpOwogICAgICAgIGxldCB7IGsxbmVnLCBrMSwgazJuZWcsIGsyIH0gPSBlbmRvLnNwbGl0U2NhbGFyKHNjKTsKICAgICAgICBsZXQgazFwID0gSTsKICAgICAgICBsZXQgazJwID0gSTsKICAgICAgICBsZXQgZCA9IHRoaXM7CiAgICAgICAgd2hpbGUgKGsxID4gXzBuNSB8fCBrMiA+IF8wbjUpIHsKICAgICAgICAgIGlmIChrMSAmIF8xbjUpCiAgICAgICAgICAgIGsxcCA9IGsxcC5hZGQoZCk7CiAgICAgICAgICBpZiAoazIgJiBfMW41KQogICAgICAgICAgICBrMnAgPSBrMnAuYWRkKGQpOwogICAgICAgICAgZCA9IGQuZG91YmxlKCk7CiAgICAgICAgICBrMSA+Pj0gXzFuNTsKICAgICAgICAgIGsyID4+PSBfMW41OwogICAgICAgIH0KICAgICAgICBpZiAoazFuZWcpCiAgICAgICAgICBrMXAgPSBrMXAubmVnYXRlKCk7CiAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgazJwID0gazJwLm5lZ2F0ZSgpOwogICAgICAgIGsycCA9IG5ldyBQb2ludDIoRnAyLm11bChrMnAucHgsIGVuZG8uYmV0YSksIGsycC5weSwgazJwLnB6KTsKICAgICAgICByZXR1cm4gazFwLmFkZChrMnApOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb25zdGFudCB0aW1lIG11bHRpcGxpY2F0aW9uLgogICAgICAgKiBVc2VzIHdOQUYgbWV0aG9kLiBXaW5kb3dlZCBtZXRob2QgbWF5IGJlIDEwJSBmYXN0ZXIsCiAgICAgICAqIGJ1dCB0YWtlcyAyeCBsb25nZXIgdG8gZ2VuZXJhdGUgYW5kIGNvbnN1bWVzIDJ4IG1lbW9yeS4KICAgICAgICogVXNlcyBwcmVjb21wdXRlcyB3aGVuIGF2YWlsYWJsZS4KICAgICAgICogVXNlcyBlbmRvbW9ycGhpc20gZm9yIEtvYmxpdHogY3VydmVzLgogICAgICAgKiBAcGFyYW0gc2NhbGFyIGJ5IHdoaWNoIHRoZSBwb2ludCB3b3VsZCBiZSBtdWx0aXBsaWVkCiAgICAgICAqIEByZXR1cm5zIE5ldyBwb2ludAogICAgICAgKi8KICAgICAgbXVsdGlwbHkoc2NhbGFyKSB7CiAgICAgICAgY29uc3QgeyBlbmRvLCBuOiBOIH0gPSBDVVJWRTsKICAgICAgICBhSW5SYW5nZSgic2NhbGFyIiwgc2NhbGFyLCBfMW41LCBOKTsKICAgICAgICBsZXQgcG9pbnQsIGZha2U7CiAgICAgICAgaWYgKGVuZG8pIHsKICAgICAgICAgIGNvbnN0IHsgazFuZWcsIGsxLCBrMm5lZywgazIgfSA9IGVuZG8uc3BsaXRTY2FsYXIoc2NhbGFyKTsKICAgICAgICAgIGxldCB7IHA6IGsxcCwgZjogZjFwIH0gPSB0aGlzLndOQUYoazEpOwogICAgICAgICAgbGV0IHsgcDogazJwLCBmOiBmMnAgfSA9IHRoaXMud05BRihrMik7CiAgICAgICAgICBrMXAgPSB3bmFmLmNvbnN0VGltZU5lZ2F0ZShrMW5lZywgazFwKTsKICAgICAgICAgIGsycCA9IHduYWYuY29uc3RUaW1lTmVnYXRlKGsybmVnLCBrMnApOwogICAgICAgICAgazJwID0gbmV3IFBvaW50MihGcDIubXVsKGsycC5weCwgZW5kby5iZXRhKSwgazJwLnB5LCBrMnAucHopOwogICAgICAgICAgcG9pbnQgPSBrMXAuYWRkKGsycCk7CiAgICAgICAgICBmYWtlID0gZjFwLmFkZChmMnApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCB7IHAsIGY6IGYyIH0gPSB0aGlzLndOQUYoc2NhbGFyKTsKICAgICAgICAgIHBvaW50ID0gcDsKICAgICAgICAgIGZha2UgPSBmMjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFBvaW50Mi5ub3JtYWxpemVaKFtwb2ludCwgZmFrZV0pWzBdOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBFZmZpY2llbnRseSBjYWxjdWxhdGUgYGFQICsgYlFgLiBVbnNhZmUsIGNhbiBleHBvc2UgcHJpdmF0ZSBrZXksIGlmIHVzZWQgaW5jb3JyZWN0bHkuCiAgICAgICAqIE5vdCB1c2luZyBTdHJhdXNzLVNoYW1pciB0cmljazogcHJlY29tcHV0YXRpb24gdGFibGVzIGFyZSBmYXN0ZXIuCiAgICAgICAqIFRoZSB0cmljayBjb3VsZCBiZSB1c2VmdWwgaWYgYm90aCBQIGFuZCBRIGFyZSBub3QgRyAobm90IGluIG91ciBjYXNlKS4KICAgICAgICogQHJldHVybnMgbm9uLXplcm8gYWZmaW5lIHBvaW50CiAgICAgICAqLwogICAgICBtdWx0aXBseUFuZEFkZFVuc2FmZShRLCBhLCBiKSB7CiAgICAgICAgY29uc3QgRyA9IFBvaW50Mi5CQVNFOwogICAgICAgIGNvbnN0IG11bCA9IChQLCBhMikgPT4gYTIgPT09IF8wbjUgfHwgYTIgPT09IF8xbjUgfHwgIVAuZXF1YWxzKEcpID8gUC5tdWx0aXBseVVuc2FmZShhMikgOiBQLm11bHRpcGx5KGEyKTsKICAgICAgICBjb25zdCBzdW0gPSBtdWwodGhpcywgYSkuYWRkKG11bChRLCBiKSk7CiAgICAgICAgcmV0dXJuIHN1bS5pczAoKSA/IHZvaWQgMCA6IHN1bTsKICAgICAgfQogICAgICAvLyBDb252ZXJ0cyBQcm9qZWN0aXZlIHBvaW50IHRvIGFmZmluZSAoeCwgeSkgY29vcmRpbmF0ZXMuCiAgICAgIC8vIENhbiBhY2NlcHQgcHJlY29tcHV0ZWQgWl4tMSAtIGZvciBleGFtcGxlLCBmcm9tIGludmVydEJhdGNoLgogICAgICAvLyAoeCwgeSwgeikg4oiLICh4PXgveiwgeT15L3opCiAgICAgIHRvQWZmaW5lKGl6KSB7CiAgICAgICAgcmV0dXJuIHRvQWZmaW5lTWVtbyh0aGlzLCBpeik7CiAgICAgIH0KICAgICAgaXNUb3JzaW9uRnJlZSgpIHsKICAgICAgICBjb25zdCB7IGg6IGNvZmFjdG9yLCBpc1RvcnNpb25GcmVlIH0gPSBDVVJWRTsKICAgICAgICBpZiAoY29mYWN0b3IgPT09IF8xbjUpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoaXNUb3JzaW9uRnJlZSkKICAgICAgICAgIHJldHVybiBpc1RvcnNpb25GcmVlKFBvaW50MiwgdGhpcyk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpc1RvcnNpb25GcmVlKCkgaGFzIG5vdCBiZWVuIGRlY2xhcmVkIGZvciB0aGUgZWxsaXB0aWMgY3VydmUiKTsKICAgICAgfQogICAgICBjbGVhckNvZmFjdG9yKCkgewogICAgICAgIGNvbnN0IHsgaDogY29mYWN0b3IsIGNsZWFyQ29mYWN0b3IgfSA9IENVUlZFOwogICAgICAgIGlmIChjb2ZhY3RvciA9PT0gXzFuNSkKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIGlmIChjbGVhckNvZmFjdG9yKQogICAgICAgICAgcmV0dXJuIGNsZWFyQ29mYWN0b3IoUG9pbnQyLCB0aGlzKTsKICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVVuc2FmZShDVVJWRS5oKTsKICAgICAgfQogICAgICB0b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICB0aGlzLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMzKFBvaW50MiwgdGhpcywgaXNDb21wcmVzc2VkKTsKICAgICAgfQogICAgICB0b0hleChpc0NvbXByZXNzZWQgPSB0cnVlKSB7CiAgICAgICAgYWJvb2woImlzQ29tcHJlc3NlZCIsIGlzQ29tcHJlc3NlZCk7CiAgICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgyKHRoaXMudG9SYXdCeXRlcyhpc0NvbXByZXNzZWQpKTsKICAgICAgfQogICAgfQogICAgUG9pbnQyLkJBU0UgPSBuZXcgUG9pbnQyKENVUlZFLkd4LCBDVVJWRS5HeSwgRnAyLk9ORSk7CiAgICBQb2ludDIuWkVSTyA9IG5ldyBQb2ludDIoRnAyLlpFUk8sIEZwMi5PTkUsIEZwMi5aRVJPKTsKICAgIGNvbnN0IF9iaXRzID0gQ1VSVkUubkJpdExlbmd0aDsKICAgIGNvbnN0IHduYWYgPSB3TkFGKFBvaW50MiwgQ1VSVkUuZW5kbyA/IE1hdGguY2VpbChfYml0cyAvIDIpIDogX2JpdHMpOwogICAgcmV0dXJuIHsKICAgICAgQ1VSVkUsCiAgICAgIFByb2plY3RpdmVQb2ludDogUG9pbnQyLAogICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyLAogICAgICB3ZWllcnN0cmFzc0VxdWF0aW9uLAogICAgICBpc1dpdGhpbkN1cnZlT3JkZXIKICAgIH07CiAgfQogIGZ1bmN0aW9uIHZhbGlkYXRlT3B0cyhjdXJ2ZSkgewogICAgY29uc3Qgb3B0cyA9IHZhbGlkYXRlQmFzaWMoY3VydmUpOwogICAgdmFsaWRhdGVPYmplY3Qob3B0cywgewogICAgICBoYXNoOiAiaGFzaCIsCiAgICAgIGhtYWM6ICJmdW5jdGlvbiIsCiAgICAgIHJhbmRvbUJ5dGVzOiAiZnVuY3Rpb24iCiAgICB9LCB7CiAgICAgIGJpdHMyaW50OiAiZnVuY3Rpb24iLAogICAgICBiaXRzMmludF9tb2ROOiAiZnVuY3Rpb24iLAogICAgICBsb3dTOiAiYm9vbGVhbiIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoeyBsb3dTOiB0cnVlLCAuLi5vcHRzIH0pOwogIH0KICBmdW5jdGlvbiB3ZWllcnN0cmFzcyhjdXJ2ZURlZikgewogICAgY29uc3QgQ1VSVkUgPSB2YWxpZGF0ZU9wdHMoY3VydmVEZWYpOwogICAgY29uc3QgeyBGcDogRnAyLCBuOiBDVVJWRV9PUkRFUiB9ID0gQ1VSVkU7CiAgICBjb25zdCBjb21wcmVzc2VkTGVuID0gRnAyLkJZVEVTICsgMTsKICAgIGNvbnN0IHVuY29tcHJlc3NlZExlbiA9IDIgKiBGcDIuQllURVMgKyAxOwogICAgZnVuY3Rpb24gbW9kTjIoYSkgewogICAgICByZXR1cm4gbW9kKGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGZ1bmN0aW9uIGludk4oYSkgewogICAgICByZXR1cm4gaW52ZXJ0KGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGNvbnN0IHsgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsIHdlaWVyc3RyYXNzRXF1YXRpb24sIGlzV2l0aGluQ3VydmVPcmRlciB9ID0gd2VpZXJzdHJhc3NQb2ludHMoewogICAgICAuLi5DVVJWRSwKICAgICAgdG9CeXRlcyhfYywgcG9pbnQsIGlzQ29tcHJlc3NlZCkgewogICAgICAgIGNvbnN0IGEgPSBwb2ludC50b0FmZmluZSgpOwogICAgICAgIGNvbnN0IHggPSBGcDIudG9CeXRlcyhhLngpOwogICAgICAgIGNvbnN0IGNhdCA9IGNvbmNhdEJ5dGVzMzsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICBpZiAoaXNDb21wcmVzc2VkKSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbcG9pbnQuaGFzRXZlblkoKSA/IDIgOiAzXSksIHgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbNF0pLCB4LCBGcDIudG9CeXRlcyhhLnkpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyb21CeXRlcyhieXRlczIpIHsKICAgICAgICBjb25zdCBsZW4gPSBieXRlczIubGVuZ3RoOwogICAgICAgIGNvbnN0IGhlYWQgPSBieXRlczJbMF07CiAgICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgICBpZiAobGVuID09PSBjb21wcmVzc2VkTGVuICYmIChoZWFkID09PSAyIHx8IGhlYWQgPT09IDMpKSB7CiAgICAgICAgICBjb25zdCB4ID0gYnl0ZXNUb051bWJlckJFKHRhaWwpOwogICAgICAgICAgaWYgKCFpblJhbmdlKHgsIF8xbjUsIEZwMi5PUkRFUikpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUG9pbnQgaXMgbm90IG9uIGN1cnZlIik7CiAgICAgICAgICBjb25zdCB5MiA9IHdlaWVyc3RyYXNzRXF1YXRpb24oeCk7CiAgICAgICAgICBsZXQgeTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHkgPSBGcDIuc3FydCh5Mik7CiAgICAgICAgICB9IGNhdGNoIChzcXJ0RXJyb3IpIHsKICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gc3FydEVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyAiOiAiICsgc3FydEVycm9yLm1lc3NhZ2UgOiAiIjsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb2ludCBpcyBub3Qgb24gY3VydmUiICsgc3VmZml4KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGlzWU9kZCA9ICh5ICYgXzFuNSkgPT09IF8xbjU7CiAgICAgICAgICBjb25zdCBpc0hlYWRPZGQgPSAoaGVhZCAmIDEpID09PSAxOwogICAgICAgICAgaWYgKGlzSGVhZE9kZCAhPT0gaXNZT2RkKQogICAgICAgICAgICB5ID0gRnAyLm5lZyh5KTsKICAgICAgICAgIHJldHVybiB7IHgsIHkgfTsKICAgICAgICB9IGVsc2UgaWYgKGxlbiA9PT0gdW5jb21wcmVzc2VkTGVuICYmIGhlYWQgPT09IDQpIHsKICAgICAgICAgIGNvbnN0IHggPSBGcDIuZnJvbUJ5dGVzKHRhaWwuc3ViYXJyYXkoMCwgRnAyLkJZVEVTKSk7CiAgICAgICAgICBjb25zdCB5ID0gRnAyLmZyb21CeXRlcyh0YWlsLnN1YmFycmF5KEZwMi5CWVRFUywgMiAqIEZwMi5CWVRFUykpOwogICAgICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBvaW50IG9mIGxlbmd0aCAke2xlbn0gd2FzIGludmFsaWQuIEV4cGVjdGVkICR7Y29tcHJlc3NlZExlbn0gY29tcHJlc3NlZCBieXRlcyBvciAke3VuY29tcHJlc3NlZExlbn0gdW5jb21wcmVzc2VkIGJ5dGVzYCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IG51bVRvTkJ5dGVTdHIgPSAobnVtMikgPT4gYnl0ZXNUb0hleDIobnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKSk7CiAgICBmdW5jdGlvbiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIobnVtYmVyMikgewogICAgICBjb25zdCBIQUxGID0gQ1VSVkVfT1JERVIgPj4gXzFuNTsKICAgICAgcmV0dXJuIG51bWJlcjIgPiBIQUxGOwogICAgfQogICAgZnVuY3Rpb24gbm9ybWFsaXplUyhzKSB7CiAgICAgIHJldHVybiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIocykgPyBtb2ROMigtcykgOiBzOwogICAgfQogICAgY29uc3Qgc2xjTnVtID0gKGIsIGZyb20sIHRvKSA9PiBieXRlc1RvTnVtYmVyQkUoYi5zbGljZShmcm9tLCB0bykpOwogICAgY2xhc3MgU2lnbmF0dXJlIHsKICAgICAgY29uc3RydWN0b3IociwgcywgcmVjb3ZlcnkpIHsKICAgICAgICB0aGlzLnIgPSByOwogICAgICAgIHRoaXMucyA9IHM7CiAgICAgICAgdGhpcy5yZWNvdmVyeSA9IHJlY292ZXJ5OwogICAgICAgIHRoaXMuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgfQogICAgICAvLyBwYWlyIChieXRlcyBvZiByLCBieXRlcyBvZiBzKQogICAgICBzdGF0aWMgZnJvbUNvbXBhY3QoaGV4KSB7CiAgICAgICAgY29uc3QgbCA9IENVUlZFLm5CeXRlTGVuZ3RoOwogICAgICAgIGhleCA9IGVuc3VyZUJ5dGVzKCJjb21wYWN0U2lnbmF0dXJlIiwgaGV4LCBsICogMik7CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoc2xjTnVtKGhleCwgMCwgbCksIHNsY051bShoZXgsIGwsIDIgKiBsKSk7CiAgICAgIH0KICAgICAgLy8gREVSIGVuY29kZWQgRUNEU0Egc2lnbmF0dXJlCiAgICAgIC8vIGh0dHBzOi8vYml0Y29pbi5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvNTc2NDQvd2hhdC1hcmUtdGhlLXBhcnRzLW9mLWEtYml0Y29pbi10cmFuc2FjdGlvbi1pbnB1dC1zY3JpcHQKICAgICAgc3RhdGljIGZyb21ERVIoaGV4KSB7CiAgICAgICAgY29uc3QgeyByLCBzIH0gPSBERVIudG9TaWcoZW5zdXJlQnl0ZXMoIkRFUiIsIGhleCkpOwogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHIsIHMpOwogICAgICB9CiAgICAgIGFzc2VydFZhbGlkaXR5KCkgewogICAgICAgIGFJblJhbmdlKCJyIiwgdGhpcy5yLCBfMW41LCBDVVJWRV9PUkRFUik7CiAgICAgICAgYUluUmFuZ2UoInMiLCB0aGlzLnMsIF8xbjUsIENVUlZFX09SREVSKTsKICAgICAgfQogICAgICBhZGRSZWNvdmVyeUJpdChyZWNvdmVyeSkgewogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHRoaXMuciwgdGhpcy5zLCByZWNvdmVyeSk7CiAgICAgIH0KICAgICAgcmVjb3ZlclB1YmxpY0tleShtc2dIYXNoKSB7CiAgICAgICAgY29uc3QgeyByLCBzLCByZWNvdmVyeTogcmVjIH0gPSB0aGlzOwogICAgICAgIGNvbnN0IGggPSBiaXRzMmludF9tb2ROKGVuc3VyZUJ5dGVzKCJtc2dIYXNoIiwgbXNnSGFzaCkpOwogICAgICAgIGlmIChyZWMgPT0gbnVsbCB8fCAhWzAsIDEsIDIsIDNdLmluY2x1ZGVzKHJlYykpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIGludmFsaWQiKTsKICAgICAgICBjb25zdCByYWRqID0gcmVjID09PSAyIHx8IHJlYyA9PT0gMyA/IHIgKyBDVVJWRS5uIDogcjsKICAgICAgICBpZiAocmFkaiA+PSBGcDIuT1JERVIpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIDIgb3IgMyBpbnZhbGlkIik7CiAgICAgICAgY29uc3QgcHJlZml4ID0gKHJlYyAmIDEpID09PSAwID8gIjAyIiA6ICIwMyI7CiAgICAgICAgY29uc3QgUiA9IFBvaW50Mi5mcm9tSGV4KHByZWZpeCArIG51bVRvTkJ5dGVTdHIocmFkaikpOwogICAgICAgIGNvbnN0IGlyID0gaW52TihyYWRqKTsKICAgICAgICBjb25zdCB1MSA9IG1vZE4yKC1oICogaXIpOwogICAgICAgIGNvbnN0IHUyID0gbW9kTjIocyAqIGlyKTsKICAgICAgICBjb25zdCBRID0gUG9pbnQyLkJBU0UubXVsdGlwbHlBbmRBZGRVbnNhZmUoUiwgdTEsIHUyKTsKICAgICAgICBpZiAoIVEpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInBvaW50IGF0IGluZmluaWZ5Iik7CiAgICAgICAgUS5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBROwogICAgICB9CiAgICAgIC8vIFNpZ25hdHVyZXMgc2hvdWxkIGJlIGxvdy1zLCB0byBwcmV2ZW50IG1hbGxlYWJpbGl0eS4KICAgICAgaGFzSGlnaFMoKSB7CiAgICAgICAgcmV0dXJuIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcih0aGlzLnMpOwogICAgICB9CiAgICAgIG5vcm1hbGl6ZVMoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaGFzSGlnaFMoKSA/IG5ldyBTaWduYXR1cmUodGhpcy5yLCBtb2ROMigtdGhpcy5zKSwgdGhpcy5yZWNvdmVyeSkgOiB0aGlzOwogICAgICB9CiAgICAgIC8vIERFUi1lbmNvZGVkCiAgICAgIHRvREVSUmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9ERVJIZXgoKSk7CiAgICAgIH0KICAgICAgdG9ERVJIZXgoKSB7CiAgICAgICAgcmV0dXJuIERFUi5oZXhGcm9tU2lnKHsgcjogdGhpcy5yLCBzOiB0aGlzLnMgfSk7CiAgICAgIH0KICAgICAgLy8gcGFkZGVkIGJ5dGVzIG9mIHIsIHRoZW4gcGFkZGVkIGJ5dGVzIG9mIHMKICAgICAgdG9Db21wYWN0UmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9Db21wYWN0SGV4KCkpOwogICAgICB9CiAgICAgIHRvQ29tcGFjdEhleCgpIHsKICAgICAgICByZXR1cm4gbnVtVG9OQnl0ZVN0cih0aGlzLnIpICsgbnVtVG9OQnl0ZVN0cih0aGlzLnMpOwogICAgICB9CiAgICB9CiAgICBjb25zdCB1dGlscyA9IHsKICAgICAgaXNWYWxpZFByaXZhdGVLZXkocHJpdmF0ZUtleSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsCiAgICAgIC8qKgogICAgICAgKiBQcm9kdWNlcyBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgcHJpdmF0ZSBrZXkgZnJvbSByYW5kb20gb2Ygc2l6ZQogICAgICAgKiAoZ3JvdXBMZW4gKyBjZWlsKGdyb3VwTGVuIC8gMikpIHdpdGggbW9kdWxvIGJpYXMgYmVpbmcgbmVnbGlnaWJsZS4KICAgICAgICovCiAgICAgIHJhbmRvbVByaXZhdGVLZXk6ICgpID0+IHsKICAgICAgICBjb25zdCBsZW5ndGggPSBnZXRNaW5IYXNoTGVuZ3RoKENVUlZFLm4pOwogICAgICAgIHJldHVybiBtYXBIYXNoVG9GaWVsZChDVVJWRS5yYW5kb21CeXRlcyhsZW5ndGgpLCBDVVJWRS5uKTsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIENyZWF0ZXMgcHJlY29tcHV0ZSB0YWJsZSBmb3IgYW4gYXJiaXRyYXJ5IEVDIHBvaW50LiBNYWtlcyBwb2ludCAiY2FjaGVkIi4KICAgICAgICogQWxsb3dzIHRvIG1hc3NpdmVseSBzcGVlZC11cCBgcG9pbnQubXVsdGlwbHkoc2NhbGFyKWAuCiAgICAgICAqIEByZXR1cm5zIGNhY2hlZCBwb2ludAogICAgICAgKiBAZXhhbXBsZQogICAgICAgKiBjb25zdCBmYXN0ID0gdXRpbHMucHJlY29tcHV0ZSg4LCBQcm9qZWN0aXZlUG9pbnQuZnJvbUhleChzb21lb25lc1B1YktleSkpOwogICAgICAgKiBmYXN0Lm11bHRpcGx5KHByaXZLZXkpOyAvLyBtdWNoIGZhc3RlciBFQ0RIIG5vdwogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZSh3aW5kb3dTaXplID0gOCwgcG9pbnQgPSBQb2ludDIuQkFTRSkgewogICAgICAgIHBvaW50Ll9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpOwogICAgICAgIHBvaW50Lm11bHRpcGx5KEJpZ0ludCgzKSk7CiAgICAgICAgcmV0dXJuIHBvaW50OwogICAgICB9CiAgICB9OwogICAgZnVuY3Rpb24gZ2V0UHVibGljS2V5KHByaXZhdGVLZXksIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgcmV0dXJuIFBvaW50Mi5mcm9tUHJpdmF0ZUtleShwcml2YXRlS2V5KS50b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCk7CiAgICB9CiAgICBmdW5jdGlvbiBpc1Byb2JQdWIoaXRlbSkgewogICAgICBjb25zdCBhcnIgPSBpc0J5dGVzMihpdGVtKTsKICAgICAgY29uc3Qgc3RyID0gdHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciOwogICAgICBjb25zdCBsZW4gPSAoYXJyIHx8IHN0cikgJiYgaXRlbS5sZW5ndGg7CiAgICAgIGlmIChhcnIpCiAgICAgICAgcmV0dXJuIGxlbiA9PT0gY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IHVuY29tcHJlc3NlZExlbjsKICAgICAgaWYgKHN0cikKICAgICAgICByZXR1cm4gbGVuID09PSAyICogY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IDIgKiB1bmNvbXByZXNzZWRMZW47CiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRTaGFyZWRTZWNyZXQocHJpdmF0ZUEsIHB1YmxpY0IsIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgaWYgKGlzUHJvYlB1Yihwcml2YXRlQSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaXJzdCBhcmcgbXVzdCBiZSBwcml2YXRlIGtleSIpOwogICAgICBpZiAoIWlzUHJvYlB1YihwdWJsaWNCKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNlY29uZCBhcmcgbXVzdCBiZSBwdWJsaWMga2V5Iik7CiAgICAgIGNvbnN0IGIgPSBQb2ludDIuZnJvbUhleChwdWJsaWNCKTsKICAgICAgcmV0dXJuIGIubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlQSkpLnRvUmF3Qnl0ZXMoaXNDb21wcmVzc2VkKTsKICAgIH0KICAgIGNvbnN0IGJpdHMyaW50ID0gQ1VSVkUuYml0czJpbnQgfHwgZnVuY3Rpb24oYnl0ZXMyKSB7CiAgICAgIGNvbnN0IG51bTIgPSBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgY29uc3QgZGVsdGEgPSBieXRlczIubGVuZ3RoICogOCAtIENVUlZFLm5CaXRMZW5ndGg7CiAgICAgIHJldHVybiBkZWx0YSA+IDAgPyBudW0yID4+IEJpZ0ludChkZWx0YSkgOiBudW0yOwogICAgfTsKICAgIGNvbnN0IGJpdHMyaW50X21vZE4gPSBDVVJWRS5iaXRzMmludF9tb2ROIHx8IGZ1bmN0aW9uKGJ5dGVzMikgewogICAgICByZXR1cm4gbW9kTjIoYml0czJpbnQoYnl0ZXMyKSk7CiAgICB9OwogICAgY29uc3QgT1JERVJfTUFTSyA9IGJpdE1hc2soQ1VSVkUubkJpdExlbmd0aCk7CiAgICBmdW5jdGlvbiBpbnQyb2N0ZXRzKG51bTIpIHsKICAgICAgYUluUmFuZ2UoYG51bSA8IDJeJHtDVVJWRS5uQml0TGVuZ3RofWAsIG51bTIsIF8wbjUsIE9SREVSX01BU0spOwogICAgICByZXR1cm4gbnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKTsKICAgIH0KICAgIGZ1bmN0aW9uIHByZXBTaWcobXNnSGFzaCwgcHJpdmF0ZUtleSwgb3B0cyA9IGRlZmF1bHRTaWdPcHRzKSB7CiAgICAgIGlmIChbInJlY292ZXJlZCIsICJjYW5vbmljYWwiXS5zb21lKChrKSA9PiBrIGluIG9wdHMpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbigpIGxlZ2FjeSBvcHRpb25zIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgY29uc3QgeyBoYXNoOiBoYXNoMywgcmFuZG9tQnl0ZXM6IHJhbmRvbUJ5dGVzMiB9ID0gQ1VSVkU7CiAgICAgIGxldCB7IGxvd1MsIHByZWhhc2gsIGV4dHJhRW50cm9weTogZW50IH0gPSBvcHRzOwogICAgICBpZiAobG93UyA9PSBudWxsKQogICAgICAgIGxvd1MgPSB0cnVlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgdmFsaWRhdGVTaWdWZXJPcHRzKG9wdHMpOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoInByZWhhc2hlZCBtc2dIYXNoIiwgaGFzaDMobXNnSGFzaCkpOwogICAgICBjb25zdCBoMWludCA9IGJpdHMyaW50X21vZE4obXNnSGFzaCk7CiAgICAgIGNvbnN0IGQgPSBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICBjb25zdCBzZWVkQXJncyA9IFtpbnQyb2N0ZXRzKGQpLCBpbnQyb2N0ZXRzKGgxaW50KV07CiAgICAgIGlmIChlbnQgIT0gbnVsbCAmJiBlbnQgIT09IGZhbHNlKSB7CiAgICAgICAgY29uc3QgZSA9IGVudCA9PT0gdHJ1ZSA/IHJhbmRvbUJ5dGVzMihGcDIuQllURVMpIDogZW50OwogICAgICAgIHNlZWRBcmdzLnB1c2goZW5zdXJlQnl0ZXMoImV4dHJhRW50cm9weSIsIGUpKTsKICAgICAgfQogICAgICBjb25zdCBzZWVkID0gY29uY2F0Qnl0ZXMzKC4uLnNlZWRBcmdzKTsKICAgICAgY29uc3QgbSA9IGgxaW50OwogICAgICBmdW5jdGlvbiBrMnNpZyhrQnl0ZXMpIHsKICAgICAgICBjb25zdCBrID0gYml0czJpbnQoa0J5dGVzKTsKICAgICAgICBpZiAoIWlzV2l0aGluQ3VydmVPcmRlcihrKSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCBpayA9IGludk4oayk7CiAgICAgICAgY29uc3QgcSA9IFBvaW50Mi5CQVNFLm11bHRpcGx5KGspLnRvQWZmaW5lKCk7CiAgICAgICAgY29uc3QgciA9IG1vZE4yKHEueCk7CiAgICAgICAgaWYgKHIgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgY29uc3QgcyA9IG1vZE4yKGlrICogbW9kTjIobSArIHIgKiBkKSk7CiAgICAgICAgaWYgKHMgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgbGV0IHJlY292ZXJ5ID0gKHEueCA9PT0gciA/IDAgOiAyKSB8IE51bWJlcihxLnkgJiBfMW41KTsKICAgICAgICBsZXQgbm9ybVMgPSBzOwogICAgICAgIGlmIChsb3dTICYmIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcihzKSkgewogICAgICAgICAgbm9ybVMgPSBub3JtYWxpemVTKHMpOwogICAgICAgICAgcmVjb3ZlcnkgXj0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUociwgbm9ybVMsIHJlY292ZXJ5KTsKICAgICAgfQogICAgICByZXR1cm4geyBzZWVkLCBrMnNpZyB9OwogICAgfQogICAgY29uc3QgZGVmYXVsdFNpZ09wdHMgPSB7IGxvd1M6IENVUlZFLmxvd1MsIHByZWhhc2g6IGZhbHNlIH07CiAgICBjb25zdCBkZWZhdWx0VmVyT3B0cyA9IHsgbG93UzogQ1VSVkUubG93UywgcHJlaGFzaDogZmFsc2UgfTsKICAgIGZ1bmN0aW9uIHNpZ24yKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMgPSBkZWZhdWx0U2lnT3B0cykgewogICAgICBjb25zdCB7IHNlZWQsIGsyc2lnIH0gPSBwcmVwU2lnKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMpOwogICAgICBjb25zdCBDID0gQ1VSVkU7CiAgICAgIGNvbnN0IGRyYmcgPSBjcmVhdGVIbWFjRHJiZyhDLmhhc2gub3V0cHV0TGVuLCBDLm5CeXRlTGVuZ3RoLCBDLmhtYWMpOwogICAgICByZXR1cm4gZHJiZyhzZWVkLCBrMnNpZyk7CiAgICB9CiAgICBQb2ludDIuQkFTRS5fc2V0V2luZG93U2l6ZSg4KTsKICAgIGZ1bmN0aW9uIHZlcmlmeShzaWduYXR1cmUsIG1zZ0hhc2gsIHB1YmxpY0tleSwgb3B0cyA9IGRlZmF1bHRWZXJPcHRzKSB7CiAgICAgIGNvbnN0IHNnID0gc2lnbmF0dXJlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgcHVibGljS2V5ID0gZW5zdXJlQnl0ZXMoInB1YmxpY0tleSIsIHB1YmxpY0tleSk7CiAgICAgIGlmICgic3RyaWN0IiBpbiBvcHRzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigib3B0aW9ucy5zdHJpY3Qgd2FzIHJlbmFtZWQgdG8gbG93UyIpOwogICAgICB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cyk7CiAgICAgIGNvbnN0IHsgbG93UywgcHJlaGFzaCB9ID0gb3B0czsKICAgICAgbGV0IF9zaWcgPSB2b2lkIDA7CiAgICAgIGxldCBQOwogICAgICB0cnkgewogICAgICAgIGlmICh0eXBlb2Ygc2cgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHNnKSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3NpZyA9IFNpZ25hdHVyZS5mcm9tREVSKHNnKTsKICAgICAgICAgIH0gY2F0Y2ggKGRlckVycm9yKSB7CiAgICAgICAgICAgIGlmICghKGRlckVycm9yIGluc3RhbmNlb2YgREVSLkVycikpCiAgICAgICAgICAgICAgdGhyb3cgZGVyRXJyb3I7CiAgICAgICAgICAgIF9zaWcgPSBTaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2cpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNnID09PSAib2JqZWN0IiAmJiB0eXBlb2Ygc2cuciA9PT0gImJpZ2ludCIgJiYgdHlwZW9mIHNnLnMgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgICBjb25zdCB7IHI6IHIyLCBzOiBzMiB9ID0gc2c7CiAgICAgICAgICBfc2lnID0gbmV3IFNpZ25hdHVyZShyMiwgczIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlBBUlNFIik7CiAgICAgICAgfQogICAgICAgIFAgPSBQb2ludDIuZnJvbUhleChwdWJsaWNLZXkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlmIChlcnJvci5tZXNzYWdlID09PSAiUEFSU0UiKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaWduYXR1cmUgbXVzdCBiZSBTaWduYXR1cmUgaW5zdGFuY2UsIFVpbnQ4QXJyYXkgb3IgaGV4IHN0cmluZ2ApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAobG93UyAmJiBfc2lnLmhhc0hpZ2hTKCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gQ1VSVkUuaGFzaChtc2dIYXNoKTsKICAgICAgY29uc3QgeyByLCBzIH0gPSBfc2lnOwogICAgICBjb25zdCBoID0gYml0czJpbnRfbW9kTihtc2dIYXNoKTsKICAgICAgY29uc3QgaXMgPSBpbnZOKHMpOwogICAgICBjb25zdCB1MSA9IG1vZE4yKGggKiBpcyk7CiAgICAgIGNvbnN0IHUyID0gbW9kTjIociAqIGlzKTsKICAgICAgY29uc3QgUiA9IFBvaW50Mi5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFAsIHUxLCB1Mik/LnRvQWZmaW5lKCk7CiAgICAgIGlmICghUikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGNvbnN0IHYgPSBtb2ROMihSLngpOwogICAgICByZXR1cm4gdiA9PT0gcjsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIENVUlZFLAogICAgICBnZXRQdWJsaWNLZXksCiAgICAgIGdldFNoYXJlZFNlY3JldCwKICAgICAgc2lnbjogc2lnbjIsCiAgICAgIHZlcmlmeSwKICAgICAgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsCiAgICAgIFNpZ25hdHVyZSwKICAgICAgdXRpbHMKICAgIH07CiAgfQogIGZ1bmN0aW9uIFNXVUZwU3FydFJhdGlvKEZwMiwgWikgewogICAgY29uc3QgcSA9IEZwMi5PUkRFUjsKICAgIGxldCBsID0gXzBuNTsKICAgIGZvciAobGV0IG8gPSBxIC0gXzFuNTsgbyAlIF8ybjQgPT09IF8wbjU7IG8gLz0gXzJuNCkKICAgICAgbCArPSBfMW41OwogICAgY29uc3QgYzEgPSBsOwogICAgY29uc3QgXzJuX3Bvd19jMV8xID0gXzJuNCA8PCBjMSAtIF8xbjUgLSBfMW41OwogICAgY29uc3QgXzJuX3Bvd19jMSA9IF8ybl9wb3dfYzFfMSAqIF8ybjQ7CiAgICBjb25zdCBjMiA9IChxIC0gXzFuNSkgLyBfMm5fcG93X2MxOwogICAgY29uc3QgYzMgPSAoYzIgLSBfMW41KSAvIF8ybjQ7CiAgICBjb25zdCBjNCA9IF8ybl9wb3dfYzEgLSBfMW41OwogICAgY29uc3QgYzUgPSBfMm5fcG93X2MxXzE7CiAgICBjb25zdCBjNiA9IEZwMi5wb3coWiwgYzIpOwogICAgY29uc3QgYzcgPSBGcDIucG93KFosIChjMiArIF8xbjUpIC8gXzJuNCk7CiAgICBsZXQgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgbGV0IHR2MSA9IGM2OwogICAgICBsZXQgdHYyID0gRnAyLnBvdyh2LCBjNCk7CiAgICAgIGxldCB0djMgPSBGcDIuc3FyKHR2Mik7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCB2KTsKICAgICAgbGV0IHR2NSA9IEZwMi5tdWwodSwgdHYzKTsKICAgICAgdHY1ID0gRnAyLnBvdyh0djUsIGMzKTsKICAgICAgdHY1ID0gRnAyLm11bCh0djUsIHR2Mik7CiAgICAgIHR2MiA9IEZwMi5tdWwodHY1LCB2KTsKICAgICAgdHYzID0gRnAyLm11bCh0djUsIHUpOwogICAgICBsZXQgdHY0ID0gRnAyLm11bCh0djMsIHR2Mik7CiAgICAgIHR2NSA9IEZwMi5wb3codHY0LCBjNSk7CiAgICAgIGxldCBpc1FSID0gRnAyLmVxbCh0djUsIEZwMi5PTkUpOwogICAgICB0djIgPSBGcDIubXVsKHR2MywgYzcpOwogICAgICB0djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgdHYzID0gRnAyLmNtb3YodHYyLCB0djMsIGlzUVIpOwogICAgICB0djQgPSBGcDIuY21vdih0djUsIHR2NCwgaXNRUik7CiAgICAgIGZvciAobGV0IGkgPSBjMTsgaSA+IF8xbjU7IGktLSkgewogICAgICAgIGxldCB0djUyID0gaSAtIF8ybjQ7CiAgICAgICAgdHY1MiA9IF8ybjQgPDwgdHY1MiAtIF8xbjU7CiAgICAgICAgbGV0IHR2djUgPSBGcDIucG93KHR2NCwgdHY1Mik7CiAgICAgICAgY29uc3QgZTEgPSBGcDIuZXFsKHR2djUsIEZwMi5PTkUpOwogICAgICAgIHR2MiA9IEZwMi5tdWwodHYzLCB0djEpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djEpOwogICAgICAgIHR2djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgICB0djMgPSBGcDIuY21vdih0djIsIHR2MywgZTEpOwogICAgICAgIHR2NCA9IEZwMi5jbW92KHR2djUsIHR2NCwgZTEpOwogICAgICB9CiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGlzUVIsIHZhbHVlOiB0djMgfTsKICAgIH07CiAgICBpZiAoRnAyLk9SREVSICUgXzRuMiA9PT0gXzNuMikgewogICAgICBjb25zdCBjMTIgPSAoRnAyLk9SREVSIC0gXzNuMikgLyBfNG4yOwogICAgICBjb25zdCBjMjIgPSBGcDIuc3FydChGcDIubmVnKFopKTsKICAgICAgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgICBsZXQgdHYxID0gRnAyLnNxcih2KTsKICAgICAgICBjb25zdCB0djIgPSBGcDIubXVsKHUsIHYpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djIpOwogICAgICAgIGxldCB5MSA9IEZwMi5wb3codHYxLCBjMTIpOwogICAgICAgIHkxID0gRnAyLm11bCh5MSwgdHYyKTsKICAgICAgICBjb25zdCB5MiA9IEZwMi5tdWwoeTEsIGMyMik7CiAgICAgICAgY29uc3QgdHYzID0gRnAyLm11bChGcDIuc3FyKHkxKSwgdik7CiAgICAgICAgY29uc3QgaXNRUiA9IEZwMi5lcWwodHYzLCB1KTsKICAgICAgICBsZXQgeSA9IEZwMi5jbW92KHkyLCB5MSwgaXNRUik7CiAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogaXNRUiwgdmFsdWU6IHkgfTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBzcXJ0UmF0aW87CiAgfQogIGZ1bmN0aW9uIG1hcFRvQ3VydmVTaW1wbGVTV1UoRnAyLCBvcHRzKSB7CiAgICB2YWxpZGF0ZUZpZWxkKEZwMik7CiAgICBpZiAoIUZwMi5pc1ZhbGlkKG9wdHMuQSkgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuQikgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuWikpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZVNpbXBsZVNXVTogaW52YWxpZCBvcHRzIik7CiAgICBjb25zdCBzcXJ0UmF0aW8gPSBTV1VGcFNxcnRSYXRpbyhGcDIsIG9wdHMuWik7CiAgICBpZiAoIUZwMi5pc09kZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGcC5pc09kZCBpcyBub3QgaW1wbGVtZW50ZWQhIik7CiAgICByZXR1cm4gKHUpID0+IHsKICAgICAgbGV0IHR2MSwgdHYyLCB0djMsIHR2NCwgdHY1LCB0djYsIHgsIHk7CiAgICAgIHR2MSA9IEZwMi5zcXIodSk7CiAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCBvcHRzLlopOwogICAgICB0djIgPSBGcDIuc3FyKHR2MSk7CiAgICAgIHR2MiA9IEZwMi5hZGQodHYyLCB0djEpOwogICAgICB0djMgPSBGcDIuYWRkKHR2MiwgRnAyLk9ORSk7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCBvcHRzLkIpOwogICAgICB0djQgPSBGcDIuY21vdihvcHRzLlosIEZwMi5uZWcodHYyKSwgIUZwMi5lcWwodHYyLCBGcDIuWkVSTykpOwogICAgICB0djQgPSBGcDIubXVsKHR2NCwgb3B0cy5BKTsKICAgICAgdHYyID0gRnAyLnNxcih0djMpOwogICAgICB0djYgPSBGcDIuc3FyKHR2NCk7CiAgICAgIHR2NSA9IEZwMi5tdWwodHY2LCBvcHRzLkEpOwogICAgICB0djIgPSBGcDIuYWRkKHR2MiwgdHY1KTsKICAgICAgdHYyID0gRnAyLm11bCh0djIsIHR2Myk7CiAgICAgIHR2NiA9IEZwMi5tdWwodHY2LCB0djQpOwogICAgICB0djUgPSBGcDIubXVsKHR2Niwgb3B0cy5CKTsKICAgICAgdHYyID0gRnAyLmFkZCh0djIsIHR2NSk7CiAgICAgIHggPSBGcDIubXVsKHR2MSwgdHYzKTsKICAgICAgY29uc3QgeyBpc1ZhbGlkLCB2YWx1ZSB9ID0gc3FydFJhdGlvKHR2MiwgdHY2KTsKICAgICAgeSA9IEZwMi5tdWwodHYxLCB1KTsKICAgICAgeSA9IEZwMi5tdWwoeSwgdmFsdWUpOwogICAgICB4ID0gRnAyLmNtb3YoeCwgdHYzLCBpc1ZhbGlkKTsKICAgICAgeSA9IEZwMi5jbW92KHksIHZhbHVlLCBpc1ZhbGlkKTsKICAgICAgY29uc3QgZTEgPSBGcDIuaXNPZGQodSkgPT09IEZwMi5pc09kZCh5KTsKICAgICAgeSA9IEZwMi5jbW92KEZwMi5uZWcoeSksIHksIGUxKTsKICAgICAgeCA9IEZwMi5kaXYoeCwgdHY0KTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgdmFyIGIybiwgaDJiLCBERVIsIF8wbjUsIF8xbjUsIF8ybjQsIF8zbjIsIF80bjI7CiAgdmFyIGluaXRfd2VpZXJzdHJhc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzIigpIHsKICAgICAgaW5pdF9jdXJ2ZSgpOwogICAgICBpbml0X21vZHVsYXIoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgKHsgYnl0ZXNUb051bWJlckJFOiBiMm4sIGhleFRvQnl0ZXM6IGgyYiB9ID0gdXRpbHNfZXhwb3J0cyk7CiAgICAgIERFUiA9IHsKICAgICAgICAvLyBhc24uMSBERVIgZW5jb2RpbmcgdXRpbHMKICAgICAgICBFcnI6IGNsYXNzIERFUkVyciBleHRlbmRzIEVycm9yIHsKICAgICAgICAgIGNvbnN0cnVjdG9yKG0gPSAiIikgewogICAgICAgICAgICBzdXBlcihtKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIEJhc2ljIGJ1aWxkaW5nIGJsb2NrIGlzIFRMViAoVGFnLUxlbmd0aC1WYWx1ZSkKICAgICAgICBfdGx2OiB7CiAgICAgICAgICBlbmNvZGU6ICh0YWcsIGRhdGEpID0+IHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgaWYgKHRhZyA8IDAgfHwgdGFnID4gMjU2KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZW5jb2RlOiB3cm9uZyB0YWciKTsKICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoICYgMSkKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogdW5wYWRkZWQgZGF0YSIpOwogICAgICAgICAgICBjb25zdCBkYXRhTGVuID0gZGF0YS5sZW5ndGggLyAyOwogICAgICAgICAgICBjb25zdCBsZW4gPSBudW1iZXJUb0hleFVucGFkZGVkKGRhdGFMZW4pOwogICAgICAgICAgICBpZiAobGVuLmxlbmd0aCAvIDIgJiAxMjgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5lbmNvZGU6IGxvbmcgZm9ybSBsZW5ndGggdG9vIGJpZyIpOwogICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBkYXRhTGVuID4gMTI3ID8gbnVtYmVyVG9IZXhVbnBhZGRlZChsZW4ubGVuZ3RoIC8gMiB8IDEyOCkgOiAiIjsKICAgICAgICAgICAgcmV0dXJuIGAke251bWJlclRvSGV4VW5wYWRkZWQodGFnKX0ke2xlbkxlbn0ke2xlbn0ke2RhdGF9YDsKICAgICAgICAgIH0sCiAgICAgICAgICAvLyB2IC0gdmFsdWUsIGwgLSBsZWZ0IGJ5dGVzICh1bnBhcnNlZCkKICAgICAgICAgIGRlY29kZSh0YWcsIGRhdGEpIHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgbGV0IHBvcyA9IDA7CiAgICAgICAgICAgIGlmICh0YWcgPCAwIHx8IHRhZyA+IDI1NikKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogd3JvbmcgdGFnIik7CiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA8IDIgfHwgZGF0YVtwb3MrK10gIT09IHRhZykKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZTogd3JvbmcgdGx2Iik7CiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gZGF0YVtwb3MrK107CiAgICAgICAgICAgIGNvbnN0IGlzTG9uZyA9ICEhKGZpcnN0ICYgMTI4KTsKICAgICAgICAgICAgbGV0IGxlbmd0aCA9IDA7CiAgICAgICAgICAgIGlmICghaXNMb25nKQogICAgICAgICAgICAgIGxlbmd0aCA9IGZpcnN0OwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBmaXJzdCAmIDEyNzsKICAgICAgICAgICAgICBpZiAoIWxlbkxlbikKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBpbmRlZmluaXRlIGxlbmd0aCBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICAgICAgaWYgKGxlbkxlbiA+IDQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogYnl0ZSBsZW5ndGggaXMgdG9vIGJpZyIpOwogICAgICAgICAgICAgIGNvbnN0IGxlbmd0aEJ5dGVzID0gZGF0YS5zdWJhcnJheShwb3MsIHBvcyArIGxlbkxlbik7CiAgICAgICAgICAgICAgaWYgKGxlbmd0aEJ5dGVzLmxlbmd0aCAhPT0gbGVuTGVuKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IGxlbmd0aCBieXRlcyBub3QgY29tcGxldGUiKTsKICAgICAgICAgICAgICBpZiAobGVuZ3RoQnl0ZXNbMF0gPT09IDApCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogemVybyBsZWZ0bW9zdCBieXRlIik7CiAgICAgICAgICAgICAgZm9yIChjb25zdCBiIG9mIGxlbmd0aEJ5dGVzKQogICAgICAgICAgICAgICAgbGVuZ3RoID0gbGVuZ3RoIDw8IDggfCBiOwogICAgICAgICAgICAgIHBvcyArPSBsZW5MZW47CiAgICAgICAgICAgICAgaWYgKGxlbmd0aCA8IDEyOCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBub3QgbWluaW1hbCBlbmNvZGluZyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHYgPSBkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgbGVuZ3RoKTsKICAgICAgICAgICAgaWYgKHYubGVuZ3RoICE9PSBsZW5ndGgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IHdyb25nIHZhbHVlIGxlbmd0aCIpOwogICAgICAgICAgICByZXR1cm4geyB2LCBsOiBkYXRhLnN1YmFycmF5KHBvcyArIGxlbmd0aCkgfTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIGh0dHBzOi8vY3J5cHRvLnN0YWNrZXhjaGFuZ2UuY29tL2EvNTc3MzQgTGVmdG1vc3QgYml0IG9mIGZpcnN0IGJ5dGUgaXMgJ25lZ2F0aXZlJyBmbGFnLAogICAgICAgIC8vIHNpbmNlIHdlIGFsd2F5cyB1c2UgcG9zaXRpdmUgaW50ZWdlcnMgaGVyZS4gSXQgbXVzdCBhbHdheXMgYmUgZW1wdHk6CiAgICAgICAgLy8gLSBhZGQgemVybyBieXRlIGlmIGV4aXN0cwogICAgICAgIC8vIC0gaWYgbmV4dCBieXRlIGRvZXNuJ3QgaGF2ZSBhIGZsYWcsIGxlYWRpbmcgemVybyBpcyBub3QgYWxsb3dlZCAobWluaW1hbCBlbmNvZGluZykKICAgICAgICBfaW50OiB7CiAgICAgICAgICBlbmNvZGUobnVtMikgewogICAgICAgICAgICBjb25zdCB7IEVycjogRSB9ID0gREVSOwogICAgICAgICAgICBpZiAobnVtMiA8IF8wbjUpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoImludGVnZXI6IG5lZ2F0aXZlIGludGVnZXJzIGFyZSBub3QgYWxsb3dlZCIpOwogICAgICAgICAgICBsZXQgaGV4ID0gbnVtYmVyVG9IZXhVbnBhZGRlZChudW0yKTsKICAgICAgICAgICAgaWYgKE51bWJlci5wYXJzZUludChoZXhbMF0sIDE2KSAmIDgpCiAgICAgICAgICAgICAgaGV4ID0gIjAwIiArIGhleDsKICAgICAgICAgICAgaWYgKGhleC5sZW5ndGggJiAxKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ1bmV4cGVjdGVkIGFzc2VydGlvbiIpOwogICAgICAgICAgICByZXR1cm4gaGV4OwogICAgICAgICAgfSwKICAgICAgICAgIGRlY29kZShkYXRhKSB7CiAgICAgICAgICAgIGNvbnN0IHsgRXJyOiBFIH0gPSBERVI7CiAgICAgICAgICAgIGlmIChkYXRhWzBdICYgMTI4KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiBuZWdhdGl2ZSIpOwogICAgICAgICAgICBpZiAoZGF0YVswXSA9PT0gMCAmJiAhKGRhdGFbMV0gJiAxMjgpKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiB1bm5lY2Vzc2FyeSBsZWFkaW5nIHplcm8iKTsKICAgICAgICAgICAgcmV0dXJuIGIybihkYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvU2lnKGhleCkgewogICAgICAgICAgY29uc3QgeyBFcnI6IEUsIF9pbnQ6IGludCwgX3RsdjogdGx2IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBkYXRhID0gdHlwZW9mIGhleCA9PT0gInN0cmluZyIgPyBoMmIoaGV4KSA6IGhleDsKICAgICAgICAgIGFieXRlcyhkYXRhKTsKICAgICAgICAgIGNvbnN0IHsgdjogc2VxQnl0ZXMsIGw6IHNlcUxlZnRCeXRlcyB9ID0gdGx2LmRlY29kZSg0OCwgZGF0YSk7CiAgICAgICAgICBpZiAoc2VxTGVmdEJ5dGVzLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEUoIkludmFsaWQgc2lnbmF0dXJlOiBsZWZ0IGJ5dGVzIGFmdGVyIHBhcnNpbmciKTsKICAgICAgICAgIGNvbnN0IHsgdjogckJ5dGVzLCBsOiByTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHNlcUJ5dGVzKTsKICAgICAgICAgIGNvbnN0IHsgdjogc0J5dGVzLCBsOiBzTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHJMZWZ0Qnl0ZXMpOwogICAgICAgICAgaWYgKHNMZWZ0Qnl0ZXMubGVuZ3RoKQogICAgICAgICAgICB0aHJvdyBuZXcgRSgiSW52YWxpZCBzaWduYXR1cmU6IGxlZnQgYnl0ZXMgYWZ0ZXIgcGFyc2luZyIpOwogICAgICAgICAgcmV0dXJuIHsgcjogaW50LmRlY29kZShyQnl0ZXMpLCBzOiBpbnQuZGVjb2RlKHNCeXRlcykgfTsKICAgICAgICB9LAogICAgICAgIGhleEZyb21TaWcoc2lnKSB7CiAgICAgICAgICBjb25zdCB7IF90bHY6IHRsdiwgX2ludDogaW50IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBzZXEgPSBgJHt0bHYuZW5jb2RlKDIsIGludC5lbmNvZGUoc2lnLnIpKX0ke3Rsdi5lbmNvZGUoMiwgaW50LmVuY29kZShzaWcucykpfWA7CiAgICAgICAgICByZXR1cm4gdGx2LmVuY29kZSg0OCwgc2VxKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIF8wbjUgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjUgPSBCaWdJbnQoMSk7CiAgICAgIF8ybjQgPSBCaWdJbnQoMik7CiAgICAgIF8zbjIgPSBCaWdJbnQoMyk7CiAgICAgIF80bjIgPSBCaWdJbnQoNCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9fc2hvcnR3X3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0SGFzaChoYXNoMykgewogICAgcmV0dXJuIHsKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIGhtYWM6IChrZXksIC4uLm1zZ3MpID0+IGhtYWMoaGFzaDMsIGtleSwgY29uY2F0Qnl0ZXMoLi4ubXNncykpLAogICAgICByYW5kb21CeXRlcwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlQ3VydmUoY3VydmVEZWYsIGRlZkhhc2gpIHsKICAgIGNvbnN0IGNyZWF0ZSA9IChoYXNoMykgPT4gd2VpZXJzdHJhc3MoeyAuLi5jdXJ2ZURlZiwgLi4uZ2V0SGFzaChoYXNoMykgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLmNyZWF0ZShkZWZIYXNoKSwgY3JlYXRlIH0pOwogIH0KICB2YXIgaW5pdF9zaG9ydHdfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanMiKCkgewogICAgICBpbml0X2htYWMoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF93ZWllcnN0cmFzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcwogIGZ1bmN0aW9uIGkyb3NwKHZhbHVlLCBsZW5ndGgpIHsKICAgIGFudW0odmFsdWUpOwogICAgYW51bShsZW5ndGgpOwogICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+PSAxIDw8IDggKiBsZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBiYWQgSTJPU1AgY2FsbDogdmFsdWU9JHt2YWx1ZX0gbGVuZ3RoPSR7bGVuZ3RofWApOwogICAgfQogICAgY29uc3QgcmVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aCB9KS5maWxsKDApOwogICAgZm9yIChsZXQgaSA9IGxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgIHJlc1tpXSA9IHZhbHVlICYgMjU1OwogICAgICB2YWx1ZSA+Pj49IDg7CiAgICB9CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkocmVzKTsKICB9CiAgZnVuY3Rpb24gc3RyeG9yKGEsIGIpIHsKICAgIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KGEubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBhW2ldIF4gYltpXTsKICAgIH0KICAgIHJldHVybiBhcnI7CiAgfQogIGZ1bmN0aW9uIGFudW0oaXRlbSkgewogICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJudW1iZXIgZXhwZWN0ZWQiKTsKICB9CiAgZnVuY3Rpb24gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5JbkJ5dGVzLCBIKSB7CiAgICBhYnl0ZXMobXNnKTsKICAgIGFieXRlcyhEU1QpOwogICAgYW51bShsZW5JbkJ5dGVzKTsKICAgIGlmIChEU1QubGVuZ3RoID4gMjU1KQogICAgICBEU1QgPSBIKGNvbmNhdEJ5dGVzMyh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIiksIERTVCkpOwogICAgY29uc3QgeyBvdXRwdXRMZW46IGJfaW5fYnl0ZXMsIGJsb2NrTGVuOiByX2luX2J5dGVzIH0gPSBIOwogICAgY29uc3QgZWxsID0gTWF0aC5jZWlsKGxlbkluQnl0ZXMgLyBiX2luX2J5dGVzKTsKICAgIGlmIChsZW5JbkJ5dGVzID4gNjU1MzUgfHwgZWxsID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3htZDogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICBjb25zdCBEU1RfcHJpbWUgPSBjb25jYXRCeXRlczMoRFNULCBpMm9zcChEU1QubGVuZ3RoLCAxKSk7CiAgICBjb25zdCBaX3BhZCA9IGkyb3NwKDAsIHJfaW5fYnl0ZXMpOwogICAgY29uc3QgbF9pX2Jfc3RyID0gaTJvc3AobGVuSW5CeXRlcywgMik7CiAgICBjb25zdCBiID0gbmV3IEFycmF5KGVsbCk7CiAgICBjb25zdCBiXzAgPSBIKGNvbmNhdEJ5dGVzMyhaX3BhZCwgbXNnLCBsX2lfYl9zdHIsIGkyb3NwKDAsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGJbMF0gPSBIKGNvbmNhdEJ5dGVzMyhiXzAsIGkyb3NwKDEsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGVsbDsgaSsrKSB7CiAgICAgIGNvbnN0IGFyZ3MgPSBbc3RyeG9yKGJfMCwgYltpIC0gMV0pLCBpMm9zcChpICsgMSwgMSksIERTVF9wcmltZV07CiAgICAgIGJbaV0gPSBIKGNvbmNhdEJ5dGVzMyguLi5hcmdzKSk7CiAgICB9CiAgICBjb25zdCBwc2V1ZG9fcmFuZG9tX2J5dGVzID0gY29uY2F0Qnl0ZXMzKC4uLmIpOwogICAgcmV0dXJuIHBzZXVkb19yYW5kb21fYnl0ZXMuc2xpY2UoMCwgbGVuSW5CeXRlcyk7CiAgfQogIGZ1bmN0aW9uIGV4cGFuZF9tZXNzYWdlX3hvZihtc2csIERTVCwgbGVuSW5CeXRlcywgaywgSCkgewogICAgYWJ5dGVzKG1zZyk7CiAgICBhYnl0ZXMoRFNUKTsKICAgIGFudW0obGVuSW5CeXRlcyk7CiAgICBpZiAoRFNULmxlbmd0aCA+IDI1NSkgewogICAgICBjb25zdCBka0xlbiA9IE1hdGguY2VpbCgyICogayAvIDgpOwogICAgICBEU1QgPSBILmNyZWF0ZSh7IGRrTGVuIH0pLnVwZGF0ZSh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIikpLnVwZGF0ZShEU1QpLmRpZ2VzdCgpOwogICAgfQogICAgaWYgKGxlbkluQnl0ZXMgPiA2NTUzNSB8fCBEU1QubGVuZ3RoID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3hvZjogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICByZXR1cm4gSC5jcmVhdGUoeyBka0xlbjogbGVuSW5CeXRlcyB9KS51cGRhdGUobXNnKS51cGRhdGUoaTJvc3AobGVuSW5CeXRlcywgMikpLnVwZGF0ZShEU1QpLnVwZGF0ZShpMm9zcChEU1QubGVuZ3RoLCAxKSkuZGlnZXN0KCk7CiAgfQogIGZ1bmN0aW9uIGhhc2hfdG9fZmllbGQobXNnLCBjb3VudCwgb3B0aW9ucykgewogICAgdmFsaWRhdGVPYmplY3Qob3B0aW9ucywgewogICAgICBEU1Q6ICJzdHJpbmdPclVpbnQ4QXJyYXkiLAogICAgICBwOiAiYmlnaW50IiwKICAgICAgbTogImlzU2FmZUludGVnZXIiLAogICAgICBrOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIGhhc2g6ICJoYXNoIgogICAgfSk7CiAgICBjb25zdCB7IHAsIGssIG0sIGhhc2g6IGhhc2gzLCBleHBhbmQsIERTVDogX0RTVCB9ID0gb3B0aW9uczsKICAgIGFieXRlcyhtc2cpOwogICAgYW51bShjb3VudCk7CiAgICBjb25zdCBEU1QgPSB0eXBlb2YgX0RTVCA9PT0gInN0cmluZyIgPyB1dGY4VG9CeXRlczIoX0RTVCkgOiBfRFNUOwogICAgY29uc3QgbG9nMnAgPSBwLnRvU3RyaW5nKDIpLmxlbmd0aDsKICAgIGNvbnN0IEwgPSBNYXRoLmNlaWwoKGxvZzJwICsgaykgLyA4KTsKICAgIGNvbnN0IGxlbl9pbl9ieXRlcyA9IGNvdW50ICogbSAqIEw7CiAgICBsZXQgcHJiOwogICAgaWYgKGV4cGFuZCA9PT0gInhtZCIpIHsKICAgICAgcHJiID0gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5faW5fYnl0ZXMsIGhhc2gzKTsKICAgIH0gZWxzZSBpZiAoZXhwYW5kID09PSAieG9mIikgewogICAgICBwcmIgPSBleHBhbmRfbWVzc2FnZV94b2YobXNnLCBEU1QsIGxlbl9pbl9ieXRlcywgaywgaGFzaDMpOwogICAgfSBlbHNlIGlmIChleHBhbmQgPT09ICJfaW50ZXJuYWxfcGFzcyIpIHsKICAgICAgcHJiID0gbXNnOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdleHBhbmQgbXVzdCBiZSAieG1kIiBvciAieG9mIicpOwogICAgfQogICAgY29uc3QgdSA9IG5ldyBBcnJheShjb3VudCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZSA9IG5ldyBBcnJheShtKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBtOyBqKyspIHsKICAgICAgICBjb25zdCBlbG1fb2Zmc2V0ID0gTCAqIChqICsgaSAqIG0pOwogICAgICAgIGNvbnN0IHR2ID0gcHJiLnN1YmFycmF5KGVsbV9vZmZzZXQsIGVsbV9vZmZzZXQgKyBMKTsKICAgICAgICBlW2pdID0gbW9kKG9zMmlwKHR2KSwgcCk7CiAgICAgIH0KICAgICAgdVtpXSA9IGU7CiAgICB9CiAgICByZXR1cm4gdTsKICB9CiAgZnVuY3Rpb24gaXNvZ2VueU1hcChmaWVsZCwgbWFwKSB7CiAgICBjb25zdCBDT0VGRiA9IG1hcC5tYXAoKGkpID0+IEFycmF5LmZyb20oaSkucmV2ZXJzZSgpKTsKICAgIHJldHVybiAoeCwgeSkgPT4gewogICAgICBjb25zdCBbeE51bSwgeERlbiwgeU51bSwgeURlbl0gPSBDT0VGRi5tYXAoKHZhbCkgPT4gdmFsLnJlZHVjZSgoYWNjLCBpKSA9PiBmaWVsZC5hZGQoZmllbGQubXVsKGFjYywgeCksIGkpKSk7CiAgICAgIHggPSBmaWVsZC5kaXYoeE51bSwgeERlbik7CiAgICAgIHkgPSBmaWVsZC5tdWwoeSwgZmllbGQuZGl2KHlOdW0sIHlEZW4pKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlSGFzaGVyKFBvaW50MiwgbWFwVG9DdXJ2ZSwgZGVmKSB7CiAgICBpZiAodHlwZW9mIG1hcFRvQ3VydmUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZSgpIG11c3QgYmUgZGVmaW5lZCIpOwogICAgcmV0dXJuIHsKICAgICAgLy8gRW5jb2RlcyBieXRlIHN0cmluZyB0byBlbGxpcHRpYyBjdXJ2ZS4KICAgICAgLy8gaGFzaF90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBoYXNoVG9DdXJ2ZShtc2csIG9wdGlvbnMpIHsKICAgICAgICBjb25zdCB1ID0gaGFzaF90b19maWVsZChtc2csIDIsIHsgLi4uZGVmLCBEU1Q6IGRlZi5EU1QsIC4uLm9wdGlvbnMgfSk7CiAgICAgICAgY29uc3QgdTAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHVbMF0pKTsKICAgICAgICBjb25zdCB1MSA9IFBvaW50Mi5mcm9tQWZmaW5lKG1hcFRvQ3VydmUodVsxXSkpOwogICAgICAgIGNvbnN0IFAgPSB1MC5hZGQodTEpLmNsZWFyQ29mYWN0b3IoKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0sCiAgICAgIC8vIEVuY29kZXMgYnl0ZSBzdHJpbmcgdG8gZWxsaXB0aWMgY3VydmUuCiAgICAgIC8vIGVuY29kZV90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBlbmNvZGVUb0N1cnZlKG1zZywgb3B0aW9ucykgewogICAgICAgIGNvbnN0IHUgPSBoYXNoX3RvX2ZpZWxkKG1zZywgMSwgeyAuLi5kZWYsIERTVDogZGVmLmVuY29kZURTVCwgLi4ub3B0aW9ucyB9KTsKICAgICAgICBjb25zdCBQID0gUG9pbnQyLmZyb21BZmZpbmUobWFwVG9DdXJ2ZSh1WzBdKSkuY2xlYXJDb2ZhY3RvcigpOwogICAgICAgIFAuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgICByZXR1cm4gUDsKICAgICAgfSwKICAgICAgLy8gU2FtZSBhcyBlbmNvZGVUb0N1cnZlLCBidXQgd2l0aG91dCBoYXNoCiAgICAgIG1hcFRvQ3VydmUoc2NhbGFycykgewogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzY2FsYXJzKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZTogZXhwZWN0ZWQgYXJyYXkgb2YgYmlnaW50cyIpOwogICAgICAgIGZvciAoY29uc3QgaSBvZiBzY2FsYXJzKQogICAgICAgICAgaWYgKHR5cGVvZiBpICE9PSAiYmlnaW50IikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBtYXBUb0N1cnZlOiBleHBlY3RlZCBhcnJheSBvZiBiaWdpbnRzLCBnb3QgJHtpfSBpbiBhcnJheWApOwogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHNjYWxhcnMpKS5jbGVhckNvZmFjdG9yKCk7CiAgICAgICAgUC5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBQOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgb3MyaXA7CiAgdmFyIGluaXRfaGFzaF90b19jdXJ2ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcyIoKSB7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBvczJpcCA9IGJ5dGVzVG9OdW1iZXJCRTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL3NlY3AyNTZrMS5qcwogIHZhciBzZWNwMjU2azFfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KHNlY3AyNTZrMV9leHBvcnRzLCB7CiAgICBlbmNvZGVUb0N1cnZlOiAoKSA9PiBlbmNvZGVUb0N1cnZlLAogICAgaGFzaFRvQ3VydmU6ICgpID0+IGhhc2hUb0N1cnZlLAogICAgc2Nobm9ycjogKCkgPT4gc2Nobm9yciwKICAgIHNlY3AyNTZrMTogKCkgPT4gc2VjcDI1NmsxCiAgfSk7CiAgZnVuY3Rpb24gc3FydE1vZCh5KSB7CiAgICBjb25zdCBQID0gc2VjcDI1NmsxUDsKICAgIGNvbnN0IF8zbjMgPSBCaWdJbnQoMyksIF82biA9IEJpZ0ludCg2KSwgXzExbiA9IEJpZ0ludCgxMSksIF8yMm4gPSBCaWdJbnQoMjIpOwogICAgY29uc3QgXzIzbiA9IEJpZ0ludCgyMyksIF80NG4gPSBCaWdJbnQoNDQpLCBfODhuID0gQmlnSW50KDg4KTsKICAgIGNvbnN0IGIyID0geSAqIHkgKiB5ICUgUDsKICAgIGNvbnN0IGIzMiA9IGIyICogYjIgKiB5ICUgUDsKICAgIGNvbnN0IGI2ID0gcG93MihiMzIsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IGI5ID0gcG93MihiNiwgXzNuMywgUCkgKiBiMzIgJSBQOwogICAgY29uc3QgYjExID0gcG93MihiOSwgXzJuNSwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCBiMjIgPSBwb3cyKGIxMSwgXzExbiwgUCkgKiBiMTEgJSBQOwogICAgY29uc3QgYjQ0ID0gcG93MihiMjIsIF8yMm4sIFApICogYjIyICUgUDsKICAgIGNvbnN0IGI4OCA9IHBvdzIoYjQ0LCBfNDRuLCBQKSAqIGI0NCAlIFA7CiAgICBjb25zdCBiMTc2ID0gcG93MihiODgsIF84OG4sIFApICogYjg4ICUgUDsKICAgIGNvbnN0IGIyMjAgPSBwb3cyKGIxNzYsIF80NG4sIFApICogYjQ0ICUgUDsKICAgIGNvbnN0IGIyMjMgPSBwb3cyKGIyMjAsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IHQxID0gcG93MihiMjIzLCBfMjNuLCBQKSAqIGIyMiAlIFA7CiAgICBjb25zdCB0MiA9IHBvdzIodDEsIF82biwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCByb290MiA9IHBvdzIodDIsIF8ybjUsIFApOwogICAgaWYgKCFGcC5lcWwoRnAuc3FyKHJvb3QyKSwgeSkpCiAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgIHJldHVybiByb290MjsKICB9CiAgZnVuY3Rpb24gdGFnZ2VkSGFzaCh0YWcsIC4uLm1lc3NhZ2VzKSB7CiAgICBsZXQgdGFnUCA9IFRBR0dFRF9IQVNIX1BSRUZJWEVTW3RhZ107CiAgICBpZiAodGFnUCA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IHRhZ0ggPSBzaGEyNTYoVWludDhBcnJheS5mcm9tKHRhZywgKGMpID0+IGMuY2hhckNvZGVBdCgwKSkpOwogICAgICB0YWdQID0gY29uY2F0Qnl0ZXMzKHRhZ0gsIHRhZ0gpOwogICAgICBUQUdHRURfSEFTSF9QUkVGSVhFU1t0YWddID0gdGFnUDsKICAgIH0KICAgIHJldHVybiBzaGEyNTYoY29uY2F0Qnl0ZXMzKHRhZ1AsIC4uLm1lc3NhZ2VzKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdikgewogICAgbGV0IGRfID0gc2VjcDI1NmsxLnV0aWxzLm5vcm1Qcml2YXRlS2V5VG9TY2FsYXIocHJpdik7CiAgICBsZXQgcCA9IFBvaW50LmZyb21Qcml2YXRlS2V5KGRfKTsKICAgIGNvbnN0IHNjYWxhciA9IHAuaGFzRXZlblkoKSA/IGRfIDogbW9kTigtZF8pOwogICAgcmV0dXJuIHsgc2NhbGFyLCBieXRlczogcG9pbnRUb0J5dGVzKHApIH07CiAgfQogIGZ1bmN0aW9uIGxpZnRfeCh4KSB7CiAgICBhSW5SYW5nZSgieCIsIHgsIF8xbjYsIHNlY3AyNTZrMVApOwogICAgY29uc3QgeHggPSBtb2RQKHggKiB4KTsKICAgIGNvbnN0IGMgPSBtb2RQKHh4ICogeCArIEJpZ0ludCg3KSk7CiAgICBsZXQgeSA9IHNxcnRNb2QoYyk7CiAgICBpZiAoeSAlIF8ybjUgIT09IF8wbjYpCiAgICAgIHkgPSBtb2RQKC15KTsKICAgIGNvbnN0IHAgPSBuZXcgUG9pbnQoeCwgeSwgXzFuNik7CiAgICBwLmFzc2VydFZhbGlkaXR5KCk7CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gY2hhbGxlbmdlKC4uLmFyZ3MpIHsKICAgIHJldHVybiBtb2ROKG51bSh0YWdnZWRIYXNoKCJCSVAwMzQwL2NoYWxsZW5nZSIsIC4uLmFyZ3MpKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRQdWJsaWNLZXkocHJpdmF0ZUtleSkgewogICAgcmV0dXJuIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdmF0ZUtleSkuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJTaWduKG1lc3NhZ2UsIHByaXZhdGVLZXksIGF1eFJhbmQgPSByYW5kb21CeXRlcygzMikpIHsKICAgIGNvbnN0IG0gPSBlbnN1cmVCeXRlcygibWVzc2FnZSIsIG1lc3NhZ2UpOwogICAgY29uc3QgeyBieXRlczogcHgsIHNjYWxhcjogZCB9ID0gc2Nobm9yckdldEV4dFB1YktleShwcml2YXRlS2V5KTsKICAgIGNvbnN0IGEgPSBlbnN1cmVCeXRlcygiYXV4UmFuZCIsIGF1eFJhbmQsIDMyKTsKICAgIGNvbnN0IHQgPSBudW1UbzMyYihkIF4gbnVtKHRhZ2dlZEhhc2goIkJJUDAzNDAvYXV4IiwgYSkpKTsKICAgIGNvbnN0IHJhbmQgPSB0YWdnZWRIYXNoKCJCSVAwMzQwL25vbmNlIiwgdCwgcHgsIG0pOwogICAgY29uc3Qga18gPSBtb2ROKG51bShyYW5kKSk7CiAgICBpZiAoa18gPT09IF8wbjYpCiAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbiBmYWlsZWQ6IGsgaXMgemVybyIpOwogICAgY29uc3QgeyBieXRlczogcngsIHNjYWxhcjogayB9ID0gc2Nobm9yckdldEV4dFB1YktleShrXyk7CiAgICBjb25zdCBlID0gY2hhbGxlbmdlKHJ4LCBweCwgbSk7CiAgICBjb25zdCBzaWcgPSBuZXcgVWludDhBcnJheSg2NCk7CiAgICBzaWcuc2V0KHJ4LCAwKTsKICAgIHNpZy5zZXQobnVtVG8zMmIobW9kTihrICsgZSAqIGQpKSwgMzIpOwogICAgaWYgKCFzY2hub3JyVmVyaWZ5KHNpZywgbSwgcHgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInNpZ246IEludmFsaWQgc2lnbmF0dXJlIHByb2R1Y2VkIik7CiAgICByZXR1cm4gc2lnOwogIH0KICBmdW5jdGlvbiBzY2hub3JyVmVyaWZ5KHNpZ25hdHVyZSwgbWVzc2FnZSwgcHVibGljS2V5KSB7CiAgICBjb25zdCBzaWcgPSBlbnN1cmVCeXRlcygic2lnbmF0dXJlIiwgc2lnbmF0dXJlLCA2NCk7CiAgICBjb25zdCBtID0gZW5zdXJlQnl0ZXMoIm1lc3NhZ2UiLCBtZXNzYWdlKTsKICAgIGNvbnN0IHB1YiA9IGVuc3VyZUJ5dGVzKCJwdWJsaWNLZXkiLCBwdWJsaWNLZXksIDMyKTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFAgPSBsaWZ0X3gobnVtKHB1YikpOwogICAgICBjb25zdCByID0gbnVtKHNpZy5zdWJhcnJheSgwLCAzMikpOwogICAgICBpZiAoIWluUmFuZ2UociwgXzFuNiwgc2VjcDI1NmsxUCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBzID0gbnVtKHNpZy5zdWJhcnJheSgzMiwgNjQpKTsKICAgICAgaWYgKCFpblJhbmdlKHMsIF8xbjYsIHNlY3AyNTZrMU4pKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgY29uc3QgZSA9IGNoYWxsZW5nZShudW1UbzMyYihyKSwgcG9pbnRUb0J5dGVzKFApLCBtKTsKICAgICAgY29uc3QgUiA9IEdtdWxBZGQoUCwgcywgbW9kTigtZSkpOwogICAgICBpZiAoIVIgfHwgIVIuaGFzRXZlblkoKSB8fCBSLnRvQWZmaW5lKCkueCAhPT0gcikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KICB2YXIgc2VjcDI1NmsxUCwgc2VjcDI1NmsxTiwgXzFuNiwgXzJuNSwgZGl2TmVhcmVzdCwgRnAsIHNlY3AyNTZrMSwgXzBuNiwgVEFHR0VEX0hBU0hfUFJFRklYRVMsIHBvaW50VG9CeXRlcywgbnVtVG8zMmIsIG1vZFAsIG1vZE4sIFBvaW50LCBHbXVsQWRkLCBudW0sIHNjaG5vcnIsIGlzb01hcCwgbWFwU1dVLCBodGYsIGhhc2hUb0N1cnZlLCBlbmNvZGVUb0N1cnZlOwogIHZhciBpbml0X3NlY3AyNTZrMSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzIigpIHsKICAgICAgaW5pdF9zaGEyNTYoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF9zaG9ydHdfdXRpbHMoKTsKICAgICAgaW5pdF9oYXNoX3RvX2N1cnZlKCk7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBpbml0X3dlaWVyc3RyYXNzKCk7CiAgICAgIHNlY3AyNTZrMVAgPSBCaWdJbnQoIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZmMyZiIpOwogICAgICBzZWNwMjU2azFOID0gQmlnSW50KCIweGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlYmFhZWRjZTZhZjQ4YTAzYmJmZDI1ZThjZDAzNjQxNDEiKTsKICAgICAgXzFuNiA9IEJpZ0ludCgxKTsKICAgICAgXzJuNSA9IEJpZ0ludCgyKTsKICAgICAgZGl2TmVhcmVzdCA9IChhLCBiKSA9PiAoYSArIGIgLyBfMm41KSAvIGI7CiAgICAgIEZwID0gRmllbGQoc2VjcDI1NmsxUCwgdm9pZCAwLCB2b2lkIDAsIHsgc3FydDogc3FydE1vZCB9KTsKICAgICAgc2VjcDI1NmsxID0gY3JlYXRlQ3VydmUoewogICAgICAgIGE6IEJpZ0ludCgwKSwKICAgICAgICAvLyBlcXVhdGlvbiBwYXJhbXM6IGEsIGIKICAgICAgICBiOiBCaWdJbnQoNyksCiAgICAgICAgLy8gU2VlbSB0byBiZSByaWdpZDogYml0Y29pbnRhbGsub3JnL2luZGV4LnBocD90b3BpYz0yODk3OTUubXNnMzE4Mzk3NSNtc2czMTgzOTc1CiAgICAgICAgRnAsCiAgICAgICAgLy8gRmllbGQncyBwcmltZTogMm4qKjI1Nm4gLSAybioqMzJuIC0gMm4qKjluIC0gMm4qKjhuIC0gMm4qKjduIC0gMm4qKjZuIC0gMm4qKjRuIC0gMW4KICAgICAgICBuOiBzZWNwMjU2azFOLAogICAgICAgIC8vIEN1cnZlIG9yZGVyLCB0b3RhbCBjb3VudCBvZiB2YWxpZCBwb2ludHMgaW4gdGhlIGZpZWxkCiAgICAgICAgLy8gQmFzZSBwb2ludCAoeCwgeSkgYWthIGdlbmVyYXRvciBwb2ludAogICAgICAgIEd4OiBCaWdJbnQoIjU1MDY2MjYzMDIyMjc3MzQzNjY5NTc4NzE4ODk1MTY4NTM0MzI2MjUwNjAzNDUzNzc3NTk0MTc1NTAwMTg3MzYwMzg5MTE2NzI5MjQwIiksCiAgICAgICAgR3k6IEJpZ0ludCgiMzI2NzA1MTAwMjA3NTg4MTY5NzgwODMwODUxMzA1MDcwNDMxODQ0NzEyNzMzODA2NTkyNDMyNzU5Mzg5MDQzMzU3NTczMzc0ODI0MjQiKSwKICAgICAgICBoOiBCaWdJbnQoMSksCiAgICAgICAgLy8gQ29mYWN0b3IKICAgICAgICBsb3dTOiB0cnVlLAogICAgICAgIC8vIEFsbG93IG9ubHkgbG93LVMgc2lnbmF0dXJlcyBieSBkZWZhdWx0IGluIHNpZ24oKSBhbmQgdmVyaWZ5KCkKICAgICAgICAvKioKICAgICAgICAgKiBzZWNwMjU2azEgYmVsb25ncyB0byBLb2JsaXR6IGN1cnZlczogaXQgaGFzIGVmZmljaWVudGx5IGNvbXB1dGFibGUgZW5kb21vcnBoaXNtLgogICAgICAgICAqIEVuZG9tb3JwaGlzbSB1c2VzIDJ4IGxlc3MgUkFNLCBzcGVlZHMgdXAgcHJlY29tcHV0YXRpb24gYnkgMnggYW5kIEVDREggLyBrZXkgcmVjb3ZlcnkgYnkgMjAlLgogICAgICAgICAqIEZvciBwcmVjb21wdXRlZCB3TkFGIGl0IHRyYWRlcyBvZmYgMS8yIGluaXQgdGltZSAmIDEvMyByYW0gZm9yIDIwJSBwZXJmIGhpdC4KICAgICAgICAgKiBFeHBsYW5hdGlvbjogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vcGF1bG1pbGxyL2ViNjcwODA2NzkzZTg0ZGY2MjhhN2M0MzRhODczMDY2CiAgICAgICAgICovCiAgICAgICAgZW5kbzogewogICAgICAgICAgYmV0YTogQmlnSW50KCIweDdhZTk2YTJiNjU3YzA3MTA2ZTY0NDc5ZWFjMzQzNGU5OWNmMDQ5NzUxMmY1ODk5NWMxMzk2YzI4NzE5NTAxZWUiKSwKICAgICAgICAgIHNwbGl0U2NhbGFyOiAoaykgPT4gewogICAgICAgICAgICBjb25zdCBuID0gc2VjcDI1NmsxTjsKICAgICAgICAgICAgY29uc3QgYTEgPSBCaWdJbnQoIjB4MzA4NmQyMjFhN2Q0NmJjZGU4NmM5MGU0OTI4NGViMTUiKTsKICAgICAgICAgICAgY29uc3QgYjEgPSAtXzFuNiAqIEJpZ0ludCgiMHhlNDQzN2VkNjAxMGU4ODI4NmY1NDdmYTkwYWJmZTRjMyIpOwogICAgICAgICAgICBjb25zdCBhMiA9IEJpZ0ludCgiMHgxMTRjYTUwZjdhOGUyZjNmNjU3YzExMDhkOWQ0NGNmZDgiKTsKICAgICAgICAgICAgY29uc3QgYjIgPSBhMTsKICAgICAgICAgICAgY29uc3QgUE9XXzJfMTI4ID0gQmlnSW50KCIweDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIpOwogICAgICAgICAgICBjb25zdCBjMSA9IGRpdk5lYXJlc3QoYjIgKiBrLCBuKTsKICAgICAgICAgICAgY29uc3QgYzIgPSBkaXZOZWFyZXN0KC1iMSAqIGssIG4pOwogICAgICAgICAgICBsZXQgazEgPSBtb2QoayAtIGMxICogYTEgLSBjMiAqIGEyLCBuKTsKICAgICAgICAgICAgbGV0IGsyID0gbW9kKC1jMSAqIGIxIC0gYzIgKiBiMiwgbik7CiAgICAgICAgICAgIGNvbnN0IGsxbmVnID0gazEgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGNvbnN0IGsybmVnID0gazIgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGlmIChrMW5lZykKICAgICAgICAgICAgICBrMSA9IG4gLSBrMTsKICAgICAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgICAgIGsyID0gbiAtIGsyOwogICAgICAgICAgICBpZiAoazEgPiBQT1dfMl8xMjggfHwgazIgPiBQT1dfMl8xMjgpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNwbGl0U2NhbGFyOiBFbmRvbW9ycGhpc20gZmFpbGVkLCBrPSIgKyBrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4geyBrMW5lZywgazEsIGsybmVnLCBrMiB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgc2hhMjU2KTsKICAgICAgXzBuNiA9IEJpZ0ludCgwKTsKICAgICAgVEFHR0VEX0hBU0hfUFJFRklYRVMgPSB7fTsKICAgICAgcG9pbnRUb0J5dGVzID0gKHBvaW50KSA9PiBwb2ludC50b1Jhd0J5dGVzKHRydWUpLnNsaWNlKDEpOwogICAgICBudW1UbzMyYiA9IChuKSA9PiBudW1iZXJUb0J5dGVzQkUobiwgMzIpOwogICAgICBtb2RQID0gKHgpID0+IG1vZCh4LCBzZWNwMjU2azFQKTsKICAgICAgbW9kTiA9ICh4KSA9PiBtb2QoeCwgc2VjcDI1NmsxTik7CiAgICAgIFBvaW50ID0gc2VjcDI1NmsxLlByb2plY3RpdmVQb2ludDsKICAgICAgR211bEFkZCA9IChRLCBhLCBiKSA9PiBQb2ludC5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFEsIGEsIGIpOwogICAgICBudW0gPSBieXRlc1RvTnVtYmVyQkU7CiAgICAgIHNjaG5vcnIgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+ICh7CiAgICAgICAgZ2V0UHVibGljS2V5OiBzY2hub3JyR2V0UHVibGljS2V5LAogICAgICAgIHNpZ246IHNjaG5vcnJTaWduLAogICAgICAgIHZlcmlmeTogc2Nobm9yclZlcmlmeSwKICAgICAgICB1dGlsczogewogICAgICAgICAgcmFuZG9tUHJpdmF0ZUtleTogc2VjcDI1NmsxLnV0aWxzLnJhbmRvbVByaXZhdGVLZXksCiAgICAgICAgICBsaWZ0X3gsCiAgICAgICAgICBwb2ludFRvQnl0ZXMsCiAgICAgICAgICBudW1iZXJUb0J5dGVzQkUsCiAgICAgICAgICBieXRlc1RvTnVtYmVyQkUsCiAgICAgICAgICB0YWdnZWRIYXNoLAogICAgICAgICAgbW9kCiAgICAgICAgfQogICAgICB9KSkoKTsKICAgICAgaXNvTWFwID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBpc29nZW55TWFwKEZwLCBbCiAgICAgICAgLy8geE51bQogICAgICAgIFsKICAgICAgICAgICIweDhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhkYWFhYWE4YzciLAogICAgICAgICAgIjB4N2QzZDRjODBiYzMyMWQ1YjlmMzE1Y2VhN2ZkNDRjNWQ1OTVkMmZjMGJmNjNiOTJkZmZmMTA0NGYxN2M2NTgxIiwKICAgICAgICAgICIweDUzNGMzMjhkMjNmMjM0ZTZlMmE0MTNkZWNhMjVjYWVjZTQ1MDYxNDQwMzdjNDAzMTRlY2JkMGI1M2Q5ZGQyNjIiLAogICAgICAgICAgIjB4OGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGRhYWFhYTg4YyIKICAgICAgICBdLAogICAgICAgIC8vIHhEZW4KICAgICAgICBbCiAgICAgICAgICAiMHhkMzU3NzExOTNkOTQ5MThhOWNhMzRjY2JiN2I2NDBkZDg2Y2Q0MDk1NDJmODQ4N2Q5ZmU2Yjc0NTc4MWViNDliIiwKICAgICAgICAgICIweGVkYWRjNmY2NDM4M2RjMWRmN2M0YjJkNTFiNTQyMjU0MDZkMzZiNjQxZjVlNDFiYmM1MmE1NjYxMmE4YzZkMTQiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0sCiAgICAgICAgLy8geU51bQogICAgICAgIFsKICAgICAgICAgICIweDRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiOGUzOGUyM2MiLAogICAgICAgICAgIjB4Yzc1ZTBjMzJkNWNiN2MwZmE5ZDBhNTRiMTJhMGE2ZDU2NDdhYjA0NmQ2ODZkYTZmZGZmYzkwZmMyMDFkNzFhMyIsCiAgICAgICAgICAiMHgyOWE2MTk0NjkxZjkxYTczNzE1MjA5ZWY2NTEyZTU3NjcyMjgzMGEyMDFiZTIwMThhNzY1ZTg1YTllY2VlOTMxIiwKICAgICAgICAgICIweDJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmMzhlMzhkODQiCiAgICAgICAgXSwKICAgICAgICAvLyB5RGVuCiAgICAgICAgWwogICAgICAgICAgIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZjkzYiIsCiAgICAgICAgICAiMHg3YTA2NTM0YmI4YmRiNDlmZDVlOWU2NjMyNzIyYzI5ODk0NjdjMWJmYzhlOGQ5NzhkZmI0MjVkMjY4NWMyNTczIiwKICAgICAgICAgICIweDY0ODRhYTcxNjU0NWNhMmNmM2E3MGMzZmE4ZmUzMzdlMGEzZDIxMTYyZjBkNjI5OWE3YmY4MTkyYmZkMmE3NmYiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0KICAgICAgXS5tYXAoKGkpID0+IGkubWFwKChqKSA9PiBCaWdJbnQoaikpKSkpKCk7CiAgICAgIG1hcFNXVSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gbWFwVG9DdXJ2ZVNpbXBsZVNXVShGcCwgewogICAgICAgIEE6IEJpZ0ludCgiMHgzZjg3MzFhYmRkNjYxYWRjYTA4YTU1NThmMGY1ZDI3MmU5NTNkMzYzY2I2ZjBlNWQ0MDU0NDdjMDFhNDQ0NTMzIiksCiAgICAgICAgQjogQmlnSW50KCIxNzcxIiksCiAgICAgICAgWjogRnAuY3JlYXRlKEJpZ0ludCgiLTExIikpCiAgICAgIH0pKSgpOwogICAgICBodGYgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGNyZWF0ZUhhc2hlcihzZWNwMjU2azEuUHJvamVjdGl2ZVBvaW50LCAoc2NhbGFycykgPT4gewogICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gbWFwU1dVKEZwLmNyZWF0ZShzY2FsYXJzWzBdKSk7CiAgICAgICAgcmV0dXJuIGlzb01hcCh4LCB5KTsKICAgICAgfSwgewogICAgICAgIERTVDogInNlY3AyNTZrMV9YTUQ6U0hBLTI1Nl9TU1dVX1JPXyIsCiAgICAgICAgZW5jb2RlRFNUOiAic2VjcDI1NmsxX1hNRDpTSEEtMjU2X1NTV1VfTlVfIiwKICAgICAgICBwOiBGcC5PUkRFUiwKICAgICAgICBtOiAxLAogICAgICAgIGs6IDEyOCwKICAgICAgICBleHBhbmQ6ICJ4bWQiLAogICAgICAgIGhhc2g6IHNoYTI1NgogICAgICB9KSkoKTsKICAgICAgaGFzaFRvQ3VydmUgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGh0Zi5oYXNoVG9DdXJ2ZSkoKTsKICAgICAgZW5jb2RlVG9DdXJ2ZSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gaHRmLmVuY29kZVRvQ3VydmUpKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcwogIHZhciBFeGVjdXRpb25SZXZlcnRlZEVycm9yLCBGZWVDYXBUb29IaWdoRXJyb3IsIEZlZUNhcFRvb0xvd0Vycm9yLCBOb25jZVRvb0hpZ2hFcnJvciwgTm9uY2VUb29Mb3dFcnJvciwgTm9uY2VNYXhWYWx1ZUVycm9yLCBJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLCBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yLCBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvciwgVGlwQWJvdmVGZWVDYXBFcnJvciwgVW5rbm93bk5vZGVFcnJvcjsKICB2YXIgaW5pdF9ub2RlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0R3dlaSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWVzc2FnZSB9ID0ge30pIHsKICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IG1lc3NhZ2U/LnJlcGxhY2UoImV4ZWN1dGlvbiByZXZlcnRlZDogIiwgIiIpPy5yZXBsYWNlKCJleGVjdXRpb24gcmV2ZXJ0ZWQiLCAiIik7CiAgICAgICAgICBzdXBlcihgRXhlY3V0aW9uIHJldmVydGVkICR7cmVhc29uID8gYHdpdGggcmVhc29uOiAke3JlYXNvbn1gIDogImZvciBhbiB1bmtub3duIHJlYXNvbiJ9LmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJFeGVjdXRpb25SZXZlcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDMKICAgICAgfSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGVjdXRpb25SZXZlcnRlZEVycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9leGVjdXRpb24gcmV2ZXJ0ZWQvCiAgICAgIH0pOwogICAgICBGZWVDYXBUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkgY2Fubm90IGJlIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGFsbG93ZWQgdmFsdWUgKDJeMjU2LTEpLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29IaWdoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWVDYXBUb29IaWdoRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiAyXF4yNTYtMXxmZWUgY2FwIGhpZ2hlciB0aGFuIDJcXjI1Ni0xLwogICAgICB9KTsKICAgICAgRmVlQ2FwVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfWAgOiAiIn0gZ3dlaSkgY2Fubm90IGJlIGxvd2VyIHRoYW4gdGhlIGJsb2NrIGJhc2UgZmVlLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29Mb3dFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlZUNhcFRvb0xvd0Vycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9tYXggZmVlIHBlciBnYXMgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfGZlZSBjYXAgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfHRyYW5zYWN0aW9uIGlzIG91dGRhdGVkLwogICAgICB9KTsKICAgICAgTm9uY2VUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG5vbmNlIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBoaWdoZXIgdGhhbiB0aGUgbmV4dCBvbmUgZXhwZWN0ZWQuYCwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vSGlnaEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb25jZVRvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgdG9vIGhpZ2gvCiAgICAgIH0pOwogICAgICBOb25jZVRvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBsb3dlciB0aGFuIHRoZSBjdXJyZW50IG5vbmNlIG9mIHRoZSBhY2NvdW50LmAsCiAgICAgICAgICAgICJUcnkgaW5jcmVhc2luZyB0aGUgbm9uY2Ugb3IgZmluZCB0aGUgbGF0ZXN0IG5vbmNlIHdpdGggYGdldFRyYW5zYWN0aW9uQ291bnRgLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vTG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlVG9vTG93RXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL25vbmNlIHRvbyBsb3d8dHJhbnNhY3Rpb24gYWxyZWFkeSBpbXBvcnRlZHxhbHJlYWR5IGtub3duLwogICAgICB9KTsKICAgICAgTm9uY2VNYXhWYWx1ZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBOb25jZSBwcm92aWRlZCBmb3IgdGhlIHRyYW5zYWN0aW9uICR7bm9uY2UgPyBgKCR7bm9uY2V9KSBgIDogIiJ9ZXhjZWVkcyB0aGUgbWF4aW11bSBhbGxvd2VkIG5vbmNlLmAsIHsgY2F1c2UsIG5hbWU6ICJOb25jZU1heFZhbHVlRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlTWF4VmFsdWVFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgaGFzIG1heCB2YWx1ZS8KICAgICAgfSk7CiAgICAgIEluc3VmZmljaWVudEZ1bmRzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJUaGUgdG90YWwgY29zdCAoZ2FzICogZ2FzIGZlZSArIHZhbHVlKSBvZiBleGVjdXRpbmcgdGhpcyB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBiYWxhbmNlIG9mIHRoZSBhY2NvdW50LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlRoaXMgZXJyb3IgY291bGQgYXJpc2Ugd2hlbiB0aGUgYWNjb3VudCBkb2VzIG5vdCBoYXZlIGVub3VnaCBmdW5kcyB0bzoiLAogICAgICAgICAgICAgICIgLSBwYXkgZm9yIHRoZSB0b3RhbCBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIHBheSBmb3IgdGhlIHZhbHVlIHRvIHNlbmQuIiwKICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgIlRoZSBjb3N0IG9mIHRoZSB0cmFuc2FjdGlvbiBpcyBjYWxjdWxhdGVkIGFzIGBnYXMgKiBnYXMgZmVlICsgdmFsdWVgLCB3aGVyZToiLAogICAgICAgICAgICAgICIgLSBgZ2FzYCBpcyB0aGUgYW1vdW50IG9mIGdhcyBuZWVkZWQgZm9yIHRyYW5zYWN0aW9uIHRvIGV4ZWN1dGUsIiwKICAgICAgICAgICAgICAiIC0gYGdhcyBmZWVgIGlzIHRoZSBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIGB2YWx1ZWAgaXMgdGhlIGFtb3VudCBvZiBldGhlciB0byBzZW5kIHRvIHRoZSByZWNpcGllbnQuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiSW5zdWZmaWNpZW50RnVuZHNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluc3VmZmljaWVudEZ1bmRzRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL2luc3VmZmljaWVudCBmdW5kc3xleGNlZWRzIHRyYW5zYWN0aW9uIHNlbmRlciBhY2NvdW50IGJhbGFuY2UvCiAgICAgIH0pOwogICAgICBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIGdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgYW1vdW50IG9mIGdhcyAke2dhcyA/IGAoJHtnYXN9KSBgIDogIiJ9cHJvdmlkZWQgZm9yIHRoZSB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBsaW1pdCBhbGxvd2VkIGZvciB0aGUgYmxvY2suYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIkludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gaGlnaHxnYXMgbGltaXQgcmVhY2hlZC8KICAgICAgfSk7CiAgICAgIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBnYXMgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihgVGhlIGFtb3VudCBvZiBnYXMgJHtnYXMgPyBgKCR7Z2FzfSkgYCA6ICIifXByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gaXMgdG9vIGxvdy5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiSW50cmluc2ljR2FzVG9vTG93RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRyaW5zaWNHYXNUb29Mb3dFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gbG93LwogICAgICB9KTsKICAgICAgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSB0cmFuc2FjdGlvbiB0eXBlIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgY2hhaW4uIiwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL3RyYW5zYWN0aW9uIHR5cGUgbm90IHZhbGlkLwogICAgICB9KTsKICAgICAgVGlwQWJvdmVGZWVDYXBFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFRoZSBwcm92aWRlZCB0aXAgKFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCR7bWF4UHJpb3JpdHlGZWVQZXJHYXMgPyBgID0gJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAgOiAiIn0pIGNhbm5vdCBiZSBoaWdoZXIgdGhhbiB0aGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVGlwQWJvdmVGZWVDYXBFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpcEFib3ZlRmVlQ2FwRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBwcmlvcml0eSBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiBtYXggZmVlIHBlciBnYXN8dGlwIGhpZ2hlciB0aGFuIGZlZSBjYXAvCiAgICAgIH0pOwogICAgICBVbmtub3duTm9kZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlIH0pIHsKICAgICAgICAgIHN1cGVyKGBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBleGVjdXRpbmc6ICR7Y2F1c2U/LnNob3J0TWVzc2FnZX1gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVW5rbm93bk5vZGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMKICBmdW5jdGlvbiBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKGVyci5kZXRhaWxzIHx8ICIiKS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIgPyBlcnIud2FsaygoZSkgPT4gZT8uY29kZSA9PT0gRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvci5jb2RlKSA6IGVycjsKICAgIGlmIChleGVjdXRpb25SZXZlcnRlZEVycm9yIGluc3RhbmNlb2YgQmFzZUVycm9yMikKICAgICAgcmV0dXJuIG5ldyBFeGVjdXRpb25SZXZlcnRlZEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1lc3NhZ2U6IGV4ZWN1dGlvblJldmVydGVkRXJyb3IuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChFeGVjdXRpb25SZXZlcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtZXNzYWdlOiBlcnIuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChGZWVDYXBUb29IaWdoRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoewogICAgICAgIGNhdXNlOiBlcnIsCiAgICAgICAgbWF4RmVlUGVyR2FzOiBhcmdzPy5tYXhGZWVQZXJHYXMKICAgICAgfSk7CiAgICBpZiAoRmVlQ2FwVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29Mb3dFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtYXhGZWVQZXJHYXM6IGFyZ3M/Lm1heEZlZVBlckdhcwogICAgICB9KTsKICAgIGlmIChOb25jZVRvb0hpZ2hFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBOb25jZVRvb0xvd0Vycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlTWF4VmFsdWVFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlTWF4VmFsdWVFcnJvcih7IGNhdXNlOiBlcnIsIG5vbmNlOiBhcmdzPy5ub25jZSB9KTsKICAgIGlmIChJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW5zdWZmaWNpZW50RnVuZHNFcnJvcih7IGNhdXNlOiBlcnIgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vSGlnaEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgZ2FzOiBhcmdzPy5nYXMgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcih7IGNhdXNlOiBlcnIsIGdhczogYXJncz8uZ2FzIH0pOwogICAgaWYgKFRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IoeyBjYXVzZTogZXJyIH0pOwogICAgaWYgKFRpcEFib3ZlRmVlQ2FwRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1heEZlZVBlckdhczogYXJncz8ubWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiBhcmdzPy5tYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9KTsKICAgIHJldHVybiBuZXcgVW5rbm93bk5vZGVFcnJvcih7CiAgICAgIGNhdXNlOiBlcnIKICAgIH0pOwogIH0KICB2YXIgaW5pdF9nZXROb2RlRXJyb3IgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2V4dHJhY3QuanMKICBmdW5jdGlvbiBleHRyYWN0KHZhbHVlXywgeyBmb3JtYXQgfSkgewogICAgaWYgKCFmb3JtYXQpCiAgICAgIHJldHVybiB7fTsKICAgIGNvbnN0IHZhbHVlID0ge307CiAgICBmdW5jdGlvbiBleHRyYWN0Xyhmb3JtYXR0ZWQyKSB7CiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmb3JtYXR0ZWQyKTsKICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgIGlmIChrZXkgaW4gdmFsdWVfKQogICAgICAgICAgdmFsdWVba2V5XSA9IHZhbHVlX1trZXldOwogICAgICAgIGlmIChmb3JtYXR0ZWQyW2tleV0gJiYgdHlwZW9mIGZvcm1hdHRlZDJba2V5XSA9PT0gIm9iamVjdCIgJiYgIUFycmF5LmlzQXJyYXkoZm9ybWF0dGVkMltrZXldKSkKICAgICAgICAgIGV4dHJhY3RfKGZvcm1hdHRlZDJba2V5XSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdCh2YWx1ZV8gfHwge30pOwogICAgZXh0cmFjdF8oZm9ybWF0dGVkKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgdmFyIGluaXRfZXh0cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9leHRyYWN0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvZm9ybWF0dGVyLmpzCiAgZnVuY3Rpb24gZGVmaW5lRm9ybWF0dGVyKHR5cGUsIGZvcm1hdCkgewogICAgcmV0dXJuICh7IGV4Y2x1ZGUsIGZvcm1hdDogb3ZlcnJpZGVzIH0pID0+IHsKICAgICAgcmV0dXJuIHsKICAgICAgICBleGNsdWRlLAogICAgICAgIGZvcm1hdDogKGFyZ3MpID0+IHsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdChhcmdzKTsKICAgICAgICAgIGlmIChleGNsdWRlKSB7CiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGV4Y2x1ZGUpIHsKICAgICAgICAgICAgICBkZWxldGUgZm9ybWF0dGVkW2tleV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLmZvcm1hdHRlZCwKICAgICAgICAgICAgLi4ub3ZlcnJpZGVzKGFyZ3MpCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgdHlwZQogICAgICB9OwogICAgfTsKICB9CiAgdmFyIGluaXRfZm9ybWF0dGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2Zvcm1hdHRlci5qcyIoKSB7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdChyZXF1ZXN0KSB7CiAgICBjb25zdCBycGNSZXF1ZXN0ID0ge307CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYXV0aG9yaXphdGlvbkxpc3QgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmF1dGhvcml6YXRpb25MaXN0ID0gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QocmVxdWVzdC5hdXRob3JpemF0aW9uTGlzdCk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYWNjZXNzTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QuYWNjZXNzTGlzdCA9IHJlcXVlc3QuYWNjZXNzTGlzdDsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmJsb2JzICE9PSAidW5kZWZpbmVkIikgewogICAgICBpZiAodHlwZW9mIHJlcXVlc3QuYmxvYnNbMF0gIT09ICJzdHJpbmciKQogICAgICAgIHJwY1JlcXVlc3QuYmxvYnMgPSByZXF1ZXN0LmJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4KSk7CiAgICAgIGVsc2UKICAgICAgICBycGNSZXF1ZXN0LmJsb2JzID0gcmVxdWVzdC5ibG9iczsKICAgIH0KICAgIGlmICh0eXBlb2YgcmVxdWVzdC5kYXRhICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5kYXRhID0gcmVxdWVzdC5kYXRhOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmZyb20gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmZyb20gPSByZXF1ZXN0LmZyb207CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5nYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lmdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lmdhc1ByaWNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5nYXNQcmljZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyA9IG51bWJlclRvSGV4KHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lm1heEZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID0gbnVtYmVyVG9IZXgocmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3Qubm9uY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm5vbmNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5ub25jZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudG8gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnRvID0gcmVxdWVzdC50bzsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC50eXBlICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC50eXBlID0gcnBjVHJhbnNhY3Rpb25UeXBlW3JlcXVlc3QudHlwZV07CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudmFsdWUgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnZhbHVlID0gbnVtYmVyVG9IZXgocmVxdWVzdC52YWx1ZSk7CiAgICByZXR1cm4gcnBjUmVxdWVzdDsKICB9CiAgZnVuY3Rpb24gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGFkZHJlc3M6IGF1dGhvcml6YXRpb24uY29udHJhY3RBZGRyZXNzLAogICAgICByOiBhdXRob3JpemF0aW9uLnIsCiAgICAgIHM6IGF1dGhvcml6YXRpb24ucywKICAgICAgY2hhaW5JZDogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IG51bWJlclRvSGV4KGF1dGhvcml6YXRpb24ubm9uY2UpLAogICAgICAuLi50eXBlb2YgYXV0aG9yaXphdGlvbi55UGFyaXR5ICE9PSAidW5kZWZpbmVkIiA/IHsgeVBhcml0eTogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi55UGFyaXR5KSB9IDoge30sCiAgICAgIC4uLnR5cGVvZiBhdXRob3JpemF0aW9uLnYgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiBhdXRob3JpemF0aW9uLnlQYXJpdHkgPT09ICJ1bmRlZmluZWQiID8geyB2OiBudW1iZXJUb0hleChhdXRob3JpemF0aW9uLnYpIH0gOiB7fQogICAgfSkpOwogIH0KICB2YXIgcnBjVHJhbnNhY3Rpb25UeXBlLCBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3Q7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9mb3JtYXR0ZXIoKTsKICAgICAgcnBjVHJhbnNhY3Rpb25UeXBlID0gewogICAgICAgIGxlZ2FjeTogIjB4MCIsCiAgICAgICAgZWlwMjkzMDogIjB4MSIsCiAgICAgICAgZWlwMTU1OTogIjB4MiIsCiAgICAgICAgZWlwNDg0NDogIjB4MyIsCiAgICAgICAgZWlwNzcwMjogIjB4NCIKICAgICAgfTsKICAgICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUZvcm1hdHRlcigidHJhbnNhY3Rpb25SZXF1ZXN0IiwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMKICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU1hcHBpbmcoc3RhdGVNYXBwaW5nKSB7CiAgICBpZiAoIXN0YXRlTWFwcGluZyB8fCBzdGF0ZU1hcHBpbmcubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgcmV0dXJuIHN0YXRlTWFwcGluZy5yZWR1Y2UoKGFjYywgeyBzbG90LCB2YWx1ZSB9KSA9PiB7CiAgICAgIGlmIChzbG90Lmxlbmd0aCAhPT0gNjYpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRCeXRlc0xlbmd0aEVycm9yKHsKICAgICAgICAgIHNpemU6IHNsb3QubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBpZiAodmFsdWUubGVuZ3RoICE9PSA2NikKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IoewogICAgICAgICAgc2l6ZTogdmFsdWUubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBhY2Nbc2xvdF0gPSB2YWx1ZTsKICAgICAgcmV0dXJuIGFjYzsKICAgIH0sIHt9KTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudFN0YXRlT3ZlcnJpZGUocGFyYW1ldGVycykgewogICAgY29uc3QgeyBiYWxhbmNlLCBub25jZSwgc3RhdGUsIHN0YXRlRGlmZiwgY29kZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlID0ge307CiAgICBpZiAoY29kZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5jb2RlID0gY29kZTsKICAgIGlmIChiYWxhbmNlICE9PSB2b2lkIDApCiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLmJhbGFuY2UgPSBudW1iZXJUb0hleChiYWxhbmNlKTsKICAgIGlmIChub25jZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5ub25jZSA9IG51bWJlclRvSGV4KG5vbmNlKTsKICAgIGlmIChzdGF0ZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5zdGF0ZSA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZSk7CiAgICBpZiAoc3RhdGVEaWZmICE9PSB2b2lkIDApIHsKICAgICAgaWYgKHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlKQogICAgICAgIHRocm93IG5ldyBTdGF0ZUFzc2lnbm1lbnRDb25mbGljdEVycm9yKCk7CiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlRGlmZiA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZURpZmYpOwogICAgfQogICAgcmV0dXJuIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHBhcmFtZXRlcnMpIHsKICAgIGlmICghcGFyYW1ldGVycykKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSB7fTsKICAgIGZvciAoY29uc3QgeyBhZGRyZXNzLCAuLi5hY2NvdW50U3RhdGUgfSBvZiBwYXJhbWV0ZXJzKSB7CiAgICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIGlmIChycGNTdGF0ZU92ZXJyaWRlW2FkZHJlc3NdKQogICAgICAgIHRocm93IG5ldyBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yKHsgYWRkcmVzcyB9KTsKICAgICAgcnBjU3RhdGVPdmVycmlkZVthZGRyZXNzXSA9IHNlcmlhbGl6ZUFjY291bnRTdGF0ZU92ZXJyaWRlKGFjY291bnRTdGF0ZSk7CiAgICB9CiAgICByZXR1cm4gcnBjU3RhdGVPdmVycmlkZTsKICB9CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZTIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2FkZHJlc3MoKTsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfc3RhdGVPdmVycmlkZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvbnVtYmVyLmpzCiAgdmFyIG1heEludDgsIG1heEludDE2LCBtYXhJbnQyNCwgbWF4SW50MzIsIG1heEludDQwLCBtYXhJbnQ0OCwgbWF4SW50NTYsIG1heEludDY0LCBtYXhJbnQ3MiwgbWF4SW50ODAsIG1heEludDg4LCBtYXhJbnQ5NiwgbWF4SW50MTA0LCBtYXhJbnQxMTIsIG1heEludDEyMCwgbWF4SW50MTI4LCBtYXhJbnQxMzYsIG1heEludDE0NCwgbWF4SW50MTUyLCBtYXhJbnQxNjAsIG1heEludDE2OCwgbWF4SW50MTc2LCBtYXhJbnQxODQsIG1heEludDE5MiwgbWF4SW50MjAwLCBtYXhJbnQyMDgsIG1heEludDIxNiwgbWF4SW50MjI0LCBtYXhJbnQyMzIsIG1heEludDI0MCwgbWF4SW50MjQ4LCBtYXhJbnQyNTYsIG1pbkludDgsIG1pbkludDE2LCBtaW5JbnQyNCwgbWluSW50MzIsIG1pbkludDQwLCBtaW5JbnQ0OCwgbWluSW50NTYsIG1pbkludDY0LCBtaW5JbnQ3MiwgbWluSW50ODAsIG1pbkludDg4LCBtaW5JbnQ5NiwgbWluSW50MTA0LCBtaW5JbnQxMTIsIG1pbkludDEyMCwgbWluSW50MTI4LCBtaW5JbnQxMzYsIG1pbkludDE0NCwgbWluSW50MTUyLCBtaW5JbnQxNjAsIG1pbkludDE2OCwgbWluSW50MTc2LCBtaW5JbnQxODQsIG1pbkludDE5MiwgbWluSW50MjAwLCBtaW5JbnQyMDgsIG1pbkludDIxNiwgbWluSW50MjI0LCBtaW5JbnQyMzIsIG1pbkludDI0MCwgbWluSW50MjQ4LCBtaW5JbnQyNTYsIG1heFVpbnQ4LCBtYXhVaW50MTYsIG1heFVpbnQyNCwgbWF4VWludDMyLCBtYXhVaW50NDAsIG1heFVpbnQ0OCwgbWF4VWludDU2LCBtYXhVaW50NjQsIG1heFVpbnQ3MiwgbWF4VWludDgwLCBtYXhVaW50ODgsIG1heFVpbnQ5NiwgbWF4VWludDEwNCwgbWF4VWludDExMiwgbWF4VWludDEyMCwgbWF4VWludDEyOCwgbWF4VWludDEzNiwgbWF4VWludDE0NCwgbWF4VWludDE1MiwgbWF4VWludDE2MCwgbWF4VWludDE2OCwgbWF4VWludDE3NiwgbWF4VWludDE4NCwgbWF4VWludDE5MiwgbWF4VWludDIwMCwgbWF4VWludDIwOCwgbWF4VWludDIxNiwgbWF4VWludDIyNCwgbWF4VWludDIzMiwgbWF4VWludDI0MCwgbWF4VWludDI0OCwgbWF4VWludDI1NjsKICB2YXIgaW5pdF9udW1iZXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9udW1iZXIuanMiKCkgewogICAgICBtYXhJbnQ4ID0gMm4gKiogKDhuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDE2ID0gMm4gKiogKDE2biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQyNCA9IDJuICoqICgyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MzIgPSAybiAqKiAoMzJuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDQwID0gMm4gKiogKDQwbiAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ0OCA9IDJuICoqICg0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50NTYgPSAybiAqKiAoNTZuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDY0ID0gMm4gKiogKDY0biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ3MiA9IDJuICoqICg3Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50ODAgPSAybiAqKiAoODBuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDg4ID0gMm4gKiogKDg4biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ5NiA9IDJuICoqICg5Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTA0ID0gMm4gKiogKDEwNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTEyID0gMm4gKiogKDExMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTIwID0gMm4gKiogKDEyMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTI4ID0gMm4gKiogKDEyOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTM2ID0gMm4gKiogKDEzNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTQ0ID0gMm4gKiogKDE0NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTUyID0gMm4gKiogKDE1Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTYwID0gMm4gKiogKDE2MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTY4ID0gMm4gKiogKDE2OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTc2ID0gMm4gKiogKDE3Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTg0ID0gMm4gKiogKDE4NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTkyID0gMm4gKiogKDE5Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjAwID0gMm4gKiogKDIwMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjA4ID0gMm4gKiogKDIwOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjE2ID0gMm4gKiogKDIxNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjI0ID0gMm4gKiogKDIyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjMyID0gMm4gKiogKDIzMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQwID0gMm4gKiogKDI0MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQ4ID0gMm4gKiogKDI0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjU2ID0gMm4gKiogKDI1Nm4gLSAxbikgLSAxbjsKICAgICAgbWluSW50OCA9IC0oMm4gKiogKDhuIC0gMW4pKTsKICAgICAgbWluSW50MTYgPSAtKDJuICoqICgxNm4gLSAxbikpOwogICAgICBtaW5JbnQyNCA9IC0oMm4gKiogKDI0biAtIDFuKSk7CiAgICAgIG1pbkludDMyID0gLSgybiAqKiAoMzJuIC0gMW4pKTsKICAgICAgbWluSW50NDAgPSAtKDJuICoqICg0MG4gLSAxbikpOwogICAgICBtaW5JbnQ0OCA9IC0oMm4gKiogKDQ4biAtIDFuKSk7CiAgICAgIG1pbkludDU2ID0gLSgybiAqKiAoNTZuIC0gMW4pKTsKICAgICAgbWluSW50NjQgPSAtKDJuICoqICg2NG4gLSAxbikpOwogICAgICBtaW5JbnQ3MiA9IC0oMm4gKiogKDcybiAtIDFuKSk7CiAgICAgIG1pbkludDgwID0gLSgybiAqKiAoODBuIC0gMW4pKTsKICAgICAgbWluSW50ODggPSAtKDJuICoqICg4OG4gLSAxbikpOwogICAgICBtaW5JbnQ5NiA9IC0oMm4gKiogKDk2biAtIDFuKSk7CiAgICAgIG1pbkludDEwNCA9IC0oMm4gKiogKDEwNG4gLSAxbikpOwogICAgICBtaW5JbnQxMTIgPSAtKDJuICoqICgxMTJuIC0gMW4pKTsKICAgICAgbWluSW50MTIwID0gLSgybiAqKiAoMTIwbiAtIDFuKSk7CiAgICAgIG1pbkludDEyOCA9IC0oMm4gKiogKDEyOG4gLSAxbikpOwogICAgICBtaW5JbnQxMzYgPSAtKDJuICoqICgxMzZuIC0gMW4pKTsKICAgICAgbWluSW50MTQ0ID0gLSgybiAqKiAoMTQ0biAtIDFuKSk7CiAgICAgIG1pbkludDE1MiA9IC0oMm4gKiogKDE1Mm4gLSAxbikpOwogICAgICBtaW5JbnQxNjAgPSAtKDJuICoqICgxNjBuIC0gMW4pKTsKICAgICAgbWluSW50MTY4ID0gLSgybiAqKiAoMTY4biAtIDFuKSk7CiAgICAgIG1pbkludDE3NiA9IC0oMm4gKiogKDE3Nm4gLSAxbikpOwogICAgICBtaW5JbnQxODQgPSAtKDJuICoqICgxODRuIC0gMW4pKTsKICAgICAgbWluSW50MTkyID0gLSgybiAqKiAoMTkybiAtIDFuKSk7CiAgICAgIG1pbkludDIwMCA9IC0oMm4gKiogKDIwMG4gLSAxbikpOwogICAgICBtaW5JbnQyMDggPSAtKDJuICoqICgyMDhuIC0gMW4pKTsKICAgICAgbWluSW50MjE2ID0gLSgybiAqKiAoMjE2biAtIDFuKSk7CiAgICAgIG1pbkludDIyNCA9IC0oMm4gKiogKDIyNG4gLSAxbikpOwogICAgICBtaW5JbnQyMzIgPSAtKDJuICoqICgyMzJuIC0gMW4pKTsKICAgICAgbWluSW50MjQwID0gLSgybiAqKiAoMjQwbiAtIDFuKSk7CiAgICAgIG1pbkludDI0OCA9IC0oMm4gKiogKDI0OG4gLSAxbikpOwogICAgICBtaW5JbnQyNTYgPSAtKDJuICoqICgyNTZuIC0gMW4pKTsKICAgICAgbWF4VWludDggPSAybiAqKiA4biAtIDFuOwogICAgICBtYXhVaW50MTYgPSAybiAqKiAxNm4gLSAxbjsKICAgICAgbWF4VWludDI0ID0gMm4gKiogMjRuIC0gMW47CiAgICAgIG1heFVpbnQzMiA9IDJuICoqIDMybiAtIDFuOwogICAgICBtYXhVaW50NDAgPSAybiAqKiA0MG4gLSAxbjsKICAgICAgbWF4VWludDQ4ID0gMm4gKiogNDhuIC0gMW47CiAgICAgIG1heFVpbnQ1NiA9IDJuICoqIDU2biAtIDFuOwogICAgICBtYXhVaW50NjQgPSAybiAqKiA2NG4gLSAxbjsKICAgICAgbWF4VWludDcyID0gMm4gKiogNzJuIC0gMW47CiAgICAgIG1heFVpbnQ4MCA9IDJuICoqIDgwbiAtIDFuOwogICAgICBtYXhVaW50ODggPSAybiAqKiA4OG4gLSAxbjsKICAgICAgbWF4VWludDk2ID0gMm4gKiogOTZuIC0gMW47CiAgICAgIG1heFVpbnQxMDQgPSAybiAqKiAxMDRuIC0gMW47CiAgICAgIG1heFVpbnQxMTIgPSAybiAqKiAxMTJuIC0gMW47CiAgICAgIG1heFVpbnQxMjAgPSAybiAqKiAxMjBuIC0gMW47CiAgICAgIG1heFVpbnQxMjggPSAybiAqKiAxMjhuIC0gMW47CiAgICAgIG1heFVpbnQxMzYgPSAybiAqKiAxMzZuIC0gMW47CiAgICAgIG1heFVpbnQxNDQgPSAybiAqKiAxNDRuIC0gMW47CiAgICAgIG1heFVpbnQxNTIgPSAybiAqKiAxNTJuIC0gMW47CiAgICAgIG1heFVpbnQxNjAgPSAybiAqKiAxNjBuIC0gMW47CiAgICAgIG1heFVpbnQxNjggPSAybiAqKiAxNjhuIC0gMW47CiAgICAgIG1heFVpbnQxNzYgPSAybiAqKiAxNzZuIC0gMW47CiAgICAgIG1heFVpbnQxODQgPSAybiAqKiAxODRuIC0gMW47CiAgICAgIG1heFVpbnQxOTIgPSAybiAqKiAxOTJuIC0gMW47CiAgICAgIG1heFVpbnQyMDAgPSAybiAqKiAyMDBuIC0gMW47CiAgICAgIG1heFVpbnQyMDggPSAybiAqKiAyMDhuIC0gMW47CiAgICAgIG1heFVpbnQyMTYgPSAybiAqKiAyMTZuIC0gMW47CiAgICAgIG1heFVpbnQyMjQgPSAybiAqKiAyMjRuIC0gMW47CiAgICAgIG1heFVpbnQyMzIgPSAybiAqKiAyMzJuIC0gMW47CiAgICAgIG1heFVpbnQyNDAgPSAybiAqKiAyNDBuIC0gMW47CiAgICAgIG1heFVpbnQyNDggPSAybiAqKiAyNDhuIC0gMW47CiAgICAgIG1heFVpbnQyNTYgPSAybiAqKiAyNTZuIC0gMW47CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRSZXF1ZXN0LmpzCiAgZnVuY3Rpb24gYXNzZXJ0UmVxdWVzdChhcmdzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgdG8gfSA9IGFyZ3M7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgaWYgKGFjY291bnQgJiYgIWlzQWRkcmVzcyhhY2NvdW50LmFkZHJlc3MpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcyB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmICh0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmICh0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKSkKICAgICAgdGhyb3cgbmV3IEZlZUNvbmZsaWN0RXJyb3IoKTsKICAgIGlmIChtYXhGZWVQZXJHYXMgJiYgbWF4RmVlUGVyR2FzID4gbWF4VWludDI1NikKICAgICAgdGhyb3cgbmV3IEZlZUNhcFRvb0hpZ2hFcnJvcih7IG1heEZlZVBlckdhcyB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPiBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcyB9KTsKICB9CiAgdmFyIGluaXRfYXNzZXJ0UmVxdWVzdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vYXNzZXJ0UmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfcGFyc2VBY2NvdW50KCk7CiAgICAgIGluaXRfbnVtYmVyKCk7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X25vZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9pc0FkZHJlc3NFcXVhbC5qcwogIGZ1bmN0aW9uIGlzQWRkcmVzc0VxdWFsKGEsIGIpIHsKICAgIGlmICghaXNBZGRyZXNzKGEsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBhIH0pOwogICAgaWYgKCFpc0FkZHJlc3MoYiwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGIgfSk7CiAgICByZXR1cm4gYS50b0xvd2VyQ2FzZSgpID09PSBiLnRvTG93ZXJDYXNlKCk7CiAgfQogIHZhciBpbml0X2lzQWRkcmVzc0VxdWFsID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2lzQWRkcmVzc0VxdWFsLmpzIigpIHsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZGVjb2RlRnVuY3Rpb25SZXN1bHQuanMKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNCB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgaWYgKCFhYmlJdGVtLm91dHB1dHMpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yKGFiaUl0ZW0ubmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgY29uc3QgdmFsdWVzID0gZGVjb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLm91dHB1dHMsIGRhdGEpOwogICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMSkKICAgICAgcmV0dXJuIHZhbHVlczsKICAgIGlmICh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMSkKICAgICAgcmV0dXJuIHZhbHVlc1swXTsKICAgIHJldHVybiB2b2lkIDA7CiAgfQogIHZhciBkb2NzUGF0aDQ7CiAgdmFyIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvblJlc3VsdC5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2dldEFiaUl0ZW0oKTsKICAgICAgZG9jc1BhdGg0ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZUZ1bmN0aW9uUmVzdWx0IjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9hYmlzLmpzCiAgdmFyIG11bHRpY2FsbDNBYmksIHVuaXZlcnNhbFJlc29sdmVyRXJyb3JzLCB1bml2ZXJzYWxSZXNvbHZlclJlc29sdmVBYmksIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSwgdGV4dFJlc29sdmVyQWJpLCBhZGRyZXNzUmVzb2x2ZXJBYmksIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwgZXJjMjBBYmksIGVyYzIwQWJpX2J5dGVzMzIsIGVyYzcyMUFiaSwgZXJjNDYyNkFiaTsKICB2YXIgaW5pdF9hYmlzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWJpcy5qcyIoKSB7CiAgICAgIG11bHRpY2FsbDNBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJ0YXJnZXQiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJhbGxvd0ZhaWx1cmUiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJjYWxsRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJjYWxscyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiYWdncmVnYXRlMyIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJyZXR1cm5EYXRhIiwKICAgICAgICAgICAgICB0eXBlOiAidHVwbGVbXSIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJFcnJvcnMgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG5hbWU6ICJSZXNvbHZlck5vdEZvdW5kIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBuYW1lOiAiUmVzb2x2ZXJXaWxkY2FyZE5vdFN1cHBvcnRlZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyTm90Q29udHJhY3QiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyRXJyb3IiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdGF0dXMiLAogICAgICAgICAgICAgICAgICB0eXBlOiAidWludDE2IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbmFtZTogIm1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgbmFtZTogImVycm9ycyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiSHR0cEVycm9yIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmVzb2x2ZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlcyIgfSwKICAgICAgICAgICAgeyBuYW1lOiAiZGF0YSIsIHR5cGU6ICJieXRlcyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJyZXNvbHZlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7IG5hbWU6ICJuYW1lIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJkYXRhIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJnYXRld2F5cyIsIHR5cGU6ICJzdHJpbmdbXSIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmV2ZXJzZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJyZXZlcnNlTmFtZSIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJyZXNvbHZlZE5hbWUiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmVzb2x2ZWRBZGRyZXNzIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJldmVyc2VSZXNvbHZlciIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlciIgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogInJldmVyc2UiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogImJ5dGVzIiwgbmFtZTogInJldmVyc2VOYW1lIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJzdHJpbmdbXSIsIG5hbWU6ICJnYXRld2F5cyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInJlc29sdmVkTmFtZSIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlZEFkZHJlc3MiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmV2ZXJzZVJlc29sdmVyIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJlc29sdmVyIiB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICB0ZXh0UmVzb2x2ZXJBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInRleHQiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICAgICAgeyBuYW1lOiAia2V5IiwgdHlwZTogInN0cmluZyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgIH0KICAgICAgXTsKICAgICAgYWRkcmVzc1Jlc29sdmVyQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJhZGRyIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbeyBuYW1lOiAiIiwgdHlwZTogImFkZHJlc3MiIH1dCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiYWRkciIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJjb2luVHlwZSIsIHR5cGU6ICJ1aW50MjU2IiB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJieXRlcyIgfV0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiaXNWYWxpZFNpZyIKICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzIwQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic3ltYm9sIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXIiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICBlcmMyMEFiaV9ieXRlczMyID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJieXRlczMyIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYnl0ZXMzMiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0b3RhbFN1cHBseSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmVjaXBpZW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhbW91bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzcyMUFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZXZlbnQiLAogICAgICAgICAgbmFtZTogIkFwcHJvdmFsIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImV2ZW50IiwKICAgICAgICAgIG5hbWU6ICJBcHByb3ZhbEZvckFsbCIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm9wZXJhdG9yIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhcHByb3ZlZCIsCiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRva2VuSWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImFwcHJvdmUiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiZ2V0QXBwcm92ZWQiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImlzQXBwcm92ZWRGb3JBbGwiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAibmFtZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogIm93bmVyT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic2FmZVRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJwYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImZyb20iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNhZmVUcmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiaWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImRhdGEiLAogICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNldEFwcHJvdmFsRm9yQWxsIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFwcHJvdmVkIiwKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImluZGV4IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJpbmRleCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG9rZW5JZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG9rZW5VUkkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRva2VJZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbXQogICAgICAgIH0KICAgICAgXTsKICAgICAgZXJjNDYyNkFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiRGVwb3NpdCIsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiV2l0aGRyYXciLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImFsbG93YW5jZSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJhcHByb3ZlIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogImFzc2V0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldFRva2VuQWRkcmVzcyIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJjb252ZXJ0VG9Bc3NldHMiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiY29udmVydFRvU2hhcmVzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJkZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJjYWxsZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heERlcG9zaXQiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm1heEFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImNhbGxlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAibWF4TWludCIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFJlZGVlbSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFdpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJtYXhBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJtaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdEZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdNaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdSZWRlZW0iLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicHJldmlld1dpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicmVkZWVtIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsQXNzZXRzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b3RhbE1hbmFnZWRBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsU3VwcGx5IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiZnJvbSIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG8iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAid2l0aGRyYXciLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9CiAgICAgIF07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3QuanMKICB2YXIgYWdncmVnYXRlM1NpZ25hdHVyZTsKICB2YXIgaW5pdF9jb250cmFjdDIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9jb250cmFjdC5qcyIoKSB7CiAgICAgIGFnZ3JlZ2F0ZTNTaWduYXR1cmUgPSAiMHg4MmFkNTZjYiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3RzLmpzCiAgdmFyIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwgZGVwbG95bGVzc0NhbGxWaWFGYWN0b3J5Qnl0ZWNvZGUsIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckJ5dGVDb2RlOwogIHZhciBpbml0X2NvbnRyYWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2NvbnRyYWN0cy5qcyIoKSB7CiAgICAgIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDE4ZTM4MDM4MDYxMDE4ZTgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMTI0NTY1YjYwMDA4MDgzNTE2MDIwODUwMTYwMDBmNTkwNTA4MDNiNjEwMDQ4NTc2MDAwODBmZDViNjAwMDgwODM1MTYwMjA4NTAxNjAwMDg1NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDA2NzU3M2Q4MWZkNWIzZDgxZjM1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDgyNjAxZjgzMDExMjYxMDA5MjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMGFiNTc2MTAwYWI2MTAwNmI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTAwZDk1NzYxMDBkOTYxMDA2YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTAwZjE1NzYwMDA4MGZkNWI2MDAwNWI4MjgxMTAxNTYxMDExMDU3NjAyMDgxODYwMTgxMDE1MTgzODMwMTgyMDE1MjAxNjEwMGY0NTY1YjUwNjAwMDkxODEwMTYwMjAwMTkxOTA5MTUyOTM5MjUwNTA1MDU2NWI2MDAwODA2MDQwODM4NTAzMTIxNTYxMDEzNzU3NjAwMDgwZmQ1YjgyNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTRkNTc2MDAwODBmZDViNjEwMTU5ODU4Mjg2MDE2MTAwODE1NjViNjAyMDg1MDE1MTkwOTM1MDkwNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTc3NTc2MDAwODBmZDViNjEwMTgzODU4Mjg2MDE2MTAwODE1NjViOTE1MDUwOTI1MDkyOTA1MDU2ZmUiOwogICAgICBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDJjMDM4MDM4MDYxMDJjMDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMWU2NTY1YjgzNjAwMTYwMDE2MGEwMWIwMzE2M2I2MDAwMDM2MTAwZTQ1NzYwMDA4MDgzNjAwMTYwMDE2MGEwMWIwMzE2ODM2MDQwNTE2MTAwNWM5MTkwNjEwMjcwNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwOTk1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwOWU1NjViNjA2MDkxNTA1YjUwOTE1MDkxNTA4MTE1ODA2MTAwYjg1NzUwNjAwMTYwMDE2MGEwMWIwMzg2MTYzYjE1NWIxNTYxMDBlMTU3ODA2MDQwNTE2MzEwMWJiOThkNjBlMDFiODE1MjYwMDQwMTYxMDBkODkxOTA2MTAyOGM1NjViNjA0MDUxODA5MTAzOTBmZDViNTA1MDViNjAwMDgwODQ1MTYwMjA4NjAxNjAwMDg4NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDEwMzU3M2Q4MWZkNWIzZDgxZjM1YjgwNTE2MDAxNjAwMTYwYTAxYjAzODExNjgxMTQ2MTAxMWU1NzYwMDA4MGZkNWI5MTkwNTA1NjViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwNDE2MDA0NTI2MDI0NjAwMGZkNWI2MDAwNWI4MzgxMTAxNTYxMDE1NDU3ODE4MTAxNTE4MzgyMDE1MjYwMjAwMTYxMDEzYzU2NWI1MDUwNjAwMDkxMDE1MjU2NWI2MDAwODI2MDFmODMwMTEyNjEwMTZlNTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTAxODc1NzYxMDE4NzYxMDEyMzU2NWI2MDQwNTE2MDFmODIwMTYwMWYxOTkwODExNjYwM2YwMTE2ODEwMTYwMDE2MDAxNjA0MDFiMDM4MTExODI4MjEwMTcxNTYxMDFiNTU3NjEwMWI1NjEwMTIzNTY1YjYwNDA1MjgxODE1MjgzODIwMTYwMjAwMTg1MTAxNTYxMDFjZDU3NjAwMDgwZmQ1YjYxMDFkZTgyNjAyMDgzMDE2MDIwODcwMTYxMDEzOTU2NWI5NDkzNTA1MDUwNTA1NjViNjAwMDgwNjAwMDgwNjA4MDg1ODcwMzEyMTU2MTAxZmM1NzYwMDA4MGZkNWI2MTAyMDU4NTYxMDEwNzU2NWI2MDIwODYwMTUxOTA5NDUwNjAwMTYwMDE2MDQwMWIwMzgxMTExNTYxMDIyMTU3NjAwMDgwZmQ1YjYxMDIyZDg3ODI4ODAxNjEwMTVkNTY1YjkzNTA1MDYxMDIzYzYwNDA4NjAxNjEwMTA3NTY1YjYwNjA4NjAxNTE5MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMjU4NTc2MDAwODBmZDViNjEwMjY0ODc4Mjg4MDE2MTAxNWQ1NjViOTE1MDUwOTI5NTkxOTQ1MDkyNTA1NjViNjAwMDgyNTE2MTAyODI4MTg0NjAyMDg3MDE2MTAxMzk1NjViOTE5MDkxMDE5MjkxNTA1MDU2NWI2MDIwODE1MjYwMDA4MjUxODA2MDIwODQwMTUyNjEwMmFiODE2MDQwODUwMTYwMjA4NzAxNjEwMTM5NTY1YjYwMWYwMTYwMWYxOTE2OTE5MDkxMDE2MDQwMDE5MjkxNTA1MDU2ZmUiOwogICAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDY5NDM4MDM4MDYxMDY5NDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwNTFlNTY1YjYwMDA2MTAwM2M4NDg0ODQ2MTAwNDg1NjViOTA1MDgwNjAwMDUyNjAwMTYwMWZmMzViNjAwMDdmNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjYxMDA3NDgzNjEwNDBjNTY1YjAzNjEwMWU3NTc2MDAwNjA2MDgwODQ4MDYwMjAwMTkwNTE4MTAxOTA2MTAwOTI5MTkwNjEwNTc3NTY1YjYwNDA1MTkyOTU1MDkwOTM1MDkxNTA2MDAwOTA2MDAxNjAwMTYwYTAxYjAzODUxNjkwNjEwMGI2OTA4NTkwNjEwNWRkNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwZjM1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwZjg1NjViNjA2MDkxNTA1YjUwNTA5MDUwODc2MDAxNjAwMTYwYTAxYjAzMTYzYjYwMDAwMzYxMDE2MDU3ODA2MTAxNjA1NzYwNDA1MTYyNDYxYmNkNjBlNTFiODE1MjYwMjA2MDA0ODIwMTUyNjAxZTYwMjQ4MjAxNTI3ZjUzNjk2NzZlNjE3NDc1NzI2NTU2NjE2YzY5NjQ2MTc0NmY3MjNhMjA2NDY1NzA2YzZmNzk2ZDY1NmU3NDAwMDA2MDQ0ODIwMTUyNjA2NDAxNWI2MDQwNTE4MDkxMDM5MGZkNWI2MDQwNTE2MzBiMTM1ZDNmNjBlMTFiODA4MjUyOTA2MDAxNjAwMTYwYTAxYjAzOGExNjkwNjMxNjI2YmE3ZTkwNjEwMTkwOTA4YjkwODc5MDYwMDQwMTYxMDVmOTU2NWI2MDIwNjA0MDUxODA4MzAzODE4NjVhZmExNTgwMTU2MTAxYWQ1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNTA2MDQwNTEzZDYwMWYxOTYwMWY4MjAxMTY4MjAxODA2MDQwNTI1MDgxMDE5MDYxMDFkMTkxOTA2MTA2MzM1NjViNjAwMTYwMDE2MGUwMWIwMzE5MTYxNDk0NTA1MDUwNTA1MDYxMDQwNTU2NWI2MDAxNjAwMTYwYTAxYjAzODQxNjNiMTU2MTAyN2E1NzYwNDA1MTYzMGIxMzVkM2Y2MGUxMWI4MDgyNTI5MDYwMDE2MDAxNjBhMDFiMDM4NjE2OTA2MzE2MjZiYTdlOTA2MTAyMjc5MDg3OTA4NzkwNjAwNDAxNjEwNWY5NTY1YjYwMjA2MDQwNTE4MDgzMDM4MTg2NWFmYTE1ODAxNTYxMDI0NDU3M2Q2MDAwODAzZTNkNjAwMGZkNWI1MDUwNTA1MDYwNDA1MTNkNjAxZjE5NjAxZjgyMDExNjgyMDE4MDYwNDA1MjUwODEwMTkwNjEwMjY4OTE5MDYxMDYzMzU2NWI2MDAxNjAwMTYwZTAxYjAzMTkxNjE0OTA1MDYxMDQwNTU2NWI4MTUxNjA0MTE0NjEwMmRmNTc2MDQwNTE2MjQ2MWJjZDYwZTUxYjgxNTI2MDIwNjAwNDgyMDE1MjYwM2E2MDI0ODIwMTUyNjAwMDgwNTE2MDIwNjEwNjc0ODMzOTgxNTE5MTUyNjA0NDgyMDE1MjdmM2EyMDY5NmU3NjYxNmM2OTY0MjA3MzY5Njc2ZTYxNzQ3NTcyNjUyMDZjNjU2ZTY3NzQ2ODAwMDAwMDAwMDAwMDYwNjQ4MjAxNTI2MDg0MDE2MTAxNTc1NjViNjEwMmU3NjEwNDI1NTY1YjUwNjAyMDgyMDE1MTYwNDA4MDg0MDE1MTg0NTE4NTkzOTI2MDAwOTE4NTkxOTA4MTEwNjEwMzBjNTc2MTAzMGM2MTA2NWQ1NjViMDE2MDIwMDE1MTYwZjgxYzkwNTA2MDFiODExNDgwMTU5MDYxMDMyYjU3NTA4MDYwZmYxNjYwMWMxNDE1NWIxNTYxMDM4YzU3NjA0MDUxNjI0NjFiY2Q2MGU1MWI4MTUyNjAyMDYwMDQ4MjAxNTI2MDNiNjAyNDgyMDE1MjYwMDA4MDUxNjAyMDYxMDY3NDgzMzk4MTUxOTE1MjYwNDQ4MjAxNTI3ZjNhMjA2OTZlNzY2MTZjNjk2NDIwNzM2OTY3NmU2MTc0NzU3MjY1MjA3NjIwNzY2MTZjNzU2NTAwMDAwMDAwMDA2MDY0ODIwMTUyNjA4NDAxNjEwMTU3NTY1YjYwNDA4MDUxNjAwMDgxNTI2MDIwODEwMTgwODM1Mjg5OTA1MjYwZmY4MzE2OTE4MTAxOTE5MDkxNTI2MDYwODEwMTg0OTA1MjYwODA4MTAxODM5MDUyNjAwMTYwMDE2MGEwMWIwMzg5MTY5MDYwMDE5MDYwYTAwMTYwMjA2MDQwNTE2MDIwODEwMzkwODA4NDAzOTA4NTVhZmExNTgwMTU2MTAzZWE1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNjAyMDYwNDA1MTAzNTE2MDAxNjAwMTYwYTAxYjAzMTYxNDk0NTA1MDUwNTA1MDViOTM5MjUwNTA1MDU2NWI2MDAwNjAyMDgyNTExMDE1NjEwNDFkNTc2MDAwODBmZDViNTA4MDUxMDE1MTkwNTY1YjYwNDA1MTgwNjA2MDAxNjA0MDUyODA2MDAzOTA2MDIwODIwMjgwMzY4MzM3NTA5MTkyOTE1MDUwNTY1YjYwMDE2MDAxNjBhMDFiMDM4MTE2ODExNDYxMDQ1ODU3NjAwMDgwZmQ1YjUwNTY1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDViODM4MTEwMTU2MTA0OGM1NzgxODEwMTUxODM4MjAxNTI2MDIwMDE2MTA0NzQ1NjViNTA1MDYwMDA5MTAxNTI1NjViNjAwMDgyNjAxZjgzMDExMjYxMDRhNjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNGJmNTc2MTA0YmY2MTA0NWI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTA0ZWQ1NzYxMDRlZDYxMDQ1YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTA1MDU1NzYwMDA4MGZkNWI2MTA1MTY4MjYwMjA4MzAxNjAyMDg3MDE2MTA0NzE1NjViOTQ5MzUwNTA1MDUwNTY1YjYwMDA4MDYwMDA2MDYwODQ4NjAzMTIxNTYxMDUzMzU3NjAwMDgwZmQ1YjgzNTE2MTA1M2U4MTYxMDQ0MzU2NWI2MDIwODUwMTUxNjA0MDg2MDE1MTkxOTQ1MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNTYxNTc2MDAwODBmZDViNjEwNTZkODY4Mjg3MDE2MTA0OTU1NjViOTE1MDUwOTI1MDkyNTA5MjU2NWI2MDAwODA2MDAwNjA2MDg0ODYwMzEyMTU2MTA1OGM1NzYwMDA4MGZkNWI4MzUxNjEwNTk3ODE2MTA0NDM1NjViNjAyMDg1MDE1MTkwOTM1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1YjM1NzYwMDA4MGZkNWI2MTA1YmY4NjgyODcwMTYxMDQ5NTU2NWI2MDQwODYwMTUxOTA5MzUwOTA1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1NjE1NzYwMDA4MGZkNWI2MDAwODI1MTYxMDVlZjgxODQ2MDIwODcwMTYxMDQ3MTU2NWI5MTkwOTEwMTkyOTE1MDUwNTY1YjgyODE1MjYwNDA2MDIwODIwMTUyNjAwMDgyNTE4MDYwNDA4NDAxNTI2MTA2MWU4MTYwNjA4NTAxNjAyMDg3MDE2MTA0NzE1NjViNjAxZjAxNjAxZjE5MTY5MTkwOTEwMTYwNjAwMTkzOTI1MDUwNTA1NjViNjAwMDYwMjA4Mjg0MDMxMjE1NjEwNjQ1NTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjBlMDFiMDMxOTgxMTY4MTE0NjEwNDA1NTc2MDAwODBmZDViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwMzI2MDA0NTI2MDI0NjAwMGZkZmU1MzY5Njc2ZTYxNzQ3NTcyNjU1NjYxNmM2OTY0NjE3NDZmNzIyMzcyNjU2MzZmNzY2NTcyNTM2OTY3NmU2NTcyIjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jaGFpbi5qcwogIHZhciBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QsIENoYWluTWlzbWF0Y2hFcnJvciwgQ2hhaW5Ob3RGb3VuZEVycm9yLCBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvciwgSW52YWxpZENoYWluSWRFcnJvcjsKICB2YXIgaW5pdF9jaGFpbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NoYWluLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja051bWJlciwgY2hhaW4sIGNvbnRyYWN0IH0pIHsKICAgICAgICAgIHN1cGVyKGBDaGFpbiAiJHtjaGFpbi5uYW1lfSIgZG9lcyBub3Qgc3VwcG9ydCBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIuYCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiVGhpcyBjb3VsZCBiZSBkdWUgdG8gYW55IG9mIHRoZSBmb2xsb3dpbmc6IiwKICAgICAgICAgICAgICAuLi5ibG9ja051bWJlciAmJiBjb250cmFjdC5ibG9ja0NyZWF0ZWQgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkID4gYmxvY2tOdW1iZXIgPyBbCiAgICAgICAgICAgICAgICBgLSBUaGUgY29udHJhY3QgIiR7Y29udHJhY3QubmFtZX0iIHdhcyBub3QgZGVwbG95ZWQgdW50aWwgYmxvY2sgJHtjb250cmFjdC5ibG9ja0NyZWF0ZWR9IChjdXJyZW50IGJsb2NrICR7YmxvY2tOdW1iZXJ9KS5gCiAgICAgICAgICAgICAgXSA6IFsKICAgICAgICAgICAgICAgIGAtIFRoZSBjaGFpbiBkb2VzIG5vdCBoYXZlIHRoZSBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIgY29uZmlndXJlZC5gCiAgICAgICAgICAgICAgXQogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0IgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBDaGFpbk1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2hhaW4sIGN1cnJlbnRDaGFpbklkIH0pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgY3VycmVudCBjaGFpbiBvZiB0aGUgd2FsbGV0IChpZDogJHtjdXJyZW50Q2hhaW5JZH0pIGRvZXMgbm90IG1hdGNoIHRoZSB0YXJnZXQgY2hhaW4gZm9yIHRoZSB0cmFuc2FjdGlvbiAoaWQ6ICR7Y2hhaW4uaWR9IFx1MjAxMyAke2NoYWluLm5hbWV9KS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBDdXJyZW50IENoYWluIElEOiAgJHtjdXJyZW50Q2hhaW5JZH1gLAogICAgICAgICAgICAgIGBFeHBlY3RlZCBDaGFpbiBJRDogJHtjaGFpbi5pZH0gXHUyMDEzICR7Y2hhaW4ubmFtZX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDaGFpbk1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIENoYWluTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJObyBjaGFpbiB3YXMgcHJvdmlkZWQgdG8gdGhlIHJlcXVlc3QuIiwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgY2hhaW4gd2l0aCB0aGUgYGNoYWluYCBhcmd1bWVudCBvbiB0aGUgQWN0aW9uLCBvciBieSBzdXBwbHlpbmcgYSBgY2hhaW5gIHRvIFdhbGxldENsaWVudC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkNoYWluTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoIk5vIGNoYWluIHdhcyBwcm92aWRlZCB0byB0aGUgQ2xpZW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIkNsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQ2hhaW5JZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNoYWluSWQgfSkgewogICAgICAgICAgc3VwZXIodHlwZW9mIGNoYWluSWQgPT09ICJudW1iZXIiID8gYENoYWluIElEICIke2NoYWluSWR9IiBpcyBpbnZhbGlkLmAgOiAiQ2hhaW4gSUQgaXMgaW52YWxpZC4iLCB7IG5hbWU6ICJJbnZhbGlkQ2hhaW5JZEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRGVwbG95RGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gYnl0ZWNvZGU7CiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGFiaTIuZmluZCgoeCkgPT4gInR5cGUiIGluIHggJiYgeC50eXBlID09PSAiY29uc3RydWN0b3IiKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3Rvck5vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgaWYgKCEoImlucHV0cyIgaW4gZGVzY3JpcHRpb24pKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoNSB9KTsKICAgIGlmICghZGVzY3JpcHRpb24uaW5wdXRzIHx8IGRlc2NyaXB0aW9uLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgY29uc3QgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoZGVzY3JpcHRpb24uaW5wdXRzLCBhcmdzKTsKICAgIHJldHVybiBjb25jYXRIZXgoW2J5dGVjb2RlLCBkYXRhXSk7CiAgfQogIHZhciBkb2NzUGF0aDU7CiAgdmFyIGluaXRfZW5jb2RlRGVwbG95RGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZURlcGxveURhdGEuanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgZG9jc1BhdGg1ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZURlcGxveURhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMKICBmdW5jdGlvbiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7IGJsb2NrTnVtYmVyLCBjaGFpbiwgY29udHJhY3Q6IG5hbWUgfSkgewogICAgY29uc3QgY29udHJhY3QgPSBjaGFpbj8uY29udHJhY3RzPy5bbmFtZV07CiAgICBpZiAoIWNvbnRyYWN0KQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogeyBuYW1lIH0KICAgICAgfSk7CiAgICBpZiAoYmxvY2tOdW1iZXIgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkICYmIGNvbnRyYWN0LmJsb2NrQ3JlYXRlZCA+IGJsb2NrTnVtYmVyKQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogY29udHJhY3QuYmxvY2tDcmVhdGVkCiAgICAgICAgfQogICAgICB9KTsKICAgIHJldHVybiBjb250cmFjdC5hZGRyZXNzOwogIH0KICB2YXIgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMiKCkgewogICAgICBpbml0X2NoYWluKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q2FsbEVycm9yLmpzCiAgZnVuY3Rpb24gZ2V0Q2FsbEVycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBDYWxsRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQogIHZhciBpbml0X2dldENhbGxFcnJvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZXJyb3JzL2dldENhbGxFcnJvci5qcyIoKSB7CiAgICAgIGluaXRfY29udHJhY3QoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICAgIGluaXRfZ2V0Tm9kZUVycm9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMKICBmdW5jdGlvbiB3aXRoUmVzb2x2ZXJzKCkgewogICAgbGV0IHJlc29sdmUgPSAoKSA9PiB2b2lkIDA7CiAgICBsZXQgcmVqZWN0ID0gKCkgPT4gdm9pZCAwOwogICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlXywgcmVqZWN0XykgPT4gewogICAgICByZXNvbHZlID0gcmVzb2x2ZV87CiAgICAgIHJlamVjdCA9IHJlamVjdF87CiAgICB9KTsKICAgIHJldHVybiB7IHByb21pc2UsIHJlc29sdmUsIHJlamVjdCB9OwogIH0KICB2YXIgaW5pdF93aXRoUmVzb2x2ZXJzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS9jcmVhdGVCYXRjaFNjaGVkdWxlci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUJhdGNoU2NoZWR1bGVyKHsgZm4sIGlkLCBzaG91bGRTcGxpdEJhdGNoLCB3YWl0OiB3YWl0MiA9IDAsIHNvcnQgfSkgewogICAgY29uc3QgZXhlYyA9IGFzeW5jICgpID0+IHsKICAgICAgY29uc3Qgc2NoZWR1bGVyID0gZ2V0U2NoZWR1bGVyKCk7CiAgICAgIGZsdXNoKCk7CiAgICAgIGNvbnN0IGFyZ3MgPSBzY2hlZHVsZXIubWFwKCh7IGFyZ3M6IGFyZ3MyIH0pID0+IGFyZ3MyKTsKICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKQogICAgICAgIHJldHVybjsKICAgICAgZm4oYXJncykudGhlbigoZGF0YSkgPT4gewogICAgICAgIGlmIChzb3J0ICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpCiAgICAgICAgICBkYXRhLnNvcnQoc29ydCk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVzb2x2ZSB9ID0gc2NoZWR1bGVyW2ldOwogICAgICAgICAgcmVzb2x2ZT8uKFtkYXRhW2ldLCBkYXRhXSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVqZWN0IH0gPSBzY2hlZHVsZXJbaV07CiAgICAgICAgICByZWplY3Q/LihlcnIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgZmx1c2ggPSAoKSA9PiBzY2hlZHVsZXJDYWNoZS5kZWxldGUoaWQpOwogICAgY29uc3QgZ2V0QmF0Y2hlZEFyZ3MgPSAoKSA9PiBnZXRTY2hlZHVsZXIoKS5tYXAoKHsgYXJncyB9KSA9PiBhcmdzKTsKICAgIGNvbnN0IGdldFNjaGVkdWxlciA9ICgpID0+IHNjaGVkdWxlckNhY2hlLmdldChpZCkgfHwgW107CiAgICBjb25zdCBzZXRTY2hlZHVsZXIgPSAoaXRlbSkgPT4gc2NoZWR1bGVyQ2FjaGUuc2V0KGlkLCBbLi4uZ2V0U2NoZWR1bGVyKCksIGl0ZW1dKTsKICAgIHJldHVybiB7CiAgICAgIGZsdXNoLAogICAgICBhc3luYyBzY2hlZHVsZShhcmdzKSB7CiAgICAgICAgY29uc3QgeyBwcm9taXNlLCByZXNvbHZlLCByZWplY3QgfSA9IHdpdGhSZXNvbHZlcnMoKTsKICAgICAgICBjb25zdCBzcGxpdDIgPSBzaG91bGRTcGxpdEJhdGNoPy4oWy4uLmdldEJhdGNoZWRBcmdzKCksIGFyZ3NdKTsKICAgICAgICBpZiAoc3BsaXQyKQogICAgICAgICAgZXhlYygpOwogICAgICAgIGNvbnN0IGhhc0FjdGl2ZVNjaGVkdWxlciA9IGdldFNjaGVkdWxlcigpLmxlbmd0aCA+IDA7CiAgICAgICAgaWYgKGhhc0FjdGl2ZVNjaGVkdWxlcikgewogICAgICAgICAgc2V0U2NoZWR1bGVyKHsgYXJncywgcmVzb2x2ZSwgcmVqZWN0IH0pOwogICAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgICAgfQogICAgICAgIHNldFNjaGVkdWxlcih7IGFyZ3MsIHJlc29sdmUsIHJlamVjdCB9KTsKICAgICAgICBzZXRUaW1lb3V0KGV4ZWMsIHdhaXQyKTsKICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgfQogICAgfTsKICB9CiAgdmFyIHNjaGVkdWxlckNhY2hlOwogIHZhciBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL2NyZWF0ZUJhdGNoU2NoZWR1bGVyLmpzIigpIHsKICAgICAgaW5pdF93aXRoUmVzb2x2ZXJzKCk7CiAgICAgIHNjaGVkdWxlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzCiAgdmFyIE9mZmNoYWluTG9va3VwRXJyb3IsIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciwgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yOwogIHZhciBpbml0X2NjaXAgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzIigpIHsKICAgICAgaW5pdF9zdHJpbmdpZnkoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfdXRpbHMzKCk7CiAgICAgIE9mZmNoYWluTG9va3VwRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2FsbGJhY2tTZWxlY3RvciwgY2F1c2UsIGRhdGEsIGV4dHJhRGF0YSwgc2VuZGVyLCB1cmxzIH0pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgZm9yIGFuIG9mZmNoYWluIHJlc3VsdC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgfHwgW10sCiAgICAgICAgICAgICAgY2F1c2UubWV0YU1lc3NhZ2VzPy5sZW5ndGggPyAiIiA6IFtdLAogICAgICAgICAgICAgICJPZmZjaGFpbiBHYXRld2F5IENhbGw6IiwKICAgICAgICAgICAgICB1cmxzICYmIFsKICAgICAgICAgICAgICAgICIgIEdhdGV3YXkgVVJMKHMpOiIsCiAgICAgICAgICAgICAgICAuLi51cmxzLm1hcCgodXJsKSA9PiBgICAgICR7Z2V0VXJsKHVybCl9YCkKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGAgIFNlbmRlcjogJHtzZW5kZXJ9YCwKICAgICAgICAgICAgICBgICBEYXRhOiAke2RhdGF9YCwKICAgICAgICAgICAgICBgICBDYWxsYmFjayBzZWxlY3RvcjogJHtjYWxsYmFja1NlbGVjdG9yfWAsCiAgICAgICAgICAgICAgYCAgRXh0cmEgZGF0YTogJHtleHRyYURhdGF9YAogICAgICAgICAgICBdLmZsYXQoKSwKICAgICAgICAgICAgbmFtZTogIk9mZmNoYWluTG9va3VwRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyByZXN1bHQsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiT2ZmY2hhaW4gZ2F0ZXdheSByZXNwb25zZSBpcyBtYWxmb3JtZWQuIFJlc3BvbnNlIGRhdGEgbXVzdCBiZSBhIGhleCB2YWx1ZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBHYXRld2F5IFVSTDogJHtnZXRVcmwodXJsKX1gLAogICAgICAgICAgICAgIGBSZXNwb25zZTogJHtzdHJpbmdpZnkocmVzdWx0KX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cFJlc3BvbnNlTWFsZm9ybWVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwU2VuZGVyTWlzbWF0Y2hFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzZW5kZXIsIHRvIH0pIHsKICAgICAgICAgIHN1cGVyKCJSZXZlcnRlZCBzZW5kZXIgYWRkcmVzcyBkb2VzIG5vdCBtYXRjaCB0YXJnZXQgY29udHJhY3QgYWRkcmVzcyAoYHRvYCkuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgQ29udHJhY3QgYWRkcmVzczogJHt0b31gLAogICAgICAgICAgICAgIGBPZmZjaGFpbkxvb2t1cCBzZW5kZXIgYWRkcmVzczogJHtzZW5kZXJ9YAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcwogIHZhciBjY2lwX2V4cG9ydHMgPSB7fTsKICBfX2V4cG9ydChjY2lwX2V4cG9ydHMsIHsKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlCiAgfSk7CiAgYXN5bmMgZnVuY3Rpb24gb2ZmY2hhaW5Mb29rdXAoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgdG8gfSkgewogICAgY29uc3QgeyBhcmdzIH0gPSBkZWNvZGVFcnJvclJlc3VsdCh7CiAgICAgIGRhdGEsCiAgICAgIGFiaTogW29mZmNoYWluTG9va3VwQWJpSXRlbV0KICAgIH0pOwogICAgY29uc3QgW3NlbmRlciwgdXJscywgY2FsbERhdGEsIGNhbGxiYWNrU2VsZWN0b3IsIGV4dHJhRGF0YV0gPSBhcmdzOwogICAgY29uc3QgeyBjY2lwUmVhZCB9ID0gY2xpZW50OwogICAgY29uc3QgY2NpcFJlcXVlc3RfID0gY2NpcFJlYWQgJiYgdHlwZW9mIGNjaXBSZWFkPy5yZXF1ZXN0ID09PSAiZnVuY3Rpb24iID8gY2NpcFJlYWQucmVxdWVzdCA6IGNjaXBSZXF1ZXN0OwogICAgdHJ5IHsKICAgICAgaWYgKCFpc0FkZHJlc3NFcXVhbCh0bywgc2VuZGVyKSkKICAgICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yKHsgc2VuZGVyLCB0byB9KTsKICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2NpcFJlcXVlc3RfKHsgZGF0YTogY2FsbERhdGEsIHNlbmRlciwgdXJscyB9KTsKICAgICAgY29uc3QgeyBkYXRhOiBkYXRhXyB9ID0gYXdhaXQgY2FsbChjbGllbnQsIHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZywKICAgICAgICBkYXRhOiBjb25jYXQoWwogICAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFtyZXN1bHQsIGV4dHJhRGF0YV0pCiAgICAgICAgXSksCiAgICAgICAgdG8KICAgICAgfSk7CiAgICAgIHJldHVybiBkYXRhXzsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBFcnJvcih7CiAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIGRhdGEsCiAgICAgICAgZXh0cmFEYXRhLAogICAgICAgIHNlbmRlciwKICAgICAgICB1cmxzCiAgICAgIH0pOwogICAgfQogIH0KICBhc3luYyBmdW5jdGlvbiBjY2lwUmVxdWVzdCh7IGRhdGEsIHNlbmRlciwgdXJscyB9KSB7CiAgICBsZXQgZXJyb3IgPSBuZXcgRXJyb3IoIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVybHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgdXJsID0gdXJsc1tpXTsKICAgICAgY29uc3QgbWV0aG9kID0gdXJsLmluY2x1ZGVzKCJ7ZGF0YX0iKSA/ICJHRVQiIDogIlBPU1QiOwogICAgICBjb25zdCBib2R5ID0gbWV0aG9kID09PSAiUE9TVCIgPyB7IGRhdGEsIHNlbmRlciB9IDogdm9pZCAwOwogICAgICBjb25zdCBoZWFkZXJzID0gbWV0aG9kID09PSAiUE9TVCIgPyB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSA6IHt9OwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLnJlcGxhY2UoIntzZW5kZXJ9Iiwgc2VuZGVyKS5yZXBsYWNlKCJ7ZGF0YX0iLCBkYXRhKSwgewogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgbWV0aG9kCiAgICAgICAgfSk7CiAgICAgICAgbGV0IHJlc3VsdDsKICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpIHsKICAgICAgICAgIHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpLmRhdGE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgZXJyb3IgPSBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgIGRldGFpbHM6IHJlc3VsdD8uZXJyb3IgPyBzdHJpbmdpZnkocmVzdWx0LmVycm9yKSA6IHJlc3BvbnNlLnN0YXR1c1RleHQsCiAgICAgICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMsCiAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICghaXNIZXgocmVzdWx0KSkgewogICAgICAgICAgZXJyb3IgPSBuZXcgT2ZmY2hhaW5Mb29rdXBSZXNwb25zZU1hbGZvcm1lZEVycm9yKHsKICAgICAgICAgICAgcmVzdWx0LAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGVycm9yID0gbmV3IEh0dHBSZXF1ZXN0RXJyb3IoewogICAgICAgICAgYm9keSwKICAgICAgICAgIGRldGFpbHM6IGVyci5tZXNzYWdlLAogICAgICAgICAgdXJsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIHRocm93IGVycm9yOwogIH0KICB2YXIgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmUsIG9mZmNoYWluTG9va3VwQWJpSXRlbTsKICB2YXIgaW5pdF9jY2lwMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcyIoKSB7CiAgICAgIGluaXRfY2FsbCgpOwogICAgICBpbml0X2NjaXAoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIGluaXRfZGVjb2RlRXJyb3JSZXN1bHQoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICAgICAgaW5pdF9jb25jYXQoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgICBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZSA9ICIweDU1NmYxODMwIjsKICAgICAgb2ZmY2hhaW5Mb29rdXBBYmlJdGVtID0gewogICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cCIsCiAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInVybHMiLAogICAgICAgICAgICB0eXBlOiAic3RyaW5nW10iCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbERhdGEiLAogICAgICAgICAgICB0eXBlOiAiYnl0ZXMiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbGJhY2tGdW5jdGlvbiIsCiAgICAgICAgICAgIHR5cGU6ICJieXRlczQiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiZXh0cmFEYXRhIiwKICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NhbGwuanMKICBhc3luYyBmdW5jdGlvbiBjYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBiYXRjaCA9IEJvb2xlYW4oY2xpZW50LmJhdGNoPy5tdWx0aWNhbGwpLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYWNjZXNzTGlzdCwgYmxvYnMsIGNvZGUsIGRhdGE6IGRhdGFfLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSwgLi4ucmVzdCB9ID0gYXJnczsKICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50XyA/IHBhcnNlQWNjb3VudChhY2NvdW50XykgOiB2b2lkIDA7CiAgICBpZiAoY29kZSAmJiAoZmFjdG9yeSB8fCBmYWN0b3J5RGF0YSkpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJDYW5ub3QgcHJvdmlkZSBib3RoIGBjb2RlYCAmIGBmYWN0b3J5YC9gZmFjdG9yeURhdGFgIGFzIHBhcmFtZXRlcnMuIik7CiAgICBpZiAoY29kZSAmJiB0bykKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkNhbm5vdCBwcm92aWRlIGJvdGggYGNvZGVgICYgYHRvYCBhcyBwYXJhbWV0ZXJzLiIpOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSA9IGNvZGUgJiYgZGF0YV87CiAgICBjb25zdCBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnkgPSBmYWN0b3J5ICYmIGZhY3RvcnlEYXRhICYmIHRvICYmIGRhdGFfOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGwgPSBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlIHx8IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeTsKICAgIGNvbnN0IGRhdGEgPSAoKCkgPT4gewogICAgICBpZiAoZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlRGF0YSh7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgZGF0YTogZGF0YV8KICAgICAgICB9KTsKICAgICAgaWYgKGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHsKICAgICAgICAgIGRhdGE6IGRhdGFfLAogICAgICAgICAgZmFjdG9yeSwKICAgICAgICAgIGZhY3RvcnlEYXRhLAogICAgICAgICAgdG8KICAgICAgICB9KTsKICAgICAgcmV0dXJuIGRhdGFfOwogICAgfSkoKTsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWc7CiAgICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpOwogICAgICBjb25zdCBjaGFpbkZvcm1hdCA9IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVycz8udHJhbnNhY3Rpb25SZXF1ZXN0Py5mb3JtYXQ7CiAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgICAgLy8gUGljayBvdXQgZXh0cmEgZGF0YSB0aGF0IG1pZ2h0IGV4aXN0IG9uIHRoZSBjaGFpbidzIHRyYW5zYWN0aW9uIHJlcXVlc3QgdHlwZS4KICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgYmxvYnMsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgbm9uY2UsCiAgICAgICAgdG86IGRlcGxveWxlc3NDYWxsID8gdm9pZCAwIDogdG8sCiAgICAgICAgdmFsdWUKICAgICAgfSk7CiAgICAgIGlmIChiYXRjaCAmJiBzaG91bGRQZXJmb3JtTXVsdGljYWxsKHsgcmVxdWVzdCB9KSAmJiAhcnBjU3RhdGVPdmVycmlkZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgc2NoZWR1bGVNdWx0aWNhbGwoY2xpZW50LCB7CiAgICAgICAgICAgIC4uLnJlcXVlc3QsCiAgICAgICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgICAgICBibG9ja1RhZwogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcikgJiYgIShlcnIgaW5zdGFuY2VvZiBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QpKQogICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUgPyBbCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgYmxvY2ssCiAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgXSA6IFtyZXF1ZXN0LCBibG9ja10KICAgICAgfSk7CiAgICAgIGlmIChyZXNwb25zZSA9PT0gIjB4IikKICAgICAgICByZXR1cm4geyBkYXRhOiB2b2lkIDAgfTsKICAgICAgcmV0dXJuIHsgZGF0YTogcmVzcG9uc2UgfTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBjb25zdCBkYXRhMiA9IGdldFJldmVydEVycm9yRGF0YShlcnIpOwogICAgICBjb25zdCB7IG9mZmNoYWluTG9va3VwOiBvZmZjaGFpbkxvb2t1cDIsIG9mZmNoYWluTG9va3VwU2lnbmF0dXJlOiBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZTIgfSA9IGF3YWl0IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gKGluaXRfY2NpcDIoKSwgY2NpcF9leHBvcnRzKSk7CiAgICAgIGlmIChjbGllbnQuY2NpcFJlYWQgIT09IGZhbHNlICYmIGRhdGEyPy5zbGljZSgwLCAxMCkgPT09IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlMiAmJiB0bykKICAgICAgICByZXR1cm4geyBkYXRhOiBhd2FpdCBvZmZjaGFpbkxvb2t1cDIoY2xpZW50LCB7IGRhdGE6IGRhdGEyLCB0byB9KSB9OwogICAgICBpZiAoZGVwbG95bGVzc0NhbGwgJiYgZGF0YTI/LnNsaWNlKDAsIDEwKSA9PT0gIjB4MTAxYmI5OGQiKQogICAgICAgIHRocm93IG5ldyBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcih7IGZhY3RvcnkgfSk7CiAgICAgIHRocm93IGdldENhbGxFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2hvdWxkUGVyZm9ybU11bHRpY2FsbCh7IHJlcXVlc3QgfSkgewogICAgY29uc3QgeyBkYXRhLCB0bywgLi4ucmVxdWVzdF8gfSA9IHJlcXVlc3Q7CiAgICBpZiAoIWRhdGEpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChkYXRhLnN0YXJ0c1dpdGgoYWdncmVnYXRlM1NpZ25hdHVyZSkpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICghdG8pCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChPYmplY3QudmFsdWVzKHJlcXVlc3RfKS5maWx0ZXIoKHgpID0+IHR5cGVvZiB4ICE9PSAidW5kZWZpbmVkIikubGVuZ3RoID4gMCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlTXVsdGljYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBiYXRjaFNpemUgPSAxMDI0LCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBjbGllbnQuYmF0Y2g/Lm11bHRpY2FsbCA9PT0gIm9iamVjdCIgPyBjbGllbnQuYmF0Y2gubXVsdGljYWxsIDoge307CiAgICBjb25zdCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCBkYXRhLCBtdWx0aWNhbGxBZGRyZXNzOiBtdWx0aWNhbGxBZGRyZXNzXywgdG8gfSA9IGFyZ3M7CiAgICBsZXQgbXVsdGljYWxsQWRkcmVzcyA9IG11bHRpY2FsbEFkZHJlc3NfOwogICAgaWYgKCFtdWx0aWNhbGxBZGRyZXNzKSB7CiAgICAgIGlmICghY2xpZW50LmNoYWluKQogICAgICAgIHRocm93IG5ldyBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcigpOwogICAgICBtdWx0aWNhbGxBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJtdWx0aWNhbGwzIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7Y2xpZW50LnVpZH0uJHtibG9ja31gLAogICAgICB3YWl0OiB3YWl0MiwKICAgICAgc2hvdWxkU3BsaXRCYXRjaChhcmdzMikgewogICAgICAgIGNvbnN0IHNpemUzID0gYXJnczIucmVkdWNlKChzaXplNCwgeyBkYXRhOiBkYXRhMiB9KSA9PiBzaXplNCArIChkYXRhMi5sZW5ndGggLSAyKSwgMCk7CiAgICAgICAgcmV0dXJuIHNpemUzID4gYmF0Y2hTaXplICogMjsKICAgICAgfSwKICAgICAgZm46IGFzeW5jIChyZXF1ZXN0cykgPT4gewogICAgICAgIGNvbnN0IGNhbGxzID0gcmVxdWVzdHMubWFwKChyZXF1ZXN0KSA9PiAoewogICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgY2FsbERhdGE6IHJlcXVlc3QuZGF0YSwKICAgICAgICAgIHRhcmdldDogcmVxdWVzdC50bwogICAgICAgIH0pKTsKICAgICAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IG11bHRpY2FsbDNBYmksCiAgICAgICAgICBhcmdzOiBbY2FsbHNdLAogICAgICAgICAgZnVuY3Rpb25OYW1lOiAiYWdncmVnYXRlMyIKICAgICAgICB9KTsKICAgICAgICBjb25zdCBkYXRhMiA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICAgIHBhcmFtczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGF0YTogY2FsbGRhdGEsCiAgICAgICAgICAgICAgdG86IG11bHRpY2FsbEFkZHJlc3MKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYmxvY2sKICAgICAgICAgIF0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZGVjb2RlRnVuY3Rpb25SZXN1bHQoewogICAgICAgICAgYWJpOiBtdWx0aWNhbGwzQWJpLAogICAgICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImFnZ3JlZ2F0ZTMiLAogICAgICAgICAgZGF0YTogZGF0YTIgfHwgIjB4IgogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFt7IHJldHVybkRhdGEsIHN1Y2Nlc3MgfV0gPSBhd2FpdCBzY2hlZHVsZSh7IGRhdGEsIHRvIH0pOwogICAgaWYgKCFzdWNjZXNzKQogICAgICB0aHJvdyBuZXcgUmF3Q29udHJhY3RFcnJvcih7IGRhdGE6IHJldHVybkRhdGEgfSk7CiAgICBpZiAocmV0dXJuRGF0YSA9PT0gIjB4IikKICAgICAgcmV0dXJuIHsgZGF0YTogdm9pZCAwIH07CiAgICByZXR1cm4geyBkYXRhOiByZXR1cm5EYXRhIH07CiAgfQogIGZ1bmN0aW9uIHRvRGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYnl0ZXMsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgICAgYXJnczogW2NvZGUsIGRhdGFdCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHRvIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYWRkcmVzcywgYnl0ZXMsIGFkZHJlc3MsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlLAogICAgICBhcmdzOiBbdG8sIGRhdGEsIGZhY3RvcnksIGZhY3RvcnlEYXRhXQogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGdldFJldmVydEVycm9yRGF0YShlcnIpIHsKICAgIGlmICghKGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIpKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgY29uc3QgZXJyb3IgPSBlcnIud2FsaygpOwogICAgcmV0dXJuIHR5cGVvZiBlcnJvcj8uZGF0YSA9PT0gIm9iamVjdCIgPyBlcnJvci5kYXRhPy5kYXRhIDogZXJyb3IuZGF0YTsKICB9CiAgdmFyIGluaXRfY2FsbCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY2FsbC5qcyIoKSB7CiAgICAgIGluaXRfZXhwb3J0cygpOwogICAgICBpbml0X3BhcnNlQWNjb3VudCgpOwogICAgICBpbml0X2FiaXMoKTsKICAgICAgaW5pdF9jb250cmFjdDIoKTsKICAgICAgaW5pdF9jb250cmFjdHMoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfY2hhaW4oKTsKICAgICAgaW5pdF9jb250cmFjdCgpOwogICAgICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgICAgIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogICAgICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogICAgICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9nZXRDYWxsRXJyb3IoKTsKICAgICAgaW5pdF9leHRyYWN0KCk7CiAgICAgIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CiAgICAgIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKICAgICAgaW5pdF9zdGF0ZU92ZXJyaWRlMigpOwogICAgICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0TmF0aXZlV2ViU29ja2V0KCkgewogICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gV2ViU29ja2V0OwogICAgaWYgKHR5cGVvZiBnbG9iYWwuV2ViU29ja2V0ICE9PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIGdsb2JhbC5XZWJTb2NrZXQ7CiAgICBpZiAodHlwZW9mIHdpbmRvdy5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gd2luZG93LldlYlNvY2tldDsKICAgIGlmICh0eXBlb2Ygc2VsZi5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gc2VsZi5XZWJTb2NrZXQ7CiAgICB0aHJvdyBuZXcgRXJyb3IoImBXZWJTb2NrZXRgIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudCIpOwogIH0KICB2YXIgaW5pdF91dGlsczUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcwogIHZhciBuYXRpdmVfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KG5hdGl2ZV9leHBvcnRzLCB7CiAgICBXZWJTb2NrZXQ6ICgpID0+IFdlYlNvY2tldDIKICB9KTsKICB2YXIgV2ViU29ja2V0MjsKICB2YXIgaW5pdF9uYXRpdmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcyIoKSB7CiAgICAgIGluaXRfdXRpbHM1KCk7CiAgICAgIFdlYlNvY2tldDIgPSBnZXROYXRpdmVXZWJTb2NrZXQoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgdmFyIGVzbV9leHBvcnRzID0ge307CiAgX19leHBvcnQoZXNtX2V4cG9ydHMsIHsKICAgIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yLAogICAgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IsCiAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLAogICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3I6ICgpID0+IEFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yLAogICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IsCiAgICBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IsCiAgICBBYmlFbmNvZGluZ0J5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciwKICAgIEFiaUVuY29kaW5nTGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yLAogICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFcnJvcklucHV0c05vdEZvdW5kRXJyb3IsCiAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3I6ICgpID0+IEFiaUVycm9yTm90Rm91bmRFcnJvciwKICAgIEFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRXZlbnROb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFdmVudE5vdEZvdW5kRXJyb3IsCiAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3I6ICgpID0+IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwKICAgIEFiaUV2ZW50U2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsCiAgICBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yOiAoKSA9PiBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yLAogICAgQmFzZUVycm9yOiAoKSA9PiBCYXNlRXJyb3IyLAogICAgQmFzZUZlZVNjYWxhckVycm9yOiAoKSA9PiBCYXNlRmVlU2NhbGFyRXJyb3IsCiAgICBCbG9ja05vdEZvdW5kRXJyb3I6ICgpID0+IEJsb2NrTm90Rm91bmRFcnJvciwKICAgIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsCiAgICBDYWxsRXhlY3V0aW9uRXJyb3I6ICgpID0+IENhbGxFeGVjdXRpb25FcnJvciwKICAgIENoYWluRGlzY29ubmVjdGVkRXJyb3I6ICgpID0+IENoYWluRGlzY29ubmVjdGVkRXJyb3IsCiAgICBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3Q6ICgpID0+IENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCwKICAgIENoYWluTWlzbWF0Y2hFcnJvcjogKCkgPT4gQ2hhaW5NaXNtYXRjaEVycm9yLAogICAgQ2hhaW5Ob3RGb3VuZEVycm9yOiAoKSA9PiBDaGFpbk5vdEZvdW5kRXJyb3IsCiAgICBDaXJjdWxhclJlZmVyZW5jZUVycm9yOiAoKSA9PiBDaXJjdWxhclJlZmVyZW5jZUVycm9yLAogICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3I6ICgpID0+IENsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yLAogICAgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IsCiAgICBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcjogKCkgPT4gQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IsCiAgICBEZWNvZGVMb2dEYXRhTWlzbWF0Y2g6ICgpID0+IERlY29kZUxvZ0RhdGFNaXNtYXRjaCwKICAgIERlY29kZUxvZ1RvcGljc01pc21hdGNoOiAoKSA9PiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCwKICAgIEVJUDExOTNQcm92aWRlclJwY0Vycm9yOiAoKSA9PiBQcm92aWRlclJwY0Vycm9yMiwKICAgIEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3I6ICgpID0+IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IsCiAgICBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3I6ICgpID0+IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvciwKICAgIEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3I6ICgpID0+IEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3IsCiAgICBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3I6ICgpID0+IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvciwKICAgIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3I6ICgpID0+IEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IsCiAgICBFeGVjdXRpb25SZXZlcnRlZEVycm9yOiAoKSA9PiBFeGVjdXRpb25SZXZlcnRlZEVycm9yLAogICAgRmVlQ2FwVG9vSGlnaEVycm9yOiAoKSA9PiBGZWVDYXBUb29IaWdoRXJyb3IsCiAgICBGZWVDYXBUb29Mb3dFcnJvcjogKCkgPT4gRmVlQ2FwVG9vTG93RXJyb3IsCiAgICBGZWVDb25mbGljdEVycm9yOiAoKSA9PiBGZWVDb25mbGljdEVycm9yLAogICAgRmlsdGVyVHlwZU5vdFN1cHBvcnRlZEVycm9yOiAoKSA9PiBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBIdHRwUmVxdWVzdEVycm9yOiAoKSA9PiBIdHRwUmVxdWVzdEVycm9yLAogICAgSW5zdWZmaWNpZW50RnVuZHNFcnJvcjogKCkgPT4gSW5zdWZmaWNpZW50RnVuZHNFcnJvciwKICAgIEludGVnZXJPdXRPZlJhbmdlRXJyb3I6ICgpID0+IEludGVnZXJPdXRPZlJhbmdlRXJyb3IsCiAgICBJbnRlcm5hbFJwY0Vycm9yOiAoKSA9PiBJbnRlcm5hbFJwY0Vycm9yLAogICAgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yOiAoKSA9PiBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsCiAgICBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcjogKCkgPT4gSW50cmluc2ljR2FzVG9vTG93RXJyb3IsCiAgICBJbnZhbGlkQWJpRGVjb2RpbmdUeXBlRXJyb3I6ICgpID0+IEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciwKICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvcjogKCkgPT4gSW52YWxpZEFiaUVuY29kaW5nVHlwZUVycm9yLAogICAgSW52YWxpZEFiaUl0ZW1FcnJvcjogKCkgPT4gSW52YWxpZEFiaUl0ZW1FcnJvciwKICAgIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwKICAgIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I6ICgpID0+IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IsCiAgICBJbnZhbGlkQWRkcmVzc0Vycm9yOiAoKSA9PiBJbnZhbGlkQWRkcmVzc0Vycm9yLAogICAgSW52YWxpZEFycmF5RXJyb3I6ICgpID0+IEludmFsaWRBcnJheUVycm9yLAogICAgSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IsCiAgICBJbnZhbGlkQ2hhaW5JZEVycm9yOiAoKSA9PiBJbnZhbGlkQ2hhaW5JZEVycm9yLAogICAgSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvcjogKCkgPT4gSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvciwKICAgIEludmFsaWREZWZpbml0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciwKICAgIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3I6ICgpID0+IEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsCiAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yLAogICAgSW52YWxpZEhleFZhbHVlRXJyb3I6ICgpID0+IEludmFsaWRIZXhWYWx1ZUVycm9yLAogICAgSW52YWxpZElucHV0UnBjRXJyb3I6ICgpID0+IEludmFsaWRJbnB1dFJwY0Vycm9yLAogICAgSW52YWxpZExlZ2FjeVZFcnJvcjogKCkgPT4gSW52YWxpZExlZ2FjeVZFcnJvciwKICAgIEludmFsaWRNb2RpZmllckVycm9yOiAoKSA9PiBJbnZhbGlkTW9kaWZpZXJFcnJvciwKICAgIEludmFsaWRQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZFBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUGFyYW1zUnBjRXJyb3IsCiAgICBJbnZhbGlkUGFyZW50aGVzaXNFcnJvcjogKCkgPT4gSW52YWxpZFBhcmVudGhlc2lzRXJyb3IsCiAgICBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcjogKCkgPT4gSW52YWxpZFByaW1hcnlUeXBlRXJyb3IsCiAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLAogICAgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3I6ICgpID0+IEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLAogICAgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsCiAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLAogICAgSW52YWxpZFNpZ25hdHVyZUVycm9yOiAoKSA9PiBJbnZhbGlkU2lnbmF0dXJlRXJyb3IsCiAgICBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcjogKCkgPT4gSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IsCiAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciwKICAgIEludmFsaWRTdHJ1Y3RUeXBlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IsCiAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3I6ICgpID0+IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwKICAgIExpbWl0RXhjZWVkZWRScGNFcnJvcjogKCkgPT4gTGltaXRFeGNlZWRlZFJwY0Vycm9yLAogICAgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3I6ICgpID0+IE1heEZlZVBlckdhc1Rvb0xvd0Vycm9yLAogICAgTWV0aG9kTm90Rm91bmRScGNFcnJvcjogKCkgPT4gTWV0aG9kTm90Rm91bmRScGNFcnJvciwKICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yOiAoKSA9PiBNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwKICAgIE5vbmNlTWF4VmFsdWVFcnJvcjogKCkgPT4gTm9uY2VNYXhWYWx1ZUVycm9yLAogICAgTm9uY2VUb29IaWdoRXJyb3I6ICgpID0+IE5vbmNlVG9vSGlnaEVycm9yLAogICAgTm9uY2VUb29Mb3dFcnJvcjogKCkgPT4gTm9uY2VUb29Mb3dFcnJvciwKICAgIFBhcnNlUnBjRXJyb3I6ICgpID0+IFBhcnNlUnBjRXJyb3IsCiAgICBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yOiAoKSA9PiBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLAogICAgUHJvdmlkZXJScGNFcnJvcjogKCkgPT4gUHJvdmlkZXJScGNFcnJvciwKICAgIFJhd0NvbnRyYWN0RXJyb3I6ICgpID0+IFJhd0NvbnRyYWN0RXJyb3IsCiAgICBSZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3I6ICgpID0+IFJlc291cmNlTm90Rm91bmRScGNFcnJvciwKICAgIFJlc291cmNlVW5hdmFpbGFibGVScGNFcnJvcjogKCkgPT4gUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLAogICAgUnBjRXJyb3I6ICgpID0+IFJwY0Vycm9yLAogICAgUnBjUmVxdWVzdEVycm9yOiAoKSA9PiBScGNSZXF1ZXN0RXJyb3IsCiAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3I6ICgpID0+IFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwKICAgIFNpemVPdmVyZmxvd0Vycm9yOiAoKSA9PiBTaXplT3ZlcmZsb3dFcnJvciwKICAgIFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcjogKCkgPT4gU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yLAogICAgU29ja2V0Q2xvc2VkRXJyb3I6ICgpID0+IFNvY2tldENsb3NlZEVycm9yLAogICAgU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3I6ICgpID0+IFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yLAogICAgU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvcjogKCkgPT4gU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvciwKICAgIFN3aXRjaENoYWluRXJyb3I6ICgpID0+IFN3aXRjaENoYWluRXJyb3IsCiAgICBUaW1lb3V0RXJyb3I6ICgpID0+IFRpbWVvdXRFcnJvciwKICAgIFRpcEFib3ZlRmVlQ2FwRXJyb3I6ICgpID0+IFRpcEFib3ZlRmVlQ2FwRXJyb3IsCiAgICBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLAogICAgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yLAogICAgVHJhbnNhY3Rpb25SZWplY3RlZFJwY0Vycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsCiAgICBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvcjogKCkgPT4gVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yOiAoKSA9PiBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLAogICAgVW5rbm93bk5vZGVFcnJvcjogKCkgPT4gVW5rbm93bk5vZGVFcnJvciwKICAgIFVua25vd25ScGNFcnJvcjogKCkgPT4gVW5rbm93blJwY0Vycm9yLAogICAgVW5rbm93blNpZ25hdHVyZUVycm9yOiAoKSA9PiBVbmtub3duU2lnbmF0dXJlRXJyb3IsCiAgICBVbmtub3duVHlwZUVycm9yOiAoKSA9PiBVbmtub3duVHlwZUVycm9yLAogICAgVW5zdXBwb3J0ZWRQYWNrZWRBYmlUeXBlOiAoKSA9PiBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUsCiAgICBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3I6ICgpID0+IFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwKICAgIFVybFJlcXVpcmVkRXJyb3I6ICgpID0+IFVybFJlcXVpcmVkRXJyb3IsCiAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3I6ICgpID0+IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciwKICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I6ICgpID0+IFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IsCiAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3I6ICgpID0+IFdlYlNvY2tldFJlcXVlc3RFcnJvciwKICAgIGFzc2VydEN1cnJlbnRDaGFpbjogKCkgPT4gYXNzZXJ0Q3VycmVudENoYWluLAogICAgYXNzZXJ0UmVxdWVzdDogKCkgPT4gYXNzZXJ0UmVxdWVzdCwKICAgIGFzc2VydFRyYW5zYWN0aW9uRUlQMTU1OTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5LAogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAyOTMwOiAoKSA9PiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAsCiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3ksCiAgICBibG9ic1RvQ29tbWl0bWVudHM6ICgpID0+IGJsb2JzVG9Db21taXRtZW50cywKICAgIGJsb2JzVG9Qcm9vZnM6ICgpID0+IGJsb2JzVG9Qcm9vZnMsCiAgICBib29sVG9CeXRlczogKCkgPT4gYm9vbFRvQnl0ZXMsCiAgICBib29sVG9IZXg6ICgpID0+IGJvb2xUb0hleCwKICAgIGJ5dGVzVG9CaWdJbnQ6ICgpID0+IGJ5dGVzVG9CaWdJbnQsCiAgICBieXRlc1RvQm9vbDogKCkgPT4gYnl0ZXNUb0Jvb2wsCiAgICBieXRlc1RvSGV4OiAoKSA9PiBieXRlc1RvSGV4LAogICAgYnl0ZXNUb051bWJlcjogKCkgPT4gYnl0ZXNUb051bWJlciwKICAgIGJ5dGVzVG9SbHA6ICgpID0+IGJ5dGVzVG9SbHAsCiAgICBieXRlc1RvU3RyaW5nOiAoKSA9PiBieXRlc1RvU3RyaW5nLAogICAgY2NpcEZldGNoOiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNoZWNrc3VtQWRkcmVzczogKCkgPT4gY2hlY2tzdW1BZGRyZXNzLAogICAgY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaDogKCkgPT4gY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaCwKICAgIGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXM6ICgpID0+IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmU6ICgpID0+IGNvbXBhY3RTaWduYXR1cmVUb1NpZ25hdHVyZSwKICAgIGNvbmNhdDogKCkgPT4gY29uY2F0LAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMiwKICAgIGNvbmNhdEhleDogKCkgPT4gY29uY2F0SGV4LAogICAgY3JlYXRlQ2xpZW50OiAoKSA9PiBjcmVhdGVDbGllbnQsCiAgICBjcmVhdGVOb25jZU1hbmFnZXI6ICgpID0+IGNyZWF0ZU5vbmNlTWFuYWdlciwKICAgIGNyZWF0ZVB1YmxpY0NsaWVudDogKCkgPT4gY3JlYXRlUHVibGljQ2xpZW50LAogICAgY3JlYXRlVGVzdENsaWVudDogKCkgPT4gY3JlYXRlVGVzdENsaWVudCwKICAgIGNyZWF0ZVRyYW5zcG9ydDogKCkgPT4gY3JlYXRlVHJhbnNwb3J0LAogICAgY3JlYXRlV2FsbGV0Q2xpZW50OiAoKSA9PiBjcmVhdGVXYWxsZXRDbGllbnQsCiAgICBjdXN0b206ICgpID0+IGN1c3RvbSwKICAgIGRlY29kZUFiaVBhcmFtZXRlcnM6ICgpID0+IGRlY29kZUFiaVBhcmFtZXRlcnMsCiAgICBkZWNvZGVEZXBsb3lEYXRhOiAoKSA9PiBkZWNvZGVEZXBsb3lEYXRhLAogICAgZGVjb2RlRXJyb3JSZXN1bHQ6ICgpID0+IGRlY29kZUVycm9yUmVzdWx0LAogICAgZGVjb2RlRXZlbnRMb2c6ICgpID0+IGRlY29kZUV2ZW50TG9nLAogICAgZGVjb2RlRnVuY3Rpb25EYXRhOiAoKSA9PiBkZWNvZGVGdW5jdGlvbkRhdGEsCiAgICBkZWNvZGVGdW5jdGlvblJlc3VsdDogKCkgPT4gZGVjb2RlRnVuY3Rpb25SZXN1bHQsCiAgICBkZWZpbmVCbG9jazogKCkgPT4gZGVmaW5lQmxvY2ssCiAgICBkZWZpbmVDaGFpbjogKCkgPT4gZGVmaW5lQ2hhaW4sCiAgICBkZWZpbmVLemc6ICgpID0+IGRlZmluZUt6ZywKICAgIGRlZmluZVRyYW5zYWN0aW9uOiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvbiwKICAgIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZGVmaW5lVHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlQnl0ZWNvZGU6ICgpID0+IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgIGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlOiAoKSA9PiBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSwKICAgIGRvbWFpblNlcGFyYXRvcjogKCkgPT4gZG9tYWluU2VwYXJhdG9yLAogICAgZW5jb2RlQWJpUGFyYW1ldGVyczogKCkgPT4gZW5jb2RlQWJpUGFyYW1ldGVycywKICAgIGVuY29kZURlcGxveURhdGE6ICgpID0+IGVuY29kZURlcGxveURhdGEsCiAgICBlbmNvZGVFcnJvclJlc3VsdDogKCkgPT4gZW5jb2RlRXJyb3JSZXN1bHQsCiAgICBlbmNvZGVFdmVudFRvcGljczogKCkgPT4gZW5jb2RlRXZlbnRUb3BpY3MsCiAgICBlbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IGVuY29kZUZ1bmN0aW9uRGF0YSwKICAgIGVuY29kZUZ1bmN0aW9uUmVzdWx0OiAoKSA9PiBlbmNvZGVGdW5jdGlvblJlc3VsdCwKICAgIGVuY29kZVBhY2tlZDogKCkgPT4gZW5jb2RlUGFja2VkLAogICAgZXJjMjBBYmk6ICgpID0+IGVyYzIwQWJpLAogICAgZXJjMjBBYmlfYnl0ZXMzMjogKCkgPT4gZXJjMjBBYmlfYnl0ZXMzMiwKICAgIGVyYzQ2MjZBYmk6ICgpID0+IGVyYzQ2MjZBYmksCiAgICBlcmM3MjFBYmk6ICgpID0+IGVyYzcyMUFiaSwKICAgIGV0aGVyVW5pdHM6ICgpID0+IGV0aGVyVW5pdHMsCiAgICBleHRyYWN0Q2hhaW46ICgpID0+IGV4dHJhY3RDaGFpbiwKICAgIGZhbGxiYWNrOiAoKSA9PiBmYWxsYmFjaywKICAgIGZvcm1hdEJsb2NrOiAoKSA9PiBmb3JtYXRCbG9jaywKICAgIGZvcm1hdEV0aGVyOiAoKSA9PiBmb3JtYXRFdGhlciwKICAgIGZvcm1hdEd3ZWk6ICgpID0+IGZvcm1hdEd3ZWksCiAgICBmb3JtYXRMb2c6ICgpID0+IGZvcm1hdExvZywKICAgIGZvcm1hdFRyYW5zYWN0aW9uOiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvbiwKICAgIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZm9ybWF0VHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBmb3JtYXRVbml0czogKCkgPT4gZm9ybWF0VW5pdHMsCiAgICBmcm9tQmxvYnM6ICgpID0+IGZyb21CbG9icywKICAgIGZyb21CeXRlczogKCkgPT4gZnJvbUJ5dGVzLAogICAgZnJvbUhleDogKCkgPT4gZnJvbUhleCwKICAgIGZyb21SbHA6ICgpID0+IGZyb21SbHAsCiAgICBnZXRBYmlJdGVtOiAoKSA9PiBnZXRBYmlJdGVtLAogICAgZ2V0QWRkcmVzczogKCkgPT4gZ2V0QWRkcmVzcywKICAgIGdldENoYWluQ29udHJhY3RBZGRyZXNzOiAoKSA9PiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcywKICAgIGdldENvbnRyYWN0OiAoKSA9PiBnZXRDb250cmFjdCwKICAgIGdldENvbnRyYWN0QWRkcmVzczogKCkgPT4gZ2V0Q29udHJhY3RBZGRyZXNzMiwKICAgIGdldENvbnRyYWN0RXJyb3I6ICgpID0+IGdldENvbnRyYWN0RXJyb3IsCiAgICBnZXRDcmVhdGUyQWRkcmVzczogKCkgPT4gZ2V0Q3JlYXRlMkFkZHJlc3MsCiAgICBnZXRDcmVhdGVBZGRyZXNzOiAoKSA9PiBnZXRDcmVhdGVBZGRyZXNzLAogICAgZ2V0RXZlbnRTZWxlY3RvcjogKCkgPT4gdG9FdmVudFNlbGVjdG9yLAogICAgZ2V0RXZlbnRTaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0RnVuY3Rpb25TZWxlY3RvcjogKCkgPT4gdG9GdW5jdGlvblNlbGVjdG9yLAogICAgZ2V0RnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZSwKICAgIGdldFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0VHJhbnNhY3Rpb25UeXBlLAogICAgZ2V0VHlwZXNGb3JFSVA3MTJEb21haW46ICgpID0+IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluLAogICAgZ3dlaVVuaXRzOiAoKSA9PiBnd2VpVW5pdHMsCiAgICBoYXNoRG9tYWluOiAoKSA9PiBoYXNoRG9tYWluLAogICAgaGFzaE1lc3NhZ2U6ICgpID0+IGhhc2hNZXNzYWdlLAogICAgaGFzaFR5cGVkRGF0YTogKCkgPT4gaGFzaFR5cGVkRGF0YSwKICAgIGhleFRvQmlnSW50OiAoKSA9PiBoZXhUb0JpZ0ludCwKICAgIGhleFRvQm9vbDogKCkgPT4gaGV4VG9Cb29sLAogICAgaGV4VG9CeXRlczogKCkgPT4gaGV4VG9CeXRlcywKICAgIGhleFRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gcGFyc2VDb21wYWN0U2lnbmF0dXJlLAogICAgaGV4VG9OdW1iZXI6ICgpID0+IGhleFRvTnVtYmVyLAogICAgaGV4VG9SbHA6ICgpID0+IGhleFRvUmxwLAogICAgaGV4VG9TaWduYXR1cmU6ICgpID0+IHBhcnNlU2lnbmF0dXJlMiwKICAgIGhleFRvU3RyaW5nOiAoKSA9PiBoZXhUb1N0cmluZywKICAgIGh0dHA6ICgpID0+IGh0dHAsCiAgICBpc0FkZHJlc3M6ICgpID0+IGlzQWRkcmVzcywKICAgIGlzQWRkcmVzc0VxdWFsOiAoKSA9PiBpc0FkZHJlc3NFcXVhbCwKICAgIGlzQnl0ZXM6ICgpID0+IGlzQnl0ZXMzLAogICAgaXNFcmM2NDkyU2lnbmF0dXJlOiAoKSA9PiBpc0VyYzY0OTJTaWduYXR1cmUsCiAgICBpc0hhc2g6ICgpID0+IGlzSGFzaCwKICAgIGlzSGV4OiAoKSA9PiBpc0hleCwKICAgIGtlY2NhazI1NjogKCkgPT4ga2VjY2FrMjU2LAogICAgbGFiZWxoYXNoOiAoKSA9PiBsYWJlbGhhc2gsCiAgICBtYXhJbnQxMDQ6ICgpID0+IG1heEludDEwNCwKICAgIG1heEludDExMjogKCkgPT4gbWF4SW50MTEyLAogICAgbWF4SW50MTIwOiAoKSA9PiBtYXhJbnQxMjAsCiAgICBtYXhJbnQxMjg6ICgpID0+IG1heEludDEyOCwKICAgIG1heEludDEzNjogKCkgPT4gbWF4SW50MTM2LAogICAgbWF4SW50MTQ0OiAoKSA9PiBtYXhJbnQxNDQsCiAgICBtYXhJbnQxNTI6ICgpID0+IG1heEludDE1MiwKICAgIG1heEludDE2OiAoKSA9PiBtYXhJbnQxNiwKICAgIG1heEludDE2MDogKCkgPT4gbWF4SW50MTYwLAogICAgbWF4SW50MTY4OiAoKSA9PiBtYXhJbnQxNjgsCiAgICBtYXhJbnQxNzY6ICgpID0+IG1heEludDE3NiwKICAgIG1heEludDE4NDogKCkgPT4gbWF4SW50MTg0LAogICAgbWF4SW50MTkyOiAoKSA9PiBtYXhJbnQxOTIsCiAgICBtYXhJbnQyMDA6ICgpID0+IG1heEludDIwMCwKICAgIG1heEludDIwODogKCkgPT4gbWF4SW50MjA4LAogICAgbWF4SW50MjE2OiAoKSA9PiBtYXhJbnQyMTYsCiAgICBtYXhJbnQyMjQ6ICgpID0+IG1heEludDIyNCwKICAgIG1heEludDIzMjogKCkgPT4gbWF4SW50MjMyLAogICAgbWF4SW50MjQ6ICgpID0+IG1heEludDI0LAogICAgbWF4SW50MjQwOiAoKSA9PiBtYXhJbnQyNDAsCiAgICBtYXhJbnQyNDg6ICgpID0+IG1heEludDI0OCwKICAgIG1heEludDI1NjogKCkgPT4gbWF4SW50MjU2LAogICAgbWF4SW50MzI6ICgpID0+IG1heEludDMyLAogICAgbWF4SW50NDA6ICgpID0+IG1heEludDQwLAogICAgbWF4SW50NDg6ICgpID0+IG1heEludDQ4LAogICAgbWF4SW50NTY6ICgpID0+IG1heEludDU2LAogICAgbWF4SW50NjQ6ICgpID0+IG1heEludDY0LAogICAgbWF4SW50NzI6ICgpID0+IG1heEludDcyLAogICAgbWF4SW50ODogKCkgPT4gbWF4SW50OCwKICAgIG1heEludDgwOiAoKSA9PiBtYXhJbnQ4MCwKICAgIG1heEludDg4OiAoKSA9PiBtYXhJbnQ4OCwKICAgIG1heEludDk2OiAoKSA9PiBtYXhJbnQ5NiwKICAgIG1heFVpbnQxMDQ6ICgpID0+IG1heFVpbnQxMDQsCiAgICBtYXhVaW50MTEyOiAoKSA9PiBtYXhVaW50MTEyLAogICAgbWF4VWludDEyMDogKCkgPT4gbWF4VWludDEyMCwKICAgIG1heFVpbnQxMjg6ICgpID0+IG1heFVpbnQxMjgsCiAgICBtYXhVaW50MTM2OiAoKSA9PiBtYXhVaW50MTM2LAogICAgbWF4VWludDE0NDogKCkgPT4gbWF4VWludDE0NCwKICAgIG1heFVpbnQxNTI6ICgpID0+IG1heFVpbnQxNTIsCiAgICBtYXhVaW50MTY6ICgpID0+IG1heFVpbnQxNiwKICAgIG1heFVpbnQxNjA6ICgpID0+IG1heFVpbnQxNjAsCiAgICBtYXhVaW50MTY4OiAoKSA9PiBtYXhVaW50MTY4LAogICAgbWF4VWludDE3NjogKCkgPT4gbWF4VWludDE3NiwKICAgIG1heFVpbnQxODQ6ICgpID0+IG1heFVpbnQxODQsCiAgICBtYXhVaW50MTkyOiAoKSA9PiBtYXhVaW50MTkyLAogICAgbWF4VWludDIwMDogKCkgPT4gbWF4VWludDIwMCwKICAgIG1heFVpbnQyMDg6ICgpID0+IG1heFVpbnQyMDgsCiAgICBtYXhVaW50MjE2OiAoKSA9PiBtYXhVaW50MjE2LAogICAgbWF4VWludDIyNDogKCkgPT4gbWF4VWludDIyNCwKICAgIG1heFVpbnQyMzI6ICgpID0+IG1heFVpbnQyMzIsCiAgICBtYXhVaW50MjQ6ICgpID0+IG1heFVpbnQyNCwKICAgIG1heFVpbnQyNDA6ICgpID0+IG1heFVpbnQyNDAsCiAgICBtYXhVaW50MjQ4OiAoKSA9PiBtYXhVaW50MjQ4LAogICAgbWF4VWludDI1NjogKCkgPT4gbWF4VWludDI1NiwKICAgIG1heFVpbnQzMjogKCkgPT4gbWF4VWludDMyLAogICAgbWF4VWludDQwOiAoKSA9PiBtYXhVaW50NDAsCiAgICBtYXhVaW50NDg6ICgpID0+IG1heFVpbnQ0OCwKICAgIG1heFVpbnQ1NjogKCkgPT4gbWF4VWludDU2LAogICAgbWF4VWludDY0OiAoKSA9PiBtYXhVaW50NjQsCiAgICBtYXhVaW50NzI6ICgpID0+IG1heFVpbnQ3MiwKICAgIG1heFVpbnQ4OiAoKSA9PiBtYXhVaW50OCwKICAgIG1heFVpbnQ4MDogKCkgPT4gbWF4VWludDgwLAogICAgbWF4VWludDg4OiAoKSA9PiBtYXhVaW50ODgsCiAgICBtYXhVaW50OTY6ICgpID0+IG1heFVpbnQ5NiwKICAgIG1pbkludDEwNDogKCkgPT4gbWluSW50MTA0LAogICAgbWluSW50MTEyOiAoKSA9PiBtaW5JbnQxMTIsCiAgICBtaW5JbnQxMjA6ICgpID0+IG1pbkludDEyMCwKICAgIG1pbkludDEyODogKCkgPT4gbWluSW50MTI4LAogICAgbWluSW50MTM2OiAoKSA9PiBtaW5JbnQxMzYsCiAgICBtaW5JbnQxNDQ6ICgpID0+IG1pbkludDE0NCwKICAgIG1pbkludDE1MjogKCkgPT4gbWluSW50MTUyLAogICAgbWluSW50MTY6ICgpID0+IG1pbkludDE2LAogICAgbWluSW50MTYwOiAoKSA9PiBtaW5JbnQxNjAsCiAgICBtaW5JbnQxNjg6ICgpID0+IG1pbkludDE2OCwKICAgIG1pbkludDE3NjogKCkgPT4gbWluSW50MTc2LAogICAgbWluSW50MTg0OiAoKSA9PiBtaW5JbnQxODQsCiAgICBtaW5JbnQxOTI6ICgpID0+IG1pbkludDE5MiwKICAgIG1pbkludDIwMDogKCkgPT4gbWluSW50MjAwLAogICAgbWluSW50MjA4OiAoKSA9PiBtaW5JbnQyMDgsCiAgICBtaW5JbnQyMTY6ICgpID0+IG1pbkludDIxNiwKICAgIG1pbkludDIyNDogKCkgPT4gbWluSW50MjI0LAogICAgbWluSW50MjMyOiAoKSA9PiBtaW5JbnQyMzIsCiAgICBtaW5JbnQyNDogKCkgPT4gbWluSW50MjQsCiAgICBtaW5JbnQyNDA6ICgpID0+IG1pbkludDI0MCwKICAgIG1pbkludDI0ODogKCkgPT4gbWluSW50MjQ4LAogICAgbWluSW50MjU2OiAoKSA9PiBtaW5JbnQyNTYsCiAgICBtaW5JbnQzMjogKCkgPT4gbWluSW50MzIsCiAgICBtaW5JbnQ0MDogKCkgPT4gbWluSW50NDAsCiAgICBtaW5JbnQ0ODogKCkgPT4gbWluSW50NDgsCiAgICBtaW5JbnQ1NjogKCkgPT4gbWluSW50NTYsCiAgICBtaW5JbnQ2NDogKCkgPT4gbWluSW50NjQsCiAgICBtaW5JbnQ3MjogKCkgPT4gbWluSW50NzIsCiAgICBtaW5JbnQ4OiAoKSA9PiBtaW5JbnQ4LAogICAgbWluSW50ODA6ICgpID0+IG1pbkludDgwLAogICAgbWluSW50ODg6ICgpID0+IG1pbkludDg4LAogICAgbWluSW50OTY6ICgpID0+IG1pbkludDk2LAogICAgbXVsdGljYWxsM0FiaTogKCkgPT4gbXVsdGljYWxsM0FiaSwKICAgIG5hbWVoYXNoOiAoKSA9PiBuYW1laGFzaCwKICAgIG5vbmNlTWFuYWdlcjogKCkgPT4gbm9uY2VNYW5hZ2VyLAogICAgbnVtYmVyVG9CeXRlczogKCkgPT4gbnVtYmVyVG9CeXRlcywKICAgIG51bWJlclRvSGV4OiAoKSA9PiBudW1iZXJUb0hleCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlLAogICAgcGFkOiAoKSA9PiBwYWQsCiAgICBwYWRCeXRlczogKCkgPT4gcGFkQnl0ZXMsCiAgICBwYWRIZXg6ICgpID0+IHBhZEhleCwKICAgIHBhcnNlQWJpOiAoKSA9PiBwYXJzZUFiaSwKICAgIHBhcnNlQWJpSXRlbTogKCkgPT4gcGFyc2VBYmlJdGVtLAogICAgcGFyc2VBYmlQYXJhbWV0ZXI6ICgpID0+IHBhcnNlQWJpUGFyYW1ldGVyMiwKICAgIHBhcnNlQWJpUGFyYW1ldGVyczogKCkgPT4gcGFyc2VBYmlQYXJhbWV0ZXJzLAogICAgcGFyc2VDb21wYWN0U2lnbmF0dXJlOiAoKSA9PiBwYXJzZUNvbXBhY3RTaWduYXR1cmUsCiAgICBwYXJzZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHBhcnNlRXJjNjQ5MlNpZ25hdHVyZSwKICAgIHBhcnNlRXRoZXI6ICgpID0+IHBhcnNlRXRoZXIsCiAgICBwYXJzZUV2ZW50TG9nczogKCkgPT4gcGFyc2VFdmVudExvZ3MsCiAgICBwYXJzZUd3ZWk6ICgpID0+IHBhcnNlR3dlaSwKICAgIHBhcnNlU2lnbmF0dXJlOiAoKSA9PiBwYXJzZVNpZ25hdHVyZTIsCiAgICBwYXJzZVRyYW5zYWN0aW9uOiAoKSA9PiBwYXJzZVRyYW5zYWN0aW9uLAogICAgcGFyc2VVbml0czogKCkgPT4gcGFyc2VVbml0cywKICAgIHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGEsCiAgICBwcmVzaWduTWVzc2FnZVByZWZpeDogKCkgPT4gcHJlc2lnbk1lc3NhZ2VQcmVmaXgsCiAgICBwdWJsaWNBY3Rpb25zOiAoKSA9PiBwdWJsaWNBY3Rpb25zLAogICAgcmVjb3ZlckFkZHJlc3M6ICgpID0+IHJlY292ZXJBZGRyZXNzLAogICAgcmVjb3Zlck1lc3NhZ2VBZGRyZXNzOiAoKSA9PiByZWNvdmVyTWVzc2FnZUFkZHJlc3MsCiAgICByZWNvdmVyUHVibGljS2V5OiAoKSA9PiByZWNvdmVyUHVibGljS2V5LAogICAgcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzczogKCkgPT4gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcywKICAgIHJlY292ZXJUeXBlZERhdGFBZGRyZXNzOiAoKSA9PiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcywKICAgIHJpcGVtZDE2MDogKCkgPT4gcmlwZW1kMTYwMiwKICAgIHJwY1NjaGVtYTogKCkgPT4gcnBjU2NoZW1hLAogICAgcnBjVHJhbnNhY3Rpb25UeXBlOiAoKSA9PiBycGNUcmFuc2FjdGlvblR5cGUsCiAgICBzZXJpYWxpemVBY2Nlc3NMaXN0OiAoKSA9PiBzZXJpYWxpemVBY2Nlc3NMaXN0LAogICAgc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUsCiAgICBzZXJpYWxpemVTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZVRyYW5zYWN0aW9uOiAoKSA9PiBzZXJpYWxpemVUcmFuc2FjdGlvbiwKICAgIHNlcmlhbGl6ZVR5cGVkRGF0YTogKCkgPT4gc2VyaWFsaXplVHlwZWREYXRhLAogICAgc2V0RXJyb3JDb25maWc6ICgpID0+IHNldEVycm9yQ29uZmlnLAogICAgc2V0dXBLemc6ICgpID0+IHNldHVwS3pnLAogICAgc2hhMjU2OiAoKSA9PiBzaGEyNTYyLAogICAgc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlczogKCkgPT4gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcywKICAgIHNpZ25hdHVyZVRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlLAogICAgc2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNpemU6ICgpID0+IHNpemUsCiAgICBzbGljZTogKCkgPT4gc2xpY2UsCiAgICBzbGljZUJ5dGVzOiAoKSA9PiBzbGljZUJ5dGVzLAogICAgc2xpY2VIZXg6ICgpID0+IHNsaWNlSGV4LAogICAgc3RyaW5nVG9CeXRlczogKCkgPT4gc3RyaW5nVG9CeXRlcywKICAgIHN0cmluZ1RvSGV4OiAoKSA9PiBzdHJpbmdUb0hleCwKICAgIHN0cmluZ2lmeTogKCkgPT4gc3RyaW5naWZ5LAogICAgdGVzdEFjdGlvbnM6ICgpID0+IHRlc3RBY3Rpb25zLAogICAgdG9CbG9iU2lkZWNhcnM6ICgpID0+IHRvQmxvYlNpZGVjYXJzLAogICAgdG9CbG9iczogKCkgPT4gdG9CbG9icywKICAgIHRvQnl0ZXM6ICgpID0+IHRvQnl0ZXMsCiAgICB0b0V2ZW50SGFzaDogKCkgPT4gdG9TaWduYXR1cmVIYXNoLAogICAgdG9FdmVudFNlbGVjdG9yOiAoKSA9PiB0b0V2ZW50U2VsZWN0b3IsCiAgICB0b0V2ZW50U2lnbmF0dXJlOiAoKSA9PiB0b1NpZ25hdHVyZSwKICAgIHRvRnVuY3Rpb25IYXNoOiAoKSA9PiB0b1NpZ25hdHVyZUhhc2gsCiAgICB0b0Z1bmN0aW9uU2VsZWN0b3I6ICgpID0+IHRvRnVuY3Rpb25TZWxlY3RvciwKICAgIHRvRnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgdG9IZXg6ICgpID0+IHRvSGV4LAogICAgdG9QcmVmaXhlZE1lc3NhZ2U6ICgpID0+IHRvUHJlZml4ZWRNZXNzYWdlLAogICAgdG9SbHA6ICgpID0+IHRvUmxwLAogICAgdHJhbnNhY3Rpb25UeXBlOiAoKSA9PiB0cmFuc2FjdGlvblR5cGUsCiAgICB0cmltOiAoKSA9PiB0cmltLAogICAgdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpOiAoKSA9PiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JBYmksCiAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZTogKCkgPT4gdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQnl0ZUNvZGUsCiAgICB2YWxpZGF0ZVR5cGVkRGF0YTogKCkgPT4gdmFsaWRhdGVUeXBlZERhdGEsCiAgICB2ZXJpZnlIYXNoOiAoKSA9PiB2ZXJpZnlIYXNoLAogICAgdmVyaWZ5TWVzc2FnZTogKCkgPT4gdmVyaWZ5TWVzc2FnZSwKICAgIHZlcmlmeVR5cGVkRGF0YTogKCkgPT4gdmVyaWZ5VHlwZWREYXRhLAogICAgd2FsbGV0QWN0aW9uczogKCkgPT4gd2FsbGV0QWN0aW9ucywKICAgIHdlYlNvY2tldDogKCkgPT4gd2ViU29ja2V0LAogICAgd2VpVW5pdHM6ICgpID0+IHdlaVVuaXRzLAogICAgd2l0aFJldHJ5OiAoKSA9PiB3aXRoUmV0cnksCiAgICB3aXRoVGltZW91dDogKCkgPT4gd2l0aFRpbWVvdXQsCiAgICB6ZXJvQWRkcmVzczogKCkgPT4gemVyb0FkZHJlc3MsCiAgICB6ZXJvSGFzaDogKCkgPT4gemVyb0hhc2gKICB9KTsKICBpbml0X2V4cG9ydHMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2dldEFjdGlvbi5qcwogIGZ1bmN0aW9uIGdldEFjdGlvbihjbGllbnQsIGFjdGlvbkZuLCBuYW1lKSB7CiAgICBjb25zdCBhY3Rpb25faW1wbGljaXQgPSBjbGllbnRbYWN0aW9uRm4ubmFtZV07CiAgICBpZiAodHlwZW9mIGFjdGlvbl9pbXBsaWNpdCA9PT0gImZ1bmN0aW9uIikKICAgICAgcmV0dXJuIGFjdGlvbl9pbXBsaWNpdDsKICAgIGNvbnN0IGFjdGlvbl9leHBsaWNpdCA9IGNsaWVudFtuYW1lXTsKICAgIGlmICh0eXBlb2YgYWN0aW9uX2V4cGxpY2l0ID09PSAiZnVuY3Rpb24iKQogICAgICByZXR1cm4gYWN0aW9uX2V4cGxpY2l0OwogICAgcmV0dXJuIChwYXJhbXMpID0+IGFjdGlvbkZuKGNsaWVudCwgcGFyYW1zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X2FiaSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2xvZy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICBzdXBlcihgRmlsdGVyIHR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQuYCwgewogICAgICAgIG5hbWU6ICJGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIGluaXRfZ2V0QWJpSXRlbSgpOwogIHZhciBkb2NzUGF0aCA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVFdmVudFRvcGljcyI7CiAgZnVuY3Rpb24gZW5jb2RlRXZlbnRUb3BpY3MocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGV2ZW50TmFtZSwgYXJncyB9ID0gcGFyYW1ldGVyczsKICAgIGxldCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGlmIChldmVudE5hbWUpIHsKICAgICAgY29uc3QgaXRlbSA9IGdldEFiaUl0ZW0oeyBhYmk6IGFiaTIsIG5hbWU6IGV2ZW50TmFtZSB9KTsKICAgICAgaWYgKCFpdGVtKQogICAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3IoZXZlbnROYW1lLCB7IGRvY3NQYXRoIH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoIH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9FdmVudFNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IHRvcGljcyA9IFtdOwogICAgaWYgKGFyZ3MgJiYgImlucHV0cyIgaW4gYWJpSXRlbSkgewogICAgICBjb25zdCBpbmRleGVkSW5wdXRzID0gYWJpSXRlbS5pbnB1dHM/LmZpbHRlcigocGFyYW0pID0+ICJpbmRleGVkIiBpbiBwYXJhbSAmJiBwYXJhbS5pbmRleGVkKTsKICAgICAgY29uc3QgYXJnc18gPSBBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGluZGV4ZWRJbnB1dHM/Lm1hcCgoeCkgPT4gYXJnc1t4Lm5hbWVdKSA/PyBbXSA6IFtdOwogICAgICBpZiAoYXJnc18ubGVuZ3RoID4gMCkgewogICAgICAgIHRvcGljcyA9IGluZGV4ZWRJbnB1dHM/Lm1hcCgocGFyYW0sIGkpID0+IHsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NfW2ldKSkKICAgICAgICAgICAgcmV0dXJuIGFyZ3NfW2ldLm1hcCgoXywgaikgPT4gZW5jb2RlQXJnKHsgcGFyYW0sIHZhbHVlOiBhcmdzX1tpXVtqXSB9KSk7CiAgICAgICAgICByZXR1cm4gYXJnc19baV0gPyBlbmNvZGVBcmcoeyBwYXJhbSwgdmFsdWU6IGFyZ3NfW2ldIH0pIDogbnVsbDsKICAgICAgICB9KSA/PyBbXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIFtzaWduYXR1cmUsIC4uLnRvcGljc107CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFyZyh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInN0cmluZyIgfHwgcGFyYW0udHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGtlY2NhazI1Nih0b0J5dGVzKHZhbHVlKSk7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInR1cGxlIiB8fCBwYXJhbS50eXBlLm1hdGNoKC9eKC4qKVxbKFxkKyk/XF0kLykpCiAgICAgIHRocm93IG5ldyBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IocGFyYW0udHlwZSk7CiAgICByZXR1cm4gZW5jb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCBbdmFsdWVdKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZmlsdGVycy9jcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUuanMKICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7IG1ldGhvZCB9KSB7CiAgICBjb25zdCByZXF1ZXN0TWFwID0ge307CiAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siKQogICAgICBjbGllbnQudHJhbnNwb3J0Lm9uUmVzcG9uc2U/LigoeyBtZXRob2Q6IG1ldGhvZF8sIHJlc3BvbnNlOiBpZCwgc3RhdHVzLCB0cmFuc3BvcnQgfSkgPT4gewogICAgICAgIGlmIChzdGF0dXMgPT09ICJzdWNjZXNzIiAmJiBtZXRob2QgPT09IG1ldGhvZF8pCiAgICAgICAgICByZXF1ZXN0TWFwW2lkXSA9IHRyYW5zcG9ydC5yZXF1ZXN0OwogICAgICB9KTsKICAgIHJldHVybiAoaWQpID0+IHJlcXVlc3RNYXBbaWRdIHx8IGNsaWVudC5yZXF1ZXN0OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBhYmk6IGFiaTIsIGFyZ3MsIGV2ZW50TmFtZSwgZnJvbUJsb2NrLCBzdHJpY3QsIHRvQmxvY2sgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIgogICAgfSk7CiAgICBjb25zdCB0b3BpY3MgPSBldmVudE5hbWUgPyBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lCiAgICB9KSA6IHZvaWQgMDsKICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgdG9waWNzCiAgICAgICAgfQogICAgICBdCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lLAogICAgICBpZCwKICAgICAgcmVxdWVzdDogZ2V0UmVxdWVzdChpZCksCiAgICAgIHN0cmljdDogQm9vbGVhbihzdHJpY3QpLAogICAgICB0eXBlOiAiZXZlbnQiCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlQ29udHJhY3RHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q29udHJhY3RFcnJvci5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGluaXRfcnBjKCk7CiAgdmFyIEVYRUNVVElPTl9SRVZFUlRFRF9FUlJPUl9DT0RFID0gMzsKICBmdW5jdGlvbiBnZXRDb250cmFjdEVycm9yKGVyciwgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGZ1bmN0aW9uTmFtZSwgc2VuZGVyIH0pIHsKICAgIGNvbnN0IHsgY29kZSwgZGF0YSwgbWVzc2FnZSwgc2hvcnRNZXNzYWdlIH0gPSBlcnIgaW5zdGFuY2VvZiBSYXdDb250cmFjdEVycm9yID8gZXJyIDogZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMiA/IGVyci53YWxrKChlcnIyKSA9PiAiZGF0YSIgaW4gZXJyMikgfHwgZXJyLndhbGsoKSA6IHt9OwogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKQogICAgICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IoeyBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmIChbRVhFQ1VUSU9OX1JFVkVSVEVEX0VSUk9SX0NPREUsIEludGVybmFsUnBjRXJyb3IuY29kZV0uaW5jbHVkZXMoY29kZSkgJiYgKGRhdGEgfHwgbWVzc2FnZSB8fCBzaG9ydE1lc3NhZ2UpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICBkYXRhOiB0eXBlb2YgZGF0YSA9PT0gIm9iamVjdCIgPyBkYXRhLmRhdGEgOiBkYXRhLAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgbWVzc2FnZTogc2hvcnRNZXNzYWdlID8/IG1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gZXJyOwogICAgfSkoKTsKICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgY29udHJhY3RBZGRyZXNzOiBhZGRyZXNzLAogICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICBmdW5jdGlvbk5hbWUsCiAgICAgIHNlbmRlcgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZXN0aW1hdGVHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfYmFzZSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcHVibGljS2V5VG9BZGRyZXNzLmpzCiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBmdW5jdGlvbiBwdWJsaWNLZXlUb0FkZHJlc3MocHVibGljS2V5KSB7CiAgICBjb25zdCBhZGRyZXNzID0ga2VjY2FrMjU2KGAweCR7cHVibGljS2V5LnN1YnN0cmluZyg0KX1gKS5zdWJzdHJpbmcoMjYpOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhgMHgke2FkZHJlc3N9YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3JlY292ZXJQdWJsaWNLZXkuanMKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJQdWJsaWNLZXkoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pIHsKICAgIGNvbnN0IGhhc2hIZXggPSBpc0hleChoYXNoMykgPyBoYXNoMyA6IHRvSGV4KGhhc2gzKTsKICAgIGNvbnN0IHsgc2VjcDI1NmsxOiBzZWNwMjU2azEyIH0gPSBhd2FpdCBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IChpbml0X3NlY3AyNTZrMSgpLCBzZWNwMjU2azFfZXhwb3J0cykpOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9ICgoKSA9PiB7CiAgICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlID09PSAib2JqZWN0IiAmJiAiciIgaW4gc2lnbmF0dXJlICYmICJzIiBpbiBzaWduYXR1cmUpIHsKICAgICAgICBjb25zdCB7IHIsIHMsIHYsIHlQYXJpdHkgfSA9IHNpZ25hdHVyZTsKICAgICAgICBjb25zdCB5UGFyaXR5T3JWMiA9IE51bWJlcih5UGFyaXR5ID8/IHYpOwogICAgICAgIGNvbnN0IHJlY292ZXJ5Qml0MiA9IHRvUmVjb3ZlcnlCaXQoeVBhcml0eU9yVjIpOwogICAgICAgIHJldHVybiBuZXcgc2VjcDI1NmsxMi5TaWduYXR1cmUoaGV4VG9CaWdJbnQociksIGhleFRvQmlnSW50KHMpKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdDIpOwogICAgICB9CiAgICAgIGNvbnN0IHNpZ25hdHVyZUhleCA9IGlzSGV4KHNpZ25hdHVyZSkgPyBzaWduYXR1cmUgOiB0b0hleChzaWduYXR1cmUpOwogICAgICBjb25zdCB5UGFyaXR5T3JWID0gaGV4VG9OdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgICAgY29uc3QgcmVjb3ZlcnlCaXQgPSB0b1JlY292ZXJ5Qml0KHlQYXJpdHlPclYpOwogICAgICByZXR1cm4gc2VjcDI1NmsxMi5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnN1YnN0cmluZygyLCAxMzApKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdCk7CiAgICB9KSgpOwogICAgY29uc3QgcHVibGljS2V5ID0gc2lnbmF0dXJlXy5yZWNvdmVyUHVibGljS2V5KGhhc2hIZXguc3Vic3RyaW5nKDIpKS50b0hleChmYWxzZSk7CiAgICByZXR1cm4gYDB4JHtwdWJsaWNLZXl9YDsKICB9CiAgZnVuY3Rpb24gdG9SZWNvdmVyeUJpdCh5UGFyaXR5T3JWKSB7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMCB8fCB5UGFyaXR5T3JWID09PSAxKQogICAgICByZXR1cm4geVBhcml0eU9yVjsKICAgIGlmICh5UGFyaXR5T3JWID09PSAyNykKICAgICAgcmV0dXJuIDA7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgIHJldHVybiAxOwogICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHlQYXJpdHlPclYgdmFsdWUiKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlckFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyQWRkcmVzcyh7IGhhc2g6IGhhc2gzLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHB1YmxpY0tleVRvQWRkcmVzcyhhd2FpdCByZWNvdmVyUHVibGljS2V5KHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvUmxwLmpzCiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jdXJzb3IyKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUmxwKGJ5dGVzMiwgdG8gPSAiaGV4IikgewogICAgY29uc3QgZW5jb2RhYmxlID0gZ2V0RW5jb2RhYmxlKGJ5dGVzMik7CiAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkoZW5jb2RhYmxlLmxlbmd0aCkpOwogICAgZW5jb2RhYmxlLmVuY29kZShjdXJzb3IpOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKTsKICAgIHJldHVybiBjdXJzb3IuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9SbHAoYnl0ZXMyLCB0byA9ICJieXRlcyIpIHsKICAgIHJldHVybiB0b1JscChieXRlczIsIHRvKTsKICB9CiAgZnVuY3Rpb24gaGV4VG9SbHAoaGV4LCB0byA9ICJoZXgiKSB7CiAgICByZXR1cm4gdG9SbHAoaGV4LCB0byk7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZShieXRlczIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGJ5dGVzMikpCiAgICAgIHJldHVybiBnZXRFbmNvZGFibGVMaXN0KGJ5dGVzMi5tYXAoKHgpID0+IGdldEVuY29kYWJsZSh4KSkpOwogICAgcmV0dXJuIGdldEVuY29kYWJsZUJ5dGVzKGJ5dGVzMik7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZUxpc3QobGlzdCkgewogICAgY29uc3QgYm9keUxlbmd0aCA9IGxpc3QucmVkdWNlKChhY2MsIHgpID0+IGFjYyArIHgubGVuZ3RoLCAwKTsKICAgIGNvbnN0IHNpemVPZkJvZHlMZW5ndGggPSBnZXRTaXplT2ZMZW5ndGgoYm9keUxlbmd0aCk7CiAgICBjb25zdCBsZW5ndGggPSAoKCkgPT4gewogICAgICBpZiAoYm9keUxlbmd0aCA8PSA1NSkKICAgICAgICByZXR1cm4gMSArIGJvZHlMZW5ndGg7CiAgICAgIHJldHVybiAxICsgc2l6ZU9mQm9keUxlbmd0aCArIGJvZHlMZW5ndGg7CiAgICB9KSgpOwogICAgcmV0dXJuIHsKICAgICAgbGVuZ3RoLAogICAgICBlbmNvZGUoY3Vyc29yKSB7CiAgICAgICAgaWYgKGJvZHlMZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxOTIgKyBib2R5TGVuZ3RoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDE5MiArIDU1ICsgc2l6ZU9mQm9keUxlbmd0aCk7CiAgICAgICAgICBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMSkKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50OChib2R5TGVuZ3RoKTsKICAgICAgICAgIGVsc2UgaWYgKHNpemVPZkJvZHlMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJvZHlMZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMykKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50MjQoYm9keUxlbmd0aCk7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDMyKGJvZHlMZW5ndGgpOwogICAgICAgIH0KICAgICAgICBmb3IgKGNvbnN0IHsgZW5jb2RlOiBlbmNvZGUyIH0gb2YgbGlzdCkgewogICAgICAgICAgZW5jb2RlMihjdXJzb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gZ2V0RW5jb2RhYmxlQnl0ZXMoYnl0ZXNPckhleCkgewogICAgY29uc3QgYnl0ZXMyID0gdHlwZW9mIGJ5dGVzT3JIZXggPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhieXRlc09ySGV4KSA6IGJ5dGVzT3JIZXg7CiAgICBjb25zdCBzaXplT2ZCeXRlc0xlbmd0aCA9IGdldFNpemVPZkxlbmd0aChieXRlczIubGVuZ3RoKTsKICAgIGNvbnN0IGxlbmd0aCA9ICgoKSA9PiB7CiAgICAgIGlmIChieXRlczIubGVuZ3RoID09PSAxICYmIGJ5dGVzMlswXSA8IDEyOCkKICAgICAgICByZXR1cm4gMTsKICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpCiAgICAgICAgcmV0dXJuIDEgKyBieXRlczIubGVuZ3RoOwogICAgICByZXR1cm4gMSArIHNpemVPZkJ5dGVzTGVuZ3RoICsgYnl0ZXMyLmxlbmd0aDsKICAgIH0pKCk7CiAgICByZXR1cm4gewogICAgICBsZW5ndGgsCiAgICAgIGVuY29kZShjdXJzb3IpIHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCA9PT0gMSAmJiBieXRlczJbMF0gPCAxMjgpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxMjggKyBieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDEyOCArIDU1ICsgc2l6ZU9mQnl0ZXNMZW5ndGgpOwogICAgICAgICAgaWYgKHNpemVPZkJ5dGVzTGVuZ3RoID09PSAxKQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQ4KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDMpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDI0KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQzMihieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldFNpemVPZkxlbmd0aChsZW5ndGgpIHsKICAgIGlmIChsZW5ndGggPCAyICoqIDgpCiAgICAgIHJldHVybiAxOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMTYpCiAgICAgIHJldHVybiAyOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMjQpCiAgICAgIHJldHVybiAzOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMzIpCiAgICAgIHJldHVybiA0OwogICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkxlbmd0aCBpcyB0b28gbGFyZ2UuIik7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hBdXRob3JpemF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgdG8gfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1Nihjb25jYXRIZXgoWwogICAgICAiMHgwNSIsCiAgICAgIHRvUmxwKFsKICAgICAgICBjaGFpbklkID8gbnVtYmVyVG9IZXgoY2hhaW5JZCkgOiAiMHgiLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZSA/IG51bWJlclRvSGV4KG5vbmNlKSA6ICIweCIKICAgICAgXSkKICAgIF0pKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGhleFRvQnl0ZXMoaGFzaDMpOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2V4cGVyaW1lbnRhbC9laXA3NzAyL3V0aWxzL3JlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGF1dGhvcml6YXRpb24sIHNpZ25hdHVyZSB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiByZWNvdmVyQWRkcmVzcyh7CiAgICAgIGhhc2g6IGhhc2hBdXRob3JpemF0aW9uKGF1dGhvcml6YXRpb24pLAogICAgICBzaWduYXR1cmU6IHNpZ25hdHVyZSA/PyBhdXRob3JpemF0aW9uCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfZm9ybWF0RXRoZXIoKTsKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X3RyYW5zYWN0aW9uKCk7CiAgdmFyIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoY2F1c2UsIHsgYWNjb3VudCwgZG9jc1BhdGg6IGRvY3NQYXRoOSwgY2hhaW4sIGRhdGEsIGdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG5vbmNlLCB0bywgdmFsdWUgfSkgewogICAgICBjb25zdCBwcmV0dHlBcmdzID0gcHJldHR5UHJpbnQoewogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgdG8sCiAgICAgICAgdmFsdWU6IHR5cGVvZiB2YWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0RXRoZXIodmFsdWUpfSAke2NoYWluPy5uYXRpdmVDdXJyZW5jeT8uc3ltYm9sIHx8ICJFVEgifWAsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2U6IHR5cGVvZiBnYXNQcmljZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShnYXNQcmljZSl9IGd3ZWlgLAogICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgbm9uY2UKICAgICAgfSk7CiAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgIGNhdXNlLAogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAiRXN0aW1hdGUgR2FzIEFyZ3VtZW50czoiLAogICAgICAgICAgcHJldHR5QXJncwogICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgIG5hbWU6ICJFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yIgogICAgICB9KTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXRFc3RpbWF0ZUdhc0Vycm9yLmpzCiAgaW5pdF9ub2RlKCk7CiAgaW5pdF9nZXROb2RlRXJyb3IoKTsKICBmdW5jdGlvbiBnZXRFc3RpbWF0ZUdhc0Vycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgIC4uLmFyZ3MKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlR2FzLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUyKCk7CiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9wcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9mZWUuanMKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICB2YXIgQmFzZUZlZVNjYWxhckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiYGJhc2VGZWVNdWx0aXBsaWVyYCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxLiIsIHsKICAgICAgICBuYW1lOiAiQmFzZUZlZVNjYWxhckVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQ2hhaW4gZG9lcyBub3Qgc3VwcG9ydCBFSVAtMTU1OSBmZWVzLiIsIHsKICAgICAgICBuYW1lOiAiRWlwMTU1OUZlZXNOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKICB2YXIgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhQcmlvcml0eUZlZVBlckdhcyB9KSB7CiAgICAgIHN1cGVyKGBcYG1heEZlZVBlckdhc1xgIGNhbm5vdCBiZSBsZXNzIHRoYW4gdGhlIFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCAoJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaSkuYCwgeyBuYW1lOiAiTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvY2suanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQmxvY2tOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgYmxvY2tIYXNoLCBibG9ja051bWJlciB9KSB7CiAgICAgIGxldCBpZGVudGlmaWVyID0gIkJsb2NrIjsKICAgICAgaWYgKGJsb2NrSGFzaCkKICAgICAgICBpZGVudGlmaWVyID0gYEJsb2NrIGF0IGhhc2ggIiR7YmxvY2tIYXNofSJgOwogICAgICBpZiAoYmxvY2tOdW1iZXIpCiAgICAgICAgaWRlbnRpZmllciA9IGBCbG9jayBhdCBudW1iZXIgIiR7YmxvY2tOdW1iZXJ9ImA7CiAgICAgIHN1cGVyKGAke2lkZW50aWZpZXJ9IGNvdWxkIG5vdCBiZSBmb3VuZC5gLCB7IG5hbWU6ICJCbG9ja05vdEZvdW5kRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9jay5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvYmxvY2suanMKICBpbml0X2Zvcm1hdHRlcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvbi5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZm9ybWF0dGVyKCk7CiAgdmFyIHRyYW5zYWN0aW9uVHlwZSA9IHsKICAgICIweDAiOiAibGVnYWN5IiwKICAgICIweDEiOiAiZWlwMjkzMCIsCiAgICAiMHgyIjogImVpcDE1NTkiLAogICAgIjB4MyI6ICJlaXA0ODQ0IiwKICAgICIweDQiOiAiZWlwNzcwMiIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbl8gPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICBibG9ja0hhc2g6IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA/IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA6IG51bGwsCiAgICAgIGJsb2NrTnVtYmVyOiB0cmFuc2FjdGlvbi5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvbi5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBjaGFpbklkOiB0cmFuc2FjdGlvbi5jaGFpbklkID8gaGV4VG9OdW1iZXIodHJhbnNhY3Rpb24uY2hhaW5JZCkgOiB2b2lkIDAsCiAgICAgIGdhczogdHJhbnNhY3Rpb24uZ2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLmdhcykgOiB2b2lkIDAsCiAgICAgIGdhc1ByaWNlOiB0cmFuc2FjdGlvbi5nYXNQcmljZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi5nYXNQcmljZSkgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckJsb2JHYXM6IHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPyBCaWdJbnQodHJhbnNhY3Rpb24ubWF4RmVlUGVyQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckdhczogdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA/IEJpZ0ludCh0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG5vbmNlOiB0cmFuc2FjdGlvbi5ub25jZSA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uLm5vbmNlKSA6IHZvaWQgMCwKICAgICAgdG86IHRyYW5zYWN0aW9uLnRvID8gdHJhbnNhY3Rpb24udG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvbi50cmFuc2FjdGlvbkluZGV4ID8gTnVtYmVyKHRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgdHlwZTogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uVHlwZVt0cmFuc2FjdGlvbi50eXBlXSA6IHZvaWQgMCwKICAgICAgdHlwZUhleDogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uLnR5cGUgOiB2b2lkIDAsCiAgICAgIHZhbHVlOiB0cmFuc2FjdGlvbi52YWx1ZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi52YWx1ZSkgOiB2b2lkIDAsCiAgICAgIHY6IHRyYW5zYWN0aW9uLnYgPyBCaWdJbnQodHJhbnNhY3Rpb24udikgOiB2b2lkIDAKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb24uYXV0aG9yaXphdGlvbkxpc3QpCiAgICAgIHRyYW5zYWN0aW9uXy5hdXRob3JpemF0aW9uTGlzdCA9IGZvcm1hdEF1dGhvcml6YXRpb25MaXN0Mih0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCk7CiAgICB0cmFuc2FjdGlvbl8ueVBhcml0eSA9ICgoKSA9PiB7CiAgICAgIGlmICh0cmFuc2FjdGlvbi55UGFyaXR5KQogICAgICAgIHJldHVybiBOdW1iZXIodHJhbnNhY3Rpb24ueVBhcml0eSk7CiAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb25fLnYgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAwbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjduKQogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAxbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjhuKQogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID49IDM1bikKICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbl8udiAlIDJuID09PSAwbiA/IDEgOiAwOwogICAgICB9CiAgICAgIHJldHVybiB2b2lkIDA7CiAgICB9KSgpOwogICAgaWYgKHRyYW5zYWN0aW9uXy50eXBlID09PSAibGVnYWN5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLmFjY2Vzc0xpc3Q7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ueVBhcml0eTsKICAgIH0KICAgIGlmICh0cmFuc2FjdGlvbl8udHlwZSA9PT0gImVpcDI5MzAiKSB7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICB9CiAgICBpZiAodHJhbnNhY3Rpb25fLnR5cGUgPT09ICJlaXAxNTU5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLm1heEZlZVBlckJsb2JHYXM7CiAgICB9CiAgICByZXR1cm4gdHJhbnNhY3Rpb25fOwogIH0KICB2YXIgZGVmaW5lVHJhbnNhY3Rpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJ0cmFuc2FjdGlvbiIsIGZvcm1hdFRyYW5zYWN0aW9uKTsKICBmdW5jdGlvbiBmb3JtYXRBdXRob3JpemF0aW9uTGlzdDIoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGNvbnRyYWN0QWRkcmVzczogYXV0aG9yaXphdGlvbi5hZGRyZXNzLAogICAgICBjaGFpbklkOiBOdW1iZXIoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IE51bWJlcihhdXRob3JpemF0aW9uLm5vbmNlKSwKICAgICAgcjogYXV0aG9yaXphdGlvbi5yLAogICAgICBzOiBhdXRob3JpemF0aW9uLnMsCiAgICAgIHlQYXJpdHk6IE51bWJlcihhdXRob3JpemF0aW9uLnlQYXJpdHkpCiAgICB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9ibG9jay5qcwogIGZ1bmN0aW9uIGZvcm1hdEJsb2NrKGJsb2NrKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBibG9jay50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbiA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICByZXR1cm4gZm9ybWF0VHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICAuLi5ibG9jaywKICAgICAgYmFzZUZlZVBlckdhczogYmxvY2suYmFzZUZlZVBlckdhcyA/IEJpZ0ludChibG9jay5iYXNlRmVlUGVyR2FzKSA6IG51bGwsCiAgICAgIGJsb2JHYXNVc2VkOiBibG9jay5ibG9iR2FzVXNlZCA/IEJpZ0ludChibG9jay5ibG9iR2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGRpZmZpY3VsdHk6IGJsb2NrLmRpZmZpY3VsdHkgPyBCaWdJbnQoYmxvY2suZGlmZmljdWx0eSkgOiB2b2lkIDAsCiAgICAgIGV4Y2Vzc0Jsb2JHYXM6IGJsb2NrLmV4Y2Vzc0Jsb2JHYXMgPyBCaWdJbnQoYmxvY2suZXhjZXNzQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIGdhc0xpbWl0OiBibG9jay5nYXNMaW1pdCA/IEJpZ0ludChibG9jay5nYXNMaW1pdCkgOiB2b2lkIDAsCiAgICAgIGdhc1VzZWQ6IGJsb2NrLmdhc1VzZWQgPyBCaWdJbnQoYmxvY2suZ2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGhhc2g6IGJsb2NrLmhhc2ggPyBibG9jay5oYXNoIDogbnVsbCwKICAgICAgbG9nc0Jsb29tOiBibG9jay5sb2dzQmxvb20gPyBibG9jay5sb2dzQmxvb20gOiBudWxsLAogICAgICBub25jZTogYmxvY2subm9uY2UgPyBibG9jay5ub25jZSA6IG51bGwsCiAgICAgIG51bWJlcjogYmxvY2subnVtYmVyID8gQmlnSW50KGJsb2NrLm51bWJlcikgOiBudWxsLAogICAgICBzaXplOiBibG9jay5zaXplID8gQmlnSW50KGJsb2NrLnNpemUpIDogdm9pZCAwLAogICAgICB0aW1lc3RhbXA6IGJsb2NrLnRpbWVzdGFtcCA/IEJpZ0ludChibG9jay50aW1lc3RhbXApIDogdm9pZCAwLAogICAgICB0cmFuc2FjdGlvbnMsCiAgICAgIHRvdGFsRGlmZmljdWx0eTogYmxvY2sudG90YWxEaWZmaWN1bHR5ID8gQmlnSW50KGJsb2NrLnRvdGFsRGlmZmljdWx0eSkgOiBudWxsCiAgICB9OwogIH0KICB2YXIgZGVmaW5lQmxvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJibG9jayIsIGZvcm1hdEJsb2NrKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2soY2xpZW50LCB7IGJsb2NrSGFzaCwgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gPz8gImxhdGVzdCI7CiAgICBjb25zdCBpbmNsdWRlVHJhbnNhY3Rpb25zID0gaW5jbHVkZVRyYW5zYWN0aW9uc18gPz8gZmFsc2U7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgYmxvY2sgPSBudWxsOwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeUhhc2giLAogICAgICAgIHBhcmFtczogW2Jsb2NrSGFzaCwgaW5jbHVkZVRyYW5zYWN0aW9uc10KICAgICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICB9IGVsc2UgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeU51bWJlciIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcsIGluY2x1ZGVUcmFuc2FjdGlvbnNdCiAgICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIH0KICAgIGlmICghYmxvY2spCiAgICAgIHRocm93IG5ldyBCbG9ja05vdEZvdW5kRXJyb3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyIH0pOwogICAgY29uc3QgZm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy5ibG9jaz8uZm9ybWF0IHx8IGZvcm1hdEJsb2NrOwogICAgcmV0dXJuIGZvcm1hdChibG9jayk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0R2FzUHJpY2UuanMKICBhc3luYyBmdW5jdGlvbiBnZXRHYXNQcmljZShjbGllbnQpIHsKICAgIGNvbnN0IGdhc1ByaWNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2FzUHJpY2UiCiAgICB9KTsKICAgIHJldHVybiBCaWdJbnQoZ2FzUHJpY2UpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMuanMKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgcmV0dXJuIGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYmxvY2s6IGJsb2NrXywgY2hhaW4gPSBjbGllbnQuY2hhaW4sIHJlcXVlc3QgfSA9IGFyZ3MgfHwge307CiAgICB0cnkgewogICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhcyA9IGNoYWluPy5mZWVzPy5tYXhQcmlvcml0eUZlZVBlckdhcyA/PyBjaGFpbj8uZmVlcz8uZGVmYXVsdFByaW9yaXR5RmVlOwogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29uc3QgYmxvY2sgPSBibG9ja18gfHwgYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhc18gPSBhd2FpdCBtYXhQcmlvcml0eUZlZVBlckdhcyh7CiAgICAgICAgICBibG9jaywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgICBpZiAobWF4UHJpb3JpdHlGZWVQZXJHYXNfID09PSBudWxsKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7CiAgICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzXzsKICAgICAgfQogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gbWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGNvbnN0IG1heFByaW9yaXR5RmVlUGVyR2FzSGV4ID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9tYXhQcmlvcml0eUZlZVBlckdhcyIKICAgICAgfSk7CiAgICAgIHJldHVybiBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhc0hleCk7CiAgICB9IGNhdGNoIHsKICAgICAgY29uc3QgW2Jsb2NrLCBnYXNQcmljZV0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgYmxvY2tfID8gUHJvbWlzZS5yZXNvbHZlKGJsb2NrXykgOiBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoe30pLAogICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEdhc1ByaWNlLCAiZ2V0R2FzUHJpY2UiKSh7fSkKICAgICAgXSk7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBnYXNQcmljZSAtIGJsb2NrLmJhc2VGZWVQZXJHYXM7CiAgICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyA8IDBuKQogICAgICAgIHJldHVybiAwbjsKICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlRmVlc1Blckdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIHJldHVybiBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVGZWVzUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBibG9jazogYmxvY2tfLCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgcmVxdWVzdCwgdHlwZSA9ICJlaXAxNTU5IiB9ID0gYXJncyB8fCB7fTsKICAgIGNvbnN0IGJhc2VGZWVNdWx0aXBsaWVyID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBjaGFpbj8uZmVlcz8uYmFzZUZlZU11bHRpcGxpZXIgPT09ICJmdW5jdGlvbiIpCiAgICAgICAgcmV0dXJuIGNoYWluLmZlZXMuYmFzZUZlZU11bHRpcGxpZXIoewogICAgICAgICAgYmxvY2s6IGJsb2NrXywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgcmV0dXJuIGNoYWluPy5mZWVzPy5iYXNlRmVlTXVsdGlwbGllciA/PyAxLjI7CiAgICB9KSgpOwogICAgaWYgKGJhc2VGZWVNdWx0aXBsaWVyIDwgMSkKICAgICAgdGhyb3cgbmV3IEJhc2VGZWVTY2FsYXJFcnJvcigpOwogICAgY29uc3QgZGVjaW1hbHMgPSBiYXNlRmVlTXVsdGlwbGllci50b1N0cmluZygpLnNwbGl0KCIuIilbMV0/Lmxlbmd0aCA/PyAwOwogICAgY29uc3QgZGVub21pbmF0b3IgPSAxMCAqKiBkZWNpbWFsczsKICAgIGNvbnN0IG11bHRpcGx5ID0gKGJhc2UyKSA9PiBiYXNlMiAqIEJpZ0ludChNYXRoLmNlaWwoYmFzZUZlZU11bHRpcGxpZXIgKiBkZW5vbWluYXRvcikpIC8gQmlnSW50KGRlbm9taW5hdG9yKTsKICAgIGNvbnN0IGJsb2NrID0gYmxvY2tfID8gYmxvY2tfIDogYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgIGlmICh0eXBlb2YgY2hhaW4/LmZlZXM/LmVzdGltYXRlRmVlc1BlckdhcyA9PT0gImZ1bmN0aW9uIikgewogICAgICBjb25zdCBmZWVzMiA9IGF3YWl0IGNoYWluLmZlZXMuZXN0aW1hdGVGZWVzUGVyR2FzKHsKICAgICAgICBibG9jazogYmxvY2tfLAogICAgICAgIGNsaWVudCwKICAgICAgICBtdWx0aXBseSwKICAgICAgICByZXF1ZXN0LAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICAgIGlmIChmZWVzMiAhPT0gbnVsbCkKICAgICAgICByZXR1cm4gZmVlczI7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSB0eXBlb2YgcmVxdWVzdD8ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPT09ICJiaWdpbnQiID8gcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA6IGF3YWl0IGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgYmxvY2ssCiAgICAgICAgY2hhaW4sCiAgICAgICAgcmVxdWVzdAogICAgICB9KTsKICAgICAgY29uc3QgYmFzZUZlZVBlckdhcyA9IG11bHRpcGx5KGJsb2NrLmJhc2VGZWVQZXJHYXMpOwogICAgICBjb25zdCBtYXhGZWVQZXJHYXMgPSByZXF1ZXN0Py5tYXhGZWVQZXJHYXMgPz8gYmFzZUZlZVBlckdhcyArIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICByZXR1cm4gewogICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfQogICAgY29uc3QgZ2FzUHJpY2UgPSByZXF1ZXN0Py5nYXNQcmljZSA/PyBtdWx0aXBseShhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRHYXNQcmljZSwgImdldEdhc1ByaWNlIikoe30pKTsKICAgIHJldHVybiB7CiAgICAgIGdhc1ByaWNlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25Db3VudChjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYmxvY2tOdW1iZXIgfSkgewogICAgY29uc3QgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkNvdW50IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVyKSB9KTsKICAgIHJldHVybiBoZXhUb051bWJlcihjb3VudCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9ibG9ic1RvQ29tbWl0bWVudHMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb0NvbW1pdG1lbnRzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsga3pnIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdG8gPSBwYXJhbWV0ZXJzLnRvID8/ICh0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgYmxvYnMgPSB0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyBwYXJhbWV0ZXJzLmJsb2JzLm1hcCgoeCkgPT4gaGV4VG9CeXRlcyh4KSkgOiBwYXJhbWV0ZXJzLmJsb2JzOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykKICAgICAgY29tbWl0bWVudHMucHVzaChVaW50OEFycmF5LmZyb20oa3pnLmJsb2JUb0t6Z0NvbW1pdG1lbnQoYmxvYikpKTsKICAgIHJldHVybiB0byA9PT0gImJ5dGVzIiA/IGNvbW1pdG1lbnRzIDogY29tbWl0bWVudHMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2Jsb2JzVG9Qcm9vZnMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb1Byb29mcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGt6ZyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGNvbW1pdG1lbnRzID0gdHlwZW9mIHBhcmFtZXRlcnMuY29tbWl0bWVudHNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5jb21taXRtZW50cy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5jb21taXRtZW50czsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9icy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBibG9iID0gYmxvYnNbaV07CiAgICAgIGNvbnN0IGNvbW1pdG1lbnQgPSBjb21taXRtZW50c1tpXTsKICAgICAgcHJvb2ZzLnB1c2goVWludDhBcnJheS5mcm9tKGt6Zy5jb21wdXRlQmxvYkt6Z1Byb29mKGJsb2IsIGNvbW1pdG1lbnQpKSk7CiAgICB9CiAgICByZXR1cm4gdG8gPT09ICJieXRlcyIgPyBwcm9vZnMgOiBwcm9vZnMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2NvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2guanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3NoYTI1Ni5qcwogIGluaXRfc2hhMjU2KCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBzaGEyNTYyKHZhbHVlLCB0b18pIHsKICAgIGNvbnN0IHRvID0gdG9fIHx8ICJoZXgiOwogICAgY29uc3QgYnl0ZXMyID0gc2hhMjU2KGlzSGV4KHZhbHVlLCB7IHN0cmljdDogZmFsc2UgfSkgPyB0b0J5dGVzKHZhbHVlKSA6IHZhbHVlKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGJ5dGVzMjsKICAgIHJldHVybiB0b0hleChieXRlczIpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaC5qcwogIGZ1bmN0aW9uIGNvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2gocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb21taXRtZW50LCB2ZXJzaW9uOiB2ZXJzaW9uMyA9IDEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0byA9IHBhcmFtZXRlcnMudG8gPz8gKHR5cGVvZiBjb21taXRtZW50ID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCB2ZXJzaW9uZWRIYXNoID0gc2hhMjU2Mihjb21taXRtZW50LCAiYnl0ZXMiKTsKICAgIHZlcnNpb25lZEhhc2guc2V0KFt2ZXJzaW9uM10sIDApOwogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gdmVyc2lvbmVkSGFzaCA6IGJ5dGVzVG9IZXgodmVyc2lvbmVkSGFzaCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9jb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gY29tbWl0bWVudHNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGNvbW1pdG1lbnRzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIGNvbW1pdG1lbnRzWzBdID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCBoYXNoZXMgPSBbXTsKICAgIGZvciAoY29uc3QgY29tbWl0bWVudCBvZiBjb21taXRtZW50cykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2Jsb2IuanMKICB2YXIgYmxvYnNQZXJUcmFuc2FjdGlvbiA9IDY7CiAgdmFyIGJ5dGVzUGVyRmllbGRFbGVtZW50ID0gMzI7CiAgdmFyIGZpZWxkRWxlbWVudHNQZXJCbG9iID0gNDA5NjsKICB2YXIgYnl0ZXNQZXJCbG9iID0gYnl0ZXNQZXJGaWVsZEVsZW1lbnQgKiBmaWVsZEVsZW1lbnRzUGVyQmxvYjsKICB2YXIgbWF4Qnl0ZXNQZXJUcmFuc2FjdGlvbiA9IGJ5dGVzUGVyQmxvYiAqIGJsb2JzUGVyVHJhbnNhY3Rpb24gLSAvLyB0ZXJtaW5hdG9yIGJ5dGUgKDB4ODApLgogIDEgLSAvLyB6ZXJvIGJ5dGUgKDB4MDApIGFwcGVuZGVkIHRvIGVhY2ggZmllbGQgZWxlbWVudC4KICAxICogZmllbGRFbGVtZW50c1BlckJsb2IgKiBibG9ic1BlclRyYW5zYWN0aW9uOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2t6Zy5qcwogIHZhciB2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6ZyA9IDE7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvYi5qcwogIGluaXRfYmFzZSgpOwogIHZhciBCbG9iU2l6ZVRvb0xhcmdlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhTaXplLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKCJCbG9iIHNpemUgaXMgdG9vIGxhcmdlLiIsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFtgTWF4OiAke21heFNpemV9IGJ5dGVzYCwgYEdpdmVuOiAke3NpemUzfSBieXRlc2BdLAogICAgICAgIG5hbWU6ICJCbG9iU2l6ZVRvb0xhcmdlRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEVtcHR5QmxvYkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQmxvYiBkYXRhIG11c3Qgbm90IGJlIGVtcHR5LiIsIHsgbmFtZTogIkVtcHR5QmxvYkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkVmVyc2lvbmVkSGFzaFNpemVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKGBWZXJzaW9uZWQgaGFzaCAiJHtoYXNoM30iIHNpemUgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkV4cGVjdGVkOiAzMiIsIGBSZWNlaXZlZDogJHtzaXplM31gXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFZlcnNpb25lZEhhc2hTaXplRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEludmFsaWRWZXJzaW9uZWRIYXNoVmVyc2lvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMsIHZlcnNpb246IHZlcnNpb24zIH0pIHsKICAgICAgc3VwZXIoYFZlcnNpb25lZCBoYXNoICIke2hhc2gzfSIgdmVyc2lvbiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgIGBFeHBlY3RlZDogJHt2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6Z31gLAogICAgICAgICAgYFJlY2VpdmVkOiAke3ZlcnNpb24zfWAKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJJbnZhbGlkVmVyc2lvbmVkSGFzaFZlcnNpb25FcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvdG9CbG9icy5qcwogIGluaXRfY3Vyc29yMigpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiB0b0Jsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuZGF0YSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgZGF0YSA9IHR5cGVvZiBwYXJhbWV0ZXJzLmRhdGEgPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhwYXJhbWV0ZXJzLmRhdGEpIDogcGFyYW1ldGVycy5kYXRhOwogICAgY29uc3Qgc2l6ZV8gPSBzaXplKGRhdGEpOwogICAgaWYgKCFzaXplXykKICAgICAgdGhyb3cgbmV3IEVtcHR5QmxvYkVycm9yKCk7CiAgICBpZiAoc2l6ZV8gPiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uKQogICAgICB0aHJvdyBuZXcgQmxvYlNpemVUb29MYXJnZUVycm9yKHsKICAgICAgICBtYXhTaXplOiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uLAogICAgICAgIHNpemU6IHNpemVfCiAgICAgIH0pOwogICAgY29uc3QgYmxvYnMgPSBbXTsKICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgbGV0IHBvc2l0aW9uID0gMDsKICAgIHdoaWxlIChhY3RpdmUpIHsKICAgICAgY29uc3QgYmxvYiA9IGNyZWF0ZUN1cnNvcihuZXcgVWludDhBcnJheShieXRlc1BlckJsb2IpKTsKICAgICAgbGV0IHNpemUzID0gMDsKICAgICAgd2hpbGUgKHNpemUzIDwgZmllbGRFbGVtZW50c1BlckJsb2IpIHsKICAgICAgICBjb25zdCBieXRlczIgPSBkYXRhLnNsaWNlKHBvc2l0aW9uLCBwb3NpdGlvbiArIChieXRlc1BlckZpZWxkRWxlbWVudCAtIDEpKTsKICAgICAgICBibG9iLnB1c2hCeXRlKDApOwogICAgICAgIGJsb2IucHVzaEJ5dGVzKGJ5dGVzMik7CiAgICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPCAzMSkgewogICAgICAgICAgYmxvYi5wdXNoQnl0ZSgxMjgpOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgc2l6ZTMrKzsKICAgICAgICBwb3NpdGlvbiArPSAzMTsKICAgICAgfQogICAgICBibG9icy5wdXNoKGJsb2IpOwogICAgfQogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gYmxvYnMubWFwKCh4KSA9PiB4LmJ5dGVzKSA6IGJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4LmJ5dGVzKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi90b0Jsb2JTaWRlY2Fycy5qcwogIGZ1bmN0aW9uIHRvQmxvYlNpZGVjYXJzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwga3pnLCB0byB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGJsb2JzID0gcGFyYW1ldGVycy5ibG9icyA/PyB0b0Jsb2JzKHsgZGF0YSwgdG8gfSk7CiAgICBjb25zdCBjb21taXRtZW50cyA9IHBhcmFtZXRlcnMuY29tbWl0bWVudHMgPz8gYmxvYnNUb0NvbW1pdG1lbnRzKHsgYmxvYnMsIGt6ZywgdG8gfSk7CiAgICBjb25zdCBwcm9vZnMgPSBwYXJhbWV0ZXJzLnByb29mcyA/PyBibG9ic1RvUHJvb2ZzKHsgYmxvYnMsIGNvbW1pdG1lbnRzLCBremcsIHRvIH0pOwogICAgY29uc3Qgc2lkZWNhcnMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvYnMubGVuZ3RoOyBpKyspCiAgICAgIHNpZGVjYXJzLnB1c2goewogICAgICAgIGJsb2I6IGJsb2JzW2ldLAogICAgICAgIGNvbW1pdG1lbnQ6IGNvbW1pdG1lbnRzW2ldLAogICAgICAgIHByb29mOiBwcm9vZnNbaV0KICAgICAgfSk7CiAgICByZXR1cm4gc2lkZWNhcnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vZ2V0VHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uVHlwZSh0cmFuc2FjdGlvbikgewogICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbi50eXBlOwogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLmJsb2JzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYlZlcnNpb25lZEhhc2hlcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiB0cmFuc2FjdGlvbi5zaWRlY2FycyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNDg0NCI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgfQogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5nYXNQcmljZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gImVpcDI5MzAiOwogICAgICByZXR1cm4gImxlZ2FjeSI7CiAgICB9CiAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3IoeyB0cmFuc2FjdGlvbiB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDaGFpbklkLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZChjbGllbnQpIHsKICAgIGNvbnN0IGNoYWluSWRIZXggPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9jaGFpbklkIgogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIoY2hhaW5JZEhleCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIHZhciBkZWZhdWx0UGFyYW1ldGVycyA9IFsKICAgICJibG9iVmVyc2lvbmVkSGFzaGVzIiwKICAgICJjaGFpbklkIiwKICAgICJmZWVzIiwKICAgICJnYXMiLAogICAgIm5vbmNlIiwKICAgICJ0eXBlIgogIF07CiAgYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgYmxvYnMsIGNoYWluLCBnYXMsIGt6Zywgbm9uY2UsIG5vbmNlTWFuYWdlcjogbm9uY2VNYW5hZ2VyMiwgcGFyYW1ldGVycyA9IGRlZmF1bHRQYXJhbWV0ZXJzLCB0eXBlIH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IGFjY291bnRfOwogICAgY29uc3QgcmVxdWVzdCA9IHsgLi4uYXJncywgLi4uYWNjb3VudCA/IHsgZnJvbTogYWNjb3VudD8uYWRkcmVzcyB9IDoge30gfTsKICAgIGxldCBibG9jazsKICAgIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrMigpIHsKICAgICAgaWYgKGJsb2NrKQogICAgICAgIHJldHVybiBibG9jazsKICAgICAgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoeyBibG9ja1RhZzogImxhdGVzdCIgfSk7CiAgICAgIHJldHVybiBibG9jazsKICAgIH0KICAgIGxldCBjaGFpbklkOwogICAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZDIoKSB7CiAgICAgIGlmIChjaGFpbklkKQogICAgICAgIHJldHVybiBjaGFpbklkOwogICAgICBpZiAoY2hhaW4pCiAgICAgICAgcmV0dXJuIGNoYWluLmlkOwogICAgICBpZiAodHlwZW9mIGFyZ3MuY2hhaW5JZCAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIGFyZ3MuY2hhaW5JZDsKICAgICAgY29uc3QgY2hhaW5JZF8gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRDaGFpbklkLCAiZ2V0Q2hhaW5JZCIpKHt9KTsKICAgICAgY2hhaW5JZCA9IGNoYWluSWRfOwogICAgICByZXR1cm4gY2hhaW5JZDsKICAgIH0KICAgIGlmICgocGFyYW1ldGVycy5pbmNsdWRlcygiYmxvYlZlcnNpb25lZEhhc2hlcyIpIHx8IHBhcmFtZXRlcnMuaW5jbHVkZXMoInNpZGVjYXJzIikpICYmIGJsb2JzICYmIGt6ZykgewogICAgICBjb25zdCBjb21taXRtZW50cyA9IGJsb2JzVG9Db21taXRtZW50cyh7IGJsb2JzLCBremcgfSk7CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJibG9iVmVyc2lvbmVkSGFzaGVzIikpIHsKICAgICAgICBjb25zdCB2ZXJzaW9uZWRIYXNoZXMgPSBjb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzKHsKICAgICAgICAgIGNvbW1pdG1lbnRzLAogICAgICAgICAgdG86ICJoZXgiCiAgICAgICAgfSk7CiAgICAgICAgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gdmVyc2lvbmVkSGFzaGVzOwogICAgICB9CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJzaWRlY2FycyIpKSB7CiAgICAgICAgY29uc3QgcHJvb2ZzID0gYmxvYnNUb1Byb29mcyh7IGJsb2JzLCBjb21taXRtZW50cywga3pnIH0pOwogICAgICAgIGNvbnN0IHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoewogICAgICAgICAgYmxvYnMsCiAgICAgICAgICBjb21taXRtZW50cywKICAgICAgICAgIHByb29mcywKICAgICAgICAgIHRvOiAiaGV4IgogICAgICAgIH0pOwogICAgICAgIHJlcXVlc3Quc2lkZWNhcnMgPSBzaWRlY2FyczsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImNoYWluSWQiKSkKICAgICAgcmVxdWVzdC5jaGFpbklkID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJub25jZSIpICYmIHR5cGVvZiBub25jZSA9PT0gInVuZGVmaW5lZCIgJiYgYWNjb3VudCkgewogICAgICBpZiAobm9uY2VNYW5hZ2VyMikgewogICAgICAgIGNvbnN0IGNoYWluSWQyID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgICAgICByZXF1ZXN0Lm5vbmNlID0gYXdhaXQgbm9uY2VNYW5hZ2VyMi5jb25zdW1lKHsKICAgICAgICAgIGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywKICAgICAgICAgIGNoYWluSWQ6IGNoYWluSWQyLAogICAgICAgICAgY2xpZW50CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVxdWVzdC5ub25jZSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uQ291bnQsICJnZXRUcmFuc2FjdGlvbkNvdW50IikoewogICAgICAgICAgYWRkcmVzczogYWNjb3VudC5hZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBpZiAoKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSB8fCBwYXJhbWV0ZXJzLmluY2x1ZGVzKCJ0eXBlIikpICYmIHR5cGVvZiB0eXBlID09PSAidW5kZWZpbmVkIikgewogICAgICB0cnkgewogICAgICAgIHJlcXVlc3QudHlwZSA9IGdldFRyYW5zYWN0aW9uVHlwZShyZXF1ZXN0KTsKICAgICAgfSBjYXRjaCB7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgcmVxdWVzdC50eXBlID0gdHlwZW9mIGJsb2NrMj8uYmFzZUZlZVBlckdhcyA9PT0gImJpZ2ludCIgPyAiZWlwMTU1OSIgOiAibGVnYWN5IjsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSkgewogICAgICBpZiAocmVxdWVzdC50eXBlICE9PSAibGVnYWN5IiAmJiByZXF1ZXN0LnR5cGUgIT09ICJlaXAyOTMwIikgewogICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiByZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgICBjb25zdCB7IG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSA9IGF3YWl0IGludGVybmFsX2VzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIHsKICAgICAgICAgICAgYmxvY2s6IGJsb2NrMiwKICAgICAgICAgICAgY2hhaW4sCiAgICAgICAgICAgIHJlcXVlc3QKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIiAmJiBhcmdzLm1heEZlZVBlckdhcyAmJiBhcmdzLm1heEZlZVBlckdhcyA8IG1heFByaW9yaXR5RmVlUGVyR2FzKQogICAgICAgICAgICB0aHJvdyBuZXcgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IoewogICAgICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA9IG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICAgICAgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBtYXhGZWVQZXJHYXM7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgYXJncy5tYXhGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICAgIHRocm93IG5ldyBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yKCk7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgY29uc3QgeyBnYXNQcmljZTogZ2FzUHJpY2VfIH0gPSBhd2FpdCBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgICBibG9jazogYmxvY2syLAogICAgICAgICAgY2hhaW4sCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgdHlwZTogImxlZ2FjeSIKICAgICAgICB9KTsKICAgICAgICByZXF1ZXN0Lmdhc1ByaWNlID0gZ2FzUHJpY2VfOwogICAgICB9CiAgICB9CiAgICBpZiAocGFyYW1ldGVycy5pbmNsdWRlcygiZ2FzIikgJiYgdHlwZW9mIGdhcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJlcXVlc3QuZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICAuLi5yZXF1ZXN0LAogICAgICAgIGFjY291bnQ6IGFjY291bnQgPyB7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywgdHlwZTogImpzb24tcnBjIiB9IDogYWNjb3VudAogICAgICB9KTsKICAgIGFzc2VydFJlcXVlc3QocmVxdWVzdCk7CiAgICBkZWxldGUgcmVxdWVzdC5wYXJhbWV0ZXJzOwogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmFsYW5jZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEJhbGFuY2UiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYWxhbmNlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50IH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IHZvaWQgMDsKICAgIHRyeSB7CiAgICAgIGxldCBlc3RpbWF0ZUdhc19ycGMgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBibG9jazogYmxvY2syLCByZXF1ZXN0OiByZXF1ZXN0MiwgcnBjU3RhdGVPdmVycmlkZTogcnBjU3RhdGVPdmVycmlkZTIgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9lc3RpbWF0ZUdhcyIsCiAgICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUyID8gW3JlcXVlc3QyLCBibG9jazIgPz8gImxhdGVzdCIsIHJwY1N0YXRlT3ZlcnJpZGUyXSA6IGJsb2NrMiA/IFtyZXF1ZXN0MiwgYmxvY2syXSA6IFtyZXF1ZXN0Ml0KICAgICAgICB9KTsKICAgICAgfTsKICAgICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBhdXRob3JpemF0aW9uTGlzdCwgYmxvYnMsIGJsb2JWZXJzaW9uZWRIYXNoZXMsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHZhbHVlLCBzdGF0ZU92ZXJyaWRlLCAuLi5yZXN0IH0gPSBhd2FpdCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0KGNsaWVudCwgewogICAgICAgIC4uLmFyZ3MsCiAgICAgICAgcGFyYW1ldGVyczogKAogICAgICAgICAgLy8gU29tZSBSUEMgUHJvdmlkZXJzIGRvIG5vdCBjb21wdXRlIHZlcnNpb25lZCBoYXNoZXMgZnJvbSBibG9icy4gV2Ugd2lsbCBuZWVkCiAgICAgICAgICAvLyB0byBjb21wdXRlIHRoZW0uCiAgICAgICAgICBhY2NvdW50Py50eXBlID09PSAibG9jYWwiID8gdm9pZCAwIDogWyJibG9iVmVyc2lvbmVkSGFzaGVzIl0KICAgICAgICApCiAgICAgIH0pOwogICAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgICBjb25zdCBycGNTdGF0ZU92ZXJyaWRlID0gc2VyaWFsaXplU3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKTsKICAgICAgY29uc3QgdG8gPSBhd2FpdCAoYXN5bmMgKCkgPT4gewogICAgICAgIGlmIChyZXN0LnRvKQogICAgICAgICAgcmV0dXJuIHJlc3QudG87CiAgICAgICAgaWYgKGF1dGhvcml6YXRpb25MaXN0ICYmIGF1dGhvcml6YXRpb25MaXN0Lmxlbmd0aCA+IDApCiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVjb3ZlckF1dGhvcml6YXRpb25BZGRyZXNzKHsKICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYXV0aG9yaXphdGlvbkxpc3RbMF0KICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImB0b2AgaXMgcmVxdWlyZWQuIENvdWxkIG5vdCBpbmZlciBmcm9tIGBhdXRob3JpemF0aW9uTGlzdGAiKTsKICAgICAgICAgIH0pOwogICAgICAgIHJldHVybiB2b2lkIDA7CiAgICAgIH0pKCk7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGNoYWluRm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdDsKICAgICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAvLyBQaWNrIG91dCBleHRyYSBkYXRhIHRoYXQgbWlnaHQgZXhpc3Qgb24gdGhlIGNoYWluJ3MgdHJhbnNhY3Rpb24gcmVxdWVzdCB0eXBlLgogICAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICBibG9icywKICAgICAgICBibG9iVmVyc2lvbmVkSGFzaGVzLAogICAgICAgIGRhdGEsCiAgICAgICAgZ2FzLAogICAgICAgIGdhc1ByaWNlLAogICAgICAgIG1heEZlZVBlckJsb2JHYXMsCiAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgIG5vbmNlLAogICAgICAgIHRvLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgICBsZXQgZXN0aW1hdGUgPSBCaWdJbnQoYXdhaXQgZXN0aW1hdGVHYXNfcnBjKHsgYmxvY2ssIHJlcXVlc3QsIHJwY1N0YXRlT3ZlcnJpZGUgfSkpOwogICAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSBhd2FpdCBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzOiByZXF1ZXN0LmZyb20gfSk7CiAgICAgICAgY29uc3QgZXN0aW1hdGVzID0gYXdhaXQgUHJvbWlzZS5hbGwoYXV0aG9yaXphdGlvbkxpc3QubWFwKGFzeW5jIChhdXRob3JpemF0aW9uKSA9PiB7CiAgICAgICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcyB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgICAgIGNvbnN0IGVzdGltYXRlMiA9IGF3YWl0IGVzdGltYXRlR2FzX3JwYyh7CiAgICAgICAgICAgIGJsb2NrLAogICAgICAgICAgICByZXF1ZXN0OiB7CiAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3Q6IHZvaWQgMCwKICAgICAgICAgICAgICBkYXRhLAogICAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgICAgdG86IGNvbnRyYWN0QWRkcmVzcywKICAgICAgICAgICAgICB2YWx1ZTogbnVtYmVyVG9IZXgodmFsdWUyKQogICAgICAgICAgICB9LAogICAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiAxMDAwMDBuKTsKICAgICAgICAgIHJldHVybiAybiAqIEJpZ0ludChlc3RpbWF0ZTIpOwogICAgICAgIH0pKTsKICAgICAgICBlc3RpbWF0ZSArPSBlc3RpbWF0ZXMucmVkdWNlKChhY2MsIGN1cnIpID0+IGFjYyArIGN1cnIsIDBuKTsKICAgICAgfQogICAgICByZXR1cm4gZXN0aW1hdGU7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgdGhyb3cgZ2V0RXN0aW1hdGVHYXNFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUNvbnRyYWN0R2FzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVDb250cmFjdEdhcyhjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgY29uc3QgZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICBkYXRhLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLnJlcXVlc3QKICAgICAgfSk7CiAgICAgIHJldHVybiBnYXM7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zdCBhY2NvdW50ID0gcmVxdWVzdC5hY2NvdW50ID8gcGFyc2VBY2NvdW50KHJlcXVlc3QuYWNjb3VudCkgOiB2b2lkIDA7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvZXN0aW1hdGVDb250cmFjdEdhcyIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGluaXRfZ2V0QWJpSXRlbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL3BhcnNlRXZlbnRMb2dzLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUV2ZW50TG9nLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X3NpemUoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwogIGluaXRfY3Vyc29yKCk7CiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIHZhciBkb2NzUGF0aDMgPSAiL2RvY3MvY29udHJhY3QvZGVjb2RlRXZlbnRMb2ciOwogIGZ1bmN0aW9uIGRlY29kZUV2ZW50TG9nKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhLCBzdHJpY3Q6IHN0cmljdF8sIHRvcGljcyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gdHJ1ZTsKICAgIGNvbnN0IFtzaWduYXR1cmUsIC4uLmFyZ1RvcGljc10gPSB0b3BpY3M7CiAgICBpZiAoIXNpZ25hdHVyZSkKICAgICAgdGhyb3cgbmV3IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCBhYmlJdGVtID0gKCgpID0+IHsKICAgICAgaWYgKGFiaTIubGVuZ3RoID09PSAxKQogICAgICAgIHJldHVybiBhYmkyWzBdOwogICAgICByZXR1cm4gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgc2lnbmF0dXJlID09PSB0b0V2ZW50U2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIH0pKCk7CiAgICBpZiAoIShhYmlJdGVtICYmICJuYW1lIiBpbiBhYmlJdGVtKSB8fCBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCB7IG5hbWUsIGlucHV0cyB9ID0gYWJpSXRlbTsKICAgIGNvbnN0IGlzVW5uYW1lZCA9IGlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgIGxldCBhcmdzID0gaXNVbm5hbWVkID8gW10gOiB7fTsKICAgIGNvbnN0IGluZGV4ZWRJbnB1dHMgPSBpbnB1dHMuZmlsdGVyKCh4KSA9PiAiaW5kZXhlZCIgaW4geCAmJiB4LmluZGV4ZWQpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRleGVkSW5wdXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHBhcmFtID0gaW5kZXhlZElucHV0c1tpXTsKICAgICAgY29uc3QgdG9waWMgPSBhcmdUb3BpY3NbaV07CiAgICAgIGlmICghdG9waWMpCiAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ1RvcGljc01pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBwYXJhbQogICAgICAgIH0pOwogICAgICBhcmdzW2lzVW5uYW1lZCA/IGkgOiBwYXJhbS5uYW1lIHx8IGldID0gZGVjb2RlVG9waWMoeyBwYXJhbSwgdmFsdWU6IHRvcGljIH0pOwogICAgfQogICAgY29uc3Qgbm9uSW5kZXhlZElucHV0cyA9IGlucHV0cy5maWx0ZXIoKHgpID0+ICEoImluZGV4ZWQiIGluIHggJiYgeC5pbmRleGVkKSk7CiAgICBpZiAobm9uSW5kZXhlZElucHV0cy5sZW5ndGggPiAwKSB7CiAgICAgIGlmIChkYXRhICYmIGRhdGEgIT09ICIweCIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgZGVjb2RlZERhdGEgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKG5vbkluZGV4ZWRJbnB1dHMsIGRhdGEpOwogICAgICAgICAgaWYgKGRlY29kZWREYXRhKSB7CiAgICAgICAgICAgIGlmIChpc1VubmFtZWQpCiAgICAgICAgICAgICAgYXJncyA9IFsuLi5hcmdzLCAuLi5kZWNvZGVkRGF0YV07CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9uSW5kZXhlZElucHV0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYXJnc1tub25JbmRleGVkSW5wdXRzW2ldLm5hbWVdID0gZGVjb2RlZERhdGFbaV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KSB7CiAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciB8fCBlcnIgaW5zdGFuY2VvZiBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ0RhdGFNaXNtYXRjaCh7CiAgICAgICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgICAgIHBhcmFtczogbm9uSW5kZXhlZElucHV0cywKICAgICAgICAgICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdHJpY3QpIHsKICAgICAgICB0aHJvdyBuZXcgRGVjb2RlTG9nRGF0YU1pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBkYXRhOiAiMHgiLAogICAgICAgICAgcGFyYW1zOiBub25JbmRleGVkSW5wdXRzLAogICAgICAgICAgc2l6ZTogMAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICBldmVudE5hbWU6IG5hbWUsCiAgICAgIGFyZ3M6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGFyZ3MgOiB2b2lkIDAKICAgIH07CiAgfQogIGZ1bmN0aW9uIGRlY29kZVRvcGljKHsgcGFyYW0sIHZhbHVlIH0pIHsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIiB8fCBwYXJhbS50eXBlID09PSAiYnl0ZXMiIHx8IHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIgfHwgcGFyYW0udHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pKQogICAgICByZXR1cm4gdmFsdWU7CiAgICBjb25zdCBkZWNvZGVkQXJnID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCB2YWx1ZSkgfHwgW107CiAgICByZXR1cm4gZGVjb2RlZEFyZ1swXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcGFyc2VFdmVudExvZ3MuanMKICBmdW5jdGlvbiBwYXJzZUV2ZW50TG9ncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgbG9ncywgc3RyaWN0ID0gdHJ1ZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50TmFtZSA9ICgoKSA9PiB7CiAgICAgIGlmICghcGFyYW1ldGVycy5ldmVudE5hbWUpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1ldGVycy5ldmVudE5hbWUpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLmV2ZW50TmFtZTsKICAgICAgcmV0dXJuIFtwYXJhbWV0ZXJzLmV2ZW50TmFtZV07CiAgICB9KSgpOwogICAgcmV0dXJuIGxvZ3MubWFwKChsb2cpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBhYmlJdGVtID0gYWJpMi5maW5kKChhYmlJdGVtMikgPT4gYWJpSXRlbTIudHlwZSA9PT0gImV2ZW50IiAmJiBsb2cudG9waWNzWzBdID09PSB0b0V2ZW50U2VsZWN0b3IoYWJpSXRlbTIpKTsKICAgICAgICBpZiAoIWFiaUl0ZW0pCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBjb25zdCBldmVudCA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgIC4uLmxvZywKICAgICAgICAgIGFiaTogW2FiaUl0ZW1dLAogICAgICAgICAgc3RyaWN0CiAgICAgICAgfSk7CiAgICAgICAgaWYgKGV2ZW50TmFtZSAmJiAhZXZlbnROYW1lLmluY2x1ZGVzKGV2ZW50LmV2ZW50TmFtZSkpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoIWluY2x1ZGVzQXJncyh7CiAgICAgICAgICBhcmdzOiBldmVudC5hcmdzLAogICAgICAgICAgaW5wdXRzOiBhYmlJdGVtLmlucHV0cywKICAgICAgICAgIG1hdGNoQXJnczogYXJncwogICAgICAgIH0pKQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHsgLi4uZXZlbnQsIC4uLmxvZyB9OwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBsZXQgZXZlbnROYW1lMjsKICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3IpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nRGF0YU1pc21hdGNoIHx8IGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ1RvcGljc01pc21hdGNoKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIGV2ZW50TmFtZTIgPSBlcnIuYWJpSXRlbS5uYW1lOwogICAgICAgICAgaXNVbm5hbWVkID0gZXJyLmFiaUl0ZW0uaW5wdXRzPy5zb21lKCh4KSA9PiAhKCJuYW1lIiBpbiB4ICYmIHgubmFtZSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4geyAuLi5sb2csIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sIGV2ZW50TmFtZTogZXZlbnROYW1lMiB9OwogICAgICB9CiAgICB9KS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGluY2x1ZGVzQXJncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MsIGlucHV0cywgbWF0Y2hBcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFtYXRjaEFyZ3MpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKCFhcmdzKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBmdW5jdGlvbiBpc0VxdWFsKGlucHV0LCB2YWx1ZSwgYXJnKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09ICJhZGRyZXNzIikKICAgICAgICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbCh2YWx1ZSwgYXJnKTsKICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gInN0cmluZyIgfHwgaW5wdXQudHlwZSA9PT0gImJ5dGVzIikKICAgICAgICAgIHJldHVybiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpID09PSBhcmc7CiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBhcmc7CiAgICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogICAgaWYgKEFycmF5LmlzQXJyYXkoYXJncykgJiYgQXJyYXkuaXNBcnJheShtYXRjaEFyZ3MpKSB7CiAgICAgIHJldHVybiBtYXRjaEFyZ3MuZXZlcnkoKHZhbHVlLCBpbmRleDIpID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzW2luZGV4Ml07CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2luZGV4Ml0pKTsKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZW9mIGFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KGFyZ3MpICYmIHR5cGVvZiBtYXRjaEFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KG1hdGNoQXJncykpCiAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhtYXRjaEFyZ3MpLmV2ZXJ5KChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzLmZpbmQoKGlucHV0MikgPT4gaW5wdXQyLm5hbWUgPT09IGtleSk7CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2tleV0pKTsKICAgICAgfSk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0TG9ncy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvbG9nLmpzCiAgZnVuY3Rpb24gZm9ybWF0TG9nKGxvZywgeyBhcmdzLCBldmVudE5hbWUgfSA9IHt9KSB7CiAgICByZXR1cm4gewogICAgICAuLi5sb2csCiAgICAgIGJsb2NrSGFzaDogbG9nLmJsb2NrSGFzaCA/IGxvZy5ibG9ja0hhc2ggOiBudWxsLAogICAgICBibG9ja051bWJlcjogbG9nLmJsb2NrTnVtYmVyID8gQmlnSW50KGxvZy5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBsb2dJbmRleDogbG9nLmxvZ0luZGV4ID8gTnVtYmVyKGxvZy5sb2dJbmRleCkgOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkhhc2g6IGxvZy50cmFuc2FjdGlvbkhhc2ggPyBsb2cudHJhbnNhY3Rpb25IYXNoIDogbnVsbCwKICAgICAgdHJhbnNhY3Rpb25JbmRleDogbG9nLnRyYW5zYWN0aW9uSW5kZXggPyBOdW1iZXIobG9nLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgLi4uZXZlbnROYW1lID8geyBhcmdzLCBldmVudE5hbWUgfSA6IHt9CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldExvZ3MuanMKICBhc3luYyBmdW5jdGlvbiBnZXRMb2dzKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja0hhc2gsIGZyb21CbG9jaywgdG9CbG9jaywgZXZlbnQsIGV2ZW50czogZXZlbnRzXywgYXJncywgc3RyaWN0OiBzdHJpY3RfIH0gPSB7fSkgewogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IGV2ZW50cyA9IGV2ZW50c18gPz8gKGV2ZW50ID8gW2V2ZW50XSA6IHZvaWQgMCk7CiAgICBsZXQgdG9waWNzID0gW107CiAgICBpZiAoZXZlbnRzKSB7CiAgICAgIGNvbnN0IGVuY29kZWQgPSBldmVudHMuZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgIGFyZ3M6IGV2ZW50c18gPyB2b2lkIDAgOiBhcmdzCiAgICAgIH0pKTsKICAgICAgdG9waWNzID0gW2VuY29kZWRdOwogICAgICBpZiAoZXZlbnQpCiAgICAgICAgdG9waWNzID0gdG9waWNzWzBdOwogICAgfQogICAgbGV0IGxvZ3M7CiAgICBpZiAoYmxvY2tIYXNoKSB7CiAgICAgIGxvZ3MgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldExvZ3MiLAogICAgICAgIHBhcmFtczogW3sgYWRkcmVzcywgdG9waWNzLCBibG9ja0hhc2ggfV0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBsb2dzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRMb2dzIiwKICAgICAgICBwYXJhbXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgdG9waWNzLAogICAgICAgICAgICBmcm9tQmxvY2s6IHR5cGVvZiBmcm9tQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgoZnJvbUJsb2NrKSA6IGZyb21CbG9jaywKICAgICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWV2ZW50cykKICAgICAgcmV0dXJuIGZvcm1hdHRlZExvZ3M7CiAgICByZXR1cm4gcGFyc2VFdmVudExvZ3MoewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgbG9nczogZm9ybWF0dGVkTG9ncywKICAgICAgc3RyaWN0CiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJsb2NrSGFzaCwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIHRvQmxvY2ssIHN0cmljdCB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50ID0gZXZlbnROYW1lID8gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgbmFtZTogZXZlbnROYW1lIH0pIDogdm9pZCAwOwogICAgY29uc3QgZXZlbnRzID0gIWV2ZW50ID8gYWJpMi5maWx0ZXIoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IikgOiB2b2lkIDA7CiAgICByZXR1cm4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0TG9ncywgImdldExvZ3MiKSh7CiAgICAgIGFkZHJlc3MsCiAgICAgIGFyZ3MsCiAgICAgIGJsb2NrSGFzaCwKICAgICAgZXZlbnQsCiAgICAgIGV2ZW50cywKICAgICAgZnJvbUJsb2NrLAogICAgICB0b0Jsb2NrLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3JlYWRDb250cmFjdC5qcwogIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQoKTsKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogIGluaXRfY2FsbCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlYWRDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZnVuY3Rpb25OYW1lCiAgICB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgLi4ucmVzdCwKICAgICAgICBkYXRhOiBjYWxsZGF0YSwKICAgICAgICB0bzogYWRkcmVzcwogICAgICB9KTsKICAgICAgcmV0dXJuIGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9yZWFkQ29udHJhY3QiLAogICAgICAgIGZ1bmN0aW9uTmFtZQogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9zaW11bGF0ZUNvbnRyYWN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2NhbGwoKTsKICBhc3luYyBmdW5jdGlvbiBzaW11bGF0ZUNvbnRyYWN0KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRhdGFTdWZmaXgsIGZ1bmN0aW9uTmFtZSwgLi4uY2FsbFJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBhY2NvdW50ID0gY2FsbFJlcXVlc3QuYWNjb3VudCA/IHBhcnNlQWNjb3VudChjYWxsUmVxdWVzdC5hY2NvdW50KSA6IGNsaWVudC5hY2NvdW50OwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgYmF0Y2g6IGZhbHNlLAogICAgICAgIGRhdGE6IGAke2NhbGxkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLmNhbGxSZXF1ZXN0LAogICAgICAgIGFjY291bnQKICAgICAgfSk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgICBjb25zdCBtaW5pbWl6ZWRBYmkgPSBhYmkyLmZpbHRlcigoYWJpSXRlbSkgPT4gIm5hbWUiIGluIGFiaUl0ZW0gJiYgYWJpSXRlbS5uYW1lID09PSBwYXJhbWV0ZXJzLmZ1bmN0aW9uTmFtZSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgcmVzdWx0LAogICAgICAgIHJlcXVlc3Q6IHsKICAgICAgICAgIGFiaTogbWluaW1pemVkQWJpLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkYXRhU3VmZml4LAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgLi4uY2FsbFJlcXVlc3QsCiAgICAgICAgICBhY2NvdW50CiAgICAgICAgfQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9zaW11bGF0ZUNvbnRyYWN0IiwKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgc2VuZGVyOiBhY2NvdW50Py5hZGRyZXNzCiAgICAgIH0pOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhdGNoQ29udHJhY3RFdmVudC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9ycGMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL29ic2VydmUuanMKICB2YXIgbGlzdGVuZXJzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjbGVhbnVwQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjYWxsYmFja0NvdW50ID0gMDsKICBmdW5jdGlvbiBvYnNlcnZlKG9ic2VydmVySWQsIGNhbGxiYWNrcywgZm4pIHsKICAgIGNvbnN0IGNhbGxiYWNrSWQgPSArK2NhbGxiYWNrQ291bnQ7CiAgICBjb25zdCBnZXRMaXN0ZW5lcnMgPSAoKSA9PiBsaXN0ZW5lcnNDYWNoZS5nZXQob2JzZXJ2ZXJJZCkgfHwgW107CiAgICBjb25zdCB1bnN1YnNjcmliZSA9ICgpID0+IHsKICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICBsaXN0ZW5lcnNDYWNoZS5zZXQob2JzZXJ2ZXJJZCwgbGlzdGVuZXJzMi5maWx0ZXIoKGNiKSA9PiBjYi5pZCAhPT0gY2FsbGJhY2tJZCkpOwogICAgfTsKICAgIGNvbnN0IHVud2F0Y2ggPSAoKSA9PiB7CiAgICAgIGNvbnN0IGNsZWFudXAyID0gY2xlYW51cENhY2hlLmdldChvYnNlcnZlcklkKTsKICAgICAgaWYgKGdldExpc3RlbmVycygpLmxlbmd0aCA9PT0gMSAmJiBjbGVhbnVwMikKICAgICAgICBjbGVhbnVwMigpOwogICAgICB1bnN1YnNjcmliZSgpOwogICAgfTsKICAgIGNvbnN0IGxpc3RlbmVycyA9IGdldExpc3RlbmVycygpOwogICAgbGlzdGVuZXJzQ2FjaGUuc2V0KG9ic2VydmVySWQsIFsKICAgICAgLi4ubGlzdGVuZXJzLAogICAgICB7IGlkOiBjYWxsYmFja0lkLCBmbnM6IGNhbGxiYWNrcyB9CiAgICBdKTsKICAgIGlmIChsaXN0ZW5lcnMgJiYgbGlzdGVuZXJzLmxlbmd0aCA+IDApCiAgICAgIHJldHVybiB1bndhdGNoOwogICAgY29uc3QgZW1pdCA9IHt9OwogICAgZm9yIChjb25zdCBrZXkgaW4gY2FsbGJhY2tzKSB7CiAgICAgIGVtaXRba2V5XSA9ICguLi5hcmdzKSA9PiB7CiAgICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICAgIGlmIChsaXN0ZW5lcnMyLmxlbmd0aCA9PT0gMCkKICAgICAgICAgIHJldHVybjsKICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVyczIpCiAgICAgICAgICBsaXN0ZW5lci5mbnNba2V5XT8uKC4uLmFyZ3MpOwogICAgICB9OwogICAgfQogICAgY29uc3QgY2xlYW51cCA9IGZuKGVtaXQpOwogICAgaWYgKHR5cGVvZiBjbGVhbnVwID09PSAiZnVuY3Rpb24iKQogICAgICBjbGVhbnVwQ2FjaGUuc2V0KG9ic2VydmVySWQsIGNsZWFudXApOwogICAgcmV0dXJuIHVud2F0Y2g7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvd2FpdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHdhaXQodGltZSkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMpID0+IHNldFRpbWVvdXQocmVzLCB0aW1lKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcG9sbC5qcwogIGZ1bmN0aW9uIHBvbGwoZm4sIHsgZW1pdE9uQmVnaW4sIGluaXRpYWxXYWl0VGltZSwgaW50ZXJ2YWwgfSkgewogICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICBjb25zdCB1bndhdGNoID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICBjb25zdCB3YXRjaCA9IGFzeW5jICgpID0+IHsKICAgICAgbGV0IGRhdGEgPSB2b2lkIDA7CiAgICAgIGlmIChlbWl0T25CZWdpbikKICAgICAgICBkYXRhID0gYXdhaXQgZm4oeyB1bnBvbGw6IHVud2F0Y2ggfSk7CiAgICAgIGNvbnN0IGluaXRpYWxXYWl0ID0gYXdhaXQgaW5pdGlhbFdhaXRUaW1lPy4oZGF0YSkgPz8gaW50ZXJ2YWw7CiAgICAgIGF3YWl0IHdhaXQoaW5pdGlhbFdhaXQpOwogICAgICBjb25zdCBwb2xsMiA9IGFzeW5jICgpID0+IHsKICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBhd2FpdCBmbih7IHVucG9sbDogdW53YXRjaCB9KTsKICAgICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgICBwb2xsMigpOwogICAgICB9OwogICAgICBwb2xsMigpOwogICAgfTsKICAgIHdhdGNoKCk7CiAgICByZXR1cm4gdW53YXRjaDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaENvbnRyYWN0RXZlbnQuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoQ2FjaGUuanMKICB2YXIgcHJvbWlzZUNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICB2YXIgcmVzcG9uc2VDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgZnVuY3Rpb24gZ2V0Q2FjaGUoY2FjaGVLZXkyKSB7CiAgICBjb25zdCBidWlsZENhY2hlID0gKGNhY2hlS2V5MywgY2FjaGUpID0+ICh7CiAgICAgIGNsZWFyOiAoKSA9PiBjYWNoZS5kZWxldGUoY2FjaGVLZXkzKSwKICAgICAgZ2V0OiAoKSA9PiBjYWNoZS5nZXQoY2FjaGVLZXkzKSwKICAgICAgc2V0OiAoZGF0YSkgPT4gY2FjaGUuc2V0KGNhY2hlS2V5MywgZGF0YSkKICAgIH0pOwogICAgY29uc3QgcHJvbWlzZSA9IGJ1aWxkQ2FjaGUoY2FjaGVLZXkyLCBwcm9taXNlQ2FjaGUpOwogICAgY29uc3QgcmVzcG9uc2UgPSBidWlsZENhY2hlKGNhY2hlS2V5MiwgcmVzcG9uc2VDYWNoZSk7CiAgICByZXR1cm4gewogICAgICBjbGVhcjogKCkgPT4gewogICAgICAgIHByb21pc2UuY2xlYXIoKTsKICAgICAgICByZXNwb25zZS5jbGVhcigpOwogICAgICB9LAogICAgICBwcm9taXNlLAogICAgICByZXNwb25zZQogICAgfTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gd2l0aENhY2hlKGZuLCB7IGNhY2hlS2V5OiBjYWNoZUtleTIsIGNhY2hlVGltZSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB9KSB7CiAgICBjb25zdCBjYWNoZSA9IGdldENhY2hlKGNhY2hlS2V5Mik7CiAgICBjb25zdCByZXNwb25zZSA9IGNhY2hlLnJlc3BvbnNlLmdldCgpOwogICAgaWYgKHJlc3BvbnNlICYmIGNhY2hlVGltZSA+IDApIHsKICAgICAgY29uc3QgYWdlID0gKC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSByZXNwb25zZS5jcmVhdGVkLmdldFRpbWUoKTsKICAgICAgaWYgKGFnZSA8IGNhY2hlVGltZSkKICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgIH0KICAgIGxldCBwcm9taXNlID0gY2FjaGUucHJvbWlzZS5nZXQoKTsKICAgIGlmICghcHJvbWlzZSkgewogICAgICBwcm9taXNlID0gZm4oKTsKICAgICAgY2FjaGUucHJvbWlzZS5zZXQocHJvbWlzZSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBkYXRhID0gYXdhaXQgcHJvbWlzZTsKICAgICAgY2FjaGUucmVzcG9uc2Uuc2V0KHsgY3JlYXRlZDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIGRhdGEgfSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSBmaW5hbGx5IHsKICAgICAgY2FjaGUucHJvbWlzZS5jbGVhcigpOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrTnVtYmVyLmpzCiAgdmFyIGNhY2hlS2V5ID0gKGlkKSA9PiBgYmxvY2tOdW1iZXIuJHtpZH1gOwogIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrTnVtYmVyKGNsaWVudCwgeyBjYWNoZVRpbWUgPSBjbGllbnQuY2FjaGVUaW1lIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBhd2FpdCB3aXRoQ2FjaGUoKCkgPT4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfYmxvY2tOdW1iZXIiCiAgICB9KSwgeyBjYWNoZUtleTogY2FjaGVLZXkoY2xpZW50LnVpZCksIGNhY2hlVGltZSB9KTsKICAgIHJldHVybiBCaWdJbnQoYmxvY2tOdW1iZXJIZXgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZpbHRlckNoYW5nZXMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRGaWx0ZXJDaGFuZ2VzKF9jbGllbnQsIHsgZmlsdGVyIH0pIHsKICAgIGNvbnN0IHN0cmljdCA9ICJzdHJpY3QiIGluIGZpbHRlciAmJiBmaWx0ZXIuc3RyaWN0OwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckNoYW5nZXMiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGlmICh0eXBlb2YgbG9nc1swXSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBsb2dzOwogICAgY29uc3QgZm9ybWF0dGVkTG9ncyA9IGxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKTsKICAgIGlmICghKCJhYmkiIGluIGZpbHRlcikgfHwgIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3VuaW5zdGFsbEZpbHRlci5qcwogIGFzeW5jIGZ1bmN0aW9uIHVuaW5zdGFsbEZpbHRlcihfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICByZXR1cm4gZmlsdGVyLnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfdW5pbnN0YWxsRmlsdGVyIiwKICAgICAgcGFyYW1zOiBbZmlsdGVyLmlkXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hDb250cmFjdEV2ZW50LmpzCiAgZnVuY3Rpb24gd2F0Y2hDb250cmFjdEV2ZW50KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJhdGNoID0gdHJ1ZSwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGVuYWJsZVBvbGxpbmcgPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHBvbGxfICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gcG9sbF87CiAgICAgIGlmICh0eXBlb2YgZnJvbUJsb2NrID09PSAiYmlnaW50IikKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siICYmIGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0c1swXS5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0pKCk7CiAgICBjb25zdCBwb2xsQ29udHJhY3RFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQ29udHJhY3RFdmVudCIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGJhdGNoLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZXZlbnROYW1lLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBzdHJpY3QsCiAgICAgICAgZnJvbUJsb2NrCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uTG9ncywgb25FcnJvciB9LCAoZW1pdCkgPT4gewogICAgICAgIGxldCBwcmV2aW91c0Jsb2NrTnVtYmVyOwogICAgICAgIGlmIChmcm9tQmxvY2sgIT09IHZvaWQgMCkKICAgICAgICAgIHByZXZpb3VzQmxvY2tOdW1iZXIgPSBmcm9tQmxvY2sgLSAxbjsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGxldCBpbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmaWx0ZXIgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLCAiY3JlYXRlQ29udHJhY3RFdmVudEZpbHRlciIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciA8IGJsb2NrTnVtYmVyKSB7CiAgICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICAgIGZyb21CbG9jazogcHJldmlvdXNCbG9ja051bWJlciArIDFuLAogICAgICAgICAgICAgICAgICB0b0Jsb2NrOiBibG9ja051bWJlciwKICAgICAgICAgICAgICAgICAgc3RyaWN0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUNvbnRyYWN0RXZlbnQgPSAoKSA9PiB7CiAgICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gZmFsc2U7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaENvbnRyYWN0RXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50TmFtZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgc3RyaWN0CiAgICAgIF0pOwogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgOwogICAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSAoKCkgPT4gewogICAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHMuZmluZCgodHJhbnNwb3J0MykgPT4gdHJhbnNwb3J0My5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpOwogICAgICAgICAgICAgICAgaWYgKCF0cmFuc3BvcnQyKQogICAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc3BvcnQyLnZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgY29uc3QgdG9waWNzID0gZXZlbnROYW1lID8gZW5jb2RlRXZlbnRUb3BpY3MoewogICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgYXJncwogICAgICAgICAgICB9KSA6IFtdOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJsb2dzIiwgeyBhZGRyZXNzLCB0b3BpY3MgfV0sCiAgICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBjb25zdCBsb2cgPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZXZlbnROYW1lOiBldmVudE5hbWUyLCBhcmdzOiBhcmdzMiB9ID0gZGVjb2RlRXZlbnRMb2coewogICAgICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgICB0b3BpY3M6IGxvZy50b3BpY3MsCiAgICAgICAgICAgICAgICAgICAgc3RyaWN0OiBzdHJpY3RfCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRMb2cobG9nLCB7CiAgICAgICAgICAgICAgICAgICAgYXJnczogYXJnczIsCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TmFtZTI7CiAgICAgICAgICAgICAgICAgIGxldCBpc1VubmFtZWQ7CiAgICAgICAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dEYXRhTWlzbWF0Y2ggfHwgZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUyID0gZXJyLmFiaUl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgICAgICBpc1VubmFtZWQgPSBlcnIuYWJpSXRlbS5pbnB1dHM/LnNvbWUoKHgpID0+ICEoIm5hbWUiIGluIHggJiYgeC5uYW1lKSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgewogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSkoKTsKICAgICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgICAgfSk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQ29udHJhY3RFdmVudCgpIDogc3Vic2NyaWJlQ29udHJhY3RFdmVudCgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FjY291bnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQWNjb3VudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICBzdXBlcihbCiAgICAgICAgIkNvdWxkIG5vdCBmaW5kIGFuIEFjY291bnQgdG8gZXhlY3V0ZSB3aXRoIHRoaXMgQWN0aW9uLiIsCiAgICAgICAgIlBsZWFzZSBwcm92aWRlIGFuIEFjY291bnQgd2l0aCB0aGUgYGFjY291bnRgIGFyZ3VtZW50IG9uIHRoZSBBY3Rpb24sIG9yIGJ5IHN1cHBseWluZyBhbiBgYWNjb3VudGAgdG8gdGhlIENsaWVudC4iCiAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgZG9jc1NsdWc6ICJhY2NvdW50IiwKICAgICAgICBuYW1lOiAiQWNjb3VudE5vdEZvdW5kRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEFjY291bnRUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5LCBtZXRhTWVzc2FnZXMsIHR5cGUgfSkgewogICAgICBzdXBlcihgQWNjb3VudCB0eXBlICIke3R5cGV9IiBpcyBub3Qgc3VwcG9ydGVkLmAsIHsKICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgIG1ldGFNZXNzYWdlcywKICAgICAgICBuYW1lOiAiQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2Jhc2UoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2Fzc2VydEN1cnJlbnRDaGFpbi5qcwogIGluaXRfY2hhaW4oKTsKICBmdW5jdGlvbiBhc3NlcnRDdXJyZW50Q2hhaW4oeyBjaGFpbiwgY3VycmVudENoYWluSWQgfSkgewogICAgaWYgKCFjaGFpbikKICAgICAgdGhyb3cgbmV3IENoYWluTm90Rm91bmRFcnJvcigpOwogICAgaWYgKGN1cnJlbnRDaGFpbklkICE9PSBjaGFpbi5pZCkKICAgICAgdGhyb3cgbmV3IENoYWluTWlzbWF0Y2hFcnJvcih7IGNoYWluLCBjdXJyZW50Q2hhaW5JZCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0VHJhbnNhY3Rpb25FcnJvci5qcwogIGluaXRfbm9kZSgpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2dldE5vZGVFcnJvcigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIC4uLmFyZ3MgfSkgewogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBjb25zdCBjYXVzZTIgPSBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKTsKICAgICAgaWYgKGNhdXNlMiBpbnN0YW5jZW9mIFVua25vd25Ob2RlRXJyb3IpCiAgICAgICAgcmV0dXJuIGVycjsKICAgICAgcmV0dXJuIGNhdXNlMjsKICAgIH0pKCk7CiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2xydSgpOwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFJhd1RyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2VuZFJhd1RyYW5zYWN0aW9uKGNsaWVudCwgeyBzZXJpYWxpemVkVHJhbnNhY3Rpb24gfSkgewogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NlbmRSYXdUcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbl0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zZW5kVHJhbnNhY3Rpb24uanMKICB2YXIgc3VwcG9ydHNXYWxsZXROYW1lc3BhY2UgPSBuZXcgTHJ1TWFwKDEyOCk7CiAgYXN5bmMgZnVuY3Rpb24gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIGJsb2JzLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJCbG9iR2FzLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdmFsdWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogbnVsbDsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QocGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IHRvID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgICBpZiAocGFyYW1ldGVycy50bykKICAgICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLnRvOwogICAgICAgIGlmIChhdXRob3JpemF0aW9uTGlzdCAmJiBhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggPiAwKQogICAgICAgICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyh7CiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGF1dGhvcml6YXRpb25MaXN0WzBdCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgdG9gIGlzIHJlcXVpcmVkLiBDb3VsZCBub3QgaW5mZXIgZnJvbSBgYXV0aG9yaXphdGlvbkxpc3RgLiIpOwogICAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgfSkoKTsKICAgICAgaWYgKGFjY291bnQ/LnR5cGUgPT09ICJqc29uLXJwYyIgfHwgYWNjb3VudCA9PT0gbnVsbCkgewogICAgICAgIGxldCBjaGFpbklkOwogICAgICAgIGlmIChjaGFpbiAhPT0gbnVsbCkgewogICAgICAgICAgY2hhaW5JZCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldENoYWluSWQsICJnZXRDaGFpbklkIikoe30pOwogICAgICAgICAgYXNzZXJ0Q3VycmVudENoYWluKHsKICAgICAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgICAgIGNoYWluCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAgIGJsb2JzLAogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgICBtYXhGZWVQZXJCbG9iR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUKICAgICAgICB9KTsKICAgICAgICBjb25zdCBtZXRob2QgPSBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5nZXQoY2xpZW50LnVpZCkgPyAid2FsbGV0X3NlbmRUcmFuc2FjdGlvbiIgOiAiZXRoX3NlbmRUcmFuc2FjdGlvbiI7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgcGFyYW1zOiBbcmVxdWVzdF0KICAgICAgICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIkludmFsaWRJbnB1dFJwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiTWV0aG9kTm90Rm91bmRScGNFcnJvciIgfHwgZXJyb3IubmFtZSA9PT0gIk1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIikKICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBtZXRob2Q6ICJ3YWxsZXRfc2VuZFRyYW5zYWN0aW9uIiwKICAgICAgICAgICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgICAgICAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSkudGhlbigoaGFzaDMpID0+IHsKICAgICAgICAgICAgICBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5zZXQoY2xpZW50LnVpZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0dXJuIGhhc2gzOwogICAgICAgICAgICB9KTsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gImxvY2FsIikgewogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LCAicHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdCIpKHsKICAgICAgICAgIGFjY291bnQsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3QsCiAgICAgICAgICBibG9icywKICAgICAgICAgIGNoYWluLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGdhcywKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBub25jZU1hbmFnZXI6IGFjY291bnQubm9uY2VNYW5hZ2VyLAogICAgICAgICAgcGFyYW1ldGVyczogWy4uLmRlZmF1bHRQYXJhbWV0ZXJzLCAic2lkZWNhcnMiXSwKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgLi4ucmVzdCwKICAgICAgICAgIHRvCiAgICAgICAgfSk7CiAgICAgICAgY29uc3Qgc2VyaWFsaXplciA9IGNoYWluPy5zZXJpYWxpemVycz8udHJhbnNhY3Rpb247CiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gYXdhaXQgYWNjb3VudC5zaWduVHJhbnNhY3Rpb24ocmVxdWVzdCwgewogICAgICAgICAgc2VyaWFsaXplcgogICAgICAgIH0pOwogICAgICAgIHJldHVybiBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBzZW5kUmF3VHJhbnNhY3Rpb24sICJzZW5kUmF3VHJhbnNhY3Rpb24iKSh7CiAgICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gInNtYXJ0IikKICAgICAgICB0aHJvdyBuZXcgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcih7CiAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgIkNvbnNpZGVyIHVzaW5nIHRoZSBgc2VuZFVzZXJPcGVyYXRpb25gIEFjdGlvbiBpbnN0ZWFkLiIKICAgICAgICAgIF0sCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvYnVuZGxlci9zZW5kVXNlck9wZXJhdGlvbiIsCiAgICAgICAgICB0eXBlOiAic21hcnQiCiAgICAgICAgfSk7CiAgICAgIHRocm93IG5ldyBBY2NvdW50VHlwZU5vdFN1cHBvcnRlZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIsCiAgICAgICAgdHlwZTogYWNjb3VudD8udHlwZQogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcikKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIHRocm93IGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7CiAgICAgICAgLi4ucGFyYW1ldGVycywKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBwYXJhbWV0ZXJzLmNoYWluIHx8IHZvaWQgMAogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC93cml0ZUNvbnRyYWN0LmpzCiAgYXN5bmMgZnVuY3Rpb24gd3JpdGVDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBhZGRyZXNzLCBhcmdzLCBkYXRhU3VmZml4LCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L3dyaXRlQ29udHJhY3QiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IG51bGw7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgcmV0dXJuIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHNlbmRUcmFuc2FjdGlvbiwgInNlbmRUcmFuc2FjdGlvbiIpKHsKICAgICAgICBkYXRhOiBgJHtkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgLi4ucmVxdWVzdAogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3Qvd3JpdGVDb250cmFjdCIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2dldENvbnRyYWN0LmpzCiAgZnVuY3Rpb24gZ2V0Q29udHJhY3QoeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGNsaWVudDogY2xpZW50XyB9KSB7CiAgICBjb25zdCBjbGllbnQgPSBjbGllbnRfOwogICAgY29uc3QgW3B1YmxpY0NsaWVudCwgd2FsbGV0Q2xpZW50XSA9ICgoKSA9PiB7CiAgICAgIGlmICghY2xpZW50KQogICAgICAgIHJldHVybiBbdm9pZCAwLCB2b2lkIDBdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50ICYmICJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW2NsaWVudC5wdWJsaWMsIGNsaWVudC53YWxsZXRdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50KQogICAgICAgIHJldHVybiBbY2xpZW50LnB1YmxpYywgdm9pZCAwXTsKICAgICAgaWYgKCJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW3ZvaWQgMCwgY2xpZW50LndhbGxldF07CiAgICAgIHJldHVybiBbY2xpZW50LCBjbGllbnRdOwogICAgfSkoKTsKICAgIGNvbnN0IGhhc1B1YmxpY0NsaWVudCA9IHB1YmxpY0NsaWVudCAhPT0gdm9pZCAwICYmIHB1YmxpY0NsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGhhc1dhbGxldENsaWVudCA9IHdhbGxldENsaWVudCAhPT0gdm9pZCAwICYmIHdhbGxldENsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGNvbnRyYWN0ID0ge307CiAgICBsZXQgaGFzUmVhZEZ1bmN0aW9uID0gZmFsc2U7CiAgICBsZXQgaGFzV3JpdGVGdW5jdGlvbiA9IGZhbHNlOwogICAgbGV0IGhhc0V2ZW50ID0gZmFsc2U7CiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgYWJpMikgewogICAgICBpZiAoaXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgIGlmIChpdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInZpZXciIHx8IGl0ZW0uc3RhdGVNdXRhYmlsaXR5ID09PSAicHVyZSIpCiAgICAgICAgICBoYXNSZWFkRnVuY3Rpb24gPSB0cnVlOwogICAgICAgIGVsc2UKICAgICAgICAgIGhhc1dyaXRlRnVuY3Rpb24gPSB0cnVlOwogICAgICBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICJldmVudCIpCiAgICAgICAgaGFzRXZlbnQgPSB0cnVlOwogICAgICBpZiAoaGFzUmVhZEZ1bmN0aW9uICYmIGhhc1dyaXRlRnVuY3Rpb24gJiYgaGFzRXZlbnQpCiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBpZiAoaGFzUHVibGljQ2xpZW50KSB7CiAgICAgIGlmIChoYXNSZWFkRnVuY3Rpb24pCiAgICAgICAgY29udHJhY3QucmVhZCA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0IikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGZ1bmN0aW9uTmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LnNpbXVsYXRlID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCBzaW11bGF0ZUNvbnRyYWN0LCAic2ltdWxhdGVDb250cmFjdCIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICBpZiAoaGFzRXZlbnQpIHsKICAgICAgICBjb250cmFjdC5jcmVhdGVFdmVudEZpbHRlciA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGV2ZW50TmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCBhYmlFdmVudCA9IGFiaTIuZmluZCgoeCkgPT4geC50eXBlID09PSAiZXZlbnQiICYmIHgubmFtZSA9PT0gZXZlbnROYW1lKTsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEV2ZW50UGFyYW1ldGVycyhwYXJhbWV0ZXJzLCBhYmlFdmVudCk7CiAgICAgICAgICAgICAgcmV0dXJuIGdldEFjdGlvbihwdWJsaWNDbGllbnQsIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIsICJjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyIikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGV2ZW50TmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgY29udHJhY3QuZ2V0RXZlbnRzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZXZlbnROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IGFiaUV2ZW50ID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgeC5uYW1lID09PSBldmVudE5hbWUpOwogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RXZlbnRQYXJhbWV0ZXJzKHBhcmFtZXRlcnMsIGFiaUV2ZW50KTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGNvbnRyYWN0LndhdGNoRXZlbnQgPSBuZXcgUHJveHkoe30sIHsKICAgICAgICAgIGdldChfLCBldmVudE5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuICguLi5wYXJhbWV0ZXJzKSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgYWJpRXZlbnQgPSBhYmkyLmZpbmQoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IiAmJiB4Lm5hbWUgPT09IGV2ZW50TmFtZSk7CiAgICAgICAgICAgICAgY29uc3QgeyBhcmdzLCBvcHRpb25zIH0gPSBnZXRFdmVudFBhcmFtZXRlcnMocGFyYW1ldGVycywgYWJpRXZlbnQpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCB3YXRjaENvbnRyYWN0RXZlbnQsICJ3YXRjaENvbnRyYWN0RXZlbnQiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgaWYgKGhhc1dhbGxldENsaWVudCkgewogICAgICBpZiAoaGFzV3JpdGVGdW5jdGlvbikKICAgICAgICBjb250cmFjdC53cml0ZSA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHdhbGxldENsaWVudCwgd3JpdGVDb250cmFjdCwgIndyaXRlQ29udHJhY3QiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGlmIChoYXNQdWJsaWNDbGllbnQgfHwgaGFzV2FsbGV0Q2xpZW50KSB7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LmVzdGltYXRlR2FzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIGNvbnN0IGNsaWVudDIgPSBwdWJsaWNDbGllbnQgPz8gd2FsbGV0Q2xpZW50OwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24oY2xpZW50MiwgZXN0aW1hdGVDb250cmFjdEdhcywgImVzdGltYXRlQ29udHJhY3RHYXMiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsCiAgICAgICAgICAgICAgICBhY2NvdW50OiBvcHRpb25zLmFjY291bnQgPz8gd2FsbGV0Q2xpZW50LmFjY291bnQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGNvbnRyYWN0LmFkZHJlc3MgPSBhZGRyZXNzOwogICAgY29udHJhY3QuYWJpID0gYWJpMjsKICAgIHJldHVybiBjb250cmFjdDsKICB9CiAgZnVuY3Rpb24gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHZhbHVlcykgewogICAgY29uc3QgaGFzQXJncyA9IHZhbHVlcy5sZW5ndGggJiYgQXJyYXkuaXNBcnJheSh2YWx1ZXNbMF0pOwogICAgY29uc3QgYXJncyA9IGhhc0FyZ3MgPyB2YWx1ZXNbMF0gOiBbXTsKICAgIGNvbnN0IG9wdGlvbnMgPSAoaGFzQXJncyA/IHZhbHVlc1sxXSA6IHZhbHVlc1swXSkgPz8ge307CiAgICByZXR1cm4geyBhcmdzLCBvcHRpb25zIH07CiAgfQogIGZ1bmN0aW9uIGdldEV2ZW50UGFyYW1ldGVycyh2YWx1ZXMsIGFiaUV2ZW50KSB7CiAgICBsZXQgaGFzQXJncyA9IGZhbHNlOwogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzWzBdKSkKICAgICAgaGFzQXJncyA9IHRydWU7CiAgICBlbHNlIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxKSB7CiAgICAgIGhhc0FyZ3MgPSBhYmlFdmVudC5pbnB1dHMuc29tZSgoeCkgPT4geC5pbmRleGVkKTsKICAgIH0gZWxzZSBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMikgewogICAgICBoYXNBcmdzID0gdHJ1ZTsKICAgIH0KICAgIGNvbnN0IGFyZ3MgPSBoYXNBcmdzID8gdmFsdWVzWzBdIDogdm9pZCAwOwogICAgY29uc3Qgb3B0aW9ucyA9IChoYXNBcmdzID8gdmFsdWVzWzFdIDogdmFsdWVzWzBdKSA/PyB7fTsKICAgIHJldHVybiB7IGFyZ3MsIG9wdGlvbnMgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZWlwNzEyLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgc3VwZXIoYE5vIEVJUC03MTIgZG9tYWluIGZvdW5kIG9uIGNvbnRyYWN0ICIke2FkZHJlc3N9Ii5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiRW5zdXJlIHRoYXQ6IiwKICAgICAgICAgIGAtIFRoZSBjb250cmFjdCBpcyBkZXBsb3llZCBhdCB0aGUgYWRkcmVzcyAiJHthZGRyZXNzfSIuYCwKICAgICAgICAgICItIGBlaXA3MTJEb21haW4oKWAgZnVuY3Rpb24gZXhpc3RzIG9uIHRoZSBjb250cmFjdC4iLAogICAgICAgICAgIi0gYGVpcDcxMkRvbWFpbigpYCBmdW5jdGlvbiBtYXRjaGVzIHNpZ25hdHVyZSB0byBFUkMtNTI2NyBzcGVjaWZpY2F0aW9uLiIKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFaXA3MTJEb21haW5Ob3RGb3VuZEVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RWlwNzEyRG9tYWluKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSB9ID0gcGFyYW1ldGVyczsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFtmaWVsZHMsIG5hbWUsIHZlcnNpb24zLCBjaGFpbklkLCB2ZXJpZnlpbmdDb250cmFjdCwgc2FsdCwgZXh0ZW5zaW9uc10gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgICAgYWJpLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgZnVuY3Rpb25OYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgICBmYWN0b3J5LAogICAgICAgIGZhY3RvcnlEYXRhCiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGRvbWFpbjogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIHZlcnNpb246IHZlcnNpb24zLAogICAgICAgICAgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpLAogICAgICAgICAgdmVyaWZ5aW5nQ29udHJhY3QsCiAgICAgICAgICBzYWx0CiAgICAgICAgfSwKICAgICAgICBleHRlbnNpb25zLAogICAgICAgIGZpZWxkcwogICAgICB9OwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgIGlmIChlcnJvci5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yIiAmJiBlcnJvci5jYXVzZS5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IiKSB7CiAgICAgICAgdGhyb3cgbmV3IEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICB9CiAgICAgIHRocm93IGVycm9yOwogICAgfQogIH0KICB2YXIgYWJpID0gWwogICAgewogICAgICBpbnB1dHM6IFtdLAogICAgICBuYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgb3V0cHV0czogWwogICAgICAgIHsgbmFtZTogImZpZWxkcyIsIHR5cGU6ICJieXRlczEiIH0sCiAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAidmVyc2lvbiIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAiY2hhaW5JZCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgIHsgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwgdHlwZTogImFkZHJlc3MiIH0sCiAgICAgICAgeyBuYW1lOiAic2FsdCIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIHsgbmFtZTogImV4dGVuc2lvbnMiLCB0eXBlOiAidWludDI1NltdIiB9CiAgICAgIF0sCiAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICB9CiAgXTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L2FkZENoYWluLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGFkZENoYWluKGNsaWVudCwgeyBjaGFpbiB9KSB7CiAgICBjb25zdCB7IGlkLCBuYW1lLCBuYXRpdmVDdXJyZW5jeSwgcnBjVXJscywgYmxvY2tFeHBsb3JlcnMgfSA9IGNoYWluOwogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfYWRkRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKSwKICAgICAgICAgIGNoYWluTmFtZTogbmFtZSwKICAgICAgICAgIG5hdGl2ZUN1cnJlbmN5LAogICAgICAgICAgcnBjVXJsczogcnBjVXJscy5kZWZhdWx0Lmh0dHAsCiAgICAgICAgICBibG9ja0V4cGxvcmVyVXJsczogYmxvY2tFeHBsb3JlcnMgPyBPYmplY3QudmFsdWVzKGJsb2NrRXhwbG9yZXJzKS5tYXAoKHsgdXJsIH0pID0+IHVybCkgOiB2b2lkIDAKICAgICAgICB9CiAgICAgIF0KICAgIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VpZC5qcwogIHZhciBzaXplMiA9IDI1NjsKICB2YXIgaW5kZXggPSBzaXplMjsKICB2YXIgYnVmZmVyOwogIGZ1bmN0aW9uIHVpZChsZW5ndGggPSAxMSkgewogICAgaWYgKCFidWZmZXIgfHwgaW5kZXggKyBsZW5ndGggPiBzaXplMiAqIDIpIHsKICAgICAgYnVmZmVyID0gIiI7CiAgICAgIGluZGV4ID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplMjsgaSsrKSB7CiAgICAgICAgYnVmZmVyICs9ICgyNTYgKyBNYXRoLnJhbmRvbSgpICogMjU2IHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGJ1ZmZlci5zdWJzdHJpbmcoaW5kZXgsIGluZGV4KysgKyBsZW5ndGgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGNhY2hlVGltZSA9IHBhcmFtZXRlcnMucG9sbGluZ0ludGVydmFsID8/IDRlMywgY2NpcFJlYWQsIGtleSA9ICJiYXNlIiwgbmFtZSA9ICJCYXNlIENsaWVudCIsIHBvbGxpbmdJbnRlcnZhbCA9IDRlMywgdHlwZSA9ICJiYXNlIiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNoYWluID0gcGFyYW1ldGVycy5jaGFpbjsKICAgIGNvbnN0IGFjY291bnQgPSBwYXJhbWV0ZXJzLmFjY291bnQgPyBwYXJzZUFjY291bnQocGFyYW1ldGVycy5hY2NvdW50KSA6IHZvaWQgMDsKICAgIGNvbnN0IHsgY29uZmlnLCByZXF1ZXN0LCB2YWx1ZSB9ID0gcGFyYW1ldGVycy50cmFuc3BvcnQoewogICAgICBjaGFpbiwKICAgICAgcG9sbGluZ0ludGVydmFsCiAgICB9KTsKICAgIGNvbnN0IHRyYW5zcG9ydCA9IHsgLi4uY29uZmlnLCAuLi52YWx1ZSB9OwogICAgY29uc3QgY2xpZW50ID0gewogICAgICBhY2NvdW50LAogICAgICBiYXRjaCwKICAgICAgY2FjaGVUaW1lLAogICAgICBjY2lwUmVhZCwKICAgICAgY2hhaW4sCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgcG9sbGluZ0ludGVydmFsLAogICAgICByZXF1ZXN0LAogICAgICB0cmFuc3BvcnQsCiAgICAgIHR5cGUsCiAgICAgIHVpZDogdWlkKCkKICAgIH07CiAgICBmdW5jdGlvbiBleHRlbmQoYmFzZTIpIHsKICAgICAgcmV0dXJuIChleHRlbmRGbikgPT4gewogICAgICAgIGNvbnN0IGV4dGVuZGVkID0gZXh0ZW5kRm4oYmFzZTIpOwogICAgICAgIGZvciAoY29uc3Qga2V5MiBpbiBjbGllbnQpCiAgICAgICAgICBkZWxldGUgZXh0ZW5kZWRba2V5Ml07CiAgICAgICAgY29uc3QgY29tYmluZWQgPSB7IC4uLmJhc2UyLCAuLi5leHRlbmRlZCB9OwogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNvbWJpbmVkLCB7IGV4dGVuZDogZXh0ZW5kKGNvbWJpbmVkKSB9KTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNsaWVudCwgeyBleHRlbmQ6IGV4dGVuZChjbGllbnQpIH0pOwogIH0KICBmdW5jdGlvbiBycGNTY2hlbWEoKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9idWlsZFJlcXVlc3QuanMKICBpbml0X2Jhc2UoKTsKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X3JwYygpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoRGVkdXBlLmpzCiAgaW5pdF9scnUoKTsKICB2YXIgcHJvbWlzZUNhY2hlMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTHJ1TWFwKDgxOTIpOwogIGZ1bmN0aW9uIHdpdGhEZWR1cGUoZm4sIHsgZW5hYmxlZCA9IHRydWUsIGlkIH0pIHsKICAgIGlmICghZW5hYmxlZCB8fCAhaWQpCiAgICAgIHJldHVybiBmbigpOwogICAgaWYgKHByb21pc2VDYWNoZTIuZ2V0KGlkKSkKICAgICAgcmV0dXJuIHByb21pc2VDYWNoZTIuZ2V0KGlkKTsKICAgIGNvbnN0IHByb21pc2UgPSBmbigpLmZpbmFsbHkoKCkgPT4gcHJvbWlzZUNhY2hlMi5kZWxldGUoaWQpKTsKICAgIHByb21pc2VDYWNoZTIuc2V0KGlkLCBwcm9taXNlKTsKICAgIHJldHVybiBwcm9taXNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Byb21pc2Uvd2l0aFJldHJ5LmpzCiAgZnVuY3Rpb24gd2l0aFJldHJ5KGZuLCB7IGRlbGF5OiBkZWxheV8gPSAxMDAsIHJldHJ5Q291bnQgPSAyLCBzaG91bGRSZXRyeTogc2hvdWxkUmV0cnkyID0gKCkgPT4gdHJ1ZSB9ID0ge30pIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IGF0dGVtcHRSZXRyeSA9IGFzeW5jICh7IGNvdW50ID0gMCB9ID0ge30pID0+IHsKICAgICAgICBjb25zdCByZXRyeSA9IGFzeW5jICh7IGVycm9yIH0pID0+IHsKICAgICAgICAgIGNvbnN0IGRlbGF5ID0gdHlwZW9mIGRlbGF5XyA9PT0gImZ1bmN0aW9uIiA/IGRlbGF5Xyh7IGNvdW50LCBlcnJvciB9KSA6IGRlbGF5XzsKICAgICAgICAgIGlmIChkZWxheSkKICAgICAgICAgICAgYXdhaXQgd2FpdChkZWxheSk7CiAgICAgICAgICBhdHRlbXB0UmV0cnkoeyBjb3VudDogY291bnQgKyAxIH0pOwogICAgICAgIH07CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmbigpOwogICAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGlmIChjb3VudCA8IHJldHJ5Q291bnQgJiYgYXdhaXQgc2hvdWxkUmV0cnkyKHsgY291bnQsIGVycm9yOiBlcnIgfSkpCiAgICAgICAgICAgIHJldHVybiByZXRyeSh7IGVycm9yOiBlcnIgfSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIGF0dGVtcHRSZXRyeSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYnVpbGRSZXF1ZXN0LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBmdW5jdGlvbiBidWlsZFJlcXVlc3QocmVxdWVzdCwgb3B0aW9ucyA9IHt9KSB7CiAgICByZXR1cm4gYXN5bmMgKGFyZ3MsIG92ZXJyaWRlT3B0aW9ucyA9IHt9KSA9PiB7CiAgICAgIGNvbnN0IHsgZGVkdXBlID0gZmFsc2UsIHJldHJ5RGVsYXkgPSAxNTAsIHJldHJ5Q291bnQgPSAzLCB1aWQ6IHVpZDIgfSA9IHsKICAgICAgICAuLi5vcHRpb25zLAogICAgICAgIC4uLm92ZXJyaWRlT3B0aW9ucwogICAgICB9OwogICAgICBjb25zdCByZXF1ZXN0SWQgPSBkZWR1cGUgPyBrZWNjYWsyNTYoc3RyaW5nVG9IZXgoYCR7dWlkMn0uJHtzdHJpbmdpZnkoYXJncyl9YCkpIDogdm9pZCAwOwogICAgICByZXR1cm4gd2l0aERlZHVwZSgoKSA9PiB3aXRoUmV0cnkoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVxdWVzdChhcmdzKTsKICAgICAgICB9IGNhdGNoIChlcnJfKSB7CiAgICAgICAgICBjb25zdCBlcnIgPSBlcnJfOwogICAgICAgICAgc3dpdGNoIChlcnIuY29kZSkgewogICAgICAgICAgICAvLyAtMzI3MDAKICAgICAgICAgICAgY2FzZSBQYXJzZVJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNlUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyNjAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFJlcXVlc3RScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjYwMQogICAgICAgICAgICBjYXNlIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90Rm91bmRScGNFcnJvcihlcnIsIHsgbWV0aG9kOiBhcmdzLm1ldGhvZCB9KTsKICAgICAgICAgICAgLy8gLTMyNjAyCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFBhcmFtc1JwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbXNScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzI2MDMKICAgICAgICAgICAgY2FzZSBJbnRlcm5hbFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZElucHV0UnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZElucHV0UnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAxCiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlc291cmNlTm90Rm91bmRScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzIwMDIKICAgICAgICAgICAgY2FzZSBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjAwMwogICAgICAgICAgICBjYXNlIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA0CiAgICAgICAgICAgIGNhc2UgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IoZXJyLCB7CiAgICAgICAgICAgICAgICBtZXRob2Q6IGFyZ3MubWV0aG9kCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIC0zMjAwNQogICAgICAgICAgICBjYXNlIExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA2CiAgICAgICAgICAgIGNhc2UgSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MDAxCiAgICAgICAgICAgIGNhc2UgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MTAwCiAgICAgICAgICAgIGNhc2UgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQyMDAKICAgICAgICAgICAgY2FzZSBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQ5MDAKICAgICAgICAgICAgY2FzZSBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gNDkwMQogICAgICAgICAgICBjYXNlIENoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2hhaW5EaXNjb25uZWN0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0OTAyCiAgICAgICAgICAgIGNhc2UgU3dpdGNoQ2hhaW5FcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBTd2l0Y2hDaGFpbkVycm9yKGVycik7CiAgICAgICAgICAgIC8vIENBSVAtMjU6IFVzZXIgUmVqZWN0ZWQgRXJyb3IKICAgICAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLndhbGxldGNvbm5lY3QuY29tLzIuMC9zcGVjcy9jbGllbnRzL3NpZ24vZXJyb3ItY29kZXMjcmVqZWN0ZWQtY2FpcC0yNQogICAgICAgICAgICBjYXNlIDVlMzoKICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yKGVycik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgaWYgKGVycl8gaW5zdGFuY2VvZiBCYXNlRXJyb3IyKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyXzsKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5rbm93blJwY0Vycm9yKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZGVsYXk6ICh7IGNvdW50LCBlcnJvciB9KSA9PiB7CiAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yKSB7CiAgICAgICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBlcnJvcj8uaGVhZGVycz8uZ2V0KCJSZXRyeS1BZnRlciIpOwogICAgICAgICAgICBpZiAocmV0cnlBZnRlcj8ubWF0Y2goL1xkLykpCiAgICAgICAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUludChyZXRyeUFmdGVyKSAqIDFlMzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB+figxIDw8IGNvdW50KSAqIHJldHJ5RGVsYXk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHNob3VsZFJldHJ5OiAoeyBlcnJvciB9KSA9PiBzaG91bGRSZXRyeShlcnJvcikKICAgICAgfSksIHsgZW5hYmxlZDogZGVkdXBlLCBpZDogcmVxdWVzdElkIH0pOwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkUmV0cnkoZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSAtMSkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLmNvZGUgPT09IExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3IuY29kZSA9PT0gSW50ZXJuYWxScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yICYmIGVycm9yLnN0YXR1cykgewogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwOCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDEzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MjkpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwMCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNTAyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA1MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwNCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2NyZWF0ZVRyYW5zcG9ydC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zcG9ydCh7IGtleSwgbmFtZSwgcmVxdWVzdCwgcmV0cnlDb3VudCA9IDMsIHJldHJ5RGVsYXkgPSAxNTAsIHRpbWVvdXQsIHR5cGUgfSwgdmFsdWUpIHsKICAgIGNvbnN0IHVpZDIgPSB1aWQoKTsKICAgIHJldHVybiB7CiAgICAgIGNvbmZpZzogewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIHJlcXVlc3QsCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZQogICAgICB9LAogICAgICByZXF1ZXN0OiBidWlsZFJlcXVlc3QocmVxdWVzdCwgeyByZXRyeUNvdW50LCByZXRyeURlbGF5LCB1aWQ6IHVpZDIgfSksCiAgICAgIHZhbHVlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvdHJhbnNwb3J0cy9jdXN0b20uanMKICBmdW5jdGlvbiBjdXN0b20ocHJvdmlkZXIsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtleSA9ICJjdXN0b20iLCBuYW1lID0gIkN1c3RvbSBQcm92aWRlciIsIHJldHJ5RGVsYXkgfSA9IGNvbmZpZzsKICAgIHJldHVybiAoeyByZXRyeUNvdW50OiBkZWZhdWx0UmV0cnlDb3VudCB9KSA9PiBjcmVhdGVUcmFuc3BvcnQoewogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHJlcXVlc3Q6IHByb3ZpZGVyLnJlcXVlc3QuYmluZChwcm92aWRlciksCiAgICAgIHJldHJ5Q291bnQ6IGNvbmZpZy5yZXRyeUNvdW50ID8/IGRlZmF1bHRSZXRyeUNvdW50LAogICAgICByZXRyeURlbGF5LAogICAgICB0eXBlOiAiY3VzdG9tIgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2ZhbGxiYWNrLmpzCiAgaW5pdF9ycGMoKTsKICBmdW5jdGlvbiBmYWxsYmFjayh0cmFuc3BvcnRzXywgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsga2V5ID0gImZhbGxiYWNrIiwgbmFtZSA9ICJGYWxsYmFjayIsIHJhbmsgPSBmYWxzZSwgcmV0cnlDb3VudCwgcmV0cnlEZWxheSB9ID0gY29uZmlnOwogICAgcmV0dXJuICh7IGNoYWluLCBwb2xsaW5nSW50ZXJ2YWwgPSA0ZTMsIHRpbWVvdXQsIC4uLnJlc3QgfSkgPT4gewogICAgICBsZXQgdHJhbnNwb3J0cyA9IHRyYW5zcG9ydHNfOwogICAgICBsZXQgb25SZXNwb25zZSA9ICgpID0+IHsKICAgICAgfTsKICAgICAgY29uc3QgdHJhbnNwb3J0ID0gY3JlYXRlVHJhbnNwb3J0KHsKICAgICAgICBrZXksCiAgICAgICAgbmFtZSwKICAgICAgICBhc3luYyByZXF1ZXN0KHsgbWV0aG9kLCBwYXJhbXMgfSkgewogICAgICAgICAgY29uc3QgZmV0Y2gyID0gYXN5bmMgKGkgPSAwKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSB0cmFuc3BvcnRzW2ldKHsKICAgICAgICAgICAgICAuLi5yZXN0LAogICAgICAgICAgICAgIGNoYWluLAogICAgICAgICAgICAgIHJldHJ5Q291bnQ6IDAsCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRyYW5zcG9ydDIucmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2QsCiAgICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBvblJlc3BvbnNlKHsKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHJlc3BvbnNlLAogICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQyLAogICAgICAgICAgICAgICAgc3RhdHVzOiAic3VjY2VzcyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIG9uUmVzcG9uc2UoewogICAgICAgICAgICAgICAgZXJyb3I6IGVyciwKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0MiwKICAgICAgICAgICAgICAgIHN0YXR1czogImVycm9yIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlmIChzaG91bGRUaHJvdyhlcnIpKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgIGlmIChpID09PSB0cmFuc3BvcnRzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgcmV0dXJuIGZldGNoMihpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gZmV0Y2gyKCk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHJldHJ5RGVsYXksCiAgICAgICAgdHlwZTogImZhbGxiYWNrIgogICAgICB9LCB7CiAgICAgICAgb25SZXNwb25zZTogKGZuKSA9PiBvblJlc3BvbnNlID0gZm4sCiAgICAgICAgdHJhbnNwb3J0czogdHJhbnNwb3J0cy5tYXAoKGZuKSA9PiBmbih7IGNoYWluLCByZXRyeUNvdW50OiAwIH0pKQogICAgICB9KTsKICAgICAgaWYgKHJhbmspIHsKICAgICAgICBjb25zdCByYW5rT3B0aW9ucyA9IHR5cGVvZiByYW5rID09PSAib2JqZWN0IiA/IHJhbmsgOiB7fTsKICAgICAgICByYW5rVHJhbnNwb3J0cyh7CiAgICAgICAgICBjaGFpbiwKICAgICAgICAgIGludGVydmFsOiByYW5rT3B0aW9ucy5pbnRlcnZhbCA/PyBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgICBvblRyYW5zcG9ydHM6ICh0cmFuc3BvcnRzXzIpID0+IHRyYW5zcG9ydHMgPSB0cmFuc3BvcnRzXzIsCiAgICAgICAgICBzYW1wbGVDb3VudDogcmFua09wdGlvbnMuc2FtcGxlQ291bnQsCiAgICAgICAgICB0aW1lb3V0OiByYW5rT3B0aW9ucy50aW1lb3V0LAogICAgICAgICAgdHJhbnNwb3J0cywKICAgICAgICAgIHdlaWdodHM6IHJhbmtPcHRpb25zLndlaWdodHMKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gdHJhbnNwb3J0OwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkVGhyb3coZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSA1ZTMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGZ1bmN0aW9uIHJhbmtUcmFuc3BvcnRzKHsgY2hhaW4sIGludGVydmFsID0gNGUzLCBvblRyYW5zcG9ydHMsIHNhbXBsZUNvdW50ID0gMTAsIHRpbWVvdXQgPSAxZTMsIHRyYW5zcG9ydHMsIHdlaWdodHMgPSB7fSB9KSB7CiAgICBjb25zdCB7IHN0YWJpbGl0eTogc3RhYmlsaXR5V2VpZ2h0ID0gMC43LCBsYXRlbmN5OiBsYXRlbmN5V2VpZ2h0ID0gMC4zIH0gPSB3ZWlnaHRzOwogICAgY29uc3Qgc2FtcGxlcyA9IFtdOwogICAgY29uc3QgcmFua1RyYW5zcG9ydHNfID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBzYW1wbGUgPSBhd2FpdCBQcm9taXNlLmFsbCh0cmFuc3BvcnRzLm1hcChhc3luYyAodHJhbnNwb3J0KSA9PiB7CiAgICAgICAgY29uc3QgdHJhbnNwb3J0XyA9IHRyYW5zcG9ydCh7IGNoYWluLCByZXRyeUNvdW50OiAwLCB0aW1lb3V0IH0pOwogICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTsKICAgICAgICBsZXQgZW5kOwogICAgICAgIGxldCBzdWNjZXNzOwogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCB0cmFuc3BvcnRfLnJlcXVlc3QoeyBtZXRob2Q6ICJuZXRfbGlzdGVuaW5nIiB9KTsKICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgc3VjY2VzcyA9IDA7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGVuZCA9IERhdGUubm93KCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxhdGVuY3kgPSBlbmQgLSBzdGFydDsKICAgICAgICByZXR1cm4geyBsYXRlbmN5LCBzdWNjZXNzIH07CiAgICAgIH0pKTsKICAgICAgc2FtcGxlcy5wdXNoKHNhbXBsZSk7CiAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA+IHNhbXBsZUNvdW50KQogICAgICAgIHNhbXBsZXMuc2hpZnQoKTsKICAgICAgY29uc3QgbWF4TGF0ZW5jeSA9IE1hdGgubWF4KC4uLnNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBNYXRoLm1heCguLi5zYW1wbGUyLm1hcCgoeyBsYXRlbmN5IH0pID0+IGxhdGVuY3kpKSkpOwogICAgICBjb25zdCBzY29yZXMgPSB0cmFuc3BvcnRzLm1hcCgoXywgaSkgPT4gewogICAgICAgIGNvbnN0IGxhdGVuY2llcyA9IHNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBzYW1wbGUyW2ldLmxhdGVuY3kpOwogICAgICAgIGNvbnN0IG1lYW5MYXRlbmN5ID0gbGF0ZW5jaWVzLnJlZHVjZSgoYWNjLCBsYXRlbmN5KSA9PiBhY2MgKyBsYXRlbmN5LCAwKSAvIGxhdGVuY2llcy5sZW5ndGg7CiAgICAgICAgY29uc3QgbGF0ZW5jeVNjb3JlID0gMSAtIG1lYW5MYXRlbmN5IC8gbWF4TGF0ZW5jeTsKICAgICAgICBjb25zdCBzdWNjZXNzZXMgPSBzYW1wbGVzLm1hcCgoc2FtcGxlMikgPT4gc2FtcGxlMltpXS5zdWNjZXNzKTsKICAgICAgICBjb25zdCBzdGFiaWxpdHlTY29yZSA9IHN1Y2Nlc3Nlcy5yZWR1Y2UoKGFjYywgc3VjY2VzcykgPT4gYWNjICsgc3VjY2VzcywgMCkgLyBzdWNjZXNzZXMubGVuZ3RoOwogICAgICAgIGlmIChzdGFiaWxpdHlTY29yZSA9PT0gMCkKICAgICAgICAgIHJldHVybiBbMCwgaV07CiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgIGxhdGVuY3lXZWlnaHQgKiBsYXRlbmN5U2NvcmUgKyBzdGFiaWxpdHlXZWlnaHQgKiBzdGFiaWxpdHlTY29yZSwKICAgICAgICAgIGkKICAgICAgICBdOwogICAgICB9KS5zb3J0KChhLCBiKSA9PiBiWzBdIC0gYVswXSk7CiAgICAgIG9uVHJhbnNwb3J0cyhzY29yZXMubWFwKChbLCBpXSkgPT4gdHJhbnNwb3J0c1tpXSkpOwogICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgICB9OwogICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc3BvcnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgVXJsUmVxdWlyZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoIk5vIFVSTCB3YXMgcHJvdmlkZWQgdG8gdGhlIFRyYW5zcG9ydC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBSUEMgVVJMIHRvIHRoZSBUcmFuc3BvcnQuIiwgewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY2xpZW50cy9pbnRybyIsCiAgICAgICAgbmFtZTogIlVybFJlcXVpcmVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL3RyYW5zcG9ydHMvaHR0cC5qcwogIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9odHRwLmpzCiAgaW5pdF9yZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhUaW1lb3V0LmpzCiAgZnVuY3Rpb24gd2l0aFRpbWVvdXQoZm4sIHsgZXJyb3JJbnN0YW5jZSA9IG5ldyBFcnJvcigidGltZWQgb3V0IiksIHRpbWVvdXQsIHNpZ25hbCB9KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICA7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgbGV0IHRpbWVvdXRJZDsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgICAgICAgIGlmICh0aW1lb3V0ID4gMCkgewogICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoc2lnbmFsKSB7CiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlamVjdChlcnJvckluc3RhbmNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHRpbWVvdXQpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShhd2FpdCBmbih7IHNpZ25hbDogY29udHJvbGxlcj8uc2lnbmFsIHx8IG51bGwgfSkpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVycj8ubmFtZSA9PT0gIkFib3J0RXJyb3IiKQogICAgICAgICAgICByZWplY3QoZXJyb3JJbnN0YW5jZSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2h0dHAuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2lkLmpzCiAgZnVuY3Rpb24gY3JlYXRlSWRTdG9yZSgpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnQ6IDAsCiAgICAgIHRha2UoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudCsrOwogICAgICB9LAogICAgICByZXNldCgpIHsKICAgICAgICB0aGlzLmN1cnJlbnQgPSAwOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgaWRDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBjcmVhdGVJZFN0b3JlKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvaHR0cC5qcwogIGZ1bmN0aW9uIGdldEh0dHBScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIHJlcXVlc3QocGFyYW1zKSB7CiAgICAgICAgY29uc3QgeyBib2R5LCBvblJlcXVlc3QgPSBvcHRpb25zLm9uUmVxdWVzdCwgb25SZXNwb25zZSA9IG9wdGlvbnMub25SZXNwb25zZSwgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCA/PyAxZTQgfSA9IHBhcmFtczsKICAgICAgICBjb25zdCBmZXRjaE9wdGlvbnMgPSB7CiAgICAgICAgICAuLi5vcHRpb25zLmZldGNoT3B0aW9ucyA/PyB7fSwKICAgICAgICAgIC4uLnBhcmFtcy5mZXRjaE9wdGlvbnMgPz8ge30KICAgICAgICB9OwogICAgICAgIGNvbnN0IHsgaGVhZGVycywgbWV0aG9kLCBzaWduYWw6IHNpZ25hbF8gfSA9IGZldGNoT3B0aW9uczsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3aXRoVGltZW91dChhc3luYyAoeyBzaWduYWwgfSkgPT4gewogICAgICAgICAgICBjb25zdCBpbml0ID0gewogICAgICAgICAgICAgIC4uLmZldGNoT3B0aW9ucywKICAgICAgICAgICAgICBib2R5OiBBcnJheS5pc0FycmF5KGJvZHkpID8gc3RyaW5naWZ5KGJvZHkubWFwKChib2R5MikgPT4gKHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkyLmlkID8/IGlkQ2FjaGUudGFrZSgpLAogICAgICAgICAgICAgICAgLi4uYm9keTIKICAgICAgICAgICAgICB9KSkpIDogc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkuaWQgPz8gaWRDYWNoZS50YWtlKCksCiAgICAgICAgICAgICAgICAuLi5ib2R5CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIC4uLmhlYWRlcnMKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kIHx8ICJQT1NUIiwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbF8gfHwgKHRpbWVvdXQgPiAwID8gc2lnbmFsIDogbnVsbCkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KHVybCwgaW5pdCk7CiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBhd2FpdCBvblJlcXVlc3Q/LihyZXF1ZXN0LCBpbml0KSA/PyB7IC4uLmluaXQsIHVybCB9OwogICAgICAgICAgICBjb25zdCByZXNwb25zZTIgPSBhd2FpdCBmZXRjaChhcmdzLnVybCA/PyB1cmwsIGFyZ3MpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UyOwogICAgICAgICAgfSwgewogICAgICAgICAgICBlcnJvckluc3RhbmNlOiBuZXcgVGltZW91dEVycm9yKHsgYm9keSwgdXJsIH0pLAogICAgICAgICAgICB0aW1lb3V0LAogICAgICAgICAgICBzaWduYWw6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKG9uUmVzcG9uc2UpCiAgICAgICAgICAgIGF3YWl0IG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhIHx8ICJ7fSIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgZGF0YSA9IHsgZXJyb3I6IGRhdGEgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICB0aHJvdyBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBkZXRhaWxzOiBzdHJpbmdpZnkoZGF0YS5lcnJvcikgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCwKICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLAogICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICAgIHVybAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEh0dHBSZXF1ZXN0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBUaW1lb3V0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIHRocm93IG5ldyBIdHRwUmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICAgICAgdXJsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBmdW5jdGlvbiBodHRwKHVybCwgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGZldGNoT3B0aW9ucywga2V5ID0gImh0dHAiLCBuYW1lID0gIkhUVFAgSlNPTi1SUEMiLCBvbkZldGNoUmVxdWVzdCwgb25GZXRjaFJlc3BvbnNlLCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHsgYmF0Y2hTaXplID0gMWUzLCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBiYXRjaCA9PT0gIm9iamVjdCIgPyBiYXRjaCA6IHt9OwogICAgICBjb25zdCByZXRyeUNvdW50ID0gY29uZmlnLnJldHJ5Q291bnQgPz8gcmV0cnlDb3VudF87CiAgICAgIGNvbnN0IHRpbWVvdXQgPSB0aW1lb3V0XyA/PyBjb25maWcudGltZW91dCA/PyAxZTQ7CiAgICAgIGNvbnN0IHVybF8gPSB1cmwgfHwgY2hhaW4/LnJwY1VybHMuZGVmYXVsdC5odHRwWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgY29uc3QgcnBjQ2xpZW50ID0gZ2V0SHR0cFJwY0NsaWVudCh1cmxfLCB7CiAgICAgICAgZmV0Y2hPcHRpb25zLAogICAgICAgIG9uUmVxdWVzdDogb25GZXRjaFJlcXVlc3QsCiAgICAgICAgb25SZXNwb25zZTogb25GZXRjaFJlc3BvbnNlLAogICAgICAgIHRpbWVvdXQKICAgICAgfSk7CiAgICAgIHJldHVybiBjcmVhdGVUcmFuc3BvcnQoewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIGFzeW5jIHJlcXVlc3QoeyBtZXRob2QsIHBhcmFtcyB9KSB7CiAgICAgICAgICBjb25zdCBib2R5ID0geyBtZXRob2QsIHBhcmFtcyB9OwogICAgICAgICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICAgICAgICBpZDogdXJsXywKICAgICAgICAgICAgd2FpdDogd2FpdDIsCiAgICAgICAgICAgIHNob3VsZFNwbGl0QmF0Y2gocmVxdWVzdHMpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdHMubGVuZ3RoID4gYmF0Y2hTaXplOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmbjogKGJvZHkyKSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgICAgYm9keTogYm9keTIKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHNvcnQ6IChhLCBiKSA9PiBhLmlkIC0gYi5pZAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCBmbiA9IGFzeW5jIChib2R5MikgPT4gYmF0Y2ggPyBzY2hlZHVsZShib2R5MikgOiBbCiAgICAgICAgICAgIGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBib2R5OiBib2R5MgogICAgICAgICAgICB9KQogICAgICAgICAgXTsKICAgICAgICAgIGNvbnN0IFt7IGVycm9yLCByZXN1bHQgfV0gPSBhd2FpdCBmbihib2R5KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogImh0dHAiCiAgICAgIH0sIHsKICAgICAgICBmZXRjaE9wdGlvbnMsCiAgICAgICAgdXJsOiB1cmxfCiAgICAgIH0pOwogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGluaXRfdHJpbSgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9lcnJvcnMuanMKICBpbml0X3NvbGlkaXR5KCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGZ1bmN0aW9uIGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCBjYWxsVHlwZSkgewogICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMikpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGNhdXNlID0gZXJyLndhbGsoKGUpID0+IGUgaW5zdGFuY2VvZiBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcik7CiAgICBpZiAoIShjYXVzZSBpbnN0YW5jZW9mIENvbnRyYWN0RnVuY3Rpb25SZXZlcnRlZEVycm9yKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyTm90Rm91bmQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJSZXNvbHZlcldpbGRjYXJkTm90U3VwcG9ydGVkIikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2F1c2UuZGF0YT8uZXJyb3JOYW1lID09PSAiUmVzb2x2ZXJOb3RDb250cmFjdCIpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJIdHRwRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5yZWFzb24/LmluY2x1ZGVzKCJXaWxkY2FyZCBvbiBub24tZXh0ZW5kZWQgcmVzb2x2ZXJzIGlzIG5vdCBzdXBwb3J0ZWQiKSkKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2FsbFR5cGUgPT09ICJyZXZlcnNlIiAmJiBjYXVzZS5yZWFzb24gPT09IHBhbmljUmVhc29uc1s1MF0pCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvZW5jb2RlZExhYmVsVG9MYWJlbGhhc2guanMKICBpbml0X2lzSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHsKICAgIGlmIChsYWJlbC5sZW5ndGggIT09IDY2KQogICAgICByZXR1cm4gbnVsbDsKICAgIGlmIChsYWJlbC5pbmRleE9mKCJbIikgIT09IDApCiAgICAgIHJldHVybiBudWxsOwogICAgaWYgKGxhYmVsLmluZGV4T2YoIl0iKSAhPT0gNjUpCiAgICAgIHJldHVybiBudWxsOwogICAgY29uc3QgaGFzaDMgPSBgMHgke2xhYmVsLnNsaWNlKDEsIDY1KX1gOwogICAgaWYgKCFpc0hleChoYXNoMykpCiAgICAgIHJldHVybiBudWxsOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGZ1bmN0aW9uIG5hbWVoYXNoKG5hbWUpIHsKICAgIGxldCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbmFtZSkKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICAgIGNvbnN0IGxhYmVscyA9IG5hbWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSBsYWJlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpIC09IDEpIHsKICAgICAgY29uc3QgaGFzaEZyb21FbmNvZGVkTGFiZWwgPSBlbmNvZGVkTGFiZWxUb0xhYmVsaGFzaChsYWJlbHNbaV0pOwogICAgICBjb25zdCBoYXNoZWQgPSBoYXNoRnJvbUVuY29kZWRMYWJlbCA/IHRvQnl0ZXMoaGFzaEZyb21FbmNvZGVkTGFiZWwpIDoga2VjY2FrMjU2KHN0cmluZ1RvQnl0ZXMobGFiZWxzW2ldKSwgImJ5dGVzIik7CiAgICAgIHJlc3VsdCA9IGtlY2NhazI1Nihjb25jYXQoW3Jlc3VsdCwgaGFzaGVkXSksICJieXRlcyIpOwogICAgfQogICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvcGFja2V0VG9CeXRlcy5qcwogIGluaXRfdG9CeXRlcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2VuY29kZUxhYmVsaGFzaC5qcwogIGZ1bmN0aW9uIGVuY29kZUxhYmVsaGFzaChoYXNoMykgewogICAgcmV0dXJuIGBbJHtoYXNoMy5zbGljZSgyKX1dYDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvbGFiZWxoYXNoLmpzCiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgZnVuY3Rpb24gbGFiZWxoYXNoKGxhYmVsKSB7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbGFiZWwpCiAgICAgIHJldHVybiBieXRlc1RvSGV4KHJlc3VsdCk7CiAgICByZXR1cm4gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHx8IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGxhYmVsKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL3BhY2tldFRvQnl0ZXMuanMKICBmdW5jdGlvbiBwYWNrZXRUb0J5dGVzKHBhY2tldCkgewogICAgY29uc3QgdmFsdWUgPSBwYWNrZXQucmVwbGFjZSgvXlwufFwuJC9nbSwgIiIpOwogICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDEpOwogICAgY29uc3QgYnl0ZXMyID0gbmV3IFVpbnQ4QXJyYXkoc3RyaW5nVG9CeXRlcyh2YWx1ZSkuYnl0ZUxlbmd0aCArIDIpOwogICAgbGV0IG9mZnNldCA9IDA7CiAgICBjb25zdCBsaXN0ID0gdmFsdWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewogICAgICBsZXQgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMobGlzdFtpXSk7CiAgICAgIGlmIChlbmNvZGVkLmJ5dGVMZW5ndGggPiAyNTUpCiAgICAgICAgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMoZW5jb2RlTGFiZWxoYXNoKGxhYmVsaGFzaChsaXN0W2ldKSkpOwogICAgICBieXRlczJbb2Zmc2V0XSA9IGVuY29kZWQubGVuZ3RoOwogICAgICBieXRlczIuc2V0KGVuY29kZWQsIG9mZnNldCArIDEpOwogICAgICBvZmZzZXQgKz0gZW5jb2RlZC5sZW5ndGggKyAxOwogICAgfQogICAgaWYgKGJ5dGVzMi5ieXRlTGVuZ3RoICE9PSBvZmZzZXQgKyAxKQogICAgICByZXR1cm4gYnl0ZXMyLnNsaWNlKDAsIG9mZnNldCArIDEpOwogICAgcmV0dXJuIGJ5dGVzMjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBjb2luVHlwZSwgbmFtZSwgZ2F0ZXdheVVybHMsIHN0cmljdCwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBmdW5jdGlvbkRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoewogICAgICAgIGFiaTogYWRkcmVzc1Jlc29sdmVyQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogImFkZHIiLAogICAgICAgIC4uLmNvaW5UeXBlICE9IG51bGwgPyB7IGFyZ3M6IFtuYW1laGFzaChuYW1lKSwgQmlnSW50KGNvaW5UeXBlKV0gfSA6IHsgYXJnczogW25hbWVoYXNoKG5hbWUpXSB9CiAgICAgIH0pOwogICAgICBjb25zdCByZWFkQ29udHJhY3RQYXJhbWV0ZXJzID0gewogICAgICAgIGFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcywKICAgICAgICBhYmk6IHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJyZXNvbHZlIiwKICAgICAgICBhcmdzOiBbdG9IZXgocGFja2V0VG9CeXRlcyhuYW1lKSksIGZ1bmN0aW9uRGF0YV0sCiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgYmxvY2tUYWcKICAgICAgfTsKICAgICAgY29uc3QgcmVhZENvbnRyYWN0QWN0aW9uID0gZ2V0QWN0aW9uKGNsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0Iik7CiAgICAgIGNvbnN0IHJlcyA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKHJlc1swXSA9PT0gIjB4IikKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgY29uc3QgYWRkcmVzcyA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFkZHJlc3NSZXNvbHZlckFiaSwKICAgICAgICBhcmdzOiBjb2luVHlwZSAhPSBudWxsID8gW25hbWVoYXNoKG5hbWUpLCBCaWdJbnQoY29pblR5cGUpXSA6IHZvaWQgMCwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJhZGRyIiwKICAgICAgICBkYXRhOiByZXNbMF0KICAgICAgfSk7CiAgICAgIGlmIChhZGRyZXNzID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBpZiAodHJpbShhZGRyZXNzKSA9PT0gIjB4MDAiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gYWRkcmVzczsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHRocm93IGVycjsKICAgICAgaWYgKGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCAicmVzb2x2ZSIpKQogICAgICAgIHJldHVybiBudWxsOwogICAgICB0aHJvdyBlcnI7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2Vucy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEgfSkgewogICAgICBzdXBlcigiVW5hYmxlIHRvIGV4dHJhY3QgaW1hZ2UgZnJvbSBtZXRhZGF0YS4gVGhlIG1ldGFkYXRhIG1heSBiZSBtYWxmb3JtZWQgb3IgaW52YWxpZC4iLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiLSBNZXRhZGF0YSBtdXN0IGJlIGEgSlNPTiBvYmplY3Qgd2l0aCBhdCBsZWFzdCBhbiBgaW1hZ2VgLCBgaW1hZ2VfdXJsYCBvciBgaW1hZ2VfZGF0YWAgcHJvcGVydHkuIiwKICAgICAgICAgICIiLAogICAgICAgICAgYFByb3ZpZGVkIGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9YAogICAgICAgIF0sCiAgICAgICAgbmFtZTogIkVuc0F2YXRhckludmFsaWRNZXRhZGF0YUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyByZWFzb24gfSkgewogICAgICBzdXBlcihgRU5TIE5GVCBhdmF0YXIgVVJJIGlzIGludmFsaWQuICR7cmVhc29ufWAsIHsKICAgICAgICBuYW1lOiAiRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyB1cmkgfSkgewogICAgICBzdXBlcihgVW5hYmxlIHRvIHJlc29sdmUgRU5TIGF2YXRhciBVUkkgIiR7dXJpfSIuIFRoZSBVUkkgbWF5IGJlIG1hbGZvcm1lZCwgaW52YWxpZCwgb3IgZG9lcyBub3QgcmVzcG9uZCB3aXRoIGEgdmFsaWQgaW1hZ2UuYCwgeyBuYW1lOiAiRW5zQXZhdGFyVXJpUmVzb2x1dGlvbkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgbmFtZXNwYWNlIH0pIHsKICAgICAgc3VwZXIoYEVOUyBORlQgYXZhdGFyIG5hbWVzcGFjZSAiJHtuYW1lc3BhY2V9IiBpcyBub3Qgc3VwcG9ydGVkLiBNdXN0IGJlICJlcmM3MjEiIG9yICJlcmMxMTU1Ii5gLCB7IG5hbWU6ICJFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yIiB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2F2YXRhci91dGlscy5qcwogIHZhciBuZXR3b3JrUmVnZXggPSAvKD88cHJvdG9jb2w+aHR0cHM/OlwvXC9bXlwvXSp8aXBmczpcL3xpcG5zOlwvfGFyOlwvKT8oPzxyb290PlwvKT8oPzxzdWJwYXRoPmlwZnNcL3xpcG5zXC8pPyg/PHRhcmdldD5bXHdcLS5dKykoPzxzdWJ0YXJnZXQ+XC8uKik/LzsKICB2YXIgaXBmc0hhc2hSZWdleCA9IC9eKFFtWzEtOUEtSEotTlAtWmEta20tel17NDQsfXxiW0EtWmEtejItN117NTgsfXxCW0EtWjItN117NTgsfXx6WzEtOUEtSEotTlAtWmEta20tel17NDgsfXxGWzAtOUEtRl17NTAsfSkoXC8oPzx0YXJnZXQ+W1x3XC0uXSspKT8oPzxzdWJ0YXJnZXQ+XC8uKik/JC87CiAgdmFyIGJhc2U2NFJlZ2V4ID0gL15kYXRhOihbYS16QS1aXC0vK10qKTtiYXNlNjQsKFteIl0uKikvOwogIHZhciBkYXRhVVJJUmVnZXggPSAvXmRhdGE6KFthLXpBLVpcLS8rXSopPyg7W2EtekEtWjAtOV0uKj8pPygsKS87CiAgYXN5bmMgZnVuY3Rpb24gaXNJbWFnZVVyaSh1cmkpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVyaSwgeyBtZXRob2Q6ICJIRUFEIiB9KTsKICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVzLmhlYWRlcnMuZ2V0KCJjb250ZW50LXR5cGUiKTsKICAgICAgICByZXR1cm4gY29udGVudFR5cGU/LnN0YXJ0c1dpdGgoImltYWdlLyIpOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICJvYmplY3QiICYmIHR5cGVvZiBlcnJvci5yZXNwb25zZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFnbG9iYWxUaGlzLmhhc093blByb3BlcnR5KCJJbWFnZSIpKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfTsKICAgICAgICBpbWcub25lcnJvciA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgIH07CiAgICAgICAgaW1nLnNyYyA9IHVyaTsKICAgICAgfSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEdhdGV3YXkoY3VzdG9tMiwgZGVmYXVsdEdhdGV3YXkpIHsKICAgIGlmICghY3VzdG9tMikKICAgICAgcmV0dXJuIGRlZmF1bHRHYXRld2F5OwogICAgaWYgKGN1c3RvbTIuZW5kc1dpdGgoIi8iKSkKICAgICAgcmV0dXJuIGN1c3RvbTIuc2xpY2UoMCwgLTEpOwogICAgcmV0dXJuIGN1c3RvbTI7CiAgfQogIGZ1bmN0aW9uIHJlc29sdmVBdmF0YXJVcmkoeyB1cmksIGdhdGV3YXlVcmxzIH0pIHsKICAgIGNvbnN0IGlzRW5jb2RlZCA9IGJhc2U2NFJlZ2V4LnRlc3QodXJpKTsKICAgIGlmIChpc0VuY29kZWQpCiAgICAgIHJldHVybiB7IHVyaSwgaXNPbkNoYWluOiB0cnVlLCBpc0VuY29kZWQgfTsKICAgIGNvbnN0IGlwZnNHYXRld2F5ID0gZ2V0R2F0ZXdheShnYXRld2F5VXJscz8uaXBmcywgImh0dHBzOi8vaXBmcy5pbyIpOwogICAgY29uc3QgYXJ3ZWF2ZUdhdGV3YXkgPSBnZXRHYXRld2F5KGdhdGV3YXlVcmxzPy5hcndlYXZlLCAiaHR0cHM6Ly9hcndlYXZlLm5ldCIpOwogICAgY29uc3QgbmV0d29ya1JlZ2V4TWF0Y2ggPSB1cmkubWF0Y2gobmV0d29ya1JlZ2V4KTsKICAgIGNvbnN0IHsgcHJvdG9jb2wsIHN1YnBhdGgsIHRhcmdldCwgc3VidGFyZ2V0ID0gIiIgfSA9IG5ldHdvcmtSZWdleE1hdGNoPy5ncm91cHMgfHwge307CiAgICBjb25zdCBpc0lQTlMgPSBwcm90b2NvbCA9PT0gImlwbnM6LyIgfHwgc3VicGF0aCA9PT0gImlwbnMvIjsKICAgIGNvbnN0IGlzSVBGUyA9IHByb3RvY29sID09PSAiaXBmczovIiB8fCBzdWJwYXRoID09PSAiaXBmcy8iIHx8IGlwZnNIYXNoUmVnZXgudGVzdCh1cmkpOwogICAgaWYgKHVyaS5zdGFydHNXaXRoKCJodHRwIikgJiYgIWlzSVBOUyAmJiAhaXNJUEZTKSB7CiAgICAgIGxldCByZXBsYWNlZFVyaSA9IHVyaTsKICAgICAgaWYgKGdhdGV3YXlVcmxzPy5hcndlYXZlKQogICAgICAgIHJlcGxhY2VkVXJpID0gdXJpLnJlcGxhY2UoL2h0dHBzOlwvXC9hcndlYXZlLm5ldC9nLCBnYXRld2F5VXJscz8uYXJ3ZWF2ZSk7CiAgICAgIHJldHVybiB7IHVyaTogcmVwbGFjZWRVcmksIGlzT25DaGFpbjogZmFsc2UsIGlzRW5jb2RlZDogZmFsc2UgfTsKICAgIH0KICAgIGlmICgoaXNJUE5TIHx8IGlzSVBGUykgJiYgdGFyZ2V0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBgJHtpcGZzR2F0ZXdheX0vJHtpc0lQTlMgPyAiaXBucyIgOiAiaXBmcyJ9LyR7dGFyZ2V0fSR7c3VidGFyZ2V0fWAsCiAgICAgICAgaXNPbkNoYWluOiBmYWxzZSwKICAgICAgICBpc0VuY29kZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICBpZiAocHJvdG9jb2wgPT09ICJhcjovIiAmJiB0YXJnZXQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB1cmk6IGAke2Fyd2VhdmVHYXRld2F5fS8ke3RhcmdldH0ke3N1YnRhcmdldCB8fCAiIn1gLAogICAgICAgIGlzT25DaGFpbjogZmFsc2UsCiAgICAgICAgaXNFbmNvZGVkOiBmYWxzZQogICAgICB9OwogICAgfQogICAgbGV0IHBhcnNlZFVyaSA9IHVyaS5yZXBsYWNlKGRhdGFVUklSZWdleCwgIiIpOwogICAgaWYgKHBhcnNlZFVyaS5zdGFydHNXaXRoKCI8c3ZnIikpIHsKICAgICAgcGFyc2VkVXJpID0gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJHtidG9hKHBhcnNlZFVyaSl9YDsKICAgIH0KICAgIGlmIChwYXJzZWRVcmkuc3RhcnRzV2l0aCgiZGF0YToiKSB8fCBwYXJzZWRVcmkuc3RhcnRzV2l0aCgieyIpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBwYXJzZWRVcmksCiAgICAgICAgaXNPbkNoYWluOiB0cnVlLAogICAgICAgIGlzRW5jb2RlZDogZmFsc2UKICAgICAgfTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgfQogIGZ1bmN0aW9uIGdldEpzb25JbWFnZShkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJvYmplY3QiIHx8ICEoImltYWdlIiBpbiBkYXRhKSAmJiAhKCJpbWFnZV91cmwiIGluIGRhdGEpICYmICEoImltYWdlX2RhdGEiIGluIGRhdGEpKSB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvcih7IGRhdGEgfSk7CiAgICB9CiAgICByZXR1cm4gZGF0YS5pbWFnZSB8fCBkYXRhLmltYWdlX3VybCB8fCBkYXRhLmltYWdlX2RhdGE7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE1ldGFkYXRhQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICB0cnkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmkpLnRoZW4oKHJlczIpID0+IHJlczIuanNvbigpKTsKICAgICAgY29uc3QgaW1hZ2UgPSBhd2FpdCBwYXJzZUF2YXRhclVyaSh7CiAgICAgICAgZ2F0ZXdheVVybHMsCiAgICAgICAgdXJpOiBnZXRKc29uSW1hZ2UocmVzKQogICAgICB9KTsKICAgICAgcmV0dXJuIGltYWdlOwogICAgfSBjYXRjaCB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgICB9CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHBhcnNlQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWRVUkksIGlzT25DaGFpbiB9ID0gcmVzb2x2ZUF2YXRhclVyaSh7IHVyaSwgZ2F0ZXdheVVybHMgfSk7CiAgICBpZiAoaXNPbkNoYWluKQogICAgICByZXR1cm4gcmVzb2x2ZWRVUkk7CiAgICBjb25zdCBpc0ltYWdlID0gYXdhaXQgaXNJbWFnZVVyaShyZXNvbHZlZFVSSSk7CiAgICBpZiAoaXNJbWFnZSkKICAgICAgcmV0dXJuIHJlc29sdmVkVVJJOwogICAgdGhyb3cgbmV3IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvcih7IHVyaSB9KTsKICB9CiAgZnVuY3Rpb24gcGFyc2VOZnRVcmkodXJpXykgewogICAgbGV0IHVyaSA9IHVyaV87CiAgICBpZiAodXJpLnN0YXJ0c1dpdGgoImRpZDpuZnQ6IikpIHsKICAgICAgdXJpID0gdXJpLnJlcGxhY2UoImRpZDpuZnQ6IiwgIiIpLnJlcGxhY2UoL18vZywgIi8iKTsKICAgIH0KICAgIGNvbnN0IFtyZWZlcmVuY2UsIGFzc2V0X25hbWVzcGFjZSwgdG9rZW5JRF0gPSB1cmkuc3BsaXQoIi8iKTsKICAgIGNvbnN0IFtlaXBfbmFtZXNwYWNlLCBjaGFpbklEXSA9IHJlZmVyZW5jZS5zcGxpdCgiOiIpOwogICAgY29uc3QgW2VyY19uYW1lc3BhY2UsIGNvbnRyYWN0QWRkcmVzc10gPSBhc3NldF9uYW1lc3BhY2Uuc3BsaXQoIjoiKTsKICAgIGlmICghZWlwX25hbWVzcGFjZSB8fCBlaXBfbmFtZXNwYWNlLnRvTG93ZXJDYXNlKCkgIT09ICJlaXAxNTUiKQogICAgICB0aHJvdyBuZXcgRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yKHsgcmVhc29uOiAiT25seSBFSVAtMTU1IHN1cHBvcnRlZCIgfSk7CiAgICBpZiAoIWNoYWluSUQpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJDaGFpbiBJRCBub3QgZm91bmQiIH0pOwogICAgaWYgKCFjb250cmFjdEFkZHJlc3MpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoewogICAgICAgIHJlYXNvbjogIkNvbnRyYWN0IGFkZHJlc3Mgbm90IGZvdW5kIgogICAgICB9KTsKICAgIGlmICghdG9rZW5JRCkKICAgICAgdGhyb3cgbmV3IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvcih7IHJlYXNvbjogIlRva2VuIElEIG5vdCBmb3VuZCIgfSk7CiAgICBpZiAoIWVyY19uYW1lc3BhY2UpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJFUkMgbmFtZXNwYWNlIG5vdCBmb3VuZCIgfSk7CiAgICByZXR1cm4gewogICAgICBjaGFpbklEOiBOdW1iZXIucGFyc2VJbnQoY2hhaW5JRCksCiAgICAgIG5hbWVzcGFjZTogZXJjX25hbWVzcGFjZS50b0xvd2VyQ2FzZSgpLAogICAgICBjb250cmFjdEFkZHJlc3MsCiAgICAgIHRva2VuSUQKICAgIH07CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSkgewogICAgaWYgKG5mdC5uYW1lc3BhY2UgPT09ICJlcmM3MjEiKSB7CiAgICAgIHJldHVybiByZWFkQ29udHJhY3QoY2xpZW50LCB7CiAgICAgICAgYWRkcmVzczogbmZ0LmNvbnRyYWN0QWRkcmVzcywKICAgICAgICBhYmk6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInRva2VuVVJJIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogInRva2VuSWQiLCB0eXBlOiAidWludDI1NiIgfV0sCiAgICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidG9rZW5VUkkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIGlmIChuZnQubmFtZXNwYWNlID09PSAiZXJjMTE1NSIpIHsKICAgICAgcmV0dXJuIHJlYWRDb250cmFjdChjbGllbnQsIHsKICAgICAgICBhZGRyZXNzOiBuZnQuY29udHJhY3RBZGRyZXNzLAogICAgICAgIGFiaTogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAidXJpIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIl9pZCIsIHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJzdHJpbmciIH1dCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJ1cmkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yKHsgbmFtZXNwYWNlOiBuZnQubmFtZXNwYWNlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9hdmF0YXIvcGFyc2VBdmF0YXJSZWNvcmQuanMKICBhc3luYyBmdW5jdGlvbiBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KSB7CiAgICBpZiAoL2VpcDE1NTovaS50ZXN0KHJlY29yZCkpCiAgICAgIHJldHVybiBwYXJzZU5mdEF2YXRhclVyaShjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KTsKICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogcmVjb3JkLCBnYXRld2F5VXJscyB9KTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gcGFyc2VOZnRBdmF0YXJVcmkoY2xpZW50LCB7IGdhdGV3YXlVcmxzLCByZWNvcmQgfSkgewogICAgY29uc3QgbmZ0ID0gcGFyc2VOZnRVcmkocmVjb3JkKTsKICAgIGNvbnN0IG5mdFVyaSA9IGF3YWl0IGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSk7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWROZnRVcmksIGlzT25DaGFpbiwgaXNFbmNvZGVkIH0gPSByZXNvbHZlQXZhdGFyVXJpKHsgdXJpOiBuZnRVcmksIGdhdGV3YXlVcmxzIH0pOwogICAgaWYgKGlzT25DaGFpbiAmJiAocmVzb2x2ZWROZnRVcmkuaW5jbHVkZXMoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIikgfHwgcmVzb2x2ZWROZnRVcmkuc3RhcnRzV2l0aCgieyIpKSkgewogICAgICBjb25zdCBlbmNvZGVkSnNvbiA9IGlzRW5jb2RlZCA/ICgKICAgICAgICAvLyBpZiBpdCBpcyBlbmNvZGVkLCBkZWNvZGUgaXQKICAgICAgICBhdG9iKHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIiwgIiIpKQogICAgICApIDogKAogICAgICAgIC8vIGlmIGl0IGlzbid0IGVuY29kZWQgYXNzdW1lIGl0IGlzIGEgSlNPTiBzdHJpbmcsIGJ1dCBpdCBjb3VsZCBiZSBhbnl0aGluZyAoaXQgd2lsbCBlcnJvciBpZiBpdCBpcykKICAgICAgICByZXNvbHZlZE5mdFVyaQogICAgICApOwogICAgICBjb25zdCBkZWNvZGVkID0gSlNPTi5wYXJzZShlbmNvZGVkSnNvbik7CiAgICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogZ2V0SnNvbkltYWdlKGRlY29kZWQpLCBnYXRld2F5VXJscyB9KTsKICAgIH0KICAgIGxldCB1cmlUb2tlbklkID0gbmZ0LnRva2VuSUQ7CiAgICBpZiAobmZ0Lm5hbWVzcGFjZSA9PT0gImVyYzExNTUiKQogICAgICB1cmlUb2tlbklkID0gdXJpVG9rZW5JZC5yZXBsYWNlKCIweCIsICIiKS5wYWRTdGFydCg2NCwgIjAiKTsKICAgIHJldHVybiBnZXRNZXRhZGF0YUF2YXRhclVyaSh7CiAgICAgIGdhdGV3YXlVcmxzLAogICAgICB1cmk6IHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoLyg/OjB4KT97aWR9LywgdXJpVG9rZW5JZCkKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc1RleHQuanMKICBpbml0X2FiaXMoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc1RleHQoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwga2V5LCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXNvbHZlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJlc29sdmUiLAogICAgICAgIGFyZ3M6IFsKICAgICAgICAgIHRvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpLAogICAgICAgICAgZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgICAgIGZ1bmN0aW9uTmFtZTogInRleHQiLAogICAgICAgICAgICBhcmdzOiBbbmFtZWhhc2gobmFtZSksIGtleV0KICAgICAgICAgIH0pCiAgICAgICAgXSwKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZwogICAgICB9OwogICAgICBjb25zdCByZWFkQ29udHJhY3RBY3Rpb24gPSBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKTsKICAgICAgY29uc3QgcmVzID0gZ2F0ZXdheVVybHMgPyBhd2FpdCByZWFkQ29udHJhY3RBY3Rpb24oewogICAgICAgIC4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMsCiAgICAgICAgYXJnczogWy4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMuYXJncywgZ2F0ZXdheVVybHNdCiAgICAgIH0pIDogYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHJlYWRDb250cmFjdFBhcmFtZXRlcnMpOwogICAgICBpZiAocmVzWzBdID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBjb25zdCByZWNvcmQgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidGV4dCIsCiAgICAgICAgZGF0YTogcmVzWzBdCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVjb3JkID09PSAiIiA/IG51bGwgOiByZWNvcmQ7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgaWYgKHN0cmljdCkKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIGlmIChpc051bGxVbml2ZXJzYWxSZXNvbHZlckVycm9yKGVyciwgInJlc29sdmUiKSkKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgdGhyb3cgZXJyOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc0F2YXRhci5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc0F2YXRhcihjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBhc3NldEdhdGV3YXlVcmxzLCBuYW1lLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgfSkgewogICAgY29uc3QgcmVjb3JkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RW5zVGV4dCwgImdldEVuc1RleHQiKSh7CiAgICAgIGJsb2NrTnVtYmVyLAogICAgICBibG9ja1RhZywKICAgICAga2V5OiAiYXZhdGFyIiwKICAgICAgbmFtZSwKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBnYXRld2F5VXJscywKICAgICAgc3RyaWN0CiAgICB9KTsKICAgIGlmICghcmVjb3JkKQogICAgICByZXR1cm4gbnVsbDsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhd2FpdCBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsKICAgICAgICByZWNvcmQsCiAgICAgICAgZ2F0ZXdheVVybHM6IGFzc2V0R2F0ZXdheVVybHMKICAgICAgfSk7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9lbnMvZ2V0RW5zTmFtZS5qcwogIGluaXRfYWJpcygpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zTmFtZShjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHJldmVyc2VOb2RlID0gYCR7YWRkcmVzcy50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygyKX0uYWRkci5yZXZlcnNlYDsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXZlcnNlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJldmVyc2UiLAogICAgICAgIGFyZ3M6IFt0b0hleChwYWNrZXRUb0J5dGVzKHJldmVyc2VOb2RlKSldLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnCiAgICAgIH07CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdEFjdGlvbiA9IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpOwogICAgICBjb25zdCBbbmFtZSwgcmVzb2x2ZWRBZGRyZXNzXSA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKGFkZHJlc3MudG9Mb3dlckNhc2UoKSAhPT0gcmVzb2x2ZWRBZGRyZXNzLnRvTG93ZXJDYXNlKCkpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHJldHVybiBuYW1lOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIGlmIChzdHJpY3QpCiAgICAgICAgdGhyb3cgZXJyOwogICAgICBpZiAoaXNOdWxsVW5pdmVyc2FsUmVzb2x2ZXJFcnJvcihlcnIsICJyZXZlcnNlIikpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHRocm93IGVycjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNSZXNvbHZlci5qcwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zUmVzb2x2ZXIoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBbcmVzb2x2ZXJBZGRyZXNzXSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpKHsKICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBhYmk6IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIgfV0sCiAgICAgICAgICBuYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgICAgIG91dHB1dHM6IFt7IHR5cGU6ICJhZGRyZXNzIiB9LCB7IHR5cGU6ICJieXRlczMyIiB9XSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXSwKICAgICAgZnVuY3Rpb25OYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgYXJnczogW3RvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnCiAgICB9KTsKICAgIHJldHVybiByZXNvbHZlckFkZHJlc3M7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy9kZWNvcmF0b3JzL3B1YmxpYy5qcwogIGluaXRfY2FsbCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlQmxvY2tGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVCbG9ja0ZpbHRlcihjbGllbnQpIHsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgY29uc3QgaWQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAiYmxvY2siIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlRXZlbnRGaWx0ZXIuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCB7IGFkZHJlc3MsIGFyZ3MsIGV2ZW50LCBldmVudHM6IGV2ZW50c18sIGZyb21CbG9jaywgc3RyaWN0LCB0b0Jsb2NrIH0gPSB7fSkgewogICAgY29uc3QgZXZlbnRzID0gZXZlbnRzXyA/PyAoZXZlbnQgPyBbZXZlbnRdIDogdm9pZCAwKTsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdGaWx0ZXIiCiAgICB9KTsKICAgIGxldCB0b3BpY3MgPSBbXTsKICAgIGlmIChldmVudHMpIHsKICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50cy5mbGF0TWFwKChldmVudDIpID0+IGVuY29kZUV2ZW50VG9waWNzKHsKICAgICAgICBhYmk6IFtldmVudDJdLAogICAgICAgIGV2ZW50TmFtZTogZXZlbnQyLm5hbWUsCiAgICAgICAgYXJncwogICAgICB9KSk7CiAgICAgIHRvcGljcyA9IFtlbmNvZGVkXTsKICAgICAgaWYgKGV2ZW50KQogICAgICAgIHRvcGljcyA9IHRvcGljc1swXTsKICAgIH0KICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgLi4udG9waWNzLmxlbmd0aCA/IHsgdG9waWNzIH0gOiB7fQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lOiBldmVudCA/IGV2ZW50Lm5hbWUgOiB2b2lkIDAsCiAgICAgIGZyb21CbG9jaywKICAgICAgaWQsCiAgICAgIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLAogICAgICBzdHJpY3Q6IEJvb2xlYW4oc3RyaWN0KSwKICAgICAgdG9CbG9jaywKICAgICAgdHlwZTogImV2ZW50IgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSB7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3UGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyIgogICAgfSk7CiAgICBjb25zdCBpZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX25ld1BlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAidHJhbnNhY3Rpb24iIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmxvYkJhc2VGZWUuanMKICBhc3luYyBmdW5jdGlvbiBnZXRCbG9iQmFzZUZlZShjbGllbnQpIHsKICAgIGNvbnN0IGJhc2VGZWUgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9ibG9iQmFzZUZlZSIKICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYXNlRmVlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9ja1RyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgbGV0IGNvdW50OwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBjb3VudCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50QnlIYXNoIiwKICAgICAgICBwYXJhbXM6IFtibG9ja0hhc2hdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIHsKICAgICAgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldEJsb2NrVHJhbnNhY3Rpb25Db3VudEJ5TnVtYmVyIiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgcmV0dXJuIGhleFRvTnVtYmVyKGNvdW50KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb2RlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldENvZGUoY2xpZW50LCB7IGFkZHJlc3MsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0pIHsKICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgIT09IHZvaWQgMCA/IG51bWJlclRvSGV4KGJsb2NrTnVtYmVyKSA6IHZvaWQgMDsKICAgIGNvbnN0IGhleCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldENvZGUiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIGlmIChoZXggPT09ICIweCIpCiAgICAgIHJldHVybiB2b2lkIDA7CiAgICByZXR1cm4gaGV4OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZlZUhpc3RvcnkuanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2ZlZUhpc3RvcnkuanMKICBmdW5jdGlvbiBmb3JtYXRGZWVIaXN0b3J5KGZlZUhpc3RvcnkpIHsKICAgIHJldHVybiB7CiAgICAgIGJhc2VGZWVQZXJHYXM6IGZlZUhpc3RvcnkuYmFzZUZlZVBlckdhcy5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSwKICAgICAgZ2FzVXNlZFJhdGlvOiBmZWVIaXN0b3J5Lmdhc1VzZWRSYXRpbywKICAgICAgb2xkZXN0QmxvY2s6IEJpZ0ludChmZWVIaXN0b3J5Lm9sZGVzdEJsb2NrKSwKICAgICAgcmV3YXJkOiBmZWVIaXN0b3J5LnJld2FyZD8ubWFwKChyZXdhcmQpID0+IHJld2FyZC5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RmVlSGlzdG9yeS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEZlZUhpc3RvcnkoY2xpZW50LCB7IGJsb2NrQ291bnQsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCByZXdhcmRQZXJjZW50aWxlcyB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgZmVlSGlzdG9yeSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2ZlZUhpc3RvcnkiLAogICAgICBwYXJhbXM6IFsKICAgICAgICBudW1iZXJUb0hleChibG9ja0NvdW50KSwKICAgICAgICBibG9ja051bWJlckhleCB8fCBibG9ja1RhZywKICAgICAgICByZXdhcmRQZXJjZW50aWxlcwogICAgICBdCiAgICB9LCB7IGRlZHVwZTogQm9vbGVhbihibG9ja051bWJlckhleCkgfSk7CiAgICByZXR1cm4gZm9ybWF0RmVlSGlzdG9yeShmZWVIaXN0b3J5KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRGaWx0ZXJMb2dzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyTG9ncyhfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICBjb25zdCBzdHJpY3QgPSBmaWx0ZXIuc3RyaWN0ID8/IGZhbHNlOwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckxvZ3MiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFByb29mLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZGVmaW5lQ2hhaW4uanMKICBmdW5jdGlvbiBkZWZpbmVDaGFpbihjaGFpbikgewogICAgcmV0dXJuIHsKICAgICAgZm9ybWF0dGVyczogdm9pZCAwLAogICAgICBmZWVzOiB2b2lkIDAsCiAgICAgIHNlcmlhbGl6ZXJzOiB2b2lkIDAsCiAgICAgIC4uLmNoYWluCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2V4dHJhY3RDaGFpbi5qcwogIGZ1bmN0aW9uIGV4dHJhY3RDaGFpbih7IGNoYWlucywgaWQgfSkgewogICAgcmV0dXJuIGNoYWlucy5maW5kKChjaGFpbikgPT4gY2hhaW4uaWQgPT09IGlkKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9yZWdleC5qcwogIHZhciBhcnJheVJlZ2V4ID0gL14oLiopXFsoWzAtOV0qKVxdJC87CiAgdmFyIGJ5dGVzUmVnZXgyID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgdmFyIGludGVnZXJSZWdleDIgPSAvXih1P2ludCkoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9zb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyKCk7CiAgdmFyIHNvY2tldENsaWVudENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRTb2NrZXRScGNDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBnZXRTb2NrZXQ6IGdldFNvY2tldDIsIGtlZXBBbGl2ZSA9IHRydWUsIGtleSA9ICJzb2NrZXQiLCByZWNvbm5lY3QgPSB0cnVlLCB1cmwgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGludGVydmFsOiBrZWVwQWxpdmVJbnRlcnZhbCA9IDNlNCB9ID0gdHlwZW9mIGtlZXBBbGl2ZSA9PT0gIm9iamVjdCIgPyBrZWVwQWxpdmUgOiB7fTsKICAgIGNvbnN0IHsgYXR0ZW1wdHMgPSA1LCBkZWxheSA9IDJlMyB9ID0gdHlwZW9mIHJlY29ubmVjdCA9PT0gIm9iamVjdCIgPyByZWNvbm5lY3QgOiB7fTsKICAgIGxldCBzb2NrZXRDbGllbnQgPSBzb2NrZXRDbGllbnRDYWNoZS5nZXQoYCR7a2V5fToke3VybH1gKTsKICAgIGlmIChzb2NrZXRDbGllbnQpCiAgICAgIHJldHVybiBzb2NrZXRDbGllbnQ7CiAgICBsZXQgcmVjb25uZWN0Q291bnQgPSAwOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7a2V5fToke3VybH1gLAogICAgICBmbjogYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHJlcXVlc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBsZXQgZXJyb3I7CiAgICAgICAgbGV0IHNvY2tldDsKICAgICAgICBsZXQga2VlcEFsaXZlVGltZXI7CiAgICAgICAgYXN5bmMgZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRTb2NrZXQyKHsKICAgICAgICAgICAgb25DbG9zZSgpIHsKICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlcXVlc3Qgb2YgcmVxdWVzdHMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uRXJyb3I/LihuZXcgU29ja2V0Q2xvc2VkRXJyb3IoeyB1cmwgfSkpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybCB9KSk7CiAgICAgICAgICAgICAgcmVxdWVzdHMuY2xlYXIoKTsKICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLmNsZWFyKCk7CiAgICAgICAgICAgICAgaWYgKHJlY29ubmVjdCAmJiByZWNvbm5lY3RDb3VudCA8IGF0dGVtcHRzKQogICAgICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgIHJlY29ubmVjdENvdW50Kys7CiAgICAgICAgICAgICAgICAgIGF3YWl0IHNldHVwKCkuY2F0Y2goY29uc29sZS5lcnJvcik7CiAgICAgICAgICAgICAgICB9LCBkZWxheSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRXJyb3IoZXJyb3JfKSB7CiAgICAgICAgICAgICAgZXJyb3IgPSBlcnJvcl87CiAgICAgICAgICAgICAgZm9yIChjb25zdCByZXF1ZXN0IG9mIHJlcXVlc3RzLnZhbHVlcygpKQogICAgICAgICAgICAgICAgcmVxdWVzdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXF1ZXN0cy5jbGVhcigpOwogICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuY2xlYXIoKTsKICAgICAgICAgICAgICBpZiAocmVjb25uZWN0ICYmIHJlY29ubmVjdENvdW50IDwgYXR0ZW1wdHMpCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgcmVjb25uZWN0Q291bnQrKzsKICAgICAgICAgICAgICAgICAgYXdhaXQgc2V0dXAoKS5jYXRjaChjb25zb2xlLmVycm9yKTsKICAgICAgICAgICAgICAgIH0sIGRlbGF5KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25PcGVuKCkgewogICAgICAgICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgICAgICAgIHJlY29ubmVjdENvdW50ID0gMDsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25SZXNwb25zZShkYXRhKSB7CiAgICAgICAgICAgICAgY29uc3QgaXNTdWJzY3JpcHRpb24gPSBkYXRhLm1ldGhvZCA9PT0gImV0aF9zdWJzY3JpcHRpb24iOwogICAgICAgICAgICAgIGNvbnN0IGlkID0gaXNTdWJzY3JpcHRpb24gPyBkYXRhLnBhcmFtcy5zdWJzY3JpcHRpb24gOiBkYXRhLmlkOwogICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gaXNTdWJzY3JpcHRpb24gPyBzdWJzY3JpcHRpb25zIDogcmVxdWVzdHM7CiAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjYWNoZS5nZXQoaWQpOwogICAgICAgICAgICAgIGlmIChjYWxsYmFjaykKICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9uUmVzcG9uc2UoZGF0YSk7CiAgICAgICAgICAgICAgaWYgKCFpc1N1YnNjcmlwdGlvbikKICAgICAgICAgICAgICAgIGNhY2hlLmRlbGV0ZShpZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgc29ja2V0ID0gcmVzdWx0OwogICAgICAgICAgaWYgKGtlZXBBbGl2ZSkgewogICAgICAgICAgICBpZiAoa2VlcEFsaXZlVGltZXIpCiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChrZWVwQWxpdmVUaW1lcik7CiAgICAgICAgICAgIGtlZXBBbGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gc29ja2V0LnBpbmc/LigpLCBrZWVwQWxpdmVJbnRlcnZhbCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgICBhd2FpdCBzZXR1cCgpOwogICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgIHNvY2tldENsaWVudCA9IHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBrZWVwQWxpdmVUaW1lciAmJiBjbGVhckludGVydmFsKGtlZXBBbGl2ZVRpbWVyKTsKICAgICAgICAgICAgc29ja2V0LmNsb3NlKCk7CiAgICAgICAgICAgIHNvY2tldENsaWVudENhY2hlLmRlbGV0ZShgJHtrZXl9OiR7dXJsfWApOwogICAgICAgICAgfSwKICAgICAgICAgIGdldCBzb2NrZXQoKSB7CiAgICAgICAgICAgIHJldHVybiBzb2NrZXQ7CiAgICAgICAgICB9LAogICAgICAgICAgcmVxdWVzdCh7IGJvZHksIG9uRXJyb3IsIG9uUmVzcG9uc2UgfSkgewogICAgICAgICAgICBpZiAoZXJyb3IgJiYgb25FcnJvcikKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTsKICAgICAgICAgICAgY29uc3QgaWQgPSBib2R5LmlkID8/IGlkQ2FjaGUudGFrZSgpOwogICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuaWQgPT09ICJudW1iZXIiICYmIGlkICE9PSByZXNwb25zZS5pZCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAoYm9keS5tZXRob2QgPT09ICJldGhfc3Vic2NyaWJlIiAmJiB0eXBlb2YgcmVzcG9uc2UucmVzdWx0ID09PSAic3RyaW5nIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuc2V0KHJlc3BvbnNlLnJlc3VsdCwgewogICAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgb25FcnJvcgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaWYgKGJvZHkubWV0aG9kID09PSAiZXRoX3Vuc3Vic2NyaWJlIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZGVsZXRlKGJvZHkucGFyYW1zPy5bMF0pOwogICAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZXF1ZXN0cy5zZXQoaWQsIHsgb25SZXNwb25zZTogY2FsbGJhY2ssIG9uRXJyb3IgfSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgc29ja2V0LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBqc29ucnBjOiAiMi4wIiwKICAgICAgICAgICAgICAgICAgaWQsCiAgICAgICAgICAgICAgICAgIC4uLmJvZHkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IyKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0QXN5bmMoeyBib2R5LCB0aW1lb3V0ID0gMWU0IH0pIHsKICAgICAgICAgICAgcmV0dXJuIHdpdGhUaW1lb3V0KCgpID0+IG5ldyBQcm9taXNlKChvblJlc3BvbnNlLCBvbkVycm9yKSA9PiB0aGlzLnJlcXVlc3QoewogICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgb25FcnJvciwKICAgICAgICAgICAgICBvblJlc3BvbnNlCiAgICAgICAgICAgIH0pKSwgewogICAgICAgICAgICAgIGVycm9ySW5zdGFuY2U6IG5ldyBUaW1lb3V0RXJyb3IoeyBib2R5LCB1cmwgfSksCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0cywKICAgICAgICAgIHN1YnNjcmlwdGlvbnMsCiAgICAgICAgICB1cmwKICAgICAgICB9OwogICAgICAgIHNvY2tldENsaWVudENhY2hlLnNldChgJHtrZXl9OiR7dXJsfWAsIHNvY2tldENsaWVudCk7CiAgICAgICAgcmV0dXJuIFtzb2NrZXRDbGllbnRdOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFtfLCBbc29ja2V0Q2xpZW50X11dID0gYXdhaXQgc2NoZWR1bGUoKTsKICAgIHJldHVybiBzb2NrZXRDbGllbnRfOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBhc3luYyBmdW5jdGlvbiBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IHsga2VlcEFsaXZlLCByZWNvbm5lY3QgfSA9IG9wdGlvbnM7CiAgICByZXR1cm4gZ2V0U29ja2V0UnBjQ2xpZW50KHsKICAgICAgYXN5bmMgZ2V0U29ja2V0KHsgb25DbG9zZSwgb25FcnJvciwgb25PcGVuLCBvblJlc3BvbnNlIH0pIHsKICAgICAgICBjb25zdCBXZWJTb2NrZXQzID0gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiAoaW5pdF9uYXRpdmUoKSwgbmF0aXZlX2V4cG9ydHMpKS50aGVuKChtb2R1bGUpID0+IG1vZHVsZS5XZWJTb2NrZXQpOwogICAgICAgIGNvbnN0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQzKHVybCk7CiAgICAgICAgZnVuY3Rpb24gb25DbG9zZV8oKSB7CiAgICAgICAgICBvbkNsb3NlKCk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIG9uTWVzc2FnZSk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZXJyb3IiLCBvbkVycm9yKTsKICAgICAgICAgIHNvY2tldC5yZW1vdmVFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gb25NZXNzYWdlKHsgZGF0YSB9KSB7CiAgICAgICAgICBvblJlc3BvbnNlKEpTT04ucGFyc2UoZGF0YSkpOwogICAgICAgIH0KICAgICAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBvbk1lc3NhZ2UpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJlcnJvciIsIG9uRXJyb3IpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICBpZiAoc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldDMuQ09OTkVDVElORykgewogICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICBpZiAoIXNvY2tldCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHNvY2tldC5vbm9wZW4gPSByZXNvbHZlOwogICAgICAgICAgICBzb2NrZXQub25lcnJvciA9IHJlamVjdDsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCB7IGNsb3NlOiBjbG9zZV8gfSA9IHNvY2tldDsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihzb2NrZXQsIHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBjbG9zZV8uYmluZChzb2NrZXQpKCk7CiAgICAgICAgICAgIG9uQ2xvc2UoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBwaW5nKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgV2ViU29ja2V0UmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgICBjYXVzZTogbmV3IFNvY2tldENsb3NlZEVycm9yKHsgdXJsOiBzb2NrZXQudXJsIH0pCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjb25zdCBib2R5ID0gewogICAgICAgICAgICAgICAganNvbnJwYzogIjIuMCIsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICJuZXRfdmVyc2lvbiIsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShib2R5KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0KHsgYm9keSB9KSB7CiAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IFdlYlNvY2tldFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgICBib2R5LAogICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgY2F1c2U6IG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybDogc29ja2V0LnVybCB9KQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoYm9keSkpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBrZWVwQWxpdmUsCiAgICAgIHJlY29ubmVjdCwKICAgICAgdXJsCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvY29tcGF0LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0U29ja2V0KHVybCkgewogICAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybCk7CiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihjbGllbnQuc29ja2V0LCB7CiAgICAgIHJlcXVlc3RzOiBjbGllbnQucmVxdWVzdHMsCiAgICAgIHN1YnNjcmlwdGlvbnM6IGNsaWVudC5zdWJzY3JpcHRpb25zCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90eXBlZERhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfYWRkcmVzcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3R5cGVkRGF0YS5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICAgIHN1cGVyKGBJbnZhbGlkIHByaW1hcnkgdHlwZSBcYCR7cHJpbWFyeVR5cGV9XGAgbXVzdCBiZSBvbmUgb2YgXGAke0pTT04uc3RyaW5naWZ5KE9iamVjdC5rZXlzKHR5cGVzKSl9XGAuYCwgewogICAgICAgIGRvY3NQYXRoOiAiL2FwaS9nbG9zc2FyeS9FcnJvcnMjdHlwZWRkYXRhaW52YWxpZHByaW1hcnl0eXBlZXJyb3IiLAogICAgICAgIG1ldGFNZXNzYWdlczogWyJDaGVjayB0aGF0IHRoZSBwcmltYXJ5IHR5cGUgaXMgYSBrZXkgaW4gYHR5cGVzYC4iXQogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkU3RydWN0VHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdHlwZSB9KSB7CiAgICAgIHN1cGVyKGBTdHJ1Y3QgdHlwZSAiJHt0eXBlfSIgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIlN0cnVjdCB0eXBlIG11c3Qgbm90IGJlIGEgU29saWRpdHkgdHlwZS4iXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFN0cnVjdFR5cGVFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hUeXBlZERhdGEuanMKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hUeXBlZERhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBkb21haW4gPSB7fSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0eXBlcyA9IHsKICAgICAgRUlQNzEyRG9tYWluOiBnZXRUeXBlc0ZvckVJUDcxMkRvbWFpbih7IGRvbWFpbiB9KSwKICAgICAgLi4ucGFyYW1ldGVycy50eXBlcwogICAgfTsKICAgIHZhbGlkYXRlVHlwZWREYXRhKHsKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlLAogICAgICBwcmltYXJ5VHlwZSwKICAgICAgdHlwZXMKICAgIH0pOwogICAgY29uc3QgcGFydHMgPSBbIjB4MTkwMSJdOwogICAgaWYgKGRvbWFpbikKICAgICAgcGFydHMucHVzaChoYXNoRG9tYWluKHsKICAgICAgICBkb21haW4sCiAgICAgICAgdHlwZXMKICAgICAgfSkpOwogICAgaWYgKHByaW1hcnlUeXBlICE9PSAiRUlQNzEyRG9tYWluIikKICAgICAgcGFydHMucHVzaChoYXNoU3RydWN0KHsKICAgICAgICBkYXRhOiBtZXNzYWdlLAogICAgICAgIHByaW1hcnlUeXBlLAogICAgICAgIHR5cGVzCiAgICAgIH0pKTsKICAgIHJldHVybiBrZWNjYWsyNTYoY29uY2F0KHBhcnRzKSk7CiAgfQogIGZ1bmN0aW9uIGhhc2hEb21haW4oeyBkb21haW4sIHR5cGVzIH0pIHsKICAgIHJldHVybiBoYXNoU3RydWN0KHsKICAgICAgZGF0YTogZG9tYWluLAogICAgICBwcmltYXJ5VHlwZTogIkVJUDcxMkRvbWFpbiIsCiAgICAgIHR5cGVzCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gaGFzaFN0cnVjdCh7IGRhdGEsIHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICBjb25zdCBlbmNvZGVkID0gZW5jb2RlRGF0YSh7CiAgICAgIGRhdGEsCiAgICAgIHByaW1hcnlUeXBlLAogICAgICB0eXBlcwogICAgfSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWQpOwogIH0KICBmdW5jdGlvbiBlbmNvZGVEYXRhKHsgZGF0YSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pIHsKICAgIGNvbnN0IGVuY29kZWRUeXBlcyA9IFt7IHR5cGU6ICJieXRlczMyIiB9XTsKICAgIGNvbnN0IGVuY29kZWRWYWx1ZXMgPSBbaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSldOwogICAgZm9yIChjb25zdCBmaWVsZCBvZiB0eXBlc1twcmltYXJ5VHlwZV0pIHsKICAgICAgY29uc3QgW3R5cGUsIHZhbHVlXSA9IGVuY29kZUZpZWxkKHsKICAgICAgICB0eXBlcywKICAgICAgICBuYW1lOiBmaWVsZC5uYW1lLAogICAgICAgIHR5cGU6IGZpZWxkLnR5cGUsCiAgICAgICAgdmFsdWU6IGRhdGFbZmllbGQubmFtZV0KICAgICAgfSk7CiAgICAgIGVuY29kZWRUeXBlcy5wdXNoKHR5cGUpOwogICAgICBlbmNvZGVkVmFsdWVzLnB1c2godmFsdWUpOwogICAgfQogICAgcmV0dXJuIGVuY29kZUFiaVBhcmFtZXRlcnMoZW5jb2RlZFR5cGVzLCBlbmNvZGVkVmFsdWVzKTsKICB9CiAgZnVuY3Rpb24gaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgY29uc3QgZW5jb2RlZEhhc2hUeXBlID0gdG9IZXgoZW5jb2RlVHlwZSh7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWRIYXNoVHlwZSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZVR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgY29uc3QgdW5zb3J0ZWREZXBzID0gZmluZFR5cGVEZXBlbmRlbmNpZXMoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSk7CiAgICB1bnNvcnRlZERlcHMuZGVsZXRlKHByaW1hcnlUeXBlKTsKICAgIGNvbnN0IGRlcHMgPSBbcHJpbWFyeVR5cGUsIC4uLkFycmF5LmZyb20odW5zb3J0ZWREZXBzKS5zb3J0KCldOwogICAgZm9yIChjb25zdCB0eXBlIG9mIGRlcHMpIHsKICAgICAgcmVzdWx0ICs9IGAke3R5cGV9KCR7dHlwZXNbdHlwZV0ubWFwKCh7IG5hbWUsIHR5cGU6IHQgfSkgPT4gYCR7dH0gJHtuYW1lfWApLmpvaW4oIiwiKX0pYDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IHByaW1hcnlUeXBlXywgdHlwZXMgfSwgcmVzdWx0cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpIHsKICAgIGNvbnN0IG1hdGNoID0gcHJpbWFyeVR5cGVfLm1hdGNoKC9eXHcqL3UpOwogICAgY29uc3QgcHJpbWFyeVR5cGUgPSBtYXRjaD8uWzBdOwogICAgaWYgKHJlc3VsdHMuaGFzKHByaW1hcnlUeXBlKSB8fCB0eXBlc1twcmltYXJ5VHlwZV0gPT09IHZvaWQgMCkgewogICAgICByZXR1cm4gcmVzdWx0czsKICAgIH0KICAgIHJlc3VsdHMuYWRkKHByaW1hcnlUeXBlKTsKICAgIGZvciAoY29uc3QgZmllbGQgb2YgdHlwZXNbcHJpbWFyeVR5cGVdKSB7CiAgICAgIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IGZpZWxkLnR5cGUsIHR5cGVzIH0sIHJlc3VsdHMpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUZpZWxkKHsgdHlwZXMsIG5hbWUsIHR5cGUsIHZhbHVlIH0pIHsKICAgIGlmICh0eXBlc1t0eXBlXSAhPT0gdm9pZCAwKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgeyB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICBrZWNjYWsyNTYoZW5jb2RlRGF0YSh7IGRhdGE6IHZhbHVlLCBwcmltYXJ5VHlwZTogdHlwZSwgdHlwZXMgfSkpCiAgICAgIF07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikgewogICAgICBjb25zdCBwcmVwZW5kID0gdmFsdWUubGVuZ3RoICUgMiA/ICIwIiA6ICIiOwogICAgICB2YWx1ZSA9IGAweCR7cHJlcGVuZCArIHZhbHVlLnNsaWNlKDIpfWA7CiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHZhbHVlKV07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHRvSGV4KHZhbHVlKSldOwogICAgaWYgKHR5cGUubGFzdEluZGV4T2YoIl0iKSA9PT0gdHlwZS5sZW5ndGggLSAxKSB7CiAgICAgIGNvbnN0IHBhcnNlZFR5cGUgPSB0eXBlLnNsaWNlKDAsIHR5cGUubGFzdEluZGV4T2YoIlsiKSk7CiAgICAgIGNvbnN0IHR5cGVWYWx1ZVBhaXJzID0gdmFsdWUubWFwKChpdGVtKSA9PiBlbmNvZGVGaWVsZCh7CiAgICAgICAgbmFtZSwKICAgICAgICB0eXBlOiBwYXJzZWRUeXBlLAogICAgICAgIHR5cGVzLAogICAgICAgIHZhbHVlOiBpdGVtCiAgICAgIH0pKTsKICAgICAgcmV0dXJuIFsKICAgICAgICB7IHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIGtlY2NhazI1NihlbmNvZGVBYmlQYXJhbWV0ZXJzKHR5cGVWYWx1ZVBhaXJzLm1hcCgoW3RdKSA9PiB0KSwgdHlwZVZhbHVlUGFpcnMubWFwKChbLCB2XSkgPT4gdikpKQogICAgICBdOwogICAgfQogICAgcmV0dXJuIFt7IHR5cGUgfSwgdmFsdWVdOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplVHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZG9tYWluOiBkb21haW5fLCBtZXNzYWdlOiBtZXNzYWdlXywgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgbm9ybWFsaXplRGF0YSA9IChzdHJ1Y3QsIGRhdGFfKSA9PiB7CiAgICAgIGNvbnN0IGRhdGEgPSB7IC4uLmRhdGFfIH07CiAgICAgIGZvciAoY29uc3QgcGFyYW0gb2Ygc3RydWN0KSB7CiAgICAgICAgY29uc3QgeyBuYW1lLCB0eXBlIH0gPSBwYXJhbTsKICAgICAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKQogICAgICAgICAgZGF0YVtuYW1lXSA9IGRhdGFbbmFtZV0udG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgICByZXR1cm4gZGF0YTsKICAgIH07CiAgICBjb25zdCBkb21haW4gPSAoKCkgPT4gewogICAgICBpZiAoIXR5cGVzLkVJUDcxMkRvbWFpbikKICAgICAgICByZXR1cm4ge307CiAgICAgIGlmICghZG9tYWluXykKICAgICAgICByZXR1cm4ge307CiAgICAgIHJldHVybiBub3JtYWxpemVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluXyk7CiAgICB9KSgpOwogICAgY29uc3QgbWVzc2FnZSA9ICgoKSA9PiB7CiAgICAgIGlmIChwcmltYXJ5VHlwZSA9PT0gIkVJUDcxMkRvbWFpbiIpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgcmV0dXJuIG5vcm1hbGl6ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlXyk7CiAgICB9KSgpOwogICAgcmV0dXJuIHN0cmluZ2lmeSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVR5cGVkRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdmFsaWRhdGVEYXRhID0gKHN0cnVjdCwgZGF0YSkgPT4gewogICAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHN0cnVjdCkgewogICAgICAgIGNvbnN0IHsgbmFtZSwgdHlwZSB9ID0gcGFyYW07CiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW25hbWVdOwogICAgICAgIGNvbnN0IGludGVnZXJNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICAgICAgaWYgKGludGVnZXJNYXRjaCAmJiAodHlwZW9mIHZhbHVlID09PSAibnVtYmVyIiB8fCB0eXBlb2YgdmFsdWUgPT09ICJiaWdpbnQiKSkgewogICAgICAgICAgY29uc3QgW190eXBlLCBiYXNlMiwgc2l6ZV9dID0gaW50ZWdlck1hdGNoOwogICAgICAgICAgbnVtYmVyVG9IZXgodmFsdWUsIHsKICAgICAgICAgICAgc2lnbmVkOiBiYXNlMiA9PT0gImludCIsCiAgICAgICAgICAgIHNpemU6IE51bWJlci5wYXJzZUludChzaXplXykgLyA4CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGUgPT09ICJhZGRyZXNzIiAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFpc0FkZHJlc3ModmFsdWUpKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgICAgICBjb25zdCBieXRlc01hdGNoID0gdHlwZS5tYXRjaChieXRlc1JlZ2V4Mik7CiAgICAgICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgICAgIGNvbnN0IFtfdHlwZSwgc2l6ZV9dID0gYnl0ZXNNYXRjaDsKICAgICAgICAgIGlmIChzaXplXyAmJiBzaXplKHZhbHVlKSAhPT0gTnVtYmVyLnBhcnNlSW50KHNpemVfKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IoewogICAgICAgICAgICAgIGV4cGVjdGVkU2l6ZTogTnVtYmVyLnBhcnNlSW50KHNpemVfKSwKICAgICAgICAgICAgICBnaXZlblNpemU6IHNpemUodmFsdWUpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCBzdHJ1Y3QyID0gdHlwZXNbdHlwZV07CiAgICAgICAgaWYgKHN0cnVjdDIpIHsKICAgICAgICAgIHZhbGlkYXRlUmVmZXJlbmNlKHR5cGUpOwogICAgICAgICAgdmFsaWRhdGVEYXRhKHN0cnVjdDIsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBpZiAodHlwZXMuRUlQNzEyRG9tYWluICYmIGRvbWFpbikKICAgICAgdmFsaWRhdGVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluKTsKICAgIGlmIChwcmltYXJ5VHlwZSAhPT0gIkVJUDcxMkRvbWFpbiIpIHsKICAgICAgaWYgKHR5cGVzW3ByaW1hcnlUeXBlXSkKICAgICAgICB2YWxpZGF0ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlKTsKICAgICAgZWxzZQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0VHlwZXNGb3JFSVA3MTJEb21haW4oeyBkb21haW4gfSkgewogICAgcmV0dXJuIFsKICAgICAgdHlwZW9mIGRvbWFpbj8ubmFtZSA9PT0gInN0cmluZyIgJiYgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgIGRvbWFpbj8udmVyc2lvbiAmJiB7IG5hbWU6ICJ2ZXJzaW9uIiwgdHlwZTogInN0cmluZyIgfSwKICAgICAgdHlwZW9mIGRvbWFpbj8uY2hhaW5JZCA9PT0gIm51bWJlciIgJiYgewogICAgICAgIG5hbWU6ICJjaGFpbklkIiwKICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgfSwKICAgICAgZG9tYWluPy52ZXJpZnlpbmdDb250cmFjdCAmJiB7CiAgICAgICAgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwKICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgfSwKICAgICAgZG9tYWluPy5zYWx0ICYmIHsgbmFtZTogInNhbHQiLCB0eXBlOiAiYnl0ZXMzMiIgfQogICAgXS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGRvbWFpblNlcGFyYXRvcih7IGRvbWFpbiB9KSB7CiAgICByZXR1cm4gaGFzaERvbWFpbih7CiAgICAgIGRvbWFpbiwKICAgICAgdHlwZXM6IHsKICAgICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pCiAgICAgIH0KICAgIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVJlZmVyZW5jZSh0eXBlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiIHx8IHR5cGUgPT09ICJib29sIiB8fCB0eXBlID09PSAic3RyaW5nIiB8fCB0eXBlLnN0YXJ0c1dpdGgoImJ5dGVzIikgfHwgdHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgdHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IoeyB0eXBlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvbkRhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvbkRhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGRhdGEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzbGljZShkYXRhLCAwLCA0KTsKICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJmdW5jdGlvbiIgJiYgc2lnbmF0dXJlID09PSB0b0Z1bmN0aW9uU2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVGdW5jdGlvbkRhdGEiCiAgICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgZnVuY3Rpb25OYW1lOiBkZXNjcmlwdGlvbi5uYW1lLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBkZXNjcmlwdGlvbiAmJiBkZXNjcmlwdGlvbi5pbnB1dHMgJiYgZGVzY3JpcHRpb24uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgc2xpY2UoZGF0YSwgNCkpIDogdm9pZCAwCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVFcnJvclJlc3VsdC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg2ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUVycm9yUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVFcnJvclJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZXJyb3JOYW1lLCBhcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGVycm9yTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZXJyb3JOYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9yTm90Rm91bmRFcnJvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgQWJpRXJyb3JOb3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg2IH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9GdW5jdGlvblNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IGRhdGEgPSAiMHgiOwogICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGggPiAwKSB7CiAgICAgIGlmICghYWJpSXRlbS5pbnB1dHMpCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvcihhYmlJdGVtLm5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMsIGFyZ3MpOwogICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbc2lnbmF0dXJlLCBkYXRhXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaW5kZXguanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uUmVzdWx0LmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg3ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUZ1bmN0aW9uUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lLCByZXN1bHQgfSA9IHBhcmFtZXRlcnM7CiAgICBsZXQgYWJpSXRlbSA9IGFiaTJbMF07CiAgICBpZiAoZnVuY3Rpb25OYW1lKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSBnZXRBYmlJdGVtKHsgYWJpOiBhYmkyLCBuYW1lOiBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmICghaXRlbSkKICAgICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg3IH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBpZiAoIWFiaUl0ZW0ub3V0cHV0cykKICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IoYWJpSXRlbS5uYW1lLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBsZXQgdmFsdWVzID0gQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0IDogW3Jlc3VsdF07CiAgICBpZiAoYWJpSXRlbS5vdXRwdXRzLmxlbmd0aCA9PT0gMCAmJiAhdmFsdWVzWzBdKQogICAgICB2YWx1ZXMgPSBbXTsKICAgIHJldHVybiBlbmNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0ub3V0cHV0cywgdmFsdWVzKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlUGFja2VkLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9wYWQoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlUGFja2VkKHR5cGVzLCB2YWx1ZXMpIHsKICAgIGlmICh0eXBlcy5sZW5ndGggIT09IHZhbHVlcy5sZW5ndGgpCiAgICAgIHRocm93IG5ldyBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IoewogICAgICAgIGV4cGVjdGVkTGVuZ3RoOiB0eXBlcy5sZW5ndGgsCiAgICAgICAgZ2l2ZW5MZW5ndGg6IHZhbHVlcy5sZW5ndGgKICAgICAgfSk7CiAgICBjb25zdCBkYXRhID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHR5cGUgPSB0eXBlc1tpXTsKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07CiAgICAgIGRhdGEucHVzaChlbmNvZGUodHlwZSwgdmFsdWUpKTsKICAgIH0KICAgIHJldHVybiBjb25jYXRIZXgoZGF0YSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZSh0eXBlLCB2YWx1ZSwgaXNBcnJheSA9IGZhbHNlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIGNvbnN0IGFkZHJlc3MgPSB2YWx1ZTsKICAgICAgaWYgKCFpc0FkZHJlc3MoYWRkcmVzcykpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICByZXR1cm4gcGFkKGFkZHJlc3MudG9Mb3dlckNhc2UoKSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBzdHJpbmdUb0hleCh2YWx1ZSk7CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIHZhbHVlOwogICAgaWYgKHR5cGUgPT09ICJib29sIikKICAgICAgcmV0dXJuIHBhZChib29sVG9IZXgodmFsdWUpLCB7IHNpemU6IGlzQXJyYXkgPyAzMiA6IDEgfSk7CiAgICBjb25zdCBpbnRNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICBpZiAoaW50TWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBiYXNlVHlwZSwgYml0cyA9ICIyNTYiXSA9IGludE1hdGNoOwogICAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChiaXRzKSAvIDg7CiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IHNpemUzLAogICAgICAgIHNpZ25lZDogYmFzZVR5cGUgPT09ICJpbnQiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYnl0ZXNNYXRjaCA9IHR5cGUubWF0Y2goYnl0ZXNSZWdleDIpOwogICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBzaXplM10gPSBieXRlc01hdGNoOwogICAgICBpZiAoTnVtYmVyLnBhcnNlSW50KHNpemUzKSAhPT0gKHZhbHVlLmxlbmd0aCAtIDIpIC8gMikKICAgICAgICB0aHJvdyBuZXcgQnl0ZXNTaXplTWlzbWF0Y2hFcnJvcih7CiAgICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChzaXplMyksCiAgICAgICAgICBnaXZlblNpemU6ICh2YWx1ZS5sZW5ndGggLSAyKSAvIDIKICAgICAgICB9KTsKICAgICAgcmV0dXJuIHBhZCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIsIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwgfSk7CiAgICB9CiAgICBjb25zdCBhcnJheU1hdGNoID0gdHlwZS5tYXRjaChhcnJheVJlZ2V4KTsKICAgIGlmIChhcnJheU1hdGNoICYmIEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGNvbnN0IFtfdHlwZSwgY2hpbGRUeXBlXSA9IGFycmF5TWF0Y2g7CiAgICAgIGNvbnN0IGRhdGEgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGEucHVzaChlbmNvZGUoY2hpbGRUeXBlLCB2YWx1ZVtpXSwgdHJ1ZSkpOwogICAgICB9CiAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkKICAgICAgICByZXR1cm4gIjB4IjsKICAgICAgcmV0dXJuIGNvbmNhdEhleChkYXRhKTsKICAgIH0KICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUodHlwZSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9nZXRDb250cmFjdEFkZHJlc3MuanMKICBpbml0X2NvbmNhdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0J5dGVzLmpzCiAgZnVuY3Rpb24gaXNCeXRlczModmFsdWUpIHsKICAgIGlmICghdmFsdWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJvYmplY3QiKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoISgiQllURVNfUEVSX0VMRU1FTlQiIGluIHZhbHVlKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHZhbHVlLkJZVEVTX1BFUl9FTEVNRU5UID09PSAxICYmIHZhbHVlLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldENvbnRyYWN0QWRkcmVzcy5qcwogIGluaXRfcGFkKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgZnVuY3Rpb24gZ2V0Q29udHJhY3RBZGRyZXNzMihvcHRzKSB7CiAgICBpZiAob3B0cy5vcGNvZGUgPT09ICJDUkVBVEUyIikKICAgICAgcmV0dXJuIGdldENyZWF0ZTJBZGRyZXNzKG9wdHMpOwogICAgcmV0dXJuIGdldENyZWF0ZUFkZHJlc3Mob3B0cyk7CiAgfQogIGZ1bmN0aW9uIGdldENyZWF0ZUFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGxldCBub25jZSA9IHRvQnl0ZXMob3B0cy5ub25jZSk7CiAgICBpZiAobm9uY2VbMF0gPT09IDApCiAgICAgIG5vbmNlID0gbmV3IFVpbnQ4QXJyYXkoW10pOwogICAgcmV0dXJuIGdldEFkZHJlc3MoYDB4JHtrZWNjYWsyNTYodG9SbHAoW2Zyb20sIG5vbmNlXSwgImJ5dGVzIikpLnNsaWNlKDI2KX1gKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q3JlYXRlMkFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGNvbnN0IHNhbHQgPSBwYWQoaXNCeXRlczMob3B0cy5zYWx0KSA/IG9wdHMuc2FsdCA6IHRvQnl0ZXMob3B0cy5zYWx0KSwgewogICAgICBzaXplOiAzMgogICAgfSk7CiAgICBjb25zdCBieXRlY29kZUhhc2ggPSAoKCkgPT4gewogICAgICBpZiAoImJ5dGVjb2RlSGFzaCIgaW4gb3B0cykgewogICAgICAgIGlmIChpc0J5dGVzMyhvcHRzLmJ5dGVjb2RlSGFzaCkpCiAgICAgICAgICByZXR1cm4gb3B0cy5ieXRlY29kZUhhc2g7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMob3B0cy5ieXRlY29kZUhhc2gpOwogICAgICB9CiAgICAgIHJldHVybiBrZWNjYWsyNTYob3B0cy5ieXRlY29kZSwgImJ5dGVzIik7CiAgICB9KSgpOwogICAgcmV0dXJuIGdldEFkZHJlc3Moc2xpY2Uoa2VjY2FrMjU2KGNvbmNhdChbdG9CeXRlcygiMHhmZiIpLCBmcm9tLCBzYWx0LCBieXRlY29kZUhhc2hdKSksIDEyKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvblJlY2VpcHQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X2Zvcm1hdHRlcigpOwogIHZhciByZWNlaXB0U3RhdHVzZXMgPSB7CiAgICAiMHgwIjogInJldmVydGVkIiwKICAgICIweDEiOiAic3VjY2VzcyIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCh0cmFuc2FjdGlvblJlY2VpcHQpIHsKICAgIGNvbnN0IHJlY2VpcHQgPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uUmVjZWlwdCwKICAgICAgYmxvY2tOdW1iZXI6IHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvblJlY2VpcHQuYmxvY2tOdW1iZXIpIDogbnVsbCwKICAgICAgY29udHJhY3RBZGRyZXNzOiB0cmFuc2FjdGlvblJlY2VpcHQuY29udHJhY3RBZGRyZXNzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmNvbnRyYWN0QWRkcmVzcyA6IG51bGwsCiAgICAgIGN1bXVsYXRpdmVHYXNVc2VkOiB0cmFuc2FjdGlvblJlY2VpcHQuY3VtdWxhdGl2ZUdhc1VzZWQgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmN1bXVsYXRpdmVHYXNVc2VkKSA6IG51bGwsCiAgICAgIGVmZmVjdGl2ZUdhc1ByaWNlOiB0cmFuc2FjdGlvblJlY2VpcHQuZWZmZWN0aXZlR2FzUHJpY2UgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmVmZmVjdGl2ZUdhc1ByaWNlKSA6IG51bGwsCiAgICAgIGdhc1VzZWQ6IHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkID8gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkKSA6IG51bGwsCiAgICAgIGxvZ3M6IHRyYW5zYWN0aW9uUmVjZWlwdC5sb2dzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKSA6IG51bGwsCiAgICAgIHRvOiB0cmFuc2FjdGlvblJlY2VpcHQudG8gPyB0cmFuc2FjdGlvblJlY2VpcHQudG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvblJlY2VpcHQudHJhbnNhY3Rpb25JbmRleCA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uUmVjZWlwdC50cmFuc2FjdGlvbkluZGV4KSA6IG51bGwsCiAgICAgIHN0YXR1czogdHJhbnNhY3Rpb25SZWNlaXB0LnN0YXR1cyA/IHJlY2VpcHRTdGF0dXNlc1t0cmFuc2FjdGlvblJlY2VpcHQuc3RhdHVzXSA6IG51bGwsCiAgICAgIHR5cGU6IHRyYW5zYWN0aW9uUmVjZWlwdC50eXBlID8gdHJhbnNhY3Rpb25UeXBlW3RyYW5zYWN0aW9uUmVjZWlwdC50eXBlXSB8fCB0cmFuc2FjdGlvblJlY2VpcHQudHlwZSA6IG51bGwKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSkKICAgICAgcmVjZWlwdC5ibG9iR2FzUHJpY2UgPSBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSk7CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNVc2VkKQogICAgICByZWNlaXB0LmJsb2JHYXNVc2VkID0gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9iR2FzVXNlZCk7CiAgICByZXR1cm4gcmVjZWlwdDsKICB9CiAgdmFyIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVGb3JtYXR0ZXIoInRyYW5zYWN0aW9uUmVjZWlwdCIsIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9pbmRleC5qcwogIGluaXRfZnJvbUhleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbVJscC5qcwogIGluaXRfYmFzZSgpOwogIGluaXRfZW5jb2RpbmcoKTsKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbVJscCh2YWx1ZSwgdG8gPSAiaGV4IikgewogICAgY29uc3QgYnl0ZXMyID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMyAmJiB2YWx1ZS5sZW5ndGggJSAyICE9PSAwKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRIZXhWYWx1ZUVycm9yKHZhbHVlKTsKICAgICAgICByZXR1cm4gaGV4VG9CeXRlcyh2YWx1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSkoKTsKICAgIGNvbnN0IGN1cnNvciA9IGNyZWF0ZUN1cnNvcihieXRlczIsIHsKICAgICAgcmVjdXJzaXZlUmVhZExpbWl0OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkKICAgIH0pOwogICAgY29uc3QgcmVzdWx0ID0gZnJvbVJscEN1cnNvcihjdXJzb3IsIHRvKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0byA9ICJoZXgiKSB7CiAgICBpZiAoY3Vyc29yLmJ5dGVzLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKSA6IGN1cnNvci5ieXRlczsKICAgIGNvbnN0IHByZWZpeCA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgaWYgKHByZWZpeCA8IDEyOCkKICAgICAgY3Vyc29yLmRlY3JlbWVudFBvc2l0aW9uKDEpOwogICAgaWYgKHByZWZpeCA8IDE5MikgewogICAgICBjb25zdCBsZW5ndGgyID0gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgMTI4KTsKICAgICAgY29uc3QgYnl0ZXMyID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgyKTsKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoYnl0ZXMyKSA6IGJ5dGVzMjsKICAgIH0KICAgIGNvbnN0IGxlbmd0aCA9IHJlYWRMZW5ndGgoY3Vyc29yLCBwcmVmaXgsIDE5Mik7CiAgICByZXR1cm4gcmVhZExpc3QoY3Vyc29yLCBsZW5ndGgsIHRvKTsKICB9CiAgZnVuY3Rpb24gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgb2Zmc2V0KSB7CiAgICBpZiAob2Zmc2V0ID09PSAxMjggJiYgcHJlZml4IDwgMTI4KQogICAgICByZXR1cm4gMTsKICAgIGlmIChwcmVmaXggPD0gb2Zmc2V0ICsgNTUpCiAgICAgIHJldHVybiBwcmVmaXggLSBvZmZzZXQ7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDEpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQ4KCk7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDIpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQxNigpOwogICAgaWYgKHByZWZpeCA9PT0gb2Zmc2V0ICsgNTUgKyAzKQogICAgICByZXR1cm4gY3Vyc29yLnJlYWRVaW50MjQoKTsKICAgIGlmIChwcmVmaXggPT09IG9mZnNldCArIDU1ICsgNCkKICAgICAgcmV0dXJuIGN1cnNvci5yZWFkVWludDMyKCk7CiAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiSW52YWxpZCBSTFAgcHJlZml4Iik7CiAgfQogIGZ1bmN0aW9uIHJlYWRMaXN0KGN1cnNvciwgbGVuZ3RoLCB0bykgewogICAgY29uc3QgcG9zaXRpb24gPSBjdXJzb3IucG9zaXRpb247CiAgICBjb25zdCB2YWx1ZSA9IFtdOwogICAgd2hpbGUgKGN1cnNvci5wb3NpdGlvbiAtIHBvc2l0aW9uIDwgbGVuZ3RoKQogICAgICB2YWx1ZS5wdXNoKGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0bykpOwogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudFNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9GdW5jdGlvblNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudEhhc2guanMKICBpbml0X3RvU2lnbmF0dXJlSGFzaCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC90b0Z1bmN0aW9uSGFzaC5qcwogIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2lzSGFzaC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3NpemUoKTsKICBmdW5jdGlvbiBpc0hhc2goaGFzaDMpIHsKICAgIHJldHVybiBpc0hleChoYXNoMykgJiYgc2l6ZShoYXNoMykgPT09IDMyOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3JpcGVtZDE2MC5qcwogIGluaXRfbWQoKTsKICBpbml0X3V0aWxzMigpOwogIHZhciBSaG8gPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkoWzcsIDQsIDEzLCAxLCAxMCwgNiwgMTUsIDMsIDEyLCAwLCA5LCA1LCAyLCAxNCwgMTEsIDhdKTsKICB2YXIgSWQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5KDE2KS5maWxsKDApLm1hcCgoXywgaSkgPT4gaSkpOwogIHZhciBQaSA9IC8qIEBfX1BVUkVfXyAqLyBJZC5tYXAoKGkpID0+ICg5ICogaSArIDUpICUgMTYpOwogIHZhciBpZHhMID0gW0lkXTsKICB2YXIgaWR4UiA9IFtQaV07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspCiAgICBmb3IgKGxldCBqIG9mIFtpZHhMLCBpZHhSXSkKICAgICAgai5wdXNoKGpbaV0ubWFwKChrKSA9PiBSaG9ba10pKTsKICB2YXIgc2hpZnRzID0gLyogQF9fUFVSRV9fICovIFsKICAgIFsxMSwgMTQsIDE1LCAxMiwgNSwgOCwgNywgOSwgMTEsIDEzLCAxNCwgMTUsIDYsIDcsIDksIDhdLAogICAgWzEyLCAxMywgMTEsIDE1LCA2LCA5LCA5LCA3LCAxMiwgMTUsIDExLCAxMywgNywgOCwgNywgN10sCiAgICBbMTMsIDE1LCAxNCwgMTEsIDcsIDcsIDYsIDgsIDEzLCAxNCwgMTMsIDEyLCA1LCA1LCA2LCA5XSwKICAgIFsxNCwgMTEsIDEyLCAxNCwgOCwgNiwgNSwgNSwgMTUsIDEyLCAxNSwgMTQsIDksIDksIDgsIDZdLAogICAgWzE1LCAxMiwgMTMsIDEzLCA5LCA1LCA4LCA2LCAxNCwgMTEsIDEyLCAxMSwgOCwgNiwgNSwgNV0KICBdLm1hcCgoaSkgPT4gbmV3IFVpbnQ4QXJyYXkoaSkpOwogIHZhciBzaGlmdHNMID0gLyogQF9fUFVSRV9fICovIGlkeEwubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBzaGlmdHNSID0gLyogQF9fUFVSRV9fICovIGlkeFIubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBLbCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgMCwKICAgIDE1MTg1MDAyNDksCiAgICAxODU5Nzc1MzkzLAogICAgMjQwMDk1OTcwOCwKICAgIDI4NDA4NTM4MzgKICBdKTsKICB2YXIgS3IgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgIDEzNTI4Mjk5MjYsCiAgICAxNTQ4NjAzNjg0LAogICAgMTgzNjA3MjY5MSwKICAgIDIwNTM5OTQyMTcsCiAgICAwCiAgXSk7CiAgZnVuY3Rpb24gZihncm91cCwgeCwgeSwgeikgewogICAgaWYgKGdyb3VwID09PSAwKQogICAgICByZXR1cm4geCBeIHkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDEpCiAgICAgIHJldHVybiB4ICYgeSB8IH54ICYgejsKICAgIGVsc2UgaWYgKGdyb3VwID09PSAyKQogICAgICByZXR1cm4gKHggfCB+eSkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDMpCiAgICAgIHJldHVybiB4ICYgeiB8IHkgJiB+ejsKICAgIGVsc2UKICAgICAgcmV0dXJuIHggXiAoeSB8IH56KTsKICB9CiAgdmFyIFJfQlVGID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50MzJBcnJheSgxNik7CiAgdmFyIFJJUEVNRDE2MCA9IGNsYXNzIGV4dGVuZHMgSGFzaE1EIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcig2NCwgMjAsIDgsIHRydWUpOwogICAgICB0aGlzLmgwID0gMTczMjU4NDE5MyB8IDA7CiAgICAgIHRoaXMuaDEgPSA0MDIzMjMzNDE3IHwgMDsKICAgICAgdGhpcy5oMiA9IDI1NjIzODMxMDIgfCAwOwogICAgICB0aGlzLmgzID0gMjcxNzMzODc4IHwgMDsKICAgICAgdGhpcy5oNCA9IDMyODUzNzc1MjAgfCAwOwogICAgfQogICAgZ2V0KCkgewogICAgICBjb25zdCB7IGgwLCBoMSwgaDIsIGgzLCBoNCB9ID0gdGhpczsKICAgICAgcmV0dXJuIFtoMCwgaDEsIGgyLCBoMywgaDRdOwogICAgfQogICAgc2V0KGgwLCBoMSwgaDIsIGgzLCBoNCkgewogICAgICB0aGlzLmgwID0gaDAgfCAwOwogICAgICB0aGlzLmgxID0gaDEgfCAwOwogICAgICB0aGlzLmgyID0gaDIgfCAwOwogICAgICB0aGlzLmgzID0gaDMgfCAwOwogICAgICB0aGlzLmg0ID0gaDQgfCAwOwogICAgfQogICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrLCBvZmZzZXQgKz0gNCkKICAgICAgICBSX0JVRltpXSA9IHZpZXcuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7CiAgICAgIGxldCBhbCA9IHRoaXMuaDAgfCAwLCBhciA9IGFsLCBibCA9IHRoaXMuaDEgfCAwLCBiciA9IGJsLCBjbCA9IHRoaXMuaDIgfCAwLCBjciA9IGNsLCBkbCA9IHRoaXMuaDMgfCAwLCBkciA9IGRsLCBlbCA9IHRoaXMuaDQgfCAwLCBlciA9IGVsOwogICAgICBmb3IgKGxldCBncm91cCA9IDA7IGdyb3VwIDwgNTsgZ3JvdXArKykgewogICAgICAgIGNvbnN0IHJHcm91cCA9IDQgLSBncm91cDsKICAgICAgICBjb25zdCBoYmwgPSBLbFtncm91cF0sIGhiciA9IEtyW2dyb3VwXTsKICAgICAgICBjb25zdCBybCA9IGlkeExbZ3JvdXBdLCByciA9IGlkeFJbZ3JvdXBdOwogICAgICAgIGNvbnN0IHNsID0gc2hpZnRzTFtncm91cF0sIHNyID0gc2hpZnRzUltncm91cF07CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB0bCA9IHJvdGwoYWwgKyBmKGdyb3VwLCBibCwgY2wsIGRsKSArIFJfQlVGW3JsW2ldXSArIGhibCwgc2xbaV0pICsgZWwgfCAwOwogICAgICAgICAgYWwgPSBlbCwgZWwgPSBkbCwgZGwgPSByb3RsKGNsLCAxMCkgfCAwLCBjbCA9IGJsLCBibCA9IHRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHsKICAgICAgICAgIGNvbnN0IHRyID0gcm90bChhciArIGYockdyb3VwLCBiciwgY3IsIGRyKSArIFJfQlVGW3JyW2ldXSArIGhiciwgc3JbaV0pICsgZXIgfCAwOwogICAgICAgICAgYXIgPSBlciwgZXIgPSBkciwgZHIgPSByb3RsKGNyLCAxMCkgfCAwLCBjciA9IGJyLCBiciA9IHRyOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNldCh0aGlzLmgxICsgY2wgKyBkciB8IDAsIHRoaXMuaDIgKyBkbCArIGVyIHwgMCwgdGhpcy5oMyArIGVsICsgYXIgfCAwLCB0aGlzLmg0ICsgYWwgKyBiciB8IDAsIHRoaXMuaDAgKyBibCArIGNyIHwgMCk7CiAgICB9CiAgICByb3VuZENsZWFuKCkgewogICAgICBSX0JVRi5maWxsKDApOwogICAgfQogICAgZGVzdHJveSgpIHsKICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlOwogICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICB0aGlzLnNldCgwLCAwLCAwLCAwLCAwKTsKICAgIH0KICB9OwogIHZhciByaXBlbWQxNjAgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBSSVBFTUQxNjAoKSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3JpcGVtZDE2MC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcmlwZW1kMTYwMih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IHJpcGVtZDE2MChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pID8gdG9CeXRlcyh2YWx1ZSkgOiB2YWx1ZSk7CiAgICBpZiAodG8gPT09ICJieXRlcyIpCiAgICAgIHJldHVybiBieXRlczI7CiAgICByZXR1cm4gdG9IZXgoYnl0ZXMyKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvaGFzaE1lc3NhZ2UuanMKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3N0cmluZ3MuanMKICB2YXIgcHJlc2lnbk1lc3NhZ2VQcmVmaXggPSAiGUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS90b1ByZWZpeGVkTWVzc2FnZS5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2VfKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXyA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHN0cmluZ1RvSGV4KG1lc3NhZ2VfKTsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXy5yYXcgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBtZXNzYWdlXy5yYXc7CiAgICAgIHJldHVybiBieXRlc1RvSGV4KG1lc3NhZ2VfLnJhdyk7CiAgICB9KSgpOwogICAgY29uc3QgcHJlZml4ID0gc3RyaW5nVG9IZXgoYCR7cHJlc2lnbk1lc3NhZ2VQcmVmaXh9JHtzaXplKG1lc3NhZ2UpfWApOwogICAgcmV0dXJuIGNvbmNhdChbcHJlZml4LCBtZXNzYWdlXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hNZXNzYWdlLmpzCiAgZnVuY3Rpb24gaGFzaE1lc3NhZ2UobWVzc2FnZSwgdG9fKSB7CiAgICByZXR1cm4ga2VjY2FrMjU2KHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2UpLCB0b18pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9yZWNvdmVyTWVzc2FnZUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaE1lc3NhZ2UobWVzc2FnZSksIHNpZ25hdHVyZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclR5cGVkRGF0YUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHNpZ25hdHVyZSwgdHlwZXMgfSA9IHBhcmFtZXRlcnM7CiAgICByZXR1cm4gcmVjb3ZlckFkZHJlc3MoewogICAgICBoYXNoOiBoYXNoVHlwZWREYXRhKHsKICAgICAgICBkb21haW4sCiAgICAgICAgbWVzc2FnZSwKICAgICAgICBwcmltYXJ5VHlwZSwKICAgICAgICB0eXBlcwogICAgICB9KSwKICAgICAgc2lnbmF0dXJlCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5SGFzaC5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlIYXNoKHsgYWRkcmVzcywgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSB7CiAgICByZXR1cm4gaXNBZGRyZXNzRXF1YWwoZ2V0QWRkcmVzcyhhZGRyZXNzKSwgYXdhaXQgcmVjb3ZlckFkZHJlc3MoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5TWVzc2FnZS5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlNZXNzYWdlKHsgYWRkcmVzcywgbWVzc2FnZSwgc2lnbmF0dXJlIH0pIHsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS92ZXJpZnlUeXBlZERhdGEuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZG9tYWluLCBtZXNzYWdlLCBwcmltYXJ5VHlwZSwgc2lnbmF0dXJlLCB0eXBlcyB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyh7CiAgICAgIGRvbWFpbiwKICAgICAgbWVzc2FnZSwKICAgICAgcHJpbWFyeVR5cGUsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgdHlwZXMKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcGFyc2VFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYnl0ZXMuanMKICB2YXIgZXJjNjQ5Mk1hZ2ljQnl0ZXMgPSAiMHg2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyIjsKICB2YXIgemVyb0hhc2ggPSAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9pc0VyYzY0OTJTaWduYXR1cmUuanMKICBpbml0X3NsaWNlKCk7CiAgZnVuY3Rpb24gaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIHNsaWNlSGV4KHNpZ25hdHVyZSwgLTMyKSA9PT0gZXJjNjQ5Mk1hZ2ljQnl0ZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlRXJjNjQ5MlNpZ25hdHVyZS5qcwogIGZ1bmN0aW9uIHBhcnNlRXJjNjQ5MlNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIGlmICghaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHNpZ25hdHVyZSB9OwogICAgY29uc3QgW2FkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZV9dID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbeyB0eXBlOiAiYWRkcmVzcyIgfSwgeyB0eXBlOiAiYnl0ZXMiIH0sIHsgdHlwZTogImJ5dGVzIiB9XSwgc2lnbmF0dXJlKTsKICAgIHJldHVybiB7IGFkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZTogc2lnbmF0dXJlXyB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBmdW5jdGlvbiBzZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZGF0YSwgc2lnbmF0dXJlLCB0byA9ICJoZXgiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9IGNvbmNhdEhleChbCiAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImFkZHJlc3MiIH0sIHsgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFthZGRyZXNzLCBkYXRhLCBzaWduYXR1cmVdKSwKICAgICAgZXJjNjQ5Mk1hZ2ljQnl0ZXMKICAgIF0pOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIHNpZ25hdHVyZV87CiAgICByZXR1cm4gaGV4VG9CeXRlcyhzaWduYXR1cmVfKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9nZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X2Zyb21IZXgoKTsKICBmdW5jdGlvbiBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3Qgc2VyaWFsaXplZFR5cGUgPSBzbGljZUhleChzZXJpYWxpemVkVHJhbnNhY3Rpb24sIDAsIDEpOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwNCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgPT09ICIweDAzIikKICAgICAgcmV0dXJuICJlaXA0ODQ0IjsKICAgIGlmIChzZXJpYWxpemVkVHlwZSA9PT0gIjB4MDIiKQogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwMSIpCiAgICAgIHJldHVybiAiZWlwMjkzMCI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgIT09ICIweCIgJiYgaGV4VG9OdW1iZXIoc2VyaWFsaXplZFR5cGUpID49IDE5MikKICAgICAgcmV0dXJuICJsZWdhY3kiOwogICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlRXJyb3IoeyBzZXJpYWxpemVkVHlwZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRUcmFuc2FjdGlvbi5qcwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jaGFpbigpOwogIGluaXRfbm9kZSgpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIGFzc2VydFRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBhdXRob3JpemF0aW9uTGlzdCB9ID0gdHJhbnNhY3Rpb247CiAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgZm9yIChjb25zdCBhdXRob3JpemF0aW9uIG9mIGF1dGhvcml6YXRpb25MaXN0KSB7CiAgICAgICAgY29uc3QgeyBjb250cmFjdEFkZHJlc3MsIGNoYWluSWQgfSA9IGF1dGhvcml6YXRpb247CiAgICAgICAgaWYgKCFpc0FkZHJlc3MoY29udHJhY3RBZGRyZXNzKSkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogY29udHJhY3RBZGRyZXNzIH0pOwogICAgICAgIGlmIChjaGFpbklkIDwgMCkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgICAgfQogICAgfQogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGJsb2JWZXJzaW9uZWRIYXNoZXMgfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMubGVuZ3RoID09PSAwKQogICAgICAgIHRocm93IG5ldyBFbXB0eUJsb2JFcnJvcigpOwogICAgICBmb3IgKGNvbnN0IGhhc2gzIG9mIGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgICBjb25zdCBzaXplXyA9IHNpemUoaGFzaDMpOwogICAgICAgIGNvbnN0IHZlcnNpb24zID0gaGV4VG9OdW1iZXIoc2xpY2UoaGFzaDMsIDAsIDEpKTsKICAgICAgICBpZiAoc2l6ZV8gIT09IDMyKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRWZXJzaW9uZWRIYXNoU2l6ZUVycm9yKHsgaGFzaDogaGFzaDMsIHNpemU6IHNpemVfIH0pOwogICAgICAgIGlmICh2ZXJzaW9uMyAhPT0gdmVyc2lvbmVkSGFzaFZlcnNpb25LemcpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFZlcnNpb25lZEhhc2hWZXJzaW9uRXJyb3IoewogICAgICAgICAgICBoYXNoOiBoYXNoMywKICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbjMKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGNoYWluSWQgPD0gMCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRDaGFpbklkRXJyb3IoeyBjaGFpbklkIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKG1heEZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzIH0pOwogICAgaWYgKG1heFByaW9yaXR5RmVlUGVyR2FzICYmIG1heEZlZVBlckdhcyAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyA+IG1heEZlZVBlckdhcykKICAgICAgdGhyb3cgbmV3IFRpcEFib3ZlRmVlQ2FwRXJyb3IoeyBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIHRvIH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIEVJUC0yOTMwIFRyYW5zYWN0aW9uIGF0dHJpYnV0ZS4iKTsKICAgIGlmIChnYXNQcmljZSAmJiBnYXNQcmljZSA+IG1heFVpbnQyNTYpCiAgICAgIHRocm93IG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoeyBtYXhGZWVQZXJHYXM6IGdhc1ByaWNlIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBjaGFpbklkLCBtYXhQcmlvcml0eUZlZVBlckdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKHR5cGVvZiBjaGFpbklkICE9PSAidW5kZWZpbmVkIiAmJiBjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIExlZ2FjeSBUcmFuc2FjdGlvbiBhdHRyaWJ1dGUuIik7CiAgICBpZiAoZ2FzUHJpY2UgJiYgZ2FzUHJpY2UgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzOiBnYXNQcmljZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9wYXJzZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfcGFkKCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VUcmFuc2FjdGlvbihzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDE1NTkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXA0ODQ0IikKICAgICAgcmV0dXJuIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDc3MDIiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDc3MDIoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uTGVnYWN5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA3NzAyKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIHYsIHIsIHNdID0gdHJhbnNhY3Rpb25BcnJheTsKICAgIGlmICh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCAhPT0gMTAgJiYgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggIT09IDEzKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIGF1dGhvcml6YXRpb25MaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNzcwMiIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA3NzAyIgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckdhcykgJiYgbWF4RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJHYXMpOwogICAgaWYgKGlzSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAoYWNjZXNzTGlzdC5sZW5ndGggIT09IDAgJiYgYWNjZXNzTGlzdCAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uYWNjZXNzTGlzdCA9IHBhcnNlQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGlmIChhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggIT09IDAgJiYgYXV0aG9yaXphdGlvbkxpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmF1dGhvcml6YXRpb25MaXN0ID0gcGFyc2VBdXRob3JpemF0aW9uTGlzdChhdXRob3JpemF0aW9uTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEzID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25PcldyYXBwZXJBcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgaGFzTmV0d29ya1dyYXBwZXIgPSB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5Lmxlbmd0aCA9PT0gNDsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSBoYXNOZXR3b3JrV3JhcHBlciA/IHRyYW5zYWN0aW9uT3JXcmFwcGVyQXJyYXlbMF0gOiB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5OwogICAgY29uc3Qgd3JhcHBlckFycmF5ID0gaGFzTmV0d29ya1dyYXBwZXIgPyB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5LnNsaWNlKDEpIDogW107CiAgICBjb25zdCBbY2hhaW5JZCwgbm9uY2UsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBtYXhGZWVQZXJHYXMsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCBtYXhGZWVQZXJCbG9iR2FzLCBibG9iVmVyc2lvbmVkSGFzaGVzLCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBjb25zdCBbYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdID0gd3JhcHBlckFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExIHx8IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxNCkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IoewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGNoYWluSWQsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNDg0NCIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcywKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA0ODQ0IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckJsb2JHYXMpICYmIG1heEZlZVBlckJsb2JHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJCbG9iR2FzKTsKICAgIGlmIChpc0hleChtYXhGZWVQZXJHYXMpICYmIG1heEZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4RmVlUGVyR2FzKTsKICAgIGlmIChpc0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4UHJpb3JpdHlGZWVQZXJHYXMpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBpZiAoYmxvYnMgJiYgY29tbWl0bWVudHMgJiYgcHJvb2ZzKQogICAgICB0cmFuc2FjdGlvbi5zaWRlY2FycyA9IHRvQmxvYlNpZGVjYXJzKHsKICAgICAgICBibG9icywKICAgICAgICBjb21taXRtZW50cywKICAgICAgICBwcm9vZnMKICAgICAgfSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDE0ID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVAxNTU5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgdiwgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEyKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvcih7CiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIG5vbmNlLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgICBnYXMsCiAgICAgICAgICB0bywKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDkgPyB7CiAgICAgICAgICAgIHYsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIHMKICAgICAgICAgIH0gOiB7fQogICAgICAgIH0sCiAgICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uLAogICAgICAgIHR5cGU6ICJlaXAxNTU5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICBjaGFpbklkOiBoZXhUb051bWJlcihjaGFpbklkKSwKICAgICAgdHlwZTogImVpcDE1NTkiCiAgICB9OwogICAgaWYgKGlzSGV4KHRvKSAmJiB0byAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udG8gPSB0bzsKICAgIGlmIChpc0hleChnYXMpICYmIGdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzID0gaGV4VG9CaWdJbnQoZ2FzKTsKICAgIGlmIChpc0hleChkYXRhKSAmJiBkYXRhICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5kYXRhID0gZGF0YTsKICAgIGlmIChpc0hleChub25jZSkgJiYgbm9uY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm5vbmNlID0gaGV4VG9OdW1iZXIobm9uY2UpOwogICAgaWYgKGlzSGV4KHZhbHVlKSAmJiB2YWx1ZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udmFsdWUgPSBoZXhUb0JpZ0ludCh2YWx1ZSk7CiAgICBpZiAoaXNIZXgobWF4RmVlUGVyR2FzKSAmJiBtYXhGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heEZlZVBlckdhcyk7CiAgICBpZiAoaXNIZXgobWF4UHJpb3JpdHlGZWVQZXJHYXMpICYmIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heFByaW9yaXR5RmVlUGVyR2FzKTsKICAgIGlmIChhY2Nlc3NMaXN0Lmxlbmd0aCAhPT0gMCAmJiBhY2Nlc3NMaXN0ICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ID0gcGFyc2VBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxMiA/IHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIDogdm9pZCAwOwogICAgcmV0dXJuIHsgLi4uc2lnbmF0dXJlLCAuLi50cmFuc2FjdGlvbiB9OwogIH0KICBmdW5jdGlvbiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSB0b1RyYW5zYWN0aW9uQXJyYXkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IFtjaGFpbklkLCBub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBpZiAoISh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gOCB8fCB0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gMTEpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBnYXNQcmljZSwKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIC4uLnRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID4gOCA/IHsKICAgICAgICAgICAgdiwKICAgICAgICAgICAgciwKICAgICAgICAgICAgcwogICAgICAgICAgfSA6IHt9CiAgICAgICAgfSwKICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdHlwZTogImVpcDI5MzAiCiAgICAgIH0pOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7CiAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICB0eXBlOiAiZWlwMjkzMCIKICAgIH07CiAgICBpZiAoaXNIZXgodG8pICYmIHRvICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi50byA9IHRvOwogICAgaWYgKGlzSGV4KGdhcykgJiYgZ2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5nYXMgPSBoZXhUb0JpZ0ludChnYXMpOwogICAgaWYgKGlzSGV4KGRhdGEpICYmIGRhdGEgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmRhdGEgPSBkYXRhOwogICAgaWYgKGlzSGV4KG5vbmNlKSAmJiBub25jZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubm9uY2UgPSBoZXhUb051bWJlcihub25jZSk7CiAgICBpZiAoaXNIZXgodmFsdWUpICYmIHZhbHVlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi52YWx1ZSA9IGhleFRvQmlnSW50KHZhbHVlKTsKICAgIGlmIChpc0hleChnYXNQcmljZSkgJiYgZ2FzUHJpY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhc1ByaWNlID0gaGV4VG9CaWdJbnQoZ2FzUHJpY2UpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25MZWdhY3koc2VyaWFsaXplZFRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbkFycmF5ID0gZnJvbVJscChzZXJpYWxpemVkVHJhbnNhY3Rpb24sICJoZXgiKTsKICAgIGNvbnN0IFtub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBjaGFpbklkT3JWXywgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBub25jZSwKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDYgPyB7CiAgICAgICAgICAgIHY6IGNoYWluSWRPclZfLAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAibGVnYWN5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICB0eXBlOiAibGVnYWN5IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KGdhc1ByaWNlKSAmJiBnYXNQcmljZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzUHJpY2UgPSBoZXhUb0JpZ0ludChnYXNQcmljZSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbik7CiAgICBpZiAodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IGNoYWluSWRPclYgPSBpc0hleChjaGFpbklkT3JWXykgJiYgY2hhaW5JZE9yVl8gIT09ICIweCIgPyBoZXhUb0JpZ0ludChjaGFpbklkT3JWXykgOiAwbjsKICAgIGlmIChzID09PSAiMHgiICYmIHIgPT09ICIweCIpIHsKICAgICAgaWYgKGNoYWluSWRPclYgPiAwKQogICAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBOdW1iZXIoY2hhaW5JZE9yVik7CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0KICAgIGNvbnN0IHYgPSBjaGFpbklkT3JWOwogICAgY29uc3QgY2hhaW5JZCA9IE51bWJlcigodiAtIDM1bikgLyAybik7CiAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBjaGFpbklkOwogICAgZWxzZSBpZiAodiAhPT0gMjduICYmIHYgIT09IDI4bikKICAgICAgdGhyb3cgbmV3IEludmFsaWRMZWdhY3lWRXJyb3IoeyB2IH0pOwogICAgdHJhbnNhY3Rpb24udiA9IHY7CiAgICB0cmFuc2FjdGlvbi5zID0gczsKICAgIHRyYW5zYWN0aW9uLnIgPSByOwogICAgdHJhbnNhY3Rpb24ueVBhcml0eSA9IHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICB9CiAgZnVuY3Rpb24gdG9UcmFuc2FjdGlvbkFycmF5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgcmV0dXJuIGZyb21SbHAoYDB4JHtzZXJpYWxpemVkVHJhbnNhY3Rpb24uc2xpY2UoNCl9YCwgImhleCIpOwogIH0KICBmdW5jdGlvbiBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdF8pIHsKICAgIGNvbnN0IGFjY2Vzc0xpc3QgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWNjZXNzTGlzdF8ubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW2FkZHJlc3MsIHN0b3JhZ2VLZXlzXSA9IGFjY2Vzc0xpc3RfW2ldOwogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICBhY2Nlc3NMaXN0LnB1c2goewogICAgICAgIGFkZHJlc3MsCiAgICAgICAgc3RvcmFnZUtleXM6IHN0b3JhZ2VLZXlzLm1hcCgoa2V5KSA9PiBpc0hhc2goa2V5KSA/IGtleSA6IHRyaW0oa2V5KSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYWNjZXNzTGlzdDsKICB9CiAgZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uTGlzdChzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGNvbnN0IGF1dGhvcml6YXRpb25MaXN0ID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdC5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBbY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgeVBhcml0eSwgciwgc10gPSBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3RbaV07CiAgICAgIGF1dGhvcml6YXRpb25MaXN0LnB1c2goewogICAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZTogaGV4VG9OdW1iZXIobm9uY2UpLAogICAgICAgIC4uLnBhcnNlRUlQMTU1U2lnbmF0dXJlKFt5UGFyaXR5LCByLCBzXSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYXV0aG9yaXphdGlvbkxpc3Q7CiAgfQogIGZ1bmN0aW9uIHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIHsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkuc2xpY2UoLTMpOwogICAgY29uc3QgdiA9IHNpZ25hdHVyZVswXSA9PT0gIjB4IiB8fCBoZXhUb0JpZ0ludChzaWduYXR1cmVbMF0pID09PSAwbiA/IDI3biA6IDI4bjsKICAgIHJldHVybiB7CiAgICAgIHI6IHBhZEhleChzaWduYXR1cmVbMV0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHM6IHBhZEhleChzaWduYXR1cmVbMl0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHYsCiAgICAgIHlQYXJpdHk6IHYgPT09IDI3biA/IDAgOiAxCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3RyYW5zYWN0aW9uL3NlcmlhbGl6ZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QuanMKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGlmICghYXV0aG9yaXphdGlvbkxpc3QgfHwgYXV0aG9yaXphdGlvbkxpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QgPSBbXTsKICAgIGZvciAoY29uc3QgYXV0aG9yaXphdGlvbiBvZiBhdXRob3JpemF0aW9uTGlzdCkgewogICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UsIC4uLnNpZ25hdHVyZSB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0LnB1c2goWwogICAgICAgIGNoYWluSWQgPyB0b0hleChjaGFpbklkKSA6ICIweCIsCiAgICAgICAgY29udHJhY3RBZGRyZXNzLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh7fSwgc2lnbmF0dXJlKQogICAgICBdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vc2VyaWFsaXplQWNjZXNzTGlzdC5qcwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCkgewogICAgaWYgKCFhY2Nlc3NMaXN0IHx8IGFjY2Vzc0xpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQWNjZXNzTGlzdCA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2Nlc3NMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWRkcmVzcywgc3RvcmFnZUtleXMgfSA9IGFjY2Vzc0xpc3RbaV07CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3RvcmFnZUtleXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBpZiAoc3RvcmFnZUtleXNbal0ubGVuZ3RoIC0gMiAhPT0gNjQpIHsKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcih7IHN0b3JhZ2VLZXk6IHN0b3JhZ2VLZXlzW2pdIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpIHsKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIH0KICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QucHVzaChbYWRkcmVzcywgc3RvcmFnZUtleXNdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQWNjZXNzTGlzdDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9zZXJpYWxpemVUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRUcmFuc2FjdGlvblR5cGUodHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXAxNTU5IikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQMTU1OSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgICBpZiAodHlwZSA9PT0gImVpcDQ4NDQiKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogICAgaWYgKHR5cGUgPT09ICJlaXA3NzAyIikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3NzAyKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgYXV0aG9yaXphdGlvbkxpc3QsIGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0ID0gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDA0IiwKICAgICAgdG9SbHAoWwogICAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgbWF4RmVlUGVyR2FzID8gdG9IZXgobWF4RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgICAgdG8gPz8gIjB4IiwKICAgICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgICAgZGF0YSA/PyAiMHgiLAogICAgICAgIHNlcmlhbGl6ZWRBY2Nlc3NMaXN0LAogICAgICAgIHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKQogICAgICBdKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNDg0NCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBjb25zdCB7IGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgbGV0IGJsb2JWZXJzaW9uZWRIYXNoZXMgPSB0cmFuc2FjdGlvbi5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgbGV0IHNpZGVjYXJzID0gdHJhbnNhY3Rpb24uc2lkZWNhcnM7CiAgICBpZiAodHJhbnNhY3Rpb24uYmxvYnMgJiYgKHR5cGVvZiBibG9iVmVyc2lvbmVkSGFzaGVzID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2Ygc2lkZWNhcnMgPT09ICJ1bmRlZmluZWQiKSkgewogICAgICBjb25zdCBibG9iczIgPSB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYnNbMF0gPT09ICJzdHJpbmciID8gdHJhbnNhY3Rpb24uYmxvYnMgOiB0cmFuc2FjdGlvbi5ibG9icy5tYXAoKHgpID0+IGJ5dGVzVG9IZXgoeCkpOwogICAgICBjb25zdCBremcgPSB0cmFuc2FjdGlvbi5remc7CiAgICAgIGNvbnN0IGNvbW1pdG1lbnRzMiA9IGJsb2JzVG9Db21taXRtZW50cyh7CiAgICAgICAgYmxvYnM6IGJsb2JzMiwKICAgICAgICBremcKICAgICAgfSk7CiAgICAgIGlmICh0eXBlb2YgYmxvYlZlcnNpb25lZEhhc2hlcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA9IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMoewogICAgICAgICAgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMgogICAgICAgIH0pOwogICAgICBpZiAodHlwZW9mIHNpZGVjYXJzID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNvbnN0IHByb29mczIgPSBibG9ic1RvUHJvb2ZzKHsgYmxvYnM6IGJsb2JzMiwgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMiwga3pnIH0pOwogICAgICAgIHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoeyBibG9iczogYmxvYnMyLCBjb21taXRtZW50czogY29tbWl0bWVudHMyLCBwcm9vZnM6IHByb29mczIgfSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgbWF4RmVlUGVyQmxvYkdhcyA/IHRvSGV4KG1heEZlZVBlckJsb2JHYXMpIDogIjB4IiwKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA/PyBbXSwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICBjb25zdCBibG9icyA9IFtdOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgaWYgKHNpZGVjYXJzKQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZGVjYXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgeyBibG9iLCBjb21taXRtZW50LCBwcm9vZiB9ID0gc2lkZWNhcnNbaV07CiAgICAgICAgYmxvYnMucHVzaChibG9iKTsKICAgICAgICBjb21taXRtZW50cy5wdXNoKGNvbW1pdG1lbnQpOwogICAgICAgIHByb29mcy5wdXNoKHByb29mKTsKICAgICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAzIiwKICAgICAgc2lkZWNhcnMgPyAoCiAgICAgICAgLy8gSWYgc2lkZWNhcnMgYXJlIGVuYWJsZWQsIGVudmVsb3BlIHR1cm5zIGludG8gYSAid3JhcHBlciI6CiAgICAgICAgdG9SbHAoW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdKQogICAgICApIDogKAogICAgICAgIC8vIElmIHNpZGVjYXJzIGFyZSBkaXNhYmxlZCwgc3RhbmRhcmQgZW52ZWxvcGUgaXMgdXNlZDoKICAgICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICAgICkKICAgIF0pOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGFjY2Vzc0xpc3QsIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4MDIiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVAyOTMwKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgZ2FzLCBkYXRhLCBub25jZSwgdG8sIHZhbHVlLCBhY2Nlc3NMaXN0LCBnYXNQcmljZSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IiwKICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QsCiAgICAgIC4uLnRvWVBhcml0eVNpZ25hdHVyZUFycmF5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAxIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uTGVnYWN5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCA9IDAsIGdhcywgZGF0YSwgbm9uY2UsIHRvLCB2YWx1ZSwgZ2FzUHJpY2UgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3kodHJhbnNhY3Rpb24pOwogICAgbGV0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IgogICAgXTsKICAgIGlmIChzaWduYXR1cmUpIHsKICAgICAgY29uc3QgdiA9ICgoKSA9PiB7CiAgICAgICAgaWYgKHNpZ25hdHVyZS52ID49IDM1bikgewogICAgICAgICAgY29uc3QgaW5mZXJyZWRDaGFpbklkID0gKHNpZ25hdHVyZS52IC0gMzVuKSAvIDJuOwogICAgICAgICAgaWYgKGluZmVycmVkQ2hhaW5JZCA+IDApCiAgICAgICAgICAgIHJldHVybiBzaWduYXR1cmUudjsKICAgICAgICAgIHJldHVybiAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDM1biA/IDBuIDogMW4pOwogICAgICAgIH0KICAgICAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgICAgICByZXR1cm4gQmlnSW50KGNoYWluSWQgKiAyKSArIEJpZ0ludCgzNW4gKyBzaWduYXR1cmUudiAtIDI3bik7CiAgICAgICAgY29uc3QgdjIgPSAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDI3biA/IDBuIDogMW4pOwogICAgICAgIGlmIChzaWduYXR1cmUudiAhPT0gdjIpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZExlZ2FjeVZFcnJvcih7IHY6IHNpZ25hdHVyZS52IH0pOwogICAgICAgIHJldHVybiB2MjsKICAgICAgfSkoKTsKICAgICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgICBjb25zdCBzID0gdHJpbShzaWduYXR1cmUucyk7CiAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgICAuLi5zZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdG9IZXgodiksCiAgICAgICAgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsCiAgICAgICAgcyA9PT0gIjB4MDAiID8gIjB4IiA6IHMKICAgICAgXTsKICAgIH0gZWxzZSBpZiAoY2hhaW5JZCA+IDApIHsKICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICAgIC4uLnNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0b0hleChjaGFpbklkKSwKICAgICAgICAiMHgiLAogICAgICAgICIweCIKICAgICAgXTsKICAgIH0KICAgIHJldHVybiB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiB0b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlXykgewogICAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbmF0dXJlXyA/PyB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHsgdiwgeVBhcml0eSB9ID0gc2lnbmF0dXJlOwogICAgaWYgKHR5cGVvZiBzaWduYXR1cmUuciA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlLnMgPT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gW107CiAgICBpZiAodHlwZW9mIHYgPT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiB5UGFyaXR5ID09PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIFtdOwogICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgY29uc3QgcyA9IHRyaW0oc2lnbmF0dXJlLnMpOwogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHlQYXJpdHkgPT09ICJudW1iZXIiKQogICAgICAgIHJldHVybiB5UGFyaXR5ID8gdG9IZXgoMSkgOiAiMHgiOwogICAgICBpZiAodiA9PT0gMG4pCiAgICAgICAgcmV0dXJuICIweCI7CiAgICAgIGlmICh2ID09PSAxbikKICAgICAgICByZXR1cm4gdG9IZXgoMSk7CiAgICAgIHJldHVybiB2ID09PSAyN24gPyAiMHgiIDogdG9IZXgoMSk7CiAgICB9KSgpOwogICAgcmV0dXJuIFt5UGFyaXR5XywgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsIHMgPT09ICIweDAwIiA/ICIweCIgOiBzXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdW5pdC5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdmFsdWUgfSkgewogICAgICBzdXBlcihgTnVtYmVyIFxgJHt2YWx1ZX1cYCBpcyBub3QgYSB2YWxpZCBkZWNpbWFsIG51bWJlci5gLCB7CiAgICAgICAgbmFtZTogIkludmFsaWREZWNpbWFsTnVtYmVyRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L3BhcnNlVW5pdHMuanMKICBmdW5jdGlvbiBwYXJzZVVuaXRzKHZhbHVlLCBkZWNpbWFscykgewogICAgaWYgKCEvXigtPykoWzAtOV0qKVwuPyhbMC05XSopJC8udGVzdCh2YWx1ZSkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yKHsgdmFsdWUgfSk7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uID0gIjAiXSA9IHZhbHVlLnNwbGl0KCIuIik7CiAgICBjb25zdCBuZWdhdGl2ZSA9IGludGVnZXIuc3RhcnRzV2l0aCgiLSIpOwogICAgaWYgKG5lZ2F0aXZlKQogICAgICBpbnRlZ2VyID0gaW50ZWdlci5zbGljZSgxKTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICBpZiAoZGVjaW1hbHMgPT09IDApIHsKICAgICAgaWYgKE1hdGgucm91bmQoTnVtYmVyKGAuJHtmcmFjdGlvbn1gKSkgPT09IDEpCiAgICAgICAgaW50ZWdlciA9IGAke0JpZ0ludChpbnRlZ2VyKSArIDFufWA7CiAgICAgIGZyYWN0aW9uID0gIiI7CiAgICB9IGVsc2UgaWYgKGZyYWN0aW9uLmxlbmd0aCA+IGRlY2ltYWxzKSB7CiAgICAgIGNvbnN0IFtsZWZ0LCB1bml0LCByaWdodF0gPSBbCiAgICAgICAgZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMgLSAxKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscyAtIDEsIGRlY2ltYWxzKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscykKICAgICAgXTsKICAgICAgY29uc3Qgcm91bmRlZCA9IE1hdGgucm91bmQoTnVtYmVyKGAke3VuaXR9LiR7cmlnaHR9YCkpOwogICAgICBpZiAocm91bmRlZCA+IDkpCiAgICAgICAgZnJhY3Rpb24gPSBgJHtCaWdJbnQobGVmdCkgKyBCaWdJbnQoMSl9MGAucGFkU3RhcnQobGVmdC5sZW5ndGggKyAxLCAiMCIpOwogICAgICBlbHNlCiAgICAgICAgZnJhY3Rpb24gPSBgJHtsZWZ0fSR7cm91bmRlZH1gOwogICAgICBpZiAoZnJhY3Rpb24ubGVuZ3RoID4gZGVjaW1hbHMpIHsKICAgICAgICBmcmFjdGlvbiA9IGZyYWN0aW9uLnNsaWNlKDEpOwogICAgICAgIGludGVnZXIgPSBgJHtCaWdJbnQoaW50ZWdlcikgKyAxbn1gOwogICAgICB9CiAgICAgIGZyYWN0aW9uID0gZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMpOwogICAgfSBlbHNlIHsKICAgICAgZnJhY3Rpb24gPSBmcmFjdGlvbi5wYWRFbmQoZGVjaW1hbHMsICIwIik7CiAgICB9CiAgICByZXR1cm4gQmlnSW50KGAke25lZ2F0aXZlID8gIi0iIDogIiJ9JHtpbnRlZ2VyfSR7ZnJhY3Rpb259YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUV0aGVyLmpzCiAgaW5pdF91bml0KCk7CiAgZnVuY3Rpb24gcGFyc2VFdGhlcihldGhlciwgdW5pdCA9ICJ3ZWkiKSB7CiAgICByZXR1cm4gcGFyc2VVbml0cyhldGhlciwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUd3ZWkuanMKICBpbml0X3VuaXQoKTsKICBmdW5jdGlvbiBwYXJzZUd3ZWkoZXRoZXIsIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIHBhcnNlVW5pdHMoZXRoZXIsIGd3ZWlVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbm9uY2VNYW5hZ2VyLmpzCiAgaW5pdF9scnUoKTsKICBmdW5jdGlvbiBjcmVhdGVOb25jZU1hbmFnZXIocGFyYW1ldGVycykgewogICAgY29uc3QgeyBzb3VyY2UgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkZWx0YU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgICBjb25zdCBub25jZU1hcCA9IG5ldyBMcnVNYXAoODE5Mik7CiAgICBjb25zdCBwcm9taXNlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGNvbnN0IGdldEtleSA9ICh7IGFkZHJlc3MsIGNoYWluSWQgfSkgPT4gYCR7YWRkcmVzc30uJHtjaGFpbklkfWA7CiAgICByZXR1cm4gewogICAgICBhc3luYyBjb25zdW1lKHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLmdldCh7IGFkZHJlc3MsIGNoYWluSWQsIGNsaWVudCB9KTsKICAgICAgICB0aGlzLmluY3JlbWVudCh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBwcm9taXNlOwogICAgICAgIGF3YWl0IHNvdXJjZS5zZXQoeyBhZGRyZXNzLCBjaGFpbklkIH0sIG5vbmNlKTsKICAgICAgICBub25jZU1hcC5zZXQoa2V5LCBub25jZSk7CiAgICAgICAgcmV0dXJuIG5vbmNlOwogICAgICB9LAogICAgICBhc3luYyBpbmNyZW1lbnQoeyBhZGRyZXNzLCBjaGFpbklkIH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICBkZWx0YU1hcC5zZXQoa2V5LCBkZWx0YSArIDEpOwogICAgICB9LAogICAgICBhc3luYyBnZXQoeyBhZGRyZXNzLCBjaGFpbklkLCBjbGllbnQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgbGV0IHByb21pc2UgPSBwcm9taXNlTWFwLmdldChrZXkpOwogICAgICAgIGlmICghcHJvbWlzZSkgewogICAgICAgICAgcHJvbWlzZSA9IChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBzb3VyY2UuZ2V0KHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pOwogICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzTm9uY2UgPSBub25jZU1hcC5nZXQoa2V5KSA/PyAwOwogICAgICAgICAgICAgIGlmIChwcmV2aW91c05vbmNlID4gMCAmJiBub25jZSA8PSBwcmV2aW91c05vbmNlKQogICAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzTm9uY2UgKyAxOwogICAgICAgICAgICAgIG5vbmNlTWFwLmRlbGV0ZShrZXkpOwogICAgICAgICAgICAgIHJldHVybiBub25jZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICB0aGlzLnJlc2V0KHsgYWRkcmVzcywgY2hhaW5JZCB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkoKTsKICAgICAgICAgIHByb21pc2VNYXAuc2V0KGtleSwgcHJvbWlzZSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICByZXR1cm4gZGVsdGEgKyBhd2FpdCBwcm9taXNlOwogICAgICB9LAogICAgICByZXNldCh7IGFkZHJlc3MsIGNoYWluSWQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgZGVsdGFNYXAuZGVsZXRlKGtleSk7CiAgICAgICAgcHJvbWlzZU1hcC5kZWxldGUoa2V5KTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24ganNvblJwYygpIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIGdldChwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBhZGRyZXNzLCBjbGllbnQgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGdldFRyYW5zYWN0aW9uQ291bnQoY2xpZW50LCB7CiAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9LAogICAgICBzZXQoKSB7CiAgICAgIH0KICAgIH07CiAgfQogIHZhciBub25jZU1hbmFnZXIgPSAvKiBAX19QVVJFX18gKi8gY3JlYXRlTm9uY2VNYW5hZ2VyKHsKICAgIHNvdXJjZToganNvblJwYygpCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3Byb29mLmpzCiAgZnVuY3Rpb24gZm9ybWF0U3RvcmFnZVByb29mKHN0b3JhZ2VQcm9vZikgewogICAgcmV0dXJuIHN0b3JhZ2VQcm9vZi5tYXAoKHByb29mKSA9PiAoewogICAgICAuLi5wcm9vZiwKICAgICAgdmFsdWU6IEJpZ0ludChwcm9vZi52YWx1ZSkKICAgIH0pKTsKICB9CiAgZnVuY3Rpb24gZm9ybWF0UHJvb2YocHJvb2YpIHsKICAgIHJldHVybiB7CiAgICAgIC4uLnByb29mLAogICAgICBiYWxhbmNlOiBwcm9vZi5iYWxhbmNlID8gQmlnSW50KHByb29mLmJhbGFuY2UpIDogdm9pZCAwLAogICAgICBub25jZTogcHJvb2Yubm9uY2UgPyBoZXhUb051bWJlcihwcm9vZi5ub25jZSkgOiB2b2lkIDAsCiAgICAgIHN0b3JhZ2VQcm9vZjogcHJvb2Yuc3RvcmFnZVByb29mID8gZm9ybWF0U3RvcmFnZVByb29mKHByb29mLnN0b3JhZ2VQcm9vZikgOiB2b2lkIDAKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0UHJvb2YuanMKICBhc3luYyBmdW5jdGlvbiBnZXRQcm9vZihjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIHN0b3JhZ2VLZXlzIH0pIHsKICAgIGNvbnN0IGJsb2NrVGFnID0gYmxvY2tUYWdfID8/ICJsYXRlc3QiOwogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgcHJvb2YgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRQcm9vZiIsCiAgICAgIHBhcmFtczogW2FkZHJlc3MsIHN0b3JhZ2VLZXlzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIGZvcm1hdFByb29mKHByb29mKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0Iiwgc2xvdCB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2V0U3RvcmFnZUF0IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgc2xvdCwgYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWddCiAgICB9KTsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbihjbGllbnQsIHsgYmxvY2tIYXNoLCBibG9ja051bWJlciwgYmxvY2tUYWc6IGJsb2NrVGFnXywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gfHwgImxhdGVzdCI7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgdHJhbnNhY3Rpb24gPSBudWxsOwogICAgaWYgKGhhc2gzKSB7CiAgICAgIHRyYW5zYWN0aW9uID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkJ5SGFzaCIsCiAgICAgICAgcGFyYW1zOiBbaGFzaDNdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIGlmIChibG9ja0hhc2gpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja0hhc2hBbmRJbmRleCIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tIYXNoLCBudW1iZXJUb0hleChpbmRleDIpXQogICAgICB9LCB7IGRlZHVwZTogdHJ1ZSB9KTsKICAgIH0gZWxzZSBpZiAoYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja051bWJlckFuZEluZGV4IiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZywgbnVtYmVyVG9IZXgoaW5kZXgyKV0KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgaWYgKCF0cmFuc2FjdGlvbikKICAgICAgdGhyb3cgbmV3IFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvcih7CiAgICAgICAgYmxvY2tIYXNoLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnLAogICAgICAgIGhhc2g6IGhhc2gzLAogICAgICAgIGluZGV4OiBpbmRleDIKICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uPy5mb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb247CiAgICByZXR1cm4gZm9ybWF0KHRyYW5zYWN0aW9uKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMoY2xpZW50LCB7IGhhc2g6IGhhc2gzLCB0cmFuc2FjdGlvblJlY2VpcHQgfSkgewogICAgY29uc3QgW2Jsb2NrTnVtYmVyLCB0cmFuc2FjdGlvbl0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSksCiAgICAgIGhhc2gzID8gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb24sICJnZXRUcmFuc2FjdGlvbiIpKHsgaGFzaDogaGFzaDMgfSkgOiB2b2lkIDAKICAgIF0pOwogICAgY29uc3QgdHJhbnNhY3Rpb25CbG9ja051bWJlciA9IHRyYW5zYWN0aW9uUmVjZWlwdD8uYmxvY2tOdW1iZXIgfHwgdHJhbnNhY3Rpb24/LmJsb2NrTnVtYmVyOwogICAgaWYgKCF0cmFuc2FjdGlvbkJsb2NrTnVtYmVyKQogICAgICByZXR1cm4gMG47CiAgICByZXR1cm4gYmxvY2tOdW1iZXIgLSB0cmFuc2FjdGlvbkJsb2NrTnVtYmVyICsgMW47CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIHsgaGFzaDogaGFzaDMgfSkgewogICAgY29uc3QgcmVjZWlwdCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCIsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICBpZiAoIXJlY2VpcHQpCiAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yKHsgaGFzaDogaGFzaDMgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVjZWlwdD8uZm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDsKICAgIHJldHVybiBmb3JtYXQocmVjZWlwdCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvbXVsdGljYWxsLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIG11bHRpY2FsbChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWxsb3dGYWlsdXJlID0gdHJ1ZSwgYmF0Y2hTaXplOiBiYXRjaFNpemVfLCBibG9ja051bWJlciwgYmxvY2tUYWcsIG11bHRpY2FsbEFkZHJlc3M6IG11bHRpY2FsbEFkZHJlc3NfLCBzdGF0ZU92ZXJyaWRlIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY29udHJhY3RzMiA9IHBhcmFtZXRlcnMuY29udHJhY3RzOwogICAgY29uc3QgYmF0Y2hTaXplID0gYmF0Y2hTaXplXyA/PyAodHlwZW9mIGNsaWVudC5iYXRjaD8ubXVsdGljYWxsID09PSAib2JqZWN0IiAmJiBjbGllbnQuYmF0Y2gubXVsdGljYWxsLmJhdGNoU2l6ZSB8fCAxMDI0KTsKICAgIGxldCBtdWx0aWNhbGxBZGRyZXNzID0gbXVsdGljYWxsQWRkcmVzc187CiAgICBpZiAoIW11bHRpY2FsbEFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIG11bHRpY2FsbEFkZHJlc3MgaXMgcmVxdWlyZWQuIik7CiAgICAgIG11bHRpY2FsbEFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogIm11bHRpY2FsbDMiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgY2h1bmtlZENhbGxzID0gW1tdXTsKICAgIGxldCBjdXJyZW50Q2h1bmsgPSAwOwogICAgbGV0IGN1cnJlbnRDaHVua1NpemUgPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250cmFjdHMyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUgfSA9IGNvbnRyYWN0czJbaV07CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgY2FsbERhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgICAgICBjdXJyZW50Q2h1bmtTaXplICs9IChjYWxsRGF0YS5sZW5ndGggLSAyKSAvIDI7CiAgICAgICAgaWYgKAogICAgICAgICAgLy8gQ2hlY2sgaWYgYmF0Y2hpbmcgaXMgZW5hYmxlZC4KICAgICAgICAgIGJhdGNoU2l6ZSA+IDAgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgc2l6ZSBvZiB0aGUgYmF0Y2ggZXhjZWVkcyB0aGUgc2l6ZSBsaW1pdC4KICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPiBiYXRjaFNpemUgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY2h1bmsgaXMgbm90IGFscmVhZHkgZW1wdHkuCiAgICAgICAgICBjaHVua2VkQ2FsbHNbY3VycmVudENodW5rXS5sZW5ndGggPiAwCiAgICAgICAgKSB7CiAgICAgICAgICBjdXJyZW50Q2h1bmsrKzsKICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPSAoY2FsbERhdGEubGVuZ3RoIC0gMikgLyAyOwogICAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbXTsKICAgICAgICB9CiAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbCiAgICAgICAgICAuLi5jaHVua2VkQ2FsbHNbY3VycmVudENodW5rXSwKICAgICAgICAgIHsKICAgICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgICBjYWxsRGF0YSwKICAgICAgICAgICAgdGFyZ2V0OiBhZGRyZXNzCiAgICAgICAgICB9CiAgICAgICAgXTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L211bHRpY2FsbCIsCiAgICAgICAgICBmdW5jdGlvbk5hbWUKICAgICAgICB9KTsKICAgICAgICBpZiAoIWFsbG93RmFpbHVyZSkKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIGNodW5rZWRDYWxsc1tjdXJyZW50Q2h1bmtdID0gWwogICAgICAgICAgLi4uY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10sCiAgICAgICAgICB7CiAgICAgICAgICAgIGFsbG93RmFpbHVyZTogdHJ1ZSwKICAgICAgICAgICAgY2FsbERhdGE6ICIweCIsCiAgICAgICAgICAgIHRhcmdldDogYWRkcmVzcwogICAgICAgICAgfQogICAgICAgIF07CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGFnZ3JlZ2F0ZTNSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGNodW5rZWRDYWxscy5tYXAoKGNhbGxzKSA9PiBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgIGFiaTogbXVsdGljYWxsM0FiaSwKICAgICAgYWRkcmVzczogbXVsdGljYWxsQWRkcmVzcywKICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnLAogICAgICBmdW5jdGlvbk5hbWU6ICJhZ2dyZWdhdGUzIiwKICAgICAgc3RhdGVPdmVycmlkZQogICAgfSkpKTsKICAgIGNvbnN0IHJlc3VsdHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWdncmVnYXRlM1Jlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcmVzdWx0ID0gYWdncmVnYXRlM1Jlc3VsdHNbaV07CiAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAicmVqZWN0ZWQiKSB7CiAgICAgICAgaWYgKCFhbGxvd0ZhaWx1cmUpCiAgICAgICAgICB0aHJvdyByZXN1bHQucmVhc29uOwogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY2h1bmtlZENhbGxzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2goewogICAgICAgICAgICBzdGF0dXM6ICJmYWlsdXJlIiwKICAgICAgICAgICAgZXJyb3I6IHJlc3VsdC5yZWFzb24sCiAgICAgICAgICAgIHJlc3VsdDogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3QgYWdncmVnYXRlM1Jlc3VsdCA9IHJlc3VsdC52YWx1ZTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhZ2dyZWdhdGUzUmVzdWx0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgY29uc3QgeyByZXR1cm5EYXRhLCBzdWNjZXNzIH0gPSBhZ2dyZWdhdGUzUmVzdWx0W2pdOwogICAgICAgIGNvbnN0IHsgY2FsbERhdGEgfSA9IGNodW5rZWRDYWxsc1tpXVtqXTsKICAgICAgICBjb25zdCB7IGFiaTogYWJpMiwgYWRkcmVzcywgZnVuY3Rpb25OYW1lLCBhcmdzIH0gPSBjb250cmFjdHMyW3Jlc3VsdHMubGVuZ3RoXTsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGNhbGxEYXRhID09PSAiMHgiKQogICAgICAgICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICAgICAgICBpZiAoIXN1Y2Nlc3MpCiAgICAgICAgICAgIHRocm93IG5ldyBSYXdDb250cmFjdEVycm9yKHsgZGF0YTogcmV0dXJuRGF0YSB9KTsKICAgICAgICAgIGNvbnN0IHJlc3VsdDIgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgZGF0YTogcmV0dXJuRGF0YSwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHJlc3VsdHMucHVzaChhbGxvd0ZhaWx1cmUgPyB7IHJlc3VsdDogcmVzdWx0Miwgc3RhdHVzOiAic3VjY2VzcyIgfSA6IHJlc3VsdDIpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvbXVsdGljYWxsIiwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICghYWxsb3dGYWlsdXJlKQogICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgIHJlc3VsdHMucHVzaCh7IGVycm9yLCByZXN1bHQ6IHZvaWQgMCwgc3RhdHVzOiAiZmFpbHVyZSIgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IGNvbnRyYWN0czIubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigibXVsdGljYWxsIHJlc3VsdHMgbWlzbWF0Y2giKTsKICAgIHJldHVybiByZXN1bHRzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3ZlcmlmeUhhc2guanMKICBpbml0X2FiaXMoKTsKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfY29udHJhY3QoKTsKICBpbml0X2VuY29kZURlcGxveURhdGEoKTsKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25hdHVyZSh7IHIsIHMsIHRvID0gImhleCIsIHYsIHlQYXJpdHkgfSkgewogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAoeVBhcml0eSA9PT0gMCB8fCB5UGFyaXR5ID09PSAxKQogICAgICAgIHJldHVybiB5UGFyaXR5OwogICAgICBpZiAodiAmJiAodiA9PT0gMjduIHx8IHYgPT09IDI4biB8fCB2ID49IDM1bikpCiAgICAgICAgcmV0dXJuIHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGB2YCBvciBgeVBhcml0eWAgdmFsdWUiKTsKICAgIH0pKCk7CiAgICBjb25zdCBzaWduYXR1cmUgPSBgMHgke25ldyBzZWNwMjU2azEuU2lnbmF0dXJlKGhleFRvQmlnSW50KHIpLCBoZXhUb0JpZ0ludChzKSkudG9Db21wYWN0SGV4KCl9JHt5UGFyaXR5XyA9PT0gMCA/ICIxYiIgOiAiMWMifWA7CiAgICBpZiAodG8gPT09ICJoZXgiKQogICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoc2lnbmF0dXJlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlIYXNoLmpzCiAgaW5pdF9jYWxsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5SGFzaDIoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBoYXNoOiBoYXNoMywgc2lnbmF0dXJlLCB1bml2ZXJzYWxTaWduYXR1cmVWZXJpZmllckFkZHJlc3MgPSBjbGllbnQuY2hhaW4/LmNvbnRyYWN0cz8udW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI/LmFkZHJlc3MsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmVIZXggPSAoKCkgPT4gewogICAgICBpZiAoaXNIZXgoc2lnbmF0dXJlKSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gIm9iamVjdCIgJiYgInIiIGluIHNpZ25hdHVyZSAmJiAicyIgaW4gc2lnbmF0dXJlKQogICAgICAgIHJldHVybiBzZXJpYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoc2lnbmF0dXJlKTsKICAgIH0pKCk7CiAgICBjb25zdCB3cmFwcGVkU2lnbmF0dXJlID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFmYWN0b3J5ICYmICFmYWN0b3J5RGF0YSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlSGV4OwogICAgICBpZiAoaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZUhleCkpCiAgICAgICAgcmV0dXJuIHNpZ25hdHVyZUhleDsKICAgICAgcmV0dXJuIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUoewogICAgICAgIGFkZHJlc3M6IGZhY3RvcnksCiAgICAgICAgZGF0YTogZmFjdG9yeURhdGEsCiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVIZXgKICAgICAgfSk7CiAgICB9KSgpOwogICAgdHJ5IHsKICAgICAgY29uc3QgYXJncyA9IHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyQWRkcmVzcyA/IHsKICAgICAgICB0bzogdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXJBZGRyZXNzLAogICAgICAgIGRhdGE6IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImlzVmFsaWRTaWciLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA6IHsKICAgICAgICBkYXRhOiBlbmNvZGVEZXBsb3lEYXRhKHsKICAgICAgICAgIGFiaTogdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXSwKICAgICAgICAgIGJ5dGVjb2RlOiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfTsKICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjYWxsLCAiY2FsbCIpKGFyZ3MpOwogICAgICByZXR1cm4gaGV4VG9Cb29sKGRhdGEgPz8gIjB4MCIpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB2ZXJpZmllZCA9IGlzQWRkcmVzc0VxdWFsKGdldEFkZHJlc3MoYWRkcmVzcyksIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgICAgICAgaWYgKHZlcmlmaWVkKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIENhbGxFeGVjdXRpb25FcnJvcikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCB7IGFkZHJlc3MsIG1lc3NhZ2UsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBzaWduYXR1cmUsIC4uLmNhbGxSZXF1ZXN0IH0pIHsKICAgIGNvbnN0IGhhc2gzID0gaGFzaE1lc3NhZ2UobWVzc2FnZSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvdmVyaWZ5VHlwZWREYXRhLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhMihjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHNpZ25hdHVyZSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4sIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaGFzaDMgPSBoYXNoVHlwZWREYXRhKHsgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4gfSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdC5qcwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X3dpdGhSZXNvbHZlcnMoKTsKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja051bWJlci5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gd2F0Y2hCbG9ja051bWJlcihjbGllbnQsIHsgZW1pdE9uQmVnaW4gPSBmYWxzZSwgZW1pdE1pc3NlZCA9IGZhbHNlLCBvbkJsb2NrTnVtYmVyLCBvbkVycm9yLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGxldCBwcmV2QmxvY2tOdW1iZXI7CiAgICBjb25zdCBwb2xsQmxvY2tOdW1iZXIgPSAoKSA9PiB7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaEJsb2NrTnVtYmVyIiwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGVtaXRPbkJlZ2luLAogICAgICAgIGVtaXRNaXNzZWQsCiAgICAgICAgcG9sbGluZ0ludGVydmFsCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uQmxvY2tOdW1iZXIsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7IGNhY2hlVGltZTogMCB9KTsKICAgICAgICAgIGlmIChwcmV2QmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgaWYgKGJsb2NrTnVtYmVyID09PSBwcmV2QmxvY2tOdW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2tOdW1iZXIgLSBwcmV2QmxvY2tOdW1iZXIgPiAxICYmIGVtaXRNaXNzZWQpIHsKICAgICAgICAgICAgICBmb3IgKGxldCBpID0gcHJldkJsb2NrTnVtYmVyICsgMW47IGkgPCBibG9ja051bWJlcjsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoaSwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXByZXZCbG9ja051bWJlciB8fCBibG9ja051bWJlciA+IHByZXZCbG9ja051bWJlcikgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoYmxvY2tOdW1iZXIsIHByZXZCbG9ja051bWJlcik7CiAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja051bWJlciA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQmxvY2tOdW1iZXIiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZW1pdE9uQmVnaW4sCiAgICAgICAgZW1pdE1pc3NlZAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrTnVtYmVyLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIikgewogICAgICAgICAgICAgICAgY29uc3QgdHJhbnNwb3J0MiA9IGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0cy5maW5kKCh0cmFuc3BvcnQzKSA9PiB0cmFuc3BvcnQzLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0Iik7CiAgICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zcG9ydDIudmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJuZXdIZWFkcyJdLAogICAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBoZXhUb0JpZ0ludChkYXRhLnJlc3VsdD8ubnVtYmVyKTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9ja051bWJlcihibG9ja051bWJlciwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmVfOwogICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBlbmFibGVQb2xsaW5nID8gcG9sbEJsb2NrTnVtYmVyKCkgOiBzdWJzY3JpYmVCbG9ja051bWJlcigpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHQuanMKICBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0KGNsaWVudCwgewogICAgY29uZmlybWF0aW9ucyA9IDEsCiAgICBoYXNoOiBoYXNoMywKICAgIG9uUmVwbGFjZWQsCiAgICBwb2xsaW5nSW50ZXJ2YWwgPSBjbGllbnQucG9sbGluZ0ludGVydmFsLAogICAgcmV0cnlDb3VudCA9IDYsCiAgICByZXRyeURlbGF5ID0gKHsgY291bnQgfSkgPT4gfn4oMSA8PCBjb3VudCkgKiAyMDAsCiAgICAvLyBleHBvbmVudGlhbCBiYWNrb2ZmCiAgICB0aW1lb3V0ID0gMThlNAogIH0pIHsKICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWyJ3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0IiwgY2xpZW50LnVpZCwgaGFzaDNdKTsKICAgIGxldCB0cmFuc2FjdGlvbjsKICAgIGxldCByZXBsYWNlZFRyYW5zYWN0aW9uOwogICAgbGV0IHJlY2VpcHQ7CiAgICBsZXQgcmV0cnlpbmcgPSBmYWxzZTsKICAgIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0IH0gPSB3aXRoUmVzb2x2ZXJzKCk7CiAgICBjb25zdCB0aW1lciA9IHRpbWVvdXQgPyBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvcih7IGhhc2g6IGhhc2gzIH0pKSwgdGltZW91dCkgOiB2b2lkIDA7CiAgICBjb25zdCBfdW5vYnNlcnZlID0gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uUmVwbGFjZWQsIHJlc29sdmUsIHJlamVjdCB9LCAoZW1pdCkgPT4gewogICAgICBjb25zdCBfdW53YXRjaCA9IGdldEFjdGlvbihjbGllbnQsIHdhdGNoQmxvY2tOdW1iZXIsICJ3YXRjaEJsb2NrTnVtYmVyIikoewogICAgICAgIGVtaXRNaXNzZWQ6IHRydWUsCiAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgcG9sbDogdHJ1ZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgYXN5bmMgb25CbG9ja051bWJlcihibG9ja051bWJlcl8pIHsKICAgICAgICAgIGNvbnN0IGRvbmUgPSAoZm4pID0+IHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgICAgICAgICAgX3Vud2F0Y2goKTsKICAgICAgICAgICAgZm4oKTsKICAgICAgICAgICAgX3Vub2JzZXJ2ZSgpOwogICAgICAgICAgfTsKICAgICAgICAgIGxldCBibG9ja051bWJlciA9IGJsb2NrTnVtYmVyXzsKICAgICAgICAgIGlmIChyZXRyeWluZykKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlY2VpcHQpIHsKICAgICAgICAgICAgICBpZiAoY29uZmlybWF0aW9ucyA+IDEgJiYgKCFyZWNlaXB0LmJsb2NrTnVtYmVyIHx8IGJsb2NrTnVtYmVyIC0gcmVjZWlwdC5ibG9ja051bWJlciArIDFuIDwgY29uZmlybWF0aW9ucykpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgZG9uZSgoKSA9PiBlbWl0LnJlc29sdmUocmVjZWlwdCkpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgIGF3YWl0IHdpdGhSZXRyeShhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uLCAiZ2V0VHJhbnNhY3Rpb24iKSh7IGhhc2g6IGhhc2gzIH0pOwogICAgICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyKQogICAgICAgICAgICAgICAgICBibG9ja051bWJlciA9IHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgcmV0cnlDb3VudAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHJ5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVjZWlwdCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uUmVjZWlwdCwgImdldFRyYW5zYWN0aW9uUmVjZWlwdCIpKHsgaGFzaDogaGFzaDMgfSk7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zID4gMSAmJiAoIXJlY2VpcHQuYmxvY2tOdW1iZXIgfHwgYmxvY2tOdW1iZXIgLSByZWNlaXB0LmJsb2NrTnVtYmVyICsgMW4gPCBjb25maXJtYXRpb25zKSkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZXNvbHZlKHJlY2VpcHQpKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIHx8IGVyciBpbnN0YW5jZW9mIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IpIHsKICAgICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgICByZXRyeWluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCB3aXRoUmV0cnkoKCkgPT4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHsKICAgICAgICAgICAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVUcmFuc2FjdGlvbnM6IHRydWUKICAgICAgICAgICAgICAgIH0pLCB7CiAgICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgICByZXRyeUNvdW50LAogICAgICAgICAgICAgICAgICBzaG91bGRSZXRyeTogKHsgZXJyb3IgfSkgPT4gZXJyb3IgaW5zdGFuY2VvZiBCbG9ja05vdEZvdW5kRXJyb3IKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50VHJhbnNhY3Rpb24gPSBibG9jay50cmFuc2FjdGlvbnMuZmluZCgoeyBmcm9tLCBub25jZSB9KSA9PiBmcm9tID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLmZyb20gJiYgbm9uY2UgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24ubm9uY2UpOwogICAgICAgICAgICAgICAgaWYgKCFyZXBsYWNlbWVudFRyYW5zYWN0aW9uKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICByZWNlaXB0ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LCAiZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IikoewogICAgICAgICAgICAgICAgICBoYXNoOiByZXBsYWNlbWVudFRyYW5zYWN0aW9uLmhhc2gKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnMgPiAxICYmICghcmVjZWlwdC5ibG9ja051bWJlciB8fCBibG9ja051bWJlciAtIHJlY2VpcHQuYmxvY2tOdW1iZXIgKyAxbiA8IGNvbmZpcm1hdGlvbnMpKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgcmVhc29uID0gInJlcGxhY2VkIjsKICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24udmFsdWUpIHsKICAgICAgICAgICAgICAgICAgcmVhc29uID0gInJlcHJpY2VkIjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVwbGFjZW1lbnRUcmFuc2FjdGlvbi5mcm9tID09PSByZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IDBuKSB7CiAgICAgICAgICAgICAgICAgIHJlYXNvbiA9ICJjYW5jZWxsZWQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9uZSgoKSA9PiB7CiAgICAgICAgICAgICAgICAgIGVtaXQub25SZXBsYWNlZD8uKHsKICAgICAgICAgICAgICAgICAgICByZWFzb24sCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbjogcmVwbGFjZW1lbnRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IHJlY2VpcHQKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGVtaXQucmVzb2x2ZShyZWNlaXB0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycl8pIHsKICAgICAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZWplY3QoZXJyXykpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBkb25lKCgpID0+IGVtaXQucmVqZWN0KGVycikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIHByb21pc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja3MuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoQmxvY2tzKGNsaWVudCwgeyBibG9ja1RhZyA9ICJsYXRlc3QiLCBlbWl0TWlzc2VkID0gZmFsc2UsIGVtaXRPbkJlZ2luID0gZmFsc2UsIG9uQmxvY2ssIG9uRXJyb3IsIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGNvbnN0IGluY2x1ZGVUcmFuc2FjdGlvbnMgPSBpbmNsdWRlVHJhbnNhY3Rpb25zXyA/PyBmYWxzZTsKICAgIGxldCBwcmV2QmxvY2s7CiAgICBjb25zdCBwb2xsQmxvY2tzID0gKCkgPT4gewogICAgICBjb25zdCBvYnNlcnZlcklkID0gc3RyaW5naWZ5KFsKICAgICAgICAid2F0Y2hCbG9ja3MiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgZW1pdE1pc3NlZCwKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrLCBvbkVycm9yIH0sIChlbWl0KSA9PiBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoewogICAgICAgICAgICBibG9ja1RhZywKICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYmxvY2subnVtYmVyICYmIHByZXZCbG9jaz8ubnVtYmVyKSB7CiAgICAgICAgICAgIGlmIChibG9jay5udW1iZXIgPT09IHByZXZCbG9jay5udW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2subnVtYmVyIC0gcHJldkJsb2NrLm51bWJlciA+IDEgJiYgZW1pdE1pc3NlZCkgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSBwcmV2QmxvY2s/Lm51bWJlciArIDFuOyBpIDwgYmxvY2subnVtYmVyOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrMiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgICAgIGJsb2NrTnVtYmVyOiBpLAogICAgICAgICAgICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9jayhibG9jazIsIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIC8vIElmIG5vIHByZXZpb3VzIGJsb2NrIGV4aXN0cywgZW1pdC4KICAgICAgICAgICAgIXByZXZCbG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBibG9jayB0YWcgaXMgInBlbmRpbmciIHdpdGggbm8gYmxvY2sgbnVtYmVyLCBlbWl0LgogICAgICAgICAgICBibG9ja1RhZyA9PT0gInBlbmRpbmciICYmICFibG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBuZXh0IGJsb2NrIG51bWJlciBpcyBncmVhdGVyIHRoYW4gdGhlIHByZXZpb3VzIGJsb2NrIG51bWJlciwgZW1pdC4KICAgICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byBlbWl0IGJsb2NrcyBpbiB0aGUgcGFzdC4KICAgICAgICAgICAgYmxvY2subnVtYmVyICYmIGJsb2NrLm51bWJlciA+IHByZXZCbG9jay5udW1iZXIKICAgICAgICAgICkgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgIHByZXZCbG9jayA9IGJsb2NrOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja3MgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgZW1pdEZldGNoZWQgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGVtaXRPbkJlZ2luKSB7CiAgICAgICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgICB9KS50aGVuKChibG9jaykgPT4gewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGlmICghZW1pdEZldGNoZWQpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgb25CbG9jayhibG9jaywgdm9pZCAwKTsKICAgICAgICAgICAgICBlbWl0RmV0Y2hlZCA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibmV3SGVhZHMiXSwKICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LmJsb2NrPy5mb3JtYXQgfHwgZm9ybWF0QmxvY2s7CiAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBmb3JtYXQoZGF0YS5yZXN1bHQpOwogICAgICAgICAgICAgIG9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgZW1pdEZldGNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQmxvY2tzKCkgOiBzdWJzY3JpYmVCbG9ja3MoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaEV2ZW50LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBpbml0X2FiaSgpOwogIGluaXRfcnBjKCk7CiAgZnVuY3Rpb24gd2F0Y2hFdmVudChjbGllbnQsIHsgYWRkcmVzcywgYXJncywgYmF0Y2ggPSB0cnVlLCBldmVudCwgZXZlbnRzLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAodHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIiAmJiBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHNbMF0uY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KSgpOwogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IHBvbGxFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoRXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50LAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBmcm9tQmxvY2sKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IHByZXZpb3VzQmxvY2tOdW1iZXI7CiAgICAgICAgaWYgKGZyb21CbG9jayAhPT0gdm9pZCAwKQogICAgICAgICAgcHJldmlvdXNCbG9ja051bWJlciA9IGZyb21CbG9jayAtIDFuOwogICAgICAgIGxldCBmaWx0ZXI7CiAgICAgICAgbGV0IGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgY29uc3QgdW53YXRjaCA9IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgICAgaWYgKCFpbml0aWFsaXplZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZUV2ZW50RmlsdGVyLCAiY3JlYXRlRXZlbnRGaWx0ZXIiKSh7CiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIGV2ZW50LAogICAgICAgICAgICAgICAgZXZlbnRzLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciAhPT0gYmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgICAgIGxvZ3MgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRMb2dzLCAiZ2V0TG9ncyIpKHsKICAgICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgICAgZXZlbnQsCiAgICAgICAgICAgICAgICAgIGV2ZW50cywKICAgICAgICAgICAgICAgICAgZnJvbUJsb2NrOiBwcmV2aW91c0Jsb2NrTnVtYmVyICsgMW4sCiAgICAgICAgICAgICAgICAgIHRvQmxvY2s6IGJsb2NrTnVtYmVyCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUV2ZW50ID0gKCkgPT4gewogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBldmVudHNfID0gZXZlbnRzID8/IChldmVudCA/IFtldmVudF0gOiB2b2lkIDApOwogICAgICAgICAgbGV0IHRvcGljcyA9IFtdOwogICAgICAgICAgaWYgKGV2ZW50c18pIHsKICAgICAgICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50c18uZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgICAgICAgIGFyZ3MKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB0b3BpY3MgPSBbZW5jb2RlZF07CiAgICAgICAgICAgIGlmIChldmVudCkKICAgICAgICAgICAgICB0b3BpY3MgPSB0b3BpY3NbMF07CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibG9ncyIsIHsgYWRkcmVzcywgdG9waWNzIH1dLAogICAgICAgICAgICBvbkRhdGEoZGF0YSkgewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGNvbnN0IGxvZyA9IGRhdGEucmVzdWx0OwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCB7IGV2ZW50TmFtZSwgYXJnczogYXJnczIgfSA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgICAgICAgICAgYWJpOiBldmVudHNfID8/IFtdLAogICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgdG9waWNzOiBsb2cudG9waWNzLAogICAgICAgICAgICAgICAgICBzdHJpY3QKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgeyBhcmdzOiBhcmdzMiwgZXZlbnROYW1lIH0pOwogICAgICAgICAgICAgICAgb25Mb2dzKFtmb3JtYXR0ZWRdKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGxldCBldmVudE5hbWU7CiAgICAgICAgICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ0RhdGFNaXNtYXRjaCB8fCBlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCkgewogICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSA9IGVyci5hYmlJdGVtLm5hbWU7CiAgICAgICAgICAgICAgICAgIGlzVW5uYW1lZCA9IGVyci5hYmlJdGVtLmlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdExvZyhsb2csIHsKICAgICAgICAgICAgICAgICAgYXJnczogaXNVbm5hbWVkID8gW10gOiB7fSwKICAgICAgICAgICAgICAgICAgZXZlbnROYW1lCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB1bnN1YnNjcmliZSA9IHVuc3Vic2NyaWJlXzsKICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICByZXR1cm4gZW5hYmxlUG9sbGluZyA/IHBvbGxFdmVudCgpIDogc3Vic2NyaWJlRXZlbnQoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyhjbGllbnQsIHsgYmF0Y2ggPSB0cnVlLCBvbkVycm9yLCBvblRyYW5zYWN0aW9ucywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwgfSkgewogICAgY29uc3QgZW5hYmxlUG9sbGluZyA9IHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIgPyBwb2xsXyA6IGNsaWVudC50cmFuc3BvcnQudHlwZSAhPT0gIndlYlNvY2tldCI7CiAgICBjb25zdCBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucyA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyIsCiAgICAgICAgY2xpZW50LnVpZCwKICAgICAgICBiYXRjaCwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25UcmFuc2FjdGlvbnMsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghZmlsdGVyKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciwgImNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIpKHt9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHVud2F0Y2goKTsKICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgaGFzaGVzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgaWYgKGhhc2hlcy5sZW5ndGggPT09IDApCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmF0Y2gpCiAgICAgICAgICAgICAgZW1pdC5vblRyYW5zYWN0aW9ucyhoYXNoZXMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBoYXNoMyBvZiBoYXNoZXMpCiAgICAgICAgICAgICAgICBlbWl0Lm9uVHJhbnNhY3Rpb25zKFtoYXNoM10pOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZVBlbmRpbmdUcmFuc2FjdGlvbnMgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgeyB1bnN1YnNjcmliZTogdW5zdWJzY3JpYmVfIH0gPSBhd2FpdCBjbGllbnQudHJhbnNwb3J0LnN1YnNjcmliZSh7CiAgICAgICAgICAgIHBhcmFtczogWyJuZXdQZW5kaW5nVHJhbnNhY3Rpb25zIl0sCiAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgaWYgKCFhY3RpdmUpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICBvblRyYW5zYWN0aW9ucyhbdHJhbnNhY3Rpb25dKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucygpIDogc3Vic2NyaWJlUGVuZGluZ1RyYW5zYWN0aW9ucygpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Npd2UvcGFyc2VTaXdlTWVzc2FnZS5qcwogIGZ1bmN0aW9uIHBhcnNlU2l3ZU1lc3NhZ2UobWVzc2FnZSkgewogICAgY29uc3QgeyBzY2hlbWUsIHN0YXRlbWVudCwgLi4ucHJlZml4IH0gPSBtZXNzYWdlLm1hdGNoKHByZWZpeFJlZ2V4KT8uZ3JvdXBzID8/IHt9OwogICAgY29uc3QgeyBjaGFpbklkLCBleHBpcmF0aW9uVGltZSwgaXNzdWVkQXQsIG5vdEJlZm9yZSwgcmVxdWVzdElkLCAuLi5zdWZmaXggfSA9IG1lc3NhZ2UubWF0Y2goc3VmZml4UmVnZXgpPy5ncm91cHMgPz8ge307CiAgICBjb25zdCByZXNvdXJjZXMgPSBtZXNzYWdlLnNwbGl0KCJSZXNvdXJjZXM6IilbMV0/LnNwbGl0KCJcbi0gIikuc2xpY2UoMSk7CiAgICByZXR1cm4gewogICAgICAuLi5wcmVmaXgsCiAgICAgIC4uLnN1ZmZpeCwKICAgICAgLi4uY2hhaW5JZCA/IHsgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpIH0gOiB7fSwKICAgICAgLi4uZXhwaXJhdGlvblRpbWUgPyB7IGV4cGlyYXRpb25UaW1lOiBuZXcgRGF0ZShleHBpcmF0aW9uVGltZSkgfSA6IHt9LAogICAgICAuLi5pc3N1ZWRBdCA/IHsgaXNzdWVkQXQ6IG5ldyBEYXRlKGlzc3VlZEF0KSB9IDoge30sCiAgICAgIC4uLm5vdEJlZm9yZSA/IHsgbm90QmVmb3JlOiBuZXcgRGF0ZShub3RCZWZvcmUpIH0gOiB7fSwKICAgICAgLi4ucmVxdWVzdElkID8geyByZXF1ZXN0SWQgfSA6IHt9LAogICAgICAuLi5yZXNvdXJjZXMgPyB7IHJlc291cmNlcyB9IDoge30sCiAgICAgIC4uLnNjaGVtZSA/IHsgc2NoZW1lIH0gOiB7fSwKICAgICAgLi4uc3RhdGVtZW50ID8geyBzdGF0ZW1lbnQgfSA6IHt9CiAgICB9OwogIH0KICB2YXIgcHJlZml4UmVnZXggPSAvXig/Oig/PHNjaGVtZT5bYS16QS1aXVthLXpBLVowLTkrLS5dKik6XC9cLyk/KD88ZG9tYWluPlthLXpBLVowLTkrLS5dKig/OjpbMC05XXsxLDV9KT8pICg/OndhbnRzIHlvdSB0byBzaWduIGluIHdpdGggeW91ciBFdGhlcmV1bSBhY2NvdW50OlxuKSg/PGFkZHJlc3M+MHhbYS1mQS1GMC05XXs0MH0pXG5cbig/Oig/PHN0YXRlbWVudD4uKilcblxuKT8vOwogIHZhciBzdWZmaXhSZWdleCA9IC8oPzpVUkk6ICg/PHVyaT4uKykpXG4oPzpWZXJzaW9uOiAoPzx2ZXJzaW9uPi4rKSlcbig/OkNoYWluIElEOiAoPzxjaGFpbklkPlxkKykpXG4oPzpOb25jZTogKD88bm9uY2U+W2EtekEtWjAtOV0rKSlcbig/Oklzc3VlZCBBdDogKD88aXNzdWVkQXQ+LispKSg/OlxuRXhwaXJhdGlvbiBUaW1lOiAoPzxleHBpcmF0aW9uVGltZT4uKykpPyg/OlxuTm90IEJlZm9yZTogKD88bm90QmVmb3JlPi4rKSk/KD86XG5SZXF1ZXN0IElEOiAoPzxyZXF1ZXN0SWQ+LispKT8vOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2l3ZS92YWxpZGF0ZVNpd2VNZXNzYWdlLmpzCiAgaW5pdF9pc0FkZHJlc3NFcXVhbCgpOwogIGZ1bmN0aW9uIHZhbGlkYXRlU2l3ZU1lc3NhZ2UocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBkb21haW4sIG1lc3NhZ2UsIG5vbmNlLCBzY2hlbWUsIHRpbWUgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSB9ID0gcGFyYW1ldGVyczsKICAgIGlmIChkb21haW4gJiYgbWVzc2FnZS5kb21haW4gIT09IGRvbWFpbikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG5vbmNlICYmIG1lc3NhZ2Uubm9uY2UgIT09IG5vbmNlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoc2NoZW1lICYmIG1lc3NhZ2Uuc2NoZW1lICE9PSBzY2hlbWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChtZXNzYWdlLmV4cGlyYXRpb25UaW1lICYmIHRpbWUgPj0gbWVzc2FnZS5leHBpcmF0aW9uVGltZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG1lc3NhZ2Uubm90QmVmb3JlICYmIHRpbWUgPCBtZXNzYWdlLm5vdEJlZm9yZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgdHJ5IHsKICAgICAgaWYgKCFtZXNzYWdlLmFkZHJlc3MpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcyAmJiAhaXNBZGRyZXNzRXF1YWwobWVzc2FnZS5hZGRyZXNzLCBhZGRyZXNzKSkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9zaXdlL3ZlcmlmeVNpd2VNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5U2l3ZU1lc3NhZ2UoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGRvbWFpbiwgbWVzc2FnZSwgbm9uY2UsIHNjaGVtZSwgc2lnbmF0dXJlLCB0aW1lID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgcGFyc2VkID0gcGFyc2VTaXdlTWVzc2FnZShtZXNzYWdlKTsKICAgIGlmICghcGFyc2VkLmFkZHJlc3MpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZVNpd2VNZXNzYWdlKHsKICAgICAgYWRkcmVzcywKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlOiBwYXJzZWQsCiAgICAgIG5vbmNlLAogICAgICBzY2hlbWUsCiAgICAgIHRpbWUKICAgIH0pOwogICAgaWYgKCFpc1ZhbGlkKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBoYXNoMyA9IGhhc2hNZXNzYWdlKG1lc3NhZ2UpOwogICAgcmV0dXJuIHZlcmlmeUhhc2gyKGNsaWVudCwgewogICAgICBhZGRyZXNzOiBwYXJzZWQuYWRkcmVzcywKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgLi4uY2FsbFJlcXVlc3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvZGVjb3JhdG9ycy9wdWJsaWMuanMKICBmdW5jdGlvbiBwdWJsaWNBY3Rpb25zKGNsaWVudCkgewogICAgcmV0dXJuIHsKICAgICAgY2FsbDogKGFyZ3MpID0+IGNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlQmxvY2tGaWx0ZXI6ICgpID0+IGNyZWF0ZUJsb2NrRmlsdGVyKGNsaWVudCksCiAgICAgIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXI6IChhcmdzKSA9PiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgYXJncyksCiAgICAgIGNyZWF0ZUV2ZW50RmlsdGVyOiAoYXJncykgPT4gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlUGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyOiAoKSA9PiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSwKICAgICAgZXN0aW1hdGVDb250cmFjdEdhczogKGFyZ3MpID0+IGVzdGltYXRlQ29udHJhY3RHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUdhcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCYWxhbmNlOiAoYXJncykgPT4gZ2V0QmFsYW5jZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9iQmFzZUZlZTogKCkgPT4gZ2V0QmxvYkJhc2VGZWUoY2xpZW50KSwKICAgICAgZ2V0QmxvY2s6IChhcmdzKSA9PiBnZXRCbG9jayhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9ja051bWJlcjogKGFyZ3MpID0+IGdldEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudDogKGFyZ3MpID0+IGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCeXRlY29kZTogKGFyZ3MpID0+IGdldENvZGUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0Q2hhaW5JZDogKCkgPT4gZ2V0Q2hhaW5JZChjbGllbnQpLAogICAgICBnZXRDb2RlOiAoYXJncykgPT4gZ2V0Q29kZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRDb250cmFjdEV2ZW50czogKGFyZ3MpID0+IGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgYXJncyksCiAgICAgIGdldEVpcDcxMkRvbWFpbjogKGFyZ3MpID0+IGdldEVpcDcxMkRvbWFpbihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBZGRyZXNzOiAoYXJncykgPT4gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBdmF0YXI6IChhcmdzKSA9PiBnZXRFbnNBdmF0YXIoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zTmFtZTogKGFyZ3MpID0+IGdldEVuc05hbWUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zUmVzb2x2ZXI6IChhcmdzKSA9PiBnZXRFbnNSZXNvbHZlcihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNUZXh0OiAoYXJncykgPT4gZ2V0RW5zVGV4dChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRGZWVIaXN0b3J5OiAoYXJncykgPT4gZ2V0RmVlSGlzdG9yeShjbGllbnQsIGFyZ3MpLAogICAgICBlc3RpbWF0ZUZlZXNQZXJHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyQ2hhbmdlczogKGFyZ3MpID0+IGdldEZpbHRlckNoYW5nZXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyTG9nczogKGFyZ3MpID0+IGdldEZpbHRlckxvZ3MoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0R2FzUHJpY2U6ICgpID0+IGdldEdhc1ByaWNlKGNsaWVudCksCiAgICAgIGdldExvZ3M6IChhcmdzKSA9PiBnZXRMb2dzKGNsaWVudCwgYXJncyksCiAgICAgIGdldFByb29mOiAoYXJncykgPT4gZ2V0UHJvb2YoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhczogKGFyZ3MpID0+IGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0U3RvcmFnZUF0OiAoYXJncykgPT4gZ2V0U3RvcmFnZUF0KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zKGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uQ291bnQ6IChhcmdzKSA9PiBnZXRUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uUmVjZWlwdDogKGFyZ3MpID0+IGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICBtdWx0aWNhbGw6IChhcmdzKSA9PiBtdWx0aWNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdDogKGFyZ3MpID0+IHByZXBhcmVUcmFuc2FjdGlvblJlcXVlc3QoY2xpZW50LCBhcmdzKSwKICAgICAgcmVhZENvbnRyYWN0OiAoYXJncykgPT4gcmVhZENvbnRyYWN0KGNsaWVudCwgYXJncyksCiAgICAgIHNlbmRSYXdUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRSYXdUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICBzaW11bGF0ZUNvbnRyYWN0OiAoYXJncykgPT4gc2ltdWxhdGVDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlNZXNzYWdlOiAoYXJncykgPT4gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCBhcmdzKSwKICAgICAgdmVyaWZ5U2l3ZU1lc3NhZ2U6IChhcmdzKSA9PiB2ZXJpZnlTaXdlTWVzc2FnZShjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlUeXBlZERhdGE6IChhcmdzKSA9PiB2ZXJpZnlUeXBlZERhdGEyKGNsaWVudCwgYXJncyksCiAgICAgIHVuaW5zdGFsbEZpbHRlcjogKGFyZ3MpID0+IHVuaW5zdGFsbEZpbHRlcihjbGllbnQsIGFyZ3MpLAogICAgICB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0OiAoYXJncykgPT4gd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEJsb2NrczogKGFyZ3MpID0+IHdhdGNoQmxvY2tzKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQmxvY2tOdW1iZXI6IChhcmdzKSA9PiB3YXRjaEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQ29udHJhY3RFdmVudDogKGFyZ3MpID0+IHdhdGNoQ29udHJhY3RFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEV2ZW50OiAoYXJncykgPT4gd2F0Y2hFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnM6IChhcmdzKSA9PiB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVB1YmxpY0NsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVB1YmxpY0NsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJwdWJsaWMiLCBuYW1lID0gIlB1YmxpYyBDbGllbnQiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2xpZW50ID0gY3JlYXRlQ2xpZW50KHsKICAgICAgLi4ucGFyYW1ldGVycywKICAgICAga2V5LAogICAgICBuYW1lLAogICAgICB0eXBlOiAicHVibGljQ2xpZW50IgogICAgfSk7CiAgICByZXR1cm4gY2xpZW50LmV4dGVuZChwdWJsaWNBY3Rpb25zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvZHJvcFRyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gZHJvcFRyYW5zYWN0aW9uKGNsaWVudCwgeyBoYXNoOiBoYXNoMyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2Ryb3BUcmFuc2FjdGlvbmAsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2R1bXBTdGF0ZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGR1bXBTdGF0ZShjbGllbnQpIHsKICAgIHJldHVybiBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2R1bXBTdGF0ZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRBdXRvbWluZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEF1dG9taW5lKGNsaWVudCkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX21pbmluZyIKICAgICAgfSk7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9nZXRBdXRvbWluZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRUeHBvb2xDb250ZW50LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHhwb29sQ29udGVudChjbGllbnQpIHsKICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9jb250ZW50IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2dldFR4cG9vbFN0YXR1cy5qcwogIGluaXRfZnJvbUhleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFR4cG9vbFN0YXR1cyhjbGllbnQpIHsKICAgIGNvbnN0IHsgcGVuZGluZywgcXVldWVkIH0gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9zdGF0dXMiCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIHBlbmRpbmc6IGhleFRvTnVtYmVyKHBlbmRpbmcpLAogICAgICBxdWV1ZWQ6IGhleFRvTnVtYmVyKHF1ZXVlZCkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2ltcGVyc29uYXRlQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIGltcGVyc29uYXRlQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2ltcGVyc29uYXRlQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5jcmVhc2VUaW1lLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGluY3JlYXNlVGltZShjbGllbnQsIHsgc2Vjb25kcyB9KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1faW5jcmVhc2VUaW1lIiwKICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoc2Vjb25kcyldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5zcGVjdFR4cG9vbC5qcwogIGFzeW5jIGZ1bmN0aW9uIGluc3BlY3RUeHBvb2woY2xpZW50KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ0eHBvb2xfaW5zcGVjdCIKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9sb2FkU3RhdGUuanMKICBhc3luYyBmdW5jdGlvbiBsb2FkU3RhdGUoY2xpZW50LCB7IHN0YXRlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbG9hZFN0YXRlYCwKICAgICAgcGFyYW1zOiBbc3RhdGVdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvbWluZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBtaW5lKGNsaWVudCwgeyBibG9ja3MsIGludGVydmFsIH0pIHsKICAgIGlmIChjbGllbnQubW9kZSA9PT0gImdhbmFjaGUiKQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXZtX21pbmUiLAogICAgICAgIHBhcmFtczogW3sgYmxvY2tzOiBudW1iZXJUb0hleChibG9ja3MpIH1dCiAgICAgIH0pOwogICAgZWxzZQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbWluZWAsCiAgICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoYmxvY2tzKSwgbnVtYmVyVG9IZXgoaW50ZXJ2YWwgfHwgMCldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZW1vdmVCbG9ja1RpbWVzdGFtcEludGVydmFsLmpzCiAgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZXNldC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlc2V0KGNsaWVudCwgeyBibG9ja051bWJlciwganNvblJwY1VybCB9ID0ge30pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVzZXRgLAogICAgICBwYXJhbXM6IFt7IGZvcmtpbmc6IHsgYmxvY2tOdW1iZXI6IE51bWJlcihibG9ja051bWJlciksIGpzb25ScGNVcmwgfSB9XQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3JldmVydC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJldmVydChjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1fcmV2ZXJ0IiwKICAgICAgcGFyYW1zOiBbaWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24uanMKICBpbml0X2V4dHJhY3QoKTsKICBpbml0X3RyYW5zYWN0aW9uUmVxdWVzdCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBkYXRhLCBmcm9tLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlLCAuLi5yZXN0IH0gPSBhcmdzOwogICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICBhY2Nlc3NMaXN0LAogICAgICBkYXRhLAogICAgICBmcm9tLAogICAgICBnYXMsCiAgICAgIGdhc1ByaWNlLAogICAgICBtYXhGZWVQZXJHYXMsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICBub25jZSwKICAgICAgdG8sCiAgICAgIHZhbHVlCiAgICB9KTsKICAgIGNvbnN0IGhhc2gzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24iLAogICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgfSk7CiAgICByZXR1cm4gaGFzaDM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEF1dG9taW5lLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0QXV0b21pbmUoY2xpZW50LCBlbmFibGVkKSB7CiAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJnYW5hY2hlIikgewogICAgICBpZiAoZW5hYmxlZCkKICAgICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIm1pbmVyX3N0YXJ0IiB9KTsKICAgICAgZWxzZQogICAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsgbWV0aG9kOiAibWluZXJfc3RvcCIgfSk7CiAgICB9IGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV2bV9zZXRBdXRvbWluZSIsCiAgICAgICAgcGFyYW1zOiBbZW5hYmxlZF0KICAgICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEJhbGFuY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0QmFsYW5jZShjbGllbnQsIHsgYWRkcmVzcywgdmFsdWUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudEJhbGFuY2UiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIG51bWJlclRvSGV4KHZhbHVlKV0KICAgICAgfSk7CiAgICBlbHNlCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRCYWxhbmNlYCwKICAgICAgICBwYXJhbXM6IFthZGRyZXNzLCBudW1iZXJUb0hleCh2YWx1ZSldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRCbG9ja0dhc0xpbWl0LmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCB7IGdhc0xpbWl0IH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NldEJsb2NrR2FzTGltaXQiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNMaW1pdCldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrVGltZXN0YW1wSW50ZXJ2YWwoY2xpZW50LCB7IGludGVydmFsIH0pIHsKICAgIGNvbnN0IGludGVydmFsXyA9ICgoKSA9PiB7CiAgICAgIGlmIChjbGllbnQubW9kZSA9PT0gImhhcmRoYXQiKQogICAgICAgIHJldHVybiBpbnRlcnZhbCAqIDFlMzsKICAgICAgcmV0dXJuIGludGVydmFsOwogICAgfSkoKTsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRDb2RlLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0Q29kZShjbGllbnQsIHsgYWRkcmVzcywgYnl0ZWNvZGUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudENvZGUiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICAgIGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvZGVgLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0Q29pbmJhc2UuanMKICBhc3luYyBmdW5jdGlvbiBzZXRDb2luYmFzZShjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvaW5iYXNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzc10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRJbnRlcnZhbE1pbmluZy5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEludGVydmFsTWluaW5nKGNsaWVudCwgeyBpbnRlcnZhbCB9KSB7CiAgICBjb25zdCBpbnRlcnZhbF8gPSAoKCkgPT4gewogICAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJoYXJkaGF0IikKICAgICAgICByZXR1cm4gaW50ZXJ2YWwgKiAxZTM7CiAgICAgIHJldHVybiBpbnRlcnZhbDsKICAgIH0pKCk7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXRJbnRlcnZhbE1pbmluZyIsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRMb2dnaW5nRW5hYmxlZC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgZW5hYmxlZCkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRMb2dnaW5nRW5hYmxlZGAsCiAgICAgIHBhcmFtczogW2VuYWJsZWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TWluR2FzUHJpY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0TWluR2FzUHJpY2UoY2xpZW50LCB7IGdhc1ByaWNlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TWluR2FzUHJpY2VgLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNQcmljZSldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhcy5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgeyBiYXNlRmVlUGVyR2FzIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhc2AsCiAgICAgIHBhcmFtczogW251bWJlclRvSGV4KGJhc2VGZWVQZXJHYXMpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5leHRCbG9ja1RpbWVzdGFtcC5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tUaW1lc3RhbXAoY2xpZW50LCB7IHRpbWVzdGFtcCB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXROZXh0QmxvY2tUaW1lc3RhbXAiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleCh0aW1lc3RhbXApXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5vbmNlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldE5vbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBub25jZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldE5vbmNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgbnVtYmVyVG9IZXgobm9uY2UpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldFJwY1VybC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldFJwY1VybChjbGllbnQsIGpzb25ScGNVcmwpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0UnBjVXJsYCwKICAgICAgcGFyYW1zOiBbanNvblJwY1VybF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBpbmRleDogaW5kZXgyLCB2YWx1ZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldFN0b3JhZ2VBdGAsCiAgICAgIHBhcmFtczogWwogICAgICAgIGFkZHJlc3MsCiAgICAgICAgdHlwZW9mIGluZGV4MiA9PT0gIm51bWJlciIgPyBudW1iZXJUb0hleChpbmRleDIpIDogaW5kZXgyLAogICAgICAgIHZhbHVlCiAgICAgIF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zbmFwc2hvdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNuYXBzaG90KGNsaWVudCkgewogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NuYXBzaG90IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvdGVzdC5qcwogIGZ1bmN0aW9uIHRlc3RBY3Rpb25zKHsgbW9kZTogbW9kZTIgfSkgewogICAgcmV0dXJuIChjbGllbnRfKSA9PiB7CiAgICAgIGNvbnN0IGNsaWVudCA9IGNsaWVudF8uZXh0ZW5kKCgpID0+ICh7CiAgICAgICAgbW9kZTogbW9kZTIKICAgICAgfSkpOwogICAgICByZXR1cm4gewogICAgICAgIGRyb3BUcmFuc2FjdGlvbjogKGFyZ3MpID0+IGRyb3BUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICAgIGR1bXBTdGF0ZTogKCkgPT4gZHVtcFN0YXRlKGNsaWVudCksCiAgICAgICAgZ2V0QXV0b21pbmU6ICgpID0+IGdldEF1dG9taW5lKGNsaWVudCksCiAgICAgICAgZ2V0VHhwb29sQ29udGVudDogKCkgPT4gZ2V0VHhwb29sQ29udGVudChjbGllbnQpLAogICAgICAgIGdldFR4cG9vbFN0YXR1czogKCkgPT4gZ2V0VHhwb29sU3RhdHVzKGNsaWVudCksCiAgICAgICAgaW1wZXJzb25hdGVBY2NvdW50OiAoYXJncykgPT4gaW1wZXJzb25hdGVBY2NvdW50KGNsaWVudCwgYXJncyksCiAgICAgICAgaW5jcmVhc2VUaW1lOiAoYXJncykgPT4gaW5jcmVhc2VUaW1lKGNsaWVudCwgYXJncyksCiAgICAgICAgaW5zcGVjdFR4cG9vbDogKCkgPT4gaW5zcGVjdFR4cG9vbChjbGllbnQpLAogICAgICAgIGxvYWRTdGF0ZTogKGFyZ3MpID0+IGxvYWRTdGF0ZShjbGllbnQsIGFyZ3MpLAogICAgICAgIG1pbmU6IChhcmdzKSA9PiBtaW5lKGNsaWVudCwgYXJncyksCiAgICAgICAgcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbDogKCkgPT4gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpLAogICAgICAgIHJlc2V0OiAoYXJncykgPT4gcmVzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgICByZXZlcnQ6IChhcmdzKSA9PiByZXZlcnQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZW5kVW5zaWduZWRUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QXV0b21pbmU6IChhcmdzKSA9PiBzZXRBdXRvbWluZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEJhbGFuY2U6IChhcmdzKSA9PiBzZXRCYWxhbmNlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QmxvY2tHYXNMaW1pdDogKGFyZ3MpID0+IHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRCbG9ja1RpbWVzdGFtcEludGVydmFsOiAoYXJncykgPT4gc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldENvZGU6IChhcmdzKSA9PiBzZXRDb2RlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Q29pbmJhc2U6IChhcmdzKSA9PiBzZXRDb2luYmFzZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEludGVydmFsTWluaW5nOiAoYXJncykgPT4gc2V0SW50ZXJ2YWxNaW5pbmcoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRMb2dnaW5nRW5hYmxlZDogKGFyZ3MpID0+IHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TWluR2FzUHJpY2U6IChhcmdzKSA9PiBzZXRNaW5HYXNQcmljZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldE5leHRCbG9ja0Jhc2VGZWVQZXJHYXM6IChhcmdzKSA9PiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TmV4dEJsb2NrVGltZXN0YW1wOiAoYXJncykgPT4gc2V0TmV4dEJsb2NrVGltZXN0YW1wKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Tm9uY2U6IChhcmdzKSA9PiBzZXROb25jZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFJwY1VybDogKGFyZ3MpID0+IHNldFJwY1VybChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFN0b3JhZ2VBdDogKGFyZ3MpID0+IHNldFN0b3JhZ2VBdChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNuYXBzaG90OiAoKSA9PiBzbmFwc2hvdChjbGllbnQpLAogICAgICAgIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudDogKGFyZ3MpID0+IHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIGFyZ3MpCiAgICAgIH07CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlVGVzdENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRlc3RDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBrZXkgPSAidGVzdCIsIG5hbWUgPSAiVGVzdCBDbGllbnQiLCBtb2RlOiBtb2RlMiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNsaWVudCA9IGNyZWF0ZUNsaWVudCh7CiAgICAgIC4uLnBhcmFtZXRlcnMsCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgdHlwZTogInRlc3RDbGllbnQiCiAgICB9KTsKICAgIHJldHVybiBjbGllbnQuZXh0ZW5kKChjb25maWcpID0+ICh7CiAgICAgIG1vZGU6IG1vZGUyLAogICAgICAuLi50ZXN0QWN0aW9ucyh7IG1vZGU6IG1vZGUyIH0pKGNvbmZpZykKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9kZXBsb3lDb250cmFjdC5qcwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGZ1bmN0aW9uIGRlcGxveUNvbnRyYWN0KHdhbGxldENsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlLCAuLi5yZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVEZXBsb3lEYXRhKHsgYWJpOiBhYmkyLCBhcmdzLCBieXRlY29kZSB9KTsKICAgIHJldHVybiBzZW5kVHJhbnNhY3Rpb24od2FsbGV0Q2xpZW50LCB7CiAgICAgIC4uLnJlcXVlc3QsCiAgICAgIGRhdGE6IGNhbGxkYXRhCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRBZGRyZXNzZXMuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBpZiAoY2xpZW50LmFjY291bnQ/LnR5cGUgPT09ICJsb2NhbCIpCiAgICAgIHJldHVybiBbY2xpZW50LmFjY291bnQuYWRkcmVzc107CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9hY2NvdW50cyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gYWRkcmVzc2VzLm1hcCgoYWRkcmVzcykgPT4gY2hlY2tzdW1BZGRyZXNzKGFkZHJlc3MpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldFBlcm1pc3Npb25zKGNsaWVudCkgewogICAgY29uc3QgcGVybWlzc2lvbnMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIndhbGxldF9nZXRQZXJtaXNzaW9ucyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gcGVybWlzc2lvbnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcmVxdWVzdEFkZHJlc3Nlcy5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9yZXF1ZXN0QWNjb3VudHMiIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogICAgcmV0dXJuIGFkZHJlc3Nlcy5tYXAoKGFkZHJlc3MpID0+IGdldEFkZHJlc3MoYWRkcmVzcykpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3JlcXVlc3RQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIHBlcm1pc3Npb25zKSB7CiAgICByZXR1cm4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfcmVxdWVzdFBlcm1pc3Npb25zIiwKICAgICAgcGFyYW1zOiBbcGVybWlzc2lvbnNdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduTWVzc2FnZShjbGllbnQsIHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgbWVzc2FnZSB9KSB7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBpZiAoYWNjb3VudC5zaWduTWVzc2FnZSkKICAgICAgcmV0dXJuIGFjY291bnQuc2lnbk1lc3NhZ2UoeyBtZXNzYWdlIH0pOwogICAgY29uc3QgbWVzc2FnZV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBzdHJpbmdUb0hleChtZXNzYWdlKTsKICAgICAgaWYgKG1lc3NhZ2UucmF3IGluc3RhbmNlb2YgVWludDhBcnJheSkKICAgICAgICByZXR1cm4gdG9IZXgobWVzc2FnZS5yYXcpOwogICAgICByZXR1cm4gbWVzc2FnZS5yYXc7CiAgICB9KSgpOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAicGVyc29uYWxfc2lnbiIsCiAgICAgIHBhcmFtczogW21lc3NhZ2VfLCBhY2NvdW50LmFkZHJlc3NdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnblRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X3RvSGV4KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduVHJhbnNhY3Rpb24oY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGNoYWluID0gY2xpZW50LmNoYWluLCAuLi50cmFuc2FjdGlvbiB9ID0gcGFyYW1ldGVyczsKICAgIGlmICghYWNjb3VudF8pCiAgICAgIHRocm93IG5ldyBBY2NvdW50Tm90Rm91bmRFcnJvcih7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9hY3Rpb25zL3dhbGxldC9zaWduVHJhbnNhY3Rpb24iCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBhc3NlcnRSZXF1ZXN0KHsKICAgICAgYWNjb3VudCwKICAgICAgLi4ucGFyYW1ldGVycwogICAgfSk7CiAgICBjb25zdCBjaGFpbklkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q2hhaW5JZCwgImdldENoYWluSWQiKSh7fSk7CiAgICBpZiAoY2hhaW4gIT09IG51bGwpCiAgICAgIGFzc2VydEN1cnJlbnRDaGFpbih7CiAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgY2hhaW4KICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXR0ZXJzNCA9IGNoYWluPy5mb3JtYXR0ZXJzIHx8IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVyczsKICAgIGNvbnN0IGZvcm1hdCA9IGZvcm1hdHRlcnM0Py50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdCB8fCBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3Q7CiAgICBpZiAoYWNjb3VudC5zaWduVHJhbnNhY3Rpb24pCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UcmFuc2FjdGlvbih7CiAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgY2hhaW5JZAogICAgICB9LCB7IHNlcmlhbGl6ZXI6IGNsaWVudC5jaGFpbj8uc2VyaWFsaXplcnM/LnRyYW5zYWN0aW9uIH0pOwogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIC4uLmZvcm1hdCh0cmFuc2FjdGlvbiksCiAgICAgICAgICBjaGFpbklkOiBudW1iZXJUb0hleChjaGFpbklkKSwKICAgICAgICAgIGZyb206IGFjY291bnQuYWRkcmVzcwogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3NpZ25UeXBlZERhdGEuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNpZ25UeXBlZERhdGEoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnblR5cGVkRGF0YSIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gcGFyc2VBY2NvdW50KGFjY291bnRfKTsKICAgIGNvbnN0IHR5cGVzID0gewogICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pLAogICAgICAuLi5wYXJhbWV0ZXJzLnR5cGVzCiAgICB9OwogICAgdmFsaWRhdGVUeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGlmIChhY2NvdW50LnNpZ25UeXBlZERhdGEpCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGNvbnN0IHR5cGVkRGF0YSA9IHNlcmlhbGl6ZVR5cGVkRGF0YSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UeXBlZERhdGFfdjQiLAogICAgICBwYXJhbXM6IFthY2NvdW50LmFkZHJlc3MsIHR5cGVkRGF0YV0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zd2l0Y2hDaGFpbi5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzd2l0Y2hDaGFpbihjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfc3dpdGNoRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKQogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dhdGNoQXNzZXQuanMKICBhc3luYyBmdW5jdGlvbiB3YXRjaEFzc2V0KGNsaWVudCwgcGFyYW1zKSB7CiAgICBjb25zdCBhZGRlZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAid2FsbGV0X3dhdGNoQXNzZXQiLAogICAgICBwYXJhbXMKICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgIHJldHVybiBhZGRlZDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvd2FsbGV0LmpzCiAgZnVuY3Rpb24gd2FsbGV0QWN0aW9ucyhjbGllbnQpIHsKICAgIHJldHVybiB7CiAgICAgIGFkZENoYWluOiAoYXJncykgPT4gYWRkQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgZGVwbG95Q29udHJhY3Q6IChhcmdzKSA9PiBkZXBsb3lDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRBZGRyZXNzZXM6ICgpID0+IGdldEFkZHJlc3NlcyhjbGllbnQpLAogICAgICBnZXRDaGFpbklkOiAoKSA9PiBnZXRDaGFpbklkKGNsaWVudCksCiAgICAgIGdldFBlcm1pc3Npb25zOiAoKSA9PiBnZXRQZXJtaXNzaW9ucyhjbGllbnQpLAogICAgICBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0OiAoYXJncykgPT4gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpLAogICAgICByZXF1ZXN0QWRkcmVzc2VzOiAoKSA9PiByZXF1ZXN0QWRkcmVzc2VzKGNsaWVudCksCiAgICAgIHJlcXVlc3RQZXJtaXNzaW9uczogKGFyZ3MpID0+IHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIGFyZ3MpLAogICAgICBzZW5kUmF3VHJhbnNhY3Rpb246IChhcmdzKSA9PiBzZW5kUmF3VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgc2VuZFRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25NZXNzYWdlOiAoYXJncykgPT4gc2lnbk1lc3NhZ2UoY2xpZW50LCBhcmdzKSwKICAgICAgc2lnblRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2lnblRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25UeXBlZERhdGE6IChhcmdzKSA9PiBzaWduVHlwZWREYXRhKGNsaWVudCwgYXJncyksCiAgICAgIHN3aXRjaENoYWluOiAoYXJncykgPT4gc3dpdGNoQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgd2F0Y2hBc3NldDogKGFyZ3MpID0+IHdhdGNoQXNzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgd3JpdGVDb250cmFjdDogKGFyZ3MpID0+IHdyaXRlQ29udHJhY3QoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVdhbGxldENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVdhbGxldENsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJ3YWxsZXQiLCBuYW1lID0gIldhbGxldCBDbGllbnQiLCB0cmFuc3BvcnQgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjbGllbnQgPSBjcmVhdGVDbGllbnQoewogICAgICAuLi5wYXJhbWV0ZXJzLAogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHRyYW5zcG9ydCwKICAgICAgdHlwZTogIndhbGxldENsaWVudCIKICAgIH0pOwogICAgcmV0dXJuIGNsaWVudC5leHRlbmQod2FsbGV0QWN0aW9ucyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL3dlYlNvY2tldC5qcwogIGluaXRfcmVxdWVzdCgpOwogIGZ1bmN0aW9uIHdlYlNvY2tldCh1cmwsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtlZXBBbGl2ZSwga2V5ID0gIndlYlNvY2tldCIsIG5hbWUgPSAiV2ViU29ja2V0IEpTT04tUlBDIiwgcmVjb25uZWN0LCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHJldHJ5Q291bnQgPSBjb25maWcucmV0cnlDb3VudCA/PyByZXRyeUNvdW50XzsKICAgICAgY29uc3QgdGltZW91dCA9IHRpbWVvdXRfID8/IGNvbmZpZy50aW1lb3V0ID8/IDFlNDsKICAgICAgY29uc3QgdXJsXyA9IHVybCB8fCBjaGFpbj8ucnBjVXJscy5kZWZhdWx0LndlYlNvY2tldD8uWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydCh7CiAgICAgICAga2V5LAogICAgICAgIG5hbWUsCiAgICAgICAgYXN5bmMgcmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pIHsKICAgICAgICAgIGNvbnN0IGJvZHkgPSB7IG1ldGhvZCwgcGFyYW1zIH07CiAgICAgICAgICBjb25zdCBycGNDbGllbnQgPSBhd2FpdCBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsXywgewogICAgICAgICAgICBrZWVwQWxpdmUsCiAgICAgICAgICAgIHJlY29ubmVjdAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCB7IGVycm9yLCByZXN1bHQgfSA9IGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0QXN5bmMoewogICAgICAgICAgICBib2R5LAogICAgICAgICAgICB0aW1lb3V0CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogIndlYlNvY2tldCIKICAgICAgfSwgewogICAgICAgIGdldFNvY2tldCgpIHsKICAgICAgICAgIHJldHVybiBnZXRTb2NrZXQodXJsXyk7CiAgICAgICAgfSwKICAgICAgICBnZXRScGNDbGllbnQoKSB7CiAgICAgICAgICByZXR1cm4gZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgc3Vic2NyaWJlKHsgcGFyYW1zLCBvbkRhdGEsIG9uRXJyb3IgfSkgewogICAgICAgICAgY29uc3QgcnBjQ2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgICAgY29uc3QgeyByZXN1bHQ6IHN1YnNjcmlwdGlvbklkIH0gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIGJvZHk6IHsKICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfc3Vic2NyaWJlIiwKICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsKICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZS5lcnJvcik7CiAgICAgICAgICAgICAgICBvbkVycm9yPy4ocmVzcG9uc2UuZXJyb3IpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmlkID09PSAibnVtYmVyIikgewogICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5tZXRob2QgIT09ICJldGhfc3Vic2NyaXB0aW9uIikKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBvbkRhdGEocmVzcG9uc2UucGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQsCiAgICAgICAgICAgIGFzeW5jIHVuc3Vic2NyaWJlKCkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcnBjQ2xpZW50LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfdW5zdWJzY3JpYmUiLAogICAgICAgICAgICAgICAgICBwYXJhbXM6IFtzdWJzY3JpcHRpb25JZF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiByZXNvbHZlCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hYmlzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWRkcmVzcy5qcwogIHZhciB6ZXJvQWRkcmVzcyA9ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfdW5pdCgpOwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9ycGMoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9lbmNvZGluZygpOwogIGluaXRfbm9kZSgpOwogIGluaXRfcmVxdWVzdCgpOwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2RhdGEoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3R5cGVzL2VpcDExOTMuanMKICB2YXIgUHJvdmlkZXJScGNFcnJvcjIgPSBjbGFzcyBleHRlbmRzIEVycm9yIHsKICAgIGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UpIHsKICAgICAgc3VwZXIobWVzc2FnZSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICB9KTsKICAgICAgdGhpcy5jb2RlID0gY29kZTsKICAgICAgdGhpcy5kZXRhaWxzID0gbWVzc2FnZTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVEZXBsb3lEYXRhLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKICB2YXIgZG9jc1BhdGg4ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZURlcGxveURhdGEiOwogIGZ1bmN0aW9uIGRlY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGJ5dGVjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKGRhdGEgPT09IGJ5dGVjb2RlKQogICAgICByZXR1cm4geyBieXRlY29kZSB9OwogICAgY29uc3QgZGVzY3JpcHRpb24gPSBhYmkyLmZpbmQoKHgpID0+ICJ0eXBlIiBpbiB4ICYmIHgudHlwZSA9PT0gImNvbnN0cnVjdG9yIik7CiAgICBpZiAoIWRlc2NyaXB0aW9uKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGlmICghKCJpbnB1dHMiIGluIGRlc2NyaXB0aW9uKSkKICAgICAgdGhyb3cgbmV3IEFiaUNvbnN0cnVjdG9yUGFyYW1zTm90Rm91bmRFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDggfSk7CiAgICBpZiAoIWRlc2NyaXB0aW9uLmlucHV0cyB8fCBkZXNjcmlwdGlvbi5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGNvbnN0IGFyZ3MgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgYDB4JHtkYXRhLnJlcGxhY2UoYnl0ZWNvZGUsICIiKX1gKTsKICAgIHJldHVybiB7IGFyZ3MsIGJ5dGVjb2RlIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9jb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gY29tcGFjdFNpZ25hdHVyZVRvU2lnbmF0dXJlKHsgciwgeVBhcml0eUFuZFMgfSkgewogICAgY29uc3QgeVBhcml0eUFuZFNfYnl0ZXMgPSBoZXhUb0J5dGVzKHlQYXJpdHlBbmRTKTsKICAgIGNvbnN0IHlQYXJpdHkgPSB5UGFyaXR5QW5kU19ieXRlc1swXSAmIDEyOCA/IDEgOiAwOwogICAgY29uc3QgcyA9IHlQYXJpdHlBbmRTX2J5dGVzOwogICAgaWYgKHlQYXJpdHkgPT09IDEpCiAgICAgIHNbMF0gJj0gMTI3OwogICAgcmV0dXJuIHsgciwgczogYnl0ZXNUb0hleChzKSwgeVBhcml0eSB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9wYXJzZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBwYXJzZUNvbXBhY3RTaWduYXR1cmUoc2lnbmF0dXJlSGV4KSB7CiAgICBjb25zdCB7IHIsIHMgfSA9IHNlY3AyNTZrMS5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnNsaWNlKDIsIDEzMCkpOwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eUFuZFM6IG51bWJlclRvSGV4KHMsIHsgc2l6ZTogMzIgfSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlU2lnbmF0dXJlLmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VTaWduYXR1cmUyKHNpZ25hdHVyZUhleCkgewogICAgY29uc3QgeyByLCBzIH0gPSBzZWNwMjU2azEuU2lnbmF0dXJlLmZyb21Db21wYWN0KHNpZ25hdHVyZUhleC5zbGljZSgyLCAxMzApKTsKICAgIGNvbnN0IHlQYXJpdHlPclYgPSBOdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgIGNvbnN0IFt2LCB5UGFyaXR5XSA9ICgoKSA9PiB7CiAgICAgIGlmICh5UGFyaXR5T3JWID09PSAwIHx8IHlQYXJpdHlPclYgPT09IDEpCiAgICAgICAgcmV0dXJuIFt2b2lkIDAsIHlQYXJpdHlPclZdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjcpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDBdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDFdOwogICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgeVBhcml0eU9yViB2YWx1ZSIpOwogICAgfSkoKTsKICAgIGlmICh0eXBlb2YgdiAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiB7CiAgICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgICBzOiBudW1iZXJUb0hleChzLCB7IHNpemU6IDMyIH0pLAogICAgICAgIHYsCiAgICAgICAgeVBhcml0eQogICAgICB9OwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgczogbnVtYmVyVG9IZXgocywgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcy5qcwogIGluaXRfa2VjY2FrMjU2KCk7CiAgYXN5bmMgZnVuY3Rpb24gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgc2lnbmF0dXJlOiBzaWduYXR1cmVfIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSBwYXJzZVRyYW5zYWN0aW9uKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVfID8/IHsKICAgICAgcjogdHJhbnNhY3Rpb24uciwKICAgICAgczogdHJhbnNhY3Rpb24ucywKICAgICAgdjogdHJhbnNhY3Rpb24udiwKICAgICAgeVBhcml0eTogdHJhbnNhY3Rpb24ueVBhcml0eQogICAgfTsKICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBzZXJpYWxpemVUcmFuc2FjdGlvbih7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICByOiB2b2lkIDAsCiAgICAgIHM6IHZvaWQgMCwKICAgICAgdjogdm9pZCAwLAogICAgICB5UGFyaXR5OiB2b2lkIDAsCiAgICAgIHNpZGVjYXJzOiB2b2lkIDAKICAgIH0pOwogICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsKICAgICAgaGFzaDoga2VjY2FrMjU2KHNlcmlhbGl6ZWQpLAogICAgICBzaWduYXR1cmUKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zaWduYXR1cmVUb0NvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgY29uc3QgeyByLCBzLCB2LCB5UGFyaXR5IH0gPSBzaWduYXR1cmU7CiAgICBjb25zdCB5UGFyaXR5XyA9IE51bWJlcih5UGFyaXR5ID8/IHYgLSAyN24pOwogICAgbGV0IHlQYXJpdHlBbmRTID0gczsKICAgIGlmICh5UGFyaXR5XyA9PT0gMSkgewogICAgICBjb25zdCBieXRlczIgPSBoZXhUb0J5dGVzKHMpOwogICAgICBieXRlczJbMF0gfD0gMTI4OwogICAgICB5UGFyaXR5QW5kUyA9IGJ5dGVzVG9IZXgoYnl0ZXMyKTsKICAgIH0KICAgIHJldHVybiB7IHIsIHlQYXJpdHlBbmRTIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3NlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUoeyByLCB5UGFyaXR5QW5kUyB9KSB7CiAgICByZXR1cm4gYDB4JHtuZXcgc2VjcDI1NmsxLlNpZ25hdHVyZShoZXhUb0JpZ0ludChyKSwgaGV4VG9CaWdJbnQoeVBhcml0eUFuZFMpKS50b0NvbXBhY3RIZXgoKX1gOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfZnJvbUJ5dGVzKCk7CiAgaW5pdF9jY2lwMigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9zaWRlY2Fyc1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNpZGVjYXJzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHNpZGVjYXJzWzBdLmJsb2IgPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGhhc2hlcyA9IFtdOwogICAgZm9yIChjb25zdCB7IGNvbW1pdG1lbnQgfSBvZiBzaWRlY2FycykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9mcm9tQmxvYnMuanMKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbUJsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGxlbmd0aCA9IGJsb2JzLnJlZHVjZSgobGVuZ3RoMiwgYmxvYikgPT4gbGVuZ3RoMiArIGJsb2IubGVuZ3RoLCAwKTsKICAgIGNvbnN0IGRhdGEgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkobGVuZ3RoKSk7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykgewogICAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IoYmxvYik7CiAgICAgIHdoaWxlIChhY3RpdmUgJiYgY3Vyc29yLnBvc2l0aW9uIDwgYmxvYi5sZW5ndGgpIHsKICAgICAgICBjdXJzb3IuaW5jcmVtZW50UG9zaXRpb24oMSk7CiAgICAgICAgbGV0IGNvbnN1bWUgPSAzMTsKICAgICAgICBpZiAoYmxvYi5sZW5ndGggLSBjdXJzb3IucG9zaXRpb24gPCAzMSkKICAgICAgICAgIGNvbnN1bWUgPSBibG9iLmxlbmd0aCAtIGN1cnNvci5wb3NpdGlvbjsKICAgICAgICBmb3IgKGNvbnN0IF8gaW4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29uc3VtZSB9KSkgewogICAgICAgICAgY29uc3QgYnl0ZSA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgICAgICAgY29uc3QgaXNUZXJtaW5hdG9yID0gYnl0ZSA9PT0gMTI4ICYmICFjdXJzb3IuaW5zcGVjdEJ5dGVzKGN1cnNvci5yZW1haW5pbmcpLmluY2x1ZGVzKDEyOCk7CiAgICAgICAgICBpZiAoaXNUZXJtaW5hdG9yKSB7CiAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGRhdGEucHVzaEJ5dGUoYnl0ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25zdCB0cmltbWVkRGF0YSA9IGRhdGEuYnl0ZXMuc2xpY2UoMCwgZGF0YS5wb3NpdGlvbik7CiAgICByZXR1cm4gdG8gPT09ICJoZXgiID8gYnl0ZXNUb0hleCh0cmltbWVkRGF0YSkgOiB0cmltbWVkRGF0YTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9remcvZGVmaW5lS3pnLmpzCiAgZnVuY3Rpb24gZGVmaW5lS3pnKHsgYmxvYlRvS3pnQ29tbWl0bWVudCwgY29tcHV0ZUJsb2JLemdQcm9vZiB9KSB7CiAgICByZXR1cm4gewogICAgICBibG9iVG9LemdDb21taXRtZW50LAogICAgICBjb21wdXRlQmxvYkt6Z1Byb29mCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2t6Zy9zZXR1cEt6Zy5qcwogIGZ1bmN0aW9uIHNldHVwS3pnKHBhcmFtZXRlcnMsIHBhdGgpIHsKICAgIHRyeSB7CiAgICAgIHBhcmFtZXRlcnMubG9hZFRydXN0ZWRTZXR1cChwYXRoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc3QgZXJyb3IgPSBlOwogICAgICBpZiAoIWVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoInRydXN0ZWQgc2V0dXAgaXMgYWxyZWFkeSBsb2FkZWQiKSkKICAgICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICAgIHJldHVybiBkZWZpbmVLemcocGFyYW1ldGVycyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X2Zvcm1hdEV0aGVyKCk7CiAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgaW5pdF9mb3JtYXRVbml0cygpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF90b0Z1bmN0aW9uU2VsZWN0b3IoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3BhZCgpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3N0cmluZ2lmeSgpOwogIGluaXRfdHJpbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2luZGV4LmpzCiAgdmFyIGNoYWluc19leHBvcnRzID0ge307CiAgX19leHBvcnQoY2hhaW5zX2V4cG9ydHMsIHsKICAgIGFic3RyYWN0VGVzdG5ldDogKCkgPT4gYWJzdHJhY3RUZXN0bmV0LAogICAgYWNhbGE6ICgpID0+IGFjYWxhLAogICAgYWxpZW54OiAoKSA9PiBhbGllbngsCiAgICBhbGllbnhIYWxUZXN0bmV0OiAoKSA9PiBhbGllbnhIYWxUZXN0bmV0LAogICAgYW5jaWVudDg6ICgpID0+IGFuY2llbnQ4LAogICAgYW5jaWVudDhTZXBvbGlhOiAoKSA9PiBhbmNpZW50OFNlcG9saWEsCiAgICBhbnZpbDogKCkgPT4gYW52aWwsCiAgICBhcGVDaGFpbjogKCkgPT4gYXBlQ2hhaW4sCiAgICBhcGV4VGVzdG5ldDogKCkgPT4gYXBleFRlc3RuZXQsCiAgICBhcmJpdHJ1bTogKCkgPT4gYXJiaXRydW0sCiAgICBhcmJpdHJ1bUdvZXJsaTogKCkgPT4gYXJiaXRydW1Hb2VybGksCiAgICBhcmJpdHJ1bU5vdmE6ICgpID0+IGFyYml0cnVtTm92YSwKICAgIGFyYml0cnVtU2Vwb2xpYTogKCkgPT4gYXJiaXRydW1TZXBvbGlhLAogICAgYXJlb25OZXR3b3JrOiAoKSA9PiBhcmVvbk5ldHdvcmssCiAgICBhcmVvbk5ldHdvcmtUZXN0bmV0OiAoKSA9PiBhcmVvbk5ldHdvcmtUZXN0bmV0LAogICAgYXJ0ZWxhVGVzdG5ldDogKCkgPT4gYXJ0ZWxhVGVzdG5ldCwKICAgIGFzc2V0Q2hhaW46ICgpID0+IGFzc2V0Q2hhaW4sCiAgICBhc3NldENoYWluVGVzdG5ldDogKCkgPT4gYXNzZXRDaGFpblRlc3RuZXQsCiAgICBhc3RhcjogKCkgPT4gYXN0YXIsCiAgICBhc3RhclprRVZNOiAoKSA9PiBhc3RhclprRVZNLAogICAgYXN0YXJaa3lvdG86ICgpID0+IGFzdGFyWmt5b3RvLAogICAgYXRsZXRhT2x5bXBpYTogKCkgPT4gYXRsZXRhT2x5bXBpYSwKICAgIGF1cm9yYTogKCkgPT4gYXVyb3JhLAogICAgYXVyb3JhVGVzdG5ldDogKCkgPT4gYXVyb3JhVGVzdG5ldCwKICAgIGF1cm9yaWE6ICgpID0+IGF1cm9yaWEsCiAgICBhdmFsYW5jaGU6ICgpID0+IGF2YWxhbmNoZSwKICAgIGF2YWxhbmNoZUZ1amk6ICgpID0+IGF2YWxhbmNoZUZ1amksCiAgICBiMzogKCkgPT4gYjMsCiAgICBiM1NlcG9saWE6ICgpID0+IGIzU2Vwb2xpYSwKICAgIGJhaGFtdXQ6ICgpID0+IGJhaGFtdXQsCiAgICBiYXNlOiAoKSA9PiBiYXNlLAogICAgYmFzZUdvZXJsaTogKCkgPT4gYmFzZUdvZXJsaSwKICAgIGJhc2VTZXBvbGlhOiAoKSA9PiBiYXNlU2Vwb2xpYSwKICAgIGJlYW06ICgpID0+IGJlYW0sCiAgICBiZWFtVGVzdG5ldDogKCkgPT4gYmVhbVRlc3RuZXQsCiAgICBiZWFyTmV0d29ya0NoYWluTWFpbm5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpbk1haW5uZXQsCiAgICBiZWFyTmV0d29ya0NoYWluVGVzdG5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpblRlc3RuZXQsCiAgICBiZXJhY2hhaW5UZXN0bmV0OiAoKSA9PiBiZXJhY2hhaW5UZXN0bmV0LAogICAgYmVyYWNoYWluVGVzdG5ldGJBcnRpbzogKCkgPT4gYmVyYWNoYWluVGVzdG5ldGJBcnRpbywKICAgIGJldm1NYWlubmV0OiAoKSA9PiBiZXZtTWFpbm5ldCwKICAgIGJpZnJvc3Q6ICgpID0+IGJpZnJvc3QsCiAgICBiaXRUb3JyZW50OiAoKSA9PiBiaXRUb3JyZW50LAogICAgYml0VG9ycmVudFRlc3RuZXQ6ICgpID0+IGJpdFRvcnJlbnRUZXN0bmV0LAogICAgYml0a3ViOiAoKSA9PiBiaXRrdWIsCiAgICBiaXRrdWJUZXN0bmV0OiAoKSA9PiBiaXRrdWJUZXN0bmV0LAogICAgYml0bGF5ZXI6ICgpID0+IGJpdGxheWVyLAogICAgYml0bGF5ZXJUZXN0bmV0OiAoKSA9PiBiaXRsYXllclRlc3RuZXQsCiAgICBiaXRyb2NrOiAoKSA9PiBiaXRyb2NrLAogICAgYmxhc3Q6ICgpID0+IGJsYXN0LAogICAgYmxhc3RTZXBvbGlhOiAoKSA9PiBibGFzdFNlcG9saWEsCiAgICBib2I6ICgpID0+IGJvYiwKICAgIGJvYlNlcG9saWE6ICgpID0+IGJvYlNlcG9saWEsCiAgICBib2JhOiAoKSA9PiBib2JhLAogICAgYm9iYVNlcG9saWE6ICgpID0+IGJvYmFTZXBvbGlhLAogICAgYm90YW5peFRlc3RuZXQ6ICgpID0+IGJvdGFuaXhUZXN0bmV0LAogICAgYm91bmNlQml0OiAoKSA9PiBib3VuY2VCaXQsCiAgICBib3VuY2VCaXRUZXN0bmV0OiAoKSA9PiBib3VuY2VCaXRUZXN0bmV0LAogICAgYnJvbm9zOiAoKSA9PiBicm9ub3MsCiAgICBicm9ub3NUZXN0bmV0OiAoKSA9PiBicm9ub3NUZXN0bmV0LAogICAgYnNjOiAoKSA9PiBic2MsCiAgICBic2NHcmVlbmZpZWxkOiAoKSA9PiBic2NHcmVlbmZpZWxkLAogICAgYnNjVGVzdG5ldDogKCkgPT4gYnNjVGVzdG5ldCwKICAgIGJzcXVhcmVkOiAoKSA9PiBic3F1YXJlZCwKICAgIGJzcXVhcmVkVGVzdG5ldDogKCkgPT4gYnNxdWFyZWRUZXN0bmV0LAogICAgYnRyOiAoKSA9PiBidHIsCiAgICBidHJUZXN0bmV0OiAoKSA9PiBidHJUZXN0bmV0LAogICAgYnhuOiAoKSA9PiBieG4sCiAgICBieG5UZXN0bmV0OiAoKSA9PiBieG5UZXN0bmV0LAogICAgY2Fubm9uOiAoKSA9PiBjYW5ub24sCiAgICBjYW50bzogKCkgPT4gY2FudG8sCiAgICBjZWxvOiAoKSA9PiBjZWxvLAogICAgY2Vsb0FsZmFqb3JlczogKCkgPT4gY2Vsb0FsZmFqb3JlcywKICAgIGNoYW5nOiAoKSA9PiBjaGFuZywKICAgIGNoaWxpejogKCkgPT4gY2hpbGl6LAogICAgY2hpcHM6ICgpID0+IGNoaXBzLAogICAgY2xhc3NpYzogKCkgPT4gY2xhc3NpYywKICAgIGNvbmZsdXhFU3BhY2U6ICgpID0+IGNvbmZsdXhFU3BhY2UsCiAgICBjb25mbHV4RVNwYWNlVGVzdG5ldDogKCkgPT4gY29uZmx1eEVTcGFjZVRlc3RuZXQsCiAgICBjb3JlRGFvOiAoKSA9PiBjb3JlRGFvLAogICAgY3JhYjogKCkgPT4gY3JhYiwKICAgIGNyb25vczogKCkgPT4gY3Jvbm9zLAogICAgY3Jvbm9zVGVzdG5ldDogKCkgPT4gY3Jvbm9zVGVzdG5ldCwKICAgIGNyb25vc3prRVZNOiAoKSA9PiBjcm9ub3N6a0VWTSwKICAgIGNyb25vc3prRVZNVGVzdG5ldDogKCkgPT4gY3Jvbm9zemtFVk1UZXN0bmV0LAogICAgY3Jvc3NiZWxsOiAoKSA9PiBjcm9zc2JlbGwsCiAgICBjdXJ0aXM6ICgpID0+IGN1cnRpcywKICAgIGN5YmVyOiAoKSA9PiBjeWJlciwKICAgIGN5YmVyVGVzdG5ldDogKCkgPT4gY3liZXJUZXN0bmV0LAogICAgZGFyd2luaWE6ICgpID0+IGRhcndpbmlhLAogICAgZGNoYWluOiAoKSA9PiBkY2hhaW4sCiAgICBkY2hhaW5UZXN0bmV0OiAoKSA9PiBkY2hhaW5UZXN0bmV0LAogICAgZGVmaWNoYWluRXZtOiAoKSA9PiBkZWZpY2hhaW5Fdm0sCiAgICBkZWZpY2hhaW5Fdm1UZXN0bmV0OiAoKSA9PiBkZWZpY2hhaW5Fdm1UZXN0bmV0LAogICAgZGVnZW46ICgpID0+IGRlZ2VuLAogICAgZGZrOiAoKSA9PiBkZmssCiAgICBkb2RvY2hhaW5UZXN0bmV0OiAoKSA9PiBkb2RvY2hhaW5UZXN0bmV0LAogICAgZG9nZWNoYWluOiAoKSA9PiBkb2dlY2hhaW4sCiAgICBkb3NDaGFpbjogKCkgPT4gZG9zQ2hhaW4sCiAgICBkb3NDaGFpblRlc3RuZXQ6ICgpID0+IGRvc0NoYWluVGVzdG5ldCwKICAgIGRyZXllcnhNYWlubmV0OiAoKSA9PiBkcmV5ZXJ4TWFpbm5ldCwKICAgIGRyZXllcnhUZXN0bmV0OiAoKSA9PiBkcmV5ZXJ4VGVzdG5ldCwKICAgIGR1c3Rib3lJb1Q6ICgpID0+IGR1c3Rib3lJb1QsCiAgICBkeW1lbnNpb246ICgpID0+IGR5bWVuc2lvbiwKICAgIGVkZ2VsZXNzOiAoKSA9PiBlZGdlbGVzcywKICAgIGVkZ2VsZXNzVGVzdG5ldDogKCkgPT4gZWRnZWxlc3NUZXN0bmV0LAogICAgZWRnZXdhcmU6ICgpID0+IGVkZ2V3YXJlLAogICAgZWRnZXdhcmVUZXN0bmV0OiAoKSA9PiBlZGdld2FyZVRlc3RuZXQsCiAgICBla3RhOiAoKSA9PiBla3RhLAogICAgZWt0YVRlc3RuZXQ6ICgpID0+IGVrdGFUZXN0bmV0LAogICAgZWxhc3RvczogKCkgPT4gZWxhc3RvcywKICAgIGVsYXN0b3NUZXN0bmV0OiAoKSA9PiBlbGFzdG9zVGVzdG5ldCwKICAgIGVsZWN0cm9uZXVtOiAoKSA9PiBlbGVjdHJvbmV1bSwKICAgIGVsZWN0cm9uZXVtVGVzdG5ldDogKCkgPT4gZWxlY3Ryb25ldW1UZXN0bmV0LAogICAgZWx5c2l1bVRlc3RuZXQ6ICgpID0+IGVseXNpdW1UZXN0bmV0LAogICAgZW9uOiAoKSA9PiBlb24sCiAgICBlb3M6ICgpID0+IGVvcywKICAgIGVvc1Rlc3RuZXQ6ICgpID0+IGVvc1Rlc3RuZXQsCiAgICBldGhlcmxpbms6ICgpID0+IGV0aGVybGluaywKICAgIGV0aGVybGlua1Rlc3RuZXQ6ICgpID0+IGV0aGVybGlua1Rlc3RuZXQsCiAgICBldm1vczogKCkgPT4gZXZtb3MsCiAgICBldm1vc1Rlc3RuZXQ6ICgpID0+IGV2bW9zVGVzdG5ldCwKICAgIGV4Y2Vsb25NYWlubmV0OiAoKSA9PiBleGNlbG9uTWFpbm5ldCwKICAgIGZhbnRvbTogKCkgPT4gZmFudG9tLAogICAgZmFudG9tU29uaWNUZXN0bmV0OiAoKSA9PiBmYW50b21Tb25pY1Rlc3RuZXQsCiAgICBmYW50b21UZXN0bmV0OiAoKSA9PiBmYW50b21UZXN0bmV0LAogICAgZmlibzogKCkgPT4gZmlibywKICAgIGZpbGVjb2luOiAoKSA9PiBmaWxlY29pbiwKICAgIGZpbGVjb2luQ2FsaWJyYXRpb246ICgpID0+IGZpbGVjb2luQ2FsaWJyYXRpb24sCiAgICBmaWxlY29pbkh5cGVyc3BhY2U6ICgpID0+IGZpbGVjb2luSHlwZXJzcGFjZSwKICAgIGZsYXJlOiAoKSA9PiBmbGFyZSwKICAgIGZsYXJlVGVzdG5ldDogKCkgPT4gZmxhcmVUZXN0bmV0LAogICAgZmxvd01haW5uZXQ6ICgpID0+IGZsb3dNYWlubmV0LAogICAgZmxvd1ByZXZpZXduZXQ6ICgpID0+IGZsb3dQcmV2aWV3bmV0LAogICAgZmxvd1Rlc3RuZXQ6ICgpID0+IGZsb3dUZXN0bmV0LAogICAgZmx1ZW5jZTogKCkgPT4gZmx1ZW5jZSwKICAgIGZsdWVuY2VTdGFnZTogKCkgPT4gZmx1ZW5jZVN0YWdlLAogICAgZmx1ZW5jZVRlc3RuZXQ6ICgpID0+IGZsdWVuY2VUZXN0bmV0LAogICAgZm9ybWE6ICgpID0+IGZvcm1hLAogICAgZm91bmRyeTogKCkgPT4gZm91bmRyeSwKICAgIGZyYXh0YWw6ICgpID0+IGZyYXh0YWwsCiAgICBmcmF4dGFsVGVzdG5ldDogKCkgPT4gZnJheHRhbFRlc3RuZXQsCiAgICBmdW5raU1haW5uZXQ6ICgpID0+IGZ1bmtpTWFpbm5ldCwKICAgIGZ1bmtpU2Vwb2xpYTogKCkgPT4gZnVua2lTZXBvbGlhLAogICAgZnVzZTogKCkgPT4gZnVzZSwKICAgIGZ1c2VTcGFya25ldDogKCkgPT4gZnVzZVNwYXJrbmV0LAogICAgZnVzaW9uOiAoKSA9PiBmdXNpb24sCiAgICBmdXNpb25UZXN0bmV0OiAoKSA9PiBmdXNpb25UZXN0bmV0LAogICAgZ2FybmV0OiAoKSA9PiBnYXJuZXQsCiAgICBnZW5lc3lzOiAoKSA9PiBnZW5lc3lzLAogICAgZ2xpZGVMMVByb3RvY29sOiAoKSA9PiBnbGlkZUwxUHJvdG9jb2wsCiAgICBnbGlkZUwyUHJvdG9jb2w6ICgpID0+IGdsaWRlTDJQcm90b2NvbCwKICAgIGdub3NpczogKCkgPT4gZ25vc2lzLAogICAgZ25vc2lzQ2hpYWRvOiAoKSA9PiBnbm9zaXNDaGlhZG8sCiAgICBnb0NoYWluOiAoKSA9PiBnb0NoYWluLAogICAgZ29iaTogKCkgPT4gZ29iaSwKICAgIGdvZHdva2VuOiAoKSA9PiBnb2R3b2tlbiwKICAgIGdvZXJsaTogKCkgPT4gZ29lcmxpLAogICAgZ3Jhdml0eTogKCkgPT4gZ3Jhdml0eSwKICAgIGd1cnVUZXN0bmV0OiAoKSA9PiBndXJ1VGVzdG5ldCwKICAgIGhhbTogKCkgPT4gaGFtLAogICAgaGFxcU1haW5uZXQ6ICgpID0+IGhhcXFNYWlubmV0LAogICAgaGFxcVRlc3RlZGdlMjogKCkgPT4gaGFxcVRlc3RlZGdlMiwKICAgIGhhcmRoYXQ6ICgpID0+IGhhcmRoYXQsCiAgICBoYXJtb255T25lOiAoKSA9PiBoYXJtb255T25lLAogICAgaGFzaGtleVRlc3RuZXQ6ICgpID0+IGhhc2hrZXlUZXN0bmV0LAogICAgaGVkZXJhOiAoKSA9PiBoZWRlcmEsCiAgICBoZWRlcmFQcmV2aWV3bmV0OiAoKSA9PiBoZWRlcmFQcmV2aWV3bmV0LAogICAgaGVkZXJhVGVzdG5ldDogKCkgPT4gaGVkZXJhVGVzdG5ldCwKICAgIGhlbGE6ICgpID0+IGhlbGEsCiAgICBoZW1pU2Vwb2xpYTogKCkgPT4gaGVtaVNlcG9saWEsCiAgICBob2xlc2t5OiAoKSA9PiBob2xlc2t5LAogICAgaHljaGFpbjogKCkgPT4gaHljaGFpbiwKICAgIGh5Y2hhaW5UZXN0bmV0OiAoKSA9PiBoeWNoYWluVGVzdG5ldCwKICAgIGltbXV0YWJsZVprRXZtOiAoKSA9PiBpbW11dGFibGVaa0V2bSwKICAgIGltbXV0YWJsZVprRXZtVGVzdG5ldDogKCkgPT4gaW1tdXRhYmxlWmtFdm1UZXN0bmV0LAogICAgaW5FVk06ICgpID0+IGluRVZNLAogICAgaW5rU2Vwb2xpYTogKCkgPT4gaW5rU2Vwb2xpYSwKICAgIGlvdGE6ICgpID0+IGlvdGEsCiAgICBpb3RhVGVzdG5ldDogKCkgPT4gaW90YVRlc3RuZXQsCiAgICBpb3RleDogKCkgPT4gaW90ZXgsCiAgICBpb3RleFRlc3RuZXQ6ICgpID0+IGlvdGV4VGVzdG5ldCwKICAgIGpiYzogKCkgPT4gamJjLAogICAgamJjVGVzdG5ldDogKCkgPT4gamJjVGVzdG5ldCwKICAgIGthaWE6ICgpID0+IGthaWEsCiAgICBrYWlyb3M6ICgpID0+IGthaXJvcywKICAgIGtha2Fyb3RTZXBvbGlhOiAoKSA9PiBrYWthcm90U2Vwb2xpYSwKICAgIGtha2Fyb3RTdGFya25ldFNlcG9saWE6ICgpID0+IGtha2Fyb3RTdGFya25ldFNlcG9saWEsCiAgICBrYXJkaWFDaGFpbjogKCkgPT4ga2FyZGlhQ2hhaW4sCiAgICBrYXJ1cmE6ICgpID0+IGthcnVyYSwKICAgIGthdmE6ICgpID0+IGthdmEsCiAgICBrYXZhVGVzdG5ldDogKCkgPT4ga2F2YVRlc3RuZXQsCiAgICBrY2M6ICgpID0+IGtjYywKICAgIGtpbnRvOiAoKSA9PiBraW50bywKICAgIGtsYXl0bjogKCkgPT4ga2xheXRuLAogICAga2xheXRuQmFvYmFiOiAoKSA9PiBrbGF5dG5CYW9iYWIsCiAgICBrb2k6ICgpID0+IGtvaSwKICAgIGtyb21hOiAoKSA9PiBrcm9tYSwKICAgIGtyb21hU2Vwb2xpYTogKCkgPT4ga3JvbWFTZXBvbGlhLAogICAgbDN4OiAoKSA9PiBsM3gsCiAgICBsM3hUZXN0bmV0OiAoKSA9PiBsM3hUZXN0bmV0LAogICAgbGF2aXRhOiAoKSA9PiBsYXZpdGEsCiAgICBsaWdodGxpbmtQZWdhc3VzOiAoKSA9PiBsaWdodGxpbmtQZWdhc3VzLAogICAgbGlnaHRsaW5rUGhvZW5peDogKCkgPT4gbGlnaHRsaW5rUGhvZW5peCwKICAgIGxpbmVhOiAoKSA9PiBsaW5lYSwKICAgIGxpbmVhR29lcmxpOiAoKSA9PiBsaW5lYUdvZXJsaSwKICAgIGxpbmVhU2Vwb2xpYTogKCkgPT4gbGluZWFTZXBvbGlhLAogICAgbGluZWFUZXN0bmV0OiAoKSA9PiBsaW5lYVRlc3RuZXQsCiAgICBsaXNrOiAoKSA9PiBsaXNrLAogICAgbGlza1NlcG9saWE6ICgpID0+IGxpc2tTZXBvbGlhLAogICAgbG9jYWxob3N0OiAoKSA9PiBsb2NhbGhvc3QsCiAgICBsb29wOiAoKSA9PiBsb29wLAogICAgbHVrc286ICgpID0+IGx1a3NvLAogICAgbHVrc29UZXN0bmV0OiAoKSA9PiBsdWtzb1Rlc3RuZXQsCiAgICBseWNhbjogKCkgPT4gbHljYW4sCiAgICBseXJhOiAoKSA9PiBseXJhLAogICAgbWFpbm5ldDogKCkgPT4gbWFpbm5ldCwKICAgIG1hbmRhbGE6ICgpID0+IG1hbmRhbGEsCiAgICBtYW50YTogKCkgPT4gbWFudGEsCiAgICBtYW50YVNlcG9saWFUZXN0bmV0OiAoKSA9PiBtYW50YVNlcG9saWFUZXN0bmV0LAogICAgbWFudGFUZXN0bmV0OiAoKSA9PiBtYW50YVRlc3RuZXQsCiAgICBtYW50bGU6ICgpID0+IG1hbnRsZSwKICAgIG1hbnRsZVNlcG9saWFUZXN0bmV0OiAoKSA9PiBtYW50bGVTZXBvbGlhVGVzdG5ldCwKICAgIG1hbnRsZVRlc3RuZXQ6ICgpID0+IG1hbnRsZVRlc3RuZXQsCiAgICBtYXBQcm90b2NvbDogKCkgPT4gbWFwUHJvdG9jb2wsCiAgICBtYXRjaGFpbjogKCkgPT4gbWF0Y2hhaW4sCiAgICBtYXRjaGFpblRlc3RuZXQ6ICgpID0+IG1hdGNoYWluVGVzdG5ldCwKICAgIG1lbGQ6ICgpID0+IG1lbGQsCiAgICBtZXJsaW46ICgpID0+IG1lcmxpbiwKICAgIG1ldGFjaGFpbjogKCkgPT4gbWV0YWNoYWluLAogICAgbWV0YWNoYWluSXN0YW5idWw6ICgpID0+IG1ldGFjaGFpbklzdGFuYnVsLAogICAgbWV0YWxMMjogKCkgPT4gbWV0YWxMMiwKICAgIG1ldGVyOiAoKSA9PiBtZXRlciwKICAgIG1ldGVyVGVzdG5ldDogKCkgPT4gbWV0ZXJUZXN0bmV0LAogICAgbWV0aXM6ICgpID0+IG1ldGlzLAogICAgbWV0aXNHb2VybGk6ICgpID0+IG1ldGlzR29lcmxpLAogICAgbWV2OiAoKSA9PiBtZXYsCiAgICBtZXZUZXN0bmV0OiAoKSA9PiBtZXZUZXN0bmV0LAogICAgbWludDogKCkgPT4gbWludCwKICAgIG1pbnRTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWludFNlcG9saWFUZXN0bmV0LAogICAgbW9kZTogKCkgPT4gbW9kZSwKICAgIG1vZGVUZXN0bmV0OiAoKSA9PiBtb2RlVGVzdG5ldCwKICAgIG1vb25iYXNlQWxwaGE6ICgpID0+IG1vb25iYXNlQWxwaGEsCiAgICBtb29uYmVhbTogKCkgPT4gbW9vbmJlYW0sCiAgICBtb29uYmVhbURldjogKCkgPT4gbW9vbmJlYW1EZXYsCiAgICBtb29ucml2ZXI6ICgpID0+IG1vb25yaXZlciwKICAgIG1vcnBoOiAoKSA9PiBtb3JwaCwKICAgIG1vcnBoSG9sZXNreTogKCkgPT4gbW9ycGhIb2xlc2t5LAogICAgbW9ycGhTZXBvbGlhOiAoKSA9PiBtb3JwaFNlcG9saWEsCiAgICBuYXV0aWx1czogKCkgPT4gbmF1dGlsdXMsCiAgICBuZW9uRGV2bmV0OiAoKSA9PiBuZW9uRGV2bmV0LAogICAgbmVvbk1haW5uZXQ6ICgpID0+IG5lb25NYWlubmV0LAogICAgbmV4aTogKCkgPT4gbmV4aSwKICAgIG5leGlsaXg6ICgpID0+IG5leGlsaXgsCiAgICBvYXNpc1Rlc3RuZXQ6ICgpID0+IG9hc2lzVGVzdG5ldCwKICAgIG9hc3lzOiAoKSA9PiBvYXN5cywKICAgIG9keXNzZXlUZXN0bmV0OiAoKSA9PiBvZHlzc2V5VGVzdG5ldCwKICAgIG9rYzogKCkgPT4gb2tjLAogICAgb29ydE1haW5uZXREZXY6ICgpID0+IG9vcnRNYWlubmV0RGV2LAogICAgb3BCTkI6ICgpID0+IG9wQk5CLAogICAgb3BCTkJUZXN0bmV0OiAoKSA9PiBvcEJOQlRlc3RuZXQsCiAgICBvcHRpbWlzbTogKCkgPT4gb3B0aW1pc20sCiAgICBvcHRpbWlzbUdvZXJsaTogKCkgPT4gb3B0aW1pc21Hb2VybGksCiAgICBvcHRpbWlzbVNlcG9saWE6ICgpID0+IG9wdGltaXNtU2Vwb2xpYSwKICAgIG9wdG9waWE6ICgpID0+IG9wdG9waWEsCiAgICBvcHRvcGlhVGVzdG5ldDogKCkgPT4gb3B0b3BpYVRlc3RuZXQsCiAgICBvcmRlcmx5OiAoKSA9PiBvcmRlcmx5LAogICAgb3JkZXJseVNlcG9saWE6ICgpID0+IG9yZGVybHlTZXBvbGlhLAogICAgb3RpbURldm5ldDogKCkgPT4gb3RpbURldm5ldCwKICAgIHBhbG06ICgpID0+IHBhbG0sCiAgICBwYWxtVGVzdG5ldDogKCkgPT4gcGFsbVRlc3RuZXQsCiAgICBwZ246ICgpID0+IHBnbiwKICAgIHBnblRlc3RuZXQ6ICgpID0+IHBnblRlc3RuZXQsCiAgICBwaG9lbml4OiAoKSA9PiBwaG9lbml4LAogICAgcGxheWZpQWxiaXJlbzogKCkgPT4gcGxheWZpQWxiaXJlbywKICAgIHBsaW5nYTogKCkgPT4gcGxpbmdhLAogICAgcGx1bWVUZXN0bmV0OiAoKSA9PiBwbHVtZVRlc3RuZXQsCiAgICBwb2x5Z29uOiAoKSA9PiBwb2x5Z29uLAogICAgcG9seWdvbkFtb3k6ICgpID0+IHBvbHlnb25BbW95LAogICAgcG9seWdvbk11bWJhaTogKCkgPT4gcG9seWdvbk11bWJhaSwKICAgIHBvbHlnb25aa0V2bTogKCkgPT4gcG9seWdvblprRXZtLAogICAgcG9seWdvblprRXZtQ2FyZG9uYTogKCkgPT4gcG9seWdvblprRXZtQ2FyZG9uYSwKICAgIHBvbHlnb25aa0V2bVRlc3RuZXQ6ICgpID0+IHBvbHlnb25aa0V2bVRlc3RuZXQsCiAgICBwdWxzZWNoYWluOiAoKSA9PiBwdWxzZWNoYWluLAogICAgcHVsc2VjaGFpblY0OiAoKSA9PiBwdWxzZWNoYWluVjQsCiAgICBxTWFpbm5ldDogKCkgPT4gcU1haW5uZXQsCiAgICBxVGVzdG5ldDogKCkgPT4gcVRlc3RuZXQsCiAgICBxbDE6ICgpID0+IHFsMSwKICAgIHJlYWw6ICgpID0+IHJlYWwsCiAgICByZWRiZWxseVRlc3RuZXQ6ICgpID0+IHJlZGJlbGx5VGVzdG5ldCwKICAgIHJlZHN0b25lOiAoKSA9PiByZWRzdG9uZSwKICAgIHJleWFOZXR3b3JrOiAoKSA9PiByZXlhTmV0d29yaywKICAgIHJvbGx1eDogKCkgPT4gcm9sbHV4LAogICAgcm9sbHV4VGVzdG5ldDogKCkgPT4gcm9sbHV4VGVzdG5ldCwKICAgIHJvbmluOiAoKSA9PiByb25pbiwKICAgIHJvb3Q6ICgpID0+IHJvb3QsCiAgICByb290UG9yY2luaTogKCkgPT4gcm9vdFBvcmNpbmksCiAgICByb290c3RvY2s6ICgpID0+IHJvb3RzdG9jaywKICAgIHJvb3RzdG9ja1Rlc3RuZXQ6ICgpID0+IHJvb3RzdG9ja1Rlc3RuZXQsCiAgICByc3MzOiAoKSA9PiByc3MzLAogICAgcnNzM1NlcG9saWE6ICgpID0+IHJzczNTZXBvbGlhLAogICAgc2Fha3VydTogKCkgPT4gc2Fha3VydSwKICAgIHNhaWdvbjogKCkgPT4gc2FpZ29uLAogICAgc2Fua286ICgpID0+IHNhbmtvLAogICAgc2FwcGhpcmU6ICgpID0+IHNhcHBoaXJlLAogICAgc2FwcGhpcmVUZXN0bmV0OiAoKSA9PiBzYXBwaGlyZVRlc3RuZXQsCiAgICBzYXRvc2hpVk06ICgpID0+IHNhdG9zaGlWTSwKICAgIHNhdG9zaGlWTVRlc3RuZXQ6ICgpID0+IHNhdG9zaGlWTVRlc3RuZXQsCiAgICBzY3JvbGw6ICgpID0+IHNjcm9sbCwKICAgIHNjcm9sbFNlcG9saWE6ICgpID0+IHNjcm9sbFNlcG9saWEsCiAgICBzZWk6ICgpID0+IHNlaSwKICAgIHNlaURldm5ldDogKCkgPT4gc2VpRGV2bmV0LAogICAgc2VpVGVzdG5ldDogKCkgPT4gc2VpVGVzdG5ldCwKICAgIHNlcG9saWE6ICgpID0+IHNlcG9saWEsCiAgICBzaGFwZTogKCkgPT4gc2hhcGUsCiAgICBzaGFwZVNlcG9saWE6ICgpID0+IHNoYXBlU2Vwb2xpYSwKICAgIHNoYXJkZXVtU3BoaW54OiAoKSA9PiBzaGFyZGV1bVNwaGlueCwKICAgIHNoaWJhcml1bTogKCkgPT4gc2hpYmFyaXVtLAogICAgc2hpYmFyaXVtVGVzdG5ldDogKCkgPT4gc2hpYmFyaXVtVGVzdG5ldCwKICAgIHNoaWRlbjogKCkgPT4gc2hpZGVuLAogICAgc2hpbW1lcjogKCkgPT4gc2hpbW1lciwKICAgIHNoaW1tZXJUZXN0bmV0OiAoKSA9PiBzaGltbWVyVGVzdG5ldCwKICAgIHNpbGljb246ICgpID0+IHNpbGljb24sCiAgICBzaWxpY29uU2Vwb2xpYTogKCkgPT4gc2lsaWNvblNlcG9saWEsCiAgICBza2FsZUJsb2NrQnJhd2xlcnM6ICgpID0+IHNrYWxlQmxvY2tCcmF3bGVycywKICAgIHNrYWxlQ2FseXBzbzogKCkgPT4gc2thbGVDYWx5cHNvLAogICAgc2thbGVDYWx5cHNvVGVzdG5ldDogKCkgPT4gc2thbGVDYWx5cHNvVGVzdG5ldCwKICAgIHNrYWxlQ3J5cHRvQmxhZGVzOiAoKSA9PiBza2FsZUNyeXB0b0JsYWRlcywKICAgIHNrYWxlQ3J5cHRvQ29sb3NzZXVtOiAoKSA9PiBza2FsZUNyeXB0b0NvbG9zc2V1bSwKICAgIHNrYWxlRXVyb3BhOiAoKSA9PiBza2FsZUV1cm9wYSwKICAgIHNrYWxlRXVyb3BhVGVzdG5ldDogKCkgPT4gc2thbGVFdXJvcGFUZXN0bmV0LAogICAgc2thbGVFeG9yZGU6ICgpID0+IHNrYWxlRXhvcmRlLAogICAgc2thbGVIdW1hblByb3RvY29sOiAoKSA9PiBza2FsZUh1bWFuUHJvdG9jb2wsCiAgICBza2FsZU5lYnVsYTogKCkgPT4gc2thbGVOZWJ1bGEsCiAgICBza2FsZU5lYnVsYVRlc3RuZXQ6ICgpID0+IHNrYWxlTmVidWxhVGVzdG5ldCwKICAgIHNrYWxlUmF6b3I6ICgpID0+IHNrYWxlUmF6b3IsCiAgICBza2FsZVRpdGFuOiAoKSA9PiBza2FsZVRpdGFuLAogICAgc2thbGVUaXRhblRlc3RuZXQ6ICgpID0+IHNrYWxlVGl0YW5UZXN0bmV0LAogICAgc2tldGNocGFkOiAoKSA9PiBza2V0Y2hwYWQsCiAgICBzbmF4OiAoKSA9PiBzbmF4LAogICAgc25heFRlc3RuZXQ6ICgpID0+IHNuYXhUZXN0bmV0LAogICAgc29uZWl1bU1pbmF0bzogKCkgPT4gc29uZWl1bU1pbmF0bywKICAgIHNvbmdiaXJkOiAoKSA9PiBzb25nYmlyZCwKICAgIHNvbmdiaXJkVGVzdG5ldDogKCkgPT4gc29uZ2JpcmRUZXN0bmV0LAogICAgc29waG9uVGVzdG5ldDogKCkgPT4gc29waG9uVGVzdG5ldCwKICAgIHNwaWN5OiAoKSA9PiBzcGljeSwKICAgIHN0ZXA6ICgpID0+IHN0ZXAsCiAgICBzdG9yeVRlc3RuZXQ6ICgpID0+IHN0b3J5VGVzdG5ldCwKICAgIHN0cmF0aXM6ICgpID0+IHN0cmF0aXMsCiAgICBzdXBlcmx1bWlvOiAoKSA9PiBzdXBlcmx1bWlvLAogICAgc3VwZXJwb3NpdGlvbjogKCkgPT4gc3VwZXJwb3NpdGlvbiwKICAgIHN3YW46ICgpID0+IHN3YW4sCiAgICBzd2FuUHJveGltYVRlc3RuZXQ6ICgpID0+IHN3YW5Qcm94aW1hVGVzdG5ldCwKICAgIHN3YW5TYXR1cm5UZXN0bmV0OiAoKSA9PiBzd2FuU2F0dXJuVGVzdG5ldCwKICAgIHN5c2NvaW46ICgpID0+IHN5c2NvaW4sCiAgICBzeXNjb2luVGVzdG5ldDogKCkgPT4gc3lzY29pblRlc3RuZXQsCiAgICB0YWlrbzogKCkgPT4gdGFpa28sCiAgICB0YWlrb0hla2xhOiAoKSA9PiB0YWlrb0hla2xhLAogICAgdGFpa29Kb2xuaXI6ICgpID0+IHRhaWtvSm9sbmlyLAogICAgdGFpa29LYXRsYTogKCkgPT4gdGFpa29LYXRsYSwKICAgIHRhaWtvVGVzdG5ldFNlcG9saWE6ICgpID0+IHRhaWtvVGVzdG5ldFNlcG9saWEsCiAgICB0YXJheGE6ICgpID0+IHRhcmF4YSwKICAgIHRhcmF4YVRlc3RuZXQ6ICgpID0+IHRhcmF4YVRlc3RuZXQsCiAgICB0ZWxjb2luVGVzdG5ldDogKCkgPT4gdGVsY29pblRlc3RuZXQsCiAgICB0ZWxvczogKCkgPT4gdGVsb3MsCiAgICB0ZWxvc1Rlc3RuZXQ6ICgpID0+IHRlbG9zVGVzdG5ldCwKICAgIHRlbmV0OiAoKSA9PiB0ZW5ldCwKICAgIHRoYWlDaGFpbjogKCkgPT4gdGhhaUNoYWluLAogICAgdGhhdDogKCkgPT4gdGhhdCwKICAgIHRoZXRhOiAoKSA9PiB0aGV0YSwKICAgIHRoZXRhVGVzdG5ldDogKCkgPT4gdGhldGFUZXN0bmV0LAogICAgdGh1bmRlckNvcmU6ICgpID0+IHRodW5kZXJDb3JlLAogICAgdGh1bmRlclRlc3RuZXQ6ICgpID0+IHRodW5kZXJUZXN0bmV0LAogICAgdGlrdHJpeFRlc3RuZXQ6ICgpID0+IHRpa3RyaXhUZXN0bmV0LAogICAgdG9tYjogKCkgPT4gdG9tYiwKICAgIHRyb246ICgpID0+IHRyb24sCiAgICB1bHRyb246ICgpID0+IHVsdHJvbiwKICAgIHVsdHJvblRlc3RuZXQ6ICgpID0+IHVsdHJvblRlc3RuZXQsCiAgICB1bmljaGFpblNlcG9saWE6ICgpID0+IHVuaWNoYWluU2Vwb2xpYSwKICAgIHVuaXF1ZTogKCkgPT4gdW5pcXVlLAogICAgdW5pcXVlT3BhbDogKCkgPT4gdW5pcXVlT3BhbCwKICAgIHVuaXF1ZVF1YXJ0ejogKCkgPT4gdW5pcXVlUXVhcnR6LAogICAgdW5yZWFsOiAoKSA9PiB1bnJlYWwsCiAgICB2ZWNoYWluOiAoKSA9PiB2ZWNoYWluLAogICAgdmVsYXM6ICgpID0+IHZlbGFzLAogICAgdmljdGlvbjogKCkgPT4gdmljdGlvbiwKICAgIHZpY3Rpb25UZXN0bmV0OiAoKSA9PiB2aWN0aW9uVGVzdG5ldCwKICAgIHZpc2lvbjogKCkgPT4gdmlzaW9uLAogICAgdmlzaW9uVGVzdG5ldDogKCkgPT4gdmlzaW9uVGVzdG5ldCwKICAgIHdhbmNoYWluOiAoKSA9PiB3YW5jaGFpbiwKICAgIHdhbmNoYWluVGVzdG5ldDogKCkgPT4gd2FuY2hhaW5UZXN0bmV0LAogICAgd2VhdmVWTUFscGhhbmV0OiAoKSA9PiB3ZWF2ZVZNQWxwaGFuZXQsCiAgICB3ZW1peDogKCkgPT4gd2VtaXgsCiAgICB3ZW1peFRlc3RuZXQ6ICgpID0+IHdlbWl4VGVzdG5ldCwKICAgIHdvcmxkY2hhaW46ICgpID0+IHdvcmxkY2hhaW4sCiAgICB3b3JsZGNoYWluU2Vwb2xpYTogKCkgPT4gd29ybGRjaGFpblNlcG9saWEsCiAgICB4MVRlc3RuZXQ6ICgpID0+IHhMYXllclRlc3RuZXQsCiAgICB4TGF5ZXI6ICgpID0+IHhMYXllciwKICAgIHhMYXllclRlc3RuZXQ6ICgpID0+IHhMYXllclRlc3RuZXQsCiAgICB4YWk6ICgpID0+IHhhaSwKICAgIHhhaVRlc3RuZXQ6ICgpID0+IHhhaVRlc3RuZXQsCiAgICB4ZGM6ICgpID0+IHhkYywKICAgIHhkY1Rlc3RuZXQ6ICgpID0+IHhkY1Rlc3RuZXQsCiAgICB4clNlcG9saWE6ICgpID0+IHhyU2Vwb2xpYSwKICAgIHlvb2xkb1ZlcnNlOiAoKSA9PiB5b29sZG9WZXJzZSwKICAgIHlvb2xkb1ZlcnNlVGVzdG5ldDogKCkgPT4geW9vbGRvVmVyc2VUZXN0bmV0LAogICAgemVuY2hhaW5UZXN0bmV0OiAoKSA9PiB6ZW5jaGFpblRlc3RuZXQsCiAgICB6ZW5pcTogKCkgPT4gemVuaXEsCiAgICB6ZXRhY2hhaW46ICgpID0+IHpldGFjaGFpbiwKICAgIHpldGFjaGFpbkF0aGVuc1Rlc3RuZXQ6ICgpID0+IHpldGFjaGFpbkF0aGVuc1Rlc3RuZXQsCiAgICB6aGVqaWFuZzogKCkgPT4gemhlamlhbmcsCiAgICB6aWxsaXFhOiAoKSA9PiB6aWxsaXFhLAogICAgemlsbGlxYVRlc3RuZXQ6ICgpID0+IHppbGxpcWFUZXN0bmV0LAogICAgemlyY3VpdDogKCkgPT4gemlyY3VpdCwKICAgIHppcmN1aXRUZXN0bmV0OiAoKSA9PiB6aXJjdWl0VGVzdG5ldCwKICAgIHprRmFpcjogKCkgPT4gemtGYWlyLAogICAgemtGYWlyVGVzdG5ldDogKCkgPT4gemtGYWlyVGVzdG5ldCwKICAgIHprTGlua05vdmE6ICgpID0+IHprTGlua05vdmEsCiAgICB6a0xpbmtOb3ZhU2Vwb2xpYVRlc3RuZXQ6ICgpID0+IHprTGlua05vdmFTZXBvbGlhVGVzdG5ldCwKICAgIHprU3luYzogKCkgPT4gemtzeW5jLAogICAgemtTeW5jSW5NZW1vcnlOb2RlOiAoKSA9PiB6a3N5bmNJbk1lbW9yeU5vZGUsCiAgICB6a1N5bmNMb2NhbE5vZGU6ICgpID0+IHprc3luY0xvY2FsTm9kZSwKICAgIHprU3luY1NlcG9saWFUZXN0bmV0OiAoKSA9PiB6a3N5bmNTZXBvbGlhVGVzdG5ldCwKICAgIHprc3luYzogKCkgPT4gemtzeW5jLAogICAgemtzeW5jSW5NZW1vcnlOb2RlOiAoKSA9PiB6a3N5bmNJbk1lbW9yeU5vZGUsCiAgICB6a3N5bmNMb2NhbE5vZGU6ICgpID0+IHprc3luY0xvY2FsTm9kZSwKICAgIHprc3luY1NlcG9saWFUZXN0bmV0OiAoKSA9PiB6a3N5bmNTZXBvbGlhVGVzdG5ldCwKICAgIHpvcmE6ICgpID0+IHpvcmEsCiAgICB6b3JhU2Vwb2xpYTogKCkgPT4gem9yYVNlcG9saWEsCiAgICB6b3JhVGVzdG5ldDogKCkgPT4gem9yYVRlc3RuZXQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy9mb3JtYXR0ZXJzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvY29uc3RhbnRzL251bWJlci5qcwogIGluaXRfbnVtYmVyKCk7CiAgdmFyIGdhc1BlclB1YmRhdGFEZWZhdWx0ID0gNTAwMDBuOwogIHZhciBtYXhCeXRlY29kZVNpemUgPSBtYXhVaW50MTYgKiAzMm47CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZm9ybWF0dGVycy5qcwogIHZhciBmb3JtYXR0ZXJzID0gewogICAgYmxvY2s6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVCbG9jayh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXJncy50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24gPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXR0ZXJzLnRyYW5zYWN0aW9uPy5mb3JtYXQodHJhbnNhY3Rpb24pOwogICAgICAgICAgaWYgKGZvcm1hdHRlZC50eXBlSGV4ID09PSAiMHg3MSIpCiAgICAgICAgICAgIGZvcm1hdHRlZC50eXBlID0gImVpcDcxMiI7CiAgICAgICAgICBlbHNlIGlmIChmb3JtYXR0ZWQudHlwZUhleCA9PT0gIjB4ZmYiKQogICAgICAgICAgICBmb3JtYXR0ZWQudHlwZSA9ICJwcmlvcml0eSI7CiAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBhcmdzLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hOdW1iZXIpIDogbnVsbCwKICAgICAgICAgIGwxQmF0Y2hUaW1lc3RhbXA6IGFyZ3MubDFCYXRjaFRpbWVzdGFtcCA/IGhleFRvQmlnSW50KGFyZ3MubDFCYXRjaFRpbWVzdGFtcCkgOiBudWxsLAogICAgICAgICAgdHJhbnNhY3Rpb25zCiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvbjogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHt9OwogICAgICAgIGlmIChhcmdzLnR5cGUgPT09ICIweDcxIikKICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiZWlwNzEyIjsKICAgICAgICBlbHNlIGlmIChhcmdzLnR5cGUgPT09ICIweGZmIikKICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAicHJpb3JpdHkiOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICAuLi50cmFuc2FjdGlvbiwKICAgICAgICAgIGwxQmF0Y2hOdW1iZXI6IGFyZ3MubDFCYXRjaE51bWJlciA/IGhleFRvQmlnSW50KGFyZ3MubDFCYXRjaE51bWJlcikgOiBudWxsLAogICAgICAgICAgbDFCYXRjaFR4SW5kZXg6IGFyZ3MubDFCYXRjaFR4SW5kZXggPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hUeEluZGV4KSA6IG51bGwKICAgICAgICB9OwogICAgICB9CiAgICB9KSwKICAgIHRyYW5zYWN0aW9uUmVjZWlwdDogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdCh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGwxQmF0Y2hOdW1iZXI6IGFyZ3MubDFCYXRjaE51bWJlciA/IGhleFRvQmlnSW50KGFyZ3MubDFCYXRjaE51bWJlcikgOiBudWxsLAogICAgICAgICAgbDFCYXRjaFR4SW5kZXg6IGFyZ3MubDFCYXRjaFR4SW5kZXggPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hUeEluZGV4KSA6IG51bGwsCiAgICAgICAgICBsb2dzOiBhcmdzLmxvZ3MubWFwKChsb2cpID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAuLi5mb3JtYXRMb2cobG9nKSwKICAgICAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBsb2cubDFCYXRjaE51bWJlciA/IGhleFRvQmlnSW50KGxvZy5sMUJhdGNoTnVtYmVyKSA6IG51bGwsCiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25Mb2dJbmRleDogaGV4VG9OdW1iZXIobG9nLnRyYW5zYWN0aW9uTG9nSW5kZXgpLAogICAgICAgICAgICAgIGxvZ1R5cGU6IGxvZy5sb2dUeXBlCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KSwKICAgICAgICAgIGwyVG9MMUxvZ3M6IGFyZ3MubDJUb0wxTG9ncy5tYXAoKGwyVG9MMUxvZykgPT4gewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIGJsb2NrTnVtYmVyOiBoZXhUb0JpZ0ludChsMlRvTDFMb2cuYmxvY2tIYXNoKSwKICAgICAgICAgICAgICBibG9ja0hhc2g6IGwyVG9MMUxvZy5ibG9ja0hhc2gsCiAgICAgICAgICAgICAgbDFCYXRjaE51bWJlcjogaGV4VG9CaWdJbnQobDJUb0wxTG9nLmwxQmF0Y2hOdW1iZXIpLAogICAgICAgICAgICAgIHRyYW5zYWN0aW9uSW5kZXg6IGhleFRvQmlnSW50KGwyVG9MMUxvZy50cmFuc2FjdGlvbkluZGV4KSwKICAgICAgICAgICAgICBzaGFyZElkOiBoZXhUb0JpZ0ludChsMlRvTDFMb2cuc2hhcmRJZCksCiAgICAgICAgICAgICAgaXNTZXJ2aWNlOiBsMlRvTDFMb2cuaXNTZXJ2aWNlLAogICAgICAgICAgICAgIHNlbmRlcjogbDJUb0wxTG9nLnNlbmRlciwKICAgICAgICAgICAgICBrZXk6IGwyVG9MMUxvZy5rZXksCiAgICAgICAgICAgICAgdmFsdWU6IGwyVG9MMUxvZy52YWx1ZSwKICAgICAgICAgICAgICB0cmFuc2FjdGlvbkhhc2g6IGwyVG9MMUxvZy50cmFuc2FjdGlvbkhhc2gsCiAgICAgICAgICAgICAgbG9nSW5kZXg6IGhleFRvQmlnSW50KGwyVG9MMUxvZy5sb2dJbmRleCkKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pCiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlcXVlc3Q6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QoewogICAgICBleGNsdWRlOiBbCiAgICAgICAgImN1c3RvbVNpZ25hdHVyZSIsCiAgICAgICAgImZhY3RvcnlEZXBzIiwKICAgICAgICAiZ2FzUGVyUHViZGF0YSIsCiAgICAgICAgInBheW1hc3RlciIsCiAgICAgICAgInBheW1hc3RlcklucHV0IgogICAgICBdLAogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGlmIChhcmdzLmdhc1BlclB1YmRhdGEgfHwgYXJncy5wYXltYXN0ZXIgJiYgYXJncy5wYXltYXN0ZXJJbnB1dCB8fCBhcmdzLmZhY3RvcnlEZXBzIHx8IGFyZ3MuY3VzdG9tU2lnbmF0dXJlKQogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZWlwNzEyTWV0YTogewogICAgICAgICAgICAgIC4uLmFyZ3MuZ2FzUGVyUHViZGF0YSA/IHsgZ2FzUGVyUHViZGF0YTogdG9IZXgoYXJncy5nYXNQZXJQdWJkYXRhKSB9IDogeyBnYXNQZXJQdWJkYXRhOiB0b0hleChnYXNQZXJQdWJkYXRhRGVmYXVsdCkgfSwKICAgICAgICAgICAgICAuLi5hcmdzLnBheW1hc3RlciAmJiBhcmdzLnBheW1hc3RlcklucHV0ID8gewogICAgICAgICAgICAgICAgcGF5bWFzdGVyUGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgIHBheW1hc3RlcjogYXJncy5wYXltYXN0ZXIsCiAgICAgICAgICAgICAgICAgIHBheW1hc3RlcklucHV0OiBBcnJheS5mcm9tKGhleFRvQnl0ZXMoYXJncy5wYXltYXN0ZXJJbnB1dCkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSA6IHt9LAogICAgICAgICAgICAgIC4uLmFyZ3MuZmFjdG9yeURlcHMgPyB7CiAgICAgICAgICAgICAgICBmYWN0b3J5RGVwczogYXJncy5mYWN0b3J5RGVwcy5tYXAoKGRlcCkgPT4gQXJyYXkuZnJvbShoZXhUb0J5dGVzKGRlcCkpKQogICAgICAgICAgICAgIH0gOiB7fSwKICAgICAgICAgICAgICAuLi5hcmdzLmN1c3RvbVNpZ25hdHVyZSA/IHsKICAgICAgICAgICAgICAgIGN1c3RvbVNpZ25hdHVyZTogQXJyYXkuZnJvbShoZXhUb0J5dGVzKGFyZ3MuY3VzdG9tU2lnbmF0dXJlKSkKICAgICAgICAgICAgICB9IDoge30KICAgICAgICAgICAgfSwKICAgICAgICAgICAgdHlwZTogIjB4NzEiCiAgICAgICAgICB9OwogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSkKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3NlcmlhbGl6ZXJzLmpzCiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvYXNzZXJ0RWlwNzEyVHJhbnNhY3Rpb24uanMKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9pc0FkZHJlc3MoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy9lcnJvcnMvdHJhbnNhY3Rpb24uanMKICBpbml0X2Jhc2UoKTsKICB2YXIgSW52YWxpZEVpcDcxMlRyYW5zYWN0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKFsKICAgICAgICAiVHJhbnNhY3Rpb24gaXMgbm90IGFuIEVJUDcxMiB0cmFuc2FjdGlvbi4iLAogICAgICAgICIiLAogICAgICAgICJUcmFuc2FjdGlvbiBtdXN0OiIsCiAgICAgICAgJyAgLSBpbmNsdWRlIGB0eXBlOiAiZWlwNzEyImAnLAogICAgICAgICIgIC0gaW5jbHVkZSBvbmUgb2YgdGhlIGZvbGxvd2luZzogYGN1c3RvbVNpZ25hdHVyZWAsIGBwYXltYXN0ZXJgLCBgcGF5bWFzdGVySW5wdXRgLCBgZ2FzUGVyUHViZGF0YWAsIGBmYWN0b3J5RGVwc2AiCiAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiSW52YWxpZEVpcDcxMlRyYW5zYWN0aW9uRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvaXNFaXA3MTJUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIGlzRUlQNzEyVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pIHsKICAgIGlmICh0cmFuc2FjdGlvbi50eXBlID09PSAiZWlwNzEyIikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoImN1c3RvbVNpZ25hdHVyZSIgaW4gdHJhbnNhY3Rpb24gJiYgdHJhbnNhY3Rpb24uY3VzdG9tU2lnbmF0dXJlIHx8ICJwYXltYXN0ZXIiIGluIHRyYW5zYWN0aW9uICYmIHRyYW5zYWN0aW9uLnBheW1hc3RlciB8fCAicGF5bWFzdGVySW5wdXQiIGluIHRyYW5zYWN0aW9uICYmIHRyYW5zYWN0aW9uLnBheW1hc3RlcklucHV0IHx8ICJnYXNQZXJQdWJkYXRhIiBpbiB0cmFuc2FjdGlvbiAmJiB0eXBlb2YgdHJhbnNhY3Rpb24uZ2FzUGVyUHViZGF0YSA9PT0gImJpZ2ludCIgfHwgImZhY3RvcnlEZXBzIiBpbiB0cmFuc2FjdGlvbiAmJiB0cmFuc2FjdGlvbi5mYWN0b3J5RGVwcykKICAgICAgcmV0dXJuIHRydWU7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2Fzc2VydEVpcDcxMlRyYW5zYWN0aW9uLmpzCiAgZnVuY3Rpb24gYXNzZXJ0RWlwNzEyVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgdG8sIGZyb20sIHBheW1hc3RlciwgcGF5bWFzdGVySW5wdXQgfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKCFpc0VJUDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRFaXA3MTJUcmFuc2FjdGlvbkVycm9yKCk7CiAgICBpZiAoIWNoYWluSWQgfHwgY2hhaW5JZCA8PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZENoYWluSWRFcnJvcih7IGNoYWluSWQgfSk7CiAgICBpZiAodG8gJiYgIWlzQWRkcmVzcyh0bykpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogdG8gfSk7CiAgICBpZiAoZnJvbSAmJiAhaXNBZGRyZXNzKGZyb20pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGZyb20gfSk7CiAgICBpZiAocGF5bWFzdGVyICYmICFpc0FkZHJlc3MocGF5bWFzdGVyKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBwYXltYXN0ZXIgfSk7CiAgICBpZiAocGF5bWFzdGVyICYmICFwYXltYXN0ZXJJbnB1dCkgewogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiYHBheW1hc3RlcklucHV0YCBtdXN0IGJlIHByb3ZpZGVkIHdoZW4gYHBheW1hc3RlcmAgaXMgZGVmaW5lZCIpOwogICAgfQogICAgaWYgKCFwYXltYXN0ZXIgJiYgcGF5bWFzdGVySW5wdXQpIHsKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImBwYXltYXN0ZXJgIG11c3QgYmUgcHJvdmlkZWQgd2hlbiBgcGF5bWFzdGVySW5wdXRgIGlzIGRlZmluZWQiKTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvc2VyaWFsaXplcnMuanMKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbjIodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgaWYgKGlzRUlQNzEyVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3MTIodHJhbnNhY3Rpb24pOwogICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogIH0KICB2YXIgc2VyaWFsaXplcnMgPSB7CiAgICB0cmFuc2FjdGlvbjogc2VyaWFsaXplVHJhbnNhY3Rpb24yCiAgfTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDcxMih0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgZnJvbSwgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGN1c3RvbVNpZ25hdHVyZSwgZmFjdG9yeURlcHMsIHBheW1hc3RlciwgcGF5bWFzdGVySW5wdXQsIGdhc1BlclB1YmRhdGEsIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0RWlwNzEyVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICBub25jZSA/IHRvSGV4KG5vbmNlKSA6ICIweCIsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzID8gdG9IZXgobWF4UHJpb3JpdHlGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgbWF4RmVlUGVyR2FzID8gdG9IZXgobWF4RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4MCIsCiAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICB0b0hleCgiIiksCiAgICAgIHRvSGV4KCIiKSwKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIGZyb20gPz8gIjB4IiwKICAgICAgZ2FzUGVyUHViZGF0YSA/IHRvSGV4KGdhc1BlclB1YmRhdGEpIDogdG9IZXgoZ2FzUGVyUHViZGF0YURlZmF1bHQpLAogICAgICBmYWN0b3J5RGVwcyA/PyBbXSwKICAgICAgY3VzdG9tU2lnbmF0dXJlID8/ICIweCIsCiAgICAgIC8vIEVJUDcxMiBzaWduYXR1cmUKICAgICAgcGF5bWFzdGVyICYmIHBheW1hc3RlcklucHV0ID8gW3BheW1hc3RlciwgcGF5bWFzdGVySW5wdXRdIDogW10KICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4NzEiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2hhc2hCeXRlY29kZS5qcwogIGluaXRfcGFkKCk7CiAgaW5pdF90b0J5dGVzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZXJyb3JzL2J5dGVjb2RlLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEJ5dGVjb2RlTGVuZ3RoRXhjZWVkc01heFNpemVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGdpdmVuTGVuZ3RoLCBtYXhCeXRlY29kZVNpemU6IG1heEJ5dGVjb2RlU2l6ZTIgfSkgewogICAgICBzdXBlcihgQnl0ZWNvZGUgY2Fubm90IGJlIGxvbmdlciB0aGFuICR7bWF4Qnl0ZWNvZGVTaXplMn0gYnl0ZXMuIEdpdmVuIGxlbmd0aDogJHtnaXZlbkxlbmd0aH1gLCB7IG5hbWU6ICJCeXRlY29kZUxlbmd0aEV4Y2VlZHNNYXhTaXplRXJyb3IiIH0pOwogICAgfQogIH07CiAgdmFyIEJ5dGVjb2RlTGVuZ3RoSW5Xb3Jkc011c3RCZU9kZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgZ2l2ZW5MZW5ndGhJbldvcmRzIH0pIHsKICAgICAgc3VwZXIoYEJ5dGVjb2RlIGxlbmd0aCBpbiAzMi1ieXRlIHdvcmRzIG11c3QgYmUgb2RkLiBHaXZlbiBsZW5ndGggaW4gd29yZHM6ICR7Z2l2ZW5MZW5ndGhJbldvcmRzfWAsIHsgbmFtZTogIkJ5dGVjb2RlTGVuZ3RoSW5Xb3Jkc011c3RCZU9kZEVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBCeXRlY29kZUxlbmd0aE11c3RCZURpdmlzaWJsZUJ5MzJFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGdpdmVuTGVuZ3RoIH0pIHsKICAgICAgc3VwZXIoYFRoZSBieXRlY29kZSBsZW5ndGggaW4gYnl0ZXMgbXVzdCBiZSBkaXZpc2libGUgYnkgMzIuIEdpdmVuIGxlbmd0aDogJHtnaXZlbkxlbmd0aH1gLCB7IG5hbWU6ICJCeXRlY29kZUxlbmd0aE11c3RCZURpdmlzaWJsZUJ5MzJFcnJvciIgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9oYXNoQnl0ZWNvZGUuanMKICBmdW5jdGlvbiBoYXNoQnl0ZWNvZGUoYnl0ZWNvZGUpIHsKICAgIGNvbnN0IGJ5dGVjb2RlQnl0ZXMgPSB0b0J5dGVzKGJ5dGVjb2RlKTsKICAgIGlmIChieXRlY29kZUJ5dGVzLmxlbmd0aCAlIDMyICE9PSAwKQogICAgICB0aHJvdyBuZXcgQnl0ZWNvZGVMZW5ndGhNdXN0QmVEaXZpc2libGVCeTMyRXJyb3IoewogICAgICAgIGdpdmVuTGVuZ3RoOiBieXRlY29kZUJ5dGVzLmxlbmd0aAogICAgICB9KTsKICAgIGlmIChieXRlY29kZUJ5dGVzLmxlbmd0aCA+IG1heEJ5dGVjb2RlU2l6ZSkKICAgICAgdGhyb3cgbmV3IEJ5dGVjb2RlTGVuZ3RoRXhjZWVkc01heFNpemVFcnJvcih7CiAgICAgICAgZ2l2ZW5MZW5ndGg6IGJ5dGVjb2RlQnl0ZXMubGVuZ3RoLAogICAgICAgIG1heEJ5dGVjb2RlU2l6ZQogICAgICB9KTsKICAgIGNvbnN0IGhhc2hTdHIgPSBzaGEyNTYyKGJ5dGVjb2RlQnl0ZXMpOwogICAgY29uc3QgaGFzaDMgPSB0b0J5dGVzKGhhc2hTdHIpOwogICAgY29uc3QgYnl0ZWNvZGVMZW5ndGhJbldvcmRzID0gYnl0ZWNvZGVCeXRlcy5sZW5ndGggLyAzMjsKICAgIGlmIChieXRlY29kZUxlbmd0aEluV29yZHMgJSAyID09PSAwKSB7CiAgICAgIHRocm93IG5ldyBCeXRlY29kZUxlbmd0aEluV29yZHNNdXN0QmVPZGRFcnJvcih7CiAgICAgICAgZ2l2ZW5MZW5ndGhJbldvcmRzOiBieXRlY29kZUxlbmd0aEluV29yZHMKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBieXRlY29kZUxlbmd0aCA9IHRvQnl0ZXMoYnl0ZWNvZGVMZW5ndGhJbldvcmRzKTsKICAgIGNvbnN0IGJ5dGVjb2RlTGVuZ3RoUGFkZGVkID0gcGFkKGJ5dGVjb2RlTGVuZ3RoLCB7IHNpemU6IDIgfSk7CiAgICBjb25zdCBjb2RlSGFzaFZlcnNpb24gPSBuZXcgVWludDhBcnJheShbMSwgMF0pOwogICAgaGFzaDMuc2V0KGNvZGVIYXNoVmVyc2lvbiwgMCk7CiAgICBoYXNoMy5zZXQoYnl0ZWNvZGVMZW5ndGhQYWRkZWQsIDIpOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9nZXRFaXA3MTJEb21haW4uanMKICB2YXIgZ2V0RWlwNzEyRG9tYWluMiA9ICh0cmFuc2FjdGlvbikgPT4gewogICAgYXNzZXJ0RWlwNzEyVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pOwogICAgY29uc3QgbWVzc2FnZSA9IHRyYW5zYWN0aW9uVG9NZXNzYWdlKHRyYW5zYWN0aW9uKTsKICAgIHJldHVybiB7CiAgICAgIGRvbWFpbjogewogICAgICAgIG5hbWU6ICJ6a1N5bmMiLAogICAgICAgIHZlcnNpb246ICIyIiwKICAgICAgICBjaGFpbklkOiB0cmFuc2FjdGlvbi5jaGFpbklkCiAgICAgIH0sCiAgICAgIHR5cGVzOiB7CiAgICAgICAgVHJhbnNhY3Rpb246IFsKICAgICAgICAgIHsgbmFtZTogInR4VHlwZSIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAiZnJvbSIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAidG8iLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogImdhc0xpbWl0IiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJnYXNQZXJQdWJkYXRhQnl0ZUxpbWl0IiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJtYXhGZWVQZXJHYXMiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogIm1heFByaW9yaXR5RmVlUGVyR2FzIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJwYXltYXN0ZXIiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogIm5vbmNlIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJ2YWx1ZSIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAiZGF0YSIsIHR5cGU6ICJieXRlcyIgfSwKICAgICAgICAgIHsgbmFtZTogImZhY3RvcnlEZXBzIiwgdHlwZTogImJ5dGVzMzJbXSIgfSwKICAgICAgICAgIHsgbmFtZTogInBheW1hc3RlcklucHV0IiwgdHlwZTogImJ5dGVzIiB9CiAgICAgICAgXQogICAgICB9LAogICAgICBwcmltYXJ5VHlwZTogIlRyYW5zYWN0aW9uIiwKICAgICAgbWVzc2FnZQogICAgfTsKICB9OwogIGZ1bmN0aW9uIHRyYW5zYWN0aW9uVG9NZXNzYWdlKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGdhcywgbm9uY2UsIHRvLCBmcm9tLCB2YWx1ZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgZmFjdG9yeURlcHMsIHBheW1hc3RlciwgcGF5bWFzdGVySW5wdXQsIGdhc1BlclB1YmRhdGEsIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgcmV0dXJuIHsKICAgICAgdHhUeXBlOiAxMTNuLAogICAgICBmcm9tOiBCaWdJbnQoZnJvbSksCiAgICAgIHRvOiB0byA/IEJpZ0ludCh0bykgOiAwbiwKICAgICAgZ2FzTGltaXQ6IGdhcyA/PyAwbiwKICAgICAgZ2FzUGVyUHViZGF0YUJ5dGVMaW1pdDogZ2FzUGVyUHViZGF0YSA/PyBnYXNQZXJQdWJkYXRhRGVmYXVsdCwKICAgICAgbWF4RmVlUGVyR2FzOiBtYXhGZWVQZXJHYXMgPz8gMG4sCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiBtYXhQcmlvcml0eUZlZVBlckdhcyA/PyAwbiwKICAgICAgcGF5bWFzdGVyOiBwYXltYXN0ZXIgPyBCaWdJbnQocGF5bWFzdGVyKSA6IDBuLAogICAgICBub25jZTogbm9uY2UgPyBCaWdJbnQobm9uY2UpIDogMG4sCiAgICAgIHZhbHVlOiB2YWx1ZSA/PyAwbiwKICAgICAgZGF0YTogZGF0YSA/IGRhdGEgOiAiMHgwIiwKICAgICAgZmFjdG9yeURlcHM6IGZhY3RvcnlEZXBzPy5tYXAoKGRlcCkgPT4gdG9IZXgoaGFzaEJ5dGVjb2RlKGRlcCkpKSA/PyBbXSwKICAgICAgcGF5bWFzdGVySW5wdXQ6IHBheW1hc3RlcklucHV0ID8gcGF5bWFzdGVySW5wdXQgOiAiMHgiCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZyA9IHsKICAgIGZvcm1hdHRlcnMsCiAgICBzZXJpYWxpemVycywKICAgIGN1c3RvbTogewogICAgICBnZXRFaXA3MTJEb21haW46IGdldEVpcDcxMkRvbWFpbjIKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Fic3RyYWN0VGVzdG5ldC5qcwogIHZhciBhYnN0cmFjdFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcsCiAgICBpZDogMTExMjQsCiAgICBuYW1lOiAiQWJzdHJhY3QgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkudGVzdG5ldC5hYnMueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQWJzdHJhY3QgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5hYnMueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RjljZGE2MjRGQkM3ZTA1OTM1NWNlOThhMzE2OTNkMjk5RkFDZDk2MyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzNTgzNDkKICAgICAgfSwKICAgICAgdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmQjY4ODMzMDM3OTk3NkRBODFlQjY0RmU0QkY1MGQ3NDAxNzYzQjlDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQzMTY4MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYWNhbGEuanMKICB2YXIgYWNhbGEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc4NywKICAgIG5hbWU6ICJBY2FsYSIsCiAgICBuZXR3b3JrOiAiYWNhbGEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkFjYWxhIiwKICAgICAgc3ltYm9sOiAiQUNBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC1ycGMtYWNhbGEuYWNhLWFwaS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V0aC1ycGMtYWNhbGEuYWNhLWFwaS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQWNhbGEgQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmFjYWxhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5hY2FsYS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYWxpZW5YLmpzCiAgdmFyIGFsaWVueCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAyNDEwMjQsCiAgICBuYW1lOiAiQWxpZW5YIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5hbGllbnhjaGFpbi5pby9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQWxpZW5YIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmFsaWVueGNoYWluLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hbGllblhIYWxUZXN0bmV0LmpzCiAgdmFyIGFsaWVueEhhbFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjQxMDI1LAogICAgbmFtZTogIkFMSUVOWCBIYWwgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vaGFsLXJwYy5hbGllbnhjaGFpbi5pby9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQWxpZW5YIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhbC1leHBsb3Jlci5hbGllbnhjaGFpbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL29wLXN0YWNrL2NvbnRyYWN0cy5qcwogIHZhciBjb250cmFjdHMgPSB7CiAgICBnYXNQcmljZU9yYWNsZTogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBGIiB9LAogICAgbDFCbG9jazogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDE1IiB9LAogICAgbDJDcm9zc0RvbWFpbk1lc3NlbmdlcjogewogICAgICBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA3IgogICAgfSwKICAgIGwyRXJjNzIxQnJpZGdlOiB7IGFkZHJlc3M6ICIweDQyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTQiIH0sCiAgICBsMlN0YW5kYXJkQnJpZGdlOiB7IGFkZHJlc3M6ICIweDQyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTAiIH0sCiAgICBsMlRvTDFNZXNzYWdlUGFzc2VyOiB7CiAgICAgIGFkZHJlc3M6ICIweDQyMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTYiCiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL29wLXN0YWNrL2Zvcm1hdHRlcnMuanMKICBpbml0X2Zyb21IZXgoKTsKICB2YXIgZm9ybWF0dGVyczIgPSB7CiAgICBibG9jazogLyogQF9fUFVSRV9fICovIGRlZmluZUJsb2NrKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhcmdzLnRyYW5zYWN0aW9ucz8ubWFwKCh0cmFuc2FjdGlvbikgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbiA9PT0gInN0cmluZyIpCiAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgICAgICAgIGlmIChmb3JtYXR0ZWQudHlwZUhleCA9PT0gIjB4N2UiKSB7CiAgICAgICAgICAgIGZvcm1hdHRlZC5pc1N5c3RlbVR4ID0gdHJhbnNhY3Rpb24uaXNTeXN0ZW1UeDsKICAgICAgICAgICAgZm9ybWF0dGVkLm1pbnQgPSB0cmFuc2FjdGlvbi5taW50ID8gaGV4VG9CaWdJbnQodHJhbnNhY3Rpb24ubWludCkgOiB2b2lkIDA7CiAgICAgICAgICAgIGZvcm1hdHRlZC5zb3VyY2VIYXNoID0gdHJhbnNhY3Rpb24uc291cmNlSGFzaDsKICAgICAgICAgICAgZm9ybWF0dGVkLnR5cGUgPSAiZGVwb3NpdCI7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0cmFuc2FjdGlvbnMsCiAgICAgICAgICBzdGF0ZVJvb3Q6IGFyZ3Muc3RhdGVSb290CiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvbjogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHt9OwogICAgICAgIGlmIChhcmdzLnR5cGUgPT09ICIweDdlIikgewogICAgICAgICAgdHJhbnNhY3Rpb24uaXNTeXN0ZW1UeCA9IGFyZ3MuaXNTeXN0ZW1UeDsKICAgICAgICAgIHRyYW5zYWN0aW9uLm1pbnQgPSBhcmdzLm1pbnQgPyBoZXhUb0JpZ0ludChhcmdzLm1pbnQpIDogdm9pZCAwOwogICAgICAgICAgdHJhbnNhY3Rpb24uc291cmNlSGFzaCA9IGFyZ3Muc291cmNlSGFzaDsKICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiZGVwb3NpdCI7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlY2VpcHQoewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsMUdhc1ByaWNlOiBhcmdzLmwxR2FzUHJpY2UgPyBoZXhUb0JpZ0ludChhcmdzLmwxR2FzUHJpY2UpIDogbnVsbCwKICAgICAgICAgIGwxR2FzVXNlZDogYXJncy5sMUdhc1VzZWQgPyBoZXhUb0JpZ0ludChhcmdzLmwxR2FzVXNlZCkgOiBudWxsLAogICAgICAgICAgbDFGZWU6IGFyZ3MubDFGZWUgPyBoZXhUb0JpZ0ludChhcmdzLmwxRmVlKSA6IG51bGwsCiAgICAgICAgICBsMUZlZVNjYWxhcjogYXJncy5sMUZlZVNjYWxhciA/IE51bWJlcihhcmdzLmwxRmVlU2NhbGFyKSA6IG51bGwKICAgICAgICB9OwogICAgICB9CiAgICB9KQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9zZXJpYWxpemVycy5qcwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb24zKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGlmIChpc0RlcG9zaXQodHJhbnNhY3Rpb24pKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25EZXBvc2l0KHRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgdmFyIHNlcmlhbGl6ZXJzMiA9IHsKICAgIHRyYW5zYWN0aW9uOiBzZXJpYWxpemVUcmFuc2FjdGlvbjMKICB9OwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRGVwb3NpdCh0cmFuc2FjdGlvbikgewogICAgYXNzZXJ0VHJhbnNhY3Rpb25EZXBvc2l0KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHsgc291cmNlSGFzaCwgZGF0YSwgZnJvbSwgZ2FzLCBpc1N5c3RlbVR4LCBtaW50OiBtaW50MiwgdG8sIHZhbHVlIH0gPSB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgc291cmNlSGFzaCwKICAgICAgZnJvbSwKICAgICAgdG8gPz8gIjB4IiwKICAgICAgbWludDIgPyB0b0hleChtaW50MikgOiAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICBpc1N5c3RlbVR4ID8gIjB4MSIgOiAiMHgiLAogICAgICBkYXRhID8/ICIweCIKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4N2UiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgZnVuY3Rpb24gaXNEZXBvc2l0KHRyYW5zYWN0aW9uKSB7CiAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImRlcG9zaXQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24uc291cmNlSGFzaCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkRlcG9zaXQodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgZnJvbSwgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGZyb20gJiYgIWlzQWRkcmVzcyhmcm9tKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBmcm9tIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL29wLXN0YWNrL2NoYWluQ29uZmlnLmpzCiAgdmFyIGNoYWluQ29uZmlnMiA9IHsKICAgIGNvbnRyYWN0cywKICAgIGZvcm1hdHRlcnM6IGZvcm1hdHRlcnMyLAogICAgc2VyaWFsaXplcnM6IHNlcmlhbGl6ZXJzMgogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYW5jaWVudDguanMKICB2YXIgc291cmNlSWQgPSAxOwogIHZhciBhbmNpZW50OCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogODg4ODg4ODg4LAogICAgbmFtZTogIkFuY2llbnQ4IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5hbmNpZW50OC5nZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFuY2llbnQ4IGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uYW5jaWVudDguZ2ciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi5hbmNpZW50OC5nZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhCMDlEQzA4NDI4QzhiNEVGQjRmZjlDMDgyNzM4NkNERjM0Mjc3OTk2IgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkXTogewogICAgICAgICAgYWRkcmVzczogIjB4NjM5RjJBRUNFMzk4QWE3NmIwN2U1OWVGNmFiZTJjRmUzMmJhY2I2OCIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5MDcwNTcxCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZDVlM2VEZjViNjgxMzVENTU5RDU3MkUyNmJGODYzRkJDMTk1MDAzMyIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5MDcwNTcxCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hbmNpZW50OFNlcG9saWEuanMKICB2YXIgc291cmNlSWQyID0gMTExNTUxMTE7CiAgdmFyIGFuY2llbnQ4U2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjgxMjIwMjQsCiAgICBuYW1lOiAiQW5jaWVudDggVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGN2Mi10ZXN0bmV0LmFuY2llbnQ4LmdnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQW5jaWVudDggQ2VsZXN0aWEgVGVzdG5ldCBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FudjItdGVzdG5ldC5hbmNpZW50OC5nZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FudjItdGVzdG5ldC5hbmNpZW50OC5nZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4OTQyZkQ1MDE3YzBGNjA1NzU5MzBEODU3NEVhY2ExM0JFY0Q2ZTFiQiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhmYTFkOUUyNkE2YUNEN2IyMjExNUQyNzU3MmMxMjIxQjk4MDNjOTYwIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDk3MjkwOAogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGNkJjMDE0NmQzYzc0RDQ4MzA2ZTc5QWUxMzRBMjYwRTQxOEM5MzM1IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDk3MjkwOAogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDIKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hbnZpbC5qcwogIHZhciBhbnZpbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEzMzcsCiAgICBuYW1lOiAiQW52aWwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3M6Ly8xMjcuMC4wLjE6ODU0NSJdCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcGVDaGFpbi5qcwogIHZhciBzb3VyY2VJZDMgPSA0MjE2MTsKICB2YXIgYXBlQ2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMTM5LAogICAgbmFtZTogIkFwZSBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQXBlQ29pbiIsCiAgICAgIHN5bWJvbDogIkFQRSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYXBlY2hhaW4uY29tL2h0dHAiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmFwZWNoYWluLmNvbS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFwZXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXBlc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYXBlc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDg4OQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FwZXhUZXN0bmV0LmpzCiAgdmFyIGFwZXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzOTkzLAogICAgbmFtZTogIkFQRVggVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtdGVzdG5ldC5hcGV4bGF5ZXIueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHAtdGVzdG5ldC5hcGV4bGF5ZXIueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cC10ZXN0bmV0LmFwZXhsYXllci54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmNzY0MmJlMzNhNmIxOEQxNmE5OTU2NTdhZGI1YTY4Q0QwNDM4YUUyIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI4Mzc3NQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FyYml0cnVtLmpzCiAgdmFyIGFyYml0cnVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjE2MSwKICAgIG5hbWU6ICJBcmJpdHJ1bSBPbmUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXJiMS5hcmJpdHJ1bS5pby9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmJpc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcmJpc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYXJiaXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc2NTQ3MDcKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FyYml0cnVtR29lcmxpLmpzCiAgdmFyIGFyYml0cnVtR29lcmxpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjE2MTMsCiAgICBuYW1lOiAiQXJiaXRydW0gR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBcmJpdHJ1bSBHb2VybGkgRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ29lcmxpLXJvbGx1cC5hcmJpdHJ1bS5pby9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmJpc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuYXJiaXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODgxMTQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmJpdHJ1bU5vdmEuanMKICB2YXIgYXJiaXRydW1Ob3ZhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjE3MCwKICAgIG5hbWU6ICJBcmJpdHJ1bSBOb3ZhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL25vdmEuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbm92YS5hcmJpc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktbm92YS5hcmJpc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0Njk2MwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJiaXRydW1TZXBvbGlhLmpzCiAgdmFyIGFyYml0cnVtU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNjE0LAogICAgbmFtZTogIkFyYml0cnVtIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkFyYml0cnVtIFNlcG9saWEgRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS1yb2xsdXAuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5hcmJpc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5hcmJpc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODE5MzAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmVvbk5ldHdvcmsuanMKICB2YXIgYXJlb25OZXR3b3JrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjMsCiAgICBuYW1lOiAiQXJlb24gTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBkZWNpbWFsczogMTgsIG5hbWU6ICJBUkVBIiwgc3ltYm9sOiAiQVJFQSIgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5hcmVvbi5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQtd3MuYXJlb24ubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyZW9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcmVvbnNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM1MzI4NgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmVvbk5ldHdvcmtUZXN0bmV0LmpzCiAgdmFyIGFyZW9uTmV0d29ya1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ2MiwKICAgIG5hbWU6ICJBcmVvbiBOZXR3b3JrIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiVEFSRUEiLCBzeW1ib2w6ICJUQVJFQSIgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5hcmVvbi5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQtd3MuYXJlb24ubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyZW9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcmVvbnNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FydGVsYVRlc3RuZXQuanMKICB2YXIgYXJ0ZWxhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTE4MjIsCiAgICBuYW1lOiAiQXJ0ZWxhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkFSVCIsIHN5bWJvbDogIkFSVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2JldGFuZXQtcnBjMS5hcnRlbGEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFydGVsYSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iZXRhbmV0LXNjYW4uYXJ0ZWxhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmV0YW5ldC1zY2FuLmFydGVsYS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZDA3Yzg2MzVmNzZlODc0NUVlNzA5MmZiYjZlOGZiYzVGZUYwOURENyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3MDAxODcxCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXNzZXRDaGFpbi5qcwogIHZhciBhc3NldENoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjQyMCwKICAgIG5hbWU6ICJBc3NldENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUmVhbCBXb3JsZCBBc3NldCIsCiAgICAgIHN5bWJvbDogIlJXQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQtcnBjLmFzc2V0Y2hhaW4ub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXNzZXQgQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5hc3NldGNoYWluLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLmFzc2V0Y2hhaW4ub3JnL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlLAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Fzc2V0Q2hhaW5UZXN0bmV0LmpzCiAgdmFyIGFzc2V0Q2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjQyMSwKICAgIG5hbWU6ICJBc3NldENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUmVhbCBXb3JsZCBBc3NldCIsCiAgICAgIHN5bWJvbDogIlJXQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2VudWd1LXJwYy5hc3NldGNoYWluLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzc2V0IENoYWluIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi10ZXN0bmV0LmFzc2V0Y2hhaW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4tdGVzdG5ldC5hc3NldGNoYWluLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg5ODlGODMyRDM1OTg4Y2I1ZTNlQjAwMUZhMkZlNzg5NDY5RUMzMUVhIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3MTc3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hc3Rhci5qcwogIHZhciBhc3RhciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTkyLAogICAgbmFtZTogIkFzdGFyIiwKICAgIG5ldHdvcms6ICJhc3Rhci1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBc3RhciIsCiAgICAgIHN5bWJvbDogIkFTVFIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FzdGFyLmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzdGFyIFN1YnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXN0YXIuc3Vic2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NjE3OTQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXN0YXJaa0VWTS5qcwogIHZhciBhc3RhclprRVZNID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNzc2LAogICAgbmFtZTogIkFzdGFyIHprRVZNIiwKICAgIG5ldHdvcms6ICJBc3RhclprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy16a2V2bS5hc3Rhci5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXN0YXIgemtFVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXN0YXItemtldm0uZXhwbG9yZXIuc3RhcnRhbGUuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDkzNTI4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FzdGFyWmt5b3RvLmpzCiAgdmFyIGFzdGFyWmt5b3RvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MDM4MzYxLAogICAgbmFtZTogIkFzdGFyIHprRVZNIFRlc3RuZXQgekt5b3RvIiwKICAgIG5ldHdvcms6ICJ6S3lvdG8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnN0YXJ0YWxlLmNvbS96a3lvdG8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6S3lvdG8gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vemt5b3RvLmV4cGxvcmVyLnN0YXJ0YWxlLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTYxNTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdGxldGFPbHltcGlhLmpzCiAgdmFyIGF0bGV0YU9seW1waWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzNDAsCiAgICBuYW1lOiAiQXRsZXRhIE9seW1waWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiQXRsYSIsIHN5bWJvbDogIkFUTEEiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5hdGxldGEubmV0d29yazo5OTQ0IiwKICAgICAgICAgICJodHRwczovL3Rlc3RuZXQtcnBjLmF0bGV0YS5uZXR3b3JrIgogICAgICAgIF0sCiAgICAgICAgd3M6IFsid3NzOi8vdGVzdG5ldC1ycGMuYXRsZXRhLm5ldHdvcms6OTk0NCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkF0bGV0YSBPbHltcGlhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuYXRsZXRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5hdGxldGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDE0NzJlYzYzOTIxODBmYjg0RjM0NWQyNDU1YkNDNzVCMjY1NzcxMTUiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA3NjQ3MwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2F1cm9yYS5qcwogIHZhciBhdXJvcmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMTMxNjE1NTQsCiAgICBuYW1lOiAiQXVyb3JhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5hdXJvcmEuZGV2Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXVyb3Jhc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hdXJvcmFzY2FuLmRldiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hdXJvcmFzY2FuLmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjI5MDc4MTYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2F1cm9yYVRlc3RuZXQuanMKICB2YXIgYXVyb3JhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMxMzE2MTU1NSwKICAgIG5hbWU6ICJBdXJvcmEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuYXVyb3JhLmRldiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkF1cm9yYXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5hdXJvcmFzY2FuLmRldiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmF1cm9yYXNjYW4uZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdXJvcmlhLmpzCiAgdmFyIGF1cm9yaWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwNTIwNSwKICAgIG5hbWU6ICJBdXJvcmlhIFRlc3RuZXQiLAogICAgbmV0d29yazogImF1cm9yaWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkF1cm9yaWEgU3RyYXRpcyIsCiAgICAgIHN5bWJvbDogInRTVFJBWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hdXJvcmlhLnJwYy5zdHJhdGlzZXZtLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkF1cm9yaWEgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hdXJvcmlhLmV4cGxvcmVyLnN0cmF0aXNldm0uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2F2YWxhbmNoZS5qcwogIHZhciBhdmFsYW5jaGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzMTE0LAogICAgbmFtZTogIkF2YWxhbmNoZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJBdmFsYW5jaGUiLAogICAgICBzeW1ib2w6ICJBVkFYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmF2YXgubmV0d29yay9leHQvYmMvQy9ycGMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbm93VHJhY2UiLAogICAgICAgIHVybDogImh0dHBzOi8vc25vd3RyYWNlLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5zbm93dHJhY2UuaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE5MDc5MzQKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2F2YWxhbmNoZUZ1amkuanMKICB2YXIgYXZhbGFuY2hlRnVqaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDMxMTMsCiAgICBuYW1lOiAiQXZhbGFuY2hlIEZ1amkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQXZhbGFuY2hlIEZ1amkiLAogICAgICBzeW1ib2w6ICJBVkFYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmF2YXgtdGVzdC5uZXR3b3JrL2V4dC9iYy9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNub3dUcmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LnNub3d0cmFjZS5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktdGVzdG5ldC5zbm93dHJhY2UuaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzA5Njk1OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2IzLmpzCiAgdmFyIHNvdXJjZUlkNCA9IDg0NTM7CiAgdmFyIGIzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MzMzLAogICAgbmFtZTogIkIzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5iMy5mdW4vaHR0cCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuYjMuZnVuIgogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2IzU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDUgPSAxNjg1ODc3NzM7CiAgdmFyIGIzU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTk5MywKICAgIG5hbWU6ICJCMyBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLmIzLmZ1bi9odHRwIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLmIzLmZ1biIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ1CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFoYW11dC5qcwogIHZhciBiYWhhbXV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MTY1LAogICAgbmV0d29yazogImJhaGFtdXQiLAogICAgbmFtZTogIkJhaGFtdXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZhc3R0b2tlbiIsIHN5bWJvbDogIkZUTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjMS5iYWhhbXV0LmlvIiwKICAgICAgICAgICJodHRwczovL2JhaGFtdXQtcnBjLnB1YmxpY25vZGUuY29tIiwKICAgICAgICAgICJodHRwczovL3JwYzIuYmFoYW11dC5pbyIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3dzMS5zYWhhcmEuYmFoYW11dGNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vYmFoYW11dC1ycGMucHVibGljbm9kZS5jb20iLAogICAgICAgICAgIndzczovL3dzMi5zYWhhcmEuYmFoYW11dGNoYWluLmNvbSIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZ0bnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmZ0bnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3d3dy5mdG5zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iYXNlLmpzCiAgdmFyIHNvdXJjZUlkNiA9IDE7CiAgdmFyIGJhc2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDg0NTMsCiAgICBuYW1lOiAiQmFzZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LmJhc2Uub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmFzZXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYmFzZXNjYW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5iYXNlc2Nhbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0M2VkQjg4QzRCODBmREQyQWRGRjI0MTJBN0JlYkY5ZEY0MmNCNDBlIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4NTYzMTViOTBjNDA3MzA5MjVlYzU0ODVjZjAwNGQ4MzUwNTg1MThBMCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDUwMjIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQ5MDQ4MDQ0RDU3ZTFDOTJBNzdmNzk5ODhkMjFGYThmQUY3NEU5N2UiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxNzQ4MjE0MwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzMTU0Q2YxNmNjZGI0QzZkOTIyNjI5NjY0MTc0YjkwNGQ4MEYyQzM1IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0ODIxNDMKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ2CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFzZUdvZXJsaS5qcwogIHZhciBzb3VyY2VJZDcgPSA1OwogIHZhciBiYXNlR29lcmxpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4NDUzMSwKICAgIG5hbWU6ICJCYXNlIEdvZXJsaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiR29lcmxpIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2dvZXJsaS5iYXNlLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJhc2VzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS5iYXNlc2Nhbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZ29lcmxpLmJhc2VzY2FuLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ3XTogewogICAgICAgICAgYWRkcmVzczogIjB4MkEzNTg5MWZmMzAzMTNDY0ZhNkNFODhkY2YzODU4YmIwNzVBMjI5OCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEzNzY5ODgKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGU5M2M4Y0QwRDQwOTM0MTIwNUE1OTJmOGM0QWMxQTVmZTU1ODVjZkEiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGZBNkQ4RWU1QkU3NzBGODRGQzAwMUQwOThDNGJENjA0RmUwMTI4NGEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDcKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iYXNlU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDggPSAxMTE1NTExMTsKICB2YXIgYmFzZVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDg0NTMyLAogICAgbmV0d29yazogImJhc2Utc2Vwb2xpYSIsCiAgICBuYW1lOiAiQmFzZSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZXBvbGlhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5iYXNlLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJhc2VzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuYmFzZXNjYW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLmJhc2VzY2FuLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ2RTZkQmY0RjdFQTBhYzQxMmZEOGI2NUVEMjk3ZTY0QkI3YTA2RTEiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg4NDQ1N2NhOUQwMTYzRmJDNGJiZmU0RGZiYjIwYmE0NmU0OERGMjU0IgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQ5ZjUzZTQxNDUyYzc0NTg5ZTg1Y2ExNjc3NDI2YmE0MjY0NTllODUiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA0NDQ2Njc3CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGZkMEJmNzFGNjA2NjBFMmY2MDhlZDU2ZTE2NTlDNDUwZUIxMTMxMjAiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA0NDQ2Njc3CiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDU5NjQ3CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkOAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlYW0uanMKICB2YXIgYmVhbSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDMzNywKICAgIG5hbWU6ICJCZWFtIiwKICAgIG5ldHdvcms6ICJiZWFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJlYW0iLAogICAgICBzeW1ib2w6ICJCRUFNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9idWlsZC5vbmJlYW0uY29tL3JwYyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9idWlsZC5vbmJlYW0uY29tL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmVhbSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zdWJuZXRzLmF2YXgubmV0d29yay9iZWFtIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg0OTU2ZjE1ZWZkYzNkYzE2NjQ1ZTkwY2MzNTZlYWZhNjVmZmM2NWVjIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlYW1UZXN0bmV0LmpzCiAgdmFyIGJlYW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzMzNywKICAgIG5hbWU6ICJCZWFtIFRlc3RuZXQiLAogICAgbmV0d29yazogImJlYW0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQmVhbSIsCiAgICAgIHN5bWJvbDogIkJFQU0iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2J1aWxkLm9uYmVhbS5jb20vcnBjL3Rlc3RuZXQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vYnVpbGQub25iZWFtLmNvbS93cy90ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmVhbSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zdWJuZXRzLXRlc3QuYXZheC5uZXR3b3JrL2JlYW0iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDliZjQ5YjcwNGVlMmEwOTViOTVjMWYyZDRlYjkwMTA1MTBjNDFjOWUiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlYXJOZXR3b3JrQ2hhaW5NYWlubmV0LmpzCiAgdmFyIGJlYXJOZXR3b3JrQ2hhaW5NYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NDEyMzAsCiAgICBuYW1lOiAiQmVhciBOZXR3b3JrIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQmVhck5ldHdvcmtDaGFpbiIsCiAgICAgIHN5bWJvbDogIkJSTktDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYnJua2MtbWFpbm5ldC5iZWFybmV0d29yay5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCcm5rU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9icm5rc2Nhbi5iZWFybmV0d29yay5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYnJua3NjYW4uYmVhcm5ldHdvcmsubmV0L2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlYXJOZXR3b3JrQ2hhaW5UZXN0bmV0LmpzCiAgdmFyIGJlYXJOZXR3b3JrQ2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3NTEyMzAsCiAgICBuYW1lOiAiQmVhciBOZXR3b3JrIENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAidEJSTktDIiwKICAgICAgc3ltYm9sOiAidEJSTktDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYnJua2MtdGVzdC5iZWFybmV0d29yay5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCcm5rVGVzdFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYnJua3Rlc3Qtc2Nhbi5iZWFybmV0d29yay5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYnJua3Rlc3Qtc2Nhbi5iZWFybmV0d29yay5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlcmFjaGFpblRlc3RuZXQuanMKICB2YXIgYmVyYWNoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODAwODUsCiAgICBuYW1lOiAiQmVyYWNoYWluIEFydGlvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJFUkEgVG9rZW4iLAogICAgICBzeW1ib2w6ICJCRVJBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXJ0aW8ucnBjLmJlcmFjaGFpbi5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZXJhY2hhaW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJ0aW8uYmVyYXRyYWlsLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JlcmFjaGFpblRlc3RuZXRiQXJ0aW8uanMKICB2YXIgYmVyYWNoYWluVGVzdG5ldGJBcnRpbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODAwODQsCiAgICBuYW1lOiAiQmVyYWNoYWluIGJBcnRpbyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCRVJBIFRva2VuIiwKICAgICAgc3ltYm9sOiAiQkVSQSIKICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA5MjY5CiAgICAgIH0KICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JhcnRpby5ycGMuYmVyYWNoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlcmFjaGFpbiBiQXJ0aW8gQmVyYXRyYWlsIiwKICAgICAgICB1cmw6ICJodHRwczovL2JhcnRpby5iZXJhdHJhaWwuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmV2bU1haW5uZXQuanMKICB2YXIgYmV2bU1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExNTAxLAogICAgbmFtZTogIkJFVk0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQml0Y29pbiIsIHN5bWJvbDogIkJUQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtbWFpbm5ldC0xLmJldm0uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZXZtc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLW1haW5uZXQuYmV2bS5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLW1haW5uZXQtYXBpLmJldm0uaW8vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmlmcm9zdC5qcwogIHZhciBiaWZyb3N0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMDY4LAogICAgbmFtZTogIkJpZnJvc3QgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQkZDIiwgc3ltYm9sOiAiQkZDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcHVibGljLTAxLm1haW5uZXQuYmlmcm9zdG5ldHdvcmsuY29tL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJpZnJvc3QgQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0LmJpZnJvc3RuZXR3b3JrLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0a3ViLmpzCiAgdmFyIGJpdGt1YiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTYsCiAgICBuYW1lOiAiQml0a3ViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRrdWIiLCBzeW1ib2w6ICJLVUIiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYml0a3ViY2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRrdWIgQ2hhaW4gTWFpbm5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cuYmtjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vd3d3LmJrY3NjYW4uY29tL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGt1YlRlc3RuZXQuanMKICB2YXIgYml0a3ViVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjU5MjUsCiAgICBuYW1lOiAiQml0a3ViIFRlc3RuZXQiLAogICAgbmV0d29yazogIkJpdGt1YiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRrdWIgVGVzdCIsIHN5bWJvbDogInRLVUIiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtdGVzdG5ldC5iaXRrdWJjaGFpbi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJpdGt1YiBDaGFpbiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYmtjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5ia2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0bGF5ZXIuanMKICB2YXIgYml0bGF5ZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMDkwMSwKICAgIG5hbWU6ICJCaXRsYXllciBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCVEMiLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmJpdGxheWVyLm9yZyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5iaXRsYXllci5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJiaXRsYXllciBtYWlubmV0IHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmJ0cnNjYW4uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0bGF5ZXJUZXN0bmV0LmpzCiAgdmFyIGJpdGxheWVyVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAwODEwLAogICAgbmFtZTogIkJpdGxheWVyIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJUQyIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5iaXRsYXllci5vcmciXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC13cy5iaXRsYXllci5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJiaXRsYXllciB0ZXN0bmV0IHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5idHJzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iaXRyb2NrLmpzCiAgdmFyIGJpdHJvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcxNzEsCiAgICBuYW1lOiAiQml0cm9jayBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCUk9DSyIsIHN5bWJvbDogIkJST0NLIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYnJvY2tycGMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRyb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmJpdC1yb2NrLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iaXRUb3JyZW50LmpzCiAgdmFyIGJpdFRvcnJlbnQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OSwKICAgIG5hbWU6ICJCaXRUb3JyZW50IiwKICAgIG5ldHdvcms6ICJiaXR0b3JyZW50LWNoYWluLW1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJpdFRvcnJlbnQiLCBzeW1ib2w6ICJCVFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmJpdHRvcnJlbnRjaGFpbi5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJ0dGNzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2J0dGNzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYnR0Y3NjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMTA3ODU1MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0VG9ycmVudFRlc3RuZXQuanMKICB2YXIgYml0VG9ycmVudFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjgsCiAgICBuYW1lOiAiQml0VG9ycmVudCBDaGFpbiBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJiaXR0b3JyZW50LWNoYWluLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJpdFRvcnJlbnQiLCBzeW1ib2w6ICJCVFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdHJwYy5iaXR0b3JyZW50Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCdHRjc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmJ0dGNzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmJ0dGNzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmxhc3QuanMKICB2YXIgc291cmNlSWQ5ID0gMTsKICB2YXIgYmxhc3QgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgxNDU3LAogICAgbmFtZTogIkJsYXN0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmJsYXN0LmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxhc3RzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2JsYXN0c2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYmxhc3RzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMTI5MjkKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDkKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ibGFzdFNlcG9saWEuanMKICB2YXIgc291cmNlSWQxMCA9IDExMTU1MTExOwogIHZhciBibGFzdFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2ODU4Nzc3MywKICAgIG5hbWU6ICJCbGFzdCBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLmJsYXN0LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxhc3RzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuYmxhc3RzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLmJsYXN0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzU2NjkwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMTAKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ib2IuanMKICB2YXIgc291cmNlSWQxMSA9IDE7CiAgdmFyIGJvYiA9IGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA2MDgwOCwKICAgIG5hbWU6ICJCT0IiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ29ib2IueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5nb2JvYi54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCT0IgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZ29ib2IueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIzMTMxCiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkRGE1M0UyM2Y4YTMyNjQwYjA0RDcyNTZlNjUxQzFkYjk4ZEIxMUMxIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg4QWRlRTEyNDQ0NzQzNWZFMDNlM0NEMjRkRjNmNGNBRTMyRTY1YTNFIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDExCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iYS5qcwogIHZhciBib2JhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyODgsCiAgICBuYW1lOiAiQm9iYSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5ib2JhLm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCT0JBU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ib2Jhc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2ODU5CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ib2JhU2Vwb2xpYS5qcwogIHZhciBib2JhU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjg4ODIsCiAgICBuYW1lOiAiQm9iYSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5ib2JhLm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCT0JBU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmJvYmFzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ib2JTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMTIgPSAxMTE1NTExMTsKICB2YXIgYm9iU2Vwb2xpYSA9IGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4MDg4MTMsCiAgICBuYW1lOiAiQk9CIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ib2Itc2Vwb2xpYS5ycGMuZ29ib2IueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2JvYi1zZXBvbGlhLnJwYy5nb2JvYi54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCT0IgU2Vwb2xpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ib2Itc2Vwb2xpYS5leHBsb3Jlci5nb2JvYi54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzU2NzcKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE0RDAwNjk0NTJiNEFFMmIyNTBCMzk1YjhhZEFiNzcxRTQyNjdkMmYiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA0NDYyNjE1CiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDg2N0IxQWE4NzJiOUM4Y0I1RTlGNzc1NWZlREM0NUJCMjRBZDBhZTQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA0NDYyNjE1CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDEyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm90YW5peFRlc3RuZXQuanMKICB2YXIgYm90YW5peFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM2MzYsCiAgICBuYW1lOiAiQm90YW5peCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCb3Rhbml4Iiwgc3ltYm9sOiAiQlRDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcG9hLW5vZGUuYm90YW5peGxhYnMuZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmJvdGFuaXhsYWJzLmRldiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmJvdGFuaXhsYWJzLmRldiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ib3VuY2VCaXQuanMKICB2YXIgYm91bmNlQml0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MDAxLAogICAgbmFtZTogIkJvdW5jZUJpdCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCb3VuY2VCaXQiLCBzeW1ib2w6ICJCQiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9mdWxsbm9kZS1tYWlubmV0LmJvdW5jZWJpdGFwaS5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCQiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jic2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm91bmNlQml0VGVzdG5ldC5qcwogIHZhciBib3VuY2VCaXRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2ZTMsCiAgICBuYW1lOiAiQm91bmNlQml0IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJvdW5jZUJpdCIsIHN5bWJvbDogIkJCIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2Z1bGxub2RlLXRlc3RuZXQuYm91bmNlYml0YXBpLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJCIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5iYnNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnJvbm9zLmpzCiAgdmFyIGJyb25vcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAzOSwKICAgIG5hbWU6ICJCcm9ub3MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQlJPIiwKICAgICAgc3ltYm9sOiAiQlJPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXZtLmJyb25vcy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCcm9ub1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYnJvc2Nhbi5icm9ub3Mub3JnIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnJvbm9zVGVzdG5ldC5qcwogIHZhciBicm9ub3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDM4LAogICAgbmFtZTogIkJyb25vcyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJyb25vcyBDb2luIiwKICAgICAgc3ltYm9sOiAidEJSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS10ZXN0bmV0LmJyb25vcy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCcm9ub1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGJyb3NjYW4uYnJvbm9zLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ic2MuanMKICB2YXIgYnNjID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NiwKICAgIG5hbWU6ICJCTkIgU21hcnQgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQk5CIiwKICAgICAgc3ltYm9sOiAiQk5CIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmFua3IuY29tL2JzYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJzY1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYnNjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmJzY3NjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTkyMTQ1MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNjR3JlZW5maWVsZC5qcwogIHZhciBic2NHcmVlbmZpZWxkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDE3LAogICAgbmFtZTogIkJOQiBHcmVlbmZpZWxkIENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2dyZWVuZmllbGQtY2hhaW4uYm5iY2hhaW4ub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk5CIEdyZWVuZmllbGQgTWFpbm5ldCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dyZWVuZmllbGRzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNjVGVzdG5ldC5qcwogIHZhciBic2NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NywKICAgIG5hbWU6ICJCaW5hbmNlIFNtYXJ0IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQk5CIiwKICAgICAgc3ltYm9sOiAidEJOQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2RhdGEtc2VlZC1wcmVic2MtMS1zMS5ibmJjaGFpbi5vcmc6ODU0NSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJzY1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5ic2NzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktdGVzdG5ldC5ic2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0MjI0ODMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ic3F1YXJlZC5qcwogIHZhciBic3F1YXJlZCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjIzLAogICAgbmFtZTogIkIyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5ic3F1YXJlZC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ic3F1YXJlZC5uZXR3b3JrIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNxdWFyZWRUZXN0bmV0LmpzCiAgdmFyIGJzcXVhcmVkVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEyMywKICAgIG5hbWU6ICJCMiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLmJzcXVhcmVkLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuYnNxdWFyZWQubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9idHIuanMKICB2YXIgYnRyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDA5MDEsCiAgICBuYW1lOiAiQml0bGF5ZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJpdGNvaW4iLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYml0bGF5ZXIub3JnIiwKICAgICAgICAgICJodHRwczovL3JwYy5iaXRsYXllci1ycGMuY29tIiwKICAgICAgICAgICJodHRwczovL3JwYy5hbmtyLmNvbS9iaXRsYXllciIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5iaXRsYXllci5vcmciLCAid3NzOi8vd3MuYml0bGF5ZXItcnBjLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJpdGxheWVyKEJUUikgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cuYnRyc2Nhbi5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9idHJUZXN0bmV0LmpzCiAgdmFyIGJ0clRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMDgxMCwKICAgIG5hbWU6ICJCaXRsYXllciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLmJpdGxheWVyLm9yZyJdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3Rlc3RuZXQtd3MuYml0bGF5ZXIub3JnIiwKICAgICAgICAgICJ3c3M6Ly90ZXN0bmV0LXdzLmJpdGxheWVyLXJwYy5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRsYXllcihCVFIpIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5idHJzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ieG4uanMKICB2YXIgYnhuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0OTk5LAogICAgbmFtZTogIkJsYWNrRm9ydCBFeGNoYW5nZSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCbGFja0ZvcnQgVG9rZW4iLCBzeW1ib2w6ICJCWE4iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LmJsYWNrZm9ydC5uZXR3b3JrL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuYmxhY2tmb3J0Lm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuYmxhY2tmb3J0Lm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnhuVGVzdG5ldC5qcwogIHZhciBieG5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Nzc3LAogICAgbmFtZTogIkJsYWNrRm9ydCBFeGNoYW5nZSBOZXR3b3JrIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJsYWNrRm9ydCBUZXN0bmV0IFRva2VuIiwKICAgICAgc3ltYm9sOiAiVEJYTiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LmJsYWNrZm9ydC5uZXR3b3JrL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5ibGFja2ZvcnQubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLmJsYWNrZm9ydC5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jYW5ub24uanMKICB2YXIgY2Fubm9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3MCwKICAgIG5hbWU6ICJDYW5ub24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0gfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NhbnRvLmpzCiAgdmFyIGNhbnRvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3NzAwLAogICAgbmFtZTogIkNhbnRvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNhbnRvIiwKICAgICAgc3ltYm9sOiAiQ0FOVE8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9jYW50by5ncmF2aXR5Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUdWJlci5CdWlsZCAoQmxvY2tzY291dCkiLAogICAgICAgIHVybDogImh0dHBzOi8vdHViZXIuYnVpbGQiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjkwNTc4OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL2ZlZXMuanMKICB2YXIgZmVlcyA9IHsKICAgIC8qCiAgICAgICAqIEVzdGltYXRlcyB0aGUgZmVlcyBwZXIgZ2FzIGZvciBhIHRyYW5zYWN0aW9uLgogICAgCiAgICAgICAqIElmIHRoZSB0cmFuc2FjdGlvbiBpcyB0byBiZSBwYWlkIGluIGEgdG9rZW4gKGZlZUN1cnJlbmN5IGlzIHByZXNlbnQpIHRoZW4gdGhlIGZlZXMKICAgICAgICogYXJlIGVzdGltYXRlZCBpbiB0aGUgdmFsdWUgb2YgdGhlIHRva2VuLiBPdGhlcndpc2UgZmFsbHMgYmFjayB0byB0aGUgZGVmYXVsdAogICAgICAgKiBlc3RpbWF0aW9uIGJ5IHJldHVybmluZyBudWxsLgogICAgICAgKgogICAgICAgKiBAcGFyYW0gcGFyYW1zIGZlZSBlc3RpbWF0aW9uIGZ1bmN0aW9uIHBhcmFtZXRlcnMKICAgICAgICovCiAgICBlc3RpbWF0ZUZlZXNQZXJHYXM6IGFzeW5jIChwYXJhbXMpID0+IHsKICAgICAgaWYgKCFwYXJhbXMucmVxdWVzdD8uZmVlQ3VycmVuY3kpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIGNvbnN0IFttYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzXSA9IGF3YWl0IFByb21pc2UuYWxsKFsKICAgICAgICBlc3RpbWF0ZUZlZVBlckdhc0luRmVlQ3VycmVuY3kocGFyYW1zLmNsaWVudCwgcGFyYW1zLnJlcXVlc3QuZmVlQ3VycmVuY3kpLAogICAgICAgIGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KHBhcmFtcy5jbGllbnQsIHBhcmFtcy5yZXF1ZXN0LmZlZUN1cnJlbmN5KQogICAgICBdKTsKICAgICAgY29uc3Qgc3VnZ2VzdGVkTWF4RmVlUGVyR2FzID0gcGFyYW1zLm11bHRpcGx5KG1heEZlZVBlckdhcykgKyBtYXhQcmlvcml0eUZlZVBlckdhczsKICAgICAgcmV0dXJuIHsKICAgICAgICBtYXhGZWVQZXJHYXM6IHN1Z2dlc3RlZE1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfQogIH07CiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KGNsaWVudCwgZmVlQ3VycmVuY3kpIHsKICAgIGNvbnN0IGZlZSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dhc1ByaWNlIiwKICAgICAgcGFyYW1zOiBbZmVlQ3VycmVuY3ldCiAgICB9KTsKICAgIHJldHVybiBCaWdJbnQoZmVlKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhc0luRmVlQ3VycmVuY3koY2xpZW50LCBmZWVDdXJyZW5jeSkgewogICAgY29uc3QgZmVlc1BlckdhcyA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX21heFByaW9yaXR5RmVlUGVyR2FzIiwKICAgICAgcGFyYW1zOiBbZmVlQ3VycmVuY3ldCiAgICB9KTsKICAgIHJldHVybiBCaWdJbnQoZmVlc1Blckdhcyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9mb3JtYXR0ZXJzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vdXRpbHMuanMKICBpbml0X3RyaW0oKTsKICBmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgPT09IDAgfHwgdmFsdWUgPT09IDBuIHx8IHZhbHVlID09PSB2b2lkIDAgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICIwIiB8fCB2YWx1ZSA9PT0gIiIgfHwgdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiAmJiAodHJpbSh2YWx1ZSkudG9Mb3dlckNhc2UoKSA9PT0gIjB4IiB8fCB0cmltKHZhbHVlKS50b0xvd2VyQ2FzZSgpID09PSAiMHgwMCIpOwogIH0KICBmdW5jdGlvbiBpc1ByZXNlbnQodmFsdWUpIHsKICAgIHJldHVybiAhaXNFbXB0eSh2YWx1ZSk7CiAgfQogIGZ1bmN0aW9uIGlzRUlQMTU1OSh0cmFuc2FjdGlvbikgewogICAgcmV0dXJuIHR5cGVvZiB0cmFuc2FjdGlvbi5tYXhGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCI7CiAgfQogIGZ1bmN0aW9uIGlzQ0lQNjQodHJhbnNhY3Rpb24pIHsKICAgIGlmICh0cmFuc2FjdGlvbi50eXBlID09PSAiY2lwNjQiKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGlzRUlQMTU1OSh0cmFuc2FjdGlvbikgJiYgaXNQcmVzZW50KHRyYW5zYWN0aW9uLmZlZUN1cnJlbmN5KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL2Zvcm1hdHRlcnMuanMKICB2YXIgZm9ybWF0dGVyczMgPSB7CiAgICBibG9jazogLyogQF9fUFVSRV9fICovIGRlZmluZUJsb2NrKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBhcmdzLnRyYW5zYWN0aW9ucz8ubWFwKCh0cmFuc2FjdGlvbikgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbiA9PT0gInN0cmluZyIpCiAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLmZvcm1hdHRlZCwKICAgICAgICAgICAgLi4udHJhbnNhY3Rpb24uZ2F0ZXdheUZlZSA/IHsKICAgICAgICAgICAgICBnYXRld2F5RmVlOiBoZXhUb0JpZ0ludCh0cmFuc2FjdGlvbi5nYXRld2F5RmVlKSwKICAgICAgICAgICAgICBnYXRld2F5RmVlUmVjaXBpZW50OiB0cmFuc2FjdGlvbi5nYXRld2F5RmVlUmVjaXBpZW50CiAgICAgICAgICAgIH0gOiB7fSwKICAgICAgICAgICAgZmVlQ3VycmVuY3k6IHRyYW5zYWN0aW9uLmZlZUN1cnJlbmN5CiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0cmFuc2FjdGlvbnMsCiAgICAgICAgICAuLi5hcmdzLnJhbmRvbW5lc3MgPyB7IHJhbmRvbW5lc3M6IGFyZ3MucmFuZG9tbmVzcyB9IDoge30KICAgICAgICB9OwogICAgICB9CiAgICB9KSwKICAgIHRyYW5zYWN0aW9uOiAvKiBAX19QVVJFX18gKi8gZGVmaW5lVHJhbnNhY3Rpb24oewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGlmIChhcmdzLnR5cGUgPT09ICIweDdlIikKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlzU3lzdGVtVHg6IGFyZ3MuaXNTeXN0ZW1UeCwKICAgICAgICAgICAgbWludDogYXJncy5taW50ID8gaGV4VG9CaWdJbnQoYXJncy5taW50KSA6IHZvaWQgMCwKICAgICAgICAgICAgc291cmNlSGFzaDogYXJncy5zb3VyY2VIYXNoLAogICAgICAgICAgICB0eXBlOiAiZGVwb3NpdCIKICAgICAgICAgIH07CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7IGZlZUN1cnJlbmN5OiBhcmdzLmZlZUN1cnJlbmN5IH07CiAgICAgICAgaWYgKGFyZ3MudHlwZSA9PT0gIjB4N2IiKQogICAgICAgICAgdHJhbnNhY3Rpb24udHlwZSA9ICJjaXA2NCI7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3YyIpCiAgICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiY2lwNDIiOwogICAgICAgICAgdHJhbnNhY3Rpb24uZ2F0ZXdheUZlZSA9IGFyZ3MuZ2F0ZXdheUZlZSA/IGhleFRvQmlnSW50KGFyZ3MuZ2F0ZXdheUZlZSkgOiBudWxsOwogICAgICAgICAgdHJhbnNhY3Rpb24uZ2F0ZXdheUZlZVJlY2lwaWVudCA9IGFyZ3MuZ2F0ZXdheUZlZVJlY2lwaWVudDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICB9CiAgICB9KSwKICAgIHRyYW5zYWN0aW9uUmVxdWVzdDogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uUmVxdWVzdCh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHt9OwogICAgICAgIGlmIChhcmdzLmZlZUN1cnJlbmN5KQogICAgICAgICAgcmVxdWVzdC5mZWVDdXJyZW5jeSA9IGFyZ3MuZmVlQ3VycmVuY3k7CiAgICAgICAgaWYgKGlzQ0lQNjQoYXJncykpCiAgICAgICAgICByZXF1ZXN0LnR5cGUgPSAiMHg3YiI7CiAgICAgICAgcmV0dXJuIHJlcXVlc3Q7CiAgICAgIH0KICAgIH0pCiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vc2VyaWFsaXplcnMuanMKICBpbml0X251bWJlcigpOwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfYmFzZSgpOwogIGluaXRfY2hhaW4oKTsKICBpbml0X25vZGUoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uNCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBpZiAoaXNDSVA2NCh0cmFuc2FjdGlvbikpCiAgICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkNJUDY0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uMyh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgdmFyIHNlcmlhbGl6ZXJzMyA9IHsKICAgIHRyYW5zYWN0aW9uOiBzZXJpYWxpemVUcmFuc2FjdGlvbjQKICB9OwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uQ0lQNjQodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgYXNzZXJ0VHJhbnNhY3Rpb25DSVA2NCh0cmFuc2FjdGlvbik7CiAgICBjb25zdCB7IGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZmVlQ3VycmVuY3ksIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgIG1heEZlZVBlckdhcyA/IHRvSGV4KG1heEZlZVBlckdhcykgOiAiMHgiLAogICAgICBnYXMgPyB0b0hleChnYXMpIDogIjB4IiwKICAgICAgdG8gPz8gIjB4IiwKICAgICAgdmFsdWUgPyB0b0hleCh2YWx1ZSkgOiAiMHgiLAogICAgICBkYXRhID8/ICIweCIsCiAgICAgIHNlcmlhbGl6ZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCksCiAgICAgIGZlZUN1cnJlbmN5LAogICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKQogICAgXTsKICAgIHJldHVybiBjb25jYXRIZXgoWwogICAgICAiMHg3YiIsCiAgICAgIHRvUmxwKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikKICAgIF0pOwogIH0KICB2YXIgTUFYX01BWF9GRUVfUEVSX0dBUyA9IG1heFVpbnQyNTY7CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25DSVA2NCh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBjaGFpbklkLCBtYXhQcmlvcml0eUZlZVBlckdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgdG8sIGZlZUN1cnJlbmN5IH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmIChnYXNQcmljZSkKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImBnYXNQcmljZWAgaXMgbm90IGEgdmFsaWQgQ0lQLTY0IFRyYW5zYWN0aW9uIGF0dHJpYnV0ZS4iKTsKICAgIGlmIChpc1ByZXNlbnQobWF4RmVlUGVyR2FzKSAmJiBtYXhGZWVQZXJHYXMgPiBNQVhfTUFYX0ZFRV9QRVJfR0FTKQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzIH0pOwogICAgaWYgKGlzUHJlc2VudChtYXhQcmlvcml0eUZlZVBlckdhcykgJiYgaXNQcmVzZW50KG1heEZlZVBlckdhcykgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPiBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcyB9KTsKICAgIGlmIChpc1ByZXNlbnQoZmVlQ3VycmVuY3kpICYmICFpc0FkZHJlc3MoZmVlQ3VycmVuY3kpKSB7CiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgZmVlQ3VycmVuY3lgIE1VU1QgYmUgYSB0b2tlbiBhZGRyZXNzIGZvciBDSVAtNjQgdHJhbnNhY3Rpb25zLiIpOwogICAgfQogICAgaWYgKGlzRW1wdHkoZmVlQ3VycmVuY3kpKSB7CiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgZmVlQ3VycmVuY3lgIG11c3QgYmUgcHJvdmlkZWQgZm9yIENJUC02NCB0cmFuc2FjdGlvbnMuIik7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZzMgPSB7CiAgICBjb250cmFjdHMsCiAgICBmb3JtYXR0ZXJzOiBmb3JtYXR0ZXJzMywKICAgIHNlcmlhbGl6ZXJzOiBzZXJpYWxpemVyczMsCiAgICBmZWVzCiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jZWxvLmpzCiAgdmFyIGNlbG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWczLAogICAgaWQ6IDQyMjIwLAogICAgbmFtZTogIkNlbG8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ0VMTyIsCiAgICAgIHN5bWJvbDogIkNFTE8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9mb3Juby5jZWxvLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNlbG8gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY2Vsb3NjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmNlbG9zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMzExMjU5OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jZWxvQWxmYWpvcmVzLmpzCiAgdmFyIHNvdXJjZUlkMTMgPSAxN2UzOwogIHZhciBjZWxvQWxmYWpvcmVzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMywKICAgIGlkOiA0NDc4NywKICAgIG5hbWU6ICJBbGZham9yZXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ0VMTyIsCiAgICAgIHN5bWJvbDogIkEtQ0VMTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYWxmYWpvcmVzLWZvcm5vLmNlbG8tdGVzdG5ldC5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDZWxvIEFsZmFqb3JlcyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jZWxvLWFsZmFqb3Jlcy5ibG9ja3Njb3V0LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jZWxvLWFsZmFqb3Jlcy5ibG9ja3Njb3V0LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWczLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQ1NjkwMDEKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg4MjUyNzM1MzkyN2Q4RDA2OWIzQjQ1MjkwNGM5NDJkQTE0OUJBMzgxIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxMTMyNAogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkMTNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhFMjhBQWRjZDk4ODM3NDZjMGU1MDY4RjU4ZjllYTA2MDI3YjIxNGNiIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxMTMyNAogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDRhMjYzNWU5ZTRmNmU0NTgxN2IxRDQwMmFjNDkwNGMxZDE3NTI0MzgiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyNDExMzI0CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMTNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhEMUIwRTA1ODE5NzNjOWVCN2Y4ODY5NjdBNjA2Yjk0NDFBODk3MDM3IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxMTMyNAogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jaGFuZy5qcwogIHZhciBjaGFuZyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTg1OCwKICAgIG5hbWU6ICJDaGFuZyBDaGFpbiBGb3VuZGF0aW9uIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ1RIIiwKICAgICAgc3ltYm9sOiAiQ1RIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuY3Roc2Nhbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGFuZyBDaGFpbiBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jdGhzY2FuLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NoaWxpei5qcwogIHZhciBjaGlsaXogPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODg4LAogICAgbmFtZTogIkNoaWxpeiBDaGFpbiIsCiAgICBuZXR3b3JrOiAiY2hpbGl6LWNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNIWiIsCiAgICAgIHN5bWJvbDogIkNIWiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYW5rci5jb20vY2hpbGl6IiwKICAgICAgICAgICJodHRwczovL2NoaWxpei1ycGMucHVibGljbm9kZS5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGlsaXogRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5jaGlsaXouY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4uY2hpbGl6LmNvbS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jaGlwcy5qcwogIHZhciBjaGlwcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjg4MiwKICAgIG5hbWU6ICJDaGlwcyBOZXR3b3JrIiwKICAgIG5ldHdvcms6ICJDSElQUyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJJT1RBIiwKICAgICAgc3ltYm9sOiAiSU9UQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9ub2RlLmNoaXBzLm9vby93YXNwL2FwaS92MS9jaGFpbnMvaW90YTFwcDNkM21uYXAzdWZtZ3FuanNudzM0NHNxbWY1c3ZqaDI2eTJraG5tYzg5c3Y2Nzg4eTNyMjA3YThmbi9ldm0iCiAgICAgICAgXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2xhc3NpYy5qcwogIHZhciBjbGFzc2ljID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MSwKICAgIG5hbWU6ICJFdGhlcmV1bSBDbGFzc2ljIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUQyIsCiAgICAgIHN5bWJvbDogIkVUQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V0Yy5yaXZldC5saW5rIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmNvbS9ldGMvbWFpbm5ldCIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NvbmZsdXhFU3BhY2UuanMKICB2YXIgY29uZmx1eEVTcGFjZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAzMCwKICAgIG5hbWU6ICJDb25mbHV4IGVTcGFjZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQ29uZmx1eCIsIHN5bWJvbDogIkNGWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V2bS5jb25mbHV4cnBjLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ldm0uY29uZmx1eHJwYy5jb20vd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDb25mbHV4U2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ldm0uY29uZmx1eHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEVGZjAwNzg5MTBmNjM4Y2Q4MTk5NmNjMTE3YmNjRDNlRGYyQjA3MkYiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjg2MDI5MzUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NvbmZsdXhFU3BhY2VUZXN0bmV0LmpzCiAgdmFyIGNvbmZsdXhFU3BhY2VUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MSwKICAgIG5hbWU6ICJDb25mbHV4IGVTcGFjZSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJjZngtZXNwYWNlLXRlc3RuZXQiLAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJDb25mbHV4Iiwgc3ltYm9sOiAiQ0ZYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXZtdGVzdG5ldC5jb25mbHV4cnBjLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ldm10ZXN0bmV0LmNvbmZsdXhycGMuY29tL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ29uZmx1eFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtdGVzdG5ldC5jb25mbHV4c2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RUZmMDA3ODkxMGY2MzhjZDgxOTk2Y2MxMTdiY2NEM2VEZjJCMDcyRiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTc0OTkwNTAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NvcmVEYW8uanMKICB2YXIgY29yZURhbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTExNiwKICAgIG5hbWU6ICJDb3JlIERhbyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3JlIiwKICAgICAgc3ltYm9sOiAiQ09SRSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5jb3JlZGFvLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvcmVEYW8iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5jb3JlZGFvLm9yZyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTkwNzkzNAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jcmFiLmpzCiAgdmFyIGNyYWIgPSBkZWZpbmVDaGFpbih7CiAgICBpZDogNDQsCiAgICBuYW1lOiAiQ3JhYiBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyYWIgTmV0d29yayBOYXRpdmUgVG9rZW4iLAogICAgICBzeW1ib2w6ICJDUkFCIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9jcmFiLXJwYy5kYXJ3aW5pYS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2NyYWItcnBjLmRhcndpbmlhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiQmxvY2tzY291dCIsIHVybDogImh0dHBzOi8vY3JhYi1zY2FuLmRhcndpbmlhLm5ldHdvcmsiIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzAzMjU5MwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3Jvbm9zLmpzCiAgdmFyIGNyb25vcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjUsCiAgICBuYW1lOiAiQ3Jvbm9zIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ3Jvbm9zIiwKICAgICAgc3ltYm9sOiAiQ1JPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXZtLmNyb25vcy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDcm9ub3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuY3Jvbm9zLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1hcGkuY3Jvbm9zLm9yZy9tYWlubmV0L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTYzMTEyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jcm9ub3NUZXN0bmV0LmpzCiAgdmFyIGNyb25vc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzOCwKICAgIG5hbWU6ICJDcm9ub3MgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDUk8iLAogICAgICBzeW1ib2w6ICJ0Q1JPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXZtLXQzLmNyb25vcy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDcm9ub3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY3Jvbm9zLm9yZy9leHBsb3Jlci90ZXN0bmV0MyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDE5MTI1MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb25vc3prRVZNLmpzCiAgdmFyIGNyb25vc3prRVZNID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzODgsCiAgICBuYW1lOiAiQ3Jvbm9zIHprRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ3Jvbm9zIHprRVZNIENSTyIsCiAgICAgIHN5bWJvbDogInprQ1JPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC56a2V2bS5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIHprRVZNIChNYWlubmV0KSBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56a2V2bS5jcm9ub3Mub3JnIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3Jvbm9zemtFVk1UZXN0bmV0LmpzCiAgdmFyIGNyb25vc3prRVZNVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjgyLAogICAgbmFtZTogIkNyb25vcyB6a0VWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyb25vcyB6a0VWTSBUZXN0IENvaW4iLAogICAgICBzeW1ib2w6ICJ6a1RDUk8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnprZXZtLmNyb25vcy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDcm9ub3MgemtFVk0gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56a2V2bS5jcm9ub3Mub3JnL3Rlc3RuZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3Jvc3NiZWxsLmpzCiAgdmFyIGNyb3NzYmVsbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzczNywKICAgIG5hbWU6ICJDcm9zc2JlbGwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ1NCIiwKICAgICAgc3ltYm9sOiAiQ1NCIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuY3Jvc3NiZWxsLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvc3NTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uY3Jvc3NiZWxsLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4uY3Jvc3NiZWxsLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzODI0NjAzMQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3VydGlzLmpzCiAgdmFyIGN1cnRpcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzMxMTEsCiAgICBuYW1lOiAiQ3VydGlzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJBcGVDb2luIiwgc3ltYm9sOiAiQVBFIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmN1cnRpcy5hcGVjaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDdXJ0aXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuY3VydGlzLmFwZWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jeWJlci5qcwogIHZhciBjeWJlciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzU2MCwKICAgIG5hbWU6ICJDeWJlciIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9jeWJlci5hbHQudGVjaG5vbG9neSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vY3liZXJzY2FuLmNvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2N5YmVyc2Nhbi5jby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3liZXJUZXN0bmV0LmpzCiAgdmFyIGN5YmVyVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTExNTU3NTYwLAogICAgbmFtZTogIkN5YmVyIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vY3liZXItdGVzdG5ldC5hbHQudGVjaG5vbG9neSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5jeWJlcnNjYW4uY28iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5jeWJlcnNjYW4uY28vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmZmMzOTFGMDAxODI2OWQ0NzU4QUVBMWExNDQ3NzJFOEZCOTk1NDVFIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwNDU0NQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RhcndpbmlhLmpzCiAgdmFyIGRhcndpbmlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NiwKICAgIG5hbWU6ICJEYXJ3aW5pYSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJJTkciLAogICAgICBzeW1ib2w6ICJSSU5HIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZGFyd2luaWEubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZGFyd2luaWEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7IG5hbWU6ICJFeHBsb3JlciIsIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZGFyd2luaWEubmV0d29yayIgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2OTQyMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZGNoYWluLmpzCiAgdmFyIGRjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjcxNjQ0NjQyOTgzN2UzLAogICAgbmFtZTogIkRjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9kY2hhaW4tMjcxNjQ0NjQyOTgzNzAwMC0xLmpzb25ycGMuc2FnYXJwYy5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRjaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kY2hhaW4tMjcxNjQ0NjQyOTgzNzAwMC0xLnNhZ2FleHBsb3Jlci5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktZGNoYWluLTI3MTY0NDY0Mjk4MzcwMDAtMS5zYWdhZXhwbG9yZXIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kY2hhaW5UZXN0bmV0LmpzCiAgdmFyIGRjaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI3MTMwMTc5OTc1NzhlMywKICAgIG5hbWU6ICJEY2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL2RjaGFpbnRlc3RuZXQtMjcxMzAxNzk5NzU3ODAwMC0xLmpzb25ycGMudGVzdG5ldC5zYWdhcnBjLmlvIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRGNoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2RjaGFpbnRlc3RuZXQtMjcxMzAxNzk5NzU3ODAwMC0xLnRlc3RuZXQuc2FnYWV4cGxvcmVyLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1kY2hhaW50ZXN0bmV0LTI3MTMwMTc5OTc1NzgwMDAtMS50ZXN0bmV0LnNhZ2FleHBsb3Jlci5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RlZmljaGFpbkV2bS5qcwogIHZhciBkZWZpY2hhaW5Fdm0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMzAsCiAgICBuZXR3b3JrOiAiZGVmaWNoYWluLWV2bSIsCiAgICBuYW1lOiAiRGVGaUNoYWluIEVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJEZUZpQ2hhaW4iLAogICAgICBzeW1ib2w6ICJERkkiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoLm1haW5uZXQub2NlYW4uamVsbHlmaXNoc2RrLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRlRmlTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21ldGEuZGVmaXNjYW4ubGl2ZSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMzc4NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RlZmljaGFpbkV2bVRlc3RuZXQuanMKICB2YXIgZGVmaWNoYWluRXZtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEzMSwKICAgIG5ldHdvcms6ICJkZWZpY2hhaW4tZXZtLXRlc3RuZXQiLAogICAgbmFtZTogIkRlRmlDaGFpbiBFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRGVGaUNoYWluIiwKICAgICAgc3ltYm9sOiAiREZJIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC50ZXN0bmV0Lm9jZWFuLmplbGx5ZmlzaHNkay5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEZUZpU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tZXRhLmRlZmlzY2FuLmxpdmUvP25ldHdvcms9VGVzdE5ldCIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTY0NjIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZWdlbi5qcwogIHZhciBkZWdlbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjY2NjY2NjY2LAogICAgbmFtZTogIkRlZ2VuIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkRlZ2VuIiwKICAgICAgc3ltYm9sOiAiREVHRU4iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5kZWdlbi50aXBzIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5kZWdlbi50aXBzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRGVnZW4gQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZGVnZW4udGlwcyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5kZWdlbi50aXBzL2FwaS92MiIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Rmay5qcwogIHZhciBkZmsgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzOTM1LAogICAgbmFtZTogIkRGSyBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJKZXdlbCIsCiAgICAgIHN5bWJvbDogIkpFV0VMIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zdWJuZXRzLmF2YXgubmV0d29yay9kZWZpLWtpbmdkb21zL2Rmay1jaGFpbi9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJERktTdWJuZXRTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3N1Ym5ldHMuYXZheC5uZXR3b3JrL2RlZmkta2luZ2RvbXMiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQ3OTA1NTEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RvZG9jaGFpblRlc3RuZXQuanMKICB2YXIgZG9kb2NoYWluVGVzdG5ldCA9IGRlZmluZUNoYWluKHsKICAgIGlkOiA1MzQ1NywKICAgIG5hbWU6ICJET0RPY2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBkZWNpbWFsczogMTgsIG5hbWU6ICJET0RPIiwgc3ltYm9sOiAiRE9ETyIgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9kb2RvY2hhaW4tdGVzdG5ldC5hbHQudGVjaG5vbG9neSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9kb2RvY2hhaW4tdGVzdG5ldC5hbHQudGVjaG5vbG9neS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRPRE9jaGFpbiBUZXN0bmV0IChTZXBvbGlhKSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXNjYW4uZG9kb2NoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kb2dlY2hhaW4uanMKICB2YXIgZG9nZWNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyZTMsCiAgICBuYW1lOiAiRG9nZWNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIldyYXBwZWQgRG9nZWNvaW4iLAogICAgICBzeW1ib2w6ICJXRE9HRSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5kb2dlY2hhaW4uZG9nIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRG9nZUNoYWluRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZG9nZWNoYWluLmRvZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5kb2dlY2hhaW4uZG9nL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4NjhhODYwOWE2MGEwMDhFRkE2MzNkZmRlYzU5MmMwM0IwMzBjQzUwOCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNTM4NDAzMQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZG9zQ2hhaW4uanMKICB2YXIgZG9zQ2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc5NzksCiAgICBuYW1lOiAiRE9TIENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkRPUyBDaGFpbiIsCiAgICAgIHN5bWJvbDogIkRPUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW4uZG9zY2hhaW4uY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRE9TIENoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Rvc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuZG9zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MTkwOAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZG9zQ2hhaW5UZXN0bmV0LmpzCiAgdmFyIGRvc0NoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzkzOSwKICAgIG5hbWU6ICJET1MgQ2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJET1MgQ2hhaW4gVGVzdG5ldCIsCiAgICAgIHN5bWJvbDogIkRPUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3QuZG9zY2hhaW4uY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRE9TIENoYWluIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdC5kb3NjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3QuZG9zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY5NjIzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZHJleWVyeE1haW5uZXQuanMKICB2YXIgZHJleWVyeE1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzNDUxLAogICAgbmFtZTogIkRyZXllclggTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRHJleWVyWCIsCiAgICAgIHN5bWJvbDogIkRSWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZHJleWVyeC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEcmV5ZXJYIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5kcmV5ZXJ4LmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RyZXllcnhUZXN0bmV0LmpzCiAgdmFyIGRyZXllcnhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzQ1MiwKICAgIG5hbWU6ICJEcmV5ZXJYIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRyZXllclgiLAogICAgICBzeW1ib2w6ICJEUlgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHA6Ly90ZXN0bmV0LXJwYy5kcmV5ZXJ4LmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRyZXllclggVGVzdG5ldCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtc2Nhbi5kcmV5ZXJ4LmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kdXN0Ym95SW9ULmpzCiAgdmFyIGR1c3Rib3lJb1QgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU1NTg4OCwKICAgIG5hbWU6ICJEdXN0Qm95IElvVCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJEU1QiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9kdXN0Ym95LXJwYy5qaWJsMi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2R1c3Rib3kuamlibDIuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2R1c3Rib3kuamlibDIuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RkZEMzRhYTJDNjJCMkQ1MkUwMEEzNjFlNDY2QzIyOTc4OGY0ZUQ2YSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MjY1NjkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZHltZW5zaW9uLmpzCiAgdmFyIGR5bWVuc2lvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEwMCwKICAgIG5hbWU6ICJEeW1lbnNpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRZTSIsCiAgICAgIHN5bWJvbDogIkRZTSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9keW1lbnNpb24tZXZtLXJwYy5wdWJsaWNub2RlLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9keW1lbnNpb24tZXZtLXJwYy5wdWJsaWNub2RlLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkR5bSBGWUkiLAogICAgICAgIHVybDogImh0dHBzOi8vZHltLmZ5aSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWRnZWxlc3MuanMKICB2YXIgZWRnZWxlc3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjYsCiAgICBuYW1lOiAiRWRnZWxlc3MgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRWRnZWxlc3MgV3JhcHBlZCBFVEgiLAogICAgICBzeW1ib2w6ICJFd0VUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZWRnZWxlc3MubmV0d29yay9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5lZGdlbGVzcy5uZXR3b3JrL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWRnZWxlc3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZWRnZWxlc3MubmV0d29yayIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VkZ2VsZXNzVGVzdG5ldC5qcwogIHZhciBlZGdlbGVzc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMiwKICAgIG5hbWU6ICJFZGdlbGVzcyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFZGdlbGVzcyBXcmFwcGVkIEVUSCIsCiAgICAgIHN5bWJvbDogIkV3RVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2VkZ2VsZXNzLXRlc3RuZXQucnBjLmNhbGRlcmEueHl6L2h0dHAiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZWRnZWxlc3MtdGVzdG5ldC5ycGMuY2FsZGVyYS54eXovd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFZGdlbGVzcyBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuZXhwbG9yZXIuZWRnZWxlc3MubmV0d29yayIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VkZ2V3YXJlLmpzCiAgdmFyIGVkZ2V3YXJlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDIxLAogICAgbmFtZTogIkVkZ2V3YXJlIEVkZ2VFVk0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFZGdld2FyZSIsCiAgICAgIHN5bWJvbDogIkVERyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2VkZ2V3YXJlLWV2bS5qZWxsaWVkb3dsLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVkZ3NjYW4gYnkgQmhhcmF0aGNvb3JnIiwKICAgICAgICB1cmw6ICJodHRwczovL2VkZ3NjYW4ubGl2ZSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9lZGdzY2FuLmxpdmUvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4MTE3ODcyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lZGdld2FyZVRlc3RuZXQuanMKICB2YXIgZWRnZXdhcmVUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDIyLAogICAgbmFtZTogIkJlcmVzaGVldCBCZXJlRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVzdG5ldCBFREciLAogICAgICBzeW1ib2w6ICJ0RURHIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYmVyZXNoZWV0LWV2bS5qZWxsaWVkb3dsLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVkZ3NjYW4gYnkgQmhhcmF0aGNvb3JnIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuZWRnc2Nhbi5saXZlIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuZWRnc2Nhbi5saXZlL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VrdGEuanMKICB2YXIgZWt0YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTk5NCwKICAgIG5hbWU6ICJFa3RhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVLVEEiLAogICAgICBzeW1ib2w6ICJFS1RBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbWFpbi5la3RhLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWt0YXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZWt0YXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZWt0YXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWt0YVRlc3RuZXQuanMKICB2YXIgZWt0YVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMDQsCiAgICBuYW1lOiAiRWt0YSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVLVEEiLAogICAgICBzeW1ib2w6ICJFS1RBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdC5la3RhLmlvOjg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUZXN0IEVrdGFzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3QuZWt0YXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdC5la3Rhc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWxhc3Rvcy5qcwogIHZhciBlbGFzdG9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMCwKICAgIG5hbWU6ICJFbGFzdG9zIFNtYXJ0IENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFTEEiLCBzeW1ib2w6ICJFTEEiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkyLmVsYXN0b3MuaW8vZXRoIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWxhc3RvcyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lc2MuZWxhc3Rvcy5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWxhc3Rvc1Rlc3RuZXQuanMKICB2YXIgZWxhc3Rvc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIxLAogICAgbmFtZTogIkVsYXN0b3MgU21hcnQgQ2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEVMQSIsIHN5bWJvbDogInRFTEEiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGktdGVzdG5ldC5lbGFzdG9zLmlvL2V0aCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVsYXN0b3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXNjLXRlc3RuZXQuZWxhc3Rvcy5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lbGVjdHJvbmV1bS5qcwogIHZhciBlbGVjdHJvbmV1bSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTIwMTQsCiAgICBuYW1lOiAiRWxlY3Ryb25ldW0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRVROIiwKICAgICAgc3ltYm9sOiAiRVROIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5lbGVjdHJvbmV1bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFbGVjdHJvbmV1bSBCbG9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja2V4cGxvcmVyLmVsZWN0cm9uZXVtLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWxlY3Ryb25ldW1UZXN0bmV0LmpzCiAgdmFyIGVsZWN0cm9uZXVtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTIwMTQyMCwKICAgIG5hbWU6ICJFbGVjdHJvbmV1bSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFVE4iLAogICAgICBzeW1ib2w6ICJFVE4iLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMuZWxlY3Ryb25ldW0uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWxlY3Ryb25ldW0gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tleHBsb3Jlci50aGVzZWN1cml0eXRlYW0ucm9ja3MiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWx5c2l1bVRlc3RuZXQuanMKICB2YXIgZWx5c2l1bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEzMzgsCiAgICBuYW1lOiAiRWx5c2l1bSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkxBVkEiLAogICAgICBzeW1ib2w6ICJMQVZBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9lbHlzaXVtLXRlc3QtcnBjLnZ1bGNhbmZvcmdlZC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFbHlzaXVtIHRlc3RuZXQgZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZWx5c2l1bS1leHBsb3Jlci52dWxjYW5mb3JnZWQuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Vvbi5qcwogIHZhciBlb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDczMzIsCiAgICBuYW1lOiAiSG9yaXplbiBFT04iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWkVOIiwKICAgICAgc3ltYm9sOiAiWkVOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZW9uLXJwYy5ob3JpemVubGFicy5pby9ldGh2MSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVPTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lb24tZXhwbG9yZXIuaG9yaXplbmxhYnMuaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZW9zLmpzCiAgdmFyIGVvcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTc3NzcsCiAgICBuYW1lOiAiRU9TIEVWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFT1MiLAogICAgICBzeW1ib2w6ICJFT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkuZXZtLmVvc25ldHdvcmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRU9TIEVWTSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uZW9zbmV0d29yay5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLmVvc25ldHdvcmsuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3OTQzOTMzCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lb3NUZXN0bmV0LmpzCiAgdmFyIGVvc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE1NTU3LAogICAgbmFtZTogIkVPUyBFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFT1MiLAogICAgICBzeW1ib2w6ICJFT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkudGVzdG5ldC5ldm0uZW9zbmV0d29yay5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFT1MgRVZNIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5ldm0uZW9zbmV0d29yay5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5ldm0uZW9zbmV0d29yay5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDkwNjc5NDAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ldGhlcmxpbmsuanMKICB2YXIgZXRoZXJsaW5rID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Mjc5MywKICAgIG5hbWU6ICJFdGhlcmxpbmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGV6IiwKICAgICAgc3ltYm9sOiAiWFRaIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbm9kZS5tYWlubmV0LmV0aGVybGluay5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcmxpbmsiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXRoZXJsaW5rLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzg5OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXRoZXJsaW5rVGVzdG5ldC5qcwogIHZhciBldGhlcmxpbmtUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjgxMjMsCiAgICBuYW1lOiAiRXRoZXJsaW5rIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGV6IiwKICAgICAgc3ltYm9sOiAiWFRaIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbm9kZS5naG9zdG5ldC5ldGhlcmxpbmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJsaW5rIFRlc3RuZXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5ldGhlcmxpbmsuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2V2bW9zLmpzCiAgdmFyIGV2bW9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5MDAxLAogICAgbmFtZTogIkV2bW9zIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV2bW9zIiwKICAgICAgc3ltYm9sOiAiRVZNT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldGguYmQuZXZtb3Mub3JnOjg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdm1vcyBCbG9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lc2Nhbi5saXZlIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXZtb3NUZXN0bmV0LmpzCiAgdmFyIGV2bW9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOWUzLAogICAgbmFtZTogIkV2bW9zIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXZtb3MiLAogICAgICBzeW1ib2w6ICJFVk1PUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V0aC5iZC5ldm1vcy5kZXY6ODU0NSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV2bW9zIFRlc3RuZXQgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtLmV2bW9zLmRldi8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9leGNlbG9uTWFpbm5ldC5qcwogIHZhciBleGNlbG9uTWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjIwNTIwMDIsCiAgICBuYW1lOiAiRXhjZWxvbiBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJYTE9OIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV4Y2Vsb24iLAogICAgICBzeW1ib2w6ICJ4bG9uIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9lZGdld2FsbGV0MS54bG9uLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4Y2Vsb24gZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXhjZWxvbi5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZhbnRvbS5qcwogIHZhciBmYW50b20gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1MCwKICAgIG5hbWU6ICJGYW50b20iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRmFudG9tIiwKICAgICAgc3ltYm9sOiAiRlRNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmFua3IuY29tL2ZhbnRvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZUTVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZnRtc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmZ0bXNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzAwMTk4NwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmFudG9tU29uaWNUZXN0bmV0LmpzCiAgdmFyIGZhbnRvbVNvbmljVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjQyNDAsCiAgICBuYW1lOiAiRmFudG9tIFNvbmljIE9wZW4gVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiZmFudG9tLXNvbmljLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRmFudG9tIiwKICAgICAgc3ltYm9sOiAiRlRNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjYXBpLnNvbmljLmZhbnRvbS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmFudG9tIFNvbmljIE9wZW4gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wdWJsaWMtc29uaWMuZmFudG9tLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmFudG9tVGVzdG5ldC5qcwogIHZhciBmYW50b21UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MDAyLAogICAgbmFtZTogIkZhbnRvbSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZhbnRvbSIsCiAgICAgIHN5bWJvbDogIkZUTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmZhbnRvbS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRlRNU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmZ0bXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuZnRtc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDgzMjg2ODgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9maWJvLmpzCiAgdmFyIGZpYm8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMzA2LAogICAgbmFtZTogIkZpYm8gQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiZmlibyIsCiAgICAgIHN5bWJvbDogIkZJQk8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9uZXR3b3JrLmh6cm9jLmFydCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZpYm9TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uZmlib2NoYWluLm9yZyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZpbGVjb2luLmpzCiAgdmFyIGZpbGVjb2luID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMTQsCiAgICBuYW1lOiAiRmlsZWNvaW4gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJmaWxlY29pbiIsCiAgICAgIHN5bWJvbDogIkZJTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5ub2RlLmdsaWYuaW8vcnBjL3YxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmlsZm94IiwKICAgICAgICB1cmw6ICJodHRwczovL2ZpbGZveC5pbmZvL2VuIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMzMjg1OTQKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZpbGVjb2luQ2FsaWJyYXRpb24uanMKICB2YXIgZmlsZWNvaW5DYWxpYnJhdGlvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzE0MTU5LAogICAgbmFtZTogIkZpbGVjb2luIENhbGlicmF0aW9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRlc3RuZXQgZmlsZWNvaW4iLAogICAgICBzeW1ib2w6ICJ0RklMIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmNhbGlicmF0aW9uLm5vZGUuZ2xpZi5pby9ycGMvdjEiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGaWxzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2NhbGlicmF0aW9uLmZpbHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmlsZWNvaW5IeXBlcnNwYWNlLmpzCiAgdmFyIGZpbGVjb2luSHlwZXJzcGFjZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzE0MSwKICAgIG5hbWU6ICJGaWxlY29pbiBIeXBlcnNwYWNlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRlc3RuZXQgZmlsZWNvaW4iLAogICAgICBzeW1ib2w6ICJ0RklMIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmh5cGVyc3BhY2Uubm9kZS5nbGlmLmlvL3JwYy92MSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZpbGZveCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oeXBlcnNwYWNlLmZpbGZveC5pbmZvL2VuIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZsYXJlLmpzCiAgdmFyIGZsYXJlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNCwKICAgIG5hbWU6ICJGbGFyZSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZsYXJlIiwKICAgICAgc3ltYm9sOiAiRkxSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZmxhcmUtYXBpLmZsYXJlLm5ldHdvcmsvZXh0L0MvcnBjIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmxhcmUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZmxhcmUtZXhwbG9yZXIuZmxhcmUubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9mbGFyZS1leHBsb3Jlci5mbGFyZS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDAyNDYxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbGFyZVRlc3RuZXQuanMKICB2YXIgZmxhcmVUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTQsCiAgICBuYW1lOiAiRmxhcmUgVGVzdG5ldCBDb3N0b24yIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNvc3RvbjIgRmxhcmUiLAogICAgICBzeW1ib2w6ICJDMkZMUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2Nvc3RvbjItYXBpLmZsYXJlLm5ldHdvcmsvZXh0L0MvcnBjIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ29zdG9uMiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jb3N0b24yLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vY29zdG9uMi1leHBsb3Jlci5mbGFyZS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbG93TWFpbm5ldC5qcwogIHZhciBmbG93TWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzQ3LAogICAgbmFtZTogIkZsb3dFVk0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGbG93IiwKICAgICAgc3ltYm9sOiAiRkxPVyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5ldm0ubm9kZXMub25mbG93Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1haW5uZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZmxvd2RpdmVyLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmxvd1ByZXZpZXduZXQuanMKICB2YXIgZmxvd1ByZXZpZXduZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY0NiwKICAgIG5hbWU6ICJGbG93RVZNIFByZXZpZXduZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRmxvdyIsCiAgICAgIHN5bWJvbDogIkZMT1ciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3ByZXZpZXduZXQuZXZtLm5vZGVzLm9uZmxvdy5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQcmV2aWV3bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3ByZXZpZXduZXQuZmxvd2RpdmVyLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYyMDUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Zsb3dUZXN0bmV0LmpzCiAgdmFyIGZsb3dUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NDUsCiAgICBuYW1lOiAiRmxvd0VWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZsb3ciLAogICAgICBzeW1ib2w6ICJGTE9XIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LmV2bS5ub2Rlcy5vbmZsb3cub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmxvdyBEaXZlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmZsb3dkaXZlci5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMzc1MTgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZsdWVuY2UuanMKICB2YXIgZmx1ZW5jZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTk5OTk5OSwKICAgIG5hbWU6ICJGbHVlbmNlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGTFQiLCBzeW1ib2w6ICJGTFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWFpbm5ldC5mbHVlbmNlLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5tYWlubmV0LmZsdWVuY2UuZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lm1haW5uZXQuZmx1ZW5jZS5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYWlubmV0LmZsdWVuY2UuZGV2L2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZsdWVuY2VTdGFnZS5qcwogIHZhciBmbHVlbmNlU3RhZ2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMzQyMDAwMDIyMCwKICAgIG5hbWU6ICJGbHVlbmNlIFN0YWdlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJ0RkxUIiwgc3ltYm9sOiAidEZMVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5zdGFnZS5mbHVlbmNlLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5zdGFnZS5mbHVlbmNlLmRldiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5zdGFnZS5mbHVlbmNlLmRldiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnN0YWdlLmZsdWVuY2UuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbHVlbmNlVGVzdG5ldC5qcwogIHZhciBmbHVlbmNlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTIxNjQ4MDMsCiAgICBuYW1lOiAiRmx1ZW5jZSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJ0RkxUIiwgc3ltYm9sOiAidEZMVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmZsdWVuY2UuZGV2Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLnRlc3RuZXQuZmx1ZW5jZS5kZXYiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQudGVzdG5ldC5mbHVlbmNlLmRldiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnRlc3RuZXQuZmx1ZW5jZS5kZXYvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Zvcm1hLmpzCiAgdmFyIGZvcm1hID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5ODQxMjIsCiAgICBuYW1lOiAiRm9ybWEiLAogICAgbmV0d29yazogImZvcm1hIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIHN5bWJvbDogIlRJQSIsCiAgICAgIG5hbWU6ICJUSUEiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmZvcm1hLmFydCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5mb3JtYS5hcnQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGb3JtYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5mb3JtYS5hcnQiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGQ1M0M2RkZCMTIzRjczNDlBMzI5ODBGODdmYWVEOEZmRGM5ZWYwNzkiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjUyNzA1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mb3VuZHJ5LmpzCiAgdmFyIGZvdW5kcnkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMzM3LAogICAgbmFtZTogIkZvdW5kcnkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3M6Ly8xMjcuMC4wLjE6ODU0NSJdCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mcmF4dGFsLmpzCiAgdmFyIHNvdXJjZUlkMTQgPSAxOwogIHZhciBmcmF4dGFsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyNTIsCiAgICBuYW1lOiAiRnJheHRhbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnJheCBFdGhlciIsIHN5bWJvbDogImZyeEVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5mcmF4LmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImZyYXhzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2ZyYXhzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuZnJheHNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDE0XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjZDQzkxNkVkNUM2QzJGQTk3MDE0ZjdEMWNEMTQxNTI4QWUxNzFlNCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDM2Y2I2NWMxOTY3QTBGYjBFRUUxMTU2OUM1MUMyZjJhQTFDYTZmNkQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTEzNTMyMwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDE0XTogewogICAgICAgICAgYWRkcmVzczogIjB4MzRDMGJENTg3N0E1RWU3MDk5RDBmNTY4OEQ2NUY0YkI5MTU4QkRFMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5MTM1MzIzCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMTQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mcmF4dGFsVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDE1ID0gMTdlMzsKICB2YXIgZnJheHRhbFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI1MjIsCiAgICBuYW1lOiAiRnJheHRhbCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGcmF4IEV0aGVyIiwgc3ltYm9sOiAiZnJ4RVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQuZnJheC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJmcmF4c2NhbiB0ZXN0bmV0IiwKICAgICAgICB1cmw6ICJodHRwczovL2hvbGVza3kuZnJheHNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1ob2xlc2t5LmZyYXhzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDcxNUVBNjREQTEzRjRkMDgzMWVjZTRBZDNFOGMxYWEwMTMxNjdGMzIiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhCOWM2NEJmQTQ5OGQ1YjlhODM5OEVkNmY0NmViNzZkOTBkRTU1MDVkIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzE4NDE2CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMTVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgwQmFhZkMyMTcxNjJmNjQ5MzA5MDlhRDlmMkIyNzEyNTEyMWQ2MzMyIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzE4NDE2CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMTUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdW5raU1haW5uZXQuanMKICB2YXIgc291cmNlSWQxNiA9IDE7CiAgdmFyIGZ1bmtpTWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMzM5NzksCiAgICBuYW1lOiAiRnVua2kiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLW1haW5uZXQuZnVua2ljaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGdW5raSBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Z1bmtpc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzCiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMTYKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdW5raVNlcG9saWEuanMKICB2YXIgc291cmNlSWQxNyA9IDExMTU1MTExOwogIHZhciBmdW5raVNlcG9saWEgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMzM5NzkwMSwKICAgIG5ldHdvcms6ICJmdW5raVNlcG9saWEiLAogICAgbmFtZTogIkZ1bmtpIFNlcG9saWEgU2FuZGJveCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9mdW5raS10ZXN0bmV0LmFsdC50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRnVua2kgU2Vwb2xpYSBTYW5kYm94IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEtc2FuZGJveC5mdW5raWNoYWluLmNvbS8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MjAyMDQKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE3CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVzZS5qcwogIHZhciBmdXNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjIsCiAgICBuYW1lOiAiRnVzZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnVzZSIsIHN5bWJvbDogIkZVU0UiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmZ1c2UuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGdXNlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmZ1c2UuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZnVzZS5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTYxNDY2MjgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Z1c2VTcGFya25ldC5qcwogIHZhciBmdXNlU3BhcmtuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMywKICAgIG5hbWU6ICJGdXNlIFNwYXJrbmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTcGFyayIsIHN5bWJvbDogIlNQQVJLIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5mdXNlc3BhcmsuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTcGFya2VudCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5mdXNlc3BhcmsuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZnVzZXNwYXJrLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Z1c2lvbi5qcwogIHZhciBmdXNpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMyNjU5LAogICAgbmFtZTogIkZ1c2lvbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGdXNpb24iLCBzeW1ib2w6ICJGU04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LmZ1c2lvbm5ldHdvcmsuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5mdXNpb25uZXR3b3JrLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRlNOc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mc25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQ0MTYwNQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdXNpb25UZXN0bmV0LmpzCiAgdmFyIGZ1c2lvblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ2Njg4LAogICAgbmFtZTogIkZ1c2lvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGdXNpb24iLCBzeW1ib2w6ICJGU04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LmZ1c2lvbm5ldHdvcmsuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC5mdXNpb25uZXR3b3JrLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRlNOc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmZzbnNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNDI4MzA5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ2FybmV0LmpzCiAgdmFyIHNvdXJjZUlkMTggPSAxN2UzOwogIHZhciBnYXJuZXQgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBuYW1lOiAiR2FybmV0IFRlc3RuZXQiLAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGlkOiAxNzA2OSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE4LAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdhcm5ldGNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ2FybmV0Y2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5nYXJuZXRjaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDE4XTogewogICAgICAgICAgYWRkcmVzczogIjB4NTdlZTQwNTg2ZmJFMjg2QWZDNzVFNjdjYjY5NTExQTZEOWFGNTkwOSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyNzQ2ODQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMThdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhDYjhFN0FDNTYxYjhFRjA0RjJhMTU4NjVlOWZiYzA3NjZGRUY1NjlCIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTI3NDY4NAogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDE4XTogewogICAgICAgICAgYWRkcmVzczogIjB4MDliY0RkMzExRkUzOThGODBhNzhCRTM3RTQ4OWY1RDQ0MERCOTVERSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyNzQ2ODQKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9nZW5lc3lzLmpzCiAgdmFyIGdlbmVzeXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NTA3LAogICAgbmFtZTogIkdlbmVzeXMgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJHU1lTIiwKICAgICAgc3ltYm9sOiAiR1NZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5nZW5lc3lzLm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHZW5lc3lzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2djaGFpbmV4cGxvcmVyLmdlbmVzeXMubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ2xpZGVMMVByb3RvY29sLmpzCiAgdmFyIGdsaWRlTDFQcm90b2NvbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjUxLAogICAgbmFtZTogIkdsaWRlIEwxIFByb3RvY29sIFhQIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJHTFhQIiwgc3ltYm9sOiAiR0xYUCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy1hcGkuZ2xpZGVwcm90b2NvbC54eXovbDEtcnBjIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy1hcGkuZ2xpZGVwcm90b2NvbC54eXovbDEtcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR2xpZGUgUHJvdG9jb2wgRXhwbG9yZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja2NoYWluLWV4cGxvcmVyLmdsaWRlcHJvdG9jb2wueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9nbGlkZUwyUHJvdG9jb2wuanMKICB2YXIgZ2xpZGVMMlByb3RvY29sID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNTMsCiAgICBuYW1lOiAiR2xpZGUgTDIgUHJvdG9jb2wgWFAiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkdMWFAiLCBzeW1ib2w6ICJHTFhQIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLWFwaS5nbGlkZXByb3RvY29sLnh5ei9sMi1ycGMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLWFwaS5nbGlkZXByb3RvY29sLnh5ei9sMi1ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHbGlkZSBQcm90b2NvbCBFeHBsb3JlIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2NrY2hhaW4tZXhwbG9yZXIuZ2xpZGVwcm90b2NvbC54eXoiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npcy5qcwogIHZhciBnbm9zaXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMCwKICAgIG5hbWU6ICJHbm9zaXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdub3Npc2NoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ25vc2lzY2hhaW4uY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkdub3Npc3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ25vc2lzc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuZ25vc2lzc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjEwMjI0OTEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npc0NoaWFkby5qcwogIHZhciBnbm9zaXNDaGlhZG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAwLAogICAgbmFtZTogIkdub3NpcyBDaGlhZG8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNoaWFkb2NoYWluLm5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuY2hpYWRvY2hhaW4ubmV0L3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NjczMTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9nb2JpLmpzCiAgdmFyIGdvYmkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NjMsCiAgICBuYW1lOiAiSG9yaXplbiBHb2JpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVzdCBaRU4iLAogICAgICBzeW1ib2w6ICJ0WkVOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZ29iaS10ZXN0bmV0Lmhvcml6ZW5sYWJzLmlvL2V0aHYxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR29iaSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2JpLWV4cGxvcmVyLmhvcml6ZW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvQ2hhaW4uanMKICB2YXIgZ29DaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAsCiAgICBuYW1lOiAiR29DaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJHTyIsCiAgICAgIHN5bWJvbDogIkdPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmdvY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHb0NoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdvY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvZHdva2VuLmpzCiAgdmFyIGdvZHdva2VuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTQwMiwKICAgIG5hbWU6ICJHb2R3b2tlbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogInBDS0IiLCBzeW1ib2w6ICJwQ0tCIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3YxLm1haW5uZXQuZ29kd29rZW4uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR1cgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly92MS5nd3NjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1MDM0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvZXJsaS5qcwogIHZhciBnb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUsCiAgICBuYW1lOiAiR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJHb2VybGkgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vZXRoX2dvZXJsaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1nb2VybGkuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZmM0QUM3NUM0NkM5MTRhRjU4OTJkNmQzZUZGY2ViRDc5MTcyOTNGMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMzOTIwNgogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2NTA3NjcwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3Jhdml0eS5qcwogIHZhciBncmF2aXR5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjI1LAogICAgbmFtZTogIkdyYXZpdHkgQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRyIsIHN5bWJvbDogIkciLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3Jhdml0eS54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHcmF2aXR5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZjhhYzRCRUIyRjc1ZDJjRkZiNTg4YzYzMjUxMzQ3ZmRENjI5QjkyYyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjg1MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3VydVRlc3RuZXQuanMKICB2YXIgZ3VydVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI2MSwKICAgIG5hbWU6ICJHdXJ1IE5ldHdvcmsgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAidGVzdEdVUlUiLAogICAgICBzeW1ib2w6ICJ0R1VSVSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3VydW5ldHdvcmsuYWkvYXJjaGl2ZS8yNjEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHdXJ1c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmd1cnVuZXR3b3JrLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhbS5qcwogIHZhciBoYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUxMTIsCiAgICBuYW1lOiAiSGFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkhhbSIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmhhbS5mdW4iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmhhbS5mdW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIYW0gQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFtLmZ1biIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYW0uZnVuL2FwaS92MiIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcXFNYWlubmV0LmpzCiAgdmFyIGhhcXFNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTIzNSwKICAgIG5hbWU6ICJIQVFRIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmV0aC5oYXFxLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIQVFRIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYXFxLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFxcVRlc3RlZGdlMi5qcwogIHZhciBoYXFxVGVzdGVkZ2UyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NDIxMSwKICAgIG5hbWU6ICJIQVFRIFRlc3RlZGdlIDIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTVQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5ldGgudGVzdGVkZ2UyLmhhcXEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhBUVEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdGVkZ2UyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0ZWRnZTIuaGFxcS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcmRoYXQuanMKICB2YXIgaGFyZGhhdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEzMzcsCiAgICBuYW1lOiAiSGFyZGhhdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFybW9ueU9uZS5qcwogIHZhciBoYXJtb255T25lID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjY2NmU1LAogICAgbmFtZTogIkhhcm1vbnkgT25lIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJIYXJtb255IiwKICAgICAgc3ltYm9sOiAiT05FIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vaGFybW9ueSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhcm1vbnkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFybW9ueS5vbmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxODU3NTMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhc2hrZXlDaGFpblRlc3RuZXQuanMKICB2YXIgaGFzaGtleVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMywKICAgIG5hbWU6ICJIYXNoS2V5IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSGFzaEtleSBFY29Qb2ludHMiLAogICAgICBzeW1ib2w6ICJIU0siCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2hhc2hrZXljaGFpbi10ZXN0bmV0LmFsdC50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaEtleSBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXNoa2V5Y2hhaW4tdGVzdG5ldC1leHBsb3Jlci5hbHQudGVjaG5vbG9neSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYS5qcwogIHZhciBoZWRlcmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NSwKICAgIG5hbWU6ICJIZWRlcmEgTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLW1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL21haW5uZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYVByZXZpZXduZXQuanMKICB2YXIgaGVkZXJhUHJldmlld25ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjk3LAogICAgbmFtZTogIkhlZGVyYSBQcmV2aWV3bmV0IiwKICAgIG5ldHdvcms6ICJoZWRlcmEtcHJldmlld25ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBzeW1ib2w6ICJIQkFSIiwKICAgICAgbmFtZTogIkhCQVIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcHJldmlld25ldC5oYXNoaW8uaW8vYXBpIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGFzaHNjYW4uaW8vcHJldmlld25ldCIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oZWRlcmFUZXN0bmV0LmpzCiAgdmFyIGhlZGVyYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NiwKICAgIG5hbWU6ICJIZWRlcmEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL3Rlc3RuZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVsYS5qcwogIHZhciBoZWxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NjY4LAogICAgbmFtZTogIkhlbGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiSExVU0QiLAogICAgICBzeW1ib2w6ICJITFVTRCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5oZWxhY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGVsYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tYWlubmV0LWJsb2NrZXhwbG9yZXIuaGVsYWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVtaVNlcG9saWEuanMKICB2YXIgaGVtaVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc0MzExMSwKICAgIG5hbWU6ICJIZW1pIFNlcG9saWEiLAogICAgbmV0d29yazogIkhlbWkgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ycGMuaGVtaS5uZXR3b3JrL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhlbWkgU2Vwb2xpYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLmhlbWkueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hvbGVza3kuanMKICB2YXIgaG9sZXNreSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTdlMywKICAgIG5hbWU6ICJIb2xlc2t5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJIb2xlc2t5IEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoZXJldW0taG9sZXNreS1ycGMucHVibGljbm9kZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaG9sZXNreS5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWhvbGVza3kuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NwogICAgICB9LAogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODAxNjEzCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YTZBQzkzNUQ0OTcxRTNDRDEzM2I5NTBhRTA1M2JFQ0QxNmZFN2YzYiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5NzM0ODQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oeWNoYWluLmpzCiAgdmFyIGh5Y2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEsCiAgICBuYW1lOiAiSFlDSEFJTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oeWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaHljaGFpblRlc3RuZXQuanMKICB2YXIgaHljaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEyLAogICAgbmFtZTogIkhZQ0hBSU4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5oeWNoYWluLmNvbS9odHRwIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ltbXV0YWJsZVprRXZtLmpzCiAgdmFyIGltbXV0YWJsZVprRXZtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3MSwKICAgIG5hbWU6ICJJbW11dGFibGUgemtFVk0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5pbW11dGFibGUuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSW1tdXRhYmxlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmltbXV0YWJsZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuaW1tdXRhYmxlLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDIzNmJkQTQ1ODllNDRlNjg1MGY1YUM2YTc0QmZDYTM5OGE4NmM2YzAiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDMzNTk3MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaW1tdXRhYmxlWmtFdm1UZXN0bmV0LmpzCiAgdmFyIGltbXV0YWJsZVprRXZtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTM0NzMsCiAgICBuYW1lOiAiSW1tdXRhYmxlIHprRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmltbXV0YWJsZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJJbW11dGFibGUgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LmltbXV0YWJsZS5jb20vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgyQ0M3ODdFZDM2NDYwMEIwMjIyMzYxQzQxODgzMDhGYThFNjhiQTYwIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU5NzczOTEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pbkVWTS5qcwogIHZhciBpbkVWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjUyNSwKICAgIG5hbWU6ICJpbkVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkluamVjdGl2ZSIsCiAgICAgIHN5bWJvbDogIklOSiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQucnBjLmluZXZtLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiaW5FVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaW5ldm0uY2FsZGVyYWV4cGxvcmVyLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9pbmV2bS5jYWxkZXJhZXhwbG9yZXIueHl6L2FwaS92MiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTg2MDYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lua1NlcG9saWEuanMKICB2YXIgc291cmNlSWQxOSA9IDExMTU1MTExOwogIHZhciBpbmtTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA3NjMzNzMsCiAgICBuYW1lOiAiSW5rIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtZ2VsLXNlcG9saWEuaW5rb25jaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLXNlcG9saWEuaW5rb25jaGFpbi5jb20vIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXNlcG9saWEuaW5rb25jaGFpbi5jb20vYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDE5XTogewogICAgICAgICAgYWRkcmVzczogIjB4ODYwZTYyNmM3MDBhZjM4MTEzM2Q5ZjRhZjMxNDEyYTJkMWRiM2Q1ZCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDE5XTogewogICAgICAgICAgYWRkcmVzczogIjB4NWMxZDI5YzZjOWM4YjA4MDA2OTJhY2M5NWQ3MDBiY2I0OTY2YTFkNyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQxOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDMzZjYwNzE0YmJkNzRkNjJiNjZkNzkyMTNjMzQ4NjE0ZGU1MTkwMWMiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE5CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaW90YS5qcwogIHZhciBpb3RhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODIyLAogICAgbmFtZTogIklPVEEgRVZNIiwKICAgIG5ldHdvcms6ICJpb3RhZXZtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIklPVEEiLAogICAgICBzeW1ib2w6ICJJT1RBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9qc29uLXJwYy5ldm0uaW90YWxlZGdlci5uZXQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuanNvbi1ycGMuZXZtLmlvdGFsZWRnZXIubmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLmlvdGEub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmV2bS5pb3RhLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjUwMjIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGFUZXN0bmV0LmpzCiAgdmFyIGlvdGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDc1LAogICAgbmFtZTogIklPVEEgRVZNIFRlc3RuZXQiLAogICAgbmV0d29yazogImlvdGFldm0tdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJJT1RBIiwKICAgICAgc3ltYm9sOiAiSU9UQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vanNvbi1ycGMuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuanNvbi1ycGMuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0udGVzdG5ldC5pb3RhbGVkZ2VyLm5ldCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0udGVzdG5ldC5pb3RhbGVkZ2VyLm5ldC9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaW90ZXguanMKICB2YXIgaW90ZXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ2ODksCiAgICBuYW1lOiAiSW9UZVgiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW9UZVgiLAogICAgICBzeW1ib2w6ICJJT1RYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9iYWJlbC1hcGkubWFpbm5ldC5pb3RleC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9iYWJlbC1hcGkubWFpbm5ldC5pb3RleC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIklvVGVYU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9pb3RleHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjIxNjM2NzAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGV4VGVzdG5ldC5qcwogIHZhciBpb3RleFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ2OTAsCiAgICBuYW1lOiAiSW9UZVggVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJJb1RlWCIsCiAgICAgIHN5bWJvbDogIklPVFgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2JhYmVsLWFwaS50ZXN0bmV0LmlvdGV4LmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2JhYmVsLWFwaS50ZXN0bmV0LmlvdGV4LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSW9UZVhTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuaW90ZXhzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhiNWNlY0Q2ODk0YzZmNDczRWM3MjZBMTc2ZjE1MTIzOTlBMmUzNTVkIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MzQ3NTkyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvamJjLmpzCiAgdmFyIGpiYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg5OSwKICAgIG5hbWU6ICJKSUJDSEFJTiBMMSIsCiAgICBuZXR3b3JrOiAiamJjIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJKQkMiLCBzeW1ib2w6ICJKQkMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtbDEuamliY2hhaW4ubmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHAtbDEuamliY2hhaW4ubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cC1sMS5qaWJjaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjMEM4QzQ4NkQxNDY2QzU3RWZlMTNDMmJmMDAwZDRjNTZGNDdDQmRDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyOTkwNDgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvamJjVGVzdG5ldC5qcwogIHZhciBqYmNUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODk5MSwKICAgIG5hbWU6ICJKaWJjaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJ0SkJDIiwgc3ltYm9sOiAidEpCQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmppYmNoYWluLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLnRlc3RuZXQuamliY2hhaW4ubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cC50ZXN0bmV0LmppYmNoYWluLm5ldC9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGExYTg1OGFkOTA0MUI0NzQxZTYyMDM1NWEzRjk2QjNjNzhlNzBlY0UiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzI4NDgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYXJ1cmEuanMKICB2YXIga2FydXJhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2ODYsCiAgICBuYW1lOiAiS2FydXJhIiwKICAgIG5ldHdvcms6ICJrYXJ1cmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkthcnVyYSIsCiAgICAgIHN5bWJvbDogIktBUiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgtcnBjLWthcnVyYS5hY2EtYXBpLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXRoLXJwYy1rYXJ1cmEuYWNhLWFwaS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2FydXJhIEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5rYXJ1cmEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmthcnVyYS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2FrYXJvdFNlcG9saWEuanMKICB2YXIga2FrYXJvdFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4MDIyMDM3NjQsCiAgICBuYW1lOiAiS2FrYXJvdCBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5rYWthcm90Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktha2Fyb3QgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmtha2Fyb3RzY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYWthcm90U3RhcmtuZXRTZXBvbGlhLmpzCiAgdmFyIGtha2Fyb3RTdGFya25ldFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDkyMDYzNzkwNzI4ODE2NSwKICAgIG5hbWU6ICJLYWthcm90IFN0YXJrbmV0IFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEtcnBjLmtha2Fyb3Qub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2FrYXJvdCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEua2FrYXJvdHNjYW4ub3JnIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2thcmRpYUNoYWluLmpzCiAgdmFyIGthcmRpYUNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNCwKICAgIG5hbWU6ICJLYXJkaWFDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJLQUkiLCBzeW1ib2w6ICJLQUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMua2FyZGlhY2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLYXJkaWFDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rYXJkaWFjaGFpbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2F2YS5qcwogIHZhciBrYXZhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMjIyLAogICAgbmFtZTogIkthdmEgRVZNIiwKICAgIG5ldHdvcms6ICJrYXZhLW1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkthdmEiLAogICAgICBzeW1ib2w6ICJLQVZBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldm0ua2F2YS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthdmEgRVZNIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2thdmFzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9rYXZhc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM2NjExNjUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2F2YVRlc3RuZXQuanMKICB2YXIga2F2YVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMjEsCiAgICBuYW1lOiAiS2F2YSBFVk0gVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAia2F2YS10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJLYXZhIiwKICAgICAgc3ltYm9sOiAiS0FWQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXZtLnRlc3RuZXQua2F2YS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthdmEgRVZNIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5rYXZhc2Nhbi5jb20vIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQua2F2YXNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RGYxRDcyNEE3MTY2MjYxZUVCMDE1NDE4ZmU4Yzc2NzlCQkVhN2ZkNiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3MjQyMTc5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2NjLmpzCiAgdmFyIGtjYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzIxLAogICAgbmFtZTogIktDQyBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJLQ0MgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLQ1MiLAogICAgICBzeW1ib2w6ICJLQ1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2tjYy1ycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsgbmFtZTogIktDQyBFeHBsb3JlciIsIHVybDogImh0dHBzOi8vZXhwbG9yZXIua2NjLmlvIiB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDExNzYwNDMwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2tpbnRvLmpzCiAgdmFyIGtpbnRvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3ODg3LAogICAgbmFtZTogIktpbnRvIE1haW5uZXQiLAogICAgbmV0d29yazogIktpbnRvIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5raW50by54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktpbnRvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmtpbnRvLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2xheXRuLmpzCiAgdmFyIGtsYXl0biA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODIxNywKICAgIG5hbWU6ICJLbGF5dG4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiS2xheXRuIiwKICAgICAgc3ltYm9sOiAiS0xBWSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1lbi1jeXByZXNzLmtsYXl0bi5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLbGF5dG5TY29wZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY29wZS5rbGF5dG4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDk2MDAyNDE1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYWlhLmpzCiAgdmFyIGthaWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgyMTcsCiAgICBuYW1lOiAiS2FpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLYWlhIiwKICAgICAgc3ltYm9sOiAiS0FJQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1lbi5ub2RlLmthaWEuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLYWlhU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9rYWlhc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktY3lwcmVzcy5rbGF5dG5zY29wZS5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDk2MDAyNDE1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYWlyb3MuanMKICB2YXIga2Fpcm9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDAxLAogICAgbmFtZTogIkthaXJvcyBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJrYWlyb3MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiS2Fpcm9zIEtBSUEiLAogICAgICBzeW1ib2w6ICJLQUlBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLWVuLWthaXJvcy5ub2RlLmthaWEuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLYWlhU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9rYWlyb3Mua2FpYXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTIzMzkwNTkzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2xheXRuQmFvYmFiLmpzCiAgdmFyIGtsYXl0bkJhb2JhYiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAwMSwKICAgIG5hbWU6ICJLbGF5dG4gQmFvYmFiIFRlc3RuZXQiLAogICAgbmV0d29yazogImtsYXl0bi1iYW9iYWIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQmFvYmFiIEtsYXl0biIsCiAgICAgIHN5bWJvbDogIktMQVkiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wdWJsaWMtZW4tYmFvYmFiLmtsYXl0bi5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLbGF5dG5TY29wZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iYW9iYWIua2xheXRuc2NvcGUuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyMzM5MDU5MwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2tvaS5qcwogIHZhciBrb2kgPSBkZWZpbmVDaGFpbih7CiAgICBpZDogNzAxLAogICAgbmFtZTogIktvaSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIktvaSBOZXR3b3JrIE5hdGl2ZSBUb2tlbiIsCiAgICAgIHN5bWJvbDogIktSSU5HIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9rb2ktcnBjLmRhcndpbmlhLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8va29pLXJwYy5kYXJ3aW5pYS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsgbmFtZTogIkJsb2Nrc2NvdXQiLCB1cmw6ICJodHRwczovL2tvaS1zY2FuLmRhcndpbmlhLm5ldHdvcmsiIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTgwMDAxCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva3JvbWEuanMKICB2YXIga3JvbWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1NSwKICAgIG5hbWU6ICJLcm9tYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRVRIIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLmtyb21hLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLcm9tYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lmtyb21hLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5rcm9tYS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva3JvbWFTZXBvbGlhLmpzCiAgdmFyIGtyb21hU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjM1OCwKICAgIG5hbWU6ICJLcm9tYSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZXBvbGlhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLnNlcG9saWEua3JvbWEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktyb21hIFNlcG9saWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5zZXBvbGlhLmtyb21hLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5zZXBvbGlhLmtyb21hLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2wzeC5qcwogIHZhciBsM3ggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMzI0LAogICAgbmFtZTogIkwzWCBQcm90b2NvbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtbWFpbm5ldC5sM3guY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy1tYWlubmV0LmwzeC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMM1ggTWFpbm5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5sM3guY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmwzeC5jb20vYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9sM3hUZXN0bmV0LmpzCiAgdmFyIGwzeFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMzI1LAogICAgbmFtZTogIkwzWCBQcm90b2NvbCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0LmwzeC5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLXRlc3RuZXQubDN4LmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkwzWCBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQubDN4LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci10ZXN0bmV0LmwzeC5jb20vYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xhdml0YS5qcwogIHZhciBsYXZpdGEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM2MDg5MCwKICAgIG5hbWU6ICJMQVZJVEEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidlRGVUVMIiwgc3ltYm9sOiAidlRGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdHN1YjM2MDg5MC1ldGgtcnBjLnRoZXRhdG9rZW4ub3JnL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkxBVklUQSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90c3ViMzYwODkwLWV4cGxvcmVyLnRoZXRhdG9rZW4ub3JnIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saWdodGxpbmtQZWdhc3VzLmpzCiAgdmFyIGxpZ2h0bGlua1BlZ2FzdXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4OTEsCiAgICBuYW1lOiAiTGlnaHRMaW5rIFBlZ2FzdXMgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAibGlnaHRsaW5rLXBlZ2FzdXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JlcGxpY2F0b3IucGVnYXN1cy5saWdodGxpbmsuaW8vcnBjL3YxIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTGlnaHRMaW5rIFBlZ2FzdXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGVnYXN1cy5saWdodGxpbmsuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGlnaHRsaW5rUGhvZW5peC5qcwogIHZhciBsaWdodGxpbmtQaG9lbml4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxODkwLAogICAgbmFtZTogIkxpZ2h0TGluayBQaG9lbml4IE1haW5uZXQiLAogICAgbmV0d29yazogImxpZ2h0bGluay1waG9lbml4IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9yZXBsaWNhdG9yLnBob2VuaXgubGlnaHRsaW5rLmlvL3JwYy92MSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkxpZ2h0TGluayBQaG9lbml4IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Bob2VuaXgubGlnaHRsaW5rLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2xpbmVhL2FjdGlvbnMvZXN0aW1hdGVHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2dldENhbGxFcnJvcigpOwogIGluaXRfZXh0cmFjdCgpOwogIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVHYXMyKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50IH0gPSBhcmdzOwogICAgaWYgKCFhY2NvdW50XykKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKCk7CiAgICBjb25zdCBhY2NvdW50ID0gcGFyc2VBY2NvdW50KGFjY291bnRfKTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgYWNjZXNzTGlzdCwgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlLCAuLi5yZXN0IH0gPSBhcmdzOwogICAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgICBhc3NlcnRSZXF1ZXN0KGFyZ3MpOwogICAgICBjb25zdCBjaGFpbkZvcm1hdCA9IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVycz8udHJhbnNhY3Rpb25SZXF1ZXN0Py5mb3JtYXQ7CiAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgICAgLy8gUGljayBvdXQgZXh0cmEgZGF0YSB0aGF0IG1pZ2h0IGV4aXN0IG9uIHRoZSBjaGFpbidzIHRyYW5zYWN0aW9uIHJlcXVlc3QgdHlwZS4KICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgIG5vbmNlLAogICAgICAgIHRvLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgICBjb25zdCB7IGJhc2VGZWVQZXJHYXMsIGdhc0xpbWl0LCBwcmlvcml0eUZlZVBlckdhcyB9ID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImxpbmVhX2VzdGltYXRlR2FzIiwKICAgICAgICBwYXJhbXM6IGJsb2NrID8gW3JlcXVlc3QsIGJsb2NrXSA6IFtyZXF1ZXN0XQogICAgICB9KTsKICAgICAgcmV0dXJuIHsKICAgICAgICBiYXNlRmVlUGVyR2FzOiBCaWdJbnQoYmFzZUZlZVBlckdhcyksCiAgICAgICAgZ2FzTGltaXQ6IEJpZ0ludChnYXNMaW1pdCksCiAgICAgICAgcHJpb3JpdHlGZWVQZXJHYXM6IEJpZ0ludChwcmlvcml0eUZlZVBlckdhcykKICAgICAgfTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICB0aHJvdyBnZXRDYWxsRXJyb3IoZXJyLCB7CiAgICAgICAgLi4uYXJncywKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4KICAgICAgfSk7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vbGluZWEvY2hhaW5Db25maWcuanMKICB2YXIgY2hhaW5Db25maWc0ID0gewogICAgZmVlczogewogICAgICBlc3RpbWF0ZUZlZXNQZXJHYXM6IGVzdGltYXRlRmVlc1BlckdhczIsCiAgICAgIGFzeW5jIG1heFByaW9yaXR5RmVlUGVyR2FzKHsgYmxvY2ssIGNsaWVudCwgcmVxdWVzdCB9KSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBlc3RpbWF0ZUZlZXNQZXJHYXMyKHsKICAgICAgICAgIGJsb2NrLAogICAgICAgICAgY2xpZW50LAogICAgICAgICAgbXVsdGlwbHk6ICh4KSA9PiB4LAogICAgICAgICAgcmVxdWVzdCwKICAgICAgICAgIHR5cGU6ICJlaXAxNTU5IgogICAgICAgIH0pOwogICAgICAgIGlmICghcmVzcG9uc2U/Lm1heFByaW9yaXR5RmVlUGVyR2FzKQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLm1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICB9CiAgICB9CiAgfTsKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZUZlZXNQZXJHYXMyKHsgY2xpZW50LCBtdWx0aXBseSwgcmVxdWVzdCwgdHlwZSB9KSB7CiAgICB0cnkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVzdGltYXRlR2FzMihjbGllbnQsIHsKICAgICAgICAuLi5yZXF1ZXN0LAogICAgICAgIGFjY291bnQ6IHJlcXVlc3Q/LmFjY291bnQKICAgICAgfSk7CiAgICAgIGNvbnN0IHsgcHJpb3JpdHlGZWVQZXJHYXM6IG1heFByaW9yaXR5RmVlUGVyR2FzIH0gPSByZXNwb25zZTsKICAgICAgY29uc3QgYmFzZUZlZVBlckdhcyA9IG11bHRpcGx5KEJpZ0ludChyZXNwb25zZS5iYXNlRmVlUGVyR2FzKSk7CiAgICAgIGNvbnN0IG1heEZlZVBlckdhcyA9IGJhc2VGZWVQZXJHYXMgKyBtYXhQcmlvcml0eUZlZVBlckdhczsKICAgICAgaWYgKHR5cGUgPT09ICJsZWdhY3kiKQogICAgICAgIHJldHVybiB7IGdhc1ByaWNlOiBtYXhGZWVQZXJHYXMgfTsKICAgICAgcmV0dXJuIHsKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMKICAgICAgfTsKICAgIH0gY2F0Y2ggewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGluZWEuanMKICB2YXIgbGluZWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWc0LAogICAgaWQ6IDU5MTQ0LAogICAgbmFtZTogIkxpbmVhIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkxpbmVhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmxpbmVhLmJ1aWxkIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9saW5lYXNjYW4uYnVpbGQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmxpbmVhc2Nhbi5idWlsZC9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGluZWFHb2VybGkuanMKICB2YXIgbGluZWFHb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5MTQwLAogICAgbmFtZTogIkxpbmVhIEdvZXJsaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJMaW5lYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5nb2VybGkubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmdvZXJsaS5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkubGluZWFzY2FuLmJ1aWxkIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1nb2VybGkubGluZWFzY2FuLmJ1aWxkL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0OTg2MjMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYVNlcG9saWEuanMKICB2YXIgbGluZWFTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnNCwKICAgIGlkOiA1OTE0MSwKICAgIG5hbWU6ICJMaW5lYSBTZXBvbGlhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkxpbmVhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNlcG9saWEubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLnNlcG9saWEubGluZWEuYnVpbGQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5saW5lYXNjYW4uYnVpbGQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEubGluZWFzY2FuLmJ1aWxkL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMjc0MjcKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYVRlc3RuZXQuanMKICB2YXIgbGluZWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1OTE0MCwKICAgIG5hbWU6ICJMaW5lYSBHb2VybGkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTGluZWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ29lcmxpLmxpbmVhLmJ1aWxkIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5nb2VybGkubGluZWEuYnVpbGQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ29lcmxpLmxpbmVhc2Nhbi5idWlsZCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9nb2VybGkubGluZWFzY2FuLmJ1aWxkL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0OTg2MjMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saXNrLmpzCiAgdmFyIHNvdXJjZUlkMjAgPSAxOwogIHZhciBsaXNrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxMTM1LAogICAgbmFtZTogIkxpc2siLAogICAgbmV0d29yazogImxpc2siLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5hcGkubGlzay5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQubGlzay5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5saXNrLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEE5ZDcxRTFkZDdjYTI2RjI2ZTY1NkU2NmQ2QUE4MWVkN2Y3NDViZjAiCiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxMTNjQjk5MjgzQUYyNDJEYTBBMEM1NDM0NzY2N2VkRjUzMUFhN2Q2IgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNmRCOTNGOGI4YjRmNzAxNjI0MGFmNjJGNzczMDk3OWQzNTNmOUE3IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIwXTogewogICAgICAgICAgYWRkcmVzczogIjB4MjY1ODcyM0JmNzBjNzY2N0RlNkIyNUY5OWZjY2UxM0ExNkQyNWQwOCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyMAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpc2tTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMjEgPSAxMTE1NTExMTsKICB2YXIgbGlza1NlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDQyMDIsCiAgICBuZXR3b3JrOiAibGlzay1zZXBvbGlhIiwKICAgIG5hbWU6ICJMaXNrIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2Vwb2xpYS1hcGkubGlzay5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEtYmxvY2tzY291dC5saXNrLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zZXBvbGlhLWJsb2Nrc2NvdXQubGlzay5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhBMEUzNUY1NkMzMThERTFiRDVEOWNhNkE5NEZlN2UzN0M1NjYzMzQ4IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDIxXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZTNkOTBGMjE0OTA2ODZFYzdlRjM3QkU3ODhFMDJkZkMxMjc4NzI2NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyMV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDFGYjMwZTQ0NmVBNzkxY2QxZjAxMTY3NUU1RjNmNTMxMWI3MGZhRjUiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDIxCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbG9jYWxob3N0LmpzCiAgdmFyIGxvY2FsaG9zdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMzNywKICAgIG5hbWU6ICJMb2NhbGhvc3QiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0gfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xvb3AuanMKICB2YXIgbG9vcCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTU1NTEsCiAgICBuYW1lOiAiTG9vcE5ldHdvcmsgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiTE9PUCIsCiAgICAgIHN5bWJvbDogIkxPT1AiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLm1haW5uZXRsb29wLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkxvb3BOZXR3b3JrIEJsb2NrY2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWFpbm5ldGxvb3AuY29tLyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbHVrc28uanMKICB2YXIgbHVrc28gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyLAogICAgbmV0d29yazogImx1a3NvIiwKICAgIG5hbWU6ICJMVUtTTyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiTFVLU08iLAogICAgICBzeW1ib2w6ICJMWVgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQubHVrc28ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy1ycGMubWFpbm5ldC5sdWtzby5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTFVLU08gTWFpbm5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5leGVjdXRpb24ubWFpbm5ldC5sdWtzby5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5leHBsb3Jlci5leGVjdXRpb24ubWFpbm5ldC5sdWtzby5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NjgxODMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2x1a3NvVGVzdG5ldC5qcwogIHZhciBsdWtzb1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyMDEsCiAgICBuYW1lOiAiTFVLU08gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJMVUtTTyBUZXN0bmV0IiwKICAgICAgc3ltYm9sOiAiTFlYdCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQubHVrc28ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy1ycGMudGVzdG5ldC5sdWtzby5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTFVLU08gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5leGVjdXRpb24udGVzdG5ldC5sdWtzby5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5leHBsb3Jlci5leGVjdXRpb24udGVzdG5ldC5sdWtzby5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MDUzNDgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9seWNhbi5qcwogIHZhciBseWNhbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzIxLAogICAgbmFtZTogIkx5Y2FuIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkx5Y2FuIiwKICAgICAgc3ltYm9sOiAiTFlDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYy5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly91cy1lYXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJodHRwczovL3VzLXdlc3QubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgImh0dHBzOi8vZXUtbm9ydGgubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgImh0dHBzOi8vZXUtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9hc2lhLXNvdXRoZWFzdC5seWNhbmNoYWluLmNvbSIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3JwYy5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vdXMtZWFzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vdXMtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vZXUtbm9ydGgubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgIndzczovL2V1LXdlc3QubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgIndzczovL2FzaWEtc291dGhlYXN0Lmx5Y2FuY2hhaW4uY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTHljYW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubHljYW5jaGFpbi5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9seXJhLmpzCiAgdmFyIGx5cmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk1NywKICAgIG5hbWU6ICJMeXJhIENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5seXJhLmZpbmFuY2UiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMeXJhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmx5cmEuZmluYW5jZSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5seXJhLmZpbmFuY2UvYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5MzUxOTgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21haW5uZXQuanMKICB2YXIgbWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMSwKICAgIG5hbWU6ICJFdGhlcmV1bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9jbG91ZGZsYXJlLWV0aC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5ldGhlcnNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGVuc1JlZ2lzdHJ5OiB7CiAgICAgICAgYWRkcmVzczogIjB4MDAwMDAwMDAwMDBDMkUwNzRlQzY5QTBkRmIyOTk3QkE2QzdkMmUxZSIKICAgICAgfSwKICAgICAgZW5zVW5pdmVyc2FsUmVzb2x2ZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjZTAxZjhlZWU3RTQ3OUM5MjhGODkxOWFiRDUzRTU1M2EzNkNlRjY3IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5MjU4MjEzCiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0MzUzNjAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW5kYWxhLmpzCiAgdmFyIG1hbmRhbGEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5NSwKICAgIG5hbWU6ICJNYW5kYWxhIFRDOSIsCiAgICBuZXR3b3JrOiAibWFuZGFsYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiTWFuZGFsYSIsCiAgICAgIHN5bWJvbDogIm1BQ0EiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoLXJwYy10YzkuYWNhLXN0YWdpbmcubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ldGgtcnBjLXRjOS5hY2Etc3RhZ2luZy5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFuZGFsYSBCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQubWFuZGFsYS5hY2Etc3RhZ2luZy5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQubWFuZGFsYS5hY2Etc3RhZ2luZy5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50YS5qcwogIHZhciBtYW50YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY5LAogICAgbmFtZTogIk1hbnRhIFBhY2lmaWMgTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAibWFudGEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcGFjaWZpYy1ycGMubWFudGEubmV0d29yay9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5tYW50YS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3BhY2lmaWMtZXhwbG9yZXIubWFudGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzMyODkwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50YVNlcG9saWFUZXN0bmV0LmpzCiAgdmFyIG1hbnRhU2Vwb2xpYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM0NDEwMDYsCiAgICBuYW1lOiAiTWFudGEgUGFjaWZpYyBTZXBvbGlhIFRlc3RuZXQiLAogICAgbmV0d29yazogIm1hbnRhLXNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wYWNpZmljLXJwYy5zZXBvbGlhLXRlc3RuZXQubWFudGEubmV0d29yay9odHRwIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGEgU2Vwb2xpYSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3BhY2lmaWMtZXhwbG9yZXIuc2Vwb2xpYS10ZXN0bmV0Lm1hbnRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5zZXBvbGlhLXRlc3RuZXQubWFudGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhNTQ5MThmN0I1MjVDOGRmODk0NjY4ODQ2NTA2NzY3NDEyYjUzRTMiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDc5NTg0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFudGFUZXN0bmV0LmpzCiAgdmFyIG1hbnRhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzQ0MTAwNSwKICAgIG5hbWU6ICJNYW50YSBQYWNpZmljIFRlc3RuZXQiLAogICAgbmV0d29yazogIm1hbnRhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbWFudGEtdGVzdG5ldC5jYWxkZXJhY2hhaW4ueHl6L2h0dHAiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50YSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3BhY2lmaWMtZXhwbG9yZXIudGVzdG5ldC5tYW50YS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3BhY2lmaWMtZXhwbG9yZXIudGVzdG5ldC5tYW50YS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4MjExQjE2NDNiOTVGZTc2ZjExZUQ4ODgwRUU4MTBBQkQ5QTRjZjU2QyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MTk5MTUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50bGUuanMKICB2YXIgbWFudGxlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1ZTMsCiAgICBuYW1lOiAiTWFudGxlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1OVCIsCiAgICAgIHN5bWJvbDogIk1OVCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tYW50bGUueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGxlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL21hbnRsZXNjYW4ueHl6LyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkubWFudGxlc2Nhbi54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwNDcxNwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFudGxlU2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgbWFudGxlU2Vwb2xpYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUwMDMsCiAgICBuYW1lOiAiTWFudGxlIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNTlQiLAogICAgICBzeW1ib2w6ICJNTlQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2Vwb2xpYS5tYW50bGUueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGxlIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Vwb2xpYS5tYW50bGUueHl6LyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zZXBvbGlhLm1hbnRsZS54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ1ODQwMTIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50bGVUZXN0bmV0LmpzCiAgdmFyIG1hbnRsZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUwMDEsCiAgICBuYW1lOiAiTWFudGxlIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTU5UIiwKICAgICAgc3ltYm9sOiAiTU5UIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQubWFudGxlLnh5eiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1hbnRsZSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQubWFudGxlLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0Lm1hbnRsZS54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU2MTMzMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hcFByb3RvY29sLmpzCiAgdmFyIG1hcFByb3RvY29sID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMjc3NiwKICAgIG5hbWU6ICJNQVAgUHJvdG9jb2wiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTUFQTyIsCiAgICAgIHN5bWJvbDogIk1BUE8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMubWFwbGFicy5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1BUE8gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tYXBvc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWF0Y2hhaW4uanMKICB2YXIgbWF0Y2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY5OCwKICAgIG5hbWU6ICJNYXRjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQk5CIiwKICAgICAgc3ltYm9sOiAiQk5CIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMubWF0Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYXRjaGFpbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21hdGNoc2Nhbi5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hdGNoYWluVGVzdG5ldC5qcwogIHZhciBtYXRjaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY5OSwKICAgIG5hbWU6ICJNYXRjaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCTkIiLAogICAgICBzeW1ib2w6ICJCTkIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLm1hdGNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWF0Y2hhaW4gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0Lm1hdGNoc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZWxkLmpzCiAgdmFyIG1lbGQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMzAwMDMzMywKICAgIG5hbWU6ICJNZWxkIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1lbGQiLAogICAgICBzeW1ib2w6ICJNRUxEIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLTEubWVsZC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiTUVMRHNjYW4iLCB1cmw6ICJodHRwczovL21lbGRzY2FuLmlvIiB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg3NjllZTVhOGU4MmMxNWMxYjZlMzU4ZjYyYWM4ZWI2ZTNhYmU4ZGM1IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM2MDA2OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWVybGluLmpzCiAgdmFyIG1lcmxpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIwMCwKICAgIG5hbWU6ICJNZXJsaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJUQyIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLm1lcmxpbmNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLm1lcmxpbmNoYWluLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4ubWVybGluY2hhaW4uaW8vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV0YWNoYWluLmpzCiAgdmFyIG1ldGFjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTcxLAogICAgbmFtZTogIk1ldGFDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJNZXRhdGltZSBDb2luIiwgc3ltYm9sOiAiTVRDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1ldGF0aW1lLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1ldGFFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRhdGltZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDMwMDEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV0YWNoYWluSXN0YW5idWwuanMKICB2YXIgbWV0YWNoYWluSXN0YW5idWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0NTMsCiAgICBuYW1lOiAiTWV0YUNoYWluIElzdGFuYnVsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJNZXRhdGltZSBDb2luIiwgc3ltYm9sOiAiTVRDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vaXN0YW5idWwtcnBjLm1ldGFjaGFpbi5kZXYiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRhRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaXN0YW5idWwtZXhwbG9yZXIubWV0YWNoYWluLmRldiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMzAwMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV0YWxMMi5qcwogIHZhciBzb3VyY2VJZDIyID0gMTsKICB2YXIgbWV0YWxMMiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTc1MCwKICAgIG5hbWU6ICJNZXRhbCBMMiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1ldGFsbDIuY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5tZXRhbGwyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm1ldGFsbDIuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLm1ldGFsbDIuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDIyXTogewogICAgICAgICAgYWRkcmVzczogIjB4M0IxRjdhRGEwRmNjMjZCMTM1MTVhZjc1MkRkMDdmQjFDQWMxMTQyNiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzRjM3YUJkRTJDNmI1QjJlZDZGODA0NTc4N0RmMUVEMUUzNzUzOTU2IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIyXTogewogICAgICAgICAgYWRkcmVzczogIjB4NmQwZjY1RDU5YjU1QjBGRUM1ZDJkMTUzNjUxNTREY0FEQzE0MEJGMyIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyMgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGVyLmpzCiAgdmFyIG1ldGVyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MiwKICAgIG5hbWU6ICJNZXRlciIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNVFIiLAogICAgICBzeW1ib2w6ICJNVFIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMubWV0ZXIuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRlclNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5tZXRlci5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGVyVGVzdG5ldC5qcwogIHZhciBtZXRlclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgzLAogICAgbmFtZTogIk1ldGVyIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTVRSIiwKICAgICAgc3ltYm9sOiAiTVRSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjdGVzdC5tZXRlci5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1ldGVyVGVzdG5ldFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi13YXJyaW5nc3Rha2VzLm1ldGVyLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV0aXMuanMKICB2YXIgbWV0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwODgsCiAgICBuYW1lOiAiTWV0aXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTWV0aXMiLAogICAgICBzeW1ib2w6ICJNRVRJUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FuZHJvbWVkYS5tZXRpcy5pby8/b3duZXI9MTA4OCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1ldGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm1ldGlzLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5yb3V0ZXNjYW4uaW8vdjIvbmV0d29yay9tYWlubmV0L2V2bS8xMDg4L2V0aGVyc2Nhbi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjMzODU1MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV0aXNHb2VybGkuanMKICB2YXIgbWV0aXNHb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5OSwKICAgIG5hbWU6ICJNZXRpcyBHb2VybGkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTWV0aXMgR29lcmxpIiwKICAgICAgc3ltYm9sOiAiTUVUSVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9nb2VybGkuZ2F0ZXdheS5tZXRpc2Rldm9wcy5saW5rIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWV0aXMgR29lcmxpIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS5leHBsb3Jlci5tZXRpc2Rldm9wcy5saW5rIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS5leHBsb3Jlci5tZXRpc2Rldm9wcy5saW5rL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDA2MjA3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXYuanMKICB2YXIgbWV2ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3NTE4LAogICAgbmFtZTogIk1FVmVyc2UgQ2hhaW4gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNRVZlcnNlIiwKICAgICAgc3ltYm9sOiAiTUVWIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWV2ZXJzZW1haW5uZXQuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cubWV2ZXJzZXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODY4ODEzNDAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldlRlc3RuZXQuanMKICB2YXIgbWV2VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDc1OSwKICAgIG5hbWU6ICJNRVZlcnNlIENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTUVWZXJzZSIsCiAgICAgIHN5bWJvbDogIk1FViIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1ldmVyc2V0ZXN0bmV0LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5tZXZlcnNlc2Nhbi5pby8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjQzNzExMTUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9taW50LmpzCiAgdmFyIG1pbnQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4NSwKICAgIG5hbWU6ICJNaW50IE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1pbnRjaGFpbi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1pbnRjaGFpbiBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5taW50Y2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21pbnRTZXBvbGlhVGVzdG5ldC5qcwogIHZhciBtaW50U2Vwb2xpYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2ODYsCiAgICBuYW1lOiAiTWludCBTZXBvbGlhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMubWludGNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWludGNoYWluIFRlc3RuZXQgZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5taW50Y2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9kZS5qcwogIHZhciBzb3VyY2VJZDIzID0gMTsKICB2YXIgbW9kZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMzQ0NDMsCiAgICBuYW1lOiAiTW9kZSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQubW9kZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTW9kZXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbW9kZXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQ2NTg4MgogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDIzXTogewogICAgICAgICAgYWRkcmVzczogIjB4NDMxN2JhMTQ2RDQ5MzNEODg5NTE4YTNlNUUxMUZlN2E1MzE5OWIwNCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDIzXTogewogICAgICAgICAgYWRkcmVzczogIjB4OEIzNGIxNGM3YzcxMjM0NTlDZjMwNzZiOENiOTI5QkUwOTdkMEMwNyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDczNWFEQmJFNzIyMjZCRDUyZTgxOEU3MTgxOTUzZjQyRTNiMEZGMjEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb2RlVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDI0ID0gMTExNTUxMTE7CiAgdmFyIG1vZGVUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA5MTksCiAgICBuYW1lOiAiTW9kZSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEubW9kZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLm1vZGUubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLm1vZGUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDI2MzRCRDY1YmEyN0FCNjM4MTFjNzRBNjMxMThBQ2IzMTI3MDFCZmEiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAzNzc4MzkzCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDMyMGUxNTgwZWZmRjM3RTAwOEYxQzkyNzAwZDFlQmE0N2MxQjIzZkQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAzNzc4Mzk1CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiQzVDNjc5ODc5QjI5NjUyOTY3NTZDRDk1OUMzQzczOTc2OTk5NUUyIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzc3ODM5MgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEJBYmE4MzczMTEzRmI3YTY4ZjE5NWRlRjE4NzMyZTAxYUY4ZURmQ0YiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzAxOTAwNwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDI0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbmJhc2VBbHBoYS5qcwogIHZhciBtb29uYmFzZUFscGhhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjg3LAogICAgbmFtZTogIk1vb25iYXNlIEFscGhhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkRFViIsCiAgICAgIHN5bWJvbDogIkRFViIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFwaS5tb29uYmFzZS5tb29uYmVhbS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzcy5hcGkubW9vbmJhc2UubW9vbmJlYW0ubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21vb25iYXNlLm1vb25zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL21vb25iYXNlLm1vb25zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxODUwNjg2CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbmJlYW0uanMKICB2YXIgbW9vbmJlYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyODQsCiAgICBuYW1lOiAiTW9vbmJlYW0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR0xNUiIsCiAgICAgIHN5bWJvbDogIkdMTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21vb25iZWFtLnB1YmxpYy5ibGFzdGFwaS5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tb29uYmVhbS5wdWJsaWMuYmxhc3RhcGkuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb29uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tb29uc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktbW9vbmJlYW0ubW9vbnNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYwOTAwMgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb29uYmVhbURldi5qcwogIHZhciBtb29uYmVhbURldiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4MSwKICAgIG5hbWU6ICJNb29uYmVhbSBEZXZlbG9wbWVudCBOb2RlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkRFViIsCiAgICAgIHN5bWJvbDogIkRFViIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHA6Ly8xMjcuMC4wLjE6OTk0NCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly8xMjcuMC4wLjE6OTk0NCJdCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb29ucml2ZXIuanMKICB2YXIgbW9vbnJpdmVyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjg1LAogICAgbmFtZTogIk1vb25yaXZlciIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNT1ZSIiwKICAgICAgc3ltYm9sOiAiTU9WUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbW9vbnJpdmVyLnB1YmxpYy5ibGFzdGFwaS5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tb29ucml2ZXIucHVibGljLmJsYXN0YXBpLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTW9vbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbW9vbnJpdmVyLm1vb25zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1tb29ucml2ZXIubW9vbnNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1OTc5MDQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9ycGguanMKICB2YXIgbW9ycGggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4MTgsCiAgICBuYW1lOiAiTW9ycGgiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tb3JwaGwyLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5tb3JwaGwyLmlvOjg0NDMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb3JwaCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tb3JwaGwyLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb3JwaEhvbGVza3kuanMKICB2YXIgbW9ycGhIb2xlc2t5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyODEwLAogICAgbmFtZTogIk1vcnBoIEhvbGVza3kiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXF1aWNrbm9kZS1ob2xlc2t5Lm1vcnBobDIuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLXF1aWNrbm9kZS1ob2xlc2t5Lm1vcnBobDIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb3JwaCBIb2xlc2t5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLWhvbGVza3kubW9ycGhsMi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1hcGktaG9sZXNreS5tb3JwaGwyLmlvL2FwaT8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9ycGhTZXBvbGlhLmpzCiAgdmFyIG1vcnBoU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjcxMCwKICAgIG5hbWU6ICJNb3JwaCBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0Lm1vcnBobDIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb3JwaCBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQubW9ycGhsMi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1hcGktdGVzdG5ldC5tb3JwaGwyLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9uYXV0aWx1cy5qcwogIHZhciBuYXV0aWx1cyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjIyMjIsCiAgICBuYW1lOiAiTmF1dGlsdXMgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiWkJDIiwgc3ltYm9sOiAiWkJDIiwgZGVjaW1hbHM6IDkgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkubmF1dGlsdXMubmF1dGNoYWluLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk5hdXRTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL25hdXRzY2FuLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25lb25EZXZuZXQuanMKICB2YXIgbmVvbkRldm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjQ1MDIyOTI2LAogICAgbmFtZTogIk5lb24gRVZNIERldk5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTkVPTiIsIHN5bWJvbDogIk5FT04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9kZXZuZXQubmVvbmV2bS5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZW9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kZXZuZXQubmVvbnNjYW4ub3JnIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwNTIwNjExMgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25lb25NYWlubmV0LmpzCiAgdmFyIG5lb25NYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDUwMjI5MzQsCiAgICBuZXR3b3JrOiAibmVvbk1haW5uZXQiLAogICAgbmFtZTogIk5lb24gRVZNIE1haW5OZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk5FT04iLCBzeW1ib2w6ICJORU9OIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbmVvbi1wcm94eS1tYWlubmV0LnNvbGFuYS5wMnAub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTmVvbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbmVvbnNjYW4ub3JnIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwNjU0NTUyNAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9uZXhpLmpzCiAgdmFyIG5leGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyNDIsCiAgICBuYW1lOiAiTmV4aSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTmV4aSIsIHN5bWJvbDogIk5FWEkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuY2hhaW4ubmV4aS50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTmV4aVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm5leGlzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cubmV4aXNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4MDI3N0E0NkNjNjlBNTdlRTNBNkM4YzE1OGJBODc0ODMyRjcxOEI4RSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNTc3MDE2MAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbmV4aWxpeC5qcwogIHZhciBuZXhpbGl4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDAsCiAgICBuYW1lOiAiTmV4aWxpeCBTbWFydCBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJOZXhpbGl4IiwKICAgICAgc3ltYm9sOiAiTkVYSUxJWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwY3VybC5wb3MubmV4aWxpeC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZXhpbGl4U2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLm5leGlsaXguY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg1ODM4MWM4ZTJCRjlkMEMyQzQyNTljQTE0QmRBOUFmZTAyODMxMjQ0IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc0NDQ4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vYXNpc1Rlc3RuZXQuanMKICB2YXIgb2FzaXNUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MDkwLAogICAgbmV0d29yazogIm9hc2lzLXRlc3RuZXQiLAogICAgbmFtZTogIk9hc2lzIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZhc3R0b2tlbiIsIHN5bWJvbDogIkZUTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMxLm9hc2lzLmJhaGFtdXRjaGFpbi5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGdG5zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL29hc2lzLmZ0bnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL29hc2lzLmZ0bnNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vYXN5cy5qcwogIHZhciBvYXN5cyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjQ4LAogICAgbmFtZTogIk9hc3lzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJPYXN5cyIsIHN5bWJvbDogIk9BUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tYWlubmV0Lm9hc3lzLmdhbWVzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT2FzeXNTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ub2FzeXMuZ2FtZXMiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi5vYXN5cy5nYW1lcy9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vZHlzc2V5VGVzdG5ldC5qcwogIHZhciBvZHlzc2V5VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTExODY3LAogICAgbmFtZTogIk9keXNzZXkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vb2R5c3NleS5pdGhhY2EueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT2R5c3NleSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9vZHlzc2V5LWV4cGxvcmVyLml0aGFjYS54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vb2R5c3NleS1leHBsb3Jlci5pdGhhY2EueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9va2MuanMKICB2YXIgb2tjID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NiwKICAgIG5hbWU6ICJPS0MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiT0tUIiwKICAgICAgc3ltYm9sOiAiT0tUIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXhjaGFpbnJwYy5va2V4Lm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIm9rbGluayIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cub2tsaW5rLmNvbS9va2MiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTAzNjQ3OTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29vcnRtYWlubmV0RGV2LmpzCiAgdmFyIG9vcnRNYWlubmV0RGV2ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NzAwLAogICAgbmFtZTogIk9PUlQgTWFpbm5ldERldiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPT1JUIiwKICAgICAgc3ltYm9sOiAiT09SVCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2Rldi1ycGMub29ydGVjaC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPT1JUIE1haW5uZXREZXYgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZGV2LXNjYW4ub29ydGVjaC5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcEJOQi5qcwogIHZhciBzb3VyY2VJZDI1ID0gNTY7CiAgdmFyIG9wQk5CID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDQsCiAgICBuYW1lOiAib3BCTkIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vb3BibmItbWFpbm5ldC1ycGMuYm5iY2hhaW4ub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAib3BCTkIgKEJTQ1NjYW4pIiwKICAgICAgICB1cmw6ICJodHRwczovL29wYm5iLmJzY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1vcGJuYi5ic2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTEyODgxCiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxNTNDQUI3OWY0NzY3RTJmZjg2MkM5NGFhNDk1NzMyOTRCMTNEMTY5IgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxODc2RUE3NzAyQzBhZDBDNkEyYWU2MDM2REU3NzMzZWRmQmNhNTE5IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDI1XTogewogICAgICAgICAgYWRkcmVzczogIjB4RjA1RjBlNDM2Mjg1OWMzMzMxQ2I5Mzk1Q0JDMjAxRTNGYTY3NTdFYSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyNQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wQk5CVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDI2ID0gOTc7CiAgdmFyIG9wQk5CVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTYxMSwKICAgIG5hbWU6ICJvcEJOQiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRCTkIiLAogICAgICBzeW1ib2w6ICJ0Qk5CIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vb3BibmItdGVzdG5ldC1ycGMuYm5iY2hhaW4ub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAib3BibmJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQub3BibmJzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzNzA1MTA4CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGZjIzOTRCYjg0MzAxMjU2MmY0MzQ5QzY2MzJhMEVjQjkyZkM4ODEwIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0Mzg2QzhBQmYyMDA5YUMwYzI2MzQ2MkRhNTY4REQ5ZDQ2ZTUyYTMxIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDI2XTogewogICAgICAgICAgYWRkcmVzczogIjB4Njc3MzExRmQyY0NjNTExQmJjMGY1ODFFOGQ5YTA3QjAzM0Q1RTg0MCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjYKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcHRpbWlzbS5qcwogIHZhciBzb3VyY2VJZDI3ID0gMTsKICB2YXIgb3B0aW1pc20gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEwLAogICAgbmFtZTogIk9QIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5vcHRpbWlzbS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9wdGltaXNtIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL29wdGltaXN0aWMuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1vcHRpbWlzdGljLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkMjddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlNTk2NUFiNTk2MmVEYzc0NzdDODUyMDI0M0E5NTUxN0NEMjUyZkE5IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGRmZTk3ODY4MjMzZDFhYTIyZTgxNWEyNjY5ODJmMmNmMTc2ODVhMjciCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0Mjg2MjYzCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDI3XTogewogICAgICAgICAgYWRkcmVzczogIjB4YkViNUZjNTc5MTE1MDcxNzY0Yzc0MjNBNGYxMmVEZGU0MWYxMDZFZCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDk5QzlmYzQ2ZjkyRThhMWMwZGVDMWIxNzQ3ZDAxMDkwM0U4ODRiRTEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjcKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcHRpbWlzbUdvZXJsaS5qcwogIHZhciBzb3VyY2VJZDI4ID0gNTsKICB2YXIgb3B0aW1pc21Hb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDQyMCwKICAgIG5hbWU6ICJPcHRpbWlzbSBHb2VybGkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkdvZXJsaSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2dvZXJsaS5vcHRpbWlzbS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGktb3B0aW1pc20uZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS1vcHRpbWlzbS5ldGhlcnNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhFNkRmYmEwOTUzNjE2QmFjYWIwYzlBOGVjYjNhOUJCYTc3RkMxNWMwIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDk0NjEKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg1YjQ3RTFBMDhFYTZkOTg1RDY2NDkzMDA1ODRlNjcyMkVjNEIxMzgzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDI4XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjM2QWYxNmJmMmY2ODJkRDMxMDllNjAxMDJiOEUxQTA4OUZlZEFhOCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjgKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcHRpbWlzbVNlcG9saWEuanMKICB2YXIgc291cmNlSWQyOSA9IDExMTU1MTExOwogIHZhciBvcHRpbWlzbVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMTU1NDIwLAogICAgbmFtZTogIk9QIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLm9wdGltaXNtLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9vcHRpbWlzbS1zZXBvbGlhLmJsb2Nrc2NvdXQuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL29wdGltaXNtLXNlcG9saWEuYmxvY2tzY291dC5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDI5XTogewogICAgICAgICAgYWRkcmVzczogIjB4MDVGOTYxM2FEQjMwMDI2RkZkNjM0ZjM4ZTVDNGRGZDMwYTE5N0ZhMSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg5MEU5YzRmOGE5OTRhMjUwRjZhRWZkNjFDQUZiNEYyZTg5NUQ0NThGIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTYyMDIwNAogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE2RmM1MDU4RjI1NjQ4MTk0NDcxOTM5ZGY3NUNGMjdBMmZkQzQ4QkMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGQmIwNjIxRTBCMjNiNTQ3OEI2MzBCRDU1YTVmMjFmNjc3MzBCMEYxIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyOQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdG9waWEuanMKICB2YXIgb3B0b3BpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjIwNTAsCiAgICBuYW1lOiAiT3B0b3BpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLW1haW5uZXQub3B0b3BpYS5haSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9wdG9waWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5vcHRvcGlhLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcHRvcGlhVGVzdG5ldC5qcwogIHZhciBvcHRvcGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjIwNDksCiAgICBuYW1lOiAiT3B0b3BpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtdGVzdG5ldC5vcHRvcGlhLmFpIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3B0b3BpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLXRlc3RuZXQub3B0b3BpYS5haSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9vcmRlcmx5LmpzCiAgdmFyIG9yZGVybHkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MSwKICAgIG5hbWU6ICJPcmRlcmx5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMub3JkZXJseS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3JkZXJseSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5vcmRlcmx5Lm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29yZGVybHlTZXBvbGlhLmpzCiAgdmFyIG9yZGVybHlTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NDYwLAogICAgbmFtZTogIk9yZGVybHkgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9sMi1vcmRlcmx5LWwyLTQ0NjAtc2Vwb2xpYS04dGMzc2Q3ZHZ5LnQuY29uZHVpdC54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPcmRlcmx5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVybDJuZXctb3JkZXJseS1sMi00NDYwLXNlcG9saWEtOHRjM3NkN2R2eS50LmNvbmR1aXQueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL290aW1EZXZuZXQuanMKICB2YXIgb3RpbURldm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDExNDQxMTQsCiAgICBuYW1lOiAiT3RpbSBEZXZuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovL2Rldm5ldC5vdGltLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgYmF0Y2hJbnZva2VyOiB7CiAgICAgICAgYWRkcmVzczogIjB4NUZiREIyMzE1Njc4YWZlY2IzNjdmMDMyZDkzRjY0MmY2NDE4MGFhMyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BhbG0uanMKICB2YXIgcGFsbSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEyOTcxMDgxMDksCiAgICBuYW1lOiAiUGFsbSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJQQUxNIiwKICAgICAgc3ltYm9sOiAiUEFMTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcGFsbS1tYWlubmV0LnB1YmxpYy5ibGFzdGFwaS5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hhaW5sZW5zIiwKICAgICAgICB1cmw6ICJodHRwczovL3BhbG0uY2hhaW5sZW5zLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTQyOTI0OAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGFsbVRlc3RuZXQuanMKICB2YXIgcGFsbVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMjk3MTA4MDk5LAogICAgbmFtZTogIlBhbG0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJQQUxNIiwKICAgICAgc3ltYm9sOiAiUEFMTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcGFsbS1tYWlubmV0LnB1YmxpYy5ibGFzdGFwaS5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hhaW5sZW5zIiwKICAgICAgICB1cmw6ICJodHRwczovL3BhbG0uY2hhaW5sZW5zLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTQyOTI0OAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Bnbi5qcwogIHZhciBzb3VyY2VJZDMwID0gMTsKICB2YXIgcGduID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MjQsCiAgICBuZXR3b3JrOiAicGduIiwKICAgIG5hbWU6ICJQR04iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnB1YmxpY2dvb2RzLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQR04gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucHVibGljZ29vZHMubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5wdWJsaWNnb29kcy5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDMwXTogewogICAgICAgICAgYWRkcmVzczogIjB4OUU2MjA0Rjc1MGNEODY2YjI5OTU5NGUyYUM5ZUE4MjRFMmU1Zjk1YyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMzODAyMDkKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiMjZGZDk4NWM1OTU5YkJCMzgyQkFGZEQwYjg3OUUxNDllNDgxMTZjIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMwXTogewogICAgICAgICAgYWRkcmVzczogIjB4RDAyMDRCOTUyN0MxYkE3YkQ3NjVGYTVDQ0Q5MzU1ZDM4MzM4MjcyYiIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBmb3JtYXR0ZXJzOiBmb3JtYXR0ZXJzMiwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMwCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGduVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDMxID0gMTExNTUxMTE7CiAgdmFyIHBnblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU4MDA4LAogICAgbmV0d29yazogInBnbi10ZXN0bmV0IiwKICAgIG5hbWU6ICJQR04gIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEucHVibGljZ29vZHMubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBHTiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnNlcG9saWEucHVibGljZ29vZHMubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zZXBvbGlhLnB1YmxpY2dvb2RzLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhENWJBYzMxNTJmZkMyNTMxOEY4NDhCM0RENWRBNkM4NTE3MUJhRUVlIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGMDRCZEQ1MzUzQmIwRUZGNkNBNjBDZmNDNzg1OTQyNzhlQmZFMTc5IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMxXTogewogICAgICAgICAgYWRkcmVzczogIjB4RmFFNmFiQ0FGMzBEMjNlMjMzQUM3ZmFGNzQ3RjJmQzNhNWE2QmZhMyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM3NTQ5MjUKICAgICAgfQogICAgfSwKICAgIGZvcm1hdHRlcnM6IGZvcm1hdHRlcnMyLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzEsCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGhvZW5peC5qcwogIHZhciBwaG9lbml4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM4MSwKICAgIG5hbWU6ICJQaG9lbml4IEJsb2NrY2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlBob2VuaXgiLCBzeW1ib2w6ICJQSFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucGhvZW5peHBsb3Jlci5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQaG9lbml4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Bob2VuaXhwbG9yZXIuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Bob2VuaXhwbG9yZXIuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4NDk4Y0Y3NTdhNTc1Y0ZGMmMyRWQ5ZjUzMmY1NkVmYTc5N2Y4NjQ0MiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1NjIwMTkyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wbGF5ZmlBbGJpcmVvLmpzCiAgdmFyIHBsYXlmaUFsYmlyZW8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcsCiAgICBpZDogMTYxMjEyNywKICAgIG5hbWU6ICJQbGF5RmkgQWxiaXJlbyBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJhbGJpcmVvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FsYmlyZW8tcnBjLnBsYXlmaS5haSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9hbGJpcmVvLXJwYy13cy5wbGF5ZmkuYWkvd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQbGF5RmkgQWxiaXJlbyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hbGJpcmVvLWV4cGxvcmVyLnBsYXlmaS5haSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RjljZGE2MjRGQkM3ZTA1OTM1NWNlOThhMzE2OTNkMjk5RkFDZDk2MyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wbGluZ2EuanMKICB2YXIgcGxpbmdhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDIsCiAgICBuYW1lOiAiUGxpbmdhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJQbGluZ2EiLCBzeW1ib2w6ICJQTElOR0EiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGN1cmwubWFpbm5ldC5wbGdjaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQbGdzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5wbGdzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4MDk4OTU3NjE2MGYyZTcwOTI5MDhCQjk0Nzk2MzFiOTAxMDYwYjZlNCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDQ0ODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BsdW1lVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDMyID0gMTExNTUxMTE7CiAgdmFyIHBsdW1lVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTYxMjIxMTM1LAogICAgbmFtZTogIlBsdW1lIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIlBsdW1lIFNlcG9saWEgRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMucGx1bWVuZXR3b3JrLnh5ei9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQtcnBjLnBsdW1lbmV0d29yay54eXovd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIucGx1bWVuZXR3b3JrLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLnBsdW1lbmV0d29yay54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcG9seWdvbi5qcwogIHZhciBwb2x5Z29uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzcsCiAgICBuYW1lOiAiUG9seWdvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUE9MIiwgc3ltYm9sOiAiUE9MIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcG9seWdvbi1ycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcG9seWdvbnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1NzcwMTYwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uQW1veS5qcwogIHZhciBwb2x5Z29uQW1veSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODAwMDIsCiAgICBuYW1lOiAiUG9seWdvbiBBbW95IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJNQVRJQyIsIHN5bWJvbDogIk1BVElDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLWFtb3kucG9seWdvbi50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYW1veS5wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWFtb3kucG9seWdvbnNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMTI3Mzg4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcG9seWdvbk11bWJhaS5qcwogIHZhciBwb2x5Z29uTXVtYmFpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDAwMSwKICAgIG5hbWU6ICJQb2x5Z29uIE11bWJhaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTUFUSUMiLCBzeW1ib2w6ICJNQVRJQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5hbmtyLmNvbS9wb2x5Z29uX211bWJhaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBvbHlnb25TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL211bWJhaS5wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3RuZXQucG9seWdvbnNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNTc3MDE2MAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BvbHlnb25aa0V2bS5qcwogIHZhciBwb2x5Z29uWmtFdm0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMDEsCiAgICBuYW1lOiAiUG9seWdvbiB6a0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly96a2V2bS1ycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vemtldm0ucG9seWdvbnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS16a2V2bS5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU3NzQ2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uWmtFdm1DYXJkb25hLmpzCiAgdmFyIHBvbHlnb25aa0V2bUNhcmRvbmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0NDIsCiAgICBuYW1lOiAiUG9seWdvbiB6a0VWTSBDYXJkb25hIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5jYXJkb25hLnprZXZtLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jYXJkb25hLXprZXZtLnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jYXJkb25hLXprZXZtLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDExNDA5MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcG9seWdvblprRXZtVGVzdG5ldC5qcwogIHZhciBwb2x5Z29uWmtFdm1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDQyLAogICAgbmFtZTogIlBvbHlnb24gemtFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucHVibGljLnprZXZtLXRlc3QubmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC16a2V2bS5wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC16a2V2bS5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MjU2ODYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3B1bHNlY2hhaW4uanMKICB2YXIgcHVsc2VjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzY5LAogICAgbmFtZTogIlB1bHNlQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlB1bHNlIiwgc3ltYm9sOiAiUExTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICB0ZXN0bmV0OiBmYWxzZSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucHVsc2VjaGFpbi5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MucHVsc2VjaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQdWxzZVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5wdWxzZWNoYWluLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuc2Nhbi5wdWxzZWNoYWluLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgZW5zUmVnaXN0cnk6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMDAwMDAwMDAwMEMyRTA3NGVDNjlBMGRGYjI5OTdCQTZDN2QyZTFlIgogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNDM1MzYwMQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcHVsc2VjaGFpblY0LmpzCiAgdmFyIHB1bHNlY2hhaW5WNCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTQzLAogICAgbmFtZTogIlB1bHNlQ2hhaW4gVjQiLAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWNCBQdWxzZSIsIHN5bWJvbDogInY0UExTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnY0LnRlc3RuZXQucHVsc2VjaGFpbi5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MudjQudGVzdG5ldC5wdWxzZWNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlB1bHNlU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnY0LnRlc3RuZXQucHVsc2VjaGFpbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi52NC50ZXN0bmV0LnB1bHNlY2hhaW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0MzUzNjAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9xbDEuanMKICB2YXIgcWwxID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3NjYsCiAgICBuYW1lOiAiUUwxIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlFPTSIsCiAgICAgIHN5bWJvbDogIlFPTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnFvbS5vbmUiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJRbDEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5xb20ub25lIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg3QTUyMzcwNzE2ZWE3MzA1ODU4ODRGNUJEQjBmNkU2MEMzOWI4QzY0IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9xTWFpbm5ldC5qcwogIHZhciBxTWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzU0NDEsCiAgICBuYW1lOiAiUSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlEiLAogICAgICBzeW1ib2w6ICJRIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnEub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUSBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnEub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnEub3JnL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3FUZXN0bmV0LmpzCiAgdmFyIHFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNTQ0MywKICAgIG5hbWU6ICJRIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUSIsCiAgICAgIHN5bWJvbDogIlEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMucXRlc3RuZXQub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnF0ZXN0bmV0Lm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5xdGVzdG5ldC5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JlYWwuanMKICB2YXIgcmVhbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTExMTg4LAogICAgbmFtZTogInJlLmFsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJyZUVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgc3ltYm9sOiAicmVFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9yZWFsLmRycGMub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAicmUuYWwgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucmUuYWwiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIucmUuYWwvYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY5NQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmVkYmVsbHlUZXN0bmV0LmpzCiAgdmFyIHJlZGJlbGx5VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTUzLAogICAgbmFtZTogIlJlZGJlbGx5IE5ldHdvcmsgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiUmVkYmVsbHkgTmF0aXZlIENvaW4iLAogICAgICBzeW1ib2w6ICJSQk5UIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2dvdmVybm9ycy50ZXN0bmV0LnJlZGJlbGx5Lm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcm5hbCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LnJlZGJlbGx5Lm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXRoZXJuYWwuZmx5LmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmVkc3RvbmUuanMKICB2YXIgc291cmNlSWQzMyA9IDE7CiAgdmFyIHJlZHN0b25lID0gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgbmFtZTogIlJlZHN0b25lIiwKICAgIGlkOiA2OTAsCiAgICBzb3VyY2VJZDogc291cmNlSWQzMywKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yZWRzdG9uZWNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMucmVkc3RvbmVjaGFpbi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJlZHN0b25lLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhDN2JDYjBlODgzOWEyOEExY0ZhZGQxQ0Y3MTZkZTkwMTZDZEE1MWFlIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTk1NzgzMjkKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhhNDI2QTA1MmY2NTdBRUVlZmMyOThiM0I1YzM1YTQ3MGU0NzM5ZDY5IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTk1NzgzMzcKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQzM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGM0NzNjYTdFMDJhZjI0YzEyOWMyZUVmNTFGMmFEZjA0MTFjMURmNjkiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTU3ODMzMQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JleWFOZXR3b3JrLmpzCiAgdmFyIHJleWFOZXR3b3JrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNzI5LAogICAgbmFtZTogIlJleWEgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBkZWNpbWFsczogMTgsIG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucmV5YS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLnJleWEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJleWEgTmV0d29yayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yZXlhLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JvbGx1eC5qcwogIHZhciByb2xsdXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MCwKICAgIG5hbWU6ICJSb2xsdXggTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTeXNjb2luIiwKICAgICAgc3ltYm9sOiAiU1lTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucm9sbHV4LmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMucm9sbHV4LmNvbS93c3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSb2xsdXhFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yb2xsdXguY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnJvbGx1eC5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDExOTIyMgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9sbHV4VGVzdG5ldC5qcwogIHZhciByb2xsdXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1N2UzLAogICAgbmFtZTogIlJvbGx1eCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlN5c2NvaW4iLAogICAgICBzeW1ib2w6ICJTWVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy10YW5lbmJhdW0ucm9sbHV4LmNvbS8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLXRhbmVuYmF1bS5yb2xsdXguY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJvbGx1eFRlc3RuZXRFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9yb2xsdXgudGFuZW5iYXVtLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3JvbGx1eC50YW5lbmJhdW0uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4MTM2NzUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JvbmluLmpzCiAgdmFyIHJvbmluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDIwLAogICAgbmFtZTogIlJvbmluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJST04iLCBzeW1ib2w6ICJST04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkucm9uaW5jaGFpbi5jb20vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9uaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXBwLnJvbmluY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI2MDIzNTM1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb290LmpzCiAgdmFyIHJvb3QgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc2NjgsCiAgICBuYW1lOiAiVGhlIFJvb3QgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJYUlAiLAogICAgICBzeW1ib2w6ICJYUlAiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Jvb3Qucm9vdG5ldC5saXZlL2FyY2hpdmUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcm9vdC5yb290bmV0LmxpdmUvYXJjaGl2ZS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJvb3RzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Jvb3RzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjOUMyRTI0MjlBZUMzNTQ5MTZjNDc2QjMwZDcyOWRlRGRDOTQ5ODhkIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDkyMTgzMzgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Jvb3RQb3JjaW5pLmpzCiAgdmFyIHJvb3RQb3JjaW5pID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3NjcyLAogICAgbmFtZTogIlRoZSBSb290IE5ldHdvcmsgLSBQb3JjaW5pIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlhSUCIsCiAgICAgIHN5bWJvbDogIlhSUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcG9yY2luaS5yb290bmV0LmFwcC9hcmNoaXZlIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3BvcmNpbmkucm9vdG5ldC5hcHAvYXJjaGl2ZS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJvb3RzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3BvcmNpbmkucm9vdHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGM5QzJFMjQyOUFlQzM1NDkxNmM0NzZCMzBkNzI5ZGVEZEM5NDk4OGQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA1NTU2OTIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb290c3RvY2suanMKICB2YXIgcm9vdHN0b2NrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMCwKICAgIG5hbWU6ICJSb290c3RvY2sgTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAicm9vdHN0b2NrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJvb3RzdG9jayBCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiUkJUQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1ub2RlLnJzay5jbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJTSyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yc2suY28iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDI0OTU0MAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9vdHN0b2NrVGVzdG5ldC5qcwogIHZhciByb290c3RvY2tUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMSwKICAgIG5hbWU6ICJSb290c3RvY2sgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAicm9vdHN0b2NrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJvb3RzdG9jayBCaXRjb2luIiwKICAgICAgc3ltYm9sOiAidFJCVEMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wdWJsaWMtbm9kZS50ZXN0bmV0LnJzay5jbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJTSyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LnJvb3RzdG9jay5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yc3MzLmpzCiAgdmFyIHNvdXJjZUlkMzQgPSAxOwogIHZhciByc3MzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxMjU1MywKICAgIG5hbWU6ICJSU1MzIFZTTCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJSU1MzIiwgc3ltYm9sOiAiUlNTMyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yc3MzLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNTMyBWU0wgTWFpbm5ldCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ucnNzMy5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnJzczMuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhFNmYyNGQyQzMyQjMxMDlCMThlZDMzY0YwOGVGYjQ5MGIxZTA5QzEwIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQxOTMKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2QTEyNDMyNDkxYmJiRThkM2JhYmY3NUY3NTk3NjY3NzRDNzc4RGI0IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTkzODcwNTcKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQzNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDRjYmFiNjkxMDhBYTcyMTUxRURhNUEzYzE2NGVBODY4NDVmMTg0MzgiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yc3MzU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDM1ID0gMTExNTUxMTE7CiAgdmFyIHJzczNTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyMzMxLAogICAgbmFtZTogIlJTUzMgVlNMIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUlNTMyIsIHN5bWJvbDogIlJTUzMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5yc3MzLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNTMyBWU0wgU2Vwb2xpYSBUZXN0bmV0IFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi50ZXN0bmV0LnJzczMuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi50ZXN0bmV0LnJzczMuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhEYjVjNDZDM0VhYTZFZDZhRThiMjM3OTc4NURGN2RkMDI5QzBkQzgxIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTU2OTcKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhjQkQ3N0U4RTFFN0YwNkIyNWJhRGU2NzE0MmNkRTgyNjUyRGE3YjU3IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNTM0NTAzNQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM1XTogewogICAgICAgICAgYWRkcmVzczogIjB4ZEREMjliYjYzQjA4MzlGQjFjRTBlRTQzOUZmMDI3NzM4NTk1RDA3QiIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYWFrdXJ1LmpzCiAgdmFyIHNhYWt1cnUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcyMjU4NzgsCiAgICBuYW1lOiAiU2Fha3VydSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJPQVMiLCBzeW1ib2w6ICJPQVMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2Fha3VydS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2Fha3VydSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zYWFrdXJ1Lm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhaWdvbi5qcwogIHZhciBzYWlnb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjEsCiAgICBuYW1lOiAiU2FpZ29uIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJPTiIsIHN5bWJvbDogIlJPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhaWdvbi10ZXN0bmV0LnJvbmluY2hhaW4uY29tL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNhaWdvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zYWlnb24tYXBwLnJvbmluY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4NzM2ODcxCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2Fua28uanMKICB2YXIgc2Fua28gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTYsCiAgICBuYW1lOiAiU2Fua28iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkRNVCIsIHN5bWJvbDogIkRNVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2Fua28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2Fua28gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Fua28ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXBwaGlyZS5qcwogIHZhciBzYXBwaGlyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjMyOTQsCiAgICBuYW1lOiAiT2FzaXMgU2FwcGhpcmUiLAogICAgbmV0d29yazogInNhcHBoaXJlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTYXBwaGlyZSBSb3NlIiwgc3ltYm9sOiAiUk9TRSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhcHBoaXJlLm9hc2lzLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NhcHBoaXJlLm9hc2lzLmlvL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT2FzaXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIub2FzaXMuaW8vbWFpbm5ldC9zYXBwaGlyZSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3MzQ1MzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhcHBoaXJlVGVzdG5ldC5qcwogIHZhciBzYXBwaGlyZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzMjk1LAogICAgbmFtZTogIk9hc2lzIFNhcHBoaXJlIFRlc3RuZXQiLAogICAgbmV0d29yazogInNhcHBoaXJlLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNhcHBoaXJlIFRlc3QgUm9zZSIsIHN5bWJvbDogIlRFU1QiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldi93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9hc2lzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm9hc2lzLmlvL3Rlc3RuZXQvc2FwcGhpcmUiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2F0b3NoaXZtLmpzCiAgdmFyIHNhdG9zaGlWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEwOSwKICAgIG5hbWU6ICJTYXRvc2hpVk0gQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQlRDIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hbHBoYS1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3N2bXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc3Ztc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXRvc2hpdm1UZXN0bmV0LmpzCiAgdmFyIHNhdG9zaGlWTVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMTAsCiAgICBuYW1lOiAiU2F0b3NoaVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJUQyIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdC1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3Ztc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LnN2bXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Njcm9sbC5qcwogIHZhciBzY3JvbGwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MiwKICAgIG5hbWU6ICJTY3JvbGwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNjcm9sbC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93c3MtcnBjLnNjcm9sbC5pby93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNjcm9sbHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLnNjcm9sbHNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zY3JvbGxTZXBvbGlhLmpzCiAgdmFyIHNjcm9sbFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MSwKICAgIG5hbWU6ICJTY3JvbGwgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5zY3JvbGwuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTY3JvbGxzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEuc2Nyb2xsc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDk0NzMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWkuanMKICB2YXIgc2VpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI5LAogICAgbmFtZTogIlNlaSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLnNlaS1hcGlzLmNvbS8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtLXdzLnNlaS1hcGlzLmNvbS8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2VpdHJhY2UuY29tL3BhY2lmaWMtMS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWlEZXZuZXQuanMKICB2YXIgc2VpRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTM3MTUsCiAgICBuYW1lOiAiU2VpIERldm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2VpIiwgc3ltYm9sOiAiU0VJIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXZtLXJwYy1hcmN0aWMtMS5zZWktYXBpcy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2VpVGVzdG5ldC5qcwogIHZhciBzZWlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI4LAogICAgbmFtZTogIlNlaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLXRlc3RuZXQuc2VpLWFwaXMuY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V2bS13cy10ZXN0bmV0LnNlaS1hcGlzLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNlaXRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlaXRyYWNlLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZXBvbGlhLmpzCiAgdmFyIHNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTU1MTExLAogICAgbmFtZTogIlNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMyLnNlcG9saWEub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzUxNTMyCiAgICAgIH0sCiAgICAgIGVuc1JlZ2lzdHJ5OiB7IGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzhBZjk5OWUzODI3M0Q2NThCRTFiOTIxYjg4QTlEZGYwMDU3NjljQyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MzE3MDgwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hhcGUuanMKICB2YXIgc291cmNlSWQzNiA9IDE7CiAgdmFyIHNoYXBlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAzNjAsCiAgICBuYW1lOiAiU2hhcGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5zaGFwZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAic2hhcGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoYXBlc2Nhbi54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2hhcGVzY2FuLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZFZjhjNjlDZkU0NjM1ZDg2NmUzRTAyNzMyMDY4MDIyYzA2ZTcyNEQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTk0MAogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEVCMDZmRmExNjAxMUI1NjI4QmFCOThFMjk3NzYzNjFjODM3NDFkZDMiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTkzMwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM2XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjJFZGQ1ZjQ5MzBFYTkyZENhM2ZCODE2ODliREQ5YjlkMDc2YjU3QiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwMzY5OTM1CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzYKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGFwZVNlcG9saWEuanMKICB2YXIgc291cmNlSWQzNyA9IDExMTU1MTExOwogIHZhciBzaGFwZVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMDExLAogICAgbmFtZTogIlNoYXBlIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuc2hhcGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc2Vwb2xpYS5zaGFwZS5uZXR3b3JrLyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1zZXBvbGlhLnNoYXBlLm5ldHdvcmsvYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzNwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoYXJkZXVtU3BoaW54LmpzCiAgdmFyIHNoYXJkZXVtU3BoaW54ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDgyLAogICAgbmFtZTogIlNoYXJkZXVtIFNwaGlueCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU0hBUkRFVU0iLCBzeW1ib2w6ICJTSE0iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zcGhpbnguc2hhcmRldW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2hhcmRldW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc3BoaW54LnNoYXJkZXVtLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGliYXJpdW0uanMKICB2YXIgc2hpYmFyaXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDksCiAgICBuYW1lOiAiU2hpYmFyaXVtIiwKICAgIG5ldHdvcms6ICJzaGliYXJpdW0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJvbmUiLCBzeW1ib2w6ICJCT05FIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNoaWJycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zaGliYXJpdW1zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4NjRCZjY4MUFERDYwNTIzOTUxODhBODkxMDFBMUIzN2QzQjRDOTYxIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI2NTkwMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpYmFyaXVtVGVzdG5ldC5qcwogIHZhciBzaGliYXJpdW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTcsCiAgICBuYW1lOiAiUHVwcHluZXQgU2hpYmFyaXVtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJvbmUiLAogICAgICBzeW1ib2w6ICJCT05FIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVwcHluZXQuc2hpYnJwYy5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4QTQwMjliNzRGQkEzNjZjOTI2ZURGQTdEZDEwQjIxQzYyMTE3MGE0YyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDM1NzY5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpZGVuLmpzCiAgdmFyIHNoaWRlbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzM2LAogICAgbmFtZTogIlNoaWRlbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTRE4iLAogICAgICBzeW1ib2w6ICJTRE4iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NoaWRlbi5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vc2hpZGVuLXJwYy5kd2VsbGlyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaWRlbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoaWRlbi5zdWJzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGltbWVyLmpzCiAgdmFyIHNoaW1tZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0OCwKICAgIG5hbWU6ICJTaGltbWVyIiwKICAgIG5ldHdvcms6ICJzaGltbWVyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS5zaGltbWVyLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaGltbWVyIE5ldHdvcmsgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnNoaW1tZXIubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoaW1tZXJUZXN0bmV0LmpzCiAgdmFyIHNoaW1tZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDczLAogICAgbmFtZTogIlNoaW1tZXIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAic2hpbW1lci10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS50ZXN0bmV0LnNoaW1tZXIubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaW1tZXIgTmV0d29yayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0udGVzdG5ldC5zaGltbWVyLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaWxpY29uLmpzCiAgdmFyIHNpbGljb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzNTUsCiAgICBuYW1lOiAiU2lsaWNvbiB6a0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYy5zaWxpY29uLm5ldHdvcmsiLAogICAgICAgICAgImh0dHBzOi8vc2lsaWNvbi1tYWlubmV0Lm5vZGVpbmZyYS5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaWxpY29uU2NvcGUiLAogICAgICAgIHVybDogImh0dHBzOi8vc2NvcGUuc2lsaWNvbi5uZXR3b3JrIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2lsaWNvblNlcG9saWEuanMKICB2YXIgc2lsaWNvblNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3MjI2NDExNjAsCiAgICBuYW1lOiAiU2lsaWNvbiBTZXBvbGlhIHprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLXNlcG9saWEuc2lsaWNvbi5uZXR3b3JrIiwKICAgICAgICAgICJodHRwczovL3NpbGljb24tdGVzdG5ldC5ub2RlaW5mcmEuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2lsaWNvblNlcG9saWFTY29wZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY29wZS1zZXBvbGlhLnNpbGljb24ubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9icmF3bC5qcwogIHZhciBza2FsZUJsb2NrQnJhd2xlcnMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM5MTg0NTg5NCwKICAgIG5hbWU6ICJTS0FMRSB8IEJsb2NrIEJyYXdsZXJzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCUkFXTCIsIHN5bWJvbDogIkJSQVdMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mcmF5ZWQtZGVjZW50LWFudGFyZXMuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czoge30KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvLmpzCiAgdmFyIHNrYWxlQ2FseXBzbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTU2NDgzMDgxOCwKICAgIG5hbWU6ICJTS0FMRSB8IENhbHlwc28gTkZUIEh1YiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hvbm9yYWJsZS1zdGVlbC1yYXNhbGhhZ3VlIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMTA3NjI2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvVGVzdG5ldC5qcwogIHZhciBza2FsZUNhbHlwc29UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NzQzOTkxMzEsCiAgICBuYW1lOiAiU0tBTEUgQ2FseXBzbyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9naWFudC1oYWxmLWR1YWwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dpYW50LWhhbGYtZHVhbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ2lhbnQtaGFsZi1kdWFsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMyMjAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jcnlwdG9CbGFkZXMuanMKICB2YXIgc2thbGVDcnlwdG9CbGFkZXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjYwNjIxNTcsCiAgICBuYW1lOiAiU0tBTEUgfCBDcnlwdG9CbGFkZXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4Il0sCiAgICAgICAgd2ViU29ja2V0OiBbCiAgICAgICAgICAid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9hZmZlY3Rpb25hdGUtaW1tZWRpYXRlLXBvbGx1eCIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4LmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvY3J5cHRvQ29sb3NzZXVtLmpzCiAgdmFyIHNrYWxlQ3J5cHRvQ29sb3NzZXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDMyOTQyMTcyLAogICAgbmFtZTogIlNLQUxFIHwgQ3J5cHRvIENvbG9zc2V1bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaGF1bnRpbmctZGV2b3RlZC1kZW5lYiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hhdW50aW5nLWRldm90ZWQtZGVuZWIiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXVudGluZy1kZXZvdGVkLWRlbmViLmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvZXVyb3BhLmpzCiAgdmFyIHNrYWxlRXVyb3BhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDQ2Mzk5MTI2LAogICAgbmFtZTogIlNLQUxFIHwgRXVyb3BhIExpcXVpZGl0eSBIdWIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2VsYXRlZC10YW4tc2thdCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2VsYXRlZC10YW4tc2thdCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VsYXRlZC10YW4tc2thdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxMTM0OTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2V1cm9wYVRlc3RuZXQuanMKICB2YXIgc2thbGVFdXJvcGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDQ0NjczNDE5LAogICAgbmFtZTogIlNLQUxFIEV1cm9wYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9qdWljeS1sb3ctc21hbGwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2p1aWN5LWxvdy1zbWFsbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vanVpY3ktbG93LXNtYWxsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTA4NTgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9leG9yZGUuanMKICB2YXIgc2thbGVFeG9yZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIxMzk5Mjc1NTIsCiAgICBuYW1lOiAiU0tBTEUgfCBFeG9yZGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2xpZ2h0LXZhc3QtZGlwaGRhIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGlnaHQtdmFzdC1kaXBoZGEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9saWdodC12YXN0LWRpcGhkYS5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2h1bWFuUHJvdG9jb2wuanMKICB2YXIgc2thbGVIdW1hblByb3RvY29sID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjczMjI3NDUzLAogICAgbmFtZTogIlNLQUxFIHwgSHVtYW4gUHJvdG9jb2wiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dhbi1yZWQtYWluIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3Mvd2FuLXJlZC1haW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW4tcmVkLWFpbi5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL25lYnVsYS5qcwogIHZhciBza2FsZU5lYnVsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTQ4MjYwMTY0OSwKICAgIG5hbWU6ICJTS0FMRSB8IE5lYnVsYSBHYW1pbmcgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9ncmVlbi1naWRkeS1kZW5lYm9sYSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dyZWVuLWdpZGR5LWRlbmVib2xhIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ3JlZW4tZ2lkZHktZGVuZWJvbGEuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMzcyOTg2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9uZWJ1bGFUZXN0bmV0LmpzCiAgdmFyIHNrYWxlTmVidWxhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzcwODQ2MjQsCiAgICBuYW1lOiAiU0tBTEUgTmVidWxhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL2xhbmt5LWlsbC1mdW5ueS10ZXN0bmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGFua3ktaWxsLWZ1bm55LXRlc3RuZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9sYW5reS1pbGwtZnVubnktdGVzdG5ldC5leHBsb3Jlci50ZXN0bmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNTE0MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3Jhem9yLmpzCiAgdmFyIHNrYWxlUmF6b3IgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI3ODYxMTM1MSwKICAgIG5hbWU6ICJTS0FMRSB8IFJhem9yIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3R1cmJ1bGVudC11bmlxdWUtc2NoZWF0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvdHVyYnVsZW50LXVuaXF1ZS1zY2hlYXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90dXJidWxlbnQtdW5pcXVlLXNjaGVhdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3RpdGFuLmpzCiAgdmFyIHNrYWxlVGl0YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzNTAyMTYyMzQsCiAgICBuYW1lOiAiU0tBTEUgfCBUaXRhbiBDb21tdW5pdHkgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wYXJhbGxlbC1zdG9ybXktc3BpY2EuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDc2NDU4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS90aXRhblRlc3RuZXQuanMKICB2YXIgc2thbGVUaXRhblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAzNTIyMjAsCiAgICBuYW1lOiAiU0tBTEUgVGl0YW4gSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9hd2FyZS1mYWtlLXRyaW0tdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2F3YXJlLWZha2UtdHJpbS10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXdhcmUtZmFrZS10cmltLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQwNzIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2V0Y2hwYWQuanMKICB2YXIgc2tldGNocGFkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5ODQxMjMsCiAgICBuYW1lOiAiRm9ybWEgU2tldGNocGFkIiwKICAgIG5ldHdvcms6ICJza2V0Y2hwYWQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiVElBIiwKICAgICAgbmFtZTogIlRJQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2tldGNocGFkLTEuZm9ybWEuYXJ0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLnNrZXRjaHBhZC0xLmZvcm1hLmFydCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNrZXRjaHBhZCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5za2V0Y2hwYWQtMS5mb3JtYS5hcnQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heC5qcwogIHZhciBzb3VyY2VJZDM4ID0gMTsKICB2YXIgc25heCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjE5MiwKICAgIG5ldHdvcms6ICJzbmF4Y2hhaW4tbWFpbm5ldCIsCiAgICBuYW1lOiAiU25heENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc25heGNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU25heCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zbmF4Y2hhaW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQ3MjU2MkZjZjI2RDZiMjc5M2Y4RTBiMGZCNjYwYmEwRTVlMDhBNDYiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM4XTogewogICAgICAgICAgYWRkcmVzczogIjB4MjE3MmU0OTJGYzgwN0Y1ZDU2NDVEMEUzNTQzZjEzOUVDRjUzOTI5NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDc5ZjQ0NkQwMjRkNzREMEJiNkU2OTlDMTMxYzcwMzQ2M2M1RDY1RTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NTM0QmRiNmI1YzA2MGQzZTZhYTgzMzQzMzMzMzEzNWVGRThFMGFBIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDM4CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heFRlc3RuZXQuanMKICB2YXIgc291cmNlSWQzOSA9IDExMTU1MTExOwogIHZhciBzbmF4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTMwMDEsCiAgICBuZXR3b3JrOiAic25heGNoYWluLXRlc3RuZXQiLAogICAgbmFtZTogIlNuYXhDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZXBvbGlhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5zbmF4Y2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbmF4IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDIwNmE3NWQ4OWQ0NUYxNDZDNTQwMjBGMTMyRkY5M2JFREQwOWY1NUUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM5XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjBlM0EzNjhhNGNkQ0VmODVmZkI5NjRlMzcyNzI2RjU2QTQ2MjIxZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGI1YWZkZDBFOGRERjA4MUVmOTBlOEEzZTBjN2I1Nzk4ZTY2RTk1NEUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiZDM3RTFhNTlENEMwMEM5QTQ2Rjc1MDE4ZGZmZDg0MDYxYkM1Zjc0IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzOQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmVpdW1NaW5hdG8uanMKICB2YXIgc291cmNlSWQ0MCA9IDExMTU1MTExOwogIHZhciBzb25laXVtTWluYXRvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxOTQ2LAogICAgbmFtZTogIlNvbmVpdW0gTWluYXRvIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWluYXRvLnNvbmVpdW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci10ZXN0bmV0LnNvbmVpdW0ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQuc29uZWl1bS5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDQwXTogewogICAgICAgICAgYWRkcmVzczogIjB4RjY5ZEI2Y0E1NTlDNTJkOUE0QkI2ZTJCMjkwMWY0OTBDYTM1RmJmNiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MTBlNTI4NkM3NDZlQzM4YmVlQjc1MzhkMDE0NmY2MEQyN2JlMzQzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NWVhMTQ4OTc0MUE1RDcyZkZkRDhlNjQ4NUIyMTZiQmRjQzE1QWYzIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNjQ2NjEzNgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQwXTogewogICAgICAgICAgYWRkcmVzczogIjB4NWY1YTQwNEE1ZWRhYmNERDgwREIwNUU4ZTU0QTc4YzlFQkYwMDBDMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDY0NjYxMzYKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ0MAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmdiaXJkLmpzCiAgdmFyIHNvbmdiaXJkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOSwKICAgIG5hbWU6ICJTb25nYmlyZCBDYW5hcnktTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb25nYmlyZCIsCiAgICAgIHN5bWJvbDogIlNHQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NvbmdiaXJkLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNvbmdiaXJkIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NvbmdiaXJkLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc29uZ2JpcmQtZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zb25nYmlyZFRlc3RuZXQuanMKICB2YXIgc29uZ2JpcmRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNiwKICAgIG5hbWU6ICJTb25nYmlyZCBUZXN0bmV0IENvc3RvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3N0b24gRmxhcmUiLAogICAgICBzeW1ib2w6ICJDRkxSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vY29zdG9uLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvc3RvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc29waG9uVGVzdG5ldC5qcwogIHZhciBzb3Bob25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDUzMTA1MDEwNCwKICAgIG5hbWU6ICJTb3Bob24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb3Bob24iLAogICAgICBzeW1ib2w6ICJTT1BIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5zb3Bob24ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50ZXN0bmV0LnNvcGhvbi54eXovd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTb3Bob24gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5zb3Bob24ueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4M2MwNGQxMTJhZGVkQTJDNkQ5MDM3YmI2ZWNiNDJFN2YwYjEwOEFmIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NjQyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3BpY3kuanMKICB2YXIgc3BpY3kgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODgyLAogICAgbmFtZTogIkNoaWxpeiBTcGljeSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJjaGlsaXotc3BpY3ktVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDSFoiLAogICAgICBzeW1ib2w6ICJDSFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vc3BpY3ktcnBjLmNoaWxpei5jb20iLAogICAgICAgICAgImh0dHBzOi8vY2hpbGl6LXNwaWN5LXJwYy5wdWJsaWNub2RlLmNvbSIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3NwaWN5LXJwYy13cy5jaGlsaXouY29tIiwKICAgICAgICAgICJ3c3M6Ly9jaGlsaXotc3BpY3ktcnBjLnB1YmxpY25vZGUuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hpbGl6IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwOi8vc3BpY3ktZXhwbG9yZXIuY2hpbGl6LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cDovL3NwaWN5LWV4cGxvcmVyLmNoaWxpei5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3N0ZXAuanMKICB2YXIgc3RlcCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzNCwKICAgIG5hbWU6ICJTdGVwIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZJVEZJIiwgc3ltYm9sOiAiRklURkkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RlcC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3RlcCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3N0ZXBzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdG9yeVRlc3RuZXQuanMKICB2YXIgc3RvcnlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTEzLAogICAgbmFtZTogIlN0b3J5IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSVAiLAogICAgICBzeW1ib2w6ICJJUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuc3RvcnlycGMuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdG9yeSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3RvcnlzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdHJhdGlzLmpzCiAgdmFyIHN0cmF0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwNTEwNSwKICAgIG5hbWU6ICJTdHJhdGlzIE1haW5uZXQiLAogICAgbmV0d29yazogInN0cmF0aXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIlN0cmF0aXMiLAogICAgICBzeW1ib2w6ICJTVFJBWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RyYXRpc2V2bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdHJhdGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnN0cmF0aXNldm0uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3VwZXJsdW1pby5qcwogIHZhciBzdXBlcmx1bWlvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODY2LAogICAgbmFtZTogIlN1cGVyTHVtaW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5sdW1pby5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkx1bWlvIGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmx1bWlvLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdXBlcnBvc2l0aW9uLmpzCiAgdmFyIHN1cGVycG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU1MjQ0LAogICAgbmFtZTogIlN1cGVycG9zaXRpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5zdXBlcnBvc2l0aW9uLnNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3VwZXJwb3NpdGlvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zdXBlcnBvc2l0aW9uLnNvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuLmpzCiAgdmFyIHN3YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1NCwKICAgIG5hbWU6ICJTd2FuIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQtcnBjLnN3YW5jaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3N3YW5zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuUHJveGltYVRlc3RuZXQuanMKICB2YXIgc3dhblByb3hpbWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDI0MTEzMywKICAgIG5hbWU6ICJTd2FuIFByb3hpbWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLXByb3hpbWEuc3dhbmNoYWluLmlvCSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlN3YW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcHJveGltYS1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3dhblNhdHVyblRlc3RuZXQuanMKICB2YXIgc3dhblNhdHVyblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjQsCiAgICBuYW1lOiAiU3dhbiBTYXR1cm4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vc2F0dXJuLXJwYy5zd2FuY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NhdHVybi1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pbi5qcwogIHZhciBzeXNjb2luID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NywKICAgIG5hbWU6ICJTeXNjb2luIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiU3lzY29pbiIsCiAgICAgIHN5bWJvbDogIlNZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnN5c2NvaW4ub3JnIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5zeXNjb2luLm9yZy93c3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTeXNjb2luRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI4NzEzOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pblRlc3RuZXQuanMKICB2YXIgc3lzY29pblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MDAsCiAgICBuYW1lOiAiU3lzY29pbiBUYW5lbmJhdW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTeXNjb2luIiwKICAgICAgc3ltYm9sOiAiU1lTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGFuZW5iYXVtLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50YW5lbmJhdW0uaW8vd3NzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3lzY29pblRlc3RuZXRFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90YW5lbmJhdW0uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjcxMjg4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrby5qcwogIHZhciB0YWlrbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3ZTMsCiAgICBuYW1lOiAiVGFpa28gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQudGFpa28ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLm1haW5uZXQudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGFpa29zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3RhaWtvc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkudGFpa29zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2IyNDM2Nzc0QzNlMTkxYzg1MDU2ZDI0OEVGNDI2MGNlNWYyN0E5RCIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhaWtvSGVrbGEuanMKICB2YXIgdGFpa29IZWtsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3MDA5LAogICAgbmFtZTogIlRhaWtvIEhla2xhIEwyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5oZWtsYS50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUYWlrb3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGVrbGEudGFpa29zY2FuLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29Kb2xuaXIuanMKICB2YXIgdGFpa29Kb2xuaXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNywKICAgIG5hbWU6ICJUYWlrbyBKb2xuaXIgKEFscGhhLTUgVGVzdG5ldCkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmpvbG5pci50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmpvbG5pci50YWlrby54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzMyNzA2CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29LYXRsYS5qcwogIHZhciB0YWlrb0thdGxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjcwMDgsCiAgICBuYW1lOiAiVGFpa28gS2F0bGEgKEFscGhhLTYgVGVzdG5ldCkiLAogICAgbmV0d29yazogInRrby1rYXRsYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMua2F0bGEudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rYXRsYS50YWlrby54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrb1Rlc3RuZXRTZXBvbGlhLmpzCiAgdmFyIHRhaWtvVGVzdG5ldFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNSwKICAgIG5hbWU6ICJUYWlrbyAoQWxwaGEtMyBUZXN0bmV0KSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdC50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3QudGFpa28ueHl6IgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFyYXhhLmpzCiAgdmFyIHRhcmF4YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQxLAogICAgbmFtZTogIlRhcmF4YSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tYWlubmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhcmF4YVRlc3RuZXQuanMKICB2YXIgdGFyYXhhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQyLAogICAgbmFtZTogIlRhcmF4YSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90ZWxjb2luVGVzdG5ldC5qcwogIHZhciB0ZWxjb2luVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAxNywKICAgIG5hbWU6ICJUZWxjb2luIEFkaXJpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRlbGNvaW4iLCBzeW1ib2w6ICJURUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVsY29pbi5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAidGVsc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZWxzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbG9zLmpzCiAgdmFyIHRlbG9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MCwKICAgIG5hbWU6ICJUZWxvcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJUZWxvcyIsCiAgICAgIHN5bWJvbDogIlRMT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnRlbG9zLm5ldC9ldm0iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUZWxvc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0NjUzMDcwOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGVsb3NUZXN0bmV0LmpzCiAgdmFyIHRlbG9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDEsCiAgICBuYW1lOiAiVGVsb3MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVsb3MiLAogICAgICBzeW1ib2w6ICJUTE9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC50ZWxvcy5uZXQvZXZtIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVsb3NjYW4gKHRlc3RuZXQpIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbmV0LmpzCiAgdmFyIHRlbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU5LAogICAgbmFtZTogIlRlbmV0IiwKICAgIG5ldHdvcms6ICJ0ZW5ldC1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJURU5FVCIsCiAgICAgIHN5bWJvbDogIlRFTkVUIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVuZXQub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVuZXRTY2FuIE1haW5uZXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVuZXRzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3RlbmV0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RoYWlDaGFpbi5qcwogIHZhciB0aGFpQ2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcsCiAgICBuYW1lOiAiVGhhaUNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUQ0giLCBzeW1ib2w6ICJUQ0giLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGhhaWNoYWluLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwRGFENjEzMGU4MzJjMjE3MTlDNUNFM2JhZTkzNDU0RTE2QTg0ODI2IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ4MDYzODYKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGhhdC5qcwogIHZhciB0aGF0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NDI4LAogICAgbmFtZTogIlRIQVQgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVEhBVCIsIHN5bWJvbDogIlRIQVQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkudGhhdGNoYWluLmlvL21haW5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3RoYXQuYmxvY2tzY291dC5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RoZXRhLmpzCiAgdmFyIHRoZXRhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjEsCiAgICBuYW1lOiAiVGhldGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVEZVRUwiLCBzeW1ib2w6ICJURlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC1ycGMtYXBpLnRoZXRhdG9rZW4ub3JnL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRoZXRhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRoZXRhdG9rZW4ub3JnIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aGV0YVRlc3RuZXQuanMKICB2YXIgdGhldGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjUsCiAgICBuYW1lOiAiVGhldGEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVEZVRUwiLCBzeW1ib2w6ICJURlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC1ycGMtYXBpLXRlc3RuZXQudGhldGF0b2tlbi5vcmcvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGhldGEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci50aGV0YXRva2VuLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aHVuZGVyQ29yZS5qcwogIHZhciB0aHVuZGVyQ29yZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTA4LAogICAgbmFtZTogIlRodW5kZXJDb3JlIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRUIiwgc3ltYm9sOiAiVFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy50aHVuZGVyY29yZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUaHVuZGVyQ29yZSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly92aWV3YmxvY2suaW8vdGh1bmRlcmNvcmUiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RodW5kZXJUZXN0bmV0LmpzCiAgdmFyIHRodW5kZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5OTcsCiAgICBuYW1lOiAiNWlyZUNoYWluIFRodW5kZXIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiNWlyZSBUb2tlbiIsIHN5bWJvbDogIjVJUkUiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtdGVzdG5ldC41aXJlLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICI1aXJlQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuNWlyZS5uZXR3b3JrIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Rpa3RyaXhUZXN0bmV0LmpzCiAgdmFyIHRpa3RyaXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MjA5MiwKICAgIG5hbWU6ICJUaWtUcml4IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogInRUVFgiLAogICAgICBzeW1ib2w6ICJ0VFRYIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rpa3RyaXgtcnBjLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRpa1RyaXggVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90aWt0cml4Lnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90b21iLmpzCiAgdmFyIHRvbWIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY5NjksCiAgICBuYW1lOiAiVG9tYiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUT01CIiwgc3ltYm9sOiAiVE9NQiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50b21iY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVG9tYiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90b21ic2NvdXQuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90cm9uLmpzCiAgdmFyIHRyb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcyODEyNjQyOCwKICAgIG5hbWU6ICJUcm9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUUk9OIiwgc3ltYm9sOiAiVFJYIiwgZGVjaW1hbHM6IDYgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkudHJvbmdyaWQuaW8vanNvbnJwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRyb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Ryb25zY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGlsaXN0LnRyb25zY2FuYXBpLmNvbS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy91bHRyb24uanMKICB2YXIgdWx0cm9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMxLAogICAgbmFtZTogIlVsdHJvbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJVTFgiLCBzeW1ib2w6ICJVTFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly91bHRyb24tcnBjLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlVsdHJvbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3VseHNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy91bHRyb25UZXN0bmV0LmpzCiAgdmFyIHVsdHJvblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyMzAsCiAgICBuYW1lOiAiVWx0cm9uIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlVMWCIsIHN5bWJvbDogIlVMWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3VsdHJvbi1kZXYuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbHRyb24gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci51bHRyb24tZGV2LmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VuaWNoYWluU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDQxID0gMTExNTUxMTE7CiAgdmFyIHVuaWNoYWluU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTMwMSwKICAgIG5hbWU6ICJVbmljaGFpbiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLnVuaWNoYWluLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlVuaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS51bmlzY2FuLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS51bmlzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQxXTogewogICAgICAgICAgYWRkcmVzczogIjB4MGQ4M2RhYjYyOWYwZTBGOWQzNmMwQ2JjODlCNjlhNDg5ZjA3NTFiRCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0MV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGVhNThmY0E2ODQ5ZDc5RUFkMWYyNjYwODg1NWMyRDY0MDdkNTRDZTIiCiAgICAgICAgfQogICAgICB9LAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQ0MV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGVmZjczZTVhYTNCOUFFQzMyYzY1OUFhM0UwMDQ0NGQyMGE4NDM5NGIiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQxCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdW5pcXVlLmpzCiAgdmFyIHVuaXF1ZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg4MCwKICAgIG5hbWU6ICJVbmlxdWUgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJVTlEiLAogICAgICBzeW1ib2w6ICJVTlEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudW5pcXVlLm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbmlxdWUgU3Vic2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly91bmlxdWUuc3Vic2Nhbi5pby8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy91bmlxdWVPcGFsLmpzCiAgdmFyIHVuaXF1ZU9wYWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODIsCiAgICBuYW1lOiAiT3BhbCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk9QTCIsCiAgICAgIHN5bWJvbDogIk9QTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy1vcGFsLnVuaXF1ZS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3BhbCBTdWJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL29wYWwuc3Vic2Nhbi5pby8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdW5pcXVlUXVhcnR6LmpzCiAgdmFyIHVuaXF1ZVF1YXJ0eiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg4MSwKICAgIG5hbWU6ICJRdWFydHogTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJRVFoiLAogICAgICBzeW1ib2w6ICJRVFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtcXVhcnR6LnVuaXF1ZS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUXVhcnR6IFN1YnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcXVhcnR6LnN1YnNjYW4uaW8vIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdW5yZWFsLmpzCiAgdmFyIHVucmVhbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTgyMzMsCiAgICBuYW1lOiAiVW5yZWFsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJyZUVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgc3ltYm9sOiAicmVFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudW5yZWFsLW9yYml0LmdlbGF0by5kaWdpdGFsIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVW5yZWFsIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3VucmVhbC5ibG9ja3Njb3V0LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly91bnJlYWwuYmxvY2tzY291dC5jb20vYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4OGI2QjBlNjBEOENEODQ4OThFYThiOTgxMDY1QTEyRjg3NmVBNTY3NyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNzQ1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92ZWNoYWluLmpzCiAgdmFyIHZlY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMDAwOSwKICAgIG5hbWU6ICJWZWNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWZUNoYWluIiwgc3ltYm9sOiAiVkVUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC52ZWNoYWluLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlZlY2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZS52ZWNoYWluLm9yZyIKICAgICAgfSwKICAgICAgdmVjaGFpblN0YXRzOiB7CiAgICAgICAgbmFtZTogIlZlY2hhaW4gU3RhdHMiLAogICAgICAgIHVybDogImh0dHBzOi8vdmVjaGFpbnN0YXRzLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3ZlbGFzLmpzCiAgdmFyIHZlbGFzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDYsCiAgICBuYW1lOiAiVmVsYXMgRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZMWCIsIHN5bWJvbDogIlZMWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V2bWV4cGxvcmVyLnZlbGFzLmNvbS9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWZWxhcyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ldm1leHBsb3Jlci52ZWxhcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3ZpY3Rpb24uanMKICB2YXIgdmljdGlvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODgsCiAgICBuYW1lOiAiVmljdGlvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVmljdGlvbiIsIHN5bWJvbDogIlZJQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy52aWN0aW9uLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlZJQyBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3ZpY3NjYW4ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92aWN0aW9uVGVzdG5ldC5qcwogIHZhciB2aWN0aW9uVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODksCiAgICBuYW1lOiAiVmljdGlvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWaWN0aW9uIiwgc3ltYm9sOiAiVklDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQudmljdGlvbi54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWSUMgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LnZpY3NjYW4ueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyMTcwMTc5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmlzaW9uLmpzCiAgdmFyIHZpc2lvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg4ODg4LAogICAgbmFtZTogIlZpc2lvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVklTSU9OIiwgc3ltYm9sOiAiVlMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9pbmZyYWdyaWQudi5uZXR3b3JrL2V0aGVyZXVtL2NvbXBhdGlibGUiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWaXNpb24gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly92aXNpb25zY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmlzaW9uVGVzdG5ldC5qcwogIHZhciB2aXNpb25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NjY2NjYsCiAgICBuYW1lOiAiVmlzaW9uIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZJU0lPTiIsIHN5bWJvbDogIlZTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdnBpb25lZXIuaW5mcmFncmlkLnYubmV0d29yay9ldGhlcmV1bS9jb21wYXRpYmxlIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVmlzaW9uIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdmlzaW9uc2Nhbi5vcmcvP2NoYWluPXZwaW9uZWVyIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3dhbmNoYWluLmpzCiAgdmFyIHdhbmNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODgsCiAgICBuYW1lOiAiV2FuY2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIldBTkNIQUlOIiwgc3ltYm9sOiAiV0FOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9nd2FuLXNzbC53YW5kZXZzLm9yZzo1Njg5MSIsCiAgICAgICAgICAiaHR0cHM6Ly9nd2FuMi1zc2wud2FuZGV2cy5vcmciCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJXYW5TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3dhbnNjYW4ub3JnIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjREY2QTE1NjZlNzhFQjQ1OTRjODZGZTczRmNkYzgyNDI5ZTk3ZmJCIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1MzEyMzkwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93YW5jaGFpblRlc3RuZXQuanMKICB2YXIgd2FuY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5OTksCiAgICBuYW1lOiAiV2FuY2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiV0FOQ0hBSU4iLCBzeW1ib2w6ICJXQU50IiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ3dhbi1zc2wud2FuZGV2cy5vcmc6NDY4OTEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJXYW5TY2FuVGVzdCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW5zY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4MTFjODliRjQ0OTZjMzlGQjgwNTM1RmZiNGM5MjcxNTgzOUNDNTMyNCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNDc0MzQ0OAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3dlYXZldm1BbHBoYW5ldC5qcwogIHZhciB3ZWF2ZVZNQWxwaGFuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk0OTYsCiAgICBuYW1lOiAiV2VhdmVWTSBBbHBoYW5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVGVzdG5ldCBXZWF2ZVZNIiwgc3ltYm9sOiAidFdWTSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy53dm0uZGV2Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV2VhdmVWTSBBbHBoYW5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci53dm0uZGV2IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3dlbWl4LmpzCiAgdmFyIHdlbWl4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTExLAogICAgbmFtZTogIldFTUlYIiwKICAgIG5ldHdvcms6ICJ3ZW1peC1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJXRU1JWCIsIHN5bWJvbDogIldFTUlYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS53ZW1peC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ3ZW1peEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLndlbWl4LmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3dlbWl4VGVzdG5ldC5qcwogIHZhciB3ZW1peFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTIsCiAgICBuYW1lOiAiV0VNSVggVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAid2VtaXgtdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiV0VNSVgiLCBzeW1ib2w6ICJ0V0VNSVgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLnRlc3Qud2VtaXguY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAid2VtaXhFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LndlbWl4c2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC53ZW1peHNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93b3JsZGNoYWluLmpzCiAgdmFyIHNvdXJjZUlkNDIgPSAxOwogIHZhciB3b3JsZGNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA0ODAsCiAgICBuYW1lOiAiV29ybGQgQ2hhaW4iLAogICAgbmV0d29yazogIndvcmxkY2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3dvcmxkY2hhaW4tbWFpbm5ldC5nLmFsY2hlbXkuY29tL3B1YmxpYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIldvcmxkc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93b3JsZHNjYW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS53b3JsZHNjYW4ub3JnL2FwaSIKICAgICAgfSwKICAgICAgYmxvY2tzY291dDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3dvcmxkY2hhaW4tbWFpbm5ldC5leHBsb3Jlci5hbGNoZW15LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93b3JsZGNoYWluLW1haW5uZXQuZXhwbG9yZXIuYWxjaGVteS5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfSwKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkNDJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgwRTkwZENBRkJDMjQyRDJDODYxQTIwQmIyMEVDOEU3MTgyOTY1YTUyIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE5QTZkMUU5MDM0NTk2MTk2Mjk1Q0YxNDg1MDk3OTY5NzgzNDNjNUQiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ1ZWMxNGE4M0I3ZDk1QkUxRTJBYzEyNTIzZTJkRUUxMkNiZWVhNkMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkNDJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0NzA0NThDOTE5NzhEMmQ5Mjk3MDQ0ODlBZDczMERDM0UzMDAxMTEzIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDIKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93b3JsZGNoYWluU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDQzID0gMTExNTUxMTE7CiAgdmFyIHdvcmxkY2hhaW5TZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA0ODAxLAogICAgbmFtZTogIldvcmxkIENoYWluIFNlcG9saWEiLAogICAgbmV0d29yazogIndvcmxkY2hhaW4tc2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmcuYWxjaGVteS5jb20vcHVibGljIl0gfSwKICAgICAgcHVibGljOiB7IGh0dHA6IFsiaHR0cHM6Ly93b3JsZGNoYWluLXNlcG9saWEuZy5hbGNoZW15LmNvbS9wdWJsaWMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJXb3JsZHNjYW4gU2Vwb2xpYSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLndvcmxkc2Nhbi5vcmciCiAgICAgIH0sCiAgICAgIGJsb2Nrc2NvdXQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93b3JsZGNoYWluLXNlcG9saWEuZXhwbG9yZXIuYWxjaGVteS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmV4cGxvcmVyLmFsY2hlbXkuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDQzXTogewogICAgICAgICAgYWRkcmVzczogIjB4OGNGOTdFZTYxNkM5ODZhMDcwRjUwMjBkOTczYjQ1NkQwMTIwQzI1MyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNDNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhjODg4NmY4QkFiNkVhZWIyMTVhREI1ZjFjNjg2QkY2OTkyNDgzMDBlIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGZjZFQmExMDkyNzFmZTZkNDIzN0VlZUQ0YkFiMWREOUE3N2REMUE0IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQzXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZDdERjU0YjM5ODk4NTVlYjY2NDk3MzAxYTRhQUVjMzNEYmIzRjhERSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy94YWkuanMKICB2YXIgeGFpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NjAyNzksCiAgICBuYW1lOiAiWGFpIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlhhaSIsIHN5bWJvbDogIlhBSSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3hhaS1jaGFpbi5uZXQvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci54YWktY2hhaW4ubmV0IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyMjU0OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy94YWlUZXN0bmV0LmpzCiAgdmFyIHhhaVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM3NzE0NTU1NDI5LAogICAgbmFtZTogIlhhaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzWGFpIiwgc3ltYm9sOiAic1hBSSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtdjIueGFpLWNoYWluLm5ldC9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXItdjIueGFpLWNoYWluLm5ldCIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy94ZGMuanMKICB2YXIgeGRjID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MCwKICAgIG5hbWU6ICJYaW5GaW4gTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJYREMiLAogICAgICBzeW1ib2w6ICJYREMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMueGRjcnBjLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlhEQ1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8veGRjc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDBCMTc5NWNjQThFNGVDNGRmMDIzNDZhMDgyZGY1NEQ0MzdGOEQ5YUYiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzU4ODQwMjAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3hkY1Rlc3RuZXQuanMKICB2YXIgeGRjVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTEsCiAgICBuYW1lOiAiQXBvdGhlbSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRYREMiLAogICAgICBzeW1ib2w6ICJUWERDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXJwYy5hcG90aGVtLm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJYRENTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQueGRjc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTk3NjUzODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3hMYXllci5qcwogIHZhciB4TGF5ZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5NiwKICAgIG5hbWU6ICJYIExheWVyIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiT0tCIiwKICAgICAgc3ltYm9sOiAiT0tCIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnhsYXllci50ZWNoIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT0tMaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5va2xpbmsuY29tL3hsYXllciIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cub2tsaW5rLmNvbS9hcGkvdjUvZXhwbG9yZXIveGxheWVyL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NzQxNgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveExheWVyVGVzdG5ldC5qcwogIHZhciB4TGF5ZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOTUsCiAgICBuYW1lOiAiWDEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPS0IiLAogICAgICBzeW1ib2w6ICJPS0IiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly94bGF5ZXJ0ZXN0cnBjLm9reC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPS0xpbmsiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm9rbGluay5jb20veGxheWVyLXRlc3QiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjI0MzQ0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveHJTZXBvbGlhLmpzCiAgdmFyIHhyU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjczMCwKICAgIG5hbWU6ICJYUiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRYUiIsCiAgICAgIHN5bWJvbDogInRYUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3hyLXNlcG9saWEtdGVzdG5ldC5ycGMuY2FsZGVyYS54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8veHItc2Vwb2xpYS10ZXN0bmV0LmV4cGxvcmVyLmNhbGRlcmEueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3lvb2xkb1ZlcnNlLmpzCiAgdmFyIHlvb2xkb1ZlcnNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNSwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk9BUyIsIHN5bWJvbDogIk9BUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy55b29sZG8tdmVyc2UueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWW9vbGRvIFZlcnNlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnlvb2xkby12ZXJzZS54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy95b29sZG9WZXJzZVRlc3RuZXQuanMKICB2YXIgeW9vbGRvVmVyc2VUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNiwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiT0FTIiwgc3ltYm9sOiAiT0FTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIllvb2xkbyBWZXJzZSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96ZW5jaGFpblRlc3RuZXQuanMKICB2YXIgemVuY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NDA4LAogICAgbmFtZTogIlplbmNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWkNYIiwKICAgICAgc3ltYm9sOiAiWkNYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYy13cyJdCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjMwMDE5CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlplbnRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3plbnRyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3plbmlxLmpzCiAgdmFyIHplbmlxID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzODM0MTQ4NDc4MjUsCiAgICBuYW1lOiAiWmVuaXEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiWkVOSVEiLCBzeW1ib2w6ICJaRU5JUSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FwaS56ZW5pcS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmVuaXEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vemVuaXFzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemV0YWNoYWluLmpzCiAgdmFyIHpldGFjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogN2UzLAogICAgbmFtZTogIlpldGFDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJaZXRhIiwKICAgICAgc3ltYm9sOiAiWkVUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vemV0YWNoYWluLWV2bS5ibG9ja3BpLm5ldHdvcmsvdjEvcnBjL3B1YmxpYyJdCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTYzMjc4MQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJaZXRhU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56ZXRhY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96ZXRhY2hhaW5BdGhlbnNUZXN0bmV0LmpzCiAgdmFyIHpldGFjaGFpbkF0aGVuc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcwMDEsCiAgICBuYW1lOiAiWmV0YUNoYWluIEF0aGVucyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlpldGEiLAogICAgICBzeW1ib2w6ICJhWkVUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vemV0YWNoYWluLWF0aGVucy1ldm0uYmxvY2twaS5uZXR3b3JrL3YxL3JwYy9wdWJsaWMiXQogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI3MTUyMTcKICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmV0YVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXRoZW5zLmV4cGxvcmVyLnpldGFjaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemhlamlhbmcuanMKICB2YXIgemhlamlhbmcgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMzc4MDMsCiAgICBuYW1lOiAiWmhlamlhbmciLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlpoZWppYW5nIEV0aGVyIiwgc3ltYm9sOiAiWmhlakVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy56aGVqaWFuZy5ldGhwYW5kYW9wcy5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlYWNvbmNoYWluIiwKICAgICAgICB1cmw6ICJodHRwczovL3poZWppYW5nLmJlYWNvbmNoYS5pbiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aWxsaXFhLmpzCiAgdmFyIHppbGxpcWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMyNzY5LAogICAgbmFtZTogIlppbGxpcWEiLAogICAgbmV0d29yazogInppbGxpcWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlppbGxpcWEiLCBzeW1ib2w6ICJaSUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkuemlsbGlxYS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcm5hbCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ldm14LnppbGxpcWEuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aWxsaXFhVGVzdG5ldC5qcwogIHZhciB6aWxsaXFhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzMxMDEsCiAgICBuYW1lOiAiWmlsbGlxYSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJ6aWxsaXFhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlppbGxpcWEiLCBzeW1ib2w6ICJaSUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9kZXYtYXBpLnppbGxpcWEuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJuYWwiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZteC50ZXN0bmV0LnppbGxpcWEuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3ppcmN1aXQuanMKICB2YXIgemlyY3VpdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDg5MDAsCiAgICBuYW1lOiAiWmlyY3VpdCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3ppcmN1aXQxLW1haW5uZXQucDJwaWZ5LmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0MS1tYWlubmV0LmxpcXVpZnkuY29tIiwKICAgICAgICAgICJodHRwczovL3ppcmN1aXQtbWFpbm5ldC5kcnBjLm9yZyIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlppcmN1aXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemlyY3VpdC5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3ppcmN1aXRUZXN0bmV0LmpzCiAgdmFyIHppcmN1aXRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0ODg5OSwKICAgIG5hbWU6ICJaaXJjdWl0IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkVUSCIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vemlyY3VpdDEtdGVzdG5ldC5wMnBpZnkuY29tIiwKICAgICAgICAgICJodHRwczovL3ppcmN1aXQxLXRlc3RuZXQubGlxdWlmeS5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJaaXJjdWl0IFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC56aXJjdWl0LmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MDQwMjg3CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtGYWlyLmpzCiAgdmFyIHprRmFpciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI3NjYsCiAgICBuYW1lOiAiWktGYWlyIE1haW5uZXQiLAogICAgbmV0d29yazogInprZmFpci1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlVTRCBDb2luIiwKICAgICAgc3ltYm9sOiAiVVNEQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnprZmFpci5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogInprRmFpciBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnprZmFpci5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnprZmFpci5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjA5MDk1OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a0ZhaXJUZXN0bmV0LmpzCiAgdmFyIHprRmFpclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzODUxLAogICAgbmFtZTogIlpLRmFpciBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJ6a2ZhaXItdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJVU0QgQ29pbiIsCiAgICAgIHN5bWJvbDogIlVTREMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLnprZmFpci5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogInprRmFpciBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXNjYW4uemtmYWlyLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prTGlua05vdmEuanMKICB2YXIgemtMaW5rTm92YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODEwMTgwLAogICAgbmFtZTogInprTGluayBOb3ZhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy56a2xpbmsuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0xpbmsgTm92YSBCbG9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56a2xpbmsuaW8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a0xpbmtOb3ZhU2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgemtMaW5rTm92YVNlcG9saWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MTAxODEsCiAgICBuYW1lOiAiemtMaW5rIE5vdmEgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NlcG9saWEucnBjLnprbGluay5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogInprTGluayBOb3ZhIEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuZXhwbG9yZXIuemtsaW5rLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtzeW5jLmpzCiAgdmFyIHprc3luYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAzMjQsCiAgICBuYW1lOiAiWktzeW5jIEVyYSIsCiAgICBuZXR3b3JrOiAiemtzeW5jLWVyYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5lcmEuemtzeW5jLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuZXJhLnprc3luYy5pby93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lcmEuemtzeW5jLm5ldHdvcmsvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1lcmEuemtzeW5jLm5ldHdvcmsvYXBpIgogICAgICB9LAogICAgICBuYXRpdmU6IHsKICAgICAgICBuYW1lOiAiWktzeW5jIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnprc3luYy5pby8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2stZXhwbG9yZXItYXBpLm1haW5uZXQuemtzeW5jLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RjljZGE2MjRGQkM3ZTA1OTM1NWNlOThhMzE2OTNkMjk5RkFDZDk2MyIKICAgICAgfSwKICAgICAgdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmQjY4ODMzMDM3OTk3NkRBODFlQjY0RmU0QkY1MGQ3NDAxNzYzQjlDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ1NjU5Mzg4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a3N5bmNJbk1lbW9yeU5vZGUuanMKICB2YXIgemtzeW5jSW5NZW1vcnlOb2RlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDI2MCwKICAgIG5hbWU6ICJaS3N5bmMgSW5NZW1vcnkgTm9kZSIsCiAgICBuZXR3b3JrOiAiemtzeW5jLWluLW1lbW9yeS1ub2RlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vbG9jYWxob3N0OjgwMTEiXQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prc3luY0xvY2FsTm9kZS5qcwogIHZhciB6a3N5bmNMb2NhbE5vZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcsCiAgICBpZDogMjcwLAogICAgbmFtZTogIlpLc3luYyBDTEkgTG9jYWwgTm9kZSIsCiAgICBuZXR3b3JrOiAiemtzeW5jLWNsaS1sb2NhbC1ub2RlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vbG9jYWxob3N0OjMwNTAiXQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prc3luY1NlcG9saWFUZXN0bmV0LmpzCiAgdmFyIHprc3luY1NlcG9saWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDMwMCwKICAgIG5hbWU6ICJaS3N5bmMgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJ6a3N5bmMtc2Vwb2xpYS10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuZXJhLnprc3luYy5kZXYiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vc2Vwb2xpYS5lcmEuemtzeW5jLmRldi93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLWVyYS56a3N5bmMubmV0d29yay8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEtZXJhLnprc3luYy5uZXR3b3JrL2FwaSIKICAgICAgfSwKICAgICAgbmF0aXZlOiB7CiAgICAgICAgbmFtZTogIlpLc3luYyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnprc3luYy5pby8iLAogICAgICAgIGJsb2NrRXhwbG9yZXJBcGk6ICJodHRwczovL2Jsb2NrLWV4cGxvcmVyLWFwaS5zZXBvbGlhLnprc3luYy5kZXYvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhGOWNkYTYyNEZCQzdlMDU5MzU1Y2U5OGEzMTY5M2QyOTlGQUNkOTYzIgogICAgICB9LAogICAgICB1bml2ZXJzYWxTaWduYXR1cmVWZXJpZmllcjogewogICAgICAgIGFkZHJlc3M6ICIweGZCNjg4MzMwMzc5OTc2REE4MWVCNjRGZTRCRjUwZDc0MDE3NjNCOUMiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzg1NTcxMgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3pvcmEuanMKICB2YXIgc291cmNlSWQ0NCA9IDE7CiAgdmFyIHpvcmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDc3Nzc3NzcsCiAgICBuYW1lOiAiWm9yYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnpvcmEuZW5lcmd5Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy56b3JhLmVuZXJneSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnpvcmEuZW5lcmd5IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnpvcmEuZW5lcmd5L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4OUU2MjA0Rjc1MGNEODY2YjI5OTU5NGUyYUM5ZUE4MjRFMmU1Zjk1YyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU4ODIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxYTBhZDAxMTkxM0ExNTBmNjlmNkExOURGNDQ3QTBDZkQ5NTUxMDU0IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4M2UyRWE5QjkyQjdFNDhBNTIyOTZmRDI2MWRjMjZmZDk5NTI4NDYzMSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ0NAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3pvcmFTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkNDUgPSAxMTE1NTExMTsKICB2YXIgem9yYVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDk5OTk5OTk5OSwKICAgIG5hbWU6ICJab3JhIFNlcG9saWEiLAogICAgbmV0d29yazogInpvcmEtc2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJab3JhIFNlcG9saWEiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEucnBjLnpvcmEuZW5lcmd5Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NlcG9saWEucnBjLnpvcmEuZW5lcmd5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWm9yYSBTZXBvbGlhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuZXhwbG9yZXIuem9yYS5lbmVyZ3kvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NlcG9saWEuZXhwbG9yZXIuem9yYS5lbmVyZ3kvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNDVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNjE1QjQ4MUJkM0U1QTFDMEM3Q2EzRGExYmRjNjYzRTg2MTVBZGU5IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODMxNjAKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlZmZFMkM2Y0E5QWI3OTdENDE4ZjBEOTFlQTYwODA3NzEzZjM1MzZmIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQ1XTogewogICAgICAgICAgYWRkcmVzczogIjB4NTM3NmYxRDU0M2RjYkI1QkQ0MTZjNTZDMTg5ZTRjQjczOTlmQ2NDQiIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ0NSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96b3JhVGVzdG5ldC5qcwogIHZhciBzb3VyY2VJZDQ2ID0gNTsKICB2YXIgem9yYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDk5OSwKICAgIG5hbWU6ICJab3JhIEdvZXJsaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlpvcmEgR29lcmxpIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnJwYy56b3JhLmVuZXJneSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnJwYy56b3JhLmVuZXJneSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuZXhwbG9yZXIuem9yYS5lbmVyZ3kiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5leHBsb3Jlci56b3JhLmVuZXJneS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTg5MTIzCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4RGI5RjUxNzkwMzY1ZTdkYzE5NmU3RDA3MjcyOGRmMzlCZTk1OEFDZSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ0NiwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3ByaXZhdGVLZXlUb0FjY291bnQuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3RvQWNjb3VudC5qcwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgZnVuY3Rpb24gdG9BY2NvdW50KHNvdXJjZSkgewogICAgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICJzdHJpbmciKSB7CiAgICAgIGlmICghaXNBZGRyZXNzKHNvdXJjZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogc291cmNlIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGFkZHJlc3M6IHNvdXJjZSwKICAgICAgICB0eXBlOiAianNvbi1ycGMiCiAgICAgIH07CiAgICB9CiAgICBpZiAoIWlzQWRkcmVzcyhzb3VyY2UuYWRkcmVzcywgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHNvdXJjZS5hZGRyZXNzIH0pOwogICAgcmV0dXJuIHsKICAgICAgYWRkcmVzczogc291cmNlLmFkZHJlc3MsCiAgICAgIG5vbmNlTWFuYWdlcjogc291cmNlLm5vbmNlTWFuYWdlciwKICAgICAgc2lnbjogc291cmNlLnNpZ24sCiAgICAgIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbjogc291cmNlLmV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbiwKICAgICAgc2lnbk1lc3NhZ2U6IHNvdXJjZS5zaWduTWVzc2FnZSwKICAgICAgc2lnblRyYW5zYWN0aW9uOiBzb3VyY2Uuc2lnblRyYW5zYWN0aW9uLAogICAgICBzaWduVHlwZWREYXRhOiBzb3VyY2Uuc2lnblR5cGVkRGF0YSwKICAgICAgc291cmNlOiAiY3VzdG9tIiwKICAgICAgdHlwZTogImxvY2FsIgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuNDAvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduLmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2lnbih7IGhhc2g6IGhhc2gzLCBwcml2YXRlS2V5LCB0byA9ICJvYmplY3QiIH0pIHsKICAgIGNvbnN0IHsgciwgcywgcmVjb3ZlcnkgfSA9IHNlY3AyNTZrMS5zaWduKGhhc2gzLnNsaWNlKDIpLCBwcml2YXRlS2V5LnNsaWNlKDIpKTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgczogbnVtYmVyVG9IZXgocywgeyBzaXplOiAzMiB9KSwKICAgICAgdjogcmVjb3ZlcnkgPyAyOG4gOiAyN24sCiAgICAgIHlQYXJpdHk6IHJlY292ZXJ5CiAgICB9OwogICAgcmV0dXJuICgoKSA9PiB7CiAgICAgIGlmICh0byA9PT0gImJ5dGVzIiB8fCB0byA9PT0gImhleCIpCiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZVNpZ25hdHVyZSh7IC4uLnNpZ25hdHVyZSwgdG8gfSk7CiAgICAgIHJldHVybiBzaWduYXR1cmU7CiAgICB9KSgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3V0aWxzL3NpZ25BdXRob3JpemF0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gZXhwZXJpbWVudGFsX3NpZ25BdXRob3JpemF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgY29udHJhY3RBZGRyZXNzLCBjaGFpbklkLCBub25jZSwgcHJpdmF0ZUtleSwgdG8gPSAib2JqZWN0IiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IHNpZ24oewogICAgICBoYXNoOiBoYXNoQXV0aG9yaXphdGlvbih7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UgfSksCiAgICAgIHByaXZhdGVLZXksCiAgICAgIHRvCiAgICB9KTsKICAgIGlmICh0byA9PT0gIm9iamVjdCIpCiAgICAgIHJldHVybiB7CiAgICAgICAgY29udHJhY3RBZGRyZXNzLAogICAgICAgIGNoYWluSWQsCiAgICAgICAgbm9uY2UsCiAgICAgICAgLi4uc2lnbmF0dXJlCiAgICAgIH07CiAgICByZXR1cm4gc2lnbmF0dXJlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3V0aWxzL3NpZ25NZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2lnbk1lc3NhZ2UyKHsgbWVzc2FnZSwgcHJpdmF0ZUtleSB9KSB7CiAgICByZXR1cm4gYXdhaXQgc2lnbih7IGhhc2g6IGhhc2hNZXNzYWdlKG1lc3NhZ2UpLCBwcml2YXRlS2V5LCB0bzogImhleCIgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjQwL25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvc2lnblRyYW5zYWN0aW9uLmpzCiAgaW5pdF9rZWNjYWsyNTYoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduVHJhbnNhY3Rpb24yKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgcHJpdmF0ZUtleSwgdHJhbnNhY3Rpb24sIHNlcmlhbGl6ZXIgPSBzZXJpYWxpemVUcmFuc2FjdGlvbiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHNpZ25hYmxlVHJhbnNhY3Rpb24gPSAoKCkgPT4gewogICAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImVpcDQ4NDQiKQogICAgICAgIHJldHVybiB7CiAgICAgICAgICAuLi50cmFuc2FjdGlvbiwKICAgICAgICAgIHNpZGVjYXJzOiBmYWxzZQogICAgICAgIH07CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0pKCk7CiAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBzaWduKHsKICAgICAgaGFzaDoga2VjY2FrMjU2KHNlcmlhbGl6ZXIoc2lnbmFibGVUcmFuc2FjdGlvbikpLAogICAgICBwcml2YXRlS2V5CiAgICB9KTsKICAgIHJldHVybiBzZXJpYWxpemVyKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3V0aWxzL3NpZ25UeXBlZERhdGEuanMKICBhc3luYyBmdW5jdGlvbiBzaWduVHlwZWREYXRhMihwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHByaXZhdGVLZXksIC4uLnR5cGVkRGF0YSB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiBhd2FpdCBzaWduKHsKICAgICAgaGFzaDogaGFzaFR5cGVkRGF0YSh0eXBlZERhdGEpLAogICAgICBwcml2YXRlS2V5LAogICAgICB0bzogImhleCIKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS40MC9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3ByaXZhdGVLZXlUb0FjY291bnQuanMKICBmdW5jdGlvbiBwcml2YXRlS2V5VG9BY2NvdW50KHByaXZhdGVLZXksIG9wdGlvbnMgPSB7fSkgewogICAgY29uc3QgeyBub25jZU1hbmFnZXI6IG5vbmNlTWFuYWdlcjIgfSA9IG9wdGlvbnM7CiAgICBjb25zdCBwdWJsaWNLZXkgPSB0b0hleChzZWNwMjU2azEuZ2V0UHVibGljS2V5KHByaXZhdGVLZXkuc2xpY2UoMiksIGZhbHNlKSk7CiAgICBjb25zdCBhZGRyZXNzID0gcHVibGljS2V5VG9BZGRyZXNzKHB1YmxpY0tleSk7CiAgICBjb25zdCBhY2NvdW50ID0gdG9BY2NvdW50KHsKICAgICAgYWRkcmVzcywKICAgICAgbm9uY2VNYW5hZ2VyOiBub25jZU1hbmFnZXIyLAogICAgICBhc3luYyBzaWduKHsgaGFzaDogaGFzaDMgfSkgewogICAgICAgIHJldHVybiBzaWduKHsgaGFzaDogaGFzaDMsIHByaXZhdGVLZXksIHRvOiAiaGV4IiB9KTsKICAgICAgfSwKICAgICAgYXN5bmMgZXhwZXJpbWVudGFsX3NpZ25BdXRob3JpemF0aW9uKGF1dGhvcml6YXRpb24pIHsKICAgICAgICByZXR1cm4gZXhwZXJpbWVudGFsX3NpZ25BdXRob3JpemF0aW9uKHsgLi4uYXV0aG9yaXphdGlvbiwgcHJpdmF0ZUtleSB9KTsKICAgICAgfSwKICAgICAgYXN5bmMgc2lnbk1lc3NhZ2UoeyBtZXNzYWdlIH0pIHsKICAgICAgICByZXR1cm4gc2lnbk1lc3NhZ2UyKHsgbWVzc2FnZSwgcHJpdmF0ZUtleSB9KTsKICAgICAgfSwKICAgICAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCB7IHNlcmlhbGl6ZXIgfSA9IHt9KSB7CiAgICAgICAgcmV0dXJuIHNpZ25UcmFuc2FjdGlvbjIoeyBwcml2YXRlS2V5LCB0cmFuc2FjdGlvbiwgc2VyaWFsaXplciB9KTsKICAgICAgfSwKICAgICAgYXN5bmMgc2lnblR5cGVkRGF0YSh0eXBlZERhdGEpIHsKICAgICAgICByZXR1cm4gc2lnblR5cGVkRGF0YTIoeyAuLi50eXBlZERhdGEsIHByaXZhdGVLZXkgfSk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgLi4uYWNjb3VudCwKICAgICAgcHVibGljS2V5LAogICAgICBzb3VyY2U6ICJwcml2YXRlS2V5IgogICAgfTsKICB9CgogIC8vIGxpYnMvc2hpbmthaS12aWVtL3NyYy9pbmRleC50cwogIHdpbmRvdy52aWVtID0gZXNtX2V4cG9ydHM7CiAgd2luZG93LmNoYWlucyA9IGNoYWluc19leHBvcnRzOwogIHZhciBWaWVtUHJvdmlkZXIgPSBjbGFzcyB7CiAgICBjbGllbnQ7CiAgICBzZWxlY3RlZEFkZHJlc3M7CiAgICBjb25zdHJ1Y3RvcihjaGFpbiwgc2spIHsKICAgICAgY29uc3QgcHJpdmF0ZUtleSA9IHNrIHx8ICIweGY0YzFjNmQ5MjMxYTVmMDhhYThkOTgyNGExNDJjNGZjNWE2NjNjYTFhNmVjZDYxMTI2ZTU0YTBkNzUwMWRmODIiOwogICAgICBjb25zdCBhY2NvdW50ID0gcHJpdmF0ZUtleVRvQWNjb3VudChwcml2YXRlS2V5KTsKICAgICAgdGhpcy5jbGllbnQgPSBjcmVhdGVXYWxsZXRDbGllbnQoewogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNoYWluIHx8IGFyYml0cnVtU2Vwb2xpYSwKICAgICAgICB0cmFuc3BvcnQ6IGh0dHAoCiAgICAgICAgICAiaHR0cHM6Ly9hcmJpdHJ1bS1zZXBvbGlhLmJsb2NrcGkubmV0d29yay92MS9ycGMvcHVibGljIgogICAgICAgICkKICAgICAgfSkuZXh0ZW5kKHB1YmxpY0FjdGlvbnMpOwogICAgICB0aGlzLmNsaWVudC5nZXRBZGRyZXNzZXMoKS50aGVuKChhZGRyZXNzZXMpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygiYWRkcmVzc2VzIiwgYWRkcmVzc2VzKTsKICAgICAgICB0aGlzLnNlbGVjdGVkQWRkcmVzcyA9IGFkZHJlc3Nlc1swXTsKICAgICAgfSk7CiAgICB9CiAgICBlbmFibGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RBY2NvdW50cygpOwogICAgfQogICAgcmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pIHsKICAgICAgY29uc29sZS5sb2coInJlcXVlc3QiLCBtZXRob2QsIHBhcmFtcyk7CiAgICAgIHN3aXRjaCAobWV0aG9kKSB7CiAgICAgICAgY2FzZSAiZXRoX3JlcXVlc3RBY2NvdW50cyI6CiAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0QWNjb3VudHMoKTsKICAgICAgICBjYXNlICJldGhfYWNjb3VudHMiOgogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLmdldEFjY291bnRzKCkpOwogICAgICAgIGNhc2UgImV0aF9zZW5kVHJhbnNhY3Rpb24iOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZFRyYW5zYWN0aW9uKHBhcmFtc1swXSk7CiAgICAgICAgY2FzZSAiZXRoX3NpZ24iOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2lnbihwYXJhbXNbMF0sIHBhcmFtc1sxXSk7CiAgICAgICAgY2FzZSAicGVyc29uYWxfc2lnbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5wZXJzb25hbFNpZ24ocGFyYW1zWzBdLCBwYXJhbXNbMV0pOwogICAgICAgIGNhc2UgImV0aF9zaWduVHlwZWREYXRhIjoKICAgICAgICAgIHJldHVybiB0aGlzLnNpZ25UeXBlZERhdGEocGFyYW1zWzBdLCBwYXJhbXNbMV0pOwogICAgICAgIGNhc2UgImV0aF9jaGFpbklkIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldENoYWluSWQoKTsKICAgICAgICBjYXNlICJuZXRfdmVyc2lvbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXROZXR3b3JrSWQoKTsKICAgICAgICBjYXNlICJldGhfYmxvY2tOdW1iZXIiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxvY2tOdW1iZXIoKTsKICAgICAgICBjYXNlICJldGhfZ2V0VHJhbnNhY3Rpb25Db3VudCI6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUcmFuc2FjdGlvbkNvdW50KHBhcmFtc1swXSk7CiAgICAgICAgY2FzZSAiZXRoX2dldFRyYW5zYWN0aW9uQnlIYXNoIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zYWN0aW9uKHBhcmFtc1swXSk7CiAgICAgICAgY2FzZSAiZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCI6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRUcmFuc2FjdGlvblJlY2VpcHQocGFyYW1zWzBdKTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBtZXRob2Q6ICR7bWV0aG9kfWApOwogICAgICB9CiAgICB9CiAgICBhc3luYyBnZXRUcmFuc2FjdGlvbihoYXNoMykgewogICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IHRoaXMuY2xpZW50LmdldFRyYW5zYWN0aW9uKHsgaGFzaDogaGFzaDMgfSk7CiAgICAgIGNvbnNvbGUubG9nKCJnZXRUcmFuc2FjdGlvbiIsIHRyYW5zYWN0aW9uKTsKICAgICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUgPT09ICJlaXAxNTU5IikgewogICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiMHgyIjsKICAgICAgfQogICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICB9CiAgICBhc3luYyBnZXRUcmFuc2FjdGlvblJlY2VpcHQoaGFzaDMpIHsKICAgICAgY29uc3QgcmVjZWlwdCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldFRyYW5zYWN0aW9uUmVjZWlwdCh7IGhhc2g6IGhhc2gzIH0pOwogICAgICBjb25zb2xlLmxvZygiZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IiwgcmVjZWlwdCk7CiAgICAgIGlmIChyZWNlaXB0LnR5cGUgPT09ICJlaXAxNTU5IikgewogICAgICAgIHJlY2VpcHQudHlwZSA9ICIweDIiOwogICAgICB9CiAgICAgIGlmIChyZWNlaXB0LnN0YXR1cyA9PT0gInN1Y2Nlc3MiKSB7CiAgICAgICAgcmVjZWlwdC5zdGF0dXMgPSAiMHgxIjsKICAgICAgfQogICAgICByZXR1cm4gcmVjZWlwdDsKICAgIH0KICAgIGFzeW5jIGdldFRyYW5zYWN0aW9uQ291bnQoYWRkcmVzcykgewogICAgICBjb25zdCB0cmFuc2FjdGlvbkNvdW50ID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VHJhbnNhY3Rpb25Db3VudCh7IGFkZHJlc3MgfSk7CiAgICAgIGNvbnNvbGUubG9nKCJ0cmFuc2FjdGlvbkNvdW50IiwgdHJhbnNhY3Rpb25Db3VudCk7CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbkNvdW50OwogICAgfQogICAgYXN5bmMgZ2V0QmxvY2tOdW1iZXIoKSB7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVyID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0QmxvY2tOdW1iZXIoKTsKICAgICAgY29uc29sZS5sb2coImJsb2NrTnVtYmVyIiwgYmxvY2tOdW1iZXIpOwogICAgICByZXR1cm4gYmxvY2tOdW1iZXI7CiAgICB9CiAgICBhc3luYyByZXF1ZXN0QWNjb3VudHMoKSB7CiAgICAgIGNvbnN0IFthZGRyZXNzXSA9IGF3YWl0IHRoaXMuY2xpZW50LmdldEFkZHJlc3NlcygpOwogICAgICBjb25zb2xlLmxvZygicmVxdWVzdEFjY291bnRzIiwgYWRkcmVzcyk7CiAgICAgIHRoaXMuc2VsZWN0ZWRBZGRyZXNzID0gYWRkcmVzczsKICAgICAgcmV0dXJuIFthZGRyZXNzXTsKICAgIH0KICAgIGdldEFjY291bnRzKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEFkZHJlc3MgPyBbdGhpcy5zZWxlY3RlZEFkZHJlc3NdIDogW107CiAgICB9CiAgICBhc3luYyBzZW5kVHJhbnNhY3Rpb24odHgpIHsKICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkQWRkcmVzcykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiTm8gYWNjb3VudHMgYXZhaWxhYmxlIik7CiAgICAgIH0KICAgICAgaWYgKCF0eC50byB8fCAhdHgudmFsdWUgfHwgIXR4LmdhcykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiTWlzc2luZyByZXF1aXJlZCB0cmFuc2FjdGlvbiBwYXJhbWV0ZXJzIik7CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coInNlbmRUcmFuc2FjdGlvbiB0eDogIiwgdHgpOwogICAgICBjb25zb2xlLmxvZygiVHJhbnNhY3Rpb24gZ2FzUHJpY2U6ICIsIHR4Lmdhc1ByaWNlKTsKICAgICAgY29uc29sZS5sb2coIlRyYW5zYWN0aW9uIGdhczogIiwgdHguZ2FzKTsKICAgICAgY29uc3QgdmFsdWUgPSBCaWdJbnQodHgudmFsdWUpOwogICAgICBjb25zdCB2YWx1ZUluRXRoID0gTnVtYmVyKHZhbHVlKSAvIDEwICoqIDE4OwogICAgICBjb25zb2xlLmxvZyhgVHJhbnNhY3Rpb24gdmFsdWUgaW4gRVRIOiAke3ZhbHVlSW5FdGh9YCk7CiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uQ29udGVudCA9IHsKICAgICAgICB0bzogdHgudG8sCiAgICAgICAgdmFsdWUsCiAgICAgICAgZGF0YTogdHguZGF0YSwKICAgICAgICBjaGFpbjogdGhpcy5jbGllbnQuY2hhaW4KICAgICAgfTsKICAgICAgY29uc29sZS5sb2coInNlbmRUcmFuc2FjdGlvbiIsIHRyYW5zYWN0aW9uQ29udGVudCk7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IHRoaXMuY2xpZW50LnByZXBhcmVUcmFuc2FjdGlvblJlcXVlc3QodHJhbnNhY3Rpb25Db250ZW50KTsKICAgICAgICBjb25zb2xlLmxvZygiUHJlcGFyZWQgdHJhbnNhY3Rpb24gcmVxdWVzdDoiLCByZXF1ZXN0KTsKICAgICAgICBjb25zdCBzZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBhd2FpdCB0aGlzLmNsaWVudC5zaWduVHJhbnNhY3Rpb24ocmVxdWVzdCk7CiAgICAgICAgY29uc29sZS5sb2coIlNlcmlhbGl6ZWQgdHJhbnNhY3Rpb246Iiwgc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgICAgICBjb25zdCBoYXNoMyA9IGF3YWl0IHRoaXMuY2xpZW50LnNlbmRSYXdUcmFuc2FjdGlvbih7CiAgICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24KICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygic2VuZFRyYW5zYWN0aW9uIGhhc2giLCBoYXNoMyk7CiAgICAgICAgcmV0dXJuIGhhc2gzOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoInNlbmRUcmFuc2FjdGlvbiBlcnJvciIsIGVycm9yKTsKICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgfQogICAgfQogICAgc2lnbihhZGRyZXNzLCBtZXNzYWdlKSB7CiAgICAgIGlmIChhZGRyZXNzICE9PSB0aGlzLnNlbGVjdGVkQWRkcmVzcykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQWRkcmVzcyBtaXNtYXRjaCIpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmNsaWVudC5zaWduTWVzc2FnZSh7IGFjY291bnQ6IGFkZHJlc3MsIG1lc3NhZ2UgfSk7CiAgICB9CiAgICBwZXJzb25hbFNpZ24obWVzc2FnZSwgYWRkcmVzcykgewogICAgICBpZiAoYWRkcmVzcyAhPT0gdGhpcy5zZWxlY3RlZEFkZHJlc3MpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkFkZHJlc3MgbWlzbWF0Y2giKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jbGllbnQuc2lnbk1lc3NhZ2UoeyBhY2NvdW50OiBhZGRyZXNzLCBtZXNzYWdlIH0pOwogICAgfQogICAgc2lnblR5cGVkRGF0YShhZGRyZXNzLCB0eXBlZERhdGEpIHsKICAgICAgaWYgKGFkZHJlc3MgIT09IHRoaXMuc2VsZWN0ZWRBZGRyZXNzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBZGRyZXNzIG1pc21hdGNoIik7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY2xpZW50LnNpZ25UeXBlZERhdGEoewogICAgICAgIGFjY291bnQ6IGFkZHJlc3MsCiAgICAgICAgZG9tYWluOiB0eXBlZERhdGEuZG9tYWluLAogICAgICAgIHR5cGVzOiB0eXBlZERhdGEudHlwZXMsCiAgICAgICAgbWVzc2FnZTogdHlwZWREYXRhLm1lc3NhZ2UsCiAgICAgICAgcHJpbWFyeVR5cGU6IHR5cGVkRGF0YS5wcmltYXJ5VHlwZQogICAgICB9KTsKICAgIH0KICAgIGFzeW5jIGdldENoYWluSWQoKSB7CiAgICAgIGNvbnN0IGNoYWluSWQgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXRDaGFpbklkKCk7CiAgICAgIGNvbnNvbGUubG9nKCJnZXRDaGFpbklkIiwgY2hhaW5JZCk7CiAgICAgIHJldHVybiBjaGFpbklkOwogICAgfQogICAgYXN5bmMgZ2V0TmV0d29ya0lkKCkgewogICAgICBjb25zdCBjaGFpbklkID0gYXdhaXQgdGhpcy5nZXRDaGFpbklkKCk7CiAgICAgIHJldHVybiBjaGFpbklkLnRvU3RyaW5nKCk7CiAgICB9CiAgfTsKICBmdW5jdGlvbiBhZGRFaXA2OTYzTGlzdGVuZXIoaW5mbywgcHJvdmlkZXIpIHsKICAgIGNvbnN0IGFubm91bmNlRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoCiAgICAgICJlaXA2OTYzOmFubm91bmNlUHJvdmlkZXIiLAogICAgICB7CiAgICAgICAgZGV0YWlsOiBPYmplY3QuZnJlZXplKHsgaW5mbywgcHJvdmlkZXIgfSkKICAgICAgfQogICAgKTsKICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGFubm91bmNlRXZlbnQpOwogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImVpcDY5NjM6cmVxdWVzdFByb3ZpZGVyIiwgKCkgPT4gewogICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChhbm5vdW5jZUV2ZW50KTsKICAgIH0pOwogIH0KICBmdW5jdGlvbiBpbml0aWFsaXplVmllbVByb3ZpZGVyKGNoYWluLCBwcm92aWRlckluZm8pIHsKICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IFZpZW1Qcm92aWRlcihjaGFpbiwgbnVsbCk7CiAgICB3aW5kb3cuZXRoZXJldW0gPSB7CiAgICAgIHJlcXVlc3Q6IHByb3ZpZGVyLnJlcXVlc3QuYmluZChwcm92aWRlciksCiAgICAgIGVuYWJsZTogcHJvdmlkZXIuZW5hYmxlLmJpbmQocHJvdmlkZXIpLAogICAgICBvbjogKGV2ZW50TmFtZSwgX2NhbGxiYWNrKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coYEV2ZW50IGxpc3RlbmVyIGZvciAke2V2ZW50TmFtZX0gYWRkZWQuYCk7CiAgICAgIH0sCiAgICAgIHJlbW92ZUxpc3RlbmVyOiAoZXZlbnROYW1lLCBfY2FsbGJhY2spID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhgRXZlbnQgbGlzdGVuZXIgZm9yICR7ZXZlbnROYW1lfSByZW1vdmVkLmApOwogICAgICB9LAogICAgICBpc0Nvbm5lY3RlZDogKCkgPT4gewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBzZW5kOiAobWV0aG9kLCBwYXJhbXMpID0+IHsKICAgICAgICBjb25zb2xlLndhcm4oInNlbmQgaXMgZGVwcmVjYXRlZC4gVXNlIHJlcXVlc3QgaW5zdGVhZC4iKTsKICAgICAgICByZXR1cm4gcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pOwogICAgICB9LAogICAgICBzZW5kQXN5bmM6IChwYXlsb2FkLCBjYWxsYmFjaykgPT4gewogICAgICAgIGNvbnNvbGUud2Fybigic2VuZEFzeW5jIGlzIGRlcHJlY2F0ZWQuIFVzZSByZXF1ZXN0IGluc3RlYWQuIik7CiAgICAgICAgcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZDogcGF5bG9hZC5tZXRob2QsIHBhcmFtczogcGF5bG9hZC5wYXJhbXMgfSkudGhlbigocmVzdWx0KSA9PiBjYWxsYmFjayhudWxsLCB7IHJlc3VsdCB9KSkuY2F0Y2goKGVycm9yKSA9PiBjYWxsYmFjayhlcnJvciwgbnVsbCkpOwogICAgICB9LAogICAgICBpc01ldGFNYXNrOiB0cnVlLAogICAgICAvLyBTZXQgdG8gdHJ1ZSBpZiBtaW1pY2tpbmcgTWV0YU1hc2sKICAgICAgc2VsZWN0ZWRBZGRyZXNzOiBwcm92aWRlci5zZWxlY3RlZEFkZHJlc3MsCiAgICAgIGNoYWluSWQ6IGNoYWluPy5pZCB8fCAiMHgxIgogICAgICAvLyBEZWZhdWx0IHRvIG1haW5uZXQgaWYgY2hhaW4gaXMgbm90IHByb3ZpZGVkCiAgICB9OwogICAgYWRkRWlwNjk2M0xpc3RlbmVyKHByb3ZpZGVySW5mbywgcHJvdmlkZXIpOwogICAgY29uc29sZS5sb2coIlZpZW0gcHJvdmlkZXIgaW5pdGlhbGl6ZWQiKTsKICB9CiAgdmFyIHZpZW1Qcm92aWRlckluZm8gPSB7CiAgICB1dWlkOiAiZDY5YmM0YzQtZTQzYS00ZDBhLTgzZDctYjZlN2I3NTA0YmViIiwKICAgIG5hbWU6ICJTaGlua2FpIFZpZW0gUHJvdmlkZXIiLAogICAgaWNvbjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU16WTNJaUJvWldsbmFIUTlJak0yTnlJZ2RtbGxkMEp2ZUQwaU1DQXdJRE0yTnlBek5qY2lJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4amFYSmpiR1VnWTNnOUlqRTRNeTQxSWlCamVUMGlNVGd6TGpVaUlISTlJakU0TXk0MUlpQm1hV3hzUFNJalJrVTJNVFl5SWk4K0NqeHdZWFJvSUdROUlrMHlOekl1TWprMUlESTNOQzQyTmpoRE1qY3dMamMxT0NBeU5qZ3VPVGMxSURJMk5pNDJNVGtnTWpZMkxqSXhOU0F5TmpBdU9EUTBJREkyTmk0M056bERNalE1TGpZMk5DQXlOamN1T0RZeklESTBOUzQ1TlRJZ01qWTBMakkzT1NBeU5EQXVOalEySURJMU5pNDBNRFJETWpVMExqWXlPQ0F5TlRrdU16WTNJREkyTXk0Mk5EWWdNalUxTGpjeU5TQXlOall1TkRZeklESTFOQzR4TURkRE1qY3dMakE1SURJMU1pNHdNVElnTWpjekxqYzJJREkwT1M0ek1qUWdNamN5TGpNd09TQXlORFF1TlRnMVF6STNNQzQ0T0RZZ01qTTVMamswTnlBeU5qWXVOakU1SURJek9TNHdNaklnTWpZeUxqSXpPQ0F5TXprdU9EWkRNalUyTGpBeU1pQXlOREV1TURRMUlESTFNQzR3TmpJZ01qUXhMamN6T0NBeU5EVXVNakkySURJek5TNDJPRFJETWpRMkxqSTFJREl6TkM0M05Ua2dNalEzTGpJM05DQXlNek11T0RBMklESTBPQzR6TWpjZ01qTXlMamc1TlVNeU5UQXVPVEF5SURJek1DNDJPRFVnTWpVeUxqZzVNeUF5TWpndU1EZzBJREkxTVM0MU9EUWdNakkwTGpVM00wTXlOVEF1TXpNeklESXlNUzR5TWlBeU5EY3VNVFl4SURJeE9TNHlPVGtnTWpRekxqa3pNaUF5TVRrdU9Ea3hRekkwTVM0eklESXlNQzR6T0RJZ01qTTJMakF5TXlBeU1qSXVNRE1nTWpNMExqUXhOaUF5TVRrdU16UXlUREl6TkM0ME9EY2dNakU1TGpNeE0wTXlNek11T0RjMUlESXhPUzR4TmprZ01qTXlMamt6TnlBeU1UWXVOalUwSURJek1pNDNNemNnTWpFMExqZ3hPVU15TXpFdU56azVJREl3TlM0NE5EWWdNak0xTGpZNE1pQXhPVGN1TWpNMUlESTBNQzQ1TVRZZ01Ua3dMakE0TWtNeU5EY3VORFExSURFNE1TNHhPVFlnTWpVeExqa3lOaUF4TnpFdU16azVJREkxTXk0NU1UY2dNVFl3TGpVek0wTXlOVGN1TURNeUlERTBNeTQwT0RNZ01qVXpMamN6TWlBeE1qY3VOakU0SURJME5DNDFNVFVnTVRFekxqQXpPVU15TXpNdU5UYzNJRGsxTGpjeU9ETWdNakU0TGpFMU9DQTROQzR6TWpjNElERTVOeTQ0TmlBNE1DNHhNemMxUXpFNU15NHdPVFVnTnprdU1UVTFJREU0T0M0ME5EUWdOemd1TmpNME9DQXhPRE11T1RNMUlEYzRMalUwT0RGRE1UYzVMalF4TVNBM09DNDJNelE0SURFM05DNDNOelFnTnprdU1UVTFJREUzTUM0d01Ea2dPREF1TVRNM05VTXhORGt1TnpJMklEZzBMak15TnpnZ01UTTBMakk1TXlBNU5TNDNNamd6SURFeU15NHpOVFFnTVRFekxqQXpPVU14TVRRdU1UVXhJREV5Tnk0Mk1UZ2dNVEV3TGpnMU1TQXhORE11TkRneklERXhNeTQ1TlRJZ01UWXdMalV6TTBNeE1UVXVPVEk1SURFM01TNDBNVFFnTVRJd0xqUXlOQ0F4T0RFdU1UazJJREV5Tmk0NU5UTWdNVGt3TGpBNE1rTXhNekl1TWpBeUlERTVOeTR5TXpVZ01UTTJMakE0TlNBeU1EVXVPRE15SURFek5TNHhNeklnTWpFMExqZ3hPVU14TXpRdU9UTXpJREl4Tmk0Mk5UUWdNVE16TGprNU5DQXlNVGt1TVRZNUlERXpNeTR6T0RJZ01qRTVMak14TTB3eE16TXVORFV6SURJeE9TNHpOREpETVRNeExqZzBOaUF5TWpJdU1ERTFJREV5Tmk0MU9ETWdNakl3TGpNNE1pQXhNak11T1RNNElESXhPUzQ0T1RGRE1USXdMamN5TXlBeU1Ua3VNams1SURFeE55NDFNemNnTWpJeExqSXlJREV4Tmk0eU9EVWdNakkwTGpVM00wTXhNVFF1T1RjMklESXlPQzR3T0RRZ01URTJMamsxTkNBeU16QXVOamcxSURFeE9TNDFORElnTWpNeUxqZzVOVU14TWpBdU5UazFJREl6TXk0NE1EWWdNVEl4TGpZeE9TQXlNelF1TnpVNUlERXlNaTQyTkRNZ01qTTFMalk0TkVNeE1UY3VPREEzSURJME1TNDNNemdnTVRFeExqZ3pNeUF5TkRFdU1EUTFJREV3TlM0Mk16RWdNak01TGpnMlF6RXdNUzR5TlNBeU16a3VNREl5SURrMkxqazRNamtnTWpNNUxqazBOeUE1TlM0MU5qQTFJREkwTkM0MU9EVkRPVFF1TVRBNU55QXlORGt1TXpJMElEazNMamMzT1RVZ01qVXlMakF4TWlBeE1ERXVOREEzSURJMU5DNHhNRGRETVRBMExqSXdPU0F5TlRVdU56STFJREV4TXk0eU5ERWdNalU1TGpNMU1pQXhNamN1TWpJeklESTFOaTQwTURSRE1USXhMamt4T0NBeU5qUXVNamM1SURFeE9DNHlNRFVnTWpZM0xqZzJNeUF4TURjdU1ESTFJREkyTmk0M056bERNVEF4TGpJMUlESTJOaTR5TVRVZ09UY3VNRGsyTnlBeU5qZ3VPVGMxSURrMUxqVTNORGNnTWpjMExqWTJPRU01TkM0d09ERXlJREk0TUM0eU16RWdPVGN1TURJMU5pQXlPRFF1TWpFNUlERXdNUzQyT1RFZ01qZzJMamczT0VNeE1EUXVOelE1SURJNE9DNDJNVElnTVRBNExqRTJNeUF5T0RrdU1qa3hJREV4TVM0M056WWdNamc1TGpNME9VTXhNekV1TlRZeUlESTRPUzQyTWpNZ01UUTNMamc1TVNBeU9ERXVORFU1SURFMk1pNDFPVGtnTWpZNUxqRTNPRU14TnpBdU5qa3lJREkyTWk0ME1UVWdNVGMzTGpNME9TQXlOVGd1T1RreElERTRNeTQ1TkRrZ01qVTRMamt3TkVNeE9UQXVOVFE1SURJMU9DNDVPVEVnTVRrM0xqRTVNU0F5TmpJdU5ERTFJREl3TlM0eU9Ua2dNalk1TGpFM09FTXlNakF1TURBM0lESTRNUzQwTlRrZ01qTTJMak16TmlBeU9Ea3VOakl6SURJMU5pNHhNaklnTWpnNUxqTTBPVU15TlRrdU56TTFJREk0T1M0ek1EVWdNall6TGpFME9DQXlPRGd1TmpFeUlESTJOaTR5TURjZ01qZzJMamczT0VNeU56QXVPRGcySURJNE5DNHlNVGtnTWpjekxqZ3hOeUF5T0RBdU1qTXhJREkzTWk0ek1qTWdNamMwTGpZMk9FZ3lOekl1TWprMVdrMHhOVFl1TmpJMElESXdOeTR5TmpKRE1UVXdMalV3T0NBeU1EY3VNalE0SURFME5TNDBOVGtnTWpBeUxqRXpNeUF4TkRVdU5EUTBJREU1TlM0NU5qTkRNVFExTGpRME5DQXhPRGt1TmpjNElERTFNQzQxTlRFZ01UZzBMalV6TkNBeE5UWXVPRFV5SURFNE5DNDBOelpETVRZeUxqZzBJREU0TkM0ME1UZ2dNVFk0TGpFM05DQXhPVEF1TURrM0lERTJPQzR4TVRjZ01UazJMalEyT1VNeE5qZ3VNRFl4SURJd01pNDNPRE1nTVRZekxqSTFNeUF5TURjdU1qa3hJREUxTmk0Mk1qUWdNakEzTGpJMk1scE5NakV4TGpJek1TQXlNRGN1TWpZeVF6SXdOQzQxT0RnZ01qQTNMakk1TVNBeE9Ua3VOemsxSURJd01pNDNOamtnTVRrNUxqY3pPQ0F4T1RZdU5EWTVRekU1T1M0Mk9ERWdNVGt3TGpBNU55QXlNRFV1TURJNUlERTROQzQwTVRnZ01qRXhMakF3TXlBeE9EUXVORGMyUXpJeE55NHpNRFFnTVRnMExqVTBPQ0F5TWpJdU5ERXhJREU0T1M0Mk9USWdNakl5TGpReE1TQXhPVFV1T1RZelF6SXlNaTQwTVRFZ01qQXlMakV6TXlBeU1UY3VNelEzSURJd055NHlORGdnTWpFeExqSXpNU0F5TURjdU1qWXlXaUlnWm1sc2JEMGlkMmhwZEdVaUx6NEtQQzl6ZG1jK0NnPT0iLAogICAgLy8gQmFzZTY0IGVuY29kZWQgaWNvbgogICAgcmRuczogImNvbS5zaGlua2FpLmRlc2t0b3AiCiAgfTsKICBpbml0aWFsaXplVmllbVByb3ZpZGVyKGFyYml0cnVtU2Vwb2xpYSwgdmllbVByb3ZpZGVySW5mbyk7Cn0pKCk7Ci8qISBCdW5kbGVkIGxpY2Vuc2UgaW5mb3JtYXRpb246CgpAbm9ibGUvaGFzaGVzL2VzbS91dGlscy5qczoKICAoKiEgbm9ibGUtaGFzaGVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qczoKICAoKiEgbm9ibGUtY3VydmVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC9tb2R1bGFyLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanM6CiAgKCohIG5vYmxlLWN1cnZlcyAtIE1JVCBMaWNlbnNlIChjKSAyMDIyIFBhdWwgTWlsbGVyIChwYXVsbWlsbHIuY29tKSAqKQoKQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKKi8K';
('KCgpID0+IHsKICB2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogIHZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwogIHZhciBfX2VzbSA9IChmbiwgcmVzKSA9PiBmdW5jdGlvbiBfX2luaXQoKSB7CiAgICByZXR1cm4gZm4gJiYgKHJlcyA9ICgwLCBmbltfX2dldE93blByb3BOYW1lcyhmbilbMF1dKShmbiA9IDApKSwgcmVzOwogIH07CiAgdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgICBmb3IgKHZhciBuYW1lIGluIGFsbCkKICAgICAgX19kZWZQcm9wKHRhcmdldCwgbmFtZSwgeyBnZXQ6IGFsbFtuYW1lXSwgZW51bWVyYWJsZTogdHJ1ZSB9KTsKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzCiAgdmFyIHZlcnNpb247CiAgdmFyIGluaXRfdmVyc2lvbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbiA9ICIxLjAuNiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcwogIHZhciBCYXNlRXJyb3I7CiAgdmFyIGluaXRfZXJyb3JzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcyIoKSB7CiAgICAgIGluaXRfdmVyc2lvbigpOwogICAgICBCYXNlRXJyb3IgPSBjbGFzcyBfQmFzZUVycm9yIGV4dGVuZHMgRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHNob3J0TWVzc2FnZSwgYXJncyA9IHt9KSB7CiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRldGFpbHMgOiBhcmdzLmNhdXNlPy5tZXNzYWdlID8gYXJncy5jYXVzZS5tZXNzYWdlIDogYXJncy5kZXRhaWxzOwogICAgICAgICAgY29uc3QgZG9jc1BhdGg5ID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRvY3NQYXRoIHx8IGFyZ3MuZG9jc1BhdGggOiBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgY29uc3QgbWVzc2FnZSA9IFsKICAgICAgICAgICAgc2hvcnRNZXNzYWdlIHx8ICJBbiBlcnJvciBvY2N1cnJlZC4iLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgLi4uYXJncy5tZXRhTWVzc2FnZXMgPyBbLi4uYXJncy5tZXRhTWVzc2FnZXMsICIiXSA6IFtdLAogICAgICAgICAgICAuLi5kb2NzUGF0aDkgPyBbYERvY3M6IGh0dHBzOi8vYWJpdHlwZS5kZXYke2RvY3NQYXRoOX1gXSA6IFtdLAogICAgICAgICAgICAuLi5kZXRhaWxzID8gW2BEZXRhaWxzOiAke2RldGFpbHN9YF0gOiBbXSwKICAgICAgICAgICAgYFZlcnNpb246IGFiaXR5cGVAJHt2ZXJzaW9ufWAKICAgICAgICAgIF0uam9pbigiXG4iKTsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkZXRhaWxzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZG9jc1BhdGgiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtZXRhTWVzc2FnZXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaG9ydE1lc3NhZ2UiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkFiaVR5cGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKGFyZ3MuY2F1c2UpCiAgICAgICAgICAgIHRoaXMuY2F1c2UgPSBhcmdzLmNhdXNlOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5zaG9ydE1lc3NhZ2UgPSBzaG9ydE1lc3NhZ2U7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9yZWdleC5qcwogIGZ1bmN0aW9uIGV4ZWNUeXBlZChyZWdleCwgc3RyaW5nKSB7CiAgICBjb25zdCBtYXRjaCA9IHJlZ2V4LmV4ZWMoc3RyaW5nKTsKICAgIHJldHVybiBtYXRjaD8uZ3JvdXBzOwogIH0KICB2YXIgYnl0ZXNSZWdleCwgaW50ZWdlclJlZ2V4LCBpc1R1cGxlUmVnZXg7CiAgdmFyIGluaXRfcmVnZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vcmVnZXguanMiKCkgewogICAgICBieXRlc1JlZ2V4ID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgICAgIGludGVnZXJSZWdleCA9IC9edT9pbnQoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKICAgICAgaXNUdXBsZVJlZ2V4ID0gL15cKC4rP1wpLio/JC87CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaVBhcmFtZXRlci5qcwogIGZ1bmN0aW9uIGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpIHsKICAgIGxldCB0eXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBpZiAodHVwbGVSZWdleC50ZXN0KGFiaVBhcmFtZXRlci50eXBlKSAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKSB7CiAgICAgIHR5cGUgPSAiKCI7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzW2ldOwogICAgICAgIHR5cGUgKz0gZm9ybWF0QWJpUGFyYW1ldGVyKGNvbXBvbmVudCk7CiAgICAgICAgaWYgKGkgPCBsZW5ndGggLSAxKQogICAgICAgICAgdHlwZSArPSAiLCAiOwogICAgICB9CiAgICAgIGNvbnN0IHJlc3VsdCA9IGV4ZWNUeXBlZCh0dXBsZVJlZ2V4LCBhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIHR5cGUgKz0gYCkke3Jlc3VsdD8uYXJyYXkgPz8gIiJ9YDsKICAgICAgcmV0dXJuIGZvcm1hdEFiaVBhcmFtZXRlcih7CiAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICB9CiAgICBpZiAoImluZGV4ZWQiIGluIGFiaVBhcmFtZXRlciAmJiBhYmlQYXJhbWV0ZXIuaW5kZXhlZCkKICAgICAgdHlwZSA9IGAke3R5cGV9IGluZGV4ZWRgOwogICAgaWYgKGFiaVBhcmFtZXRlci5uYW1lKQogICAgICByZXR1cm4gYCR7dHlwZX0gJHthYmlQYXJhbWV0ZXIubmFtZX1gOwogICAgcmV0dXJuIHR5cGU7CiAgfQogIHZhciB0dXBsZVJlZ2V4OwogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIHR1cGxlUmVnZXggPSAvXnR1cGxlKD88YXJyYXk+KFxbKFxkKilcXSkqKSQvOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpUGFyYW1ldGVycyhhYmlQYXJhbWV0ZXJzKSB7CiAgICBsZXQgcGFyYW1zID0gIiI7CiAgICBjb25zdCBsZW5ndGggPSBhYmlQYXJhbWV0ZXJzLmxlbmd0aDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gYWJpUGFyYW1ldGVyc1tpXTsKICAgICAgcGFyYW1zICs9IGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpOwogICAgICBpZiAoaSAhPT0gbGVuZ3RoIC0gMSkKICAgICAgICBwYXJhbXMgKz0gIiwgIjsKICAgIH0KICAgIHJldHVybiBwYXJhbXM7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpUGFyYW1ldGVycy5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVyKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaUl0ZW0uanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtKGFiaUl0ZW0pIHsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiBgZnVuY3Rpb24gJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cyl9KSR7YWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgJiYgYWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgIT09ICJub25wYXlhYmxlIiA/IGAgJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eX1gIDogIiJ9JHthYmlJdGVtLm91dHB1dHMubGVuZ3RoID8gYCByZXR1cm5zICgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5vdXRwdXRzKX0pYCA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICByZXR1cm4gYGV2ZW50ICR7YWJpSXRlbS5uYW1lfSgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMpfSlgOwogICAgaWYgKGFiaUl0ZW0udHlwZSA9PT0gImVycm9yIikKICAgICAgcmV0dXJuIGBlcnJvciAke2FiaUl0ZW0ubmFtZX0oJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pYDsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJjb25zdHJ1Y3RvciIpCiAgICAgIHJldHVybiBgY29uc3RydWN0b3IoJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInBheWFibGUiID8gIiBwYXlhYmxlIiA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZmFsbGJhY2siKQogICAgICByZXR1cm4gImZhbGxiYWNrKCkiOwogICAgcmV0dXJuICJyZWNlaXZlKCkgZXh0ZXJuYWwgcGF5YWJsZSI7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaUl0ZW0gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpSXRlbS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVycygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMKICBmdW5jdGlvbiBpc0Vycm9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGVycm9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGVycm9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXZlbnRTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBleGVjVHlwZWQoZXZlbnRTaWduYXR1cmVSZWdleCwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LnRlc3Qoc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGV4ZWNUeXBlZChmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBzdHJ1Y3RTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKHN0cnVjdFNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRmFsbGJhY2tTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZmFsbGJhY2tTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzUmVjZWl2ZVNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiByZWNlaXZlU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICB2YXIgZXJyb3JTaWduYXR1cmVSZWdleCwgZXZlbnRTaWduYXR1cmVSZWdleCwgZnVuY3Rpb25TaWduYXR1cmVSZWdleCwgc3RydWN0U2lnbmF0dXJlUmVnZXgsIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIGZhbGxiYWNrU2lnbmF0dXJlUmVnZXgsIHJlY2VpdmVTaWduYXR1cmVSZWdleCwgbW9kaWZpZXJzLCBldmVudE1vZGlmaWVycywgZnVuY3Rpb25Nb2RpZmllcnM7CiAgdmFyIGluaXRfc2lnbmF0dXJlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGVycm9yU2lnbmF0dXJlUmVnZXggPSAvXmVycm9yICg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKVwoKD88cGFyYW1ldGVycz4uKj8pXCkkLzsKICAgICAgZXZlbnRTaWduYXR1cmVSZWdleCA9IC9eZXZlbnQgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopXCgoPzxwYXJhbWV0ZXJzPi4qPylcKSQvOwogICAgICBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4ID0gL15mdW5jdGlvbiAoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKilcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86ICg/PHNjb3BlPmV4dGVybmFsfHB1YmxpY3sxfSkpPyg/OiAoPzxzdGF0ZU11dGFiaWxpdHk+cHVyZXx2aWV3fG5vbnBheWFibGV8cGF5YWJsZXsxfSkpPyg/OiByZXR1cm5zXHM/XCgoPzxyZXR1cm5zPi4qPylcKSk/JC87CiAgICAgIHN0cnVjdFNpZ25hdHVyZVJlZ2V4ID0gL15zdHJ1Y3QgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopIFx7KD88cHJvcGVydGllcz4uKj8pXH0kLzsKICAgICAgY29uc3RydWN0b3JTaWduYXR1cmVSZWdleCA9IC9eY29uc3RydWN0b3JcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86XHMoPzxzdGF0ZU11dGFiaWxpdHk+cGF5YWJsZXsxfSkpPyQvOwogICAgICBmYWxsYmFja1NpZ25hdHVyZVJlZ2V4ID0gL15mYWxsYmFja1woXCkgZXh0ZXJuYWwoPzpccyg/PHN0YXRlTXV0YWJpbGl0eT5wYXlhYmxlezF9KSk/JC87CiAgICAgIHJlY2VpdmVTaWduYXR1cmVSZWdleCA9IC9ecmVjZWl2ZVwoXCkgZXh0ZXJuYWwgcGF5YWJsZSQvOwogICAgICBtb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgIm1lbW9yeSIsCiAgICAgICAgImluZGV4ZWQiLAogICAgICAgICJzdG9yYWdlIiwKICAgICAgICAiY2FsbGRhdGEiCiAgICAgIF0pOwogICAgICBldmVudE1vZGlmaWVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsiaW5kZXhlZCJdKTsKICAgICAgZnVuY3Rpb25Nb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgImNhbGxkYXRhIiwKICAgICAgICAibWVtb3J5IiwKICAgICAgICAic3RvcmFnZSIKICAgICAgXSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzCiAgdmFyIEludmFsaWRBYmlJdGVtRXJyb3IsIFVua25vd25UeXBlRXJyb3IsIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcjsKICB2YXIgaW5pdF9hYmlJdGVtID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZEFiaUl0ZW1FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNpZ25hdHVyZSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBpdGVtLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogYHBhcnNlQWJpSXRlbSgke0pTT04uc3RyaW5naWZ5KHNpZ25hdHVyZSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaWl0ZW0tMSIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRBYmlJdGVtRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25UeXBlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0eXBlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHR5cGUuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgVHlwZSAiJHt0eXBlfSIgaXMgbm90IGEgdmFsaWQgQUJJIHR5cGUuIFBlcmhhcHMgeW91IGZvcmdvdCB0byBpbmNsdWRlIGEgc3RydWN0IHNpZ25hdHVyZT9gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIlVua25vd25UeXBlRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIlVua25vd24gdHlwZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BUeXBlICIke3R5cGV9IiBpcyBub3QgYSB2YWxpZCBBQkkgdHlwZS5gXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNvbGlkaXR5VHlwZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvYWJpUGFyYW1ldGVyLmpzCiAgdmFyIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvciwgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwgSW52YWxpZFBhcmFtZXRlckVycm9yLCBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvciwgSW52YWxpZE1vZGlmaWVyRXJyb3IsIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I7CiAgdmFyIGluaXRfYWJpUGFyYW1ldGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXIoJHtKU09OLnN0cmluZ2lmeShwYXJhbSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaXBhcmFtZXRlci0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW1zIH0pIHsKICAgICAgICAgIHN1cGVyKCJGYWlsZWQgdG8gcGFyc2UgQUJJIHBhcmFtZXRlcnMuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXJzKCR7SlNPTi5zdHJpbmdpZnkocGFyYW1zLCBudWxsLCAyKX0pYCwKICAgICAgICAgICAgZG9jc1BhdGg6ICIvYXBpL2h1bWFuI3BhcnNlYWJpcGFyYW1ldGVycy0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFBhcmFtZXRlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0gfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkUGFyYW1ldGVyRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIG5hbWUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgIiR7bmFtZX0iIGlzIGEgcHJvdGVjdGVkIFNvbGlkaXR5IGtleXdvcmQuIE1vcmUgaW5mbzogaHR0cHM6Ly9kb2NzLnNvbGlkaXR5bGFuZy5vcmcvZW4vbGF0ZXN0L2NoZWF0c2hlZXQuaHRtbGAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRNb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRNb2RpZmllckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gLAogICAgICAgICAgICAgIGBEYXRhIGxvY2F0aW9uIGNhbiBvbmx5IGJlIHNwZWNpZmllZCBmb3IgYXJyYXksIHN0cnVjdCwgb3IgbWFwcGluZyB0eXBlcywgYnV0ICIke21vZGlmaWVyfSIgd2FzIGdpdmVuLmAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEZ1bmN0aW9uTW9kaWZpZXJFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEFiaVR5cGVQYXJhbWV0ZXJFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGFiaVBhcmFtZXRlciB9KSB7CiAgICAgICAgICBzdXBlcigiSW52YWxpZCBBQkkgcGFyYW1ldGVyLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogSlNPTi5zdHJpbmdpZnkoYWJpUGFyYW1ldGVyLCBudWxsLCAyKSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkFCSSBwYXJhbWV0ZXIgdHlwZSBpcyBpbnZhbGlkLiJdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkQWJpVHlwZVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc2lnbmF0dXJlLmpzCiAgdmFyIEludmFsaWRTaWduYXR1cmVFcnJvciwgVW5rbm93blNpZ25hdHVyZUVycm9yLCBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I7CiAgdmFyIGluaXRfc2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9zaWduYXR1cmUuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkU2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgJHt0eXBlfSBzaWduYXR1cmUuYCwgewogICAgICAgICAgICBkZXRhaWxzOiBzaWduYXR1cmUKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgVW5rbm93blNpZ25hdHVyZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2lnbmF0dXJlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNpZ25hdHVyZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgc3RydWN0IHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIk5vIHByb3BlcnRpZXMgZXhpc3QuIl0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZXJyb3JzL3N0cnVjdC5qcwogIHZhciBDaXJjdWxhclJlZmVyZW5jZUVycm9yOwogIHZhciBpbml0X3N0cnVjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3RydWN0LmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgQ2lyY3VsYXJSZWZlcmVuY2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIkNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3RlZC4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BTdHJ1Y3QgIiR7dHlwZX0iIGlzIGEgY2lyY3VsYXIgcmVmZXJlbmNlLmBdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJDaXJjdWxhclJlZmVyZW5jZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzCiAgdmFyIEludmFsaWRQYXJlbnRoZXNpc0Vycm9yOwogIHZhciBpbml0X3NwbGl0UGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjdXJyZW50LCBkZXB0aCB9KSB7CiAgICAgICAgICBzdXBlcigiVW5iYWxhbmNlZCBwYXJlbnRoZXNlcy4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGAiJHtjdXJyZW50LnRyaW0oKX0iIGhhcyB0b28gbWFueSAke2RlcHRoID4gMCA/ICJvcGVuaW5nIiA6ICJjbG9zaW5nIn0gcGFyZW50aGVzZXMuYAogICAgICAgICAgICBdLAogICAgICAgICAgICBkZXRhaWxzOiBgRGVwdGggIiR7ZGVwdGh9ImAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRQYXJlbnRoZXNpc0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL2NhY2hlLmpzCiAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVyQ2FjaGVLZXkocGFyYW0sIHR5cGUpIHsKICAgIGlmICh0eXBlKQogICAgICByZXR1cm4gYCR7dHlwZX06JHtwYXJhbX1gOwogICAgcmV0dXJuIHBhcmFtOwogIH0KICB2YXIgcGFyYW1ldGVyQ2FjaGU7CiAgdmFyIGluaXRfY2FjaGUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9jYWNoZS5qcyIoKSB7CiAgICAgIHBhcmFtZXRlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoWwogICAgICAgIC8vIFVubmFtZWQKICAgICAgICBbImFkZHJlc3MiLCB7IHR5cGU6ICJhZGRyZXNzIiB9XSwKICAgICAgICBbImJvb2wiLCB7IHR5cGU6ICJib29sIiB9XSwKICAgICAgICBbImJ5dGVzIiwgeyB0eXBlOiAiYnl0ZXMiIH1dLAogICAgICAgIFsiYnl0ZXMzMiIsIHsgdHlwZTogImJ5dGVzMzIiIH1dLAogICAgICAgIFsiaW50IiwgeyB0eXBlOiAiaW50MjU2IiB9XSwKICAgICAgICBbImludDI1NiIsIHsgdHlwZTogImludDI1NiIgfV0sCiAgICAgICAgWyJzdHJpbmciLCB7IHR5cGU6ICJzdHJpbmciIH1dLAogICAgICAgIFsidWludCIsIHsgdHlwZTogInVpbnQyNTYiIH1dLAogICAgICAgIFsidWludDgiLCB7IHR5cGU6ICJ1aW50OCIgfV0sCiAgICAgICAgWyJ1aW50MTYiLCB7IHR5cGU6ICJ1aW50MTYiIH1dLAogICAgICAgIFsidWludDI0IiwgeyB0eXBlOiAidWludDI0IiB9XSwKICAgICAgICBbInVpbnQzMiIsIHsgdHlwZTogInVpbnQzMiIgfV0sCiAgICAgICAgWyJ1aW50NjQiLCB7IHR5cGU6ICJ1aW50NjQiIH1dLAogICAgICAgIFsidWludDk2IiwgeyB0eXBlOiAidWludDk2IiB9XSwKICAgICAgICBbInVpbnQxMTIiLCB7IHR5cGU6ICJ1aW50MTEyIiB9XSwKICAgICAgICBbInVpbnQxNjAiLCB7IHR5cGU6ICJ1aW50MTYwIiB9XSwKICAgICAgICBbInVpbnQxOTIiLCB7IHR5cGU6ICJ1aW50MTkyIiB9XSwKICAgICAgICBbInVpbnQyNTYiLCB7IHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAvLyBOYW1lZAogICAgICAgIFsiYWRkcmVzcyBvd25lciIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAib3duZXIiIH1dLAogICAgICAgIFsiYWRkcmVzcyB0byIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAidG8iIH1dLAogICAgICAgIFsiYm9vbCBhcHByb3ZlZCIsIHsgdHlwZTogImJvb2wiLCBuYW1lOiAiYXBwcm92ZWQiIH1dLAogICAgICAgIFsiYnl0ZXMgX2RhdGEiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJfZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBkYXRhIiwgeyB0eXBlOiAiYnl0ZXMiLCBuYW1lOiAiZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBzaWduYXR1cmUiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJzaWduYXR1cmUiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBoYXNoIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJoYXNoIiB9XSwKICAgICAgICBbImJ5dGVzMzIgciIsIHsgdHlwZTogImJ5dGVzMzIiLCBuYW1lOiAiciIgfV0sCiAgICAgICAgWyJieXRlczMyIHJvb3QiLCB7IHR5cGU6ICJieXRlczMyIiwgbmFtZTogInJvb3QiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBzIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJzIiB9XSwKICAgICAgICBbInN0cmluZyBuYW1lIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogIm5hbWUiIH1dLAogICAgICAgIFsic3RyaW5nIHN5bWJvbCIsIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJzeW1ib2wiIH1dLAogICAgICAgIFsic3RyaW5nIHRva2VuVVJJIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInRva2VuVVJJIiB9XSwKICAgICAgICBbInVpbnQgdG9rZW5JZCIsIHsgdHlwZTogInVpbnQyNTYiLCBuYW1lOiAidG9rZW5JZCIgfV0sCiAgICAgICAgWyJ1aW50OCB2IiwgeyB0eXBlOiAidWludDgiLCBuYW1lOiAidiIgfV0sCiAgICAgICAgWyJ1aW50MjU2IGJhbGFuY2UiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogImJhbGFuY2UiIH1dLAogICAgICAgIFsidWludDI1NiB0b2tlbklkIiwgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiB9XSwKICAgICAgICBbInVpbnQyNTYgdmFsdWUiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogInZhbHVlIiB9XSwKICAgICAgICAvLyBJbmRleGVkCiAgICAgICAgWwogICAgICAgICAgImV2ZW50OmFkZHJlc3MgaW5kZXhlZCBmcm9tIiwKICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAiZnJvbSIsIGluZGV4ZWQ6IHRydWUgfQogICAgICAgIF0sCiAgICAgICAgWyJldmVudDphZGRyZXNzIGluZGV4ZWQgdG8iLCB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInRvIiwgaW5kZXhlZDogdHJ1ZSB9XSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludCBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludDI1NiBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXQogICAgICBdKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcwogIGZ1bmN0aW9uIHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZSwgc3RydWN0cyA9IHt9KSB7CiAgICBpZiAoaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpKSB7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSk7CiAgICAgIGlmICghbWF0Y2gpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSwgdHlwZTogImZ1bmN0aW9uIiB9KTsKICAgICAgY29uc3QgaW5wdXRQYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGlucHV0cyA9IFtdOwogICAgICBjb25zdCBpbnB1dExlbmd0aCA9IGlucHV0UGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSsrKSB7CiAgICAgICAgaW5wdXRzLnB1c2gocGFyc2VBYmlQYXJhbWV0ZXIoaW5wdXRQYXJhbXNbaV0sIHsKICAgICAgICAgIG1vZGlmaWVyczogZnVuY3Rpb25Nb2RpZmllcnMsCiAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0pKTsKICAgICAgfQogICAgICBjb25zdCBvdXRwdXRzID0gW107CiAgICAgIGlmIChtYXRjaC5yZXR1cm5zKSB7CiAgICAgICAgY29uc3Qgb3V0cHV0UGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnJldHVybnMpOwogICAgICAgIGNvbnN0IG91dHB1dExlbmd0aCA9IG91dHB1dFBhcmFtcy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRwdXRMZW5ndGg7IGkrKykgewogICAgICAgICAgb3V0cHV0cy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKG91dHB1dFBhcmFtc1tpXSwgewogICAgICAgICAgICBtb2RpZmllcnM6IGZ1bmN0aW9uTW9kaWZpZXJzLAogICAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbWF0Y2gubmFtZSwKICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHMsCiAgICAgICAgb3V0cHV0cwogICAgICB9OwogICAgfQogICAgaWYgKGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJldmVudCIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgewogICAgICAgICAgbW9kaWZpZXJzOiBldmVudE1vZGlmaWVycywKICAgICAgICAgIHN0cnVjdHMsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiB7IG5hbWU6IG1hdGNoLm5hbWUsIHR5cGU6ICJldmVudCIsIGlucHV0czogYWJpUGFyYW1ldGVycyB9OwogICAgfQogICAgaWYgKGlzRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFcnJvclNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJlcnJvciIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgeyBzdHJ1Y3RzLCB0eXBlOiAiZXJyb3IiIH0pKTsKICAgICAgfQogICAgICByZXR1cm4geyBuYW1lOiBtYXRjaC5uYW1lLCB0eXBlOiAiZXJyb3IiLCBpbnB1dHM6IGFiaVBhcmFtZXRlcnMgfTsKICAgIH0KICAgIGlmIChpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkpIHsKICAgICAgY29uc3QgbWF0Y2ggPSBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgaWYgKCFtYXRjaCkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFNpZ25hdHVyZUVycm9yKHsgc2lnbmF0dXJlLCB0eXBlOiAiY29uc3RydWN0b3IiIH0pOwogICAgICBjb25zdCBwYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlcnMgPSBbXTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cywgdHlwZTogImNvbnN0cnVjdG9yIiB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHM6IGFiaVBhcmFtZXRlcnMKICAgICAgfTsKICAgIH0KICAgIGlmIChpc0ZhbGxiYWNrU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHR5cGU6ICJmYWxsYmFjayIgfTsKICAgIGlmIChpc1JlY2VpdmVTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAicmVjZWl2ZSIsCiAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIKICAgICAgfTsKICAgIHRocm93IG5ldyBVbmtub3duU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUgfSk7CiAgfQogIGZ1bmN0aW9uIHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCBvcHRpb25zKSB7CiAgICBjb25zdCBwYXJhbWV0ZXJDYWNoZUtleSA9IGdldFBhcmFtZXRlckNhY2hlS2V5KHBhcmFtLCBvcHRpb25zPy50eXBlKTsKICAgIGlmIChwYXJhbWV0ZXJDYWNoZS5oYXMocGFyYW1ldGVyQ2FjaGVLZXkpKQogICAgICByZXR1cm4gcGFyYW1ldGVyQ2FjaGUuZ2V0KHBhcmFtZXRlckNhY2hlS2V5KTsKICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChwYXJhbSk7CiAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZChpc1R1cGxlID8gYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXggOiBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgcGFyYW0pOwogICAgaWYgKCFtYXRjaCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbWV0ZXJFcnJvcih7IHBhcmFtIH0pOwogICAgaWYgKG1hdGNoLm5hbWUgJiYgaXNTb2xpZGl0eUtleXdvcmQobWF0Y2gubmFtZSkpCiAgICAgIHRocm93IG5ldyBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvcih7IHBhcmFtLCBuYW1lOiBtYXRjaC5uYW1lIH0pOwogICAgY29uc3QgbmFtZSA9IG1hdGNoLm5hbWUgPyB7IG5hbWU6IG1hdGNoLm5hbWUgfSA6IHt9OwogICAgY29uc3QgaW5kZXhlZCA9IG1hdGNoLm1vZGlmaWVyID09PSAiaW5kZXhlZCIgPyB7IGluZGV4ZWQ6IHRydWUgfSA6IHt9OwogICAgY29uc3Qgc3RydWN0cyA9IG9wdGlvbnM/LnN0cnVjdHMgPz8ge307CiAgICBsZXQgdHlwZTsKICAgIGxldCBjb21wb25lbnRzID0ge307CiAgICBpZiAoaXNUdXBsZSkgewogICAgICB0eXBlID0gInR1cGxlIjsKICAgICAgY29uc3QgcGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnR5cGUpOwogICAgICBjb25zdCBjb21wb25lbnRzXyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50c18ucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cyB9KSk7CiAgICAgIH0KICAgICAgY29tcG9uZW50cyA9IHsgY29tcG9uZW50czogY29tcG9uZW50c18gfTsKICAgIH0gZWxzZSBpZiAobWF0Y2gudHlwZSBpbiBzdHJ1Y3RzKSB7CiAgICAgIHR5cGUgPSAidHVwbGUiOwogICAgICBjb21wb25lbnRzID0geyBjb21wb25lbnRzOiBzdHJ1Y3RzW21hdGNoLnR5cGVdIH07CiAgICB9IGVsc2UgaWYgKGR5bmFtaWNJbnRlZ2VyUmVnZXgudGVzdChtYXRjaC50eXBlKSkgewogICAgICB0eXBlID0gYCR7bWF0Y2gudHlwZX0yNTZgOwogICAgfSBlbHNlIHsKICAgICAgdHlwZSA9IG1hdGNoLnR5cGU7CiAgICAgIGlmICghKG9wdGlvbnM/LnR5cGUgPT09ICJzdHJ1Y3QiKSAmJiAhaXNTb2xpZGl0eVR5cGUodHlwZSkpCiAgICAgICAgdGhyb3cgbmV3IFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcih7IHR5cGUgfSk7CiAgICB9CiAgICBpZiAobWF0Y2gubW9kaWZpZXIpIHsKICAgICAgaWYgKCFvcHRpb25zPy5tb2RpZmllcnM/Lmhhcz8uKG1hdGNoLm1vZGlmaWVyKSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE1vZGlmaWVyRXJyb3IoewogICAgICAgICAgcGFyYW0sCiAgICAgICAgICB0eXBlOiBvcHRpb25zPy50eXBlLAogICAgICAgICAgbW9kaWZpZXI6IG1hdGNoLm1vZGlmaWVyCiAgICAgICAgfSk7CiAgICAgIGlmIChmdW5jdGlvbk1vZGlmaWVycy5oYXMobWF0Y2gubW9kaWZpZXIpICYmICFpc1ZhbGlkRGF0YUxvY2F0aW9uKHR5cGUsICEhbWF0Y2guYXJyYXkpKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yKHsKICAgICAgICAgIHBhcmFtLAogICAgICAgICAgdHlwZTogb3B0aW9ucz8udHlwZSwKICAgICAgICAgIG1vZGlmaWVyOiBtYXRjaC5tb2RpZmllcgogICAgICAgIH0pOwogICAgfQogICAgY29uc3QgYWJpUGFyYW1ldGVyID0gewogICAgICB0eXBlOiBgJHt0eXBlfSR7bWF0Y2guYXJyYXkgPz8gIiJ9YCwKICAgICAgLi4ubmFtZSwKICAgICAgLi4uaW5kZXhlZCwKICAgICAgLi4uY29tcG9uZW50cwogICAgfTsKICAgIHBhcmFtZXRlckNhY2hlLnNldChwYXJhbWV0ZXJDYWNoZUtleSwgYWJpUGFyYW1ldGVyKTsKICAgIHJldHVybiBhYmlQYXJhbWV0ZXI7CiAgfQogIGZ1bmN0aW9uIHNwbGl0UGFyYW1ldGVycyhwYXJhbXMsIHJlc3VsdCA9IFtdLCBjdXJyZW50ID0gIiIsIGRlcHRoID0gMCkgewogICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLnRyaW0oKS5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGNoYXIgPSBwYXJhbXNbaV07CiAgICAgIGNvbnN0IHRhaWwgPSBwYXJhbXMuc2xpY2UoaSArIDEpOwogICAgICBzd2l0Y2ggKGNoYXIpIHsKICAgICAgICBjYXNlICIsIjoKICAgICAgICAgIHJldHVybiBkZXB0aCA9PT0gMCA/IHNwbGl0UGFyYW1ldGVycyh0YWlsLCBbLi4ucmVzdWx0LCBjdXJyZW50LnRyaW0oKV0pIDogc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGgpOwogICAgICAgIGNhc2UgIigiOgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoICsgMSk7CiAgICAgICAgY2FzZSAiKSI6CiAgICAgICAgICByZXR1cm4gc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGggLSAxKTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoKTsKICAgICAgfQogICAgfQogICAgaWYgKGN1cnJlbnQgPT09ICIiKQogICAgICByZXR1cm4gcmVzdWx0OwogICAgaWYgKGRlcHRoICE9PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IoeyBjdXJyZW50LCBkZXB0aCB9KTsKICAgIHJlc3VsdC5wdXNoKGN1cnJlbnQudHJpbSgpKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGlzU29saWRpdHlUeXBlKHR5cGUpIHsKICAgIHJldHVybiB0eXBlID09PSAiYWRkcmVzcyIgfHwgdHlwZSA9PT0gImJvb2wiIHx8IHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgdHlwZSA9PT0gInN0cmluZyIgfHwgYnl0ZXNSZWdleC50ZXN0KHR5cGUpIHx8IGludGVnZXJSZWdleC50ZXN0KHR5cGUpOwogIH0KICBmdW5jdGlvbiBpc1NvbGlkaXR5S2V5d29yZChuYW1lKSB7CiAgICByZXR1cm4gbmFtZSA9PT0gImFkZHJlc3MiIHx8IG5hbWUgPT09ICJib29sIiB8fCBuYW1lID09PSAiZnVuY3Rpb24iIHx8IG5hbWUgPT09ICJzdHJpbmciIHx8IG5hbWUgPT09ICJ0dXBsZSIgfHwgYnl0ZXNSZWdleC50ZXN0KG5hbWUpIHx8IGludGVnZXJSZWdleC50ZXN0KG5hbWUpIHx8IHByb3RlY3RlZEtleXdvcmRzUmVnZXgudGVzdChuYW1lKTsKICB9CiAgZnVuY3Rpb24gaXNWYWxpZERhdGFMb2NhdGlvbih0eXBlLCBpc0FycmF5KSB7CiAgICByZXR1cm4gaXNBcnJheSB8fCB0eXBlID09PSAiYnl0ZXMiIHx8IHR5cGUgPT09ICJzdHJpbmciIHx8IHR5cGUgPT09ICJ0dXBsZSI7CiAgfQogIHZhciBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXgsIGR5bmFtaWNJbnRlZ2VyUmVnZXgsIHByb3RlY3RlZEtleXdvcmRzUmVnZXg7CiAgdmFyIGluaXRfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcyIoKSB7CiAgICAgIGluaXRfcmVnZXgoKTsKICAgICAgaW5pdF9hYmlJdGVtKCk7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlKCk7CiAgICAgIGluaXRfc3BsaXRQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfY2FjaGUoKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGFiaVBhcmFtZXRlcldpdGhvdXRUdXBsZVJlZ2V4ID0gL14oPzx0eXBlPlthLXpBLVokX11bYS16QS1aMC05JF9dKikoPzxhcnJheT4oPzpcW1xkKj9cXSkrPyk/KD86XHMoPzxtb2RpZmllcj5jYWxsZGF0YXxpbmRleGVkfG1lbW9yeXxzdG9yYWdlezF9KSk/KD86XHMoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKikpPyQvOwogICAgICBhYmlQYXJhbWV0ZXJXaXRoVHVwbGVSZWdleCA9IC9eXCgoPzx0eXBlPi4rPylcKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8oPzpccyg/PG1vZGlmaWVyPmNhbGxkYXRhfGluZGV4ZWR8bWVtb3J5fHN0b3JhZ2V7MX0pKT8oPzpccyg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSk/JC87CiAgICAgIGR5bmFtaWNJbnRlZ2VyUmVnZXggPSAvXnU/aW50JC87CiAgICAgIHByb3RlY3RlZEtleXdvcmRzUmVnZXggPSAvXig/OmFmdGVyfGFsaWFzfGFub255bW91c3xhcHBseXxhdXRvfGJ5dGV8Y2FsbGRhdGF8Y2FzZXxjYXRjaHxjb25zdGFudHxjb3B5b2Z8ZGVmYXVsdHxkZWZpbmVkfGVycm9yfGV2ZW50fGV4dGVybmFsfGZhbHNlfGZpbmFsfGZ1bmN0aW9ufGltbXV0YWJsZXxpbXBsZW1lbnRzfGlufGluZGV4ZWR8aW5saW5lfGludGVybmFsfGxldHxtYXBwaW5nfG1hdGNofG1lbW9yeXxtdXRhYmxlfG51bGx8b2Z8b3ZlcnJpZGV8cGFydGlhbHxwcml2YXRlfHByb21pc2V8cHVibGljfHB1cmV8cmVmZXJlbmNlfHJlbG9jYXRhYmxlfHJldHVybnxyZXR1cm5zfHNpemVvZnxzdGF0aWN8c3RvcmFnZXxzdHJ1Y3R8c3VwZXJ8c3VwcG9ydHN8c3dpdGNofHRoaXN8dHJ1ZXx0cnl8dHlwZWRlZnx0eXBlb2Z8dmFyfHZpZXd8dmlydHVhbCkkLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9zdHJ1Y3RzLmpzCiAgZnVuY3Rpb24gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpIHsKICAgIGNvbnN0IHNoYWxsb3dTdHJ1Y3RzID0ge307CiAgICBjb25zdCBzaWduYXR1cmVzTGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZXNMZW5ndGg7IGkrKykgewogICAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVzW2ldOwogICAgICBpZiAoIWlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgICAgY29udGludWU7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJzdHJ1Y3QiIH0pOwogICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbWF0Y2gucHJvcGVydGllcy5zcGxpdCgiOyIpOwogICAgICBjb25zdCBjb21wb25lbnRzID0gW107CiAgICAgIGNvbnN0IHByb3BlcnRpZXNMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBwcm9wZXJ0aWVzTGVuZ3RoOyBrKyspIHsKICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnRpZXNba107CiAgICAgICAgY29uc3QgdHJpbW1lZCA9IHByb3BlcnR5LnRyaW0oKTsKICAgICAgICBpZiAoIXRyaW1tZWQpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBjb25zdCBhYmlQYXJhbWV0ZXIgPSBwYXJzZUFiaVBhcmFtZXRlcih0cmltbWVkLCB7CiAgICAgICAgICB0eXBlOiAic3RydWN0IgogICAgICAgIH0pOwogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICB9CiAgICAgIGlmICghY29tcG9uZW50cy5sZW5ndGgpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSB9KTsKICAgICAgc2hhbGxvd1N0cnVjdHNbbWF0Y2gubmFtZV0gPSBjb21wb25lbnRzOwogICAgfQogICAgY29uc3QgcmVzb2x2ZWRTdHJ1Y3RzID0ge307CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoc2hhbGxvd1N0cnVjdHMpOwogICAgY29uc3QgZW50cmllc0xlbmd0aCA9IGVudHJpZXMubGVuZ3RoOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzTGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW25hbWUsIHBhcmFtZXRlcnNdID0gZW50cmllc1tpXTsKICAgICAgcmVzb2x2ZWRTdHJ1Y3RzW25hbWVdID0gcmVzb2x2ZVN0cnVjdHMocGFyYW1ldGVycywgc2hhbGxvd1N0cnVjdHMpOwogICAgfQogICAgcmV0dXJuIHJlc29sdmVkU3RydWN0czsKICB9CiAgZnVuY3Rpb24gcmVzb2x2ZVN0cnVjdHMoYWJpUGFyYW1ldGVycywgc3RydWN0cywgYW5jZXN0b3JzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSkgewogICAgY29uc3QgY29tcG9uZW50cyA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gYWJpUGFyYW1ldGVycy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlciA9IGFiaVBhcmFtZXRlcnNbaV07CiAgICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIGlmIChpc1R1cGxlKQogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICBlbHNlIHsKICAgICAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZCh0eXBlV2l0aG91dFR1cGxlUmVnZXgsIGFiaVBhcmFtZXRlci50eXBlKTsKICAgICAgICBpZiAoIW1hdGNoPy50eXBlKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IoeyBhYmlQYXJhbWV0ZXIgfSk7CiAgICAgICAgY29uc3QgeyBhcnJheSwgdHlwZSB9ID0gbWF0Y2g7CiAgICAgICAgaWYgKHR5cGUgaW4gc3RydWN0cykgewogICAgICAgICAgaWYgKGFuY2VzdG9ycy5oYXModHlwZSkpCiAgICAgICAgICAgIHRocm93IG5ldyBDaXJjdWxhclJlZmVyZW5jZUVycm9yKHsgdHlwZSB9KTsKICAgICAgICAgIGNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgICAgIC4uLmFiaVBhcmFtZXRlciwKICAgICAgICAgICAgdHlwZTogYHR1cGxlJHthcnJheSA/PyAiIn1gLAogICAgICAgICAgICBjb21wb25lbnRzOiByZXNvbHZlU3RydWN0cyhzdHJ1Y3RzW3R5cGVdID8/IFtdLCBzdHJ1Y3RzLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbLi4uYW5jZXN0b3JzLCB0eXBlXSkpCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzU29saWRpdHlUeXBlKHR5cGUpKQogICAgICAgICAgICBjb21wb25lbnRzLnB1c2goYWJpUGFyYW1ldGVyKTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgdGhyb3cgbmV3IFVua25vd25UeXBlRXJyb3IoeyB0eXBlIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbXBvbmVudHM7CiAgfQogIHZhciB0eXBlV2l0aG91dFR1cGxlUmVnZXg7CiAgdmFyIGluaXRfc3RydWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3N0cnVjdHMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGluaXRfYWJpSXRlbSgpOwogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZSgpOwogICAgICBpbml0X3N0cnVjdCgpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgICB0eXBlV2l0aG91dFR1cGxlUmVnZXggPSAvXig/PHR5cGU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8kLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMKICBmdW5jdGlvbiBwYXJzZUFiaShzaWduYXR1cmVzKSB7CiAgICBjb25zdCBzdHJ1Y3RzID0gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpOwogICAgY29uc3QgYWJpMiA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHNpZ25hdHVyZXNbaV07CiAgICAgIGlmIChpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpKQogICAgICAgIGNvbnRpbnVlOwogICAgICBhYmkyLnB1c2gocGFyc2VTaWduYXR1cmUoc2lnbmF0dXJlLCBzdHJ1Y3RzKSk7CiAgICB9CiAgICByZXR1cm4gYWJpMjsKICB9CiAgdmFyIGluaXRfcGFyc2VBYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMiKCkgewogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmlJdGVtLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlJdGVtKHNpZ25hdHVyZSkgewogICAgbGV0IGFiaUl0ZW07CiAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gInN0cmluZyIpCiAgICAgIGFiaUl0ZW0gPSBwYXJzZVNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMoc2lnbmF0dXJlKTsKICAgICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZV8gPSBzaWduYXR1cmVbaV07CiAgICAgICAgaWYgKGlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZV8pKQogICAgICAgICAgY29udGludWU7CiAgICAgICAgYWJpSXRlbSA9IHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZV8sIHN0cnVjdHMpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpSXRlbUVycm9yKHsgc2lnbmF0dXJlIH0pOwogICAgcmV0dXJuIGFiaUl0ZW07CiAgfQogIHZhciBpbml0X3BhcnNlQWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGluaXRfc3RydWN0cygpOwogICAgICBpbml0X3V0aWxzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL3BhcnNlQWJpUGFyYW1ldGVyLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlQYXJhbWV0ZXIyKHBhcmFtKSB7CiAgICBsZXQgYWJpUGFyYW1ldGVyOwogICAgaWYgKHR5cGVvZiBwYXJhbSA9PT0gInN0cmluZyIpCiAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCB7CiAgICAgICAgbW9kaWZpZXJzCiAgICAgIH0pOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW0pOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbS5sZW5ndGg7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBwYXJhbVtpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHNpZ25hdHVyZSwgeyBtb2RpZmllcnMsIHN0cnVjdHMgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFiaVBhcmFtZXRlckVycm9yKHsgcGFyYW0gfSk7CiAgICByZXR1cm4gYWJpUGFyYW1ldGVyOwogIH0KICB2YXIgaW5pdF9wYXJzZUFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlci5qcyIoKSB7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlcygpOwogICAgICBpbml0X3N0cnVjdHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMKICBmdW5jdGlvbiBwYXJzZUFiaVBhcmFtZXRlcnMocGFyYW1zKSB7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJzID0gW107CiAgICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNwbGl0UGFyYW1ldGVycyhwYXJhbXMpOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbWV0ZXJzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2ldLCB7IG1vZGlmaWVycyB9KSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW1zKTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHBhcmFtc1tpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzcGxpdFBhcmFtZXRlcnMoc2lnbmF0dXJlKTsKICAgICAgICBjb25zdCBsZW5ndGgyID0gcGFyYW1ldGVycy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBsZW5ndGgyOyBrKyspIHsKICAgICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2tdLCB7IG1vZGlmaWVycywgc3RydWN0cyB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoYWJpUGFyYW1ldGVycy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yKHsgcGFyYW1zIH0pOwogICAgcmV0dXJuIGFiaVBhcmFtZXRlcnM7CiAgfQogIHZhciBpbml0X3BhcnNlQWJpUGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMiKCkgewogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzCiAgdmFyIGluaXRfZXhwb3J0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzIigpIHsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtKCk7CiAgICAgIGluaXRfcGFyc2VBYmkoKTsKICAgICAgaW5pdF9wYXJzZUFiaUl0ZW0oKTsKICAgICAgaW5pdF9wYXJzZUFiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3BhcnNlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9hYmlQYXJhbWV0ZXIoKTsKICAgICAgaW5pdF9zaWduYXR1cmUoKTsKICAgICAgaW5pdF9zcGxpdFBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9zdHJ1Y3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZSA9IGZhbHNlIH0gPSB7fSkgewogICAgaWYgKGFiaUl0ZW0udHlwZSAhPT0gImZ1bmN0aW9uIiAmJiBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIgJiYgYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IoYWJpSXRlbS50eXBlKTsKICAgIHJldHVybiBgJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1zKGFiaUl0ZW0uaW5wdXRzLCB7IGluY2x1ZGVOYW1lIH0pfSlgOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lID0gZmFsc2UgfSA9IHt9KSB7CiAgICBpZiAoIXBhcmFtcykKICAgICAgcmV0dXJuICIiOwogICAgcmV0dXJuIHBhcmFtcy5tYXAoKHBhcmFtKSA9PiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSkuam9pbihpbmNsdWRlTmFtZSA/ICIsICIgOiAiLCIpOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ0dXBsZSIpKSB7CiAgICAgIHJldHVybiBgKCR7Zm9ybWF0QWJpUGFyYW1zKHBhcmFtLmNvbXBvbmVudHMsIHsgaW5jbHVkZU5hbWUgfSl9KSR7cGFyYW0udHlwZS5zbGljZSgidHVwbGUiLmxlbmd0aCl9YDsKICAgIH0KICAgIHJldHVybiBwYXJhbS50eXBlICsgKGluY2x1ZGVOYW1lICYmIHBhcmFtLm5hbWUgPyBgICR7cGFyYW0ubmFtZX1gIDogIiIpOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2Zvcm1hdEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0hleC5qcwogIGZ1bmN0aW9uIGlzSGV4KHZhbHVlLCB7IHN0cmljdCA9IHRydWUgfSA9IHt9KSB7CiAgICBpZiAoIXZhbHVlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0cmljdCA/IC9eMHhbMC05YS1mQS1GXSokLy50ZXN0KHZhbHVlKSA6IHZhbHVlLnN0YXJ0c1dpdGgoIjB4Iik7CiAgfQogIHZhciBpbml0X2lzSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL2lzSGV4LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvc2l6ZS5qcwogIGZ1bmN0aW9uIHNpemUodmFsdWUpIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIpOwogICAgcmV0dXJuIHZhbHVlLmxlbmd0aDsKICB9CiAgdmFyIGluaXRfc2l6ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zaXplLmpzIigpIHsKICAgICAgaW5pdF9pc0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3ZlcnNpb24uanMKICB2YXIgdmVyc2lvbjI7CiAgdmFyIGluaXRfdmVyc2lvbjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbjIgPSAiMi4yMS4zNSI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmFzZS5qcwogIGZ1bmN0aW9uIHNldEVycm9yQ29uZmlnKGNvbmZpZykgewogICAgZXJyb3JDb25maWcgPSBjb25maWc7CiAgfQogIGZ1bmN0aW9uIHdhbGsoZXJyLCBmbikgewogICAgaWYgKGZuPy4oZXJyKSkKICAgICAgcmV0dXJuIGVycjsKICAgIGlmIChlcnIgJiYgdHlwZW9mIGVyciA9PT0gIm9iamVjdCIgJiYgImNhdXNlIiBpbiBlcnIpCiAgICAgIHJldHVybiB3YWxrKGVyci5jYXVzZSwgZm4pOwogICAgcmV0dXJuIGZuID8gbnVsbCA6IGVycjsKICB9CiAgdmFyIGVycm9yQ29uZmlnLCBCYXNlRXJyb3IyOwogIHZhciBpbml0X2Jhc2UgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9iYXNlLmpzIigpIHsKICAgICAgaW5pdF92ZXJzaW9uMigpOwogICAgICBlcnJvckNvbmZpZyA9IHsKICAgICAgICBnZXREb2NzVXJsOiAoeyBkb2NzQmFzZVVybCwgZG9jc1BhdGg6IGRvY3NQYXRoOSA9ICIiLCBkb2NzU2x1ZyB9KSA9PiBkb2NzUGF0aDkgPyBgJHtkb2NzQmFzZVVybCA/PyAiaHR0cHM6Ly92aWVtLnNoIn0ke2RvY3NQYXRoOX0ke2RvY3NTbHVnID8gYCMke2RvY3NTbHVnfWAgOiAiIn1gIDogdm9pZCAwLAogICAgICAgIHZlcnNpb246IGB2aWVtQCR7dmVyc2lvbjJ9YAogICAgICB9OwogICAgICBCYXNlRXJyb3IyID0gY2xhc3MgX0Jhc2VFcnJvciBleHRlbmRzIEVycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaG9ydE1lc3NhZ2UsIGFyZ3MgPSB7fSkgewogICAgICAgICAgY29uc3QgZGV0YWlscyA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kZXRhaWxzOwogICAgICAgICAgICBpZiAoYXJncy5jYXVzZT8ubWVzc2FnZSkKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5tZXNzYWdlOwogICAgICAgICAgICByZXR1cm4gYXJncy5kZXRhaWxzOwogICAgICAgICAgfSkoKTsKICAgICAgICAgIGNvbnN0IGRvY3NQYXRoOSA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kb2NzUGF0aCB8fCBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgICByZXR1cm4gYXJncy5kb2NzUGF0aDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBkb2NzVXJsID0gZXJyb3JDb25maWcuZ2V0RG9jc1VybD8uKHsgLi4uYXJncywgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KTsKICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBbCiAgICAgICAgICAgIHNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQuIiwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgIC4uLmFyZ3MubWV0YU1lc3NhZ2VzID8gWy4uLmFyZ3MubWV0YU1lc3NhZ2VzLCAiIl0gOiBbXSwKICAgICAgICAgICAgLi4uZG9jc1VybCA/IFtgRG9jczogJHtkb2NzVXJsfWBdIDogW10sCiAgICAgICAgICAgIC4uLmRldGFpbHMgPyBbYERldGFpbHM6ICR7ZGV0YWlsc31gXSA6IFtdLAogICAgICAgICAgICAuLi5lcnJvckNvbmZpZy52ZXJzaW9uID8gW2BWZXJzaW9uOiAke2Vycm9yQ29uZmlnLnZlcnNpb259YF0gOiBbXQogICAgICAgICAgXS5qb2luKCJcbiIpOwogICAgICAgICAgc3VwZXIobWVzc2FnZSwgYXJncy5jYXVzZSA/IHsgY2F1c2U6IGFyZ3MuY2F1c2UgfSA6IHZvaWQgMCk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkb2NzUGF0aCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm1ldGFNZXNzYWdlcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNob3J0TWVzc2FnZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInZlcnNpb24iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkJhc2VFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5uYW1lID0gYXJncy5uYW1lID8/IHRoaXMubmFtZTsKICAgICAgICAgIHRoaXMuc2hvcnRNZXNzYWdlID0gc2hvcnRNZXNzYWdlOwogICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjI7CiAgICAgICAgfQogICAgICAgIHdhbGsoZm4pIHsKICAgICAgICAgIHJldHVybiB3YWxrKHRoaXMsIGZuKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYWJpLmpzCiAgdmFyIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvciwgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciwgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yLCBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvciwgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yLCBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IsIEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvciwgQWJpRXJyb3JOb3RGb3VuZEVycm9yLCBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsIEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlFdmVudE5vdEZvdW5kRXJyb3IsIEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25PdXRwdXRzTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlJdGVtQW1iaWd1aXR5RXJyb3IsIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsIERlY29kZUxvZ0RhdGFNaXNtYXRjaCwgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gsIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciwgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yLCBJbnZhbGlkQXJyYXlFcnJvciwgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IsIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZTsKICB2YXIgaW5pdF9hYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hYmkuanMiKCkgewogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICAiQSBjb25zdHJ1Y3RvciB3YXMgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgY29uc3RydWN0b3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJDb25zdHJ1Y3RvciBhcmd1bWVudHMgd2VyZSBwcm92aWRlZCAoYGFyZ3NgKSwgYnV0IGEgY29uc3RydWN0b3IgcGFyYW1ldGVycyAoYGlucHV0c2ApIHdlcmUgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSwgYW5kIHRoYXQgdGhlIGBpbnB1dHNgIGF0dHJpYnV0ZSBvbiB0aGUgY29uc3RydWN0b3IgZXhpc3RzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyBpbnZhbGlkLmAsCiAgICAgICAgICAgICJTaXplIG11c3QgYmUgaW4gaW5jcmVtZW50cyBvZiAzMiBieXRlcyAoc2l6ZSAlIDMyID09PSAwKS4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYERhdGE6ICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWBdLAogICAgICAgICAgICBuYW1lOiAiQWJpRGVjb2RpbmdEYXRhU2l6ZUludmFsaWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZGF0YSwgcGFyYW1zLCBzaXplOiBzaXplMyB9KSB7CiAgICAgICAgICBzdXBlcihbYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIGdpdmVuIHBhcmFtZXRlcnMuYF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgUGFyYW1zOiAoJHtmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSlgLAogICAgICAgICAgICAgIGBEYXRhOiAgICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWAKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJwYXJhbXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICAgICAgICAgIHRoaXMuc2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKCdDYW5ub3QgZGVjb2RlIHplcm8gZGF0YSAoIjB4Iikgd2l0aCBBQkkgcGFyYW1ldGVycy4nLCB7CiAgICAgICAgICAgIG5hbWU6ICJBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkTGVuZ3RoLCBnaXZlbkxlbmd0aCwgdHlwZSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBQkkgZW5jb2RpbmcgYXJyYXkgbGVuZ3RoIG1pc21hdGNoIGZvciB0eXBlICR7dHlwZX0uYCwKICAgICAgICAgICAgYEV4cGVjdGVkIGxlbmd0aDogJHtleHBlY3RlZExlbmd0aH1gLAogICAgICAgICAgICBgR2l2ZW4gbGVuZ3RoOiAke2dpdmVuTGVuZ3RofWAKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgb2YgYnl0ZXMgIiR7dmFsdWV9IiAoYnl0ZXMke3NpemUodmFsdWUpfSkgZG9lcyBub3QgbWF0Y2ggZXhwZWN0ZWQgc2l6ZSAoYnl0ZXMke2V4cGVjdGVkU2l6ZX0pLmAsIHsgbmFtZTogIkFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZXhwZWN0ZWRMZW5ndGgsIGdpdmVuTGVuZ3RoIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkFCSSBlbmNvZGluZyBwYXJhbXMvdmFsdWVzIGxlbmd0aCBtaXNtYXRjaC4iLAogICAgICAgICAgICBgRXhwZWN0ZWQgbGVuZ3RoIChwYXJhbXMpOiAke2V4cGVjdGVkTGVuZ3RofWAsCiAgICAgICAgICAgIGBHaXZlbiBsZW5ndGggKHZhbHVlcyk6ICR7Z2l2ZW5MZW5ndGh9YAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBcmd1bWVudHMgKFxgYXJnc1xgKSB3ZXJlIHByb3ZpZGVkIHRvICIke2Vycm9yTmFtZX0iLCBidXQgIiR7ZXJyb3JOYW1lfSIgb24gdGhlIEFCSSBkb2VzIG5vdCBjb250YWluIGFueSBwYXJhbWV0ZXJzIChcYGlucHV0c1xgKS5gLAogICAgICAgICAgICAiQ2Fubm90IGVuY29kZSBlcnJvciByZXN1bHQgd2l0aG91dCBrbm93aW5nIHdoYXQgdGhlIHBhcmFtZXRlciB0eXBlcyBhcmUuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgaW5wdXRzIGV4aXN0IG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGVycm9yTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXJyb3IgJHtlcnJvck5hbWUgPyBgIiR7ZXJyb3JOYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHNpZ25hdHVyZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYEVuY29kZWQgZXJyb3Igc2lnbmF0dXJlICIke3NpZ25hdHVyZX0iIG5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIsCiAgICAgICAgICAgIGBZb3UgY2FuIGxvb2sgdXAgdGhlIGRlY29kZWQgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaWduYXR1cmUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGV4dHJhY3QgZXZlbnQgc2lnbmF0dXJlIGZyb20gZW1wdHkgdG9waWNzLiIsIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaWduYXR1cmUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFbmNvZGVkIGV2ZW50IHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBub3QgZm91bmQgb24gQUJJLmAsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGV2ZW50IGV4aXN0cyBvbiBpdC4iLAogICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBzaWduYXR1cmUgaGVyZTogaHR0cHM6Ly9vcGVuY2hhaW4ueHl6L3NpZ25hdHVyZXM/cXVlcnk9JHtzaWduYXR1cmV9LmAKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXZlbnQgJHtldmVudE5hbWUgPyBgIiR7ZXZlbnROYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXZlbnQgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnROb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRnVuY3Rpb24gJHtmdW5jdGlvbk5hbWUgPyBgIiR7ZnVuY3Rpb25OYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZnVuY3Rpb24gZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBGdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiBkb2VzIG5vdCBjb250YWluIGFueSBcYG91dHB1dHNcYCBvbiBBQkkuYCwKICAgICAgICAgICAgIkNhbm5vdCBkZWNvZGUgZnVuY3Rpb24gcmVzdWx0IHdpdGhvdXQga25vd2luZyB3aGF0IHRoZSBwYXJhbWV0ZXIgdHlwZXMgYXJlLiIsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGZ1bmN0aW9uIGV4aXN0cyBvbiBpdC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRW5jb2RlZCBmdW5jdGlvbiBzaWduYXR1cmUgIiR7c2lnbmF0dXJlfSIgbm90IGZvdW5kIG9uIEFCSS5gLAogICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBmdW5jdGlvbiBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgYFlvdSBjYW4gbG9vayB1cCB0aGUgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpSXRlbUFtYmlndWl0eUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih4LCB5KSB7CiAgICAgICAgICBzdXBlcigiRm91bmQgYW1iaWd1b3VzIHR5cGVzIGluIG92ZXJsb2FkZWQgQUJJIGl0ZW1zLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYFxgJHt4LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHguYWJpSXRlbSl9XGAsIGFuZGAsCiAgICAgICAgICAgICAgYFxgJHt5LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHkuYWJpSXRlbSl9XGBgLAogICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICJUaGVzZSB0eXBlcyBlbmNvZGUgZGlmZmVyZW50bHkgYW5kIGNhbm5vdCBiZSBkaXN0aW5ndWlzaGVkIGF0IHJ1bnRpbWUuIiwKICAgICAgICAgICAgICAiUmVtb3ZlIG9uZSBvZiB0aGUgYW1iaWd1b3VzIGl0ZW1zIGluIHRoZSBBQkkuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQWJpSXRlbUFtYmlndWl0eUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgZ2l2ZW5TaXplIH0pIHsKICAgICAgICAgIHN1cGVyKGBFeHBlY3RlZCBieXRlcyR7ZXhwZWN0ZWRTaXplfSwgZ290IGJ5dGVzJHtnaXZlblNpemV9LmAsIHsKICAgICAgICAgICAgbmFtZTogIkJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIERlY29kZUxvZ0RhdGFNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBkYXRhLCBwYXJhbXMsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIG5vbi1pbmRleGVkIGV2ZW50IHBhcmFtZXRlcnMuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBQYXJhbXM6ICgke2Zvcm1hdEFiaVBhcmFtcyhwYXJhbXMsIHsgaW5jbHVkZU5hbWU6IHRydWUgfSl9KWAsCiAgICAgICAgICAgICAgYERhdGE6ICAgJHtkYXRhfSAoJHtzaXplM30gYnl0ZXMpYAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiRGVjb2RlTG9nRGF0YU1pc21hdGNoIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkYXRhIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyYW1zIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2l6ZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaUl0ZW0gPSBhYmlJdGVtOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwogICAgICAgICAgdGhpcy5zaXplID0gc2l6ZTM7CiAgICAgICAgfQogICAgICB9OwogICAgICBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFeHBlY3RlZCBhIHRvcGljIGZvciBpbmRleGVkIGV2ZW50IHBhcmFtZXRlciR7cGFyYW0ubmFtZSA/IGAgIiR7cGFyYW0ubmFtZX0iYCA6ICIifSBvbiBldmVudCAiJHtmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSIuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCIgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5hYmlJdGVtID0gYWJpSXRlbTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGVuY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRW5jb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRGVjb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBcnJheUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkgewogICAgICAgICAgc3VwZXIoW2BWYWx1ZSAiJHt2YWx1ZX0iIGlzIG5vdCBhIHZhbGlkIGFycmF5LmBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBcnJheUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlZmluaXRpb24gdHlwZS5gLAogICAgICAgICAgICAnVmFsaWQgdHlwZXM6ICJmdW5jdGlvbiIsICJldmVudCIsICJlcnJvciInCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsgbmFtZTogIkludmFsaWREZWZpbml0aW9uVHlwZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZSA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHBhY2tlZCBlbmNvZGluZy5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZGF0YS5qcwogIHZhciBTbGljZU9mZnNldE91dE9mQm91bmRzRXJyb3IsIFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3I7CiAgdmFyIGluaXRfZGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2RhdGEuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCwgcG9zaXRpb24sIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTbGljZSAke3Bvc2l0aW9uID09PSAic3RhcnQiID8gInN0YXJ0aW5nIiA6ICJlbmRpbmcifSBhdCBvZmZzZXQgIiR7b2Zmc2V0fSIgaXMgb3V0LW9mLWJvdW5kcyAoc2l6ZTogJHtzaXplM30pLmAsIHsgbmFtZTogIlNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gc2l6ZSAoJHtzaXplM30pIGV4Y2VlZHMgcGFkZGluZyBzaXplICgke3RhcmdldFNpemV9KS5gLCB7IG5hbWU6ICJTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gaXMgZXhwZWN0ZWQgdG8gYmUgJHt0YXJnZXRTaXplfSAke3R5cGV9IGxvbmcsIGJ1dCBpcyAke3NpemUzfSAke3R5cGV9IGxvbmcuYCwgeyBuYW1lOiAiSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvcGFkLmpzCiAgZnVuY3Rpb24gcGFkKGhleE9yQnl0ZXMsIHsgZGlyLCBzaXplOiBzaXplMyA9IDMyIH0gPSB7fSkgewogICAgaWYgKHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHBhZEhleChoZXhPckJ5dGVzLCB7IGRpciwgc2l6ZTogc2l6ZTMgfSk7CiAgICByZXR1cm4gcGFkQnl0ZXMoaGV4T3JCeXRlcywgeyBkaXIsIHNpemU6IHNpemUzIH0pOwogIH0KICBmdW5jdGlvbiBwYWRIZXgoaGV4XywgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBoZXhfOwogICAgY29uc3QgaGV4ID0gaGV4Xy5yZXBsYWNlKCIweCIsICIiKTsKICAgIGlmIChoZXgubGVuZ3RoID4gc2l6ZTMgKiAyKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBNYXRoLmNlaWwoaGV4Lmxlbmd0aCAvIDIpLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJoZXgiCiAgICAgIH0pOwogICAgcmV0dXJuIGAweCR7aGV4W2RpciA9PT0gInJpZ2h0IiA/ICJwYWRFbmQiIDogInBhZFN0YXJ0Il0oc2l6ZTMgKiAyLCAiMCIpfWA7CiAgfQogIGZ1bmN0aW9uIHBhZEJ5dGVzKGJ5dGVzMiwgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBieXRlczI7CiAgICBpZiAoYnl0ZXMyLmxlbmd0aCA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBieXRlczIubGVuZ3RoLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgfSk7CiAgICBjb25zdCBwYWRkZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KHNpemUzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTM7IGkrKykgewogICAgICBjb25zdCBwYWRFbmQgPSBkaXIgPT09ICJyaWdodCI7CiAgICAgIHBhZGRlZEJ5dGVzW3BhZEVuZCA/IGkgOiBzaXplMyAtIGkgLSAxXSA9IGJ5dGVzMltwYWRFbmQgPyBpIDogYnl0ZXMyLmxlbmd0aCAtIGkgLSAxXTsKICAgIH0KICAgIHJldHVybiBwYWRkZWRCeXRlczsKICB9CiAgdmFyIGluaXRfcGFkID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3BhZC5qcyIoKSB7CiAgICAgIGluaXRfZGF0YSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2VuY29kaW5nLmpzCiAgdmFyIEludGVnZXJPdXRPZlJhbmdlRXJyb3IsIEludmFsaWRCeXRlc0Jvb2xlYW5FcnJvciwgSW52YWxpZEhleEJvb2xlYW5FcnJvciwgSW52YWxpZEhleFZhbHVlRXJyb3IsIFNpemVPdmVyZmxvd0Vycm9yOwogIHZhciBpbml0X2VuY29kaW5nID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZW5jb2RpbmcuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW50ZWdlck91dE9mUmFuZ2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBtYXgsIG1pbiwgc2lnbmVkLCBzaXplOiBzaXplMywgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYE51bWJlciAiJHt2YWx1ZX0iIGlzIG5vdCBpbiBzYWZlICR7c2l6ZTMgPyBgJHtzaXplMyAqIDh9LWJpdCAke3NpZ25lZCA/ICJzaWduZWQiIDogInVuc2lnbmVkIn0gYCA6ICIifWludGVnZXIgcmFuZ2UgJHttYXggPyBgKCR7bWlufSB0byAke21heH0pYCA6IGAoYWJvdmUgJHttaW59KWB9YCwgeyBuYW1lOiAiSW50ZWdlck91dE9mUmFuZ2VFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGJ5dGVzMikgewogICAgICAgICAgc3VwZXIoYEJ5dGVzIHZhbHVlICIke2J5dGVzMn0iIGlzIG5vdCBhIHZhbGlkIGJvb2xlYW4uIFRoZSBieXRlcyBhcnJheSBtdXN0IGNvbnRhaW4gYSBzaW5nbGUgYnl0ZSBvZiBlaXRoZXIgYSAwIG9yIDEgdmFsdWUuYCwgewogICAgICAgICAgICBuYW1lOiAiSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihoZXgpIHsKICAgICAgICAgIHN1cGVyKGBIZXggdmFsdWUgIiR7aGV4fSIgaXMgbm90IGEgdmFsaWQgYm9vbGVhbi4gVGhlIGhleCB2YWx1ZSBtdXN0IGJlICIweDAiIChmYWxzZSkgb3IgIjB4MSIgKHRydWUpLmAsIHsgbmFtZTogIkludmFsaWRIZXhCb29sZWFuRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEhleFZhbHVlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7CiAgICAgICAgICBzdXBlcihgSGV4IHZhbHVlICIke3ZhbHVlfSIgaXMgYW4gb2RkIGxlbmd0aCAoJHt2YWx1ZS5sZW5ndGh9KS4gSXQgbXVzdCBiZSBhbiBldmVuIGxlbmd0aC5gLCB7IG5hbWU6ICJJbnZhbGlkSGV4VmFsdWVFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplT3ZlcmZsb3dFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBnaXZlblNpemUsIG1heFNpemUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgY2Fubm90IGV4Y2VlZCAke21heFNpemV9IGJ5dGVzLiBHaXZlbiBzaXplOiAke2dpdmVuU2l6ZX0gYnl0ZXMuYCwgeyBuYW1lOiAiU2l6ZU92ZXJmbG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvdHJpbS5qcwogIGZ1bmN0aW9uIHRyaW0oaGV4T3JCeXRlcywgeyBkaXIgPSAibGVmdCIgfSA9IHt9KSB7CiAgICBsZXQgZGF0YSA9IHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIiA/IGhleE9yQnl0ZXMucmVwbGFjZSgiMHgiLCAiIikgOiBoZXhPckJ5dGVzOwogICAgbGV0IHNsaWNlTGVuZ3RoID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgaWYgKGRhdGFbZGlyID09PSAibGVmdCIgPyBpIDogZGF0YS5sZW5ndGggLSBpIC0gMV0udG9TdHJpbmcoKSA9PT0gIjAiKQogICAgICAgIHNsaWNlTGVuZ3RoKys7CiAgICAgIGVsc2UKICAgICAgICBicmVhazsKICAgIH0KICAgIGRhdGEgPSBkaXIgPT09ICJsZWZ0IiA/IGRhdGEuc2xpY2Uoc2xpY2VMZW5ndGgpIDogZGF0YS5zbGljZSgwLCBkYXRhLmxlbmd0aCAtIHNsaWNlTGVuZ3RoKTsKICAgIGlmICh0eXBlb2YgaGV4T3JCeXRlcyA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKGRhdGEubGVuZ3RoID09PSAxICYmIGRpciA9PT0gInJpZ2h0IikKICAgICAgICBkYXRhID0gYCR7ZGF0YX0wYDsKICAgICAgcmV0dXJuIGAweCR7ZGF0YS5sZW5ndGggJSAyID09PSAxID8gYDAke2RhdGF9YCA6IGRhdGF9YDsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICB2YXIgaW5pdF90cmltID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3RyaW0uanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUhleC5qcwogIGZ1bmN0aW9uIGFzc2VydFNpemUoaGV4T3JCeXRlcywgeyBzaXplOiBzaXplMyB9KSB7CiAgICBpZiAoc2l6ZShoZXhPckJ5dGVzKSA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZU92ZXJmbG93RXJyb3IoewogICAgICAgIGdpdmVuU2l6ZTogc2l6ZShoZXhPckJ5dGVzKSwKICAgICAgICBtYXhTaXplOiBzaXplMwogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gZnJvbUhleChoZXgsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBoZXhUb051bWJlcihoZXgsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gaGV4VG9TdHJpbmcoaGV4LCBvcHRzKTsKICAgIGlmICh0byA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gaGV4VG9Cb29sKGhleCwgb3B0cyk7CiAgICByZXR1cm4gaGV4VG9CeXRlcyhoZXgsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBoZXhUb0JpZ0ludChoZXgsIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQgfSA9IG9wdHM7CiAgICBpZiAob3B0cy5zaXplKQogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICBjb25zdCB2YWx1ZSA9IEJpZ0ludChoZXgpOwogICAgaWYgKCFzaWduZWQpCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIGNvbnN0IHNpemUzID0gKGhleC5sZW5ndGggLSAyKSAvIDI7CiAgICBjb25zdCBtYXggPSAoMW4gPDwgQmlnSW50KHNpemUzKSAqIDhuIC0gMW4pIC0gMW47CiAgICBpZiAodmFsdWUgPD0gbWF4KQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgLSBCaWdJbnQoYDB4JHsiZiIucGFkU3RhcnQoc2l6ZTMgKiAyLCAiZiIpfWApIC0gMW47CiAgfQogIGZ1bmN0aW9uIGhleFRvQm9vbChoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHRyaW0oaGV4KTsKICAgIH0KICAgIGlmICh0cmltKGhleCkgPT09ICIweDAwIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKHRyaW0oaGV4KSA9PT0gIjB4MDEiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHRocm93IG5ldyBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yKGhleCk7CiAgfQogIGZ1bmN0aW9uIGhleFRvTnVtYmVyKGhleCwgb3B0cyA9IHt9KSB7CiAgICByZXR1cm4gTnVtYmVyKGhleFRvQmlnSW50KGhleCwgb3B0cykpOwogIH0KICBmdW5jdGlvbiBoZXhUb1N0cmluZyhoZXgsIG9wdHMgPSB7fSkgewogICAgbGV0IGJ5dGVzMiA9IGhleFRvQnl0ZXMoaGV4KTsKICAgIGlmIChvcHRzLnNpemUpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21IZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21IZXguanMiKCkgewogICAgICBpbml0X2VuY29kaW5nKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcwogIGZ1bmN0aW9uIHRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiIHx8IHR5cGVvZiB2YWx1ZSA9PT0gImJpZ2ludCIpCiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgb3B0cyk7CiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gc3RyaW5nVG9IZXgodmFsdWUsIG9wdHMpOwogICAgfQogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvSGV4KHZhbHVlLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgZnVuY3Rpb24gYm9vbFRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IGhleCA9IGAweCR7TnVtYmVyKHZhbHVlKX1gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgfQogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb0hleCh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBsZXQgc3RyaW5nID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIHN0cmluZyArPSBoZXhlc1t2YWx1ZVtpXV07CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgke3N0cmluZ31gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleCh2YWx1ZV8sIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQsIHNpemU6IHNpemUzIH0gPSBvcHRzOwogICAgY29uc3QgdmFsdWUgPSBCaWdJbnQodmFsdWVfKTsKICAgIGxldCBtYXhWYWx1ZTsKICAgIGlmIChzaXplMykgewogICAgICBpZiAoc2lnbmVkKQogICAgICAgIG1heFZhbHVlID0gKDFuIDw8IEJpZ0ludChzaXplMykgKiA4biAtIDFuKSAtIDFuOwogICAgICBlbHNlCiAgICAgICAgbWF4VmFsdWUgPSAybiAqKiAoQmlnSW50KHNpemUzKSAqIDhuKSAtIDFuOwogICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWVfID09PSAibnVtYmVyIikgewogICAgICBtYXhWYWx1ZSA9IEJpZ0ludChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7CiAgICB9CiAgICBjb25zdCBtaW5WYWx1ZSA9IHR5cGVvZiBtYXhWYWx1ZSA9PT0gImJpZ2ludCIgJiYgc2lnbmVkID8gLW1heFZhbHVlIC0gMW4gOiAwOwogICAgaWYgKG1heFZhbHVlICYmIHZhbHVlID4gbWF4VmFsdWUgfHwgdmFsdWUgPCBtaW5WYWx1ZSkgewogICAgICBjb25zdCBzdWZmaXggPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/ICJuIiA6ICIiOwogICAgICB0aHJvdyBuZXcgSW50ZWdlck91dE9mUmFuZ2VFcnJvcih7CiAgICAgICAgbWF4OiBtYXhWYWx1ZSA/IGAke21heFZhbHVlfSR7c3VmZml4fWAgOiB2b2lkIDAsCiAgICAgICAgbWluOiBgJHttaW5WYWx1ZX0ke3N1ZmZpeH1gLAogICAgICAgIHNpZ25lZCwKICAgICAgICBzaXplOiBzaXplMywKICAgICAgICB2YWx1ZTogYCR7dmFsdWVffSR7c3VmZml4fWAKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgkeyhzaWduZWQgJiYgdmFsdWUgPCAwID8gKDFuIDw8IEJpZ0ludChzaXplMyAqIDgpKSArIEJpZ0ludCh2YWx1ZSkgOiB2YWx1ZSkudG9TdHJpbmcoMTYpfWA7CiAgICBpZiAoc2l6ZTMpCiAgICAgIHJldHVybiBwYWQoaGV4LCB7IHNpemU6IHNpemUzIH0pOwogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9IZXgodmFsdWVfLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IHZhbHVlID0gZW5jb2Rlci5lbmNvZGUodmFsdWVfKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgdmFyIGhleGVzLCBlbmNvZGVyOwogIHZhciBpbml0X3RvSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcyIoKSB7CiAgICAgIGluaXRfZW5jb2RpbmcoKTsKICAgICAgaW5pdF9wYWQoKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGhleGVzID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoX3YsIGkpID0+IGkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIikpOwogICAgICBlbmNvZGVyID0gLyogQF9fUFVSRV9fICovIG5ldyBUZXh0RW5jb2RlcigpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvdG9CeXRlcy5qcwogIGZ1bmN0aW9uIHRvQnl0ZXModmFsdWUsIG9wdHMgPSB7fSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgfHwgdHlwZW9mIHZhbHVlID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIG51bWJlclRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKGlzSGV4KHZhbHVlKSkKICAgICAgcmV0dXJuIGhleFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModmFsdWUsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBib29sVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBuZXcgVWludDhBcnJheSgxKTsKICAgIGJ5dGVzMlswXSA9IE51bWJlcih2YWx1ZSk7CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSA9PT0gIm51bWJlciIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICByZXR1cm4gcGFkKGJ5dGVzMiwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICBmdW5jdGlvbiBjaGFyQ29kZVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLnplcm8gJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5uaW5lKQogICAgICByZXR1cm4gY2hhciAtIGNoYXJDb2RlTWFwLnplcm87CiAgICBpZiAoY2hhciA+PSBjaGFyQ29kZU1hcC5BICYmIGNoYXIgPD0gY2hhckNvZGVNYXAuRikKICAgICAgcmV0dXJuIGNoYXIgLSAoY2hhckNvZGVNYXAuQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLmEgJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5mKQogICAgICByZXR1cm4gY2hhciAtIChjaGFyQ29kZU1hcC5hIC0gMTApOwogICAgcmV0dXJuIHZvaWQgMDsKICB9CiAgZnVuY3Rpb24gaGV4VG9CeXRlcyhoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICBsZXQgaGV4U3RyaW5nID0gaGV4LnNsaWNlKDIpOwogICAgaWYgKGhleFN0cmluZy5sZW5ndGggJSAyKQogICAgICBoZXhTdHJpbmcgPSBgMCR7aGV4U3RyaW5nfWA7CiAgICBjb25zdCBsZW5ndGggPSBoZXhTdHJpbmcubGVuZ3RoIC8gMjsKICAgIGNvbnN0IGJ5dGVzMiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICBmb3IgKGxldCBpbmRleDIgPSAwLCBqID0gMDsgaW5kZXgyIDwgbGVuZ3RoOyBpbmRleDIrKykgewogICAgICBjb25zdCBuaWJibGVMZWZ0ID0gY2hhckNvZGVUb0Jhc2UxNihoZXhTdHJpbmcuY2hhckNvZGVBdChqKyspKTsKICAgICAgY29uc3QgbmliYmxlUmlnaHQgPSBjaGFyQ29kZVRvQmFzZTE2KGhleFN0cmluZy5jaGFyQ29kZUF0KGorKykpOwogICAgICBpZiAobmliYmxlTGVmdCA9PT0gdm9pZCAwIHx8IG5pYmJsZVJpZ2h0ID09PSB2b2lkIDApIHsKICAgICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBieXRlIHNlcXVlbmNlICgiJHtoZXhTdHJpbmdbaiAtIDJdfSR7aGV4U3RyaW5nW2ogLSAxXX0iIGluICIke2hleFN0cmluZ30iKS5gKTsKICAgICAgfQogICAgICBieXRlczJbaW5kZXgyXSA9IG5pYmJsZUxlZnQgKiAxNiArIG5pYmJsZVJpZ2h0OwogICAgfQogICAgcmV0dXJuIGJ5dGVzMjsKICB9CiAgZnVuY3Rpb24gbnVtYmVyVG9CeXRlcyh2YWx1ZSwgb3B0cykgewogICAgY29uc3QgaGV4ID0gbnVtYmVyVG9IZXgodmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoaGV4KTsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBlbmNvZGVyMi5lbmNvZGUodmFsdWUpOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChieXRlczIsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICB2YXIgZW5jb2RlcjIsIGNoYXJDb2RlTWFwOwogIHZhciBpbml0X3RvQnl0ZXMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvQnl0ZXMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X2Zyb21IZXgoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgICBlbmNvZGVyMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVGV4dEVuY29kZXIoKTsKICAgICAgY2hhckNvZGVNYXAgPSB7CiAgICAgICAgemVybzogNDgsCiAgICAgICAgbmluZTogNTcsCiAgICAgICAgQTogNjUsCiAgICAgICAgRjogNzAsCiAgICAgICAgYTogOTcsCiAgICAgICAgZjogMTAyCiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzCiAgZnVuY3Rpb24gbnVtYmVyKG4pIHsKICAgIGlmICghTnVtYmVyLmlzU2FmZUludGVnZXIobikgfHwgbiA8IDApCiAgICAgIHRocm93IG5ldyBFcnJvcihgcG9zaXRpdmUgaW50ZWdlciBleHBlY3RlZCwgbm90ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gaXNCeXRlcyhhKSB7CiAgICByZXR1cm4gYSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgYSAhPSBudWxsICYmIHR5cGVvZiBhID09PSAib2JqZWN0IiAmJiBhLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CiAgZnVuY3Rpb24gYnl0ZXMoYiwgLi4ubGVuZ3RocykgewogICAgaWYgKCFpc0J5dGVzKGIpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIlVpbnQ4QXJyYXkgZXhwZWN0ZWQiKTsKICAgIGlmIChsZW5ndGhzLmxlbmd0aCA+IDAgJiYgIWxlbmd0aHMuaW5jbHVkZXMoYi5sZW5ndGgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYFVpbnQ4QXJyYXkgZXhwZWN0ZWQgb2YgbGVuZ3RoICR7bGVuZ3Roc30sIG5vdCBvZiBsZW5ndGg9JHtiLmxlbmd0aH1gKTsKICB9CiAgZnVuY3Rpb24gaGFzaChoKSB7CiAgICBpZiAodHlwZW9mIGggIT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mIGguY3JlYXRlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggc2hvdWxkIGJlIHdyYXBwZWQgYnkgdXRpbHMud3JhcENvbnN0cnVjdG9yIik7CiAgICBudW1iZXIoaC5vdXRwdXRMZW4pOwogICAgbnVtYmVyKGguYmxvY2tMZW4pOwogIH0KICBmdW5jdGlvbiBleGlzdHMoaW5zdGFuY2UsIGNoZWNrRmluaXNoZWQgPSB0cnVlKSB7CiAgICBpZiAoaW5zdGFuY2UuZGVzdHJveWVkKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggaW5zdGFuY2UgaGFzIGJlZW4gZGVzdHJveWVkIik7CiAgICBpZiAoY2hlY2tGaW5pc2hlZCAmJiBpbnN0YW5jZS5maW5pc2hlZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJIYXNoI2RpZ2VzdCgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIik7CiAgfQogIGZ1bmN0aW9uIG91dHB1dChvdXQsIGluc3RhbmNlKSB7CiAgICBieXRlcyhvdXQpOwogICAgY29uc3QgbWluID0gaW5zdGFuY2Uub3V0cHV0TGVuOwogICAgaWYgKG91dC5sZW5ndGggPCBtaW4pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBkaWdlc3RJbnRvKCkgZXhwZWN0cyBvdXRwdXQgYnVmZmVyIG9mIGxlbmd0aCBhdCBsZWFzdCAke21pbn1gKTsKICAgIH0KICB9CiAgdmFyIGluaXRfYXNzZXJ0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL191NjQuanMKICBmdW5jdGlvbiBmcm9tQmlnKG4sIGxlID0gZmFsc2UpIHsKICAgIGlmIChsZSkKICAgICAgcmV0dXJuIHsgaDogTnVtYmVyKG4gJiBVMzJfTUFTSzY0KSwgbDogTnVtYmVyKG4gPj4gXzMybiAmIFUzMl9NQVNLNjQpIH07CiAgICByZXR1cm4geyBoOiBOdW1iZXIobiA+PiBfMzJuICYgVTMyX01BU0s2NCkgfCAwLCBsOiBOdW1iZXIobiAmIFUzMl9NQVNLNjQpIHwgMCB9OwogIH0KICBmdW5jdGlvbiBzcGxpdChsc3QsIGxlID0gZmFsc2UpIHsKICAgIGxldCBBaCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGxldCBBbCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbHN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgaCwgbCB9ID0gZnJvbUJpZyhsc3RbaV0sIGxlKTsKICAgICAgW0FoW2ldLCBBbFtpXV0gPSBbaCwgbF07CiAgICB9CiAgICByZXR1cm4gW0FoLCBBbF07CiAgfQogIHZhciBVMzJfTUFTSzY0LCBfMzJuLCByb3RsU0gsIHJvdGxTTCwgcm90bEJILCByb3RsQkw7CiAgdmFyIGluaXRfdTY0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fdTY0LmpzIigpIHsKICAgICAgVTMyX01BU0s2NCA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMiAqKiAzMiAtIDEpOwogICAgICBfMzJuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgzMik7CiAgICAgIHJvdGxTSCA9IChoLCBsLCBzKSA9PiBoIDw8IHMgfCBsID4+PiAzMiAtIHM7CiAgICAgIHJvdGxTTCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgfCBoID4+PiAzMiAtIHM7CiAgICAgIHJvdGxCSCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgLSAzMiB8IGggPj4+IDY0IC0gczsKICAgICAgcm90bEJMID0gKGgsIGwsIHMpID0+IGggPDwgcyAtIDMyIHwgbCA+Pj4gNjQgLSBzOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vY3J5cHRvLmpzCiAgdmFyIGNyeXB0bzsKICB2YXIgaW5pdF9jcnlwdG8gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2NyeXB0by5qcyIoKSB7CiAgICAgIGNyeXB0byA9IHR5cGVvZiBnbG9iYWxUaGlzID09PSAib2JqZWN0IiAmJiAiY3J5cHRvIiBpbiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcy5jcnlwdG8gOiB2b2lkIDA7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS91dGlscy5qcwogIGZ1bmN0aW9uIGJ5dGVTd2FwMzIoYXJyKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBieXRlU3dhcChhcnJbaV0pOwogICAgfQogIH0KICBmdW5jdGlvbiB1dGY4VG9CeXRlcyhzdHIpIHsKICAgIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKGB1dGY4VG9CeXRlcyBleHBlY3RlZCBzdHJpbmcsIGdvdCAke3R5cGVvZiBzdHJ9YCk7CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHN0cikpOwogIH0KICBmdW5jdGlvbiB0b0J5dGVzMihkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKQogICAgICBkYXRhID0gdXRmOFRvQnl0ZXMoZGF0YSk7CiAgICBieXRlcyhkYXRhKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlcyguLi5hcnJheXMpIHsKICAgIGxldCBzdW0gPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgYnl0ZXMoYSk7CiAgICAgIHN1bSArPSBhLmxlbmd0aDsKICAgIH0KICAgIGNvbnN0IHJlcyA9IG5ldyBVaW50OEFycmF5KHN1bSk7CiAgICBmb3IgKGxldCBpID0gMCwgcGFkMiA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgcmVzLnNldChhLCBwYWQyKTsKICAgICAgcGFkMiArPSBhLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHdyYXBDb25zdHJ1Y3RvcihoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnKSA9PiBoYXNoQ29ucygpLnVwZGF0ZSh0b0J5dGVzMihtc2cpKS5kaWdlc3QoKTsKICAgIGNvbnN0IHRtcCA9IGhhc2hDb25zKCk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAoKSA9PiBoYXNoQ29ucygpOwogICAgcmV0dXJuIGhhc2hDOwogIH0KICBmdW5jdGlvbiB3cmFwWE9GQ29uc3RydWN0b3JXaXRoT3B0cyhoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnLCBvcHRzKSA9PiBoYXNoQ29ucyhvcHRzKS51cGRhdGUodG9CeXRlczIobXNnKSkuZGlnZXN0KCk7CiAgICBjb25zdCB0bXAgPSBoYXNoQ29ucyh7fSk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAob3B0cykgPT4gaGFzaENvbnMob3B0cyk7CiAgICByZXR1cm4gaGFzaEM7CiAgfQogIGZ1bmN0aW9uIHJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoID0gMzIpIHsKICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoYnl0ZXNMZW5ndGgpKTsKICAgIH0KICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5yYW5kb21CeXRlcyA9PT0gImZ1bmN0aW9uIikgewogICAgICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoKTsKICAgIH0KICAgIHRocm93IG5ldyBFcnJvcigiY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtdXN0IGJlIGRlZmluZWQiKTsKICB9CiAgdmFyIHUzMiwgY3JlYXRlVmlldywgcm90ciwgcm90bCwgaXNMRSwgYnl0ZVN3YXAsIEhhc2gsIHRvU3RyOwogIHZhciBpbml0X3V0aWxzMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vdXRpbHMuanMiKCkgewogICAgICBpbml0X2NyeXB0bygpOwogICAgICBpbml0X2Fzc2VydCgpOwogICAgICB1MzIgPSAoYXJyKSA9PiBuZXcgVWludDMyQXJyYXkoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIE1hdGguZmxvb3IoYXJyLmJ5dGVMZW5ndGggLyA0KSk7CiAgICAgIGNyZWF0ZVZpZXcgPSAoYXJyKSA9PiBuZXcgRGF0YVZpZXcoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTsKICAgICAgcm90ciA9ICh3b3JkLCBzaGlmdCkgPT4gd29yZCA8PCAzMiAtIHNoaWZ0IHwgd29yZCA+Pj4gc2hpZnQ7CiAgICAgIHJvdGwgPSAod29yZCwgc2hpZnQpID0+IHdvcmQgPDwgc2hpZnQgfCB3b3JkID4+PiAzMiAtIHNoaWZ0ID4+PiAwOwogICAgICBpc0xFID0gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQzMkFycmF5KFsyODc0NTQwMjBdKS5idWZmZXIpWzBdID09PSA2ODsKICAgICAgYnl0ZVN3YXAgPSAod29yZCkgPT4gd29yZCA8PCAyNCAmIDQyNzgxOTAwODAgfCB3b3JkIDw8IDggJiAxNjcxMTY4MCB8IHdvcmQgPj4+IDggJiA2NTI4MCB8IHdvcmQgPj4+IDI0ICYgMjU1OwogICAgICBIYXNoID0gY2xhc3MgewogICAgICAgIC8vIFNhZmUgdmVyc2lvbiB0aGF0IGNsb25lcyBpbnRlcm5hbCBzdGF0ZQogICAgICAgIGNsb25lKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lSW50bygpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdG9TdHIgPSB7fS50b1N0cmluZzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTMuanMKICBmdW5jdGlvbiBrZWNjYWtQKHMsIHJvdW5kcyA9IDI0KSB7CiAgICBjb25zdCBCID0gbmV3IFVpbnQzMkFycmF5KDUgKiAyKTsKICAgIGZvciAobGV0IHJvdW5kID0gMjQgLSByb3VuZHM7IHJvdW5kIDwgMjQ7IHJvdW5kKyspIHsKICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgIEJbeF0gPSBzW3hdIF4gc1t4ICsgMTBdIF4gc1t4ICsgMjBdIF4gc1t4ICsgMzBdIF4gc1t4ICsgNDBdOwogICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4ICs9IDIpIHsKICAgICAgICBjb25zdCBpZHgxID0gKHggKyA4KSAlIDEwOwogICAgICAgIGNvbnN0IGlkeDAgPSAoeCArIDIpICUgMTA7CiAgICAgICAgY29uc3QgQjAgPSBCW2lkeDBdOwogICAgICAgIGNvbnN0IEIxID0gQltpZHgwICsgMV07CiAgICAgICAgY29uc3QgVGggPSByb3RsSChCMCwgQjEsIDEpIF4gQltpZHgxXTsKICAgICAgICBjb25zdCBUbCA9IHJvdGxMKEIwLCBCMSwgMSkgXiBCW2lkeDEgKyAxXTsKICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IDUwOyB5ICs9IDEwKSB7CiAgICAgICAgICBzW3ggKyB5XSBePSBUaDsKICAgICAgICAgIHNbeCArIHkgKyAxXSBePSBUbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IGN1ckggPSBzWzJdOwogICAgICBsZXQgY3VyTCA9IHNbM107CiAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgMjQ7IHQrKykgewogICAgICAgIGNvbnN0IHNoaWZ0ID0gU0hBM19ST1RMW3RdOwogICAgICAgIGNvbnN0IFRoID0gcm90bEgoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFRsID0gcm90bEwoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFBJID0gU0hBM19QSVt0XTsKICAgICAgICBjdXJIID0gc1tQSV07CiAgICAgICAgY3VyTCA9IHNbUEkgKyAxXTsKICAgICAgICBzW1BJXSA9IFRoOwogICAgICAgIHNbUEkgKyAxXSA9IFRsOwogICAgICB9CiAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgNTA7IHkgKz0gMTApIHsKICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4KyspCiAgICAgICAgICBCW3hdID0gc1t5ICsgeF07CiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgICAgc1t5ICsgeF0gXj0gfkJbKHggKyAyKSAlIDEwXSAmIEJbKHggKyA0KSAlIDEwXTsKICAgICAgfQogICAgICBzWzBdIF49IFNIQTNfSU9UQV9IW3JvdW5kXTsKICAgICAgc1sxXSBePSBTSEEzX0lPVEFfTFtyb3VuZF07CiAgICB9CiAgICBCLmZpbGwoMCk7CiAgfQogIHZhciBTSEEzX1BJLCBTSEEzX1JPVEwsIF9TSEEzX0lPVEEsIF8wbiwgXzFuLCBfMm4sIF83biwgXzI1Nm4sIF8weDcxbiwgU0hBM19JT1RBX0gsIFNIQTNfSU9UQV9MLCByb3RsSCwgcm90bEwsIEtlY2NhaywgZ2VuLCBzaGEzXzIyNCwgc2hhM18yNTYsIHNoYTNfMzg0LCBzaGEzXzUxMiwga2VjY2FrXzIyNCwga2VjY2FrXzI1Niwga2VjY2FrXzM4NCwga2VjY2FrXzUxMiwgZ2VuU2hha2UsIHNoYWtlMTI4LCBzaGFrZTI1NjsKICB2YXIgaW5pdF9zaGEzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9zaGEzLmpzIigpIHsKICAgICAgaW5pdF9hc3NlcnQoKTsKICAgICAgaW5pdF91NjQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBM19QSSA9IFtdOwogICAgICBTSEEzX1JPVEwgPSBbXTsKICAgICAgX1NIQTNfSU9UQSA9IFtdOwogICAgICBfMG4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDApOwogICAgICBfMW4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDIpOwogICAgICBfN24gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDcpOwogICAgICBfMjU2biA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMjU2KTsKICAgICAgXzB4NzFuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgxMTMpOwogICAgICBmb3IgKGxldCByb3VuZCA9IDAsIFIgPSBfMW4sIHggPSAxLCB5ID0gMDsgcm91bmQgPCAyNDsgcm91bmQrKykgewogICAgICAgIFt4LCB5XSA9IFt5LCAoMiAqIHggKyAzICogeSkgJSA1XTsKICAgICAgICBTSEEzX1BJLnB1c2goMiAqICg1ICogeSArIHgpKTsKICAgICAgICBTSEEzX1JPVEwucHVzaCgocm91bmQgKyAxKSAqIChyb3VuZCArIDIpIC8gMiAlIDY0KTsKICAgICAgICBsZXQgdCA9IF8wbjsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDc7IGorKykgewogICAgICAgICAgUiA9IChSIDw8IF8xbiBeIChSID4+IF83bikgKiBfMHg3MW4pICUgXzI1Nm47CiAgICAgICAgICBpZiAoUiAmIF8ybikKICAgICAgICAgICAgdCBePSBfMW4gPDwgKF8xbiA8PCAvKiBAX19QVVJFX18gKi8gQmlnSW50KGopKSAtIF8xbjsKICAgICAgICB9CiAgICAgICAgX1NIQTNfSU9UQS5wdXNoKHQpOwogICAgICB9CiAgICAgIFtTSEEzX0lPVEFfSCwgU0hBM19JT1RBX0xdID0gLyogQF9fUFVSRV9fICovIHNwbGl0KF9TSEEzX0lPVEEsIHRydWUpOwogICAgICByb3RsSCA9IChoLCBsLCBzKSA9PiBzID4gMzIgPyByb3RsQkgoaCwgbCwgcykgOiByb3RsU0goaCwgbCwgcyk7CiAgICAgIHJvdGxMID0gKGgsIGwsIHMpID0+IHMgPiAzMiA/IHJvdGxCTChoLCBsLCBzKSA6IHJvdGxTTChoLCBsLCBzKTsKICAgICAgS2VjY2FrID0gY2xhc3MgX0tlY2NhayBleHRlbmRzIEhhc2ggewogICAgICAgIC8vIE5PVEU6IHdlIGFjY2VwdCBhcmd1bWVudHMgaW4gYnl0ZXMgaW5zdGVhZCBvZiBiaXRzIGhlcmUuCiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCBlbmFibGVYT0YgPSBmYWxzZSwgcm91bmRzID0gMjQpIHsKICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICB0aGlzLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0aGlzLnN1ZmZpeCA9IHN1ZmZpeDsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5lbmFibGVYT0YgPSBlbmFibGVYT0Y7CiAgICAgICAgICB0aGlzLnJvdW5kcyA9IHJvdW5kczsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMucG9zT3V0ID0gMDsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBudW1iZXIob3V0cHV0TGVuKTsKICAgICAgICAgIGlmICgwID49IHRoaXMuYmxvY2tMZW4gfHwgdGhpcy5ibG9ja0xlbiA+PSAyMDApCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiU2hhMyBzdXBwb3J0cyBvbmx5IGtlY2Nhay1mMTYwMCBmdW5jdGlvbiIpOwogICAgICAgICAgdGhpcy5zdGF0ZSA9IG5ldyBVaW50OEFycmF5KDIwMCk7CiAgICAgICAgICB0aGlzLnN0YXRlMzIgPSB1MzIodGhpcy5zdGF0ZSk7CiAgICAgICAgfQogICAgICAgIGtlY2NhaygpIHsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAga2VjY2FrUCh0aGlzLnN0YXRlMzIsIHRoaXMucm91bmRzKTsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAgdGhpcy5wb3NPdXQgPSAwOwogICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgc3RhdGUgfSA9IHRoaXM7CiAgICAgICAgICBkYXRhID0gdG9CeXRlczIoZGF0YSk7CiAgICAgICAgICBjb25zdCBsZW4gPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDA7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGNvbnN0IHRha2UgPSBNYXRoLm1pbihibG9ja0xlbiAtIHRoaXMucG9zLCBsZW4gLSBwb3MpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRha2U7IGkrKykKICAgICAgICAgICAgICBzdGF0ZVt0aGlzLnBvcysrXSBePSBkYXRhW3BvcysrXTsKICAgICAgICAgICAgaWYgKHRoaXMucG9zID09PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGZpbmlzaCgpIHsKICAgICAgICAgIGlmICh0aGlzLmZpbmlzaGVkKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHsgc3RhdGUsIHN1ZmZpeCwgcG9zLCBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIHN0YXRlW3Bvc10gXj0gc3VmZml4OwogICAgICAgICAgaWYgKChzdWZmaXggJiAxMjgpICE9PSAwICYmIHBvcyA9PT0gYmxvY2tMZW4gLSAxKQogICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgc3RhdGVbYmxvY2tMZW4gLSAxXSBePSAxMjg7CiAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgIH0KICAgICAgICB3cml0ZUludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcywgZmFsc2UpOwogICAgICAgICAgYnl0ZXMob3V0KTsKICAgICAgICAgIHRoaXMuZmluaXNoKCk7CiAgICAgICAgICBjb25zdCBidWZmZXJPdXQgPSB0aGlzLnN0YXRlOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDAsIGxlbiA9IG91dC5sZW5ndGg7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnBvc091dCA+PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvc091dCwgbGVuIC0gcG9zKTsKICAgICAgICAgICAgb3V0LnNldChidWZmZXJPdXQuc3ViYXJyYXkodGhpcy5wb3NPdXQsIHRoaXMucG9zT3V0ICsgdGFrZSksIHBvcyk7CiAgICAgICAgICAgIHRoaXMucG9zT3V0ICs9IHRha2U7CiAgICAgICAgICAgIHBvcyArPSB0YWtlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICB9CiAgICAgICAgeG9mSW50byhvdXQpIHsKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVYT0YpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiWE9GIGlzIG5vdCBwb3NzaWJsZSBmb3IgdGhpcyBpbnN0YW5jZSIpOwogICAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVJbnRvKG91dCk7CiAgICAgICAgfQogICAgICAgIHhvZihieXRlczIpIHsKICAgICAgICAgIG51bWJlcihieXRlczIpOwogICAgICAgICAgcmV0dXJuIHRoaXMueG9mSW50byhuZXcgVWludDhBcnJheShieXRlczIpKTsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIG91dHB1dChvdXQsIHRoaXMpOwogICAgICAgICAgaWYgKHRoaXMuZmluaXNoZWQpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiZGlnZXN0KCkgd2FzIGFscmVhZHkgY2FsbGVkIik7CiAgICAgICAgICB0aGlzLndyaXRlSW50byhvdXQpOwogICAgICAgICAgdGhpcy5kZXN0cm95KCk7CiAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5kaWdlc3RJbnRvKG5ldyBVaW50OEFycmF5KHRoaXMub3V0cHV0TGVuKSk7CiAgICAgICAgfQogICAgICAgIGRlc3Ryb3koKSB7CiAgICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7CiAgICAgICAgICB0aGlzLnN0YXRlLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIGNvbnN0IHsgYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCByb3VuZHMsIGVuYWJsZVhPRiB9ID0gdGhpczsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyBfS2VjY2FrKGJsb2NrTGVuLCBzdWZmaXgsIG91dHB1dExlbiwgZW5hYmxlWE9GLCByb3VuZHMpKTsKICAgICAgICAgIHRvLnN0YXRlMzIuc2V0KHRoaXMuc3RhdGUzMik7CiAgICAgICAgICB0by5wb3MgPSB0aGlzLnBvczsKICAgICAgICAgIHRvLnBvc091dCA9IHRoaXMucG9zT3V0OwogICAgICAgICAgdG8uZmluaXNoZWQgPSB0aGlzLmZpbmlzaGVkOwogICAgICAgICAgdG8ucm91bmRzID0gcm91bmRzOwogICAgICAgICAgdG8uc3VmZml4ID0gc3VmZml4OwogICAgICAgICAgdG8ub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdG8uZW5hYmxlWE9GID0gZW5hYmxlWE9GOwogICAgICAgICAgdG8uZGVzdHJveWVkID0gdGhpcy5kZXN0cm95ZWQ7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgICBnZW4gPSAoc3VmZml4LCBibG9ja0xlbiwgb3V0cHV0TGVuKSA9PiB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IEtlY2NhayhibG9ja0xlbiwgc3VmZml4LCBvdXRwdXRMZW4pKTsKICAgICAgc2hhM18yMjQgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDE0NCwgMjI0IC8gOCk7CiAgICAgIHNoYTNfMjU2ID0gLyogQF9fUFVSRV9fICovIGdlbig2LCAxMzYsIDI1NiAvIDgpOwogICAgICBzaGEzXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oNiwgMTA0LCAzODQgLyA4KTsKICAgICAgc2hhM181MTIgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDcyLCA1MTIgLyA4KTsKICAgICAga2VjY2FrXzIyNCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTQ0LCAyMjQgLyA4KTsKICAgICAga2VjY2FrXzI1NiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTM2LCAyNTYgLyA4KTsKICAgICAga2VjY2FrXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTA0LCAzODQgLyA4KTsKICAgICAga2VjY2FrXzUxMiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgNzIsIDUxMiAvIDgpOwogICAgICBnZW5TaGFrZSA9IChzdWZmaXgsIGJsb2NrTGVuLCBvdXRwdXRMZW4pID0+IHdyYXBYT0ZDb25zdHJ1Y3RvcldpdGhPcHRzKChvcHRzID0ge30pID0+IG5ldyBLZWNjYWsoYmxvY2tMZW4sIHN1ZmZpeCwgb3B0cy5ka0xlbiA9PT0gdm9pZCAwID8gb3V0cHV0TGVuIDogb3B0cy5ka0xlbiwgdHJ1ZSkpOwogICAgICBzaGFrZTEyOCA9IC8qIEBfX1BVUkVfXyAqLyBnZW5TaGFrZSgzMSwgMTY4LCAxMjggLyA4KTsKICAgICAgc2hha2UyNTYgPSAvKiBAX19QVVJFX18gKi8gZ2VuU2hha2UoMzEsIDEzNiwgMjU2IC8gOCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2tlY2NhazI1Ni5qcwogIGZ1bmN0aW9uIGtlY2NhazI1Nih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IGtlY2Nha18yNTYoaXNIZXgodmFsdWUsIHsgc3RyaWN0OiBmYWxzZSB9KSA/IHRvQnl0ZXModmFsdWUpIDogdmFsdWUpOwogICAgaWYgKHRvID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gYnl0ZXMyOwogICAgcmV0dXJuIHRvSGV4KGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2tlY2NhazI1NiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9rZWNjYWsyNTYuanMiKCkgewogICAgICBpbml0X3NoYTMoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzCiAgZnVuY3Rpb24gaGFzaFNpZ25hdHVyZShzaWcpIHsKICAgIHJldHVybiBoYXNoMihzaWcpOwogIH0KICB2YXIgaGFzaDI7CiAgdmFyIGluaXRfaGFzaFNpZ25hdHVyZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfa2VjY2FrMjU2KCk7CiAgICAgIGhhc2gyID0gKHZhbHVlKSA9PiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9ub3JtYWxpemVTaWduYXR1cmUuanMKICBmdW5jdGlvbiBub3JtYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGxldCBjdXJyZW50ID0gIiI7CiAgICBsZXQgbGV2ZWwgPSAwOwogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgbGV0IHZhbGlkID0gZmFsc2U7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGFyID0gc2lnbmF0dXJlW2ldOwogICAgICBpZiAoWyIoIiwgIikiLCAiLCJdLmluY2x1ZGVzKGNoYXIpKQogICAgICAgIGFjdGl2ZSA9IHRydWU7CiAgICAgIGlmIChjaGFyID09PSAiKCIpCiAgICAgICAgbGV2ZWwrKzsKICAgICAgaWYgKGNoYXIgPT09ICIpIikKICAgICAgICBsZXZlbC0tOwogICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKGxldmVsID09PSAwKSB7CiAgICAgICAgaWYgKGNoYXIgPT09ICIgIiAmJiBbImV2ZW50IiwgImZ1bmN0aW9uIiwgIiJdLmluY2x1ZGVzKHJlc3VsdCkpCiAgICAgICAgICByZXN1bHQgPSAiIjsKICAgICAgICBlbHNlIHsKICAgICAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICAgICAgaWYgKGNoYXIgPT09ICIpIikgewogICAgICAgICAgICB2YWxpZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoY2hhciA9PT0gIiAiKSB7CiAgICAgICAgaWYgKHNpZ25hdHVyZVtpIC0gMV0gIT09ICIsIiAmJiBjdXJyZW50ICE9PSAiLCIgJiYgY3VycmVudCAhPT0gIiwoIikgewogICAgICAgICAgY3VycmVudCA9ICIiOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICBjdXJyZW50ICs9IGNoYXI7CiAgICB9CiAgICBpZiAoIXZhbGlkKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiVW5hYmxlIHRvIG5vcm1hbGl6ZSBzaWduYXR1cmUuIik7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgaW5pdF9ub3JtYWxpemVTaWduYXR1cmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvbm9ybWFsaXplU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzCiAgdmFyIHRvU2lnbmF0dXJlOwogIHZhciBpbml0X3RvU2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9leHBvcnRzKCk7CiAgICAgIGluaXRfbm9ybWFsaXplU2lnbmF0dXJlKCk7CiAgICAgIHRvU2lnbmF0dXJlID0gKGRlZikgPT4gewogICAgICAgIGNvbnN0IGRlZl8gPSAoKCkgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiBkZWYgPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gZGVmOwogICAgICAgICAgcmV0dXJuIGZvcm1hdEFiaUl0ZW0oZGVmKTsKICAgICAgICB9KSgpOwogICAgICAgIHJldHVybiBub3JtYWxpemVTaWduYXR1cmUoZGVmXyk7CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcwogIGZ1bmN0aW9uIHRvU2lnbmF0dXJlSGFzaChmbikgewogICAgcmV0dXJuIGhhc2hTaWduYXR1cmUodG9TaWduYXR1cmUoZm4pKTsKICB9CiAgdmFyIGluaXRfdG9TaWduYXR1cmVIYXNoID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcyIoKSB7CiAgICAgIGluaXRfaGFzaFNpZ25hdHVyZSgpOwogICAgICBpbml0X3RvU2lnbmF0dXJlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcwogIHZhciB0b0V2ZW50U2VsZWN0b3I7CiAgdmFyIGluaXRfdG9FdmVudFNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CiAgICAgIHRvRXZlbnRTZWxlY3RvciA9IHRvU2lnbmF0dXJlSGFzaDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hZGRyZXNzLmpzCiAgdmFyIEludmFsaWRBZGRyZXNzRXJyb3I7CiAgdmFyIGluaXRfYWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FkZHJlc3MuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW52YWxpZEFkZHJlc3NFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBBZGRyZXNzICIke2FkZHJlc3N9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIi0gQWRkcmVzcyBtdXN0IGJlIGEgaGV4IHZhbHVlIG9mIDIwIGJ5dGVzICg0MCBoZXggY2hhcmFjdGVycykuIiwKICAgICAgICAgICAgICAiLSBBZGRyZXNzIG11c3QgbWF0Y2ggaXRzIGNoZWNrc3VtIGNvdW50ZXJwYXJ0LiIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBZGRyZXNzRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9scnUuanMKICB2YXIgTHJ1TWFwOwogIHZhciBpbml0X2xydSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbHJ1LmpzIigpIHsKICAgICAgTHJ1TWFwID0gY2xhc3MgZXh0ZW5kcyBNYXAgewogICAgICAgIGNvbnN0cnVjdG9yKHNpemUzKSB7CiAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtYXhTaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMubWF4U2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgICBnZXQoa2V5KSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHN1cGVyLmdldChrZXkpOwogICAgICAgICAgaWYgKHN1cGVyLmhhcyhrZXkpICYmIHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgdGhpcy5kZWxldGUoa2V5KTsKICAgICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgICBzZXQoa2V5LCB2YWx1ZSkgewogICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgaWYgKHRoaXMubWF4U2l6ZSAmJiB0aGlzLnNpemUgPiB0aGlzLm1heFNpemUpIHsKICAgICAgICAgICAgY29uc3QgZmlyc3RLZXkgPSB0aGlzLmtleXMoKS5uZXh0KCkudmFsdWU7CiAgICAgICAgICAgIGlmIChmaXJzdEtleSkKICAgICAgICAgICAgICB0aGlzLmRlbGV0ZShmaXJzdEtleSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldEFkZHJlc3MuanMKICBmdW5jdGlvbiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzc18sIGNoYWluSWQpIHsKICAgIGlmIChjaGVja3N1bUFkZHJlc3NDYWNoZS5oYXMoYCR7YWRkcmVzc199LiR7Y2hhaW5JZH1gKSkKICAgICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzc0NhY2hlLmdldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWApOwogICAgY29uc3QgaGV4QWRkcmVzcyA9IGNoYWluSWQgPyBgJHtjaGFpbklkfSR7YWRkcmVzc18udG9Mb3dlckNhc2UoKX1gIDogYWRkcmVzc18uc3Vic3RyaW5nKDIpLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGhleEFkZHJlc3MpLCAiYnl0ZXMiKTsKICAgIGNvbnN0IGFkZHJlc3MgPSAoY2hhaW5JZCA/IGhleEFkZHJlc3Muc3Vic3RyaW5nKGAke2NoYWluSWR9MHhgLmxlbmd0aCkgOiBoZXhBZGRyZXNzKS5zcGxpdCgiIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQwOyBpICs9IDIpIHsKICAgICAgaWYgKGhhc2gzW2kgPj4gMV0gPj4gNCA+PSA4ICYmIGFkZHJlc3NbaV0pIHsKICAgICAgICBhZGRyZXNzW2ldID0gYWRkcmVzc1tpXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICAgIGlmICgoaGFzaDNbaSA+PiAxXSAmIDE1KSA+PSA4ICYmIGFkZHJlc3NbaSArIDFdKSB7CiAgICAgICAgYWRkcmVzc1tpICsgMV0gPSBhZGRyZXNzW2kgKyAxXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICB9CiAgICBjb25zdCByZXN1bHQgPSBgMHgke2FkZHJlc3Muam9pbigiIil9YDsKICAgIGNoZWNrc3VtQWRkcmVzc0NhY2hlLnNldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWAsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICBmdW5jdGlvbiBnZXRBZGRyZXNzKGFkZHJlc3MsIGNoYWluSWQpIHsKICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhhZGRyZXNzLCBjaGFpbklkKTsKICB9CiAgdmFyIGNoZWNrc3VtQWRkcmVzc0NhY2hlOwogIHZhciBpbml0X2dldEFkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvZ2V0QWRkcmVzcy5qcyIoKSB7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF9rZWNjYWsyNTYoKTsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9pc0FkZHJlc3MoKTsKICAgICAgY2hlY2tzdW1BZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzCiAgZnVuY3Rpb24gaXNBZGRyZXNzKGFkZHJlc3MsIG9wdGlvbnMpIHsKICAgIGNvbnN0IHsgc3RyaWN0ID0gdHJ1ZSB9ID0gb3B0aW9ucyA/PyB7fTsKICAgIGNvbnN0IGNhY2hlS2V5MiA9IGAke2FkZHJlc3N9LiR7c3RyaWN0fWA7CiAgICBpZiAoaXNBZGRyZXNzQ2FjaGUuaGFzKGNhY2hlS2V5MikpCiAgICAgIHJldHVybiBpc0FkZHJlc3NDYWNoZS5nZXQoY2FjaGVLZXkyKTsKICAgIGNvbnN0IHJlc3VsdCA9ICgoKSA9PiB7CiAgICAgIGlmICghYWRkcmVzc1JlZ2V4LnRlc3QoYWRkcmVzcykpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcy50b0xvd2VyQ2FzZSgpID09PSBhZGRyZXNzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHJldHVybiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzcykgPT09IGFkZHJlc3M7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGlzQWRkcmVzc0NhY2hlLnNldChjYWNoZUtleTIsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgYWRkcmVzc1JlZ2V4LCBpc0FkZHJlc3NDYWNoZTsKICB2YXIgaW5pdF9pc0FkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzIigpIHsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGFkZHJlc3NSZWdleCA9IC9eMHhbYS1mQS1GMC05XXs0MH0kLzsKICAgICAgaXNBZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvY29uY2F0LmpzCiAgZnVuY3Rpb24gY29uY2F0KHZhbHVlcykgewogICAgaWYgKHR5cGVvZiB2YWx1ZXNbMF0gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gY29uY2F0SGV4KHZhbHVlcyk7CiAgICByZXR1cm4gY29uY2F0Qnl0ZXMyKHZhbHVlcyk7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEJ5dGVzMih2YWx1ZXMpIHsKICAgIGxldCBsZW5ndGggPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIGxlbmd0aCArPSBhcnIubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIHJlc3VsdC5zZXQoYXJyLCBvZmZzZXQpOwogICAgICBvZmZzZXQgKz0gYXJyLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEhleCh2YWx1ZXMpIHsKICAgIHJldHVybiBgMHgke3ZhbHVlcy5yZWR1Y2UoKGFjYywgeCkgPT4gYWNjICsgeC5yZXBsYWNlKCIweCIsICIiKSwgIiIpfWA7CiAgfQogIHZhciBpbml0X2NvbmNhdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9jb25jYXQuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zbGljZS5qcwogIGZ1bmN0aW9uIHNsaWNlKHZhbHVlLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gc2xpY2VIZXgodmFsdWUsIHN0YXJ0LCBlbmQsIHsKICAgICAgICBzdHJpY3QKICAgICAgfSk7CiAgICByZXR1cm4gc2xpY2VCeXRlcyh2YWx1ZSwgc3RhcnQsIGVuZCwgewogICAgICBzdHJpY3QKICAgIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZSwgc3RhcnQpIHsKICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICJudW1iZXIiICYmIHN0YXJ0ID4gMCAmJiBzdGFydCA+IHNpemUodmFsdWUpIC0gMSkKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBzdGFydCwKICAgICAgICBwb3NpdGlvbjogInN0YXJ0IiwKICAgICAgICBzaXplOiBzaXplKHZhbHVlKQogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKSB7CiAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAibnVtYmVyIiAmJiB0eXBlb2YgZW5kID09PSAibnVtYmVyIiAmJiBzaXplKHZhbHVlKSAhPT0gZW5kIC0gc3RhcnQpIHsKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBlbmQsCiAgICAgICAgcG9zaXRpb246ICJlbmQiLAogICAgICAgIHNpemU6IHNpemUodmFsdWUpCiAgICAgIH0pOwogICAgfQogIH0KICBmdW5jdGlvbiBzbGljZUJ5dGVzKHZhbHVlXywgc3RhcnQsIGVuZCwgeyBzdHJpY3QgfSA9IHt9KSB7CiAgICBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZV8sIHN0YXJ0KTsKICAgIGNvbnN0IHZhbHVlID0gdmFsdWVfLnNsaWNlKHN0YXJ0LCBlbmQpOwogICAgaWYgKHN0cmljdCkKICAgICAgYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgZnVuY3Rpb24gc2xpY2VIZXgodmFsdWVfLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGFzc2VydFN0YXJ0T2Zmc2V0KHZhbHVlXywgc3RhcnQpOwogICAgY29uc3QgdmFsdWUgPSBgMHgke3ZhbHVlXy5yZXBsYWNlKCIweCIsICIiKS5zbGljZSgoc3RhcnQgPz8gMCkgKiAyLCAoZW5kID8/IHZhbHVlXy5sZW5ndGgpICogMil9YDsKICAgIGlmIChzdHJpY3QpCiAgICAgIGFzc2VydEVuZE9mZnNldCh2YWx1ZSwgc3RhcnQsIGVuZCk7CiAgICByZXR1cm4gdmFsdWU7CiAgfQogIHZhciBpbml0X3NsaWNlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3NsaWNlLmpzIigpIHsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfaXNIZXgoKTsKICAgICAgaW5pdF9zaXplKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlQWJpUGFyYW1ldGVycy5qcwogIGZ1bmN0aW9uIGVuY29kZUFiaVBhcmFtZXRlcnMocGFyYW1zLCB2YWx1ZXMpIHsKICAgIGlmIChwYXJhbXMubGVuZ3RoICE9PSB2YWx1ZXMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogcGFyYW1zLmxlbmd0aCwKICAgICAgICBnaXZlbkxlbmd0aDogdmFsdWVzLmxlbmd0aAogICAgICB9KTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gcHJlcGFyZVBhcmFtcyh7CiAgICAgIHBhcmFtcywKICAgICAgdmFsdWVzCiAgICB9KTsKICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gIjB4IjsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBwcmVwYXJlUGFyYW1zKHsgcGFyYW1zLCB2YWx1ZXMgfSkgewogICAgY29uc3QgcHJlcGFyZWRQYXJhbXMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZVBhcmFtKHsgcGFyYW06IHBhcmFtc1tpXSwgdmFsdWU6IHZhbHVlc1tpXSB9KSk7CiAgICB9CiAgICByZXR1cm4gcHJlcGFyZWRQYXJhbXM7CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVQYXJhbSh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbTogeyAuLi5wYXJhbSwgdHlwZSB9IH0pOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIpIHsKICAgICAgcmV0dXJuIGVuY29kZVR1cGxlKHZhbHVlLCB7CiAgICAgICAgcGFyYW0KICAgICAgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIHJldHVybiBlbmNvZGVBZGRyZXNzKHZhbHVlKTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAiYm9vbCIpIHsKICAgICAgcmV0dXJuIGVuY29kZUJvb2wodmFsdWUpOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgidWludCIpIHx8IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50IikpIHsKICAgICAgY29uc3Qgc2lnbmVkID0gcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKTsKICAgICAgcmV0dXJuIGVuY29kZU51bWJlcih2YWx1ZSwgeyBzaWduZWQgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJieXRlcyIpKSB7CiAgICAgIHJldHVybiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gZW5jb2RlU3RyaW5nKHZhbHVlKTsKICAgIH0KICAgIHRocm93IG5ldyBJbnZhbGlkQWJpRW5jb2RpbmdUeXBlRXJyb3IocGFyYW0udHlwZSwgewogICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L2VuY29kZUFiaVBhcmFtZXRlcnMiCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSB7CiAgICBsZXQgc3RhdGljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKQogICAgICAgIHN0YXRpY1NpemUgKz0gMzI7CiAgICAgIGVsc2UKICAgICAgICBzdGF0aWNTaXplICs9IHNpemUoZW5jb2RlZCk7CiAgICB9CiAgICBjb25zdCBzdGF0aWNQYXJhbXMgPSBbXTsKICAgIGNvbnN0IGR5bmFtaWNQYXJhbXMgPSBbXTsKICAgIGxldCBkeW5hbWljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKSB7CiAgICAgICAgc3RhdGljUGFyYW1zLnB1c2gobnVtYmVyVG9IZXgoc3RhdGljU2l6ZSArIGR5bmFtaWNTaXplLCB7IHNpemU6IDMyIH0pKTsKICAgICAgICBkeW5hbWljUGFyYW1zLnB1c2goZW5jb2RlZCk7CiAgICAgICAgZHluYW1pY1NpemUgKz0gc2l6ZShlbmNvZGVkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGF0aWNQYXJhbXMucHVzaChlbmNvZGVkKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbmNhdChbLi4uc3RhdGljUGFyYW1zLCAuLi5keW5hbWljUGFyYW1zXSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFkZHJlc3ModmFsdWUpIHsKICAgIGlmICghaXNBZGRyZXNzKHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgIHJldHVybiB7IGR5bmFtaWM6IGZhbHNlLCBlbmNvZGVkOiBwYWRIZXgodmFsdWUudG9Mb3dlckNhc2UoKSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbSB9KSB7CiAgICBjb25zdCBkeW5hbWljID0gbGVuZ3RoID09PSBudWxsOwogICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBcnJheUVycm9yKHZhbHVlKTsKICAgIGlmICghZHluYW1pYyAmJiB2YWx1ZS5sZW5ndGggIT09IGxlbmd0aCkKICAgICAgdGhyb3cgbmV3IEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogbGVuZ3RoLAogICAgICAgIGdpdmVuTGVuZ3RoOiB2YWx1ZS5sZW5ndGgsCiAgICAgICAgdHlwZTogYCR7cGFyYW0udHlwZX1bJHtsZW5ndGh9XWAKICAgICAgfSk7CiAgICBsZXQgZHluYW1pY0NoaWxkID0gZmFsc2U7CiAgICBjb25zdCBwcmVwYXJlZFBhcmFtcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBwcmVwYXJlZFBhcmFtID0gcHJlcGFyZVBhcmFtKHsgcGFyYW0sIHZhbHVlOiB2YWx1ZVtpXSB9KTsKICAgICAgaWYgKHByZXBhcmVkUGFyYW0uZHluYW1pYykKICAgICAgICBkeW5hbWljQ2hpbGQgPSB0cnVlOwogICAgICBwcmVwYXJlZFBhcmFtcy5wdXNoKHByZXBhcmVkUGFyYW0pOwogICAgfQogICAgaWYgKGR5bmFtaWMgfHwgZHluYW1pY0NoaWxkKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgICBpZiAoZHluYW1pYykgewogICAgICAgIGNvbnN0IGxlbmd0aDIgPSBudW1iZXJUb0hleChwcmVwYXJlZFBhcmFtcy5sZW5ndGgsIHsgc2l6ZTogMzIgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgICBlbmNvZGVkOiBwcmVwYXJlZFBhcmFtcy5sZW5ndGggPiAwID8gY29uY2F0KFtsZW5ndGgyLCBkYXRhXSkgOiBsZW5ndGgyCiAgICAgICAgfTsKICAgICAgfQogICAgICBpZiAoZHluYW1pY0NoaWxkKQogICAgICAgIHJldHVybiB7IGR5bmFtaWM6IHRydWUsIGVuY29kZWQ6IGRhdGEgfTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBjb25jYXQocHJlcGFyZWRQYXJhbXMubWFwKCh7IGVuY29kZWQgfSkgPT4gZW5jb2RlZCkpCiAgICB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KSB7CiAgICBjb25zdCBbLCBwYXJhbVNpemVdID0gcGFyYW0udHlwZS5zcGxpdCgiYnl0ZXMiKTsKICAgIGNvbnN0IGJ5dGVzU2l6ZSA9IHNpemUodmFsdWUpOwogICAgaWYgKCFwYXJhbVNpemUpIHsKICAgICAgbGV0IHZhbHVlXyA9IHZhbHVlOwogICAgICBpZiAoYnl0ZXNTaXplICUgMzIgIT09IDApCiAgICAgICAgdmFsdWVfID0gcGFkSGV4KHZhbHVlXywgewogICAgICAgICAgZGlyOiAicmlnaHQiLAogICAgICAgICAgc2l6ZTogTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIgLyAzMikgKiAzMgogICAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgZW5jb2RlZDogY29uY2F0KFtwYWRIZXgobnVtYmVyVG9IZXgoYnl0ZXNTaXplLCB7IHNpemU6IDMyIH0pKSwgdmFsdWVfXSkKICAgICAgfTsKICAgIH0KICAgIGlmIChieXRlc1NpemUgIT09IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIgfSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQm9vbCh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBib29sZWFuIHZhbHVlOiAiJHt2YWx1ZX0iICh0eXBlOiAke3R5cGVvZiB2YWx1ZX0pLiBFeHBlY3RlZDogXGB0cnVlXGAgb3IgXGBmYWxzZVxgLmApOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleChib29sVG9IZXgodmFsdWUpKSB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVOdW1iZXIodmFsdWUsIHsgc2lnbmVkIH0pIHsKICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IDMyLAogICAgICAgIHNpZ25lZAogICAgICB9KQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlU3RyaW5nKHZhbHVlKSB7CiAgICBjb25zdCBoZXhWYWx1ZSA9IHN0cmluZ1RvSGV4KHZhbHVlKTsKICAgIGNvbnN0IHBhcnRzTGVuZ3RoID0gTWF0aC5jZWlsKHNpemUoaGV4VmFsdWUpIC8gMzIpOwogICAgY29uc3QgcGFydHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHNMZW5ndGg7IGkrKykgewogICAgICBwYXJ0cy5wdXNoKHBhZEhleChzbGljZShoZXhWYWx1ZSwgaSAqIDMyLCAoaSArIDEpICogMzIpLCB7CiAgICAgICAgZGlyOiAicmlnaHQiCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgIGVuY29kZWQ6IGNvbmNhdChbCiAgICAgICAgcGFkSGV4KG51bWJlclRvSGV4KHNpemUoaGV4VmFsdWUpLCB7IHNpemU6IDMyIH0pKSwKICAgICAgICAuLi5wYXJ0cwogICAgICBdKQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlVHVwbGUodmFsdWUsIHsgcGFyYW0gfSkgewogICAgbGV0IGR5bmFtaWMgPSBmYWxzZTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcGFyYW1fID0gcGFyYW0uY29tcG9uZW50c1tpXTsKICAgICAgY29uc3QgaW5kZXgyID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBpIDogcGFyYW1fLm5hbWU7CiAgICAgIGNvbnN0IHByZXBhcmVkUGFyYW0gPSBwcmVwYXJlUGFyYW0oewogICAgICAgIHBhcmFtOiBwYXJhbV8sCiAgICAgICAgdmFsdWU6IHZhbHVlW2luZGV4Ml0KICAgICAgfSk7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZWRQYXJhbSk7CiAgICAgIGlmIChwcmVwYXJlZFBhcmFtLmR5bmFtaWMpCiAgICAgICAgZHluYW1pYyA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gewogICAgICBkeW5hbWljLAogICAgICBlbmNvZGVkOiBkeW5hbWljID8gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSA6IGNvbmNhdChwcmVwYXJlZFBhcmFtcy5tYXAoKHsgZW5jb2RlZCB9KSA9PiBlbmNvZGVkKSkKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldEFycmF5Q29tcG9uZW50cyh0eXBlKSB7CiAgICBjb25zdCBtYXRjaGVzID0gdHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pOwogICAgcmV0dXJuIG1hdGNoZXMgPyAoCiAgICAgIC8vIFJldHVybiBgbnVsbGAgaWYgdGhlIGFycmF5IGlzIGR5bmFtaWMuCiAgICAgIFttYXRjaGVzWzJdID8gTnVtYmVyKG1hdGNoZXNbMl0pIDogbnVsbCwgbWF0Y2hlc1sxXV0KICAgICkgOiB2b2lkIDA7CiAgfQogIHZhciBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcwogIHZhciB0b0Z1bmN0aW9uU2VsZWN0b3I7CiAgdmFyIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfc2xpY2UoKTsKICAgICAgaW5pdF90b1NpZ25hdHVyZUhhc2goKTsKICAgICAgdG9GdW5jdGlvblNlbGVjdG9yID0gKGZuKSA9PiBzbGljZSh0b1NpZ25hdHVyZUhhc2goZm4pLCAwLCA0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9nZXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZ2V0QWJpSXRlbShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncyA9IFtdLCBuYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaXNTZWxlY3RvciA9IGlzSGV4KG5hbWUsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgIGNvbnN0IGFiaUl0ZW1zID0gYWJpMi5maWx0ZXIoKGFiaUl0ZW0pID0+IHsKICAgICAgaWYgKGlzU2VsZWN0b3IpIHsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgICAgcmV0dXJuIHRvRnVuY3Rpb25TZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICAgICAgcmV0dXJuIHRvRXZlbnRTZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuICJuYW1lIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0ubmFtZSA9PT0gbmFtZTsKICAgIH0pOwogICAgaWYgKGFiaUl0ZW1zLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGlmIChhYmlJdGVtcy5sZW5ndGggPT09IDEpCiAgICAgIHJldHVybiBhYmlJdGVtc1swXTsKICAgIGxldCBtYXRjaGVkQWJpSXRlbSA9IHZvaWQgMDsKICAgIGZvciAoY29uc3QgYWJpSXRlbSBvZiBhYmlJdGVtcykgewogICAgICBpZiAoISgiaW5wdXRzIiBpbiBhYmlJdGVtKSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKSB7CiAgICAgICAgaWYgKCFhYmlJdGVtLmlucHV0cyB8fCBhYmlJdGVtLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgICAgICByZXR1cm4gYWJpSXRlbTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoICE9PSBhcmdzLmxlbmd0aCkKICAgICAgICBjb250aW51ZTsKICAgICAgY29uc3QgbWF0Y2hlZCA9IGFyZ3MuZXZlcnkoKGFyZywgaW5kZXgyKSA9PiB7CiAgICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gImlucHV0cyIgaW4gYWJpSXRlbSAmJiBhYmlJdGVtLmlucHV0c1tpbmRleDJdOwogICAgICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcik7CiAgICAgIH0pOwogICAgICBpZiAobWF0Y2hlZCkgewogICAgICAgIGlmIChtYXRjaGVkQWJpSXRlbSAmJiAiaW5wdXRzIiBpbiBtYXRjaGVkQWJpSXRlbSAmJiBtYXRjaGVkQWJpSXRlbS5pbnB1dHMpIHsKICAgICAgICAgIGNvbnN0IGFtYmlndW91c1R5cGVzID0gZ2V0QW1iaWd1b3VzVHlwZXMoYWJpSXRlbS5pbnB1dHMsIG1hdGNoZWRBYmlJdGVtLmlucHV0cywgYXJncyk7CiAgICAgICAgICBpZiAoYW1iaWd1b3VzVHlwZXMpCiAgICAgICAgICAgIHRocm93IG5ldyBBYmlJdGVtQW1iaWd1aXR5RXJyb3IoewogICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgdHlwZTogYW1iaWd1b3VzVHlwZXNbMF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIGFiaUl0ZW06IG1hdGNoZWRBYmlJdGVtLAogICAgICAgICAgICAgIHR5cGU6IGFtYmlndW91c1R5cGVzWzFdCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBtYXRjaGVkQWJpSXRlbSA9IGFiaUl0ZW07CiAgICAgIH0KICAgIH0KICAgIGlmIChtYXRjaGVkQWJpSXRlbSkKICAgICAgcmV0dXJuIG1hdGNoZWRBYmlJdGVtOwogICAgcmV0dXJuIGFiaUl0ZW1zWzBdOwogIH0KICBmdW5jdGlvbiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcikgewogICAgY29uc3QgYXJnVHlwZSA9IHR5cGVvZiBhcmc7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJUeXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBzd2l0Y2ggKGFiaVBhcmFtZXRlclR5cGUpIHsKICAgICAgY2FzZSAiYWRkcmVzcyI6CiAgICAgICAgcmV0dXJuIGlzQWRkcmVzcyhhcmcsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgICAgY2FzZSAiYm9vbCI6CiAgICAgICAgcmV0dXJuIGFyZ1R5cGUgPT09ICJib29sZWFuIjsKICAgICAgY2FzZSAiZnVuY3Rpb24iOgogICAgICAgIHJldHVybiBhcmdUeXBlID09PSAic3RyaW5nIjsKICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyI7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBpZiAoYWJpUGFyYW1ldGVyVHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoYWJpUGFyYW1ldGVyLmNvbXBvbmVudHMpLmV2ZXJ5KChjb21wb25lbnQsIGluZGV4MikgPT4gewogICAgICAgICAgICByZXR1cm4gaXNBcmdPZlR5cGUoT2JqZWN0LnZhbHVlcyhhcmcpW2luZGV4Ml0sIGNvbXBvbmVudCk7CiAgICAgICAgICB9KTsKICAgICAgICBpZiAoL151P2ludCg4fDE2fDI0fDMyfDQwfDQ4fDU2fDY0fDcyfDgwfDg4fDk2fDEwNHwxMTJ8MTIwfDEyOHwxMzZ8MTQ0fDE1MnwxNjB8MTY4fDE3NnwxODR8MTkyfDIwMHwyMDh8MjE2fDIyNHwyMzJ8MjQwfDI0OHwyNTYpPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gIm51bWJlciIgfHwgYXJnVHlwZSA9PT0gImJpZ2ludCI7CiAgICAgICAgaWYgKC9eYnl0ZXMoWzEtOV18MVswLTldfDJbMC05XXwzWzAtMl0pPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyIgfHwgYXJnIGluc3RhbmNlb2YgVWludDhBcnJheTsKICAgICAgICBpZiAoL1thLXpdK1sxLTldezAsM30oXFtbMC05XXswLH1cXSkrJC8udGVzdChhYmlQYXJhbWV0ZXJUeXBlKSkgewogICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXJnKSAmJiBhcmcuZXZlcnkoKHgpID0+IGlzQXJnT2ZUeXBlKHgsIHsKICAgICAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgICAgICAvLyBQb3Agb2ZmIGBbXWAgb3IgYFtNXWAgZnJvbSBlbmQgb2YgdHlwZQogICAgICAgICAgICB0eXBlOiBhYmlQYXJhbWV0ZXJUeXBlLnJlcGxhY2UoLyhcW1swLTldezAsfVxdKSQvLCAiIikKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlcnMsIHRhcmdldFBhcmFtZXRlcnMsIGFyZ3MpIHsKICAgIGZvciAoY29uc3QgcGFyYW1ldGVySW5kZXggaW4gc291cmNlUGFyYW1ldGVycykgewogICAgICBjb25zdCBzb3VyY2VQYXJhbWV0ZXIgPSBzb3VyY2VQYXJhbWV0ZXJzW3BhcmFtZXRlckluZGV4XTsKICAgICAgY29uc3QgdGFyZ2V0UGFyYW1ldGVyID0gdGFyZ2V0UGFyYW1ldGVyc1twYXJhbWV0ZXJJbmRleF07CiAgICAgIGlmIChzb3VyY2VQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiB0YXJnZXRQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gc291cmNlUGFyYW1ldGVyICYmICJjb21wb25lbnRzIiBpbiB0YXJnZXRQYXJhbWV0ZXIpCiAgICAgICAgcmV0dXJuIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlci5jb21wb25lbnRzLCB0YXJnZXRQYXJhbWV0ZXIuY29tcG9uZW50cywgYXJnc1twYXJhbWV0ZXJJbmRleF0pOwogICAgICBjb25zdCB0eXBlcyA9IFtzb3VyY2VQYXJhbWV0ZXIudHlwZSwgdGFyZ2V0UGFyYW1ldGVyLnR5cGVdOwogICAgICBjb25zdCBhbWJpZ3VvdXMgPSAoKCkgPT4gewogICAgICAgIGlmICh0eXBlcy5pbmNsdWRlcygiYWRkcmVzcyIpICYmIHR5cGVzLmluY2x1ZGVzKCJieXRlczIwIikpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAodHlwZXMuaW5jbHVkZXMoImFkZHJlc3MiKSAmJiB0eXBlcy5pbmNsdWRlcygic3RyaW5nIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgaWYgKHR5cGVzLmluY2x1ZGVzKCJhZGRyZXNzIikgJiYgdHlwZXMuaW5jbHVkZXMoImJ5dGVzIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KSgpOwogICAgICBpZiAoYW1iaWd1b3VzKQogICAgICAgIHJldHVybiB0eXBlczsKICAgIH0KICAgIHJldHVybjsKICB9CiAgdmFyIGluaXRfZ2V0QWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2dldEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2lzSGV4KCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9wYXJzZUFjY291bnQuanMKICBmdW5jdGlvbiBwYXJzZUFjY291bnQoYWNjb3VudCkgewogICAgaWYgKHR5cGVvZiBhY2NvdW50ID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHsgYWRkcmVzczogYWNjb3VudCwgdHlwZTogImpzb24tcnBjIiB9OwogICAgcmV0dXJuIGFjY291bnQ7CiAgfQogIHZhciBpbml0X3BhcnNlQWNjb3VudCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcGFyc2VBY2NvdW50LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhLmpzCiAgZnVuY3Rpb24gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7CiAgICAgICAgYWJpOiBhYmkyLAogICAgICAgIGFyZ3MsCiAgICAgICAgbmFtZTogZnVuY3Rpb25OYW1lCiAgICAgIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoMiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGgyIH0pOwogICAgcmV0dXJuIHsKICAgICAgYWJpOiBbYWJpSXRlbV0sCiAgICAgIGZ1bmN0aW9uTmFtZTogdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pKQogICAgfTsKICB9CiAgdmFyIGRvY3NQYXRoMjsKICB2YXIgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YS5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGRvY3NQYXRoMiA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVGdW5jdGlvbkRhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uRGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lIH0gPSAoKCkgPT4gewogICAgICBpZiAocGFyYW1ldGVycy5hYmkubGVuZ3RoID09PSAxICYmIHBhcmFtZXRlcnMuZnVuY3Rpb25OYW1lPy5zdGFydHNXaXRoKCIweCIpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzOwogICAgICByZXR1cm4gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKTsKICAgIH0pKCk7CiAgICBjb25zdCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IGZ1bmN0aW9uTmFtZTsKICAgIGNvbnN0IGRhdGEgPSAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzID8gZW5jb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cywgYXJncyA/PyBbXSkgOiB2b2lkIDA7CiAgICByZXR1cm4gY29uY2F0SGV4KFtzaWduYXR1cmUsIGRhdGEgPz8gIjB4Il0pOwogIH0KICB2YXIgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVGdW5jdGlvbkRhdGEuanMiKCkgewogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMKICB2YXIgcGFuaWNSZWFzb25zLCBzb2xpZGl0eUVycm9yLCBzb2xpZGl0eVBhbmljOwogIHZhciBpbml0X3NvbGlkaXR5ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMiKCkgewogICAgICBwYW5pY1JlYXNvbnMgPSB7CiAgICAgICAgMTogIkFuIGBhc3NlcnRgIGNvbmRpdGlvbiBmYWlsZWQuIiwKICAgICAgICAxNzogIkFyaXRobWV0aWMgb3BlcmF0aW9uIHJlc3VsdGVkIGluIHVuZGVyZmxvdyBvciBvdmVyZmxvdy4iLAogICAgICAgIDE4OiAiRGl2aXNpb24gb3IgbW9kdWxvIGJ5IHplcm8gKGUuZy4gYDUgLyAwYCBvciBgMjMgJSAwYCkuIiwKICAgICAgICAzMzogIkF0dGVtcHRlZCB0byBjb252ZXJ0IHRvIGFuIGludmFsaWQgdHlwZS4iLAogICAgICAgIDM0OiAiQXR0ZW1wdGVkIHRvIGFjY2VzcyBhIHN0b3JhZ2UgYnl0ZSBhcnJheSB0aGF0IGlzIGluY29ycmVjdGx5IGVuY29kZWQuIiwKICAgICAgICA0OTogIlBlcmZvcm1lZCBgLnBvcCgpYCBvbiBhbiBlbXB0eSBhcnJheSIsCiAgICAgICAgNTA6ICJBcnJheSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLiIsCiAgICAgICAgNjU6ICJBbGxvY2F0ZWQgdG9vIG11Y2ggbWVtb3J5IG9yIGNyZWF0ZWQgYW4gYXJyYXkgd2hpY2ggaXMgdG9vIGxhcmdlLiIsCiAgICAgICAgODE6ICJBdHRlbXB0ZWQgdG8gY2FsbCBhIHplcm8taW5pdGlhbGl6ZWQgdmFyaWFibGUgb2YgaW50ZXJuYWwgZnVuY3Rpb24gdHlwZS4iCiAgICAgIH07CiAgICAgIHNvbGlkaXR5RXJyb3IgPSB7CiAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICJtZXNzYWdlIiwKICAgICAgICAgICAgdHlwZTogInN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFcnJvciIsCiAgICAgICAgdHlwZTogImVycm9yIgogICAgICB9OwogICAgICBzb2xpZGl0eVBhbmljID0gewogICAgICAgIGlucHV0czogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAicmVhc29uIiwKICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBuYW1lOiAiUGFuaWMiLAogICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jdXJzb3IuanMKICB2YXIgTmVnYXRpdmVPZmZzZXRFcnJvciwgUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yLCBSZWN1cnNpdmVSZWFkTGltaXRFeGNlZWRlZEVycm9yOwogIHZhciBpbml0X2N1cnNvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBOZWdhdGl2ZU9mZnNldEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCB9KSB7CiAgICAgICAgICBzdXBlcihgT2Zmc2V0IFxgJHtvZmZzZXR9XGAgY2Fubm90IGJlIG5lZ2F0aXZlLmAsIHsKICAgICAgICAgICAgbmFtZTogIk5lZ2F0aXZlT2Zmc2V0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFBvc2l0aW9uT3V0T2ZCb3VuZHNFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBsZW5ndGgsIHBvc2l0aW9uIH0pIHsKICAgICAgICAgIHN1cGVyKGBQb3NpdGlvbiBcYCR7cG9zaXRpb259XGAgaXMgb3V0IG9mIGJvdW5kcyAoXGAwIDwgcG9zaXRpb24gPCAke2xlbmd0aH1cYCkuYCwgeyBuYW1lOiAiUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY291bnQsIGxpbWl0IH0pIHsKICAgICAgICAgIHN1cGVyKGBSZWN1cnNpdmUgcmVhZCBsaW1pdCBvZiBcYCR7bGltaXR9XGAgZXhjZWVkZWQgKHJlY3Vyc2l2ZSByZWFkIGNvdW50OiBcYCR7Y291bnR9XGApLmAsIHsgbmFtZTogIlJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUN1cnNvcihieXRlczIsIHsgcmVjdXJzaXZlUmVhZExpbWl0ID0gODE5MiB9ID0ge30pIHsKICAgIGNvbnN0IGN1cnNvciA9IE9iamVjdC5jcmVhdGUoc3RhdGljQ3Vyc29yKTsKICAgIGN1cnNvci5ieXRlcyA9IGJ5dGVzMjsKICAgIGN1cnNvci5kYXRhVmlldyA9IG5ldyBEYXRhVmlldyhieXRlczIuYnVmZmVyLCBieXRlczIuYnl0ZU9mZnNldCwgYnl0ZXMyLmJ5dGVMZW5ndGgpOwogICAgY3Vyc29yLnBvc2l0aW9uUmVhZENvdW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGN1cnNvci5yZWN1cnNpdmVSZWFkTGltaXQgPSByZWN1cnNpdmVSZWFkTGltaXQ7CiAgICByZXR1cm4gY3Vyc29yOwogIH0KICB2YXIgc3RhdGljQ3Vyc29yOwogIHZhciBpbml0X2N1cnNvcjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfY3Vyc29yKCk7CiAgICAgIHN0YXRpY0N1cnNvciA9IHsKICAgICAgICBieXRlczogbmV3IFVpbnQ4QXJyYXkoKSwKICAgICAgICBkYXRhVmlldzogbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigwKSksCiAgICAgICAgcG9zaXRpb246IDAsCiAgICAgICAgcG9zaXRpb25SZWFkQ291bnQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksCiAgICAgICAgcmVjdXJzaXZlUmVhZENvdW50OiAwLAogICAgICAgIHJlY3Vyc2l2ZVJlYWRMaW1pdDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLAogICAgICAgIGFzc2VydFJlYWRMaW1pdCgpIHsKICAgICAgICAgIGlmICh0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCA+PSB0aGlzLnJlY3Vyc2l2ZVJlYWRMaW1pdCkKICAgICAgICAgICAgdGhyb3cgbmV3IFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IoewogICAgICAgICAgICAgIGNvdW50OiB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCArIDEsCiAgICAgICAgICAgICAgbGltaXQ6IHRoaXMucmVjdXJzaXZlUmVhZExpbWl0CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pIHsKICAgICAgICAgIGlmIChwb3NpdGlvbiA8IDAgfHwgcG9zaXRpb24gPiB0aGlzLmJ5dGVzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgIHRocm93IG5ldyBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IoewogICAgICAgICAgICAgIGxlbmd0aDogdGhpcy5ieXRlcy5sZW5ndGgsCiAgICAgICAgICAgICAgcG9zaXRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBkZWNyZW1lbnRQb3NpdGlvbihvZmZzZXQpIHsKICAgICAgICAgIGlmIChvZmZzZXQgPCAwKQogICAgICAgICAgICB0aHJvdyBuZXcgTmVnYXRpdmVPZmZzZXRFcnJvcih7IG9mZnNldCB9KTsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiAtIG9mZnNldDsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgZ2V0UmVhZENvdW50KHBvc2l0aW9uKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvblJlYWRDb3VudC5nZXQocG9zaXRpb24gfHwgdGhpcy5wb3NpdGlvbikgfHwgMDsKICAgICAgICB9LAogICAgICAgIGluY3JlbWVudFBvc2l0aW9uKG9mZnNldCkgewogICAgICAgICAgaWYgKG9mZnNldCA8IDApCiAgICAgICAgICAgIHRocm93IG5ldyBOZWdhdGl2ZU9mZnNldEVycm9yKHsgb2Zmc2V0IH0pOwogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uICsgb2Zmc2V0OwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0Qnl0ZShwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzW3Bvc2l0aW9uXTsKICAgICAgICB9LAogICAgICAgIGluc3BlY3RCeXRlcyhsZW5ndGgsIHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyBsZW5ndGggLSAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLnN1YmFycmF5KHBvc2l0aW9uLCBwb3NpdGlvbiArIGxlbmd0aCk7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDgocG9zaXRpb25fKSB7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBvc2l0aW9uXyA/PyB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICByZXR1cm4gdGhpcy5ieXRlc1twb3NpdGlvbl07CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDE2KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFWaWV3LmdldFVpbnQxNihwb3NpdGlvbik7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDI0KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAyKTsKICAgICAgICAgIHJldHVybiAodGhpcy5kYXRhVmlldy5nZXRVaW50MTYocG9zaXRpb24pIDw8IDgpICsgdGhpcy5kYXRhVmlldy5nZXRVaW50OChwb3NpdGlvbiArIDIpOwogICAgICAgIH0sCiAgICAgICAgaW5zcGVjdFVpbnQzMihwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uICsgMyk7CiAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhVmlldy5nZXRVaW50MzIocG9zaXRpb24pOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGUoYnl0ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSBieXRlOwogICAgICAgICAgdGhpcy5wb3NpdGlvbisrOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGVzKGJ5dGVzMikgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgYnl0ZXMyLmxlbmd0aCAtIDEpOwogICAgICAgICAgdGhpcy5ieXRlcy5zZXQoYnl0ZXMyLCB0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gYnl0ZXMyLmxlbmd0aDsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50OCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSB2YWx1ZTsKICAgICAgICAgIHRoaXMucG9zaXRpb24rKzsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50MTYodmFsdWUpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24odGhpcy5wb3NpdGlvbiArIDEpOwogICAgICAgICAgdGhpcy5kYXRhVmlldy5zZXRVaW50MTYodGhpcy5wb3NpdGlvbiwgdmFsdWUpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAyOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQyNCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMik7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQxNih0aGlzLnBvc2l0aW9uLCB2YWx1ZSA+PiA4KTsKICAgICAgICAgIHRoaXMuZGF0YVZpZXcuc2V0VWludDgodGhpcy5wb3NpdGlvbiArIDIsIHZhbHVlICYgfjQyOTQ5NjcwNDApOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAzOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQzMih2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMyk7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQzMih0aGlzLnBvc2l0aW9uLCB2YWx1ZSk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDQ7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZSgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RCeXRlKCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uKys7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZXMobGVuZ3RoLCBzaXplMykgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdEJ5dGVzKGxlbmd0aCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IHNpemUzID8/IGxlbmd0aDsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50OCgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50OCgpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAxOwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgcmVhZFVpbnQxNigpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50MTYoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gMjsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50MjQoKSB7CiAgICAgICAgICB0aGlzLmFzc2VydFJlYWRMaW1pdCgpOwogICAgICAgICAgdGhpcy5fdG91Y2goKTsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5pbnNwZWN0VWludDI0KCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDM7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkVWludDMyKCkgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdFVpbnQzMigpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSA0OwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgZ2V0IHJlbWFpbmluZygpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMucG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBzZXRQb3NpdGlvbihwb3NpdGlvbikgewogICAgICAgICAgY29uc3Qgb2xkUG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgICByZXR1cm4gKCkgPT4gdGhpcy5wb3NpdGlvbiA9IG9sZFBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgX3RvdWNoKCkgewogICAgICAgICAgaWYgKHRoaXMucmVjdXJzaXZlUmVhZExpbWl0ID09PSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNvdW50ID0gdGhpcy5nZXRSZWFkQ291bnQoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb25SZWFkQ291bnQuc2V0KHRoaXMucG9zaXRpb24sIGNvdW50ICsgMSk7CiAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCsrOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21CeXRlcy5qcwogIGZ1bmN0aW9uIGZyb21CeXRlcyhieXRlczIsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBieXRlc1RvTnVtYmVyKGJ5dGVzMiwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJiaWdpbnQiKQogICAgICByZXR1cm4gYnl0ZXNUb0JpZ0ludChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYm9vbGVhbiIpCiAgICAgIHJldHVybiBieXRlc1RvQm9vbChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGJ5dGVzVG9TdHJpbmcoYnl0ZXMyLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KGJ5dGVzMiwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9CaWdJbnQoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9Cb29sKGJ5dGVzXywgb3B0cyA9IHt9KSB7CiAgICBsZXQgYnl0ZXMyID0gYnl0ZXNfOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgYnl0ZXMyID0gdHJpbShieXRlczIpOwogICAgfQogICAgaWYgKGJ5dGVzMi5sZW5ndGggPiAxIHx8IGJ5dGVzMlswXSA+IDEpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IoYnl0ZXMyKTsKICAgIHJldHVybiBCb29sZWFuKGJ5dGVzMlswXSk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9OdW1iZXIoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvTnVtYmVyKGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXNfLCBvcHRzID0ge30pIHsKICAgIGxldCBieXRlczIgPSBieXRlc187CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21CeXRlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUJ5dGVzLmpzIigpIHsKICAgICAgaW5pdF9lbmNvZGluZygpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZGVjb2RlQWJpUGFyYW1ldGVycyhwYXJhbXMsIGRhdGEpIHsKICAgIGNvbnN0IGJ5dGVzMiA9IHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiA/IGhleFRvQnl0ZXMoZGF0YSkgOiBkYXRhOwogICAgY29uc3QgY3Vyc29yID0gY3JlYXRlQ3Vyc29yKGJ5dGVzMik7CiAgICBpZiAoc2l6ZShieXRlczIpID09PSAwICYmIHBhcmFtcy5sZW5ndGggPiAwKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBpZiAoc2l6ZShkYXRhKSAmJiBzaXplKGRhdGEpIDwgMzIpCiAgICAgIHRocm93IG5ldyBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvcih7CiAgICAgICAgZGF0YTogdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciID8gZGF0YSA6IGJ5dGVzVG9IZXgoZGF0YSksCiAgICAgICAgcGFyYW1zLAogICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgfSk7CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWVzID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7ICsraSkgewogICAgICBjb25zdCBwYXJhbSA9IHBhcmFtc1tpXTsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKGNvbnN1bWVkKTsKICAgICAgY29uc3QgW2RhdGEyLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgcGFyYW0sIHsKICAgICAgICBzdGF0aWNQb3NpdGlvbjogMAogICAgICB9KTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgICB2YWx1ZXMucHVzaChkYXRhMik7CiAgICB9CiAgICByZXR1cm4gdmFsdWVzOwogIH0KICBmdW5jdGlvbiBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZGVjb2RlQXJyYXkoY3Vyc29yLCB7IC4uLnBhcmFtLCB0eXBlIH0sIHsgbGVuZ3RoLCBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gZGVjb2RlVHVwbGUoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIGlmIChwYXJhbS50eXBlID09PSAiYWRkcmVzcyIpCiAgICAgIHJldHVybiBkZWNvZGVBZGRyZXNzKGN1cnNvcik7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImJvb2wiKQogICAgICByZXR1cm4gZGVjb2RlQm9vbChjdXJzb3IpOwogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiYnl0ZXMiKSkKICAgICAgcmV0dXJuIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgcmV0dXJuIGRlY29kZU51bWJlcihjdXJzb3IsIHBhcmFtKTsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGRlY29kZVN0cmluZyhjdXJzb3IsIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICB0aHJvdyBuZXcgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yKHBhcmFtLnR5cGUsIHsKICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVBYmlQYXJhbWV0ZXJzIgogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGRlY29kZUFkZHJlc3MoY3Vyc29yKSB7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFtjaGVja3N1bUFkZHJlc3MoYnl0ZXNUb0hleChzbGljZUJ5dGVzKHZhbHVlLCAtMjApKSksIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlQXJyYXkoY3Vyc29yLCBwYXJhbSwgeyBsZW5ndGgsIHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGlmICghbGVuZ3RoKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3Qgc3RhcnRPZkRhdGEgPSBzdGFydCArIHNpemVPZkxlbmd0aDsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0KTsKICAgICAgY29uc3QgbGVuZ3RoMiA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZMZW5ndGgpKTsKICAgICAgY29uc3QgZHluYW1pY0NoaWxkID0gaGFzRHluYW1pY0NoaWxkKHBhcmFtKTsKICAgICAgbGV0IGNvbnN1bWVkMiA9IDA7CiAgICAgIGNvbnN0IHZhbHVlMiA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDI7ICsraSkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydE9mRGF0YSArIChkeW5hbWljQ2hpbGQgPyBpICogMzIgOiBjb25zdW1lZDIpKTsKICAgICAgICBjb25zdCBbZGF0YSwgY29uc3VtZWRfXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnRPZkRhdGEKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZDIgKz0gY29uc3VtZWRfOwogICAgICAgIHZhbHVlMi5wdXNoKGRhdGEpOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZTIsIDMyXTsKICAgIH0KICAgIGlmIChoYXNEeW5hbWljQ2hpbGQocGFyYW0pKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3QgdmFsdWUyID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhcnQgKyBpICogMzIpOwogICAgICAgIGNvbnN0IFtkYXRhXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICB2YWx1ZTIucHVzaChkYXRhKTsKICAgICAgfQogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbdmFsdWUyLCAzMl07CiAgICB9CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWUgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgY29uc3QgW2RhdGEsIGNvbnN1bWVkX10gPSBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgewogICAgICAgIHN0YXRpY1Bvc2l0aW9uOiBzdGF0aWNQb3NpdGlvbiArIGNvbnN1bWVkCiAgICAgIH0pOwogICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgIHZhbHVlLnB1c2goZGF0YSk7CiAgICB9CiAgICByZXR1cm4gW3ZhbHVlLCBjb25zdW1lZF07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJvb2woY3Vyc29yKSB7CiAgICByZXR1cm4gW2J5dGVzVG9Cb29sKGN1cnNvci5yZWFkQnl0ZXMoMzIpLCB7IHNpemU6IDMyIH0pLCAzMl07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSkgewogICAgY29uc3QgW18sIHNpemUzXSA9IHBhcmFtLnR5cGUuc3BsaXQoImJ5dGVzIik7CiAgICBpZiAoIXNpemUzKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyBvZmZzZXQpOwogICAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgICAgaWYgKGxlbmd0aCA9PT0gMCkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgICByZXR1cm4gWyIweCIsIDMyXTsKICAgICAgfQogICAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbYnl0ZXNUb0hleChkYXRhKSwgMzJdOwogICAgfQogICAgY29uc3QgdmFsdWUgPSBieXRlc1RvSGV4KGN1cnNvci5yZWFkQnl0ZXMoTnVtYmVyLnBhcnNlSW50KHNpemUzKSwgMzIpKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlTnVtYmVyKGN1cnNvciwgcGFyYW0pIHsKICAgIGNvbnN0IHNpZ25lZCA9IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50Iik7CiAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChwYXJhbS50eXBlLnNwbGl0KCJpbnQiKVsxXSB8fCAiMjU2Iik7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFsKICAgICAgc2l6ZTMgPiA0OCA/IGJ5dGVzVG9CaWdJbnQodmFsdWUsIHsgc2lnbmVkIH0pIDogYnl0ZXNUb051bWJlcih2YWx1ZSwgeyBzaWduZWQgfSksCiAgICAgIDMyCiAgICBdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVUdXBsZShjdXJzb3IsIHBhcmFtLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IGhhc1VubmFtZWRDaGlsZCA9IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoID09PSAwIHx8IHBhcmFtLmNvbXBvbmVudHMuc29tZSgoeyBuYW1lIH0pID0+ICFuYW1lKTsKICAgIGNvbnN0IHZhbHVlID0gaGFzVW5uYW1lZENoaWxkID8gW10gOiB7fTsKICAgIGxldCBjb25zdW1lZCA9IDA7CiAgICBpZiAoaGFzRHluYW1pY0NoaWxkKHBhcmFtKSkgewogICAgICBjb25zdCBvZmZzZXQgPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoc2l6ZU9mT2Zmc2V0KSk7CiAgICAgIGNvbnN0IHN0YXJ0ID0gc3RhdGljUG9zaXRpb24gKyBvZmZzZXQ7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW0uY29tcG9uZW50cy5sZW5ndGg7ICsraSkgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0ICsgY29uc3VtZWQpOwogICAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgICAgdmFsdWVbaGFzVW5uYW1lZENoaWxkID8gaSA6IGNvbXBvbmVudD8ubmFtZV0gPSBkYXRhOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZSwgMzJdOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbS5jb21wb25lbnRzLmxlbmd0aDsgKytpKSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgc3RhdGljUG9zaXRpb24KICAgICAgfSk7CiAgICAgIHZhbHVlW2hhc1VubmFtZWRDaGlsZCA/IGkgOiBjb21wb25lbnQ/Lm5hbWVdID0gZGF0YTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgfQogICAgcmV0dXJuIFt2YWx1ZSwgY29uc3VtZWRdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVTdHJpbmcoY3Vyc29yLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydCk7CiAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXRpY1Bvc2l0aW9uICsgMzIpOwogICAgICByZXR1cm4gWyIiLCAzMl07CiAgICB9CiAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgsIDMyKTsKICAgIGNvbnN0IHZhbHVlID0gYnl0ZXNUb1N0cmluZyh0cmltKGRhdGEpKTsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gaGFzRHluYW1pY0NoaWxkKHBhcmFtKSB7CiAgICBjb25zdCB7IHR5cGUgfSA9IHBhcmFtOwogICAgaWYgKHR5cGUgPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlLmVuZHNXaXRoKCJbXSIpKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gcGFyYW0uY29tcG9uZW50cz8uc29tZShoYXNEeW5hbWljQ2hpbGQpOwogICAgY29uc3QgYXJyYXlDb21wb25lbnRzID0gZ2V0QXJyYXlDb21wb25lbnRzKHBhcmFtLnR5cGUpOwogICAgaWYgKGFycmF5Q29tcG9uZW50cyAmJiBoYXNEeW5hbWljQ2hpbGQoeyAuLi5wYXJhbSwgdHlwZTogYXJyYXlDb21wb25lbnRzWzFdIH0pKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgdmFyIHNpemVPZkxlbmd0aCwgc2l6ZU9mT2Zmc2V0OwogIHZhciBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGluaXRfY3Vyc29yMigpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tQnl0ZXMoKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIHNpemVPZkxlbmd0aCA9IDMyOwogICAgICBzaXplT2ZPZmZzZXQgPSAzMjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVFcnJvclJlc3VsdC5qcwogIGZ1bmN0aW9uIGRlY29kZUVycm9yUmVzdWx0KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlID0gc2xpY2UoZGF0YSwgMCwgNCk7CiAgICBpZiAoc2lnbmF0dXJlID09PSAiMHgiKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBjb25zdCBhYmlfID0gWy4uLmFiaTIgfHwgW10sIHNvbGlkaXR5RXJyb3IsIHNvbGlkaXR5UGFuaWNdOwogICAgY29uc3QgYWJpSXRlbSA9IGFiaV8uZmluZCgoeCkgPT4geC50eXBlID09PSAiZXJyb3IiICYmIHNpZ25hdHVyZSA9PT0gdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKHgpKSk7CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVFcnJvclJlc3VsdCIKICAgICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmlJdGVtLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzICYmIGFiaUl0ZW0uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzLCBzbGljZShkYXRhLCA0KSkgOiB2b2lkIDAsCiAgICAgIGVycm9yTmFtZTogYWJpSXRlbS5uYW1lCiAgICB9OwogIH0KICB2YXIgaW5pdF9kZWNvZGVFcnJvclJlc3VsdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUVycm9yUmVzdWx0LmpzIigpIHsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X3NsaWNlKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zdHJpbmdpZnkuanMKICB2YXIgc3RyaW5naWZ5OwogIHZhciBpbml0X3N0cmluZ2lmeSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc3RyaW5naWZ5LmpzIigpIHsKICAgICAgc3RyaW5naWZ5ID0gKHZhbHVlLCByZXBsYWNlciwgc3BhY2UpID0+IEpTT04uc3RyaW5naWZ5KHZhbHVlLCAoa2V5LCB2YWx1ZV8pID0+IHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/IHZhbHVlXy50b1N0cmluZygpIDogdmFsdWVfOwogICAgICAgIHJldHVybiB0eXBlb2YgcmVwbGFjZXIgPT09ICJmdW5jdGlvbiIgPyByZXBsYWNlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7CiAgICAgIH0sIHNwYWNlKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoeyBhYmlJdGVtLCBhcmdzLCBpbmNsdWRlRnVuY3Rpb25OYW1lID0gdHJ1ZSwgaW5jbHVkZU5hbWUgPSBmYWxzZSB9KSB7CiAgICBpZiAoISgibmFtZSIgaW4gYWJpSXRlbSkpCiAgICAgIHJldHVybjsKICAgIGlmICghKCJpbnB1dHMiIGluIGFiaUl0ZW0pKQogICAgICByZXR1cm47CiAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICByZXR1cm47CiAgICByZXR1cm4gYCR7aW5jbHVkZUZ1bmN0aW9uTmFtZSA/IGFiaUl0ZW0ubmFtZSA6ICIifSgke2FiaUl0ZW0uaW5wdXRzLm1hcCgoaW5wdXQsIGkpID0+IGAke2luY2x1ZGVOYW1lICYmIGlucHV0Lm5hbWUgPyBgJHtpbnB1dC5uYW1lfTogYCA6ICIifSR7dHlwZW9mIGFyZ3NbaV0gPT09ICJvYmplY3QiID8gc3RyaW5naWZ5KGFyZ3NbaV0pIDogYXJnc1tpXX1gKS5qb2luKCIsICIpfSlgOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMiKCkgewogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3VuaXQuanMKICB2YXIgZXRoZXJVbml0cywgZ3dlaVVuaXRzLCB3ZWlVbml0czsKICB2YXIgaW5pdF91bml0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvdW5pdC5qcyIoKSB7CiAgICAgIGV0aGVyVW5pdHMgPSB7CiAgICAgICAgZ3dlaTogOSwKICAgICAgICB3ZWk6IDE4CiAgICAgIH07CiAgICAgIGd3ZWlVbml0cyA9IHsKICAgICAgICBldGhlcjogLTksCiAgICAgICAgd2VpOiA5CiAgICAgIH07CiAgICAgIHdlaVVuaXRzID0gewogICAgICAgIGV0aGVyOiAtMTgsCiAgICAgICAgZ3dlaTogLTkKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0VW5pdHMuanMKICBmdW5jdGlvbiBmb3JtYXRVbml0cyh2YWx1ZSwgZGVjaW1hbHMpIHsKICAgIGxldCBkaXNwbGF5ID0gdmFsdWUudG9TdHJpbmcoKTsKICAgIGNvbnN0IG5lZ2F0aXZlID0gZGlzcGxheS5zdGFydHNXaXRoKCItIik7CiAgICBpZiAobmVnYXRpdmUpCiAgICAgIGRpc3BsYXkgPSBkaXNwbGF5LnNsaWNlKDEpOwogICAgZGlzcGxheSA9IGRpc3BsYXkucGFkU3RhcnQoZGVjaW1hbHMsICIwIik7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uXSA9IFsKICAgICAgZGlzcGxheS5zbGljZSgwLCBkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKSwKICAgICAgZGlzcGxheS5zbGljZShkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKQogICAgXTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICByZXR1cm4gYCR7bmVnYXRpdmUgPyAiLSIgOiAiIn0ke2ludGVnZXIgfHwgIjAifSR7ZnJhY3Rpb24gPyBgLiR7ZnJhY3Rpb259YCA6ICIifWA7CiAgfQogIHZhciBpbml0X2Zvcm1hdFVuaXRzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdFVuaXRzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0RXRoZXIuanMKICBmdW5jdGlvbiBmb3JtYXRFdGhlcih3ZWksIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIGZvcm1hdFVuaXRzKHdlaSwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEV0aGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdEV0aGVyLmpzIigpIHsKICAgICAgaW5pdF91bml0KCk7CiAgICAgIGluaXRfZm9ybWF0VW5pdHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcwogIGZ1bmN0aW9uIGZvcm1hdEd3ZWkod2VpLCB1bml0ID0gIndlaSIpIHsKICAgIHJldHVybiBmb3JtYXRVbml0cyh3ZWksIGd3ZWlVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEd3ZWkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcyIoKSB7CiAgICAgIGluaXRfdW5pdCgpOwogICAgICBpbml0X2Zvcm1hdFVuaXRzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvc3RhdGVPdmVycmlkZS5qcwogIGZ1bmN0aW9uIHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZU1hcHBpbmcpIHsKICAgIHJldHVybiBzdGF0ZU1hcHBpbmcucmVkdWNlKChwcmV0dHksIHsgc2xvdCwgdmFsdWUgfSkgPT4gewogICAgICByZXR1cm4gYCR7cHJldHR5fSAgICAgICAgJHtzbG90fTogJHt2YWx1ZX0KYDsKICAgIH0sICIiKTsKICB9CiAgZnVuY3Rpb24gcHJldHR5U3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKSB7CiAgICByZXR1cm4gc3RhdGVPdmVycmlkZS5yZWR1Y2UoKHByZXR0eSwgeyBhZGRyZXNzLCAuLi5zdGF0ZSB9KSA9PiB7CiAgICAgIGxldCB2YWwgPSBgJHtwcmV0dHl9ICAgICR7YWRkcmVzc306CmA7CiAgICAgIGlmIChzdGF0ZS5ub25jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIG5vbmNlOiAke3N0YXRlLm5vbmNlfQpgOwogICAgICBpZiAoc3RhdGUuYmFsYW5jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIGJhbGFuY2U6ICR7c3RhdGUuYmFsYW5jZX0KYDsKICAgICAgaWYgKHN0YXRlLmNvZGUpCiAgICAgICAgdmFsICs9IGAgICAgICBjb2RlOiAke3N0YXRlLmNvZGV9CmA7CiAgICAgIGlmIChzdGF0ZS5zdGF0ZSkgewogICAgICAgIHZhbCArPSAiICAgICAgc3RhdGU6XG4iOwogICAgICAgIHZhbCArPSBwcmV0dHlTdGF0ZU1hcHBpbmcoc3RhdGUuc3RhdGUpOwogICAgICB9CiAgICAgIGlmIChzdGF0ZS5zdGF0ZURpZmYpIHsKICAgICAgICB2YWwgKz0gIiAgICAgIHN0YXRlRGlmZjpcbiI7CiAgICAgICAgdmFsICs9IHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZS5zdGF0ZURpZmYpOwogICAgICB9CiAgICAgIHJldHVybiB2YWw7CiAgICB9LCAiICBTdGF0ZSBPdmVycmlkZTpcbiIpLnNsaWNlKDAsIC0xKTsKICB9CiAgdmFyIEFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IsIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3I7CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWNjb3VudFN0YXRlQ29uZmxpY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTdGF0ZSBmb3IgYWNjb3VudCAiJHthZGRyZXNzfSIgaXMgc2V0IG11bHRpcGxlIHRpbWVzLmAsIHsKICAgICAgICAgICAgbmFtZTogIkFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoInN0YXRlIGFuZCBzdGF0ZURpZmYgYXJlIHNldCBvbiB0aGUgc2FtZSBhY2NvdW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIlN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdHJhbnNhY3Rpb24uanMKICBmdW5jdGlvbiBwcmV0dHlQcmludChhcmdzKSB7CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoYXJncykubWFwKChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgfHwgdmFsdWUgPT09IGZhbHNlKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gW2tleSwgdmFsdWVdOwogICAgfSkuZmlsdGVyKEJvb2xlYW4pOwogICAgY29uc3QgbWF4TGVuZ3RoID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2tleV0pID0+IE1hdGgubWF4KGFjYywga2V5Lmxlbmd0aCksIDApOwogICAgcmV0dXJuIGVudHJpZXMubWFwKChba2V5LCB2YWx1ZV0pID0+IGAgICR7YCR7a2V5fTpgLnBhZEVuZChtYXhMZW5ndGggKyAxKX0gICR7dmFsdWV9YCkuam9pbigiXG4iKTsKICB9CiAgdmFyIEZlZUNvbmZsaWN0RXJyb3IsIEludmFsaWRMZWdhY3lWRXJyb3IsIEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsIEludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yLCBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLCBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IsIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb24gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc2FjdGlvbi5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBGZWVDb25mbGljdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkNhbm5vdCBzcGVjaWZ5IGJvdGggYSBgZ2FzUHJpY2VgIGFuZCBhIGBtYXhGZWVQZXJHYXNgL2BtYXhQcmlvcml0eUZlZVBlckdhc2AuIiwKICAgICAgICAgICAgIlVzZSBgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGZvciBFSVAtMTU1OSBjb21wYXRpYmxlIG5ldHdvcmtzLCBhbmQgYGdhc1ByaWNlYCBmb3Igb3RoZXJzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiRmVlQ29uZmxpY3RFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkTGVnYWN5VkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHYgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgXGB2XGAgdmFsdWUgIiR7dn0iLiBFeHBlY3RlZCAyNyBvciAyOC5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkTGVnYWN5VkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXphYmxlVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0cmFuc2FjdGlvbiB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGluZmVyIGEgdHJhbnNhY3Rpb24gdHlwZSBmcm9tIHByb3ZpZGVkIHRyYW5zYWN0aW9uLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlByb3ZpZGVkIFRyYW5zYWN0aW9uOiIsCiAgICAgICAgICAgICAgInsiLAogICAgICAgICAgICAgIHByZXR0eVByaW50KHRyYW5zYWN0aW9uKSwKICAgICAgICAgICAgICAifSIsCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgIlRvIGluZmVyIHRoZSB0eXBlLCBlaXRoZXIgcHJvdmlkZToiLAogICAgICAgICAgICAgICItIGEgYHR5cGVgIHRvIHRoZSBUcmFuc2FjdGlvbiwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC0xNTU5IFRyYW5zYWN0aW9uIHdpdGggYG1heEZlZVBlckdhc2AsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtMjkzMCBUcmFuc2FjdGlvbiB3aXRoIGBnYXNQcmljZWAgJiBgYWNjZXNzTGlzdGAsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtNDg0NCBUcmFuc2FjdGlvbiB3aXRoIGBibG9ic2AsIGBibG9iVmVyc2lvbmVkSGFzaGVzYCwgYHNpZGVjYXJzYCwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC03NzAyIFRyYW5zYWN0aW9uIHdpdGggYGF1dGhvcml6YXRpb25MaXN0YCwgb3IiLAogICAgICAgICAgICAgICItIGEgTGVnYWN5IFRyYW5zYWN0aW9uIHdpdGggYGdhc1ByaWNlYCIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNlcmlhbGl6ZWRUeXBlIH0pIHsKICAgICAgICAgIHN1cGVyKGBTZXJpYWxpemVkIHRyYW5zYWN0aW9uIHR5cGUgIiR7c2VyaWFsaXplZFR5cGV9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUeXBlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFR5cGUgPSBzZXJpYWxpemVkVHlwZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhdHRyaWJ1dGVzLCBzZXJpYWxpemVkVHJhbnNhY3Rpb24sIHR5cGUgfSkgewogICAgICAgICAgY29uc3QgbWlzc2luZyA9IE9iamVjdC5lbnRyaWVzKGF0dHJpYnV0ZXMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB0eXBlb2YgdmFsdWUgPT09ICJ1bmRlZmluZWQiID8ga2V5IDogdm9pZCAwKS5maWx0ZXIoQm9vbGVhbik7CiAgICAgICAgICBzdXBlcihgSW52YWxpZCBzZXJpYWxpemVkIHRyYW5zYWN0aW9uIG9mIHR5cGUgIiR7dHlwZX0iIHdhcyBwcm92aWRlZC5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBTZXJpYWxpemVkIFRyYW5zYWN0aW9uOiAiJHtzZXJpYWxpemVkVHJhbnNhY3Rpb259ImAsCiAgICAgICAgICAgICAgbWlzc2luZy5sZW5ndGggPiAwID8gYE1pc3NpbmcgQXR0cmlidXRlczogJHttaXNzaW5nLmpvaW4oIiwgIil9YCA6ICIiCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUcmFuc2FjdGlvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInR5cGUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBzZXJpYWxpemVkVHJhbnNhY3Rpb247CiAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc3RvcmFnZUtleSB9KSB7CiAgICAgICAgICBzdXBlcihgU2l6ZSBmb3Igc3RvcmFnZSBrZXkgIiR7c3RvcmFnZUtleX0iIGlzIGludmFsaWQuIEV4cGVjdGVkIDMyIGJ5dGVzLiBHb3QgJHtNYXRoLmZsb29yKChzdG9yYWdlS2V5Lmxlbmd0aCAtIDIpIC8gMil9IGJ5dGVzLmAsIHsgbmFtZTogIkludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGNoYWluLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlIH0pIHsKICAgICAgICAgIGNvbnN0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGNoYWluOiBjaGFpbiAmJiBgJHtjaGFpbj8ubmFtZX0gKGlkOiAke2NoYWluPy5pZH0pYCwKICAgICAgICAgICAgZnJvbTogYWNjb3VudD8uYWRkcmVzcywKICAgICAgICAgICAgdG8sCiAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgdmFsdWUgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEV0aGVyKHZhbHVlKX0gJHtjaGFpbj8ubmF0aXZlQ3VycmVuY3k/LnN5bWJvbCB8fCAiRVRIIn1gLAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBnYXMsCiAgICAgICAgICAgIGdhc1ByaWNlOiB0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEd3ZWkoZ2FzUHJpY2UpfSBnd2VpYCwKICAgICAgICAgICAgbWF4RmVlUGVyR2FzOiB0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heEZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgICAgIG5vbmNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgLi4uY2F1c2UubWV0YU1lc3NhZ2VzID8gWy4uLmNhdXNlLm1ldGFNZXNzYWdlcywgIiAiXSA6IFtdLAogICAgICAgICAgICAgICJSZXF1ZXN0IEFyZ3VtZW50czoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2F1c2UgPSBjYXVzZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgICAgICAgbGV0IGlkZW50aWZpZXIgPSAiVHJhbnNhY3Rpb24iOwogICAgICAgICAgaWYgKGJsb2NrVGFnICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIHRpbWUgIiR7YmxvY2tUYWd9IiBhdCBpbmRleCAiJHtpbmRleDJ9ImA7CiAgICAgICAgICBpZiAoYmxvY2tIYXNoICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIGhhc2ggIiR7YmxvY2tIYXNofSIgYXQgaW5kZXggIiR7aW5kZXgyfSJgOwogICAgICAgICAgaWYgKGJsb2NrTnVtYmVyICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIG51bWJlciAiJHtibG9ja051bWJlcn0iIGF0IGluZGV4ICIke2luZGV4Mn0iYDsKICAgICAgICAgIGlmIChoYXNoMykKICAgICAgICAgICAgaWRlbnRpZmllciA9IGBUcmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9ImA7CiAgICAgICAgICBzdXBlcihgJHtpZGVudGlmaWVyfSBjb3VsZCBub3QgYmUgZm91bmQuYCwgewogICAgICAgICAgICBuYW1lOiAiVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzIH0pIHsKICAgICAgICAgIHN1cGVyKGBUcmFuc2FjdGlvbiByZWNlaXB0IHdpdGggaGFzaCAiJHtoYXNoM30iIGNvdWxkIG5vdCBiZSBmb3VuZC4gVGhlIFRyYW5zYWN0aW9uIG1heSBub3QgYmUgcHJvY2Vzc2VkIG9uIGEgYmxvY2sgeWV0LmAsIHsKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMgfSkgewogICAgICAgICAgc3VwZXIoYFRpbWVkIG91dCB3aGlsZSB3YWl0aW5nIGZvciB0cmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9IiB0byBiZSBjb25maXJtZWQuYCwgeyBuYW1lOiAiV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzCiAgdmFyIGdldENvbnRyYWN0QWRkcmVzcywgZ2V0VXJsOwogIHZhciBpbml0X3V0aWxzMyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzIigpIHsKICAgICAgZ2V0Q29udHJhY3RBZGRyZXNzID0gKGFkZHJlc3MpID0+IGFkZHJlc3M7CiAgICAgIGdldFVybCA9ICh1cmwpID0+IHVybDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jb250cmFjdC5qcwogIHZhciBDYWxsRXhlY3V0aW9uRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25FeGVjdXRpb25FcnJvciwgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25aZXJvRGF0YUVycm9yLCBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciwgUmF3Q29udHJhY3RFcnJvcjsKICB2YXIgaW5pdF9jb250cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NvbnRyYWN0LmpzIigpIHsKICAgICAgaW5pdF9wYXJzZUFjY291bnQoKTsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBDYWxsRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQ6IGFjY291bnRfLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBjaGFpbiwgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSB9KSB7CiAgICAgICAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgICAgICAgbGV0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgIHRvLAogICAgICAgICAgICB2YWx1ZTogdHlwZW9mIHZhbHVlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRFdGhlcih2YWx1ZSl9ICR7Y2hhaW4/Lm5hdGl2ZUN1cnJlbmN5Py5zeW1ib2wgfHwgIkVUSCJ9YCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgZ2FzLAogICAgICAgICAgICBnYXNQcmljZTogdHlwZW9mIGdhc1ByaWNlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKGdhc1ByaWNlKX0gZ3dlaWAsCiAgICAgICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXM6IHR5cGVvZiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhQcmlvcml0eUZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBub25jZQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoc3RhdGVPdmVycmlkZSkgewogICAgICAgICAgICBwcmV0dHlBcmdzICs9IGAKJHtwcmV0dHlTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpfWA7CiAgICAgICAgICB9CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIC4uLmNhdXNlLm1ldGFNZXNzYWdlcyA/IFsuLi5jYXVzZS5tZXRhTWVzc2FnZXMsICIgIl0gOiBbXSwKICAgICAgICAgICAgICAiUmF3IENhbGwgQXJndW1lbnRzOiIsCiAgICAgICAgICAgICAgcHJldHR5QXJncwogICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKSwKICAgICAgICAgICAgbmFtZTogIkNhbGxFeGVjdXRpb25FcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFiaTogYWJpMiwgYXJncywgY29udHJhY3RBZGRyZXNzLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBmdW5jdGlvbk5hbWUsIHNlbmRlciB9KSB7CiAgICAgICAgICBjb25zdCBhYmlJdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICAgICAgY29uc3QgZm9ybWF0dGVkQXJncyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoewogICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICBhcmdzLAogICAgICAgICAgICBpbmNsdWRlRnVuY3Rpb25OYW1lOiBmYWxzZSwKICAgICAgICAgICAgaW5jbHVkZU5hbWU6IGZhbHNlCiAgICAgICAgICB9KSA6IHZvaWQgMDsKICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uV2l0aFBhcmFtcyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pIDogdm9pZCAwOwogICAgICAgICAgY29uc3QgcHJldHR5QXJncyA9IHByZXR0eVByaW50KHsKICAgICAgICAgICAgYWRkcmVzczogY29udHJhY3RBZGRyZXNzICYmIGdldENvbnRyYWN0QWRkcmVzcyhjb250cmFjdEFkZHJlc3MpLAogICAgICAgICAgICBmdW5jdGlvbjogZnVuY3Rpb25XaXRoUGFyYW1zLAogICAgICAgICAgICBhcmdzOiBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgJiYgYCR7Wy4uLkFycmF5KGZ1bmN0aW9uTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAsCiAgICAgICAgICAgIHNlbmRlcgogICAgICAgICAgfSk7CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UgfHwgYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZXhlY3V0aW5nIHRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9Ii5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAgICAgcHJldHR5QXJncyAmJiAiQ29udHJhY3QgQ2FsbDoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWJpIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29udHJhY3RBZGRyZXNzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZm9ybWF0dGVkQXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImZ1bmN0aW9uTmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlbmRlciIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaSA9IGFiaTI7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzOwogICAgICAgICAgdGhpcy5jYXVzZSA9IGNhdXNlOwogICAgICAgICAgdGhpcy5jb250cmFjdEFkZHJlc3MgPSBjb250cmFjdEFkZHJlc3M7CiAgICAgICAgICB0aGlzLmZ1bmN0aW9uTmFtZSA9IGZ1bmN0aW9uTmFtZTsKICAgICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYWJpOiBhYmkyLCBkYXRhLCBmdW5jdGlvbk5hbWUsIG1lc3NhZ2UgfSkgewogICAgICAgICAgbGV0IGNhdXNlOwogICAgICAgICAgbGV0IGRlY29kZWREYXRhID0gdm9pZCAwOwogICAgICAgICAgbGV0IG1ldGFNZXNzYWdlczsKICAgICAgICAgIGxldCByZWFzb247CiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhICE9PSAiMHgiKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZGVjb2RlZERhdGEgPSBkZWNvZGVFcnJvclJlc3VsdCh7IGFiaTogYWJpMiwgZGF0YSB9KTsKICAgICAgICAgICAgICBjb25zdCB7IGFiaUl0ZW0sIGVycm9yTmFtZSwgYXJnczogZXJyb3JBcmdzIH0gPSBkZWNvZGVkRGF0YTsKICAgICAgICAgICAgICBpZiAoZXJyb3JOYW1lID09PSAiRXJyb3IiKSB7CiAgICAgICAgICAgICAgICByZWFzb24gPSBlcnJvckFyZ3NbMF07CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvck5hbWUgPT09ICJQYW5pYyIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFtmaXJzdEFyZ10gPSBlcnJvckFyZ3M7CiAgICAgICAgICAgICAgICByZWFzb24gPSBwYW5pY1JlYXNvbnNbZmlyc3RBcmddOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zdCBlcnJvcldpdGhQYXJhbXMgPSBhYmlJdGVtID8gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZTogdHJ1ZSB9KSA6IHZvaWQgMDsKICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEFyZ3MgPSBhYmlJdGVtICYmIGVycm9yQXJncyA/IGZvcm1hdEFiaUl0ZW1XaXRoQXJncyh7CiAgICAgICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgICAgIGFyZ3M6IGVycm9yQXJncywKICAgICAgICAgICAgICAgICAgaW5jbHVkZUZ1bmN0aW9uTmFtZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVOYW1lOiBmYWxzZQogICAgICAgICAgICAgICAgfSkgOiB2b2lkIDA7CiAgICAgICAgICAgICAgICBtZXRhTWVzc2FnZXMgPSBbCiAgICAgICAgICAgICAgICAgIGVycm9yV2l0aFBhcmFtcyA/IGBFcnJvcjogJHtlcnJvcldpdGhQYXJhbXN9YCA6ICIiLAogICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgPyBgICAgICAgICR7Wy4uLkFycmF5KGVycm9yTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAgOiAiIgogICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIGNhdXNlID0gZXJyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UpCiAgICAgICAgICAgIHJlYXNvbiA9IG1lc3NhZ2U7CiAgICAgICAgICBsZXQgc2lnbmF0dXJlOwogICAgICAgICAgaWYgKGNhdXNlIGluc3RhbmNlb2YgQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yKSB7CiAgICAgICAgICAgIHNpZ25hdHVyZSA9IGNhdXNlLnNpZ25hdHVyZTsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzID0gWwogICAgICAgICAgICAgIGBVbmFibGUgdG8gZGVjb2RlIHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBhcyBpdCB3YXMgbm90IGZvdW5kIG9uIHRoZSBwcm92aWRlZCBBQkkuYCwKICAgICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBlcnJvciBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBkZWNvZGVkIHNpZ25hdHVyZSBoZXJlOiBodHRwczovL29wZW5jaGFpbi54eXovc2lnbmF0dXJlcz9xdWVyeT0ke3NpZ25hdHVyZX0uYAogICAgICAgICAgICBdOwogICAgICAgICAgfQogICAgICAgICAgc3VwZXIocmVhc29uICYmIHJlYXNvbiAhPT0gImV4ZWN1dGlvbiByZXZlcnRlZCIgfHwgc2lnbmF0dXJlID8gWwogICAgICAgICAgICBgVGhlIGNvbnRyYWN0IGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iIHJldmVydGVkIHdpdGggdGhlIGZvbGxvd2luZyAke3NpZ25hdHVyZSA/ICJzaWduYXR1cmUiIDogInJlYXNvbiJ9OmAsCiAgICAgICAgICAgIHJlYXNvbiB8fCBzaWduYXR1cmUKICAgICAgICAgIF0uam9pbigiXG4iKSA6IGBUaGUgY29udHJhY3QgZnVuY3Rpb24gIiR7ZnVuY3Rpb25OYW1lfSIgcmV2ZXJ0ZWQuYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzLAogICAgICAgICAgICBuYW1lOiAiQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInJlYXNvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNpZ25hdHVyZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBkZWNvZGVkRGF0YTsKICAgICAgICAgIHRoaXMucmVhc29uID0gcmVhc29uOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBmdW5jdGlvbk5hbWUgfSkgewogICAgICAgICAgc3VwZXIoYFRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiByZXR1cm5lZCBubyBkYXRhICgiMHgiKS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgICJUaGlzIGNvdWxkIGJlIGR1ZSB0byBhbnkgb2YgdGhlIGZvbGxvd2luZzoiLAogICAgICAgICAgICAgIGAgIC0gVGhlIGNvbnRyYWN0IGRvZXMgbm90IGhhdmUgdGhlIGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iLGAsCiAgICAgICAgICAgICAgIiAgLSBUaGUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhlIGNvbnRyYWN0IGZ1bmN0aW9uIG1heSBiZSBpbnZhbGlkLCBvciIsCiAgICAgICAgICAgICAgIiAgLSBUaGUgYWRkcmVzcyBpcyBub3QgYSBjb250cmFjdC4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZmFjdG9yeSB9KSB7CiAgICAgICAgICBzdXBlcihgRGVwbG95bWVudCBmb3IgY291bnRlcmZhY3R1YWwgY29udHJhY3QgY2FsbCBmYWlsZWQke2ZhY3RvcnkgPyBgIGZvciBmYWN0b3J5ICIke2ZhY3Rvcnl9Ii5gIDogIiJ9YCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiUGxlYXNlIGVuc3VyZToiLAogICAgICAgICAgICAgICItIFRoZSBgZmFjdG9yeWAgaXMgYSB2YWxpZCBjb250cmFjdCBkZXBsb3ltZW50IGZhY3RvcnkgKGllLiBDcmVhdGUyIEZhY3RvcnksIEVSQy00MzM3IEZhY3RvcnksIGV0YykuIiwKICAgICAgICAgICAgICAiLSBUaGUgYGZhY3RvcnlEYXRhYCBpcyBhIHZhbGlkIGVuY29kZWQgZnVuY3Rpb24gY2FsbCBmb3IgY29udHJhY3QgZGVwbG95bWVudCBmdW5jdGlvbiBvbiB0aGUgZmFjdG9yeS4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgUmF3Q29udHJhY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBkYXRhLCBtZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UgfHwgIiIsIHsgbmFtZTogIlJhd0NvbnRyYWN0RXJyb3IiIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjb2RlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogMwogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcwogIHZhciBIdHRwUmVxdWVzdEVycm9yLCBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IsIFJwY1JlcXVlc3RFcnJvciwgU29ja2V0Q2xvc2VkRXJyb3IsIFRpbWVvdXRFcnJvcjsKICB2YXIgaW5pdF9yZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfc3RyaW5naWZ5KCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBIdHRwUmVxdWVzdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGJvZHksIGNhdXNlLCBkZXRhaWxzLCBoZWFkZXJzLCBzdGF0dXMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiSFRUUCByZXF1ZXN0IGZhaWxlZC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkZXRhaWxzLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBzdGF0dXMgJiYgYFN0YXR1czogJHtzdGF0dXN9YCwKICAgICAgICAgICAgICBgVVJMOiAke2dldFVybCh1cmwpfWAsCiAgICAgICAgICAgICAgYm9keSAmJiBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSHR0cFJlcXVlc3RFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJib2R5IiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaGVhZGVycyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInN0YXR1cyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInVybCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmJvZHkgPSBib2R5OwogICAgICAgICAgdGhpcy5oZWFkZXJzID0gaGVhZGVyczsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICAgICAgdGhpcy51cmwgPSB1cmw7CiAgICAgICAgfQogICAgICB9OwogICAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYm9keSwgY2F1c2UsIGRldGFpbHMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiV2ViU29ja2V0IHJlcXVlc3QgZmFpbGVkLiIsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRldGFpbHMsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBVUkw6ICR7Z2V0VXJsKHVybCl9YCwKICAgICAgICAgICAgICBib2R5ICYmIGBSZXF1ZXN0IGJvZHk6ICR7c3RyaW5naWZ5KGJvZHkpfWAKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJXZWJTb2NrZXRSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJwY1JlcXVlc3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCBlcnJvciwgdXJsIH0pIHsKICAgICAgICAgIHN1cGVyKCJSUEMgUmVxdWVzdCBmYWlsZWQuIiwgewogICAgICAgICAgICBjYXVzZTogZXJyb3IsCiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BVUkw6ICR7Z2V0VXJsKHVybCl9YCwgYFJlcXVlc3QgYm9keTogJHtzdHJpbmdpZnkoYm9keSl9YF0sCiAgICAgICAgICAgIG5hbWU6ICJScGNSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNvZGUgPSBlcnJvci5jb2RlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgU29ja2V0Q2xvc2VkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgdXJsIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoIlRoZSBzb2NrZXQgaGFzIGJlZW4gY2xvc2VkLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbdXJsICYmIGBVUkw6ICR7Z2V0VXJsKHVybCl9YF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiU29ja2V0Q2xvc2VkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRpbWVvdXRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCB1cmwgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSByZXF1ZXN0IHRvb2sgdG9vIGxvbmcgdG8gcmVzcG9uZC4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6ICJUaGUgcmVxdWVzdCB0aW1lZCBvdXQuIiwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYFVSTDogJHtnZXRVcmwodXJsKX1gLCBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gXSwKICAgICAgICAgICAgbmFtZTogIlRpbWVvdXRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMKICB2YXIgdW5rbm93bkVycm9yQ29kZSwgUnBjRXJyb3IsIFByb3ZpZGVyUnBjRXJyb3IsIFBhcnNlUnBjRXJyb3IsIEludmFsaWRSZXF1ZXN0UnBjRXJyb3IsIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IsIEludmFsaWRQYXJhbXNScGNFcnJvciwgSW50ZXJuYWxScGNFcnJvciwgSW52YWxpZElucHV0UnBjRXJyb3IsIFJlc291cmNlTm90Rm91bmRScGNFcnJvciwgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLCBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yLCBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IsIEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLCBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IsIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsIENoYWluRGlzY29ubmVjdGVkRXJyb3IsIFN3aXRjaENoYWluRXJyb3IsIFVua25vd25ScGNFcnJvcjsKICB2YXIgaW5pdF9ycGMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIHVua25vd25FcnJvckNvZGUgPSAtMTsKICAgICAgUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGNvZGUsIGRvY3NQYXRoOiBkb2NzUGF0aDksIG1ldGFNZXNzYWdlcywgbmFtZSwgc2hvcnRNZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKHNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBtZXRhTWVzc2FnZXMgfHwgY2F1c2U/Lm1ldGFNZXNzYWdlcywKICAgICAgICAgICAgbmFtZTogbmFtZSB8fCAiUnBjRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lIHx8IGNhdXNlLm5hbWU7CiAgICAgICAgICB0aGlzLmNvZGUgPSBjYXVzZSBpbnN0YW5jZW9mIFJwY1JlcXVlc3RFcnJvciA/IGNhdXNlLmNvZGUgOiBjb2RlID8/IHVua25vd25FcnJvckNvZGU7CiAgICAgICAgfQogICAgICB9OwogICAgICBQcm92aWRlclJwY0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIG9wdGlvbnMpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCBvcHRpb25zKTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBvcHRpb25zLmRhdGE7CiAgICAgICAgfQogICAgICB9OwogICAgICBQYXJzZVJwY0Vycm9yID0gY2xhc3MgX1BhcnNlUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9QYXJzZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJQYXJzZVJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSW52YWxpZCBKU09OIHdhcyByZWNlaXZlZCBieSB0aGUgc2VydmVyLiBBbiBlcnJvciBvY2N1cnJlZCBvbiB0aGUgc2VydmVyIHdoaWxlIHBhcnNpbmcgdGhlIEpTT04gdGV4dC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZVJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNzAwCiAgICAgIH0pOwogICAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRSZXF1ZXN0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkUmVxdWVzdFJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkUmVxdWVzdFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSlNPTiBpcyBub3QgYSB2YWxpZCByZXF1ZXN0IG9iamVjdC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNjAwCiAgICAgIH0pOwogICAgICBNZXRob2ROb3RGb3VuZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIHsgbWV0aG9kIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIk1ldGhvZE5vdEZvdW5kUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgbWV0aG9kJHttZXRob2QgPyBgICIke21ldGhvZH0iYCA6ICIifSBkb2VzIG5vdCBleGlzdCAvIGlzIG5vdCBhdmFpbGFibGUuYAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWV0aG9kTm90Rm91bmRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMQogICAgICB9KTsKICAgICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRQYXJhbXNScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludmFsaWRQYXJhbXNScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiBbCiAgICAgICAgICAgICAgIkludmFsaWQgcGFyYW1ldGVycyB3ZXJlIHByb3ZpZGVkIHRvIHRoZSBSUEMgbWV0aG9kLiIsCiAgICAgICAgICAgICAgIkRvdWJsZSBjaGVjayB5b3UgaGF2ZSBwcm92aWRlZCB0aGUgY29ycmVjdCBwYXJhbWV0ZXJzLiIKICAgICAgICAgICAgXS5qb2luKCJcbiIpCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUGFyYW1zUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzI2MDIKICAgICAgfSk7CiAgICAgIEludGVybmFsUnBjRXJyb3IgPSBjbGFzcyBfSW50ZXJuYWxScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludGVybmFsUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkludGVybmFsUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBpbnRlcm5hbCBlcnJvciB3YXMgcmVjZWl2ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZXJuYWxScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMwogICAgICB9KTsKICAgICAgSW52YWxpZElucHV0UnBjRXJyb3IgPSBjbGFzcyBfSW52YWxpZElucHV0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkSW5wdXRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZElucHV0UnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IFsKICAgICAgICAgICAgICAiTWlzc2luZyBvciBpbnZhbGlkIHBhcmFtZXRlcnMuIiwKICAgICAgICAgICAgICAiRG91YmxlIGNoZWNrIHlvdSBoYXZlIHByb3ZpZGVkIHRoZSBjb3JyZWN0IHBhcmFtZXRlcnMuIgogICAgICAgICAgICBdLmpvaW4oIlxuIikKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludmFsaWRJbnB1dFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyZTMKICAgICAgfSk7CiAgICAgIFJlc291cmNlTm90Rm91bmRScGNFcnJvciA9IGNsYXNzIF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlJlc291cmNlTm90Rm91bmRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlJlcXVlc3RlZCByZXNvdXJjZSBub3QgZm91bmQuIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDAxCiAgICAgIH0pOwogICAgICBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IgPSBjbGFzcyBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJSZXF1ZXN0ZWQgcmVzb3VyY2Ugbm90IGF2YWlsYWJsZS4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDIKICAgICAgfSk7CiAgICAgIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciA9IGNsYXNzIF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRyYW5zYWN0aW9uIGNyZWF0aW9uIGZhaWxlZC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDMKICAgICAgfSk7CiAgICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IG1ldGhvZCB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9NZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBNZXRob2Qke21ldGhvZCA/IGAgIiR7bWV0aG9kfSJgIDogIiJ9IGlzIG5vdCBpbXBsZW1lbnRlZC5gCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjAwNAogICAgICB9KTsKICAgICAgTGltaXRFeGNlZWRlZFJwY0Vycm9yID0gY2xhc3MgX0xpbWl0RXhjZWVkZWRScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0xpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTGltaXRFeGNlZWRlZFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiUmVxdWVzdCBleGNlZWRzIGRlZmluZWQgbGltaXQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGltaXRFeGNlZWRlZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA1CiAgICAgIH0pOwogICAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJWZXJzaW9uIG9mIEpTT04tUlBDIHByb3RvY29sIGlzIG5vdCBzdXBwb3J0ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA2CiAgICAgIH0pOwogICAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBfVXNlclJlamVjdGVkUmVxdWVzdEVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9Vc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlVzZXIgcmVqZWN0ZWQgdGhlIHJlcXVlc3QuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogNDAwMQogICAgICB9KTsKICAgICAgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciA9IGNsYXNzIF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiVGhlIHJlcXVlc3RlZCBtZXRob2QgYW5kL29yIGFjY291bnQgaGFzIG5vdCBiZWVuIGF1dGhvcml6ZWQgYnkgdGhlIHVzZXIuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQxMDAKICAgICAgfSk7CiAgICAgIFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciA9IGNsYXNzIF9VbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSwgeyBtZXRob2QgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgUHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgcmVxdWVzdGVkIG1ldGhvZCR7bWV0aG9kID8gYCAiICR7bWV0aG9kfSJgIDogIiJ9LmAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQyMDAKICAgICAgfSk7CiAgICAgIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IgPSBjbGFzcyBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciBleHRlbmRzIFByb3ZpZGVyUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRoZSBQcm92aWRlciBpcyBkaXNjb25uZWN0ZWQgZnJvbSBhbGwgY2hhaW5zLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAwCiAgICAgIH0pOwogICAgICBDaGFpbkRpc2Nvbm5lY3RlZEVycm9yID0gY2xhc3MgX0NoYWluRGlzY29ubmVjdGVkRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0NoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkNoYWluRGlzY29ubmVjdGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJUaGUgUHJvdmlkZXIgaXMgbm90IGNvbm5lY3RlZCB0byB0aGUgcmVxdWVzdGVkIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENoYWluRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAxCiAgICAgIH0pOwogICAgICBTd2l0Y2hDaGFpbkVycm9yID0gY2xhc3MgX1N3aXRjaENoYWluRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX1N3aXRjaENoYWluRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlN3aXRjaENoYWluRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGF0dGVtcHRpbmcgdG8gc3dpdGNoIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN3aXRjaENoYWluRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAyCiAgICAgIH0pOwogICAgICBVbmtub3duUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgbmFtZTogIlVua25vd25ScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIkFuIHVua25vd24gUlBDIGVycm9yIG9jY3VycmVkLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL19tZC5qcwogIGZ1bmN0aW9uIHNldEJpZ1VpbnQ2NCh2aWV3LCBieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpIHsKICAgIGlmICh0eXBlb2Ygdmlldy5zZXRCaWdVaW50NjQgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiB2aWV3LnNldEJpZ1VpbnQ2NChieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpOwogICAgY29uc3QgXzMybjIgPSBCaWdJbnQoMzIpOwogICAgY29uc3QgX3UzMl9tYXggPSBCaWdJbnQoNDI5NDk2NzI5NSk7CiAgICBjb25zdCB3aCA9IE51bWJlcih2YWx1ZSA+PiBfMzJuMiAmIF91MzJfbWF4KTsKICAgIGNvbnN0IHdsID0gTnVtYmVyKHZhbHVlICYgX3UzMl9tYXgpOwogICAgY29uc3QgaCA9IGlzTEUyID8gNCA6IDA7CiAgICBjb25zdCBsID0gaXNMRTIgPyAwIDogNDsKICAgIHZpZXcuc2V0VWludDMyKGJ5dGVPZmZzZXQgKyBoLCB3aCwgaXNMRTIpOwogICAgdmlldy5zZXRVaW50MzIoYnl0ZU9mZnNldCArIGwsIHdsLCBpc0xFMik7CiAgfQogIHZhciBDaGksIE1haiwgSGFzaE1EOwogIHZhciBpbml0X21kID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fbWQuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBDaGkgPSAoYSwgYiwgYykgPT4gYSAmIGIgXiB+YSAmIGM7CiAgICAgIE1haiA9IChhLCBiLCBjKSA9PiBhICYgYiBeIGEgJiBjIF4gYiAmIGM7CiAgICAgIEhhc2hNRCA9IGNsYXNzIGV4dGVuZHMgSGFzaCB7CiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIG91dHB1dExlbiwgcGFkT2Zmc2V0LCBpc0xFMikgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSBibG9ja0xlbjsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5wYWRPZmZzZXQgPSBwYWRPZmZzZXQ7CiAgICAgICAgICB0aGlzLmlzTEUgPSBpc0xFMjsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubGVuZ3RoID0gMDsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGJsb2NrTGVuKTsKICAgICAgICAgIHRoaXMudmlldyA9IGNyZWF0ZVZpZXcodGhpcy5idWZmZXIpOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyB2aWV3LCBidWZmZXI6IGJ1ZmZlcjIsIGJsb2NrTGVuIH0gPSB0aGlzOwogICAgICAgICAgZGF0YSA9IHRvQnl0ZXMyKGRhdGEpOwogICAgICAgICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7CiAgICAgICAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47ICkgewogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvcywgbGVuIC0gcG9zKTsKICAgICAgICAgICAgaWYgKHRha2UgPT09IGJsb2NrTGVuKSB7CiAgICAgICAgICAgICAgY29uc3QgZGF0YVZpZXcgPSBjcmVhdGVWaWV3KGRhdGEpOwogICAgICAgICAgICAgIGZvciAoOyBibG9ja0xlbiA8PSBsZW4gLSBwb3M7IHBvcyArPSBibG9ja0xlbikKICAgICAgICAgICAgICAgIHRoaXMucHJvY2VzcyhkYXRhVmlldywgcG9zKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWZmZXIyLnNldChkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgdGFrZSksIHRoaXMucG9zKTsKICAgICAgICAgICAgdGhpcy5wb3MgKz0gdGFrZTsKICAgICAgICAgICAgcG9zICs9IHRha2U7CiAgICAgICAgICAgIGlmICh0aGlzLnBvcyA9PT0gYmxvY2tMZW4pIHsKICAgICAgICAgICAgICB0aGlzLnByb2Nlc3ModmlldywgMCk7CiAgICAgICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmxlbmd0aCArPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIHRoaXMucm91bmRDbGVhbigpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdEludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcyk7CiAgICAgICAgICBvdXRwdXQob3V0LCB0aGlzKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlOwogICAgICAgICAgY29uc3QgeyBidWZmZXI6IGJ1ZmZlcjIsIHZpZXcsIGJsb2NrTGVuLCBpc0xFOiBpc0xFMiB9ID0gdGhpczsKICAgICAgICAgIGxldCB7IHBvcyB9ID0gdGhpczsKICAgICAgICAgIGJ1ZmZlcjJbcG9zKytdID0gMTI4OwogICAgICAgICAgdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zKS5maWxsKDApOwogICAgICAgICAgaWYgKHRoaXMucGFkT2Zmc2V0ID4gYmxvY2tMZW4gLSBwb3MpIHsKICAgICAgICAgICAgdGhpcy5wcm9jZXNzKHZpZXcsIDApOwogICAgICAgICAgICBwb3MgPSAwOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChsZXQgaSA9IHBvczsgaSA8IGJsb2NrTGVuOyBpKyspCiAgICAgICAgICAgIGJ1ZmZlcjJbaV0gPSAwOwogICAgICAgICAgc2V0QmlnVWludDY0KHZpZXcsIGJsb2NrTGVuIC0gOCwgQmlnSW50KHRoaXMubGVuZ3RoICogOCksIGlzTEUyKTsKICAgICAgICAgIHRoaXMucHJvY2Vzcyh2aWV3LCAwKTsKICAgICAgICAgIGNvbnN0IG92aWV3ID0gY3JlYXRlVmlldyhvdXQpOwogICAgICAgICAgY29uc3QgbGVuID0gdGhpcy5vdXRwdXRMZW47CiAgICAgICAgICBpZiAobGVuICUgNCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIHNob3VsZCBiZSBhbGlnbmVkIHRvIDMyYml0Iik7CiAgICAgICAgICBjb25zdCBvdXRMZW4gPSBsZW4gLyA0OwogICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLmdldCgpOwogICAgICAgICAgaWYgKG91dExlbiA+IHN0YXRlLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIGJpZ2dlciB0aGFuIHN0YXRlIik7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG91dExlbjsgaSsrKQogICAgICAgICAgICBvdmlldy5zZXRVaW50MzIoNCAqIGksIHN0YXRlW2ldLCBpc0xFMik7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdCgpIHsKICAgICAgICAgIGNvbnN0IHsgYnVmZmVyOiBidWZmZXIyLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8oYnVmZmVyMik7CiAgICAgICAgICBjb25zdCByZXMgPSBidWZmZXIyLnNsaWNlKDAsIG91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRlc3Ryb3koKTsKICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkpOwogICAgICAgICAgdG8uc2V0KC4uLnRoaXMuZ2V0KCkpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgYnVmZmVyOiBidWZmZXIyLCBsZW5ndGgsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIHBvcyB9ID0gdGhpczsKICAgICAgICAgIHRvLmxlbmd0aCA9IGxlbmd0aDsKICAgICAgICAgIHRvLnBvcyA9IHBvczsKICAgICAgICAgIHRvLmZpbmlzaGVkID0gZmluaXNoZWQ7CiAgICAgICAgICB0by5kZXN0cm95ZWQgPSBkZXN0cm95ZWQ7CiAgICAgICAgICBpZiAobGVuZ3RoICUgYmxvY2tMZW4pCiAgICAgICAgICAgIHRvLmJ1ZmZlci5zZXQoYnVmZmVyMik7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhMjU2LmpzCiAgdmFyIFNIQTI1Nl9LLCBTSEEyNTZfSVYsIFNIQTI1Nl9XLCBTSEEyNTYsIHNoYTI1NjsKICB2YXIgaW5pdF9zaGEyNTYgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTI1Ni5qcyIoKSB7CiAgICAgIGluaXRfbWQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBMjU2X0sgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgICAgICAxMTE2MzUyNDA4LAogICAgICAgIDE4OTk0NDc0NDEsCiAgICAgICAgMzA0OTMyMzQ3MSwKICAgICAgICAzOTIxMDA5NTczLAogICAgICAgIDk2MTk4NzE2MywKICAgICAgICAxNTA4OTcwOTkzLAogICAgICAgIDI0NTM2MzU3NDgsCiAgICAgICAgMjg3MDc2MzIyMSwKICAgICAgICAzNjI0MzgxMDgwLAogICAgICAgIDMxMDU5ODQwMSwKICAgICAgICA2MDcyMjUyNzgsCiAgICAgICAgMTQyNjg4MTk4NywKICAgICAgICAxOTI1MDc4Mzg4LAogICAgICAgIDIxNjIwNzgyMDYsCiAgICAgICAgMjYxNDg4ODEwMywKICAgICAgICAzMjQ4MjIyNTgwLAogICAgICAgIDM4MzUzOTA0MDEsCiAgICAgICAgNDAyMjIyNDc3NCwKICAgICAgICAyNjQzNDcwNzgsCiAgICAgICAgNjA0ODA3NjI4LAogICAgICAgIDc3MDI1NTk4MywKICAgICAgICAxMjQ5MTUwMTIyLAogICAgICAgIDE1NTUwODE2OTIsCiAgICAgICAgMTk5NjA2NDk4NiwKICAgICAgICAyNTU0MjIwODgyLAogICAgICAgIDI4MjE4MzQzNDksCiAgICAgICAgMjk1Mjk5NjgwOCwKICAgICAgICAzMjEwMzEzNjcxLAogICAgICAgIDMzMzY1NzE4OTEsCiAgICAgICAgMzU4NDUyODcxMSwKICAgICAgICAxMTM5MjY5OTMsCiAgICAgICAgMzM4MjQxODk1LAogICAgICAgIDY2NjMwNzIwNSwKICAgICAgICA3NzM1Mjk5MTIsCiAgICAgICAgMTI5NDc1NzM3MiwKICAgICAgICAxMzk2MTgyMjkxLAogICAgICAgIDE2OTUxODM3MDAsCiAgICAgICAgMTk4NjY2MTA1MSwKICAgICAgICAyMTc3MDI2MzUwLAogICAgICAgIDI0NTY5NTYwMzcsCiAgICAgICAgMjczMDQ4NTkyMSwKICAgICAgICAyODIwMzAyNDExLAogICAgICAgIDMyNTk3MzA4MDAsCiAgICAgICAgMzM0NTc2NDc3MSwKICAgICAgICAzNTE2MDY1ODE3LAogICAgICAgIDM2MDAzNTI4MDQsCiAgICAgICAgNDA5NDU3MTkwOSwKICAgICAgICAyNzU0MjMzNDQsCiAgICAgICAgNDMwMjI3NzM0LAogICAgICAgIDUwNjk0ODYxNiwKICAgICAgICA2NTkwNjA1NTYsCiAgICAgICAgODgzOTk3ODc3LAogICAgICAgIDk1ODEzOTU3MSwKICAgICAgICAxMzIyODIyMjE4LAogICAgICAgIDE1MzcwMDIwNjMsCiAgICAgICAgMTc0Nzg3Mzc3OSwKICAgICAgICAxOTU1NTYyMjIyLAogICAgICAgIDIwMjQxMDQ4MTUsCiAgICAgICAgMjIyNzczMDQ1MiwKICAgICAgICAyMzYxODUyNDI0LAogICAgICAgIDI0Mjg0MzY0NzQsCiAgICAgICAgMjc1NjczNDE4NywKICAgICAgICAzMjA0MDMxNDc5LAogICAgICAgIDMzMjkzMjUyOTgKICAgICAgXSk7CiAgICAgIFNIQTI1Nl9JViA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgICAgIDE3NzkwMzM3MDMsCiAgICAgICAgMzE0NDEzNDI3NywKICAgICAgICAxMDEzOTA0MjQyLAogICAgICAgIDI3NzM0ODA3NjIsCiAgICAgICAgMTM1OTg5MzExOSwKICAgICAgICAyNjAwODIyOTI0LAogICAgICAgIDUyODczNDYzNSwKICAgICAgICAxNTQxNDU5MjI1CiAgICAgIF0pOwogICAgICBTSEEyNTZfVyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoNjQpOwogICAgICBTSEEyNTYgPSBjbGFzcyBleHRlbmRzIEhhc2hNRCB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcig2NCwgMzIsIDgsIGZhbHNlKTsKICAgICAgICAgIHRoaXMuQSA9IFNIQTI1Nl9JVlswXSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBTSEEyNTZfSVZbMV0gfCAwOwogICAgICAgICAgdGhpcy5DID0gU0hBMjU2X0lWWzJdIHwgMDsKICAgICAgICAgIHRoaXMuRCA9IFNIQTI1Nl9JVlszXSB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBTSEEyNTZfSVZbNF0gfCAwOwogICAgICAgICAgdGhpcy5GID0gU0hBMjU2X0lWWzVdIHwgMDsKICAgICAgICAgIHRoaXMuRyA9IFNIQTI1Nl9JVls2XSB8IDA7CiAgICAgICAgICB0aGlzLkggPSBTSEEyNTZfSVZbN10gfCAwOwogICAgICAgIH0KICAgICAgICBnZXQoKSB7CiAgICAgICAgICBjb25zdCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICByZXR1cm4gW0EsIEIsIEMsIEQsIEUsIEYsIEcsIEhdOwogICAgICAgIH0KICAgICAgICAvLyBwcmV0dGllci1pZ25vcmUKICAgICAgICBzZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCkgewogICAgICAgICAgdGhpcy5BID0gQSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBCIHwgMDsKICAgICAgICAgIHRoaXMuQyA9IEMgfCAwOwogICAgICAgICAgdGhpcy5EID0gRCB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBFIHwgMDsKICAgICAgICAgIHRoaXMuRiA9IEYgfCAwOwogICAgICAgICAgdGhpcy5HID0gRyB8IDA7CiAgICAgICAgICB0aGlzLkggPSBIIHwgMDsKICAgICAgICB9CiAgICAgICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKywgb2Zmc2V0ICs9IDQpCiAgICAgICAgICAgIFNIQTI1Nl9XW2ldID0gdmlldy5nZXRVaW50MzIob2Zmc2V0LCBmYWxzZSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA2NDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IFcxNSA9IFNIQTI1Nl9XW2kgLSAxNV07CiAgICAgICAgICAgIGNvbnN0IFcyID0gU0hBMjU2X1dbaSAtIDJdOwogICAgICAgICAgICBjb25zdCBzMCA9IHJvdHIoVzE1LCA3KSBeIHJvdHIoVzE1LCAxOCkgXiBXMTUgPj4+IDM7CiAgICAgICAgICAgIGNvbnN0IHMxID0gcm90cihXMiwgMTcpIF4gcm90cihXMiwgMTkpIF4gVzIgPj4+IDEwOwogICAgICAgICAgICBTSEEyNTZfV1tpXSA9IHMxICsgU0hBMjU2X1dbaSAtIDddICsgczAgKyBTSEEyNTZfV1tpIC0gMTZdIHwgMDsKICAgICAgICAgIH0KICAgICAgICAgIGxldCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY0OyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc2lnbWExID0gcm90cihFLCA2KSBeIHJvdHIoRSwgMTEpIF4gcm90cihFLCAyNSk7CiAgICAgICAgICAgIGNvbnN0IFQxID0gSCArIHNpZ21hMSArIENoaShFLCBGLCBHKSArIFNIQTI1Nl9LW2ldICsgU0hBMjU2X1dbaV0gfCAwOwogICAgICAgICAgICBjb25zdCBzaWdtYTAgPSByb3RyKEEsIDIpIF4gcm90cihBLCAxMykgXiByb3RyKEEsIDIyKTsKICAgICAgICAgICAgY29uc3QgVDIgPSBzaWdtYTAgKyBNYWooQSwgQiwgQykgfCAwOwogICAgICAgICAgICBIID0gRzsKICAgICAgICAgICAgRyA9IEY7CiAgICAgICAgICAgIEYgPSBFOwogICAgICAgICAgICBFID0gRCArIFQxIHwgMDsKICAgICAgICAgICAgRCA9IEM7CiAgICAgICAgICAgIEMgPSBCOwogICAgICAgICAgICBCID0gQTsKICAgICAgICAgICAgQSA9IFQxICsgVDIgfCAwOwogICAgICAgICAgfQogICAgICAgICAgQSA9IEEgKyB0aGlzLkEgfCAwOwogICAgICAgICAgQiA9IEIgKyB0aGlzLkIgfCAwOwogICAgICAgICAgQyA9IEMgKyB0aGlzLkMgfCAwOwogICAgICAgICAgRCA9IEQgKyB0aGlzLkQgfCAwOwogICAgICAgICAgRSA9IEUgKyB0aGlzLkUgfCAwOwogICAgICAgICAgRiA9IEYgKyB0aGlzLkYgfCAwOwogICAgICAgICAgRyA9IEcgKyB0aGlzLkcgfCAwOwogICAgICAgICAgSCA9IEggKyB0aGlzLkggfCAwOwogICAgICAgICAgdGhpcy5zZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCk7CiAgICAgICAgfQogICAgICAgIHJvdW5kQ2xlYW4oKSB7CiAgICAgICAgICBTSEEyNTZfVy5maWxsKDApOwogICAgICAgIH0KICAgICAgICBkZXN0cm95KCkgewogICAgICAgICAgdGhpcy5zZXQoMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCk7CiAgICAgICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgc2hhMjU2ID0gLyogQF9fUFVSRV9fICovIHdyYXBDb25zdHJ1Y3RvcigoKSA9PiBuZXcgU0hBMjU2KCkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vaG1hYy5qcwogIHZhciBITUFDLCBobWFjOwogIHZhciBpbml0X2htYWMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2htYWMuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBITUFDID0gY2xhc3MgZXh0ZW5kcyBIYXNoIHsKICAgICAgICBjb25zdHJ1Y3RvcihoYXNoMywgX2tleSkgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBoYXNoKGhhc2gzKTsKICAgICAgICAgIGNvbnN0IGtleSA9IHRvQnl0ZXMyKF9rZXkpOwogICAgICAgICAgdGhpcy5pSGFzaCA9IGhhc2gzLmNyZWF0ZSgpOwogICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmlIYXNoLnVwZGF0ZSAhPT0gImZ1bmN0aW9uIikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBpbnN0YW5jZSBvZiBjbGFzcyB3aGljaCBleHRlbmRzIHV0aWxzLkhhc2giKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSB0aGlzLmlIYXNoLmJsb2NrTGVuOwogICAgICAgICAgdGhpcy5vdXRwdXRMZW4gPSB0aGlzLmlIYXNoLm91dHB1dExlbjsKICAgICAgICAgIGNvbnN0IGJsb2NrTGVuID0gdGhpcy5ibG9ja0xlbjsKICAgICAgICAgIGNvbnN0IHBhZDIgPSBuZXcgVWludDhBcnJheShibG9ja0xlbik7CiAgICAgICAgICBwYWQyLnNldChrZXkubGVuZ3RoID4gYmxvY2tMZW4gPyBoYXNoMy5jcmVhdGUoKS51cGRhdGUoa2V5KS5kaWdlc3QoKSA6IGtleSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZDIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHBhZDJbaV0gXj0gNTQ7CiAgICAgICAgICB0aGlzLmlIYXNoLnVwZGF0ZShwYWQyKTsKICAgICAgICAgIHRoaXMub0hhc2ggPSBoYXNoMy5jcmVhdGUoKTsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFkMi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcGFkMltpXSBePSA1NCBeIDkyOwogICAgICAgICAgdGhpcy5vSGFzaC51cGRhdGUocGFkMik7CiAgICAgICAgICBwYWQyLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZShidWYpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIHRoaXMuaUhhc2gudXBkYXRlKGJ1Zik7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIGJ5dGVzKG91dCwgdGhpcy5vdXRwdXRMZW4pOwogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLmlIYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMub0hhc2gudXBkYXRlKG91dCk7CiAgICAgICAgICB0aGlzLm9IYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICBjb25zdCBvdXQgPSBuZXcgVWludDhBcnJheSh0aGlzLm9IYXNoLm91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLCB7fSkpOwogICAgICAgICAgY29uc3QgeyBvSGFzaCwgaUhhc2gsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIGJsb2NrTGVuLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0byA9IHRvOwogICAgICAgICAgdG8uZmluaXNoZWQgPSBmaW5pc2hlZDsKICAgICAgICAgIHRvLmRlc3Ryb3llZCA9IGRlc3Ryb3llZDsKICAgICAgICAgIHRvLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0by5vdXRwdXRMZW4gPSBvdXRwdXRMZW47CiAgICAgICAgICB0by5vSGFzaCA9IG9IYXNoLl9jbG9uZUludG8odG8ub0hhc2gpOwogICAgICAgICAgdG8uaUhhc2ggPSBpSGFzaC5fY2xvbmVJbnRvKHRvLmlIYXNoKTsKICAgICAgICAgIHJldHVybiB0bzsKICAgICAgICB9CiAgICAgICAgZGVzdHJveSgpIHsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMub0hhc2guZGVzdHJveSgpOwogICAgICAgICAgdGhpcy5pSGFzaC5kZXN0cm95KCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBobWFjID0gKGhhc2gzLCBrZXksIG1lc3NhZ2UpID0+IG5ldyBITUFDKGhhc2gzLCBrZXkpLnVwZGF0ZShtZXNzYWdlKS5kaWdlc3QoKTsKICAgICAgaG1hYy5jcmVhdGUgPSAoaGFzaDMsIGtleSkgPT4gbmV3IEhNQUMoaGFzaDMsIGtleSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qcwogIHZhciB1dGlsc19leHBvcnRzID0ge307CiAgX19leHBvcnQodXRpbHNfZXhwb3J0cywgewogICAgYUluUmFuZ2U6ICgpID0+IGFJblJhbmdlLAogICAgYWJvb2w6ICgpID0+IGFib29sLAogICAgYWJ5dGVzOiAoKSA9PiBhYnl0ZXMsCiAgICBiaXRHZXQ6ICgpID0+IGJpdEdldCwKICAgIGJpdExlbjogKCkgPT4gYml0TGVuLAogICAgYml0TWFzazogKCkgPT4gYml0TWFzaywKICAgIGJpdFNldDogKCkgPT4gYml0U2V0LAogICAgYnl0ZXNUb0hleDogKCkgPT4gYnl0ZXNUb0hleDIsCiAgICBieXRlc1RvTnVtYmVyQkU6ICgpID0+IGJ5dGVzVG9OdW1iZXJCRSwKICAgIGJ5dGVzVG9OdW1iZXJMRTogKCkgPT4gYnl0ZXNUb051bWJlckxFLAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMywKICAgIGNyZWF0ZUhtYWNEcmJnOiAoKSA9PiBjcmVhdGVIbWFjRHJiZywKICAgIGVuc3VyZUJ5dGVzOiAoKSA9PiBlbnN1cmVCeXRlcywKICAgIGVxdWFsQnl0ZXM6ICgpID0+IGVxdWFsQnl0ZXMsCiAgICBoZXhUb0J5dGVzOiAoKSA9PiBoZXhUb0J5dGVzMiwKICAgIGhleFRvTnVtYmVyOiAoKSA9PiBoZXhUb051bWJlcjIsCiAgICBpblJhbmdlOiAoKSA9PiBpblJhbmdlLAogICAgaXNCeXRlczogKCkgPT4gaXNCeXRlczIsCiAgICBtZW1vaXplZDogKCkgPT4gbWVtb2l6ZWQsCiAgICBub3RJbXBsZW1lbnRlZDogKCkgPT4gbm90SW1wbGVtZW50ZWQsCiAgICBudW1iZXJUb0J5dGVzQkU6ICgpID0+IG51bWJlclRvQnl0ZXNCRSwKICAgIG51bWJlclRvQnl0ZXNMRTogKCkgPT4gbnVtYmVyVG9CeXRlc0xFLAogICAgbnVtYmVyVG9IZXhVbnBhZGRlZDogKCkgPT4gbnVtYmVyVG9IZXhVbnBhZGRlZCwKICAgIG51bWJlclRvVmFyQnl0ZXNCRTogKCkgPT4gbnVtYmVyVG9WYXJCeXRlc0JFLAogICAgdXRmOFRvQnl0ZXM6ICgpID0+IHV0ZjhUb0J5dGVzMiwKICAgIHZhbGlkYXRlT2JqZWN0OiAoKSA9PiB2YWxpZGF0ZU9iamVjdAogIH0pOwogIGZ1bmN0aW9uIGlzQnl0ZXMyKGEpIHsKICAgIHJldHVybiBhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBhICE9IG51bGwgJiYgdHlwZW9mIGEgPT09ICJvYmplY3QiICYmIGEuY29uc3RydWN0b3IubmFtZSA9PT0gIlVpbnQ4QXJyYXkiOwogIH0KICBmdW5jdGlvbiBhYnl0ZXMoaXRlbSkgewogICAgaWYgKCFpc0J5dGVzMihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVaW50OEFycmF5IGV4cGVjdGVkIik7CiAgfQogIGZ1bmN0aW9uIGFib29sKHRpdGxlLCB2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IG11c3QgYmUgdmFsaWQgYm9vbGVhbiwgZ290ICIke3ZhbHVlfSIuYCk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9IZXgyKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICBsZXQgaGV4ID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ5dGVzMi5sZW5ndGg7IGkrKykgewogICAgICBoZXggKz0gaGV4ZXMyW2J5dGVzMltpXV07CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleFVucGFkZGVkKG51bTIpIHsKICAgIGNvbnN0IGhleCA9IG51bTIudG9TdHJpbmcoMTYpOwogICAgcmV0dXJuIGhleC5sZW5ndGggJiAxID8gYDAke2hleH1gIDogaGV4OwogIH0KICBmdW5jdGlvbiBoZXhUb051bWJlcjIoaGV4KSB7CiAgICBpZiAodHlwZW9mIGhleCAhPT0gInN0cmluZyIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGV4IHN0cmluZyBleHBlY3RlZCwgZ290ICIgKyB0eXBlb2YgaGV4KTsKICAgIHJldHVybiBCaWdJbnQoaGV4ID09PSAiIiA/ICIwIiA6IGAweCR7aGV4fWApOwogIH0KICBmdW5jdGlvbiBhc2NpaVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fMCAmJiBjaGFyIDw9IGFzY2lpcy5fOSkKICAgICAgcmV0dXJuIGNoYXIgLSBhc2NpaXMuXzA7CiAgICBpZiAoY2hhciA+PSBhc2NpaXMuX0EgJiYgY2hhciA8PSBhc2NpaXMuX0YpCiAgICAgIHJldHVybiBjaGFyIC0gKGFzY2lpcy5fQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fYSAmJiBjaGFyIDw9IGFzY2lpcy5fZikKICAgICAgcmV0dXJuIGNoYXIgLSAoYXNjaWlzLl9hIC0gMTApOwogICAgcmV0dXJuOwogIH0KICBmdW5jdGlvbiBoZXhUb0J5dGVzMihoZXgpIHsKICAgIGlmICh0eXBlb2YgaGV4ICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgIiArIHR5cGVvZiBoZXgpOwogICAgY29uc3QgaGwgPSBoZXgubGVuZ3RoOwogICAgY29uc3QgYWwgPSBobCAvIDI7CiAgICBpZiAoaGwgJSAyKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInBhZGRlZCBoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgdW5wYWRkZWQgaGV4IG9mIGxlbmd0aCAiICsgaGwpOwogICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShhbCk7CiAgICBmb3IgKGxldCBhaSA9IDAsIGhpID0gMDsgYWkgPCBhbDsgYWkrKywgaGkgKz0gMikgewogICAgICBjb25zdCBuMSA9IGFzY2lpVG9CYXNlMTYoaGV4LmNoYXJDb2RlQXQoaGkpKTsKICAgICAgY29uc3QgbjIgPSBhc2NpaVRvQmFzZTE2KGhleC5jaGFyQ29kZUF0KGhpICsgMSkpOwogICAgICBpZiAobjEgPT09IHZvaWQgMCB8fCBuMiA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc3QgY2hhciA9IGhleFtoaV0gKyBoZXhbaGkgKyAxXTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2hleCBzdHJpbmcgZXhwZWN0ZWQsIGdvdCBub24taGV4IGNoYXJhY3RlciAiJyArIGNoYXIgKyAnIiBhdCBpbmRleCAnICsgaGkpOwogICAgICB9CiAgICAgIGFycmF5W2FpXSA9IG4xICogMTYgKyBuMjsKICAgIH0KICAgIHJldHVybiBhcnJheTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckJFKGJ5dGVzMikgewogICAgcmV0dXJuIGhleFRvTnVtYmVyMihieXRlc1RvSGV4MihieXRlczIpKTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIyKGJ5dGVzVG9IZXgyKFVpbnQ4QXJyYXkuZnJvbShieXRlczIpLnJldmVyc2UoKSkpOwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobi50b1N0cmluZygxNikucGFkU3RhcnQobGVuICogMiwgIjAiKSk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvQnl0ZXNMRShuLCBsZW4pIHsKICAgIHJldHVybiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKS5yZXZlcnNlKCk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvVmFyQnl0ZXNCRShuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobnVtYmVyVG9IZXhVbnBhZGRlZChuKSk7CiAgfQogIGZ1bmN0aW9uIGVuc3VyZUJ5dGVzKHRpdGxlLCBoZXgsIGV4cGVjdGVkTGVuZ3RoKSB7CiAgICBsZXQgcmVzOwogICAgaWYgKHR5cGVvZiBoZXggPT09ICJzdHJpbmciKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcmVzID0gaGV4VG9CeXRlczIoaGV4KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSB2YWxpZCBoZXggc3RyaW5nLCBnb3QgIiR7aGV4fSIuIENhdXNlOiAke2V9YCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNCeXRlczIoaGV4KSkgewogICAgICByZXMgPSBVaW50OEFycmF5LmZyb20oaGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSBoZXggc3RyaW5nIG9yIFVpbnQ4QXJyYXlgKTsKICAgIH0KICAgIGNvbnN0IGxlbiA9IHJlcy5sZW5ndGg7CiAgICBpZiAodHlwZW9mIGV4cGVjdGVkTGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW4gIT09IGV4cGVjdGVkTGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IGV4cGVjdGVkICR7ZXhwZWN0ZWRMZW5ndGh9IGJ5dGVzLCBnb3QgJHtsZW59YCk7CiAgICByZXR1cm4gcmVzOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlczMoLi4uYXJyYXlzKSB7CiAgICBsZXQgc3VtID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGEgPSBhcnJheXNbaV07CiAgICAgIGFieXRlcyhhKTsKICAgICAgc3VtICs9IGEubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzID0gbmV3IFVpbnQ4QXJyYXkoc3VtKTsKICAgIGZvciAobGV0IGkgPSAwLCBwYWQyID0gMDsgaSA8IGFycmF5cy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBhID0gYXJyYXlzW2ldOwogICAgICByZXMuc2V0KGEsIHBhZDIpOwogICAgICBwYWQyICs9IGEubGVuZ3RoOwogICAgfQogICAgcmV0dXJuIHJlczsKICB9CiAgZnVuY3Rpb24gZXF1YWxCeXRlcyhhLCBiKSB7CiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBsZXQgZGlmZiA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspCiAgICAgIGRpZmYgfD0gYVtpXSBeIGJbaV07CiAgICByZXR1cm4gZGlmZiA9PT0gMDsKICB9CiAgZnVuY3Rpb24gdXRmOFRvQnl0ZXMyKHN0cikgewogICAgaWYgKHR5cGVvZiBzdHIgIT09ICJzdHJpbmciKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYHV0ZjhUb0J5dGVzIGV4cGVjdGVkIHN0cmluZywgZ290ICR7dHlwZW9mIHN0cn1gKTsKICAgIHJldHVybiBuZXcgVWludDhBcnJheShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc3RyKSk7CiAgfQogIGZ1bmN0aW9uIGluUmFuZ2UobiwgbWluLCBtYXgpIHsKICAgIHJldHVybiBpc1Bvc0JpZyhuKSAmJiBpc1Bvc0JpZyhtaW4pICYmIGlzUG9zQmlnKG1heCkgJiYgbWluIDw9IG4gJiYgbiA8IG1heDsKICB9CiAgZnVuY3Rpb24gYUluUmFuZ2UodGl0bGUsIG4sIG1pbiwgbWF4KSB7CiAgICBpZiAoIWluUmFuZ2UobiwgbWluLCBtYXgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkIHZhbGlkICR7dGl0bGV9OiAke21pbn0gPD0gbiA8ICR7bWF4fSwgZ290ICR7dHlwZW9mIG59ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gYml0TGVuKG4pIHsKICAgIGxldCBsZW47CiAgICBmb3IgKGxlbiA9IDA7IG4gPiBfMG4yOyBuID4+PSBfMW4yLCBsZW4gKz0gMSkKICAgICAgOwogICAgcmV0dXJuIGxlbjsKICB9CiAgZnVuY3Rpb24gYml0R2V0KG4sIHBvcykgewogICAgcmV0dXJuIG4gPj4gQmlnSW50KHBvcykgJiBfMW4yOwogIH0KICBmdW5jdGlvbiBiaXRTZXQobiwgcG9zLCB2YWx1ZSkgewogICAgcmV0dXJuIG4gfCAodmFsdWUgPyBfMW4yIDogXzBuMikgPDwgQmlnSW50KHBvcyk7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUhtYWNEcmJnKGhhc2hMZW4sIHFCeXRlTGVuLCBobWFjRm4pIHsKICAgIGlmICh0eXBlb2YgaGFzaExlbiAhPT0gIm51bWJlciIgfHwgaGFzaExlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGFzaExlbiBtdXN0IGJlIGEgbnVtYmVyIik7CiAgICBpZiAodHlwZW9mIHFCeXRlTGVuICE9PSAibnVtYmVyIiB8fCBxQnl0ZUxlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigicUJ5dGVMZW4gbXVzdCBiZSBhIG51bWJlciIpOwogICAgaWYgKHR5cGVvZiBobWFjRm4gIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaG1hY0ZuIG11c3QgYmUgYSBmdW5jdGlvbiIpOwogICAgbGV0IHYgPSB1OG4oaGFzaExlbik7CiAgICBsZXQgayA9IHU4bihoYXNoTGVuKTsKICAgIGxldCBpID0gMDsKICAgIGNvbnN0IHJlc2V0MiA9ICgpID0+IHsKICAgICAgdi5maWxsKDEpOwogICAgICBrLmZpbGwoMCk7CiAgICAgIGkgPSAwOwogICAgfTsKICAgIGNvbnN0IGggPSAoLi4uYikgPT4gaG1hY0ZuKGssIHYsIC4uLmIpOwogICAgY29uc3QgcmVzZWVkID0gKHNlZWQgPSB1OG4oKSkgPT4gewogICAgICBrID0gaCh1OGZyKFswXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgICBpZiAoc2VlZC5sZW5ndGggPT09IDApCiAgICAgICAgcmV0dXJuOwogICAgICBrID0gaCh1OGZyKFsxXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgfTsKICAgIGNvbnN0IGdlbjIgPSAoKSA9PiB7CiAgICAgIGlmIChpKysgPj0gMWUzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiZHJiZzogdHJpZWQgMTAwMCB2YWx1ZXMiKTsKICAgICAgbGV0IGxlbiA9IDA7CiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICB3aGlsZSAobGVuIDwgcUJ5dGVMZW4pIHsKICAgICAgICB2ID0gaCgpOwogICAgICAgIGNvbnN0IHNsID0gdi5zbGljZSgpOwogICAgICAgIG91dC5wdXNoKHNsKTsKICAgICAgICBsZW4gKz0gdi5sZW5ndGg7CiAgICAgIH0KICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyguLi5vdXQpOwogICAgfTsKICAgIGNvbnN0IGdlblVudGlsID0gKHNlZWQsIHByZWQpID0+IHsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJlc2VlZChzZWVkKTsKICAgICAgbGV0IHJlcyA9IHZvaWQgMDsKICAgICAgd2hpbGUgKCEocmVzID0gcHJlZChnZW4yKCkpKSkKICAgICAgICByZXNlZWQoKTsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgcmV0dXJuIGdlblVudGlsOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdChvYmplY3QsIHZhbGlkYXRvcnMsIG9wdFZhbGlkYXRvcnMgPSB7fSkgewogICAgY29uc3QgY2hlY2tGaWVsZCA9IChmaWVsZE5hbWUsIHR5cGUsIGlzT3B0aW9uYWwpID0+IHsKICAgICAgY29uc3QgY2hlY2tWYWwgPSB2YWxpZGF0b3JGbnNbdHlwZV07CiAgICAgIGlmICh0eXBlb2YgY2hlY2tWYWwgIT09ICJmdW5jdGlvbiIpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbGlkYXRvciAiJHt0eXBlfSIsIGV4cGVjdGVkIGZ1bmN0aW9uYCk7CiAgICAgIGNvbnN0IHZhbCA9IG9iamVjdFtmaWVsZE5hbWVdOwogICAgICBpZiAoaXNPcHRpb25hbCAmJiB2YWwgPT09IHZvaWQgMCkKICAgICAgICByZXR1cm47CiAgICAgIGlmICghY2hlY2tWYWwodmFsLCBvYmplY3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHBhcmFtICR7U3RyaW5nKGZpZWxkTmFtZSl9PSR7dmFsfSAoJHt0eXBlb2YgdmFsfSksIGV4cGVjdGVkICR7dHlwZX1gKTsKICAgICAgfQogICAgfTsKICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgdHlwZV0gb2YgT2JqZWN0LmVudHJpZXModmFsaWRhdG9ycykpCiAgICAgIGNoZWNrRmllbGQoZmllbGROYW1lLCB0eXBlLCBmYWxzZSk7CiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIHR5cGVdIG9mIE9iamVjdC5lbnRyaWVzKG9wdFZhbGlkYXRvcnMpKQogICAgICBjaGVja0ZpZWxkKGZpZWxkTmFtZSwgdHlwZSwgdHJ1ZSk7CiAgICByZXR1cm4gb2JqZWN0OwogIH0KICBmdW5jdGlvbiBtZW1vaXplZChmbikgewogICAgY29uc3QgbWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgICByZXR1cm4gKGFyZywgLi4uYXJncykgPT4gewogICAgICBjb25zdCB2YWwgPSBtYXAuZ2V0KGFyZyk7CiAgICAgIGlmICh2YWwgIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gdmFsOwogICAgICBjb25zdCBjb21wdXRlZCA9IGZuKGFyZywgLi4uYXJncyk7CiAgICAgIG1hcC5zZXQoYXJnLCBjb21wdXRlZCk7CiAgICAgIHJldHVybiBjb21wdXRlZDsKICAgIH07CiAgfQogIHZhciBfMG4yLCBfMW4yLCBfMm4yLCBoZXhlczIsIGFzY2lpcywgaXNQb3NCaWcsIGJpdE1hc2ssIHU4biwgdThmciwgdmFsaWRhdG9yRm5zLCBub3RJbXBsZW1lbnRlZDsKICB2YXIgaW5pdF91dGlsczQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3V0aWxzLmpzIigpIHsKICAgICAgXzBuMiA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMCk7CiAgICAgIF8xbjIgPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4yID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgyKTsKICAgICAgaGV4ZXMyID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoXywgaSkgPT4gaS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKSk7CiAgICAgIGFzY2lpcyA9IHsgXzA6IDQ4LCBfOTogNTcsIF9BOiA2NSwgX0Y6IDcwLCBfYTogOTcsIF9mOiAxMDIgfTsKICAgICAgaXNQb3NCaWcgPSAobikgPT4gdHlwZW9mIG4gPT09ICJiaWdpbnQiICYmIF8wbjIgPD0gbjsKICAgICAgYml0TWFzayA9IChuKSA9PiAoXzJuMiA8PCBCaWdJbnQobiAtIDEpKSAtIF8xbjI7CiAgICAgIHU4biA9IChkYXRhKSA9PiBuZXcgVWludDhBcnJheShkYXRhKTsKICAgICAgdThmciA9IChhcnIpID0+IFVpbnQ4QXJyYXkuZnJvbShhcnIpOwogICAgICB2YWxpZGF0b3JGbnMgPSB7CiAgICAgICAgYmlnaW50OiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYmlnaW50IiwKICAgICAgICBmdW5jdGlvbjogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiwKICAgICAgICBib29sZWFuOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYm9vbGVhbiIsCiAgICAgICAgc3RyaW5nOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAic3RyaW5nIiwKICAgICAgICBzdHJpbmdPclVpbnQ4QXJyYXk6ICh2YWwpID0+IHR5cGVvZiB2YWwgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHZhbCksCiAgICAgICAgaXNTYWZlSW50ZWdlcjogKHZhbCkgPT4gTnVtYmVyLmlzU2FmZUludGVnZXIodmFsKSwKICAgICAgICBhcnJheTogKHZhbCkgPT4gQXJyYXkuaXNBcnJheSh2YWwpLAogICAgICAgIGZpZWxkOiAodmFsLCBvYmplY3QpID0+IG9iamVjdC5GcC5pc1ZhbGlkKHZhbCksCiAgICAgICAgaGFzaDogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiAmJiBOdW1iZXIuaXNTYWZlSW50ZWdlcih2YWwub3V0cHV0TGVuKQogICAgICB9OwogICAgICBub3RJbXBsZW1lbnRlZCA9ICgpID0+IHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpOwogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvbW9kdWxhci5qcwogIGZ1bmN0aW9uIG1vZChhLCBiKSB7CiAgICBjb25zdCByZXN1bHQgPSBhICUgYjsKICAgIHJldHVybiByZXN1bHQgPj0gXzBuMyA/IHJlc3VsdCA6IGIgKyByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIHBvdyhudW0yLCBwb3dlciwgbW9kdWxvKSB7CiAgICBpZiAobW9kdWxvIDw9IF8wbjMgfHwgcG93ZXIgPCBfMG4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIHBvd2VyL21vZHVsbyA+IDAiKTsKICAgIGlmIChtb2R1bG8gPT09IF8xbjMpCiAgICAgIHJldHVybiBfMG4zOwogICAgbGV0IHJlcyA9IF8xbjM7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcmVzID0gcmVzICogbnVtMiAlIG1vZHVsbzsKICAgICAgbnVtMiA9IG51bTIgKiBudW0yICUgbW9kdWxvOwogICAgICBwb3dlciA+Pj0gXzFuMzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHBvdzIoeCwgcG93ZXIsIG1vZHVsbykgewogICAgbGV0IHJlcyA9IHg7CiAgICB3aGlsZSAocG93ZXItLSA+IF8wbjMpIHsKICAgICAgcmVzICo9IHJlczsKICAgICAgcmVzICU9IG1vZHVsbzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIGludmVydChudW1iZXIyLCBtb2R1bG8pIHsKICAgIGlmIChudW1iZXIyID09PSBfMG4zIHx8IG1vZHVsbyA8PSBfMG4zKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgaW52ZXJ0OiBleHBlY3RlZCBwb3NpdGl2ZSBpbnRlZ2VycywgZ290IG49JHtudW1iZXIyfSBtb2Q9JHttb2R1bG99YCk7CiAgICB9CiAgICBsZXQgYSA9IG1vZChudW1iZXIyLCBtb2R1bG8pOwogICAgbGV0IGIgPSBtb2R1bG87CiAgICBsZXQgeCA9IF8wbjMsIHkgPSBfMW4zLCB1ID0gXzFuMywgdiA9IF8wbjM7CiAgICB3aGlsZSAoYSAhPT0gXzBuMykgewogICAgICBjb25zdCBxID0gYiAvIGE7CiAgICAgIGNvbnN0IHIgPSBiICUgYTsKICAgICAgY29uc3QgbSA9IHggLSB1ICogcTsKICAgICAgY29uc3QgbiA9IHkgLSB2ICogcTsKICAgICAgYiA9IGEsIGEgPSByLCB4ID0gdSwgeSA9IHYsIHUgPSBtLCB2ID0gbjsKICAgIH0KICAgIGNvbnN0IGdjZCA9IGI7CiAgICBpZiAoZ2NkICE9PSBfMW4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImludmVydDogZG9lcyBub3QgZXhpc3QiKTsKICAgIHJldHVybiBtb2QoeCwgbW9kdWxvKTsKICB9CiAgZnVuY3Rpb24gdG9uZWxsaVNoYW5rcyhQKSB7CiAgICBjb25zdCBsZWdlbmRyZUMgPSAoUCAtIF8xbjMpIC8gXzJuMzsKICAgIGxldCBRLCBTLCBaOwogICAgZm9yIChRID0gUCAtIF8xbjMsIFMgPSAwOyBRICUgXzJuMyA9PT0gXzBuMzsgUSAvPSBfMm4zLCBTKyspCiAgICAgIDsKICAgIGZvciAoWiA9IF8ybjM7IFogPCBQICYmIHBvdyhaLCBsZWdlbmRyZUMsIFApICE9PSBQIC0gXzFuMzsgWisrKQogICAgICA7CiAgICBpZiAoUyA9PT0gMSkgewogICAgICBjb25zdCBwMWRpdjQgPSAoUCArIF8xbjMpIC8gXzRuOwogICAgICByZXR1cm4gZnVuY3Rpb24gdG9uZWxsaUZhc3QoRnAyLCBuKSB7CiAgICAgICAgY29uc3Qgcm9vdDIgPSBGcDIucG93KG4sIHAxZGl2NCk7CiAgICAgICAgaWYgKCFGcDIuZXFsKEZwMi5zcXIocm9vdDIpLCBuKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgICAgICByZXR1cm4gcm9vdDI7CiAgICAgIH07CiAgICB9CiAgICBjb25zdCBRMWRpdjIgPSAoUSArIF8xbjMpIC8gXzJuMzsKICAgIHJldHVybiBmdW5jdGlvbiB0b25lbGxpU2xvdyhGcDIsIG4pIHsKICAgICAgaWYgKEZwMi5wb3cobiwgbGVnZW5kcmVDKSA9PT0gRnAyLm5lZyhGcDIuT05FKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgIGxldCByID0gUzsKICAgICAgbGV0IGcgPSBGcDIucG93KEZwMi5tdWwoRnAyLk9ORSwgWiksIFEpOwogICAgICBsZXQgeCA9IEZwMi5wb3cobiwgUTFkaXYyKTsKICAgICAgbGV0IGIgPSBGcDIucG93KG4sIFEpOwogICAgICB3aGlsZSAoIUZwMi5lcWwoYiwgRnAyLk9ORSkpIHsKICAgICAgICBpZiAoRnAyLmVxbChiLCBGcDIuWkVSTykpCiAgICAgICAgICByZXR1cm4gRnAyLlpFUk87CiAgICAgICAgbGV0IG0gPSAxOwogICAgICAgIGZvciAobGV0IHQyID0gRnAyLnNxcihiKTsgbSA8IHI7IG0rKykgewogICAgICAgICAgaWYgKEZwMi5lcWwodDIsIEZwMi5PTkUpKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIHQyID0gRnAyLnNxcih0Mik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGdlID0gRnAyLnBvdyhnLCBfMW4zIDw8IEJpZ0ludChyIC0gbSAtIDEpKTsKICAgICAgICBnID0gRnAyLnNxcihnZSk7CiAgICAgICAgeCA9IEZwMi5tdWwoeCwgZ2UpOwogICAgICAgIGIgPSBGcDIubXVsKGIsIGcpOwogICAgICAgIHIgPSBtOwogICAgICB9CiAgICAgIHJldHVybiB4OwogICAgfTsKICB9CiAgZnVuY3Rpb24gRnBTcXJ0KFApIHsKICAgIGlmIChQICUgXzRuID09PSBfM24pIHsKICAgICAgY29uc3QgcDFkaXY0ID0gKFAgKyBfMW4zKSAvIF80bjsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNxcnQzbW9kNChGcDIsIG4pIHsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5wb3cobiwgcDFkaXY0KTsKICAgICAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihyb290MiksIG4pKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBzcXVhcmUgcm9vdCIpOwogICAgICAgIHJldHVybiByb290MjsKICAgICAgfTsKICAgIH0KICAgIGlmIChQICUgXzhuID09PSBfNW4pIHsKICAgICAgY29uc3QgYzEgPSAoUCAtIF81bikgLyBfOG47CiAgICAgIHJldHVybiBmdW5jdGlvbiBzcXJ0NW1vZDgoRnAyLCBuKSB7CiAgICAgICAgY29uc3QgbjIgPSBGcDIubXVsKG4sIF8ybjMpOwogICAgICAgIGNvbnN0IHYgPSBGcDIucG93KG4yLCBjMSk7CiAgICAgICAgY29uc3QgbnYgPSBGcDIubXVsKG4sIHYpOwogICAgICAgIGNvbnN0IGkgPSBGcDIubXVsKEZwMi5tdWwobnYsIF8ybjMpLCB2KTsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5tdWwobnYsIEZwMi5zdWIoaSwgRnAyLk9ORSkpOwogICAgICAgIGlmICghRnAyLmVxbChGcDIuc3FyKHJvb3QyKSwgbikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgICAgcmV0dXJuIHJvb3QyOwogICAgICB9OwogICAgfQogICAgaWYgKFAgJSBfMTZuID09PSBfOW4pIHsKICAgIH0KICAgIHJldHVybiB0b25lbGxpU2hhbmtzKFApOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7CiAgICBjb25zdCBpbml0aWFsID0gewogICAgICBPUkRFUjogImJpZ2ludCIsCiAgICAgIE1BU0s6ICJiaWdpbnQiLAogICAgICBCWVRFUzogImlzU2FmZUludGVnZXIiLAogICAgICBCSVRTOiAiaXNTYWZlSW50ZWdlciIKICAgIH07CiAgICBjb25zdCBvcHRzID0gRklFTERfRklFTERTLnJlZHVjZSgobWFwLCB2YWwpID0+IHsKICAgICAgbWFwW3ZhbF0gPSAiZnVuY3Rpb24iOwogICAgICByZXR1cm4gbWFwOwogICAgfSwgaW5pdGlhbCk7CiAgICByZXR1cm4gdmFsaWRhdGVPYmplY3QoZmllbGQsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBGcFBvdyhmMiwgbnVtMiwgcG93ZXIpIHsKICAgIGlmIChwb3dlciA8IF8wbjMpCiAgICAgIHRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgcG93ZXIgPiAwIik7CiAgICBpZiAocG93ZXIgPT09IF8wbjMpCiAgICAgIHJldHVybiBmMi5PTkU7CiAgICBpZiAocG93ZXIgPT09IF8xbjMpCiAgICAgIHJldHVybiBudW0yOwogICAgbGV0IHAgPSBmMi5PTkU7CiAgICBsZXQgZCA9IG51bTI7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcCA9IGYyLm11bChwLCBkKTsKICAgICAgZCA9IGYyLnNxcihkKTsKICAgICAgcG93ZXIgPj49IF8xbjM7CiAgICB9CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gRnBJbnZlcnRCYXRjaChmMiwgbnVtcykgewogICAgY29uc3QgdG1wID0gbmV3IEFycmF5KG51bXMubGVuZ3RoKTsKICAgIGNvbnN0IGxhc3RNdWx0aXBsaWVkID0gbnVtcy5yZWR1Y2UoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGFjYzsKICAgICAgcmV0dXJuIGYyLm11bChhY2MsIG51bTIpOwogICAgfSwgZjIuT05FKTsKICAgIGNvbnN0IGludmVydGVkID0gZjIuaW52KGxhc3RNdWx0aXBsaWVkKTsKICAgIG51bXMucmVkdWNlUmlnaHQoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGYyLm11bChhY2MsIHRtcFtpXSk7CiAgICAgIHJldHVybiBmMi5tdWwoYWNjLCBudW0yKTsKICAgIH0sIGludmVydGVkKTsKICAgIHJldHVybiB0bXA7CiAgfQogIGZ1bmN0aW9uIG5MZW5ndGgobiwgbkJpdExlbmd0aCkgewogICAgY29uc3QgX25CaXRMZW5ndGggPSBuQml0TGVuZ3RoICE9PSB2b2lkIDAgPyBuQml0TGVuZ3RoIDogbi50b1N0cmluZygyKS5sZW5ndGg7CiAgICBjb25zdCBuQnl0ZUxlbmd0aCA9IE1hdGguY2VpbChfbkJpdExlbmd0aCAvIDgpOwogICAgcmV0dXJuIHsgbkJpdExlbmd0aDogX25CaXRMZW5ndGgsIG5CeXRlTGVuZ3RoIH07CiAgfQogIGZ1bmN0aW9uIEZpZWxkKE9SREVSLCBiaXRMZW4yLCBpc0xFMiA9IGZhbHNlLCByZWRlZiA9IHt9KSB7CiAgICBpZiAoT1JERVIgPD0gXzBuMykKICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBGaWVsZCBPUkRFUiA+IDAsIGdvdCAke09SREVSfWApOwogICAgY29uc3QgeyBuQml0TGVuZ3RoOiBCSVRTLCBuQnl0ZUxlbmd0aDogQllURVMgfSA9IG5MZW5ndGgoT1JERVIsIGJpdExlbjIpOwogICAgaWYgKEJZVEVTID4gMjA0OCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGaWVsZCBsZW5ndGhzIG92ZXIgMjA0OCBieXRlcyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgY29uc3Qgc3FydFAgPSBGcFNxcnQoT1JERVIpOwogICAgY29uc3QgZjIgPSBPYmplY3QuZnJlZXplKHsKICAgICAgT1JERVIsCiAgICAgIEJJVFMsCiAgICAgIEJZVEVTLAogICAgICBNQVNLOiBiaXRNYXNrKEJJVFMpLAogICAgICBaRVJPOiBfMG4zLAogICAgICBPTkU6IF8xbjMsCiAgICAgIGNyZWF0ZTogKG51bTIpID0+IG1vZChudW0yLCBPUkRFUiksCiAgICAgIGlzVmFsaWQ6IChudW0yKSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiBudW0yICE9PSAiYmlnaW50IikKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBmaWVsZCBlbGVtZW50OiBleHBlY3RlZCBiaWdpbnQsIGdvdCAke3R5cGVvZiBudW0yfWApOwogICAgICAgIHJldHVybiBfMG4zIDw9IG51bTIgJiYgbnVtMiA8IE9SREVSOwogICAgICB9LAogICAgICBpczA6IChudW0yKSA9PiBudW0yID09PSBfMG4zLAogICAgICBpc09kZDogKG51bTIpID0+IChudW0yICYgXzFuMykgPT09IF8xbjMsCiAgICAgIG5lZzogKG51bTIpID0+IG1vZCgtbnVtMiwgT1JERVIpLAogICAgICBlcWw6IChsaHMsIHJocykgPT4gbGhzID09PSByaHMsCiAgICAgIHNxcjogKG51bTIpID0+IG1vZChudW0yICogbnVtMiwgT1JERVIpLAogICAgICBhZGQ6IChsaHMsIHJocykgPT4gbW9kKGxocyArIHJocywgT1JERVIpLAogICAgICBzdWI6IChsaHMsIHJocykgPT4gbW9kKGxocyAtIHJocywgT1JERVIpLAogICAgICBtdWw6IChsaHMsIHJocykgPT4gbW9kKGxocyAqIHJocywgT1JERVIpLAogICAgICBwb3c6IChudW0yLCBwb3dlcikgPT4gRnBQb3coZjIsIG51bTIsIHBvd2VyKSwKICAgICAgZGl2OiAobGhzLCByaHMpID0+IG1vZChsaHMgKiBpbnZlcnQocmhzLCBPUkRFUiksIE9SREVSKSwKICAgICAgLy8gU2FtZSBhcyBhYm92ZSwgYnV0IGRvZXNuJ3Qgbm9ybWFsaXplCiAgICAgIHNxck46IChudW0yKSA9PiBudW0yICogbnVtMiwKICAgICAgYWRkTjogKGxocywgcmhzKSA9PiBsaHMgKyByaHMsCiAgICAgIHN1Yk46IChsaHMsIHJocykgPT4gbGhzIC0gcmhzLAogICAgICBtdWxOOiAobGhzLCByaHMpID0+IGxocyAqIHJocywKICAgICAgaW52OiAobnVtMikgPT4gaW52ZXJ0KG51bTIsIE9SREVSKSwKICAgICAgc3FydDogcmVkZWYuc3FydCB8fCAoKG4pID0+IHNxcnRQKGYyLCBuKSksCiAgICAgIGludmVydEJhdGNoOiAobHN0KSA9PiBGcEludmVydEJhdGNoKGYyLCBsc3QpLAogICAgICAvLyBUT0RPOiBkbyB3ZSByZWFsbHkgbmVlZCBjb25zdGFudCBjbW92PwogICAgICAvLyBXZSBkb24ndCBoYXZlIGNvbnN0LXRpbWUgYmlnaW50cyBhbnl3YXksIHNvIHByb2JhYmx5IHdpbGwgYmUgbm90IHZlcnkgdXNlZnVsCiAgICAgIGNtb3Y6IChhLCBiLCBjKSA9PiBjID8gYiA6IGEsCiAgICAgIHRvQnl0ZXM6IChudW0yKSA9PiBpc0xFMiA/IG51bWJlclRvQnl0ZXNMRShudW0yLCBCWVRFUykgOiBudW1iZXJUb0J5dGVzQkUobnVtMiwgQllURVMpLAogICAgICBmcm9tQnl0ZXM6IChieXRlczIpID0+IHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCAhPT0gQllURVMpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZwLmZyb21CeXRlczogZXhwZWN0ZWQgJHtCWVRFU30sIGdvdCAke2J5dGVzMi5sZW5ndGh9YCk7CiAgICAgICAgcmV0dXJuIGlzTEUyID8gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgOiBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShmMik7CiAgfQogIGZ1bmN0aW9uIGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcikgewogICAgaWYgKHR5cGVvZiBmaWVsZE9yZGVyICE9PSAiYmlnaW50IikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaWVsZCBvcmRlciBtdXN0IGJlIGJpZ2ludCIpOwogICAgY29uc3QgYml0TGVuZ3RoID0gZmllbGRPcmRlci50b1N0cmluZygyKS5sZW5ndGg7CiAgICByZXR1cm4gTWF0aC5jZWlsKGJpdExlbmd0aCAvIDgpOwogIH0KICBmdW5jdGlvbiBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpIHsKICAgIGNvbnN0IGxlbmd0aCA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICByZXR1cm4gbGVuZ3RoICsgTWF0aC5jZWlsKGxlbmd0aCAvIDIpOwogIH0KICBmdW5jdGlvbiBtYXBIYXNoVG9GaWVsZChrZXksIGZpZWxkT3JkZXIsIGlzTEUyID0gZmFsc2UpIHsKICAgIGNvbnN0IGxlbiA9IGtleS5sZW5ndGg7CiAgICBjb25zdCBmaWVsZExlbiA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICBjb25zdCBtaW5MZW4gPSBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpOwogICAgaWYgKGxlbiA8IDE2IHx8IGxlbiA8IG1pbkxlbiB8fCBsZW4gPiAxMDI0KQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkICR7bWluTGVufS0xMDI0IGJ5dGVzIG9mIGlucHV0LCBnb3QgJHtsZW59YCk7CiAgICBjb25zdCBudW0yID0gaXNMRTIgPyBieXRlc1RvTnVtYmVyQkUoa2V5KSA6IGJ5dGVzVG9OdW1iZXJMRShrZXkpOwogICAgY29uc3QgcmVkdWNlZCA9IG1vZChudW0yLCBmaWVsZE9yZGVyIC0gXzFuMykgKyBfMW4zOwogICAgcmV0dXJuIGlzTEUyID8gbnVtYmVyVG9CeXRlc0xFKHJlZHVjZWQsIGZpZWxkTGVuKSA6IG51bWJlclRvQnl0ZXNCRShyZWR1Y2VkLCBmaWVsZExlbik7CiAgfQogIHZhciBfMG4zLCBfMW4zLCBfMm4zLCBfM24sIF80biwgXzVuLCBfOG4sIF85biwgXzE2biwgRklFTERfRklFTERTOwogIHZhciBpbml0X21vZHVsYXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L21vZHVsYXIuanMiKCkgewogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBfMG4zID0gQmlnSW50KDApOwogICAgICBfMW4zID0gQmlnSW50KDEpOwogICAgICBfMm4zID0gQmlnSW50KDIpOwogICAgICBfM24gPSBCaWdJbnQoMyk7CiAgICAgIF80biA9IEJpZ0ludCg0KTsKICAgICAgXzVuID0gQmlnSW50KDUpOwogICAgICBfOG4gPSBCaWdJbnQoOCk7CiAgICAgIF85biA9IEJpZ0ludCg5KTsKICAgICAgXzE2biA9IEJpZ0ludCgxNik7CiAgICAgIEZJRUxEX0ZJRUxEUyA9IFsKICAgICAgICAiY3JlYXRlIiwKICAgICAgICAiaXNWYWxpZCIsCiAgICAgICAgImlzMCIsCiAgICAgICAgIm5lZyIsCiAgICAgICAgImludiIsCiAgICAgICAgInNxcnQiLAogICAgICAgICJzcXIiLAogICAgICAgICJlcWwiLAogICAgICAgICJhZGQiLAogICAgICAgICJzdWIiLAogICAgICAgICJtdWwiLAogICAgICAgICJwb3ciLAogICAgICAgICJkaXYiLAogICAgICAgICJhZGROIiwKICAgICAgICAic3ViTiIsCiAgICAgICAgIm11bE4iLAogICAgICAgICJzcXJOIgogICAgICBdOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvY3VydmUuanMKICBmdW5jdGlvbiB3TkFGKGMsIGJpdHMpIHsKICAgIGNvbnN0IGNvbnN0VGltZU5lZ2F0ZSA9IChjb25kaXRpb24sIGl0ZW0pID0+IHsKICAgICAgY29uc3QgbmVnID0gaXRlbS5uZWdhdGUoKTsKICAgICAgcmV0dXJuIGNvbmRpdGlvbiA/IG5lZyA6IGl0ZW07CiAgICB9OwogICAgY29uc3QgdmFsaWRhdGVXID0gKFcpID0+IHsKICAgICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihXKSB8fCBXIDw9IDAgfHwgVyA+IGJpdHMpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBXcm9uZyB3aW5kb3cgc2l6ZT0ke1d9LCBzaG91bGQgYmUgWzEuLiR7Yml0c31dYCk7CiAgICB9OwogICAgY29uc3Qgb3B0cyA9IChXKSA9PiB7CiAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgY29uc3Qgd2luZG93cyA9IE1hdGguY2VpbChiaXRzIC8gVykgKyAxOwogICAgICBjb25zdCB3aW5kb3dTaXplID0gMiAqKiAoVyAtIDEpOwogICAgICByZXR1cm4geyB3aW5kb3dzLCB3aW5kb3dTaXplIH07CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgY29uc3RUaW1lTmVnYXRlLAogICAgICAvLyBub24tY29uc3QgdGltZSBtdWx0aXBsaWNhdGlvbiBsYWRkZXIKICAgICAgdW5zYWZlTGFkZGVyKGVsbSwgbikgewogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBkID0gZWxtOwogICAgICAgIHdoaWxlIChuID4gXzBuNCkgewogICAgICAgICAgaWYgKG4gJiBfMW40KQogICAgICAgICAgICBwID0gcC5hZGQoZCk7CiAgICAgICAgICBkID0gZC5kb3VibGUoKTsKICAgICAgICAgIG4gPj49IF8xbjQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwOwogICAgICB9LAogICAgICAvKioKICAgICAgICogQ3JlYXRlcyBhIHdOQUYgcHJlY29tcHV0YXRpb24gd2luZG93LiBVc2VkIGZvciBjYWNoaW5nLgogICAgICAgKiBEZWZhdWx0IHdpbmRvdyBzaXplIGlzIHNldCBieSBgdXRpbHMucHJlY29tcHV0ZSgpYCBhbmQgaXMgZXF1YWwgdG8gOC4KICAgICAgICogTnVtYmVyIG9mIHByZWNvbXB1dGVkIHBvaW50cyBkZXBlbmRzIG9uIHRoZSBjdXJ2ZSBzaXplOgogICAgICAgKiAyXijwnZGK4oiSMSkgKiAoTWF0aC5jZWlsKPCdkZsgLyDwnZGKKSArIDEpLCB3aGVyZToKICAgICAgICogLSDwnZGKIGlzIHRoZSB3aW5kb3cgc2l6ZQogICAgICAgKiAtIPCdkZsgaXMgdGhlIGJpdGxlbmd0aCBvZiB0aGUgY3VydmUgb3JkZXIuCiAgICAgICAqIEZvciBhIDI1Ni1iaXQgY3VydmUgYW5kIHdpbmRvdyBzaXplIDgsIHRoZSBudW1iZXIgb2YgcHJlY29tcHV0ZWQgcG9pbnRzIGlzIDEyOCAqIDMzID0gNDIyNC4KICAgICAgICogQHJldHVybnMgcHJlY29tcHV0ZWQgcG9pbnQgdGFibGVzIGZsYXR0ZW5lZCB0byBhIHNpbmdsZSBhcnJheQogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZVdpbmRvdyhlbG0sIFcpIHsKICAgICAgICBjb25zdCB7IHdpbmRvd3MsIHdpbmRvd1NpemUgfSA9IG9wdHMoVyk7CiAgICAgICAgY29uc3QgcG9pbnRzID0gW107CiAgICAgICAgbGV0IHAgPSBlbG07CiAgICAgICAgbGV0IGJhc2UyID0gcDsKICAgICAgICBmb3IgKGxldCB3aW5kb3cyID0gMDsgd2luZG93MiA8IHdpbmRvd3M7IHdpbmRvdzIrKykgewogICAgICAgICAgYmFzZTIgPSBwOwogICAgICAgICAgcG9pbnRzLnB1c2goYmFzZTIpOwogICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB3aW5kb3dTaXplOyBpKyspIHsKICAgICAgICAgICAgYmFzZTIgPSBiYXNlMi5hZGQocCk7CiAgICAgICAgICAgIHBvaW50cy5wdXNoKGJhc2UyKTsKICAgICAgICAgIH0KICAgICAgICAgIHAgPSBiYXNlMi5kb3VibGUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBvaW50czsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIEltcGxlbWVudHMgZWMgbXVsdGlwbGljYXRpb24gdXNpbmcgcHJlY29tcHV0ZWQgdGFibGVzIGFuZCB3LWFyeSBub24tYWRqYWNlbnQgZm9ybS4KICAgICAgICogQHBhcmFtIFcgd2luZG93IHNpemUKICAgICAgICogQHBhcmFtIHByZWNvbXB1dGVzIHByZWNvbXB1dGVkIHRhYmxlcwogICAgICAgKiBAcGFyYW0gbiBzY2FsYXIgKHdlIGRvbid0IGNoZWNrIGhlcmUsIGJ1dCBzaG91bGQgYmUgbGVzcyB0aGFuIGN1cnZlIG9yZGVyKQogICAgICAgKiBAcmV0dXJucyByZWFsIGFuZCBmYWtlIChmb3IgY29uc3QtdGltZSkgcG9pbnRzCiAgICAgICAqLwogICAgICB3TkFGKFcsIHByZWNvbXB1dGVzLCBuKSB7CiAgICAgICAgY29uc3QgeyB3aW5kb3dzLCB3aW5kb3dTaXplIH0gPSBvcHRzKFcpOwogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBmMiA9IGMuQkFTRTsKICAgICAgICBjb25zdCBtYXNrID0gQmlnSW50KDIgKiogVyAtIDEpOwogICAgICAgIGNvbnN0IG1heE51bWJlciA9IDIgKiogVzsKICAgICAgICBjb25zdCBzaGlmdEJ5ID0gQmlnSW50KFcpOwogICAgICAgIGZvciAobGV0IHdpbmRvdzIgPSAwOyB3aW5kb3cyIDwgd2luZG93czsgd2luZG93MisrKSB7CiAgICAgICAgICBjb25zdCBvZmZzZXQgPSB3aW5kb3cyICogd2luZG93U2l6ZTsKICAgICAgICAgIGxldCB3Yml0cyA9IE51bWJlcihuICYgbWFzayk7CiAgICAgICAgICBuID4+PSBzaGlmdEJ5OwogICAgICAgICAgaWYgKHdiaXRzID4gd2luZG93U2l6ZSkgewogICAgICAgICAgICB3Yml0cyAtPSBtYXhOdW1iZXI7CiAgICAgICAgICAgIG4gKz0gXzFuNDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IG9mZnNldDEgPSBvZmZzZXQ7CiAgICAgICAgICBjb25zdCBvZmZzZXQyID0gb2Zmc2V0ICsgTWF0aC5hYnMod2JpdHMpIC0gMTsKICAgICAgICAgIGNvbnN0IGNvbmQxID0gd2luZG93MiAlIDIgIT09IDA7CiAgICAgICAgICBjb25zdCBjb25kMiA9IHdiaXRzIDwgMDsKICAgICAgICAgIGlmICh3Yml0cyA9PT0gMCkgewogICAgICAgICAgICBmMiA9IGYyLmFkZChjb25zdFRpbWVOZWdhdGUoY29uZDEsIHByZWNvbXB1dGVzW29mZnNldDFdKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwID0gcC5hZGQoY29uc3RUaW1lTmVnYXRlKGNvbmQyLCBwcmVjb21wdXRlc1tvZmZzZXQyXSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4geyBwLCBmOiBmMiB9OwogICAgICB9LAogICAgICB3TkFGQ2FjaGVkKFAsIG4sIHRyYW5zZm9ybSkgewogICAgICAgIGNvbnN0IFcgPSBwb2ludFdpbmRvd1NpemVzLmdldChQKSB8fCAxOwogICAgICAgIGxldCBjb21wID0gcG9pbnRQcmVjb21wdXRlcy5nZXQoUCk7CiAgICAgICAgaWYgKCFjb21wKSB7CiAgICAgICAgICBjb21wID0gdGhpcy5wcmVjb21wdXRlV2luZG93KFAsIFcpOwogICAgICAgICAgaWYgKFcgIT09IDEpCiAgICAgICAgICAgIHBvaW50UHJlY29tcHV0ZXMuc2V0KFAsIHRyYW5zZm9ybShjb21wKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLndOQUYoVywgY29tcCwgbik7CiAgICAgIH0sCiAgICAgIC8vIFdlIGNhbGN1bGF0ZSBwcmVjb21wdXRlcyBmb3IgZWxsaXB0aWMgY3VydmUgcG9pbnQgbXVsdGlwbGljYXRpb24KICAgICAgLy8gdXNpbmcgd2luZG93ZWQgbWV0aG9kLiBUaGlzIHNwZWNpZmllcyB3aW5kb3cgc2l6ZSBhbmQKICAgICAgLy8gc3RvcmVzIHByZWNvbXB1dGVkIHZhbHVlcy4gVXN1YWxseSBvbmx5IGJhc2UgcG9pbnQgd291bGQgYmUgcHJlY29tcHV0ZWQuCiAgICAgIHNldFdpbmRvd1NpemUoUCwgVykgewogICAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgICBwb2ludFdpbmRvd1NpemVzLnNldChQLCBXKTsKICAgICAgICBwb2ludFByZWNvbXB1dGVzLmRlbGV0ZShQKTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gcGlwcGVuZ2VyKGMsIGZpZWxkLCBwb2ludHMsIHNjYWxhcnMpIHsKICAgIGlmICghQXJyYXkuaXNBcnJheShwb2ludHMpIHx8ICFBcnJheS5pc0FycmF5KHNjYWxhcnMpIHx8IHNjYWxhcnMubGVuZ3RoICE9PSBwb2ludHMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImFycmF5cyBvZiBwb2ludHMgYW5kIHNjYWxhcnMgbXVzdCBoYXZlIGVxdWFsIGxlbmd0aCIpOwogICAgc2NhbGFycy5mb3JFYWNoKChzLCBpKSA9PiB7CiAgICAgIGlmICghZmllbGQuaXNWYWxpZChzKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHNjYWxhciBhdCBpbmRleCAke2l9YCk7CiAgICB9KTsKICAgIHBvaW50cy5mb3JFYWNoKChwLCBpKSA9PiB7CiAgICAgIGlmICghKHAgaW5zdGFuY2VvZiBjKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHBvaW50IGF0IGluZGV4ICR7aX1gKTsKICAgIH0pOwogICAgY29uc3Qgd2JpdHMgPSBiaXRMZW4oQmlnSW50KHBvaW50cy5sZW5ndGgpKTsKICAgIGNvbnN0IHdpbmRvd1NpemUgPSB3Yml0cyA+IDEyID8gd2JpdHMgLSAzIDogd2JpdHMgPiA0ID8gd2JpdHMgLSAyIDogd2JpdHMgPyAyIDogMTsKICAgIGNvbnN0IE1BU0sgPSAoMSA8PCB3aW5kb3dTaXplKSAtIDE7CiAgICBjb25zdCBidWNrZXRzID0gbmV3IEFycmF5KE1BU0sgKyAxKS5maWxsKGMuWkVSTyk7CiAgICBjb25zdCBsYXN0Qml0cyA9IE1hdGguZmxvb3IoKGZpZWxkLkJJVFMgLSAxKSAvIHdpbmRvd1NpemUpICogd2luZG93U2l6ZTsKICAgIGxldCBzdW0gPSBjLlpFUk87CiAgICBmb3IgKGxldCBpID0gbGFzdEJpdHM7IGkgPj0gMDsgaSAtPSB3aW5kb3dTaXplKSB7CiAgICAgIGJ1Y2tldHMuZmlsbChjLlpFUk8pOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNjYWxhcnMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjb25zdCBzY2FsYXIgPSBzY2FsYXJzW2pdOwogICAgICAgIGNvbnN0IHdiaXRzMiA9IE51bWJlcihzY2FsYXIgPj4gQmlnSW50KGkpICYgQmlnSW50KE1BU0spKTsKICAgICAgICBidWNrZXRzW3diaXRzMl0gPSBidWNrZXRzW3diaXRzMl0uYWRkKHBvaW50c1tqXSk7CiAgICAgIH0KICAgICAgbGV0IHJlc0kgPSBjLlpFUk87CiAgICAgIGZvciAobGV0IGogPSBidWNrZXRzLmxlbmd0aCAtIDEsIHN1bUkgPSBjLlpFUk87IGogPiAwOyBqLS0pIHsKICAgICAgICBzdW1JID0gc3VtSS5hZGQoYnVja2V0c1tqXSk7CiAgICAgICAgcmVzSSA9IHJlc0kuYWRkKHN1bUkpOwogICAgICB9CiAgICAgIHN1bSA9IHN1bS5hZGQocmVzSSk7CiAgICAgIGlmIChpICE9PSAwKQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2luZG93U2l6ZTsgaisrKQogICAgICAgICAgc3VtID0gc3VtLmRvdWJsZSgpOwogICAgfQogICAgcmV0dXJuIHN1bTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVCYXNpYyhjdXJ2ZSkgewogICAgdmFsaWRhdGVGaWVsZChjdXJ2ZS5GcCk7CiAgICB2YWxpZGF0ZU9iamVjdChjdXJ2ZSwgewogICAgICBuOiAiYmlnaW50IiwKICAgICAgaDogImJpZ2ludCIsCiAgICAgIEd4OiAiZmllbGQiLAogICAgICBHeTogImZpZWxkIgogICAgfSwgewogICAgICBuQml0TGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIG5CeXRlTGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoewogICAgICAuLi5uTGVuZ3RoKGN1cnZlLm4sIGN1cnZlLm5CaXRMZW5ndGgpLAogICAgICAuLi5jdXJ2ZSwKICAgICAgLi4ueyBwOiBjdXJ2ZS5GcC5PUkRFUiB9CiAgICB9KTsKICB9CiAgdmFyIF8wbjQsIF8xbjQsIHBvaW50UHJlY29tcHV0ZXMsIHBvaW50V2luZG93U2l6ZXM7CiAgdmFyIGluaXRfY3VydmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzIigpIHsKICAgICAgaW5pdF9tb2R1bGFyKCk7CiAgICAgIGluaXRfdXRpbHM0KCk7CiAgICAgIF8wbjQgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjQgPSBCaWdJbnQoMSk7CiAgICAgIHBvaW50UHJlY29tcHV0ZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICAgICAgcG9pbnRXaW5kb3dTaXplcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3Qvd2VpZXJzdHJhc3MuanMKICBmdW5jdGlvbiB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cykgewogICAgaWYgKG9wdHMubG93UyAhPT0gdm9pZCAwKQogICAgICBhYm9vbCgibG93UyIsIG9wdHMubG93Uyk7CiAgICBpZiAob3B0cy5wcmVoYXNoICE9PSB2b2lkIDApCiAgICAgIGFib29sKCJwcmVoYXNoIiwgb3B0cy5wcmVoYXNoKTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVQb2ludE9wdHMoY3VydmUpIHsKICAgIGNvbnN0IG9wdHMgPSB2YWxpZGF0ZUJhc2ljKGN1cnZlKTsKICAgIHZhbGlkYXRlT2JqZWN0KG9wdHMsIHsKICAgICAgYTogImZpZWxkIiwKICAgICAgYjogImZpZWxkIgogICAgfSwgewogICAgICBhbGxvd2VkUHJpdmF0ZUtleUxlbmd0aHM6ICJhcnJheSIsCiAgICAgIHdyYXBQcml2YXRlS2V5OiAiYm9vbGVhbiIsCiAgICAgIGlzVG9yc2lvbkZyZWU6ICJmdW5jdGlvbiIsCiAgICAgIGNsZWFyQ29mYWN0b3I6ICJmdW5jdGlvbiIsCiAgICAgIGFsbG93SW5maW5pdHlQb2ludDogImJvb2xlYW4iLAogICAgICBmcm9tQnl0ZXM6ICJmdW5jdGlvbiIsCiAgICAgIHRvQnl0ZXM6ICJmdW5jdGlvbiIKICAgIH0pOwogICAgY29uc3QgeyBlbmRvLCBGcDogRnAyLCBhIH0gPSBvcHRzOwogICAgaWYgKGVuZG8pIHsKICAgICAgaWYgKCFGcDIuZXFsKGEsIEZwMi5aRVJPKSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRW5kb21vcnBoaXNtIGNhbiBvbmx5IGJlIGRlZmluZWQgZm9yIEtvYmxpdHogY3VydmVzIHRoYXQgaGF2ZSBhPTAiKTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIGVuZG8gIT09ICJvYmplY3QiIHx8IHR5cGVvZiBlbmRvLmJldGEgIT09ICJiaWdpbnQiIHx8IHR5cGVvZiBlbmRvLnNwbGl0U2NhbGFyICE9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBlbmRvbW9ycGhpc20gd2l0aCBiZXRhOiBiaWdpbnQgYW5kIHNwbGl0U2NhbGFyOiBmdW5jdGlvbiIpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLm9wdHMgfSk7CiAgfQogIGZ1bmN0aW9uIHdlaWVyc3RyYXNzUG9pbnRzKG9wdHMpIHsKICAgIGNvbnN0IENVUlZFID0gdmFsaWRhdGVQb2ludE9wdHMob3B0cyk7CiAgICBjb25zdCB7IEZwOiBGcDIgfSA9IENVUlZFOwogICAgY29uc3QgRm4gPSBGaWVsZChDVVJWRS5uLCBDVVJWRS5uQml0TGVuZ3RoKTsKICAgIGNvbnN0IHRvQnl0ZXMzID0gQ1VSVkUudG9CeXRlcyB8fCAoKF9jLCBwb2ludCwgX2lzQ29tcHJlc3NlZCkgPT4gewogICAgICBjb25zdCBhID0gcG9pbnQudG9BZmZpbmUoKTsKICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyhVaW50OEFycmF5LmZyb20oWzRdKSwgRnAyLnRvQnl0ZXMoYS54KSwgRnAyLnRvQnl0ZXMoYS55KSk7CiAgICB9KTsKICAgIGNvbnN0IGZyb21CeXRlczIgPSBDVVJWRS5mcm9tQnl0ZXMgfHwgKChieXRlczIpID0+IHsKICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgY29uc3QgeCA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheSgwLCBGcDIuQllURVMpKTsKICAgICAgY29uc3QgeSA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheShGcDIuQllURVMsIDIgKiBGcDIuQllURVMpKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfSk7CiAgICBmdW5jdGlvbiB3ZWllcnN0cmFzc0VxdWF0aW9uKHgpIHsKICAgICAgY29uc3QgeyBhLCBiIH0gPSBDVVJWRTsKICAgICAgY29uc3QgeDIgPSBGcDIuc3FyKHgpOwogICAgICBjb25zdCB4MyA9IEZwMi5tdWwoeDIsIHgpOwogICAgICByZXR1cm4gRnAyLmFkZChGcDIuYWRkKHgzLCBGcDIubXVsKHgsIGEpKSwgYik7CiAgICB9CiAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihDVVJWRS5HeSksIHdlaWVyc3RyYXNzRXF1YXRpb24oQ1VSVkUuR3gpKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgZ2VuZXJhdG9yIHBvaW50OiBlcXVhdGlvbiBsZWZ0ICE9IHJpZ2h0Iik7CiAgICBmdW5jdGlvbiBpc1dpdGhpbkN1cnZlT3JkZXIobnVtMikgewogICAgICByZXR1cm4gaW5SYW5nZShudW0yLCBfMW41LCBDVVJWRS5uKTsKICAgIH0KICAgIGZ1bmN0aW9uIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIoa2V5KSB7CiAgICAgIGNvbnN0IHsgYWxsb3dlZFByaXZhdGVLZXlMZW5ndGhzOiBsZW5ndGhzLCBuQnl0ZUxlbmd0aCwgd3JhcFByaXZhdGVLZXksIG46IE4gfSA9IENVUlZFOwogICAgICBpZiAobGVuZ3RocyAmJiB0eXBlb2Yga2V5ICE9PSAiYmlnaW50IikgewogICAgICAgIGlmIChpc0J5dGVzMihrZXkpKQogICAgICAgICAga2V5ID0gYnl0ZXNUb0hleDIoa2V5KTsKICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gInN0cmluZyIgfHwgIWxlbmd0aHMuaW5jbHVkZXMoa2V5Lmxlbmd0aCkpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQga2V5Iik7CiAgICAgICAga2V5ID0ga2V5LnBhZFN0YXJ0KG5CeXRlTGVuZ3RoICogMiwgIjAiKTsKICAgICAgfQogICAgICBsZXQgbnVtMjsKICAgICAgdHJ5IHsKICAgICAgICBudW0yID0gdHlwZW9mIGtleSA9PT0gImJpZ2ludCIgPyBrZXkgOiBieXRlc1RvTnVtYmVyQkUoZW5zdXJlQnl0ZXMoInByaXZhdGUga2V5Iiwga2V5LCBuQnl0ZUxlbmd0aCkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgcHJpdmF0ZSBrZXkgbXVzdCBiZSAke25CeXRlTGVuZ3RofSBieXRlcywgaGV4IG9yIGJpZ2ludCwgbm90ICR7dHlwZW9mIGtleX1gKTsKICAgICAgfQogICAgICBpZiAod3JhcFByaXZhdGVLZXkpCiAgICAgICAgbnVtMiA9IG1vZChudW0yLCBOKTsKICAgICAgYUluUmFuZ2UoInByaXZhdGUga2V5IiwgbnVtMiwgXzFuNSwgTik7CiAgICAgIHJldHVybiBudW0yOwogICAgfQogICAgZnVuY3Rpb24gYXNzZXJ0UHJqUG9pbnQob3RoZXIpIHsKICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQb2ludDIpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvamVjdGl2ZVBvaW50IGV4cGVjdGVkIik7CiAgICB9CiAgICBjb25zdCB0b0FmZmluZU1lbW8gPSBtZW1vaXplZCgocCwgaXopID0+IHsKICAgICAgY29uc3QgeyBweDogeCwgcHk6IHksIHB6OiB6IH0gPSBwOwogICAgICBpZiAoRnAyLmVxbCh6LCBGcDIuT05FKSkKICAgICAgICByZXR1cm4geyB4LCB5IH07CiAgICAgIGNvbnN0IGlzMCA9IHAuaXMwKCk7CiAgICAgIGlmIChpeiA9PSBudWxsKQogICAgICAgIGl6ID0gaXMwID8gRnAyLk9ORSA6IEZwMi5pbnYoeik7CiAgICAgIGNvbnN0IGF4ID0gRnAyLm11bCh4LCBpeik7CiAgICAgIGNvbnN0IGF5ID0gRnAyLm11bCh5LCBpeik7CiAgICAgIGNvbnN0IHp6ID0gRnAyLm11bCh6LCBpeik7CiAgICAgIGlmIChpczApCiAgICAgICAgcmV0dXJuIHsgeDogRnAyLlpFUk8sIHk6IEZwMi5aRVJPIH07CiAgICAgIGlmICghRnAyLmVxbCh6eiwgRnAyLk9ORSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZaIHdhcyBpbnZhbGlkIik7CiAgICAgIHJldHVybiB7IHg6IGF4LCB5OiBheSB9OwogICAgfSk7CiAgICBjb25zdCBhc3NlcnRWYWxpZE1lbW8gPSBtZW1vaXplZCgocCkgPT4gewogICAgICBpZiAocC5pczAoKSkgewogICAgICAgIGlmIChDVVJWRS5hbGxvd0luZmluaXR5UG9pbnQgJiYgIUZwMi5pczAocC5weSkpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IFpFUk8iKTsKICAgICAgfQogICAgICBjb25zdCB7IHgsIHkgfSA9IHAudG9BZmZpbmUoKTsKICAgICAgaWYgKCFGcDIuaXNWYWxpZCh4KSB8fCAhRnAyLmlzVmFsaWQoeSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IHggb3IgeSBub3QgRkUiKTsKICAgICAgY29uc3QgbGVmdCA9IEZwMi5zcXIoeSk7CiAgICAgIGNvbnN0IHJpZ2h0ID0gd2VpZXJzdHJhc3NFcXVhdGlvbih4KTsKICAgICAgaWYgKCFGcDIuZXFsKGxlZnQsIHJpZ2h0KSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImJhZCBwb2ludDogZXF1YXRpb24gbGVmdCAhPSByaWdodCIpOwogICAgICBpZiAoIXAuaXNUb3JzaW9uRnJlZSgpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiYmFkIHBvaW50OiBub3QgaW4gcHJpbWUtb3JkZXIgc3ViZ3JvdXAiKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKICAgIGNsYXNzIFBvaW50MiB7CiAgICAgIGNvbnN0cnVjdG9yKHB4LCBweSwgcHopIHsKICAgICAgICB0aGlzLnB4ID0gcHg7CiAgICAgICAgdGhpcy5weSA9IHB5OwogICAgICAgIHRoaXMucHogPSBwejsKICAgICAgICBpZiAocHggPT0gbnVsbCB8fCAhRnAyLmlzVmFsaWQocHgpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJ4IHJlcXVpcmVkIik7CiAgICAgICAgaWYgKHB5ID09IG51bGwgfHwgIUZwMi5pc1ZhbGlkKHB5KSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigieSByZXF1aXJlZCIpOwogICAgICAgIGlmIChweiA9PSBudWxsIHx8ICFGcDIuaXNWYWxpZChweikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInogcmVxdWlyZWQiKTsKICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMpOwogICAgICB9CiAgICAgIC8vIERvZXMgbm90IHZhbGlkYXRlIGlmIHRoZSBwb2ludCBpcyBvbi1jdXJ2ZS4KICAgICAgLy8gVXNlIGZyb21IZXggaW5zdGVhZCwgb3IgY2FsbCBhc3NlcnRWYWxpZGl0eSgpIGxhdGVyLgogICAgICBzdGF0aWMgZnJvbUFmZmluZShwKSB7CiAgICAgICAgY29uc3QgeyB4LCB5IH0gPSBwIHx8IHt9OwogICAgICAgIGlmICghcCB8fCAhRnAyLmlzVmFsaWQoeCkgfHwgIUZwMi5pc1ZhbGlkKHkpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGFmZmluZSBwb2ludCIpOwogICAgICAgIGlmIChwIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJwcm9qZWN0aXZlIHBvaW50IG5vdCBhbGxvd2VkIik7CiAgICAgICAgY29uc3QgaXMwID0gKGkpID0+IEZwMi5lcWwoaSwgRnAyLlpFUk8pOwogICAgICAgIGlmIChpczAoeCkgJiYgaXMwKHkpKQogICAgICAgICAgcmV0dXJuIFBvaW50Mi5aRVJPOwogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHgsIHksIEZwMi5PTkUpOwogICAgICB9CiAgICAgIGdldCB4KCkgewogICAgICAgIHJldHVybiB0aGlzLnRvQWZmaW5lKCkueDsKICAgICAgfQogICAgICBnZXQgeSgpIHsKICAgICAgICByZXR1cm4gdGhpcy50b0FmZmluZSgpLnk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIFRha2VzIGEgYnVuY2ggb2YgUHJvamVjdGl2ZSBQb2ludHMgYnV0IGV4ZWN1dGVzIG9ubHkgb25lCiAgICAgICAqIGludmVyc2lvbiBvbiBhbGwgb2YgdGhlbS4gSW52ZXJzaW9uIGlzIHZlcnkgc2xvdyBvcGVyYXRpb24sCiAgICAgICAqIHNvIHRoaXMgaW1wcm92ZXMgcGVyZm9ybWFuY2UgbWFzc2l2ZWx5LgogICAgICAgKiBPcHRpbWl6YXRpb246IGNvbnZlcnRzIGEgbGlzdCBvZiBwcm9qZWN0aXZlIHBvaW50cyB0byBhIGxpc3Qgb2YgaWRlbnRpY2FsIHBvaW50cyB3aXRoIFo9MS4KICAgICAgICovCiAgICAgIHN0YXRpYyBub3JtYWxpemVaKHBvaW50cykgewogICAgICAgIGNvbnN0IHRvSW52ID0gRnAyLmludmVydEJhdGNoKHBvaW50cy5tYXAoKHApID0+IHAucHopKTsKICAgICAgICByZXR1cm4gcG9pbnRzLm1hcCgocCwgaSkgPT4gcC50b0FmZmluZSh0b0ludltpXSkpLm1hcChQb2ludDIuZnJvbUFmZmluZSk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIENvbnZlcnRzIGhhc2ggc3RyaW5nIG9yIFVpbnQ4QXJyYXkgdG8gUG9pbnQuCiAgICAgICAqIEBwYXJhbSBoZXggc2hvcnQvbG9uZyBFQ0RTQSBoZXgKICAgICAgICovCiAgICAgIHN0YXRpYyBmcm9tSGV4KGhleCkgewogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShmcm9tQnl0ZXMyKGVuc3VyZUJ5dGVzKCJwb2ludEhleCIsIGhleCkpKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0KICAgICAgLy8gTXVsdGlwbGllcyBnZW5lcmF0b3IgcG9pbnQgYnkgcHJpdmF0ZUtleS4KICAgICAgc3RhdGljIGZyb21Qcml2YXRlS2V5KHByaXZhdGVLZXkpIHsKICAgICAgICByZXR1cm4gUG9pbnQyLkJBU0UubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlS2V5KSk7CiAgICAgIH0KICAgICAgLy8gTXVsdGlzY2FsYXIgTXVsdGlwbGljYXRpb24KICAgICAgc3RhdGljIG1zbShwb2ludHMsIHNjYWxhcnMpIHsKICAgICAgICByZXR1cm4gcGlwcGVuZ2VyKFBvaW50MiwgRm4sIHBvaW50cywgc2NhbGFycyk7CiAgICAgIH0KICAgICAgLy8gIlByaXZhdGUgbWV0aG9kIiwgZG9uJ3QgdXNlIGl0IGRpcmVjdGx5CiAgICAgIF9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpIHsKICAgICAgICB3bmFmLnNldFdpbmRvd1NpemUodGhpcywgd2luZG93U2l6ZSk7CiAgICAgIH0KICAgICAgLy8gQSBwb2ludCBvbiBjdXJ2ZSBpcyB2YWxpZCBpZiBpdCBjb25mb3JtcyB0byBlcXVhdGlvbi4KICAgICAgYXNzZXJ0VmFsaWRpdHkoKSB7CiAgICAgICAgYXNzZXJ0VmFsaWRNZW1vKHRoaXMpOwogICAgICB9CiAgICAgIGhhc0V2ZW5ZKCkgewogICAgICAgIGNvbnN0IHsgeSB9ID0gdGhpcy50b0FmZmluZSgpOwogICAgICAgIGlmIChGcDIuaXNPZGQpCiAgICAgICAgICByZXR1cm4gIUZwMi5pc09kZCh5KTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZpZWxkIGRvZXNuJ3Qgc3VwcG9ydCBpc09kZCIpOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb21wYXJlIG9uZSBwb2ludCB0byBhbm90aGVyLgogICAgICAgKi8KICAgICAgZXF1YWxzKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGNvbnN0IFUxID0gRnAyLmVxbChGcDIubXVsKFgxLCBaMiksIEZwMi5tdWwoWDIsIFoxKSk7CiAgICAgICAgY29uc3QgVTIgPSBGcDIuZXFsKEZwMi5tdWwoWTEsIFoyKSwgRnAyLm11bChZMiwgWjEpKTsKICAgICAgICByZXR1cm4gVTEgJiYgVTI7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIEZsaXBzIHBvaW50IHRvIG9uZSBjb3JyZXNwb25kaW5nIHRvICh4LCAteSkgaW4gQWZmaW5lIGNvb3JkaW5hdGVzLgogICAgICAgKi8KICAgICAgbmVnYXRlKCkgewogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHRoaXMucHgsIEZwMi5uZWcodGhpcy5weSksIHRoaXMucHopOwogICAgICB9CiAgICAgIC8vIFJlbmVzLUNvc3RlbGxvLUJhdGluYSBleGNlcHRpb24tZnJlZSBkb3VibGluZyBmb3JtdWxhLgogICAgICAvLyBUaGVyZSBpcyAzMCUgZmFzdGVyIEphY29iaWFuIGZvcm11bGEsIGJ1dCBpdCBpcyBub3QgY29tcGxldGUuCiAgICAgIC8vIGh0dHBzOi8vZXByaW50LmlhY3Iub3JnLzIwMTUvMTA2MCwgYWxnb3JpdGhtIDMKICAgICAgLy8gQ29zdDogOE0gKyAzUyArIDMqYSArIDIqYjMgKyAxNWFkZC4KICAgICAgZG91YmxlKCkgewogICAgICAgIGNvbnN0IHsgYSwgYiB9ID0gQ1VSVkU7CiAgICAgICAgY29uc3QgYjMyID0gRnAyLm11bChiLCBfM24yKTsKICAgICAgICBjb25zdCB7IHB4OiBYMSwgcHk6IFkxLCBwejogWjEgfSA9IHRoaXM7CiAgICAgICAgbGV0IFgzID0gRnAyLlpFUk8sIFkzID0gRnAyLlpFUk8sIFozID0gRnAyLlpFUk87CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDEpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkxKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMSk7CiAgICAgICAgbGV0IHQzID0gRnAyLm11bChYMSwgWTEpOwogICAgICAgIHQzID0gRnAyLmFkZCh0MywgdDMpOwogICAgICAgIFozID0gRnAyLm11bChYMSwgWjEpOwogICAgICAgIFozID0gRnAyLmFkZChaMywgWjMpOwogICAgICAgIFgzID0gRnAyLm11bChhLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKGIzMiwgdDIpOwogICAgICAgIFkzID0gRnAyLmFkZChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLnN1Yih0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLmFkZCh0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLm11bChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLm11bCh0MywgWDMpOwogICAgICAgIFozID0gRnAyLm11bChiMzIsIFozKTsKICAgICAgICB0MiA9IEZwMi5tdWwoYSwgdDIpOwogICAgICAgIHQzID0gRnAyLnN1Yih0MCwgdDIpOwogICAgICAgIHQzID0gRnAyLm11bChhLCB0Myk7CiAgICAgICAgdDMgPSBGcDIuYWRkKHQzLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKFozLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQwLCB0Myk7CiAgICAgICAgWTMgPSBGcDIuYWRkKFkzLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKFkxLCBaMSk7CiAgICAgICAgdDIgPSBGcDIuYWRkKHQyLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQyLCB0Myk7CiAgICAgICAgWDMgPSBGcDIuc3ViKFgzLCB0MCk7CiAgICAgICAgWjMgPSBGcDIubXVsKHQyLCB0MSk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgcmV0dXJuIG5ldyBQb2ludDIoWDMsIFkzLCBaMyk7CiAgICAgIH0KICAgICAgLy8gUmVuZXMtQ29zdGVsbG8tQmF0aW5hIGV4Y2VwdGlvbi1mcmVlIGFkZGl0aW9uIGZvcm11bGEuCiAgICAgIC8vIFRoZXJlIGlzIDMwJSBmYXN0ZXIgSmFjb2JpYW4gZm9ybXVsYSwgYnV0IGl0IGlzIG5vdCBjb21wbGV0ZS4KICAgICAgLy8gaHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAxNS8xMDYwLCBhbGdvcml0aG0gMQogICAgICAvLyBDb3N0OiAxMk0gKyAwUyArIDMqYSArIDMqYjMgKyAyM2FkZC4KICAgICAgYWRkKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGxldCBYMyA9IEZwMi5aRVJPLCBZMyA9IEZwMi5aRVJPLCBaMyA9IEZwMi5aRVJPOwogICAgICAgIGNvbnN0IGEgPSBDVVJWRS5hOwogICAgICAgIGNvbnN0IGIzMiA9IEZwMi5tdWwoQ1VSVkUuYiwgXzNuMik7CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDIpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkyKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMik7CiAgICAgICAgbGV0IHQzID0gRnAyLmFkZChYMSwgWTEpOwogICAgICAgIGxldCB0NCA9IEZwMi5hZGQoWDIsIFkyKTsKICAgICAgICB0MyA9IEZwMi5tdWwodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQodDAsIHQxKTsKICAgICAgICB0MyA9IEZwMi5zdWIodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQoWDEsIFoxKTsKICAgICAgICBsZXQgdDUgPSBGcDIuYWRkKFgyLCBaMik7CiAgICAgICAgdDQgPSBGcDIubXVsKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDQgPSBGcDIuc3ViKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKFkxLCBaMSk7CiAgICAgICAgWDMgPSBGcDIuYWRkKFkyLCBaMik7CiAgICAgICAgdDUgPSBGcDIubXVsKHQ1LCBYMyk7CiAgICAgICAgWDMgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDUgPSBGcDIuc3ViKHQ1LCBYMyk7CiAgICAgICAgWjMgPSBGcDIubXVsKGEsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwoYjMyLCB0Mik7CiAgICAgICAgWjMgPSBGcDIuYWRkKFgzLCBaMyk7CiAgICAgICAgWDMgPSBGcDIuc3ViKHQxLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQxLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKFgzLCBaMyk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5tdWwoYjMyLCB0NCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDIgPSBGcDIuc3ViKHQwLCB0Mik7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5hZGQodDQsIHQyKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDEsIHQ0KTsKICAgICAgICBZMyA9IEZwMi5hZGQoWTMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDUsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwodDMsIFgzKTsKICAgICAgICBYMyA9IEZwMi5zdWIoWDMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDMsIHQxKTsKICAgICAgICBaMyA9IEZwMi5tdWwodDUsIFozKTsKICAgICAgICBaMyA9IEZwMi5hZGQoWjMsIHQwKTsKICAgICAgICByZXR1cm4gbmV3IFBvaW50MihYMywgWTMsIFozKTsKICAgICAgfQogICAgICBzdWJ0cmFjdChvdGhlcikgewogICAgICAgIHJldHVybiB0aGlzLmFkZChvdGhlci5uZWdhdGUoKSk7CiAgICAgIH0KICAgICAgaXMwKCkgewogICAgICAgIHJldHVybiB0aGlzLmVxdWFscyhQb2ludDIuWkVSTyk7CiAgICAgIH0KICAgICAgd05BRihuKSB7CiAgICAgICAgcmV0dXJuIHduYWYud05BRkNhY2hlZCh0aGlzLCBuLCBQb2ludDIubm9ybWFsaXplWik7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIE5vbi1jb25zdGFudC10aW1lIG11bHRpcGxpY2F0aW9uLiBVc2VzIGRvdWJsZS1hbmQtYWRkIGFsZ29yaXRobS4KICAgICAgICogSXQncyBmYXN0ZXIsIGJ1dCBzaG91bGQgb25seSBiZSB1c2VkIHdoZW4geW91IGRvbid0IGNhcmUgYWJvdXQKICAgICAgICogYW4gZXhwb3NlZCBwcml2YXRlIGtleSBlLmcuIHNpZyB2ZXJpZmljYXRpb24sIHdoaWNoIHdvcmtzIG92ZXIgKnB1YmxpYyoga2V5cy4KICAgICAgICovCiAgICAgIG11bHRpcGx5VW5zYWZlKHNjKSB7CiAgICAgICAgYUluUmFuZ2UoInNjYWxhciIsIHNjLCBfMG41LCBDVVJWRS5uKTsKICAgICAgICBjb25zdCBJID0gUG9pbnQyLlpFUk87CiAgICAgICAgaWYgKHNjID09PSBfMG41KQogICAgICAgICAgcmV0dXJuIEk7CiAgICAgICAgaWYgKHNjID09PSBfMW41KQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgY29uc3QgeyBlbmRvIH0gPSBDVVJWRTsKICAgICAgICBpZiAoIWVuZG8pCiAgICAgICAgICByZXR1cm4gd25hZi51bnNhZmVMYWRkZXIodGhpcywgc2MpOwogICAgICAgIGxldCB7IGsxbmVnLCBrMSwgazJuZWcsIGsyIH0gPSBlbmRvLnNwbGl0U2NhbGFyKHNjKTsKICAgICAgICBsZXQgazFwID0gSTsKICAgICAgICBsZXQgazJwID0gSTsKICAgICAgICBsZXQgZCA9IHRoaXM7CiAgICAgICAgd2hpbGUgKGsxID4gXzBuNSB8fCBrMiA+IF8wbjUpIHsKICAgICAgICAgIGlmIChrMSAmIF8xbjUpCiAgICAgICAgICAgIGsxcCA9IGsxcC5hZGQoZCk7CiAgICAgICAgICBpZiAoazIgJiBfMW41KQogICAgICAgICAgICBrMnAgPSBrMnAuYWRkKGQpOwogICAgICAgICAgZCA9IGQuZG91YmxlKCk7CiAgICAgICAgICBrMSA+Pj0gXzFuNTsKICAgICAgICAgIGsyID4+PSBfMW41OwogICAgICAgIH0KICAgICAgICBpZiAoazFuZWcpCiAgICAgICAgICBrMXAgPSBrMXAubmVnYXRlKCk7CiAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgazJwID0gazJwLm5lZ2F0ZSgpOwogICAgICAgIGsycCA9IG5ldyBQb2ludDIoRnAyLm11bChrMnAucHgsIGVuZG8uYmV0YSksIGsycC5weSwgazJwLnB6KTsKICAgICAgICByZXR1cm4gazFwLmFkZChrMnApOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb25zdGFudCB0aW1lIG11bHRpcGxpY2F0aW9uLgogICAgICAgKiBVc2VzIHdOQUYgbWV0aG9kLiBXaW5kb3dlZCBtZXRob2QgbWF5IGJlIDEwJSBmYXN0ZXIsCiAgICAgICAqIGJ1dCB0YWtlcyAyeCBsb25nZXIgdG8gZ2VuZXJhdGUgYW5kIGNvbnN1bWVzIDJ4IG1lbW9yeS4KICAgICAgICogVXNlcyBwcmVjb21wdXRlcyB3aGVuIGF2YWlsYWJsZS4KICAgICAgICogVXNlcyBlbmRvbW9ycGhpc20gZm9yIEtvYmxpdHogY3VydmVzLgogICAgICAgKiBAcGFyYW0gc2NhbGFyIGJ5IHdoaWNoIHRoZSBwb2ludCB3b3VsZCBiZSBtdWx0aXBsaWVkCiAgICAgICAqIEByZXR1cm5zIE5ldyBwb2ludAogICAgICAgKi8KICAgICAgbXVsdGlwbHkoc2NhbGFyKSB7CiAgICAgICAgY29uc3QgeyBlbmRvLCBuOiBOIH0gPSBDVVJWRTsKICAgICAgICBhSW5SYW5nZSgic2NhbGFyIiwgc2NhbGFyLCBfMW41LCBOKTsKICAgICAgICBsZXQgcG9pbnQsIGZha2U7CiAgICAgICAgaWYgKGVuZG8pIHsKICAgICAgICAgIGNvbnN0IHsgazFuZWcsIGsxLCBrMm5lZywgazIgfSA9IGVuZG8uc3BsaXRTY2FsYXIoc2NhbGFyKTsKICAgICAgICAgIGxldCB7IHA6IGsxcCwgZjogZjFwIH0gPSB0aGlzLndOQUYoazEpOwogICAgICAgICAgbGV0IHsgcDogazJwLCBmOiBmMnAgfSA9IHRoaXMud05BRihrMik7CiAgICAgICAgICBrMXAgPSB3bmFmLmNvbnN0VGltZU5lZ2F0ZShrMW5lZywgazFwKTsKICAgICAgICAgIGsycCA9IHduYWYuY29uc3RUaW1lTmVnYXRlKGsybmVnLCBrMnApOwogICAgICAgICAgazJwID0gbmV3IFBvaW50MihGcDIubXVsKGsycC5weCwgZW5kby5iZXRhKSwgazJwLnB5LCBrMnAucHopOwogICAgICAgICAgcG9pbnQgPSBrMXAuYWRkKGsycCk7CiAgICAgICAgICBmYWtlID0gZjFwLmFkZChmMnApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCB7IHAsIGY6IGYyIH0gPSB0aGlzLndOQUYoc2NhbGFyKTsKICAgICAgICAgIHBvaW50ID0gcDsKICAgICAgICAgIGZha2UgPSBmMjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFBvaW50Mi5ub3JtYWxpemVaKFtwb2ludCwgZmFrZV0pWzBdOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBFZmZpY2llbnRseSBjYWxjdWxhdGUgYGFQICsgYlFgLiBVbnNhZmUsIGNhbiBleHBvc2UgcHJpdmF0ZSBrZXksIGlmIHVzZWQgaW5jb3JyZWN0bHkuCiAgICAgICAqIE5vdCB1c2luZyBTdHJhdXNzLVNoYW1pciB0cmljazogcHJlY29tcHV0YXRpb24gdGFibGVzIGFyZSBmYXN0ZXIuCiAgICAgICAqIFRoZSB0cmljayBjb3VsZCBiZSB1c2VmdWwgaWYgYm90aCBQIGFuZCBRIGFyZSBub3QgRyAobm90IGluIG91ciBjYXNlKS4KICAgICAgICogQHJldHVybnMgbm9uLXplcm8gYWZmaW5lIHBvaW50CiAgICAgICAqLwogICAgICBtdWx0aXBseUFuZEFkZFVuc2FmZShRLCBhLCBiKSB7CiAgICAgICAgY29uc3QgRyA9IFBvaW50Mi5CQVNFOwogICAgICAgIGNvbnN0IG11bCA9IChQLCBhMikgPT4gYTIgPT09IF8wbjUgfHwgYTIgPT09IF8xbjUgfHwgIVAuZXF1YWxzKEcpID8gUC5tdWx0aXBseVVuc2FmZShhMikgOiBQLm11bHRpcGx5KGEyKTsKICAgICAgICBjb25zdCBzdW0gPSBtdWwodGhpcywgYSkuYWRkKG11bChRLCBiKSk7CiAgICAgICAgcmV0dXJuIHN1bS5pczAoKSA/IHZvaWQgMCA6IHN1bTsKICAgICAgfQogICAgICAvLyBDb252ZXJ0cyBQcm9qZWN0aXZlIHBvaW50IHRvIGFmZmluZSAoeCwgeSkgY29vcmRpbmF0ZXMuCiAgICAgIC8vIENhbiBhY2NlcHQgcHJlY29tcHV0ZWQgWl4tMSAtIGZvciBleGFtcGxlLCBmcm9tIGludmVydEJhdGNoLgogICAgICAvLyAoeCwgeSwgeikg4oiLICh4PXgveiwgeT15L3opCiAgICAgIHRvQWZmaW5lKGl6KSB7CiAgICAgICAgcmV0dXJuIHRvQWZmaW5lTWVtbyh0aGlzLCBpeik7CiAgICAgIH0KICAgICAgaXNUb3JzaW9uRnJlZSgpIHsKICAgICAgICBjb25zdCB7IGg6IGNvZmFjdG9yLCBpc1RvcnNpb25GcmVlIH0gPSBDVVJWRTsKICAgICAgICBpZiAoY29mYWN0b3IgPT09IF8xbjUpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoaXNUb3JzaW9uRnJlZSkKICAgICAgICAgIHJldHVybiBpc1RvcnNpb25GcmVlKFBvaW50MiwgdGhpcyk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpc1RvcnNpb25GcmVlKCkgaGFzIG5vdCBiZWVuIGRlY2xhcmVkIGZvciB0aGUgZWxsaXB0aWMgY3VydmUiKTsKICAgICAgfQogICAgICBjbGVhckNvZmFjdG9yKCkgewogICAgICAgIGNvbnN0IHsgaDogY29mYWN0b3IsIGNsZWFyQ29mYWN0b3IgfSA9IENVUlZFOwogICAgICAgIGlmIChjb2ZhY3RvciA9PT0gXzFuNSkKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIGlmIChjbGVhckNvZmFjdG9yKQogICAgICAgICAgcmV0dXJuIGNsZWFyQ29mYWN0b3IoUG9pbnQyLCB0aGlzKTsKICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVVuc2FmZShDVVJWRS5oKTsKICAgICAgfQogICAgICB0b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICB0aGlzLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMzKFBvaW50MiwgdGhpcywgaXNDb21wcmVzc2VkKTsKICAgICAgfQogICAgICB0b0hleChpc0NvbXByZXNzZWQgPSB0cnVlKSB7CiAgICAgICAgYWJvb2woImlzQ29tcHJlc3NlZCIsIGlzQ29tcHJlc3NlZCk7CiAgICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgyKHRoaXMudG9SYXdCeXRlcyhpc0NvbXByZXNzZWQpKTsKICAgICAgfQogICAgfQogICAgUG9pbnQyLkJBU0UgPSBuZXcgUG9pbnQyKENVUlZFLkd4LCBDVVJWRS5HeSwgRnAyLk9ORSk7CiAgICBQb2ludDIuWkVSTyA9IG5ldyBQb2ludDIoRnAyLlpFUk8sIEZwMi5PTkUsIEZwMi5aRVJPKTsKICAgIGNvbnN0IF9iaXRzID0gQ1VSVkUubkJpdExlbmd0aDsKICAgIGNvbnN0IHduYWYgPSB3TkFGKFBvaW50MiwgQ1VSVkUuZW5kbyA/IE1hdGguY2VpbChfYml0cyAvIDIpIDogX2JpdHMpOwogICAgcmV0dXJuIHsKICAgICAgQ1VSVkUsCiAgICAgIFByb2plY3RpdmVQb2ludDogUG9pbnQyLAogICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyLAogICAgICB3ZWllcnN0cmFzc0VxdWF0aW9uLAogICAgICBpc1dpdGhpbkN1cnZlT3JkZXIKICAgIH07CiAgfQogIGZ1bmN0aW9uIHZhbGlkYXRlT3B0cyhjdXJ2ZSkgewogICAgY29uc3Qgb3B0cyA9IHZhbGlkYXRlQmFzaWMoY3VydmUpOwogICAgdmFsaWRhdGVPYmplY3Qob3B0cywgewogICAgICBoYXNoOiAiaGFzaCIsCiAgICAgIGhtYWM6ICJmdW5jdGlvbiIsCiAgICAgIHJhbmRvbUJ5dGVzOiAiZnVuY3Rpb24iCiAgICB9LCB7CiAgICAgIGJpdHMyaW50OiAiZnVuY3Rpb24iLAogICAgICBiaXRzMmludF9tb2ROOiAiZnVuY3Rpb24iLAogICAgICBsb3dTOiAiYm9vbGVhbiIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoeyBsb3dTOiB0cnVlLCAuLi5vcHRzIH0pOwogIH0KICBmdW5jdGlvbiB3ZWllcnN0cmFzcyhjdXJ2ZURlZikgewogICAgY29uc3QgQ1VSVkUgPSB2YWxpZGF0ZU9wdHMoY3VydmVEZWYpOwogICAgY29uc3QgeyBGcDogRnAyLCBuOiBDVVJWRV9PUkRFUiB9ID0gQ1VSVkU7CiAgICBjb25zdCBjb21wcmVzc2VkTGVuID0gRnAyLkJZVEVTICsgMTsKICAgIGNvbnN0IHVuY29tcHJlc3NlZExlbiA9IDIgKiBGcDIuQllURVMgKyAxOwogICAgZnVuY3Rpb24gbW9kTjIoYSkgewogICAgICByZXR1cm4gbW9kKGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGZ1bmN0aW9uIGludk4oYSkgewogICAgICByZXR1cm4gaW52ZXJ0KGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGNvbnN0IHsgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsIHdlaWVyc3RyYXNzRXF1YXRpb24sIGlzV2l0aGluQ3VydmVPcmRlciB9ID0gd2VpZXJzdHJhc3NQb2ludHMoewogICAgICAuLi5DVVJWRSwKICAgICAgdG9CeXRlcyhfYywgcG9pbnQsIGlzQ29tcHJlc3NlZCkgewogICAgICAgIGNvbnN0IGEgPSBwb2ludC50b0FmZmluZSgpOwogICAgICAgIGNvbnN0IHggPSBGcDIudG9CeXRlcyhhLngpOwogICAgICAgIGNvbnN0IGNhdCA9IGNvbmNhdEJ5dGVzMzsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICBpZiAoaXNDb21wcmVzc2VkKSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbcG9pbnQuaGFzRXZlblkoKSA/IDIgOiAzXSksIHgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbNF0pLCB4LCBGcDIudG9CeXRlcyhhLnkpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyb21CeXRlcyhieXRlczIpIHsKICAgICAgICBjb25zdCBsZW4gPSBieXRlczIubGVuZ3RoOwogICAgICAgIGNvbnN0IGhlYWQgPSBieXRlczJbMF07CiAgICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgICBpZiAobGVuID09PSBjb21wcmVzc2VkTGVuICYmIChoZWFkID09PSAyIHx8IGhlYWQgPT09IDMpKSB7CiAgICAgICAgICBjb25zdCB4ID0gYnl0ZXNUb051bWJlckJFKHRhaWwpOwogICAgICAgICAgaWYgKCFpblJhbmdlKHgsIF8xbjUsIEZwMi5PUkRFUikpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUG9pbnQgaXMgbm90IG9uIGN1cnZlIik7CiAgICAgICAgICBjb25zdCB5MiA9IHdlaWVyc3RyYXNzRXF1YXRpb24oeCk7CiAgICAgICAgICBsZXQgeTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHkgPSBGcDIuc3FydCh5Mik7CiAgICAgICAgICB9IGNhdGNoIChzcXJ0RXJyb3IpIHsKICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gc3FydEVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyAiOiAiICsgc3FydEVycm9yLm1lc3NhZ2UgOiAiIjsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb2ludCBpcyBub3Qgb24gY3VydmUiICsgc3VmZml4KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGlzWU9kZCA9ICh5ICYgXzFuNSkgPT09IF8xbjU7CiAgICAgICAgICBjb25zdCBpc0hlYWRPZGQgPSAoaGVhZCAmIDEpID09PSAxOwogICAgICAgICAgaWYgKGlzSGVhZE9kZCAhPT0gaXNZT2RkKQogICAgICAgICAgICB5ID0gRnAyLm5lZyh5KTsKICAgICAgICAgIHJldHVybiB7IHgsIHkgfTsKICAgICAgICB9IGVsc2UgaWYgKGxlbiA9PT0gdW5jb21wcmVzc2VkTGVuICYmIGhlYWQgPT09IDQpIHsKICAgICAgICAgIGNvbnN0IHggPSBGcDIuZnJvbUJ5dGVzKHRhaWwuc3ViYXJyYXkoMCwgRnAyLkJZVEVTKSk7CiAgICAgICAgICBjb25zdCB5ID0gRnAyLmZyb21CeXRlcyh0YWlsLnN1YmFycmF5KEZwMi5CWVRFUywgMiAqIEZwMi5CWVRFUykpOwogICAgICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBvaW50IG9mIGxlbmd0aCAke2xlbn0gd2FzIGludmFsaWQuIEV4cGVjdGVkICR7Y29tcHJlc3NlZExlbn0gY29tcHJlc3NlZCBieXRlcyBvciAke3VuY29tcHJlc3NlZExlbn0gdW5jb21wcmVzc2VkIGJ5dGVzYCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IG51bVRvTkJ5dGVTdHIgPSAobnVtMikgPT4gYnl0ZXNUb0hleDIobnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKSk7CiAgICBmdW5jdGlvbiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIobnVtYmVyMikgewogICAgICBjb25zdCBIQUxGID0gQ1VSVkVfT1JERVIgPj4gXzFuNTsKICAgICAgcmV0dXJuIG51bWJlcjIgPiBIQUxGOwogICAgfQogICAgZnVuY3Rpb24gbm9ybWFsaXplUyhzKSB7CiAgICAgIHJldHVybiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIocykgPyBtb2ROMigtcykgOiBzOwogICAgfQogICAgY29uc3Qgc2xjTnVtID0gKGIsIGZyb20sIHRvKSA9PiBieXRlc1RvTnVtYmVyQkUoYi5zbGljZShmcm9tLCB0bykpOwogICAgY2xhc3MgU2lnbmF0dXJlIHsKICAgICAgY29uc3RydWN0b3IociwgcywgcmVjb3ZlcnkpIHsKICAgICAgICB0aGlzLnIgPSByOwogICAgICAgIHRoaXMucyA9IHM7CiAgICAgICAgdGhpcy5yZWNvdmVyeSA9IHJlY292ZXJ5OwogICAgICAgIHRoaXMuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgfQogICAgICAvLyBwYWlyIChieXRlcyBvZiByLCBieXRlcyBvZiBzKQogICAgICBzdGF0aWMgZnJvbUNvbXBhY3QoaGV4KSB7CiAgICAgICAgY29uc3QgbCA9IENVUlZFLm5CeXRlTGVuZ3RoOwogICAgICAgIGhleCA9IGVuc3VyZUJ5dGVzKCJjb21wYWN0U2lnbmF0dXJlIiwgaGV4LCBsICogMik7CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoc2xjTnVtKGhleCwgMCwgbCksIHNsY051bShoZXgsIGwsIDIgKiBsKSk7CiAgICAgIH0KICAgICAgLy8gREVSIGVuY29kZWQgRUNEU0Egc2lnbmF0dXJlCiAgICAgIC8vIGh0dHBzOi8vYml0Y29pbi5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvNTc2NDQvd2hhdC1hcmUtdGhlLXBhcnRzLW9mLWEtYml0Y29pbi10cmFuc2FjdGlvbi1pbnB1dC1zY3JpcHQKICAgICAgc3RhdGljIGZyb21ERVIoaGV4KSB7CiAgICAgICAgY29uc3QgeyByLCBzIH0gPSBERVIudG9TaWcoZW5zdXJlQnl0ZXMoIkRFUiIsIGhleCkpOwogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHIsIHMpOwogICAgICB9CiAgICAgIGFzc2VydFZhbGlkaXR5KCkgewogICAgICAgIGFJblJhbmdlKCJyIiwgdGhpcy5yLCBfMW41LCBDVVJWRV9PUkRFUik7CiAgICAgICAgYUluUmFuZ2UoInMiLCB0aGlzLnMsIF8xbjUsIENVUlZFX09SREVSKTsKICAgICAgfQogICAgICBhZGRSZWNvdmVyeUJpdChyZWNvdmVyeSkgewogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHRoaXMuciwgdGhpcy5zLCByZWNvdmVyeSk7CiAgICAgIH0KICAgICAgcmVjb3ZlclB1YmxpY0tleShtc2dIYXNoKSB7CiAgICAgICAgY29uc3QgeyByLCBzLCByZWNvdmVyeTogcmVjIH0gPSB0aGlzOwogICAgICAgIGNvbnN0IGggPSBiaXRzMmludF9tb2ROKGVuc3VyZUJ5dGVzKCJtc2dIYXNoIiwgbXNnSGFzaCkpOwogICAgICAgIGlmIChyZWMgPT0gbnVsbCB8fCAhWzAsIDEsIDIsIDNdLmluY2x1ZGVzKHJlYykpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIGludmFsaWQiKTsKICAgICAgICBjb25zdCByYWRqID0gcmVjID09PSAyIHx8IHJlYyA9PT0gMyA/IHIgKyBDVVJWRS5uIDogcjsKICAgICAgICBpZiAocmFkaiA+PSBGcDIuT1JERVIpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIDIgb3IgMyBpbnZhbGlkIik7CiAgICAgICAgY29uc3QgcHJlZml4ID0gKHJlYyAmIDEpID09PSAwID8gIjAyIiA6ICIwMyI7CiAgICAgICAgY29uc3QgUiA9IFBvaW50Mi5mcm9tSGV4KHByZWZpeCArIG51bVRvTkJ5dGVTdHIocmFkaikpOwogICAgICAgIGNvbnN0IGlyID0gaW52TihyYWRqKTsKICAgICAgICBjb25zdCB1MSA9IG1vZE4yKC1oICogaXIpOwogICAgICAgIGNvbnN0IHUyID0gbW9kTjIocyAqIGlyKTsKICAgICAgICBjb25zdCBRID0gUG9pbnQyLkJBU0UubXVsdGlwbHlBbmRBZGRVbnNhZmUoUiwgdTEsIHUyKTsKICAgICAgICBpZiAoIVEpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInBvaW50IGF0IGluZmluaWZ5Iik7CiAgICAgICAgUS5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBROwogICAgICB9CiAgICAgIC8vIFNpZ25hdHVyZXMgc2hvdWxkIGJlIGxvdy1zLCB0byBwcmV2ZW50IG1hbGxlYWJpbGl0eS4KICAgICAgaGFzSGlnaFMoKSB7CiAgICAgICAgcmV0dXJuIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcih0aGlzLnMpOwogICAgICB9CiAgICAgIG5vcm1hbGl6ZVMoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaGFzSGlnaFMoKSA/IG5ldyBTaWduYXR1cmUodGhpcy5yLCBtb2ROMigtdGhpcy5zKSwgdGhpcy5yZWNvdmVyeSkgOiB0aGlzOwogICAgICB9CiAgICAgIC8vIERFUi1lbmNvZGVkCiAgICAgIHRvREVSUmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9ERVJIZXgoKSk7CiAgICAgIH0KICAgICAgdG9ERVJIZXgoKSB7CiAgICAgICAgcmV0dXJuIERFUi5oZXhGcm9tU2lnKHsgcjogdGhpcy5yLCBzOiB0aGlzLnMgfSk7CiAgICAgIH0KICAgICAgLy8gcGFkZGVkIGJ5dGVzIG9mIHIsIHRoZW4gcGFkZGVkIGJ5dGVzIG9mIHMKICAgICAgdG9Db21wYWN0UmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9Db21wYWN0SGV4KCkpOwogICAgICB9CiAgICAgIHRvQ29tcGFjdEhleCgpIHsKICAgICAgICByZXR1cm4gbnVtVG9OQnl0ZVN0cih0aGlzLnIpICsgbnVtVG9OQnl0ZVN0cih0aGlzLnMpOwogICAgICB9CiAgICB9CiAgICBjb25zdCB1dGlscyA9IHsKICAgICAgaXNWYWxpZFByaXZhdGVLZXkocHJpdmF0ZUtleSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsCiAgICAgIC8qKgogICAgICAgKiBQcm9kdWNlcyBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgcHJpdmF0ZSBrZXkgZnJvbSByYW5kb20gb2Ygc2l6ZQogICAgICAgKiAoZ3JvdXBMZW4gKyBjZWlsKGdyb3VwTGVuIC8gMikpIHdpdGggbW9kdWxvIGJpYXMgYmVpbmcgbmVnbGlnaWJsZS4KICAgICAgICovCiAgICAgIHJhbmRvbVByaXZhdGVLZXk6ICgpID0+IHsKICAgICAgICBjb25zdCBsZW5ndGggPSBnZXRNaW5IYXNoTGVuZ3RoKENVUlZFLm4pOwogICAgICAgIHJldHVybiBtYXBIYXNoVG9GaWVsZChDVVJWRS5yYW5kb21CeXRlcyhsZW5ndGgpLCBDVVJWRS5uKTsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIENyZWF0ZXMgcHJlY29tcHV0ZSB0YWJsZSBmb3IgYW4gYXJiaXRyYXJ5IEVDIHBvaW50LiBNYWtlcyBwb2ludCAiY2FjaGVkIi4KICAgICAgICogQWxsb3dzIHRvIG1hc3NpdmVseSBzcGVlZC11cCBgcG9pbnQubXVsdGlwbHkoc2NhbGFyKWAuCiAgICAgICAqIEByZXR1cm5zIGNhY2hlZCBwb2ludAogICAgICAgKiBAZXhhbXBsZQogICAgICAgKiBjb25zdCBmYXN0ID0gdXRpbHMucHJlY29tcHV0ZSg4LCBQcm9qZWN0aXZlUG9pbnQuZnJvbUhleChzb21lb25lc1B1YktleSkpOwogICAgICAgKiBmYXN0Lm11bHRpcGx5KHByaXZLZXkpOyAvLyBtdWNoIGZhc3RlciBFQ0RIIG5vdwogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZSh3aW5kb3dTaXplID0gOCwgcG9pbnQgPSBQb2ludDIuQkFTRSkgewogICAgICAgIHBvaW50Ll9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpOwogICAgICAgIHBvaW50Lm11bHRpcGx5KEJpZ0ludCgzKSk7CiAgICAgICAgcmV0dXJuIHBvaW50OwogICAgICB9CiAgICB9OwogICAgZnVuY3Rpb24gZ2V0UHVibGljS2V5KHByaXZhdGVLZXksIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgcmV0dXJuIFBvaW50Mi5mcm9tUHJpdmF0ZUtleShwcml2YXRlS2V5KS50b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCk7CiAgICB9CiAgICBmdW5jdGlvbiBpc1Byb2JQdWIoaXRlbSkgewogICAgICBjb25zdCBhcnIgPSBpc0J5dGVzMihpdGVtKTsKICAgICAgY29uc3Qgc3RyID0gdHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciOwogICAgICBjb25zdCBsZW4gPSAoYXJyIHx8IHN0cikgJiYgaXRlbS5sZW5ndGg7CiAgICAgIGlmIChhcnIpCiAgICAgICAgcmV0dXJuIGxlbiA9PT0gY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IHVuY29tcHJlc3NlZExlbjsKICAgICAgaWYgKHN0cikKICAgICAgICByZXR1cm4gbGVuID09PSAyICogY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IDIgKiB1bmNvbXByZXNzZWRMZW47CiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRTaGFyZWRTZWNyZXQocHJpdmF0ZUEsIHB1YmxpY0IsIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgaWYgKGlzUHJvYlB1Yihwcml2YXRlQSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaXJzdCBhcmcgbXVzdCBiZSBwcml2YXRlIGtleSIpOwogICAgICBpZiAoIWlzUHJvYlB1YihwdWJsaWNCKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNlY29uZCBhcmcgbXVzdCBiZSBwdWJsaWMga2V5Iik7CiAgICAgIGNvbnN0IGIgPSBQb2ludDIuZnJvbUhleChwdWJsaWNCKTsKICAgICAgcmV0dXJuIGIubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlQSkpLnRvUmF3Qnl0ZXMoaXNDb21wcmVzc2VkKTsKICAgIH0KICAgIGNvbnN0IGJpdHMyaW50ID0gQ1VSVkUuYml0czJpbnQgfHwgZnVuY3Rpb24oYnl0ZXMyKSB7CiAgICAgIGNvbnN0IG51bTIgPSBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgY29uc3QgZGVsdGEgPSBieXRlczIubGVuZ3RoICogOCAtIENVUlZFLm5CaXRMZW5ndGg7CiAgICAgIHJldHVybiBkZWx0YSA+IDAgPyBudW0yID4+IEJpZ0ludChkZWx0YSkgOiBudW0yOwogICAgfTsKICAgIGNvbnN0IGJpdHMyaW50X21vZE4gPSBDVVJWRS5iaXRzMmludF9tb2ROIHx8IGZ1bmN0aW9uKGJ5dGVzMikgewogICAgICByZXR1cm4gbW9kTjIoYml0czJpbnQoYnl0ZXMyKSk7CiAgICB9OwogICAgY29uc3QgT1JERVJfTUFTSyA9IGJpdE1hc2soQ1VSVkUubkJpdExlbmd0aCk7CiAgICBmdW5jdGlvbiBpbnQyb2N0ZXRzKG51bTIpIHsKICAgICAgYUluUmFuZ2UoYG51bSA8IDJeJHtDVVJWRS5uQml0TGVuZ3RofWAsIG51bTIsIF8wbjUsIE9SREVSX01BU0spOwogICAgICByZXR1cm4gbnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKTsKICAgIH0KICAgIGZ1bmN0aW9uIHByZXBTaWcobXNnSGFzaCwgcHJpdmF0ZUtleSwgb3B0cyA9IGRlZmF1bHRTaWdPcHRzKSB7CiAgICAgIGlmIChbInJlY292ZXJlZCIsICJjYW5vbmljYWwiXS5zb21lKChrKSA9PiBrIGluIG9wdHMpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbigpIGxlZ2FjeSBvcHRpb25zIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgY29uc3QgeyBoYXNoOiBoYXNoMywgcmFuZG9tQnl0ZXM6IHJhbmRvbUJ5dGVzMiB9ID0gQ1VSVkU7CiAgICAgIGxldCB7IGxvd1MsIHByZWhhc2gsIGV4dHJhRW50cm9weTogZW50IH0gPSBvcHRzOwogICAgICBpZiAobG93UyA9PSBudWxsKQogICAgICAgIGxvd1MgPSB0cnVlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgdmFsaWRhdGVTaWdWZXJPcHRzKG9wdHMpOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoInByZWhhc2hlZCBtc2dIYXNoIiwgaGFzaDMobXNnSGFzaCkpOwogICAgICBjb25zdCBoMWludCA9IGJpdHMyaW50X21vZE4obXNnSGFzaCk7CiAgICAgIGNvbnN0IGQgPSBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICBjb25zdCBzZWVkQXJncyA9IFtpbnQyb2N0ZXRzKGQpLCBpbnQyb2N0ZXRzKGgxaW50KV07CiAgICAgIGlmIChlbnQgIT0gbnVsbCAmJiBlbnQgIT09IGZhbHNlKSB7CiAgICAgICAgY29uc3QgZSA9IGVudCA9PT0gdHJ1ZSA/IHJhbmRvbUJ5dGVzMihGcDIuQllURVMpIDogZW50OwogICAgICAgIHNlZWRBcmdzLnB1c2goZW5zdXJlQnl0ZXMoImV4dHJhRW50cm9weSIsIGUpKTsKICAgICAgfQogICAgICBjb25zdCBzZWVkID0gY29uY2F0Qnl0ZXMzKC4uLnNlZWRBcmdzKTsKICAgICAgY29uc3QgbSA9IGgxaW50OwogICAgICBmdW5jdGlvbiBrMnNpZyhrQnl0ZXMpIHsKICAgICAgICBjb25zdCBrID0gYml0czJpbnQoa0J5dGVzKTsKICAgICAgICBpZiAoIWlzV2l0aGluQ3VydmVPcmRlcihrKSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCBpayA9IGludk4oayk7CiAgICAgICAgY29uc3QgcSA9IFBvaW50Mi5CQVNFLm11bHRpcGx5KGspLnRvQWZmaW5lKCk7CiAgICAgICAgY29uc3QgciA9IG1vZE4yKHEueCk7CiAgICAgICAgaWYgKHIgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgY29uc3QgcyA9IG1vZE4yKGlrICogbW9kTjIobSArIHIgKiBkKSk7CiAgICAgICAgaWYgKHMgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgbGV0IHJlY292ZXJ5ID0gKHEueCA9PT0gciA/IDAgOiAyKSB8IE51bWJlcihxLnkgJiBfMW41KTsKICAgICAgICBsZXQgbm9ybVMgPSBzOwogICAgICAgIGlmIChsb3dTICYmIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcihzKSkgewogICAgICAgICAgbm9ybVMgPSBub3JtYWxpemVTKHMpOwogICAgICAgICAgcmVjb3ZlcnkgXj0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUociwgbm9ybVMsIHJlY292ZXJ5KTsKICAgICAgfQogICAgICByZXR1cm4geyBzZWVkLCBrMnNpZyB9OwogICAgfQogICAgY29uc3QgZGVmYXVsdFNpZ09wdHMgPSB7IGxvd1M6IENVUlZFLmxvd1MsIHByZWhhc2g6IGZhbHNlIH07CiAgICBjb25zdCBkZWZhdWx0VmVyT3B0cyA9IHsgbG93UzogQ1VSVkUubG93UywgcHJlaGFzaDogZmFsc2UgfTsKICAgIGZ1bmN0aW9uIHNpZ24yKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMgPSBkZWZhdWx0U2lnT3B0cykgewogICAgICBjb25zdCB7IHNlZWQsIGsyc2lnIH0gPSBwcmVwU2lnKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMpOwogICAgICBjb25zdCBDID0gQ1VSVkU7CiAgICAgIGNvbnN0IGRyYmcgPSBjcmVhdGVIbWFjRHJiZyhDLmhhc2gub3V0cHV0TGVuLCBDLm5CeXRlTGVuZ3RoLCBDLmhtYWMpOwogICAgICByZXR1cm4gZHJiZyhzZWVkLCBrMnNpZyk7CiAgICB9CiAgICBQb2ludDIuQkFTRS5fc2V0V2luZG93U2l6ZSg4KTsKICAgIGZ1bmN0aW9uIHZlcmlmeShzaWduYXR1cmUsIG1zZ0hhc2gsIHB1YmxpY0tleSwgb3B0cyA9IGRlZmF1bHRWZXJPcHRzKSB7CiAgICAgIGNvbnN0IHNnID0gc2lnbmF0dXJlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgcHVibGljS2V5ID0gZW5zdXJlQnl0ZXMoInB1YmxpY0tleSIsIHB1YmxpY0tleSk7CiAgICAgIGlmICgic3RyaWN0IiBpbiBvcHRzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigib3B0aW9ucy5zdHJpY3Qgd2FzIHJlbmFtZWQgdG8gbG93UyIpOwogICAgICB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cyk7CiAgICAgIGNvbnN0IHsgbG93UywgcHJlaGFzaCB9ID0gb3B0czsKICAgICAgbGV0IF9zaWcgPSB2b2lkIDA7CiAgICAgIGxldCBQOwogICAgICB0cnkgewogICAgICAgIGlmICh0eXBlb2Ygc2cgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHNnKSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3NpZyA9IFNpZ25hdHVyZS5mcm9tREVSKHNnKTsKICAgICAgICAgIH0gY2F0Y2ggKGRlckVycm9yKSB7CiAgICAgICAgICAgIGlmICghKGRlckVycm9yIGluc3RhbmNlb2YgREVSLkVycikpCiAgICAgICAgICAgICAgdGhyb3cgZGVyRXJyb3I7CiAgICAgICAgICAgIF9zaWcgPSBTaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2cpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNnID09PSAib2JqZWN0IiAmJiB0eXBlb2Ygc2cuciA9PT0gImJpZ2ludCIgJiYgdHlwZW9mIHNnLnMgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgICBjb25zdCB7IHI6IHIyLCBzOiBzMiB9ID0gc2c7CiAgICAgICAgICBfc2lnID0gbmV3IFNpZ25hdHVyZShyMiwgczIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlBBUlNFIik7CiAgICAgICAgfQogICAgICAgIFAgPSBQb2ludDIuZnJvbUhleChwdWJsaWNLZXkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlmIChlcnJvci5tZXNzYWdlID09PSAiUEFSU0UiKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaWduYXR1cmUgbXVzdCBiZSBTaWduYXR1cmUgaW5zdGFuY2UsIFVpbnQ4QXJyYXkgb3IgaGV4IHN0cmluZ2ApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAobG93UyAmJiBfc2lnLmhhc0hpZ2hTKCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gQ1VSVkUuaGFzaChtc2dIYXNoKTsKICAgICAgY29uc3QgeyByLCBzIH0gPSBfc2lnOwogICAgICBjb25zdCBoID0gYml0czJpbnRfbW9kTihtc2dIYXNoKTsKICAgICAgY29uc3QgaXMgPSBpbnZOKHMpOwogICAgICBjb25zdCB1MSA9IG1vZE4yKGggKiBpcyk7CiAgICAgIGNvbnN0IHUyID0gbW9kTjIociAqIGlzKTsKICAgICAgY29uc3QgUiA9IFBvaW50Mi5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFAsIHUxLCB1Mik/LnRvQWZmaW5lKCk7CiAgICAgIGlmICghUikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGNvbnN0IHYgPSBtb2ROMihSLngpOwogICAgICByZXR1cm4gdiA9PT0gcjsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIENVUlZFLAogICAgICBnZXRQdWJsaWNLZXksCiAgICAgIGdldFNoYXJlZFNlY3JldCwKICAgICAgc2lnbjogc2lnbjIsCiAgICAgIHZlcmlmeSwKICAgICAgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsCiAgICAgIFNpZ25hdHVyZSwKICAgICAgdXRpbHMKICAgIH07CiAgfQogIGZ1bmN0aW9uIFNXVUZwU3FydFJhdGlvKEZwMiwgWikgewogICAgY29uc3QgcSA9IEZwMi5PUkRFUjsKICAgIGxldCBsID0gXzBuNTsKICAgIGZvciAobGV0IG8gPSBxIC0gXzFuNTsgbyAlIF8ybjQgPT09IF8wbjU7IG8gLz0gXzJuNCkKICAgICAgbCArPSBfMW41OwogICAgY29uc3QgYzEgPSBsOwogICAgY29uc3QgXzJuX3Bvd19jMV8xID0gXzJuNCA8PCBjMSAtIF8xbjUgLSBfMW41OwogICAgY29uc3QgXzJuX3Bvd19jMSA9IF8ybl9wb3dfYzFfMSAqIF8ybjQ7CiAgICBjb25zdCBjMiA9IChxIC0gXzFuNSkgLyBfMm5fcG93X2MxOwogICAgY29uc3QgYzMgPSAoYzIgLSBfMW41KSAvIF8ybjQ7CiAgICBjb25zdCBjNCA9IF8ybl9wb3dfYzEgLSBfMW41OwogICAgY29uc3QgYzUgPSBfMm5fcG93X2MxXzE7CiAgICBjb25zdCBjNiA9IEZwMi5wb3coWiwgYzIpOwogICAgY29uc3QgYzcgPSBGcDIucG93KFosIChjMiArIF8xbjUpIC8gXzJuNCk7CiAgICBsZXQgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgbGV0IHR2MSA9IGM2OwogICAgICBsZXQgdHYyID0gRnAyLnBvdyh2LCBjNCk7CiAgICAgIGxldCB0djMgPSBGcDIuc3FyKHR2Mik7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCB2KTsKICAgICAgbGV0IHR2NSA9IEZwMi5tdWwodSwgdHYzKTsKICAgICAgdHY1ID0gRnAyLnBvdyh0djUsIGMzKTsKICAgICAgdHY1ID0gRnAyLm11bCh0djUsIHR2Mik7CiAgICAgIHR2MiA9IEZwMi5tdWwodHY1LCB2KTsKICAgICAgdHYzID0gRnAyLm11bCh0djUsIHUpOwogICAgICBsZXQgdHY0ID0gRnAyLm11bCh0djMsIHR2Mik7CiAgICAgIHR2NSA9IEZwMi5wb3codHY0LCBjNSk7CiAgICAgIGxldCBpc1FSID0gRnAyLmVxbCh0djUsIEZwMi5PTkUpOwogICAgICB0djIgPSBGcDIubXVsKHR2MywgYzcpOwogICAgICB0djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgdHYzID0gRnAyLmNtb3YodHYyLCB0djMsIGlzUVIpOwogICAgICB0djQgPSBGcDIuY21vdih0djUsIHR2NCwgaXNRUik7CiAgICAgIGZvciAobGV0IGkgPSBjMTsgaSA+IF8xbjU7IGktLSkgewogICAgICAgIGxldCB0djUyID0gaSAtIF8ybjQ7CiAgICAgICAgdHY1MiA9IF8ybjQgPDwgdHY1MiAtIF8xbjU7CiAgICAgICAgbGV0IHR2djUgPSBGcDIucG93KHR2NCwgdHY1Mik7CiAgICAgICAgY29uc3QgZTEgPSBGcDIuZXFsKHR2djUsIEZwMi5PTkUpOwogICAgICAgIHR2MiA9IEZwMi5tdWwodHYzLCB0djEpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djEpOwogICAgICAgIHR2djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgICB0djMgPSBGcDIuY21vdih0djIsIHR2MywgZTEpOwogICAgICAgIHR2NCA9IEZwMi5jbW92KHR2djUsIHR2NCwgZTEpOwogICAgICB9CiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGlzUVIsIHZhbHVlOiB0djMgfTsKICAgIH07CiAgICBpZiAoRnAyLk9SREVSICUgXzRuMiA9PT0gXzNuMikgewogICAgICBjb25zdCBjMTIgPSAoRnAyLk9SREVSIC0gXzNuMikgLyBfNG4yOwogICAgICBjb25zdCBjMjIgPSBGcDIuc3FydChGcDIubmVnKFopKTsKICAgICAgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgICBsZXQgdHYxID0gRnAyLnNxcih2KTsKICAgICAgICBjb25zdCB0djIgPSBGcDIubXVsKHUsIHYpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djIpOwogICAgICAgIGxldCB5MSA9IEZwMi5wb3codHYxLCBjMTIpOwogICAgICAgIHkxID0gRnAyLm11bCh5MSwgdHYyKTsKICAgICAgICBjb25zdCB5MiA9IEZwMi5tdWwoeTEsIGMyMik7CiAgICAgICAgY29uc3QgdHYzID0gRnAyLm11bChGcDIuc3FyKHkxKSwgdik7CiAgICAgICAgY29uc3QgaXNRUiA9IEZwMi5lcWwodHYzLCB1KTsKICAgICAgICBsZXQgeSA9IEZwMi5jbW92KHkyLCB5MSwgaXNRUik7CiAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogaXNRUiwgdmFsdWU6IHkgfTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBzcXJ0UmF0aW87CiAgfQogIGZ1bmN0aW9uIG1hcFRvQ3VydmVTaW1wbGVTV1UoRnAyLCBvcHRzKSB7CiAgICB2YWxpZGF0ZUZpZWxkKEZwMik7CiAgICBpZiAoIUZwMi5pc1ZhbGlkKG9wdHMuQSkgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuQikgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuWikpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZVNpbXBsZVNXVTogaW52YWxpZCBvcHRzIik7CiAgICBjb25zdCBzcXJ0UmF0aW8gPSBTV1VGcFNxcnRSYXRpbyhGcDIsIG9wdHMuWik7CiAgICBpZiAoIUZwMi5pc09kZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGcC5pc09kZCBpcyBub3QgaW1wbGVtZW50ZWQhIik7CiAgICByZXR1cm4gKHUpID0+IHsKICAgICAgbGV0IHR2MSwgdHYyLCB0djMsIHR2NCwgdHY1LCB0djYsIHgsIHk7CiAgICAgIHR2MSA9IEZwMi5zcXIodSk7CiAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCBvcHRzLlopOwogICAgICB0djIgPSBGcDIuc3FyKHR2MSk7CiAgICAgIHR2MiA9IEZwMi5hZGQodHYyLCB0djEpOwogICAgICB0djMgPSBGcDIuYWRkKHR2MiwgRnAyLk9ORSk7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCBvcHRzLkIpOwogICAgICB0djQgPSBGcDIuY21vdihvcHRzLlosIEZwMi5uZWcodHYyKSwgIUZwMi5lcWwodHYyLCBGcDIuWkVSTykpOwogICAgICB0djQgPSBGcDIubXVsKHR2NCwgb3B0cy5BKTsKICAgICAgdHYyID0gRnAyLnNxcih0djMpOwogICAgICB0djYgPSBGcDIuc3FyKHR2NCk7CiAgICAgIHR2NSA9IEZwMi5tdWwodHY2LCBvcHRzLkEpOwogICAgICB0djIgPSBGcDIuYWRkKHR2MiwgdHY1KTsKICAgICAgdHYyID0gRnAyLm11bCh0djIsIHR2Myk7CiAgICAgIHR2NiA9IEZwMi5tdWwodHY2LCB0djQpOwogICAgICB0djUgPSBGcDIubXVsKHR2Niwgb3B0cy5CKTsKICAgICAgdHYyID0gRnAyLmFkZCh0djIsIHR2NSk7CiAgICAgIHggPSBGcDIubXVsKHR2MSwgdHYzKTsKICAgICAgY29uc3QgeyBpc1ZhbGlkLCB2YWx1ZSB9ID0gc3FydFJhdGlvKHR2MiwgdHY2KTsKICAgICAgeSA9IEZwMi5tdWwodHYxLCB1KTsKICAgICAgeSA9IEZwMi5tdWwoeSwgdmFsdWUpOwogICAgICB4ID0gRnAyLmNtb3YoeCwgdHYzLCBpc1ZhbGlkKTsKICAgICAgeSA9IEZwMi5jbW92KHksIHZhbHVlLCBpc1ZhbGlkKTsKICAgICAgY29uc3QgZTEgPSBGcDIuaXNPZGQodSkgPT09IEZwMi5pc09kZCh5KTsKICAgICAgeSA9IEZwMi5jbW92KEZwMi5uZWcoeSksIHksIGUxKTsKICAgICAgeCA9IEZwMi5kaXYoeCwgdHY0KTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgdmFyIGIybiwgaDJiLCBERVIsIF8wbjUsIF8xbjUsIF8ybjQsIF8zbjIsIF80bjI7CiAgdmFyIGluaXRfd2VpZXJzdHJhc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzIigpIHsKICAgICAgaW5pdF9jdXJ2ZSgpOwogICAgICBpbml0X21vZHVsYXIoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgKHsgYnl0ZXNUb051bWJlckJFOiBiMm4sIGhleFRvQnl0ZXM6IGgyYiB9ID0gdXRpbHNfZXhwb3J0cyk7CiAgICAgIERFUiA9IHsKICAgICAgICAvLyBhc24uMSBERVIgZW5jb2RpbmcgdXRpbHMKICAgICAgICBFcnI6IGNsYXNzIERFUkVyciBleHRlbmRzIEVycm9yIHsKICAgICAgICAgIGNvbnN0cnVjdG9yKG0gPSAiIikgewogICAgICAgICAgICBzdXBlcihtKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIEJhc2ljIGJ1aWxkaW5nIGJsb2NrIGlzIFRMViAoVGFnLUxlbmd0aC1WYWx1ZSkKICAgICAgICBfdGx2OiB7CiAgICAgICAgICBlbmNvZGU6ICh0YWcsIGRhdGEpID0+IHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgaWYgKHRhZyA8IDAgfHwgdGFnID4gMjU2KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZW5jb2RlOiB3cm9uZyB0YWciKTsKICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoICYgMSkKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogdW5wYWRkZWQgZGF0YSIpOwogICAgICAgICAgICBjb25zdCBkYXRhTGVuID0gZGF0YS5sZW5ndGggLyAyOwogICAgICAgICAgICBjb25zdCBsZW4gPSBudW1iZXJUb0hleFVucGFkZGVkKGRhdGFMZW4pOwogICAgICAgICAgICBpZiAobGVuLmxlbmd0aCAvIDIgJiAxMjgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5lbmNvZGU6IGxvbmcgZm9ybSBsZW5ndGggdG9vIGJpZyIpOwogICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBkYXRhTGVuID4gMTI3ID8gbnVtYmVyVG9IZXhVbnBhZGRlZChsZW4ubGVuZ3RoIC8gMiB8IDEyOCkgOiAiIjsKICAgICAgICAgICAgcmV0dXJuIGAke251bWJlclRvSGV4VW5wYWRkZWQodGFnKX0ke2xlbkxlbn0ke2xlbn0ke2RhdGF9YDsKICAgICAgICAgIH0sCiAgICAgICAgICAvLyB2IC0gdmFsdWUsIGwgLSBsZWZ0IGJ5dGVzICh1bnBhcnNlZCkKICAgICAgICAgIGRlY29kZSh0YWcsIGRhdGEpIHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgbGV0IHBvcyA9IDA7CiAgICAgICAgICAgIGlmICh0YWcgPCAwIHx8IHRhZyA+IDI1NikKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogd3JvbmcgdGFnIik7CiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA8IDIgfHwgZGF0YVtwb3MrK10gIT09IHRhZykKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZTogd3JvbmcgdGx2Iik7CiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gZGF0YVtwb3MrK107CiAgICAgICAgICAgIGNvbnN0IGlzTG9uZyA9ICEhKGZpcnN0ICYgMTI4KTsKICAgICAgICAgICAgbGV0IGxlbmd0aCA9IDA7CiAgICAgICAgICAgIGlmICghaXNMb25nKQogICAgICAgICAgICAgIGxlbmd0aCA9IGZpcnN0OwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBmaXJzdCAmIDEyNzsKICAgICAgICAgICAgICBpZiAoIWxlbkxlbikKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBpbmRlZmluaXRlIGxlbmd0aCBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICAgICAgaWYgKGxlbkxlbiA+IDQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogYnl0ZSBsZW5ndGggaXMgdG9vIGJpZyIpOwogICAgICAgICAgICAgIGNvbnN0IGxlbmd0aEJ5dGVzID0gZGF0YS5zdWJhcnJheShwb3MsIHBvcyArIGxlbkxlbik7CiAgICAgICAgICAgICAgaWYgKGxlbmd0aEJ5dGVzLmxlbmd0aCAhPT0gbGVuTGVuKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IGxlbmd0aCBieXRlcyBub3QgY29tcGxldGUiKTsKICAgICAgICAgICAgICBpZiAobGVuZ3RoQnl0ZXNbMF0gPT09IDApCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogemVybyBsZWZ0bW9zdCBieXRlIik7CiAgICAgICAgICAgICAgZm9yIChjb25zdCBiIG9mIGxlbmd0aEJ5dGVzKQogICAgICAgICAgICAgICAgbGVuZ3RoID0gbGVuZ3RoIDw8IDggfCBiOwogICAgICAgICAgICAgIHBvcyArPSBsZW5MZW47CiAgICAgICAgICAgICAgaWYgKGxlbmd0aCA8IDEyOCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBub3QgbWluaW1hbCBlbmNvZGluZyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHYgPSBkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgbGVuZ3RoKTsKICAgICAgICAgICAgaWYgKHYubGVuZ3RoICE9PSBsZW5ndGgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IHdyb25nIHZhbHVlIGxlbmd0aCIpOwogICAgICAgICAgICByZXR1cm4geyB2LCBsOiBkYXRhLnN1YmFycmF5KHBvcyArIGxlbmd0aCkgfTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIGh0dHBzOi8vY3J5cHRvLnN0YWNrZXhjaGFuZ2UuY29tL2EvNTc3MzQgTGVmdG1vc3QgYml0IG9mIGZpcnN0IGJ5dGUgaXMgJ25lZ2F0aXZlJyBmbGFnLAogICAgICAgIC8vIHNpbmNlIHdlIGFsd2F5cyB1c2UgcG9zaXRpdmUgaW50ZWdlcnMgaGVyZS4gSXQgbXVzdCBhbHdheXMgYmUgZW1wdHk6CiAgICAgICAgLy8gLSBhZGQgemVybyBieXRlIGlmIGV4aXN0cwogICAgICAgIC8vIC0gaWYgbmV4dCBieXRlIGRvZXNuJ3QgaGF2ZSBhIGZsYWcsIGxlYWRpbmcgemVybyBpcyBub3QgYWxsb3dlZCAobWluaW1hbCBlbmNvZGluZykKICAgICAgICBfaW50OiB7CiAgICAgICAgICBlbmNvZGUobnVtMikgewogICAgICAgICAgICBjb25zdCB7IEVycjogRSB9ID0gREVSOwogICAgICAgICAgICBpZiAobnVtMiA8IF8wbjUpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoImludGVnZXI6IG5lZ2F0aXZlIGludGVnZXJzIGFyZSBub3QgYWxsb3dlZCIpOwogICAgICAgICAgICBsZXQgaGV4ID0gbnVtYmVyVG9IZXhVbnBhZGRlZChudW0yKTsKICAgICAgICAgICAgaWYgKE51bWJlci5wYXJzZUludChoZXhbMF0sIDE2KSAmIDgpCiAgICAgICAgICAgICAgaGV4ID0gIjAwIiArIGhleDsKICAgICAgICAgICAgaWYgKGhleC5sZW5ndGggJiAxKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ1bmV4cGVjdGVkIGFzc2VydGlvbiIpOwogICAgICAgICAgICByZXR1cm4gaGV4OwogICAgICAgICAgfSwKICAgICAgICAgIGRlY29kZShkYXRhKSB7CiAgICAgICAgICAgIGNvbnN0IHsgRXJyOiBFIH0gPSBERVI7CiAgICAgICAgICAgIGlmIChkYXRhWzBdICYgMTI4KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiBuZWdhdGl2ZSIpOwogICAgICAgICAgICBpZiAoZGF0YVswXSA9PT0gMCAmJiAhKGRhdGFbMV0gJiAxMjgpKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiB1bm5lY2Vzc2FyeSBsZWFkaW5nIHplcm8iKTsKICAgICAgICAgICAgcmV0dXJuIGIybihkYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvU2lnKGhleCkgewogICAgICAgICAgY29uc3QgeyBFcnI6IEUsIF9pbnQ6IGludCwgX3RsdjogdGx2IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBkYXRhID0gdHlwZW9mIGhleCA9PT0gInN0cmluZyIgPyBoMmIoaGV4KSA6IGhleDsKICAgICAgICAgIGFieXRlcyhkYXRhKTsKICAgICAgICAgIGNvbnN0IHsgdjogc2VxQnl0ZXMsIGw6IHNlcUxlZnRCeXRlcyB9ID0gdGx2LmRlY29kZSg0OCwgZGF0YSk7CiAgICAgICAgICBpZiAoc2VxTGVmdEJ5dGVzLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEUoIkludmFsaWQgc2lnbmF0dXJlOiBsZWZ0IGJ5dGVzIGFmdGVyIHBhcnNpbmciKTsKICAgICAgICAgIGNvbnN0IHsgdjogckJ5dGVzLCBsOiByTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHNlcUJ5dGVzKTsKICAgICAgICAgIGNvbnN0IHsgdjogc0J5dGVzLCBsOiBzTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHJMZWZ0Qnl0ZXMpOwogICAgICAgICAgaWYgKHNMZWZ0Qnl0ZXMubGVuZ3RoKQogICAgICAgICAgICB0aHJvdyBuZXcgRSgiSW52YWxpZCBzaWduYXR1cmU6IGxlZnQgYnl0ZXMgYWZ0ZXIgcGFyc2luZyIpOwogICAgICAgICAgcmV0dXJuIHsgcjogaW50LmRlY29kZShyQnl0ZXMpLCBzOiBpbnQuZGVjb2RlKHNCeXRlcykgfTsKICAgICAgICB9LAogICAgICAgIGhleEZyb21TaWcoc2lnKSB7CiAgICAgICAgICBjb25zdCB7IF90bHY6IHRsdiwgX2ludDogaW50IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBzZXEgPSBgJHt0bHYuZW5jb2RlKDIsIGludC5lbmNvZGUoc2lnLnIpKX0ke3Rsdi5lbmNvZGUoMiwgaW50LmVuY29kZShzaWcucykpfWA7CiAgICAgICAgICByZXR1cm4gdGx2LmVuY29kZSg0OCwgc2VxKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIF8wbjUgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjUgPSBCaWdJbnQoMSk7CiAgICAgIF8ybjQgPSBCaWdJbnQoMik7CiAgICAgIF8zbjIgPSBCaWdJbnQoMyk7CiAgICAgIF80bjIgPSBCaWdJbnQoNCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9fc2hvcnR3X3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0SGFzaChoYXNoMykgewogICAgcmV0dXJuIHsKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIGhtYWM6IChrZXksIC4uLm1zZ3MpID0+IGhtYWMoaGFzaDMsIGtleSwgY29uY2F0Qnl0ZXMoLi4ubXNncykpLAogICAgICByYW5kb21CeXRlcwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlQ3VydmUoY3VydmVEZWYsIGRlZkhhc2gpIHsKICAgIGNvbnN0IGNyZWF0ZSA9IChoYXNoMykgPT4gd2VpZXJzdHJhc3MoeyAuLi5jdXJ2ZURlZiwgLi4uZ2V0SGFzaChoYXNoMykgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLmNyZWF0ZShkZWZIYXNoKSwgY3JlYXRlIH0pOwogIH0KICB2YXIgaW5pdF9zaG9ydHdfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanMiKCkgewogICAgICBpbml0X2htYWMoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF93ZWllcnN0cmFzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcwogIGZ1bmN0aW9uIGkyb3NwKHZhbHVlLCBsZW5ndGgpIHsKICAgIGFudW0odmFsdWUpOwogICAgYW51bShsZW5ndGgpOwogICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+PSAxIDw8IDggKiBsZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBiYWQgSTJPU1AgY2FsbDogdmFsdWU9JHt2YWx1ZX0gbGVuZ3RoPSR7bGVuZ3RofWApOwogICAgfQogICAgY29uc3QgcmVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aCB9KS5maWxsKDApOwogICAgZm9yIChsZXQgaSA9IGxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgIHJlc1tpXSA9IHZhbHVlICYgMjU1OwogICAgICB2YWx1ZSA+Pj49IDg7CiAgICB9CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkocmVzKTsKICB9CiAgZnVuY3Rpb24gc3RyeG9yKGEsIGIpIHsKICAgIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KGEubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBhW2ldIF4gYltpXTsKICAgIH0KICAgIHJldHVybiBhcnI7CiAgfQogIGZ1bmN0aW9uIGFudW0oaXRlbSkgewogICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJudW1iZXIgZXhwZWN0ZWQiKTsKICB9CiAgZnVuY3Rpb24gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5JbkJ5dGVzLCBIKSB7CiAgICBhYnl0ZXMobXNnKTsKICAgIGFieXRlcyhEU1QpOwogICAgYW51bShsZW5JbkJ5dGVzKTsKICAgIGlmIChEU1QubGVuZ3RoID4gMjU1KQogICAgICBEU1QgPSBIKGNvbmNhdEJ5dGVzMyh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIiksIERTVCkpOwogICAgY29uc3QgeyBvdXRwdXRMZW46IGJfaW5fYnl0ZXMsIGJsb2NrTGVuOiByX2luX2J5dGVzIH0gPSBIOwogICAgY29uc3QgZWxsID0gTWF0aC5jZWlsKGxlbkluQnl0ZXMgLyBiX2luX2J5dGVzKTsKICAgIGlmIChsZW5JbkJ5dGVzID4gNjU1MzUgfHwgZWxsID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3htZDogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICBjb25zdCBEU1RfcHJpbWUgPSBjb25jYXRCeXRlczMoRFNULCBpMm9zcChEU1QubGVuZ3RoLCAxKSk7CiAgICBjb25zdCBaX3BhZCA9IGkyb3NwKDAsIHJfaW5fYnl0ZXMpOwogICAgY29uc3QgbF9pX2Jfc3RyID0gaTJvc3AobGVuSW5CeXRlcywgMik7CiAgICBjb25zdCBiID0gbmV3IEFycmF5KGVsbCk7CiAgICBjb25zdCBiXzAgPSBIKGNvbmNhdEJ5dGVzMyhaX3BhZCwgbXNnLCBsX2lfYl9zdHIsIGkyb3NwKDAsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGJbMF0gPSBIKGNvbmNhdEJ5dGVzMyhiXzAsIGkyb3NwKDEsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGVsbDsgaSsrKSB7CiAgICAgIGNvbnN0IGFyZ3MgPSBbc3RyeG9yKGJfMCwgYltpIC0gMV0pLCBpMm9zcChpICsgMSwgMSksIERTVF9wcmltZV07CiAgICAgIGJbaV0gPSBIKGNvbmNhdEJ5dGVzMyguLi5hcmdzKSk7CiAgICB9CiAgICBjb25zdCBwc2V1ZG9fcmFuZG9tX2J5dGVzID0gY29uY2F0Qnl0ZXMzKC4uLmIpOwogICAgcmV0dXJuIHBzZXVkb19yYW5kb21fYnl0ZXMuc2xpY2UoMCwgbGVuSW5CeXRlcyk7CiAgfQogIGZ1bmN0aW9uIGV4cGFuZF9tZXNzYWdlX3hvZihtc2csIERTVCwgbGVuSW5CeXRlcywgaywgSCkgewogICAgYWJ5dGVzKG1zZyk7CiAgICBhYnl0ZXMoRFNUKTsKICAgIGFudW0obGVuSW5CeXRlcyk7CiAgICBpZiAoRFNULmxlbmd0aCA+IDI1NSkgewogICAgICBjb25zdCBka0xlbiA9IE1hdGguY2VpbCgyICogayAvIDgpOwogICAgICBEU1QgPSBILmNyZWF0ZSh7IGRrTGVuIH0pLnVwZGF0ZSh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIikpLnVwZGF0ZShEU1QpLmRpZ2VzdCgpOwogICAgfQogICAgaWYgKGxlbkluQnl0ZXMgPiA2NTUzNSB8fCBEU1QubGVuZ3RoID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3hvZjogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICByZXR1cm4gSC5jcmVhdGUoeyBka0xlbjogbGVuSW5CeXRlcyB9KS51cGRhdGUobXNnKS51cGRhdGUoaTJvc3AobGVuSW5CeXRlcywgMikpLnVwZGF0ZShEU1QpLnVwZGF0ZShpMm9zcChEU1QubGVuZ3RoLCAxKSkuZGlnZXN0KCk7CiAgfQogIGZ1bmN0aW9uIGhhc2hfdG9fZmllbGQobXNnLCBjb3VudCwgb3B0aW9ucykgewogICAgdmFsaWRhdGVPYmplY3Qob3B0aW9ucywgewogICAgICBEU1Q6ICJzdHJpbmdPclVpbnQ4QXJyYXkiLAogICAgICBwOiAiYmlnaW50IiwKICAgICAgbTogImlzU2FmZUludGVnZXIiLAogICAgICBrOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIGhhc2g6ICJoYXNoIgogICAgfSk7CiAgICBjb25zdCB7IHAsIGssIG0sIGhhc2g6IGhhc2gzLCBleHBhbmQsIERTVDogX0RTVCB9ID0gb3B0aW9uczsKICAgIGFieXRlcyhtc2cpOwogICAgYW51bShjb3VudCk7CiAgICBjb25zdCBEU1QgPSB0eXBlb2YgX0RTVCA9PT0gInN0cmluZyIgPyB1dGY4VG9CeXRlczIoX0RTVCkgOiBfRFNUOwogICAgY29uc3QgbG9nMnAgPSBwLnRvU3RyaW5nKDIpLmxlbmd0aDsKICAgIGNvbnN0IEwgPSBNYXRoLmNlaWwoKGxvZzJwICsgaykgLyA4KTsKICAgIGNvbnN0IGxlbl9pbl9ieXRlcyA9IGNvdW50ICogbSAqIEw7CiAgICBsZXQgcHJiOwogICAgaWYgKGV4cGFuZCA9PT0gInhtZCIpIHsKICAgICAgcHJiID0gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5faW5fYnl0ZXMsIGhhc2gzKTsKICAgIH0gZWxzZSBpZiAoZXhwYW5kID09PSAieG9mIikgewogICAgICBwcmIgPSBleHBhbmRfbWVzc2FnZV94b2YobXNnLCBEU1QsIGxlbl9pbl9ieXRlcywgaywgaGFzaDMpOwogICAgfSBlbHNlIGlmIChleHBhbmQgPT09ICJfaW50ZXJuYWxfcGFzcyIpIHsKICAgICAgcHJiID0gbXNnOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdleHBhbmQgbXVzdCBiZSAieG1kIiBvciAieG9mIicpOwogICAgfQogICAgY29uc3QgdSA9IG5ldyBBcnJheShjb3VudCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZSA9IG5ldyBBcnJheShtKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBtOyBqKyspIHsKICAgICAgICBjb25zdCBlbG1fb2Zmc2V0ID0gTCAqIChqICsgaSAqIG0pOwogICAgICAgIGNvbnN0IHR2ID0gcHJiLnN1YmFycmF5KGVsbV9vZmZzZXQsIGVsbV9vZmZzZXQgKyBMKTsKICAgICAgICBlW2pdID0gbW9kKG9zMmlwKHR2KSwgcCk7CiAgICAgIH0KICAgICAgdVtpXSA9IGU7CiAgICB9CiAgICByZXR1cm4gdTsKICB9CiAgZnVuY3Rpb24gaXNvZ2VueU1hcChmaWVsZCwgbWFwKSB7CiAgICBjb25zdCBDT0VGRiA9IG1hcC5tYXAoKGkpID0+IEFycmF5LmZyb20oaSkucmV2ZXJzZSgpKTsKICAgIHJldHVybiAoeCwgeSkgPT4gewogICAgICBjb25zdCBbeE51bSwgeERlbiwgeU51bSwgeURlbl0gPSBDT0VGRi5tYXAoKHZhbCkgPT4gdmFsLnJlZHVjZSgoYWNjLCBpKSA9PiBmaWVsZC5hZGQoZmllbGQubXVsKGFjYywgeCksIGkpKSk7CiAgICAgIHggPSBmaWVsZC5kaXYoeE51bSwgeERlbik7CiAgICAgIHkgPSBmaWVsZC5tdWwoeSwgZmllbGQuZGl2KHlOdW0sIHlEZW4pKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlSGFzaGVyKFBvaW50MiwgbWFwVG9DdXJ2ZSwgZGVmKSB7CiAgICBpZiAodHlwZW9mIG1hcFRvQ3VydmUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZSgpIG11c3QgYmUgZGVmaW5lZCIpOwogICAgcmV0dXJuIHsKICAgICAgLy8gRW5jb2RlcyBieXRlIHN0cmluZyB0byBlbGxpcHRpYyBjdXJ2ZS4KICAgICAgLy8gaGFzaF90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBoYXNoVG9DdXJ2ZShtc2csIG9wdGlvbnMpIHsKICAgICAgICBjb25zdCB1ID0gaGFzaF90b19maWVsZChtc2csIDIsIHsgLi4uZGVmLCBEU1Q6IGRlZi5EU1QsIC4uLm9wdGlvbnMgfSk7CiAgICAgICAgY29uc3QgdTAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHVbMF0pKTsKICAgICAgICBjb25zdCB1MSA9IFBvaW50Mi5mcm9tQWZmaW5lKG1hcFRvQ3VydmUodVsxXSkpOwogICAgICAgIGNvbnN0IFAgPSB1MC5hZGQodTEpLmNsZWFyQ29mYWN0b3IoKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0sCiAgICAgIC8vIEVuY29kZXMgYnl0ZSBzdHJpbmcgdG8gZWxsaXB0aWMgY3VydmUuCiAgICAgIC8vIGVuY29kZV90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBlbmNvZGVUb0N1cnZlKG1zZywgb3B0aW9ucykgewogICAgICAgIGNvbnN0IHUgPSBoYXNoX3RvX2ZpZWxkKG1zZywgMSwgeyAuLi5kZWYsIERTVDogZGVmLmVuY29kZURTVCwgLi4ub3B0aW9ucyB9KTsKICAgICAgICBjb25zdCBQID0gUG9pbnQyLmZyb21BZmZpbmUobWFwVG9DdXJ2ZSh1WzBdKSkuY2xlYXJDb2ZhY3RvcigpOwogICAgICAgIFAuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgICByZXR1cm4gUDsKICAgICAgfSwKICAgICAgLy8gU2FtZSBhcyBlbmNvZGVUb0N1cnZlLCBidXQgd2l0aG91dCBoYXNoCiAgICAgIG1hcFRvQ3VydmUoc2NhbGFycykgewogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzY2FsYXJzKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZTogZXhwZWN0ZWQgYXJyYXkgb2YgYmlnaW50cyIpOwogICAgICAgIGZvciAoY29uc3QgaSBvZiBzY2FsYXJzKQogICAgICAgICAgaWYgKHR5cGVvZiBpICE9PSAiYmlnaW50IikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBtYXBUb0N1cnZlOiBleHBlY3RlZCBhcnJheSBvZiBiaWdpbnRzLCBnb3QgJHtpfSBpbiBhcnJheWApOwogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHNjYWxhcnMpKS5jbGVhckNvZmFjdG9yKCk7CiAgICAgICAgUC5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBQOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgb3MyaXA7CiAgdmFyIGluaXRfaGFzaF90b19jdXJ2ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcyIoKSB7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBvczJpcCA9IGJ5dGVzVG9OdW1iZXJCRTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL3NlY3AyNTZrMS5qcwogIHZhciBzZWNwMjU2azFfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KHNlY3AyNTZrMV9leHBvcnRzLCB7CiAgICBlbmNvZGVUb0N1cnZlOiAoKSA9PiBlbmNvZGVUb0N1cnZlLAogICAgaGFzaFRvQ3VydmU6ICgpID0+IGhhc2hUb0N1cnZlLAogICAgc2Nobm9ycjogKCkgPT4gc2Nobm9yciwKICAgIHNlY3AyNTZrMTogKCkgPT4gc2VjcDI1NmsxCiAgfSk7CiAgZnVuY3Rpb24gc3FydE1vZCh5KSB7CiAgICBjb25zdCBQID0gc2VjcDI1NmsxUDsKICAgIGNvbnN0IF8zbjMgPSBCaWdJbnQoMyksIF82biA9IEJpZ0ludCg2KSwgXzExbiA9IEJpZ0ludCgxMSksIF8yMm4gPSBCaWdJbnQoMjIpOwogICAgY29uc3QgXzIzbiA9IEJpZ0ludCgyMyksIF80NG4gPSBCaWdJbnQoNDQpLCBfODhuID0gQmlnSW50KDg4KTsKICAgIGNvbnN0IGIyID0geSAqIHkgKiB5ICUgUDsKICAgIGNvbnN0IGIzMiA9IGIyICogYjIgKiB5ICUgUDsKICAgIGNvbnN0IGI2ID0gcG93MihiMzIsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IGI5ID0gcG93MihiNiwgXzNuMywgUCkgKiBiMzIgJSBQOwogICAgY29uc3QgYjExID0gcG93MihiOSwgXzJuNSwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCBiMjIgPSBwb3cyKGIxMSwgXzExbiwgUCkgKiBiMTEgJSBQOwogICAgY29uc3QgYjQ0ID0gcG93MihiMjIsIF8yMm4sIFApICogYjIyICUgUDsKICAgIGNvbnN0IGI4OCA9IHBvdzIoYjQ0LCBfNDRuLCBQKSAqIGI0NCAlIFA7CiAgICBjb25zdCBiMTc2ID0gcG93MihiODgsIF84OG4sIFApICogYjg4ICUgUDsKICAgIGNvbnN0IGIyMjAgPSBwb3cyKGIxNzYsIF80NG4sIFApICogYjQ0ICUgUDsKICAgIGNvbnN0IGIyMjMgPSBwb3cyKGIyMjAsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IHQxID0gcG93MihiMjIzLCBfMjNuLCBQKSAqIGIyMiAlIFA7CiAgICBjb25zdCB0MiA9IHBvdzIodDEsIF82biwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCByb290MiA9IHBvdzIodDIsIF8ybjUsIFApOwogICAgaWYgKCFGcC5lcWwoRnAuc3FyKHJvb3QyKSwgeSkpCiAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgIHJldHVybiByb290MjsKICB9CiAgZnVuY3Rpb24gdGFnZ2VkSGFzaCh0YWcsIC4uLm1lc3NhZ2VzKSB7CiAgICBsZXQgdGFnUCA9IFRBR0dFRF9IQVNIX1BSRUZJWEVTW3RhZ107CiAgICBpZiAodGFnUCA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IHRhZ0ggPSBzaGEyNTYoVWludDhBcnJheS5mcm9tKHRhZywgKGMpID0+IGMuY2hhckNvZGVBdCgwKSkpOwogICAgICB0YWdQID0gY29uY2F0Qnl0ZXMzKHRhZ0gsIHRhZ0gpOwogICAgICBUQUdHRURfSEFTSF9QUkVGSVhFU1t0YWddID0gdGFnUDsKICAgIH0KICAgIHJldHVybiBzaGEyNTYoY29uY2F0Qnl0ZXMzKHRhZ1AsIC4uLm1lc3NhZ2VzKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdikgewogICAgbGV0IGRfID0gc2VjcDI1NmsxLnV0aWxzLm5vcm1Qcml2YXRlS2V5VG9TY2FsYXIocHJpdik7CiAgICBsZXQgcCA9IFBvaW50LmZyb21Qcml2YXRlS2V5KGRfKTsKICAgIGNvbnN0IHNjYWxhciA9IHAuaGFzRXZlblkoKSA/IGRfIDogbW9kTigtZF8pOwogICAgcmV0dXJuIHsgc2NhbGFyLCBieXRlczogcG9pbnRUb0J5dGVzKHApIH07CiAgfQogIGZ1bmN0aW9uIGxpZnRfeCh4KSB7CiAgICBhSW5SYW5nZSgieCIsIHgsIF8xbjYsIHNlY3AyNTZrMVApOwogICAgY29uc3QgeHggPSBtb2RQKHggKiB4KTsKICAgIGNvbnN0IGMgPSBtb2RQKHh4ICogeCArIEJpZ0ludCg3KSk7CiAgICBsZXQgeSA9IHNxcnRNb2QoYyk7CiAgICBpZiAoeSAlIF8ybjUgIT09IF8wbjYpCiAgICAgIHkgPSBtb2RQKC15KTsKICAgIGNvbnN0IHAgPSBuZXcgUG9pbnQoeCwgeSwgXzFuNik7CiAgICBwLmFzc2VydFZhbGlkaXR5KCk7CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gY2hhbGxlbmdlKC4uLmFyZ3MpIHsKICAgIHJldHVybiBtb2ROKG51bSh0YWdnZWRIYXNoKCJCSVAwMzQwL2NoYWxsZW5nZSIsIC4uLmFyZ3MpKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRQdWJsaWNLZXkocHJpdmF0ZUtleSkgewogICAgcmV0dXJuIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdmF0ZUtleSkuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJTaWduKG1lc3NhZ2UsIHByaXZhdGVLZXksIGF1eFJhbmQgPSByYW5kb21CeXRlcygzMikpIHsKICAgIGNvbnN0IG0gPSBlbnN1cmVCeXRlcygibWVzc2FnZSIsIG1lc3NhZ2UpOwogICAgY29uc3QgeyBieXRlczogcHgsIHNjYWxhcjogZCB9ID0gc2Nobm9yckdldEV4dFB1YktleShwcml2YXRlS2V5KTsKICAgIGNvbnN0IGEgPSBlbnN1cmVCeXRlcygiYXV4UmFuZCIsIGF1eFJhbmQsIDMyKTsKICAgIGNvbnN0IHQgPSBudW1UbzMyYihkIF4gbnVtKHRhZ2dlZEhhc2goIkJJUDAzNDAvYXV4IiwgYSkpKTsKICAgIGNvbnN0IHJhbmQgPSB0YWdnZWRIYXNoKCJCSVAwMzQwL25vbmNlIiwgdCwgcHgsIG0pOwogICAgY29uc3Qga18gPSBtb2ROKG51bShyYW5kKSk7CiAgICBpZiAoa18gPT09IF8wbjYpCiAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbiBmYWlsZWQ6IGsgaXMgemVybyIpOwogICAgY29uc3QgeyBieXRlczogcngsIHNjYWxhcjogayB9ID0gc2Nobm9yckdldEV4dFB1YktleShrXyk7CiAgICBjb25zdCBlID0gY2hhbGxlbmdlKHJ4LCBweCwgbSk7CiAgICBjb25zdCBzaWcgPSBuZXcgVWludDhBcnJheSg2NCk7CiAgICBzaWcuc2V0KHJ4LCAwKTsKICAgIHNpZy5zZXQobnVtVG8zMmIobW9kTihrICsgZSAqIGQpKSwgMzIpOwogICAgaWYgKCFzY2hub3JyVmVyaWZ5KHNpZywgbSwgcHgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInNpZ246IEludmFsaWQgc2lnbmF0dXJlIHByb2R1Y2VkIik7CiAgICByZXR1cm4gc2lnOwogIH0KICBmdW5jdGlvbiBzY2hub3JyVmVyaWZ5KHNpZ25hdHVyZSwgbWVzc2FnZSwgcHVibGljS2V5KSB7CiAgICBjb25zdCBzaWcgPSBlbnN1cmVCeXRlcygic2lnbmF0dXJlIiwgc2lnbmF0dXJlLCA2NCk7CiAgICBjb25zdCBtID0gZW5zdXJlQnl0ZXMoIm1lc3NhZ2UiLCBtZXNzYWdlKTsKICAgIGNvbnN0IHB1YiA9IGVuc3VyZUJ5dGVzKCJwdWJsaWNLZXkiLCBwdWJsaWNLZXksIDMyKTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFAgPSBsaWZ0X3gobnVtKHB1YikpOwogICAgICBjb25zdCByID0gbnVtKHNpZy5zdWJhcnJheSgwLCAzMikpOwogICAgICBpZiAoIWluUmFuZ2UociwgXzFuNiwgc2VjcDI1NmsxUCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBzID0gbnVtKHNpZy5zdWJhcnJheSgzMiwgNjQpKTsKICAgICAgaWYgKCFpblJhbmdlKHMsIF8xbjYsIHNlY3AyNTZrMU4pKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgY29uc3QgZSA9IGNoYWxsZW5nZShudW1UbzMyYihyKSwgcG9pbnRUb0J5dGVzKFApLCBtKTsKICAgICAgY29uc3QgUiA9IEdtdWxBZGQoUCwgcywgbW9kTigtZSkpOwogICAgICBpZiAoIVIgfHwgIVIuaGFzRXZlblkoKSB8fCBSLnRvQWZmaW5lKCkueCAhPT0gcikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KICB2YXIgc2VjcDI1NmsxUCwgc2VjcDI1NmsxTiwgXzFuNiwgXzJuNSwgZGl2TmVhcmVzdCwgRnAsIHNlY3AyNTZrMSwgXzBuNiwgVEFHR0VEX0hBU0hfUFJFRklYRVMsIHBvaW50VG9CeXRlcywgbnVtVG8zMmIsIG1vZFAsIG1vZE4sIFBvaW50LCBHbXVsQWRkLCBudW0sIHNjaG5vcnIsIGlzb01hcCwgbWFwU1dVLCBodGYsIGhhc2hUb0N1cnZlLCBlbmNvZGVUb0N1cnZlOwogIHZhciBpbml0X3NlY3AyNTZrMSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzIigpIHsKICAgICAgaW5pdF9zaGEyNTYoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF9zaG9ydHdfdXRpbHMoKTsKICAgICAgaW5pdF9oYXNoX3RvX2N1cnZlKCk7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBpbml0X3dlaWVyc3RyYXNzKCk7CiAgICAgIHNlY3AyNTZrMVAgPSBCaWdJbnQoIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZmMyZiIpOwogICAgICBzZWNwMjU2azFOID0gQmlnSW50KCIweGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlYmFhZWRjZTZhZjQ4YTAzYmJmZDI1ZThjZDAzNjQxNDEiKTsKICAgICAgXzFuNiA9IEJpZ0ludCgxKTsKICAgICAgXzJuNSA9IEJpZ0ludCgyKTsKICAgICAgZGl2TmVhcmVzdCA9IChhLCBiKSA9PiAoYSArIGIgLyBfMm41KSAvIGI7CiAgICAgIEZwID0gRmllbGQoc2VjcDI1NmsxUCwgdm9pZCAwLCB2b2lkIDAsIHsgc3FydDogc3FydE1vZCB9KTsKICAgICAgc2VjcDI1NmsxID0gY3JlYXRlQ3VydmUoewogICAgICAgIGE6IEJpZ0ludCgwKSwKICAgICAgICAvLyBlcXVhdGlvbiBwYXJhbXM6IGEsIGIKICAgICAgICBiOiBCaWdJbnQoNyksCiAgICAgICAgLy8gU2VlbSB0byBiZSByaWdpZDogYml0Y29pbnRhbGsub3JnL2luZGV4LnBocD90b3BpYz0yODk3OTUubXNnMzE4Mzk3NSNtc2czMTgzOTc1CiAgICAgICAgRnAsCiAgICAgICAgLy8gRmllbGQncyBwcmltZTogMm4qKjI1Nm4gLSAybioqMzJuIC0gMm4qKjluIC0gMm4qKjhuIC0gMm4qKjduIC0gMm4qKjZuIC0gMm4qKjRuIC0gMW4KICAgICAgICBuOiBzZWNwMjU2azFOLAogICAgICAgIC8vIEN1cnZlIG9yZGVyLCB0b3RhbCBjb3VudCBvZiB2YWxpZCBwb2ludHMgaW4gdGhlIGZpZWxkCiAgICAgICAgLy8gQmFzZSBwb2ludCAoeCwgeSkgYWthIGdlbmVyYXRvciBwb2ludAogICAgICAgIEd4OiBCaWdJbnQoIjU1MDY2MjYzMDIyMjc3MzQzNjY5NTc4NzE4ODk1MTY4NTM0MzI2MjUwNjAzNDUzNzc3NTk0MTc1NTAwMTg3MzYwMzg5MTE2NzI5MjQwIiksCiAgICAgICAgR3k6IEJpZ0ludCgiMzI2NzA1MTAwMjA3NTg4MTY5NzgwODMwODUxMzA1MDcwNDMxODQ0NzEyNzMzODA2NTkyNDMyNzU5Mzg5MDQzMzU3NTczMzc0ODI0MjQiKSwKICAgICAgICBoOiBCaWdJbnQoMSksCiAgICAgICAgLy8gQ29mYWN0b3IKICAgICAgICBsb3dTOiB0cnVlLAogICAgICAgIC8vIEFsbG93IG9ubHkgbG93LVMgc2lnbmF0dXJlcyBieSBkZWZhdWx0IGluIHNpZ24oKSBhbmQgdmVyaWZ5KCkKICAgICAgICAvKioKICAgICAgICAgKiBzZWNwMjU2azEgYmVsb25ncyB0byBLb2JsaXR6IGN1cnZlczogaXQgaGFzIGVmZmljaWVudGx5IGNvbXB1dGFibGUgZW5kb21vcnBoaXNtLgogICAgICAgICAqIEVuZG9tb3JwaGlzbSB1c2VzIDJ4IGxlc3MgUkFNLCBzcGVlZHMgdXAgcHJlY29tcHV0YXRpb24gYnkgMnggYW5kIEVDREggLyBrZXkgcmVjb3ZlcnkgYnkgMjAlLgogICAgICAgICAqIEZvciBwcmVjb21wdXRlZCB3TkFGIGl0IHRyYWRlcyBvZmYgMS8yIGluaXQgdGltZSAmIDEvMyByYW0gZm9yIDIwJSBwZXJmIGhpdC4KICAgICAgICAgKiBFeHBsYW5hdGlvbjogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vcGF1bG1pbGxyL2ViNjcwODA2NzkzZTg0ZGY2MjhhN2M0MzRhODczMDY2CiAgICAgICAgICovCiAgICAgICAgZW5kbzogewogICAgICAgICAgYmV0YTogQmlnSW50KCIweDdhZTk2YTJiNjU3YzA3MTA2ZTY0NDc5ZWFjMzQzNGU5OWNmMDQ5NzUxMmY1ODk5NWMxMzk2YzI4NzE5NTAxZWUiKSwKICAgICAgICAgIHNwbGl0U2NhbGFyOiAoaykgPT4gewogICAgICAgICAgICBjb25zdCBuID0gc2VjcDI1NmsxTjsKICAgICAgICAgICAgY29uc3QgYTEgPSBCaWdJbnQoIjB4MzA4NmQyMjFhN2Q0NmJjZGU4NmM5MGU0OTI4NGViMTUiKTsKICAgICAgICAgICAgY29uc3QgYjEgPSAtXzFuNiAqIEJpZ0ludCgiMHhlNDQzN2VkNjAxMGU4ODI4NmY1NDdmYTkwYWJmZTRjMyIpOwogICAgICAgICAgICBjb25zdCBhMiA9IEJpZ0ludCgiMHgxMTRjYTUwZjdhOGUyZjNmNjU3YzExMDhkOWQ0NGNmZDgiKTsKICAgICAgICAgICAgY29uc3QgYjIgPSBhMTsKICAgICAgICAgICAgY29uc3QgUE9XXzJfMTI4ID0gQmlnSW50KCIweDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIpOwogICAgICAgICAgICBjb25zdCBjMSA9IGRpdk5lYXJlc3QoYjIgKiBrLCBuKTsKICAgICAgICAgICAgY29uc3QgYzIgPSBkaXZOZWFyZXN0KC1iMSAqIGssIG4pOwogICAgICAgICAgICBsZXQgazEgPSBtb2QoayAtIGMxICogYTEgLSBjMiAqIGEyLCBuKTsKICAgICAgICAgICAgbGV0IGsyID0gbW9kKC1jMSAqIGIxIC0gYzIgKiBiMiwgbik7CiAgICAgICAgICAgIGNvbnN0IGsxbmVnID0gazEgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGNvbnN0IGsybmVnID0gazIgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGlmIChrMW5lZykKICAgICAgICAgICAgICBrMSA9IG4gLSBrMTsKICAgICAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgICAgIGsyID0gbiAtIGsyOwogICAgICAgICAgICBpZiAoazEgPiBQT1dfMl8xMjggfHwgazIgPiBQT1dfMl8xMjgpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNwbGl0U2NhbGFyOiBFbmRvbW9ycGhpc20gZmFpbGVkLCBrPSIgKyBrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4geyBrMW5lZywgazEsIGsybmVnLCBrMiB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgc2hhMjU2KTsKICAgICAgXzBuNiA9IEJpZ0ludCgwKTsKICAgICAgVEFHR0VEX0hBU0hfUFJFRklYRVMgPSB7fTsKICAgICAgcG9pbnRUb0J5dGVzID0gKHBvaW50KSA9PiBwb2ludC50b1Jhd0J5dGVzKHRydWUpLnNsaWNlKDEpOwogICAgICBudW1UbzMyYiA9IChuKSA9PiBudW1iZXJUb0J5dGVzQkUobiwgMzIpOwogICAgICBtb2RQID0gKHgpID0+IG1vZCh4LCBzZWNwMjU2azFQKTsKICAgICAgbW9kTiA9ICh4KSA9PiBtb2QoeCwgc2VjcDI1NmsxTik7CiAgICAgIFBvaW50ID0gc2VjcDI1NmsxLlByb2plY3RpdmVQb2ludDsKICAgICAgR211bEFkZCA9IChRLCBhLCBiKSA9PiBQb2ludC5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFEsIGEsIGIpOwogICAgICBudW0gPSBieXRlc1RvTnVtYmVyQkU7CiAgICAgIHNjaG5vcnIgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+ICh7CiAgICAgICAgZ2V0UHVibGljS2V5OiBzY2hub3JyR2V0UHVibGljS2V5LAogICAgICAgIHNpZ246IHNjaG5vcnJTaWduLAogICAgICAgIHZlcmlmeTogc2Nobm9yclZlcmlmeSwKICAgICAgICB1dGlsczogewogICAgICAgICAgcmFuZG9tUHJpdmF0ZUtleTogc2VjcDI1NmsxLnV0aWxzLnJhbmRvbVByaXZhdGVLZXksCiAgICAgICAgICBsaWZ0X3gsCiAgICAgICAgICBwb2ludFRvQnl0ZXMsCiAgICAgICAgICBudW1iZXJUb0J5dGVzQkUsCiAgICAgICAgICBieXRlc1RvTnVtYmVyQkUsCiAgICAgICAgICB0YWdnZWRIYXNoLAogICAgICAgICAgbW9kCiAgICAgICAgfQogICAgICB9KSkoKTsKICAgICAgaXNvTWFwID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBpc29nZW55TWFwKEZwLCBbCiAgICAgICAgLy8geE51bQogICAgICAgIFsKICAgICAgICAgICIweDhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhkYWFhYWE4YzciLAogICAgICAgICAgIjB4N2QzZDRjODBiYzMyMWQ1YjlmMzE1Y2VhN2ZkNDRjNWQ1OTVkMmZjMGJmNjNiOTJkZmZmMTA0NGYxN2M2NTgxIiwKICAgICAgICAgICIweDUzNGMzMjhkMjNmMjM0ZTZlMmE0MTNkZWNhMjVjYWVjZTQ1MDYxNDQwMzdjNDAzMTRlY2JkMGI1M2Q5ZGQyNjIiLAogICAgICAgICAgIjB4OGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGRhYWFhYTg4YyIKICAgICAgICBdLAogICAgICAgIC8vIHhEZW4KICAgICAgICBbCiAgICAgICAgICAiMHhkMzU3NzExOTNkOTQ5MThhOWNhMzRjY2JiN2I2NDBkZDg2Y2Q0MDk1NDJmODQ4N2Q5ZmU2Yjc0NTc4MWViNDliIiwKICAgICAgICAgICIweGVkYWRjNmY2NDM4M2RjMWRmN2M0YjJkNTFiNTQyMjU0MDZkMzZiNjQxZjVlNDFiYmM1MmE1NjYxMmE4YzZkMTQiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0sCiAgICAgICAgLy8geU51bQogICAgICAgIFsKICAgICAgICAgICIweDRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiOGUzOGUyM2MiLAogICAgICAgICAgIjB4Yzc1ZTBjMzJkNWNiN2MwZmE5ZDBhNTRiMTJhMGE2ZDU2NDdhYjA0NmQ2ODZkYTZmZGZmYzkwZmMyMDFkNzFhMyIsCiAgICAgICAgICAiMHgyOWE2MTk0NjkxZjkxYTczNzE1MjA5ZWY2NTEyZTU3NjcyMjgzMGEyMDFiZTIwMThhNzY1ZTg1YTllY2VlOTMxIiwKICAgICAgICAgICIweDJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmMzhlMzhkODQiCiAgICAgICAgXSwKICAgICAgICAvLyB5RGVuCiAgICAgICAgWwogICAgICAgICAgIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZjkzYiIsCiAgICAgICAgICAiMHg3YTA2NTM0YmI4YmRiNDlmZDVlOWU2NjMyNzIyYzI5ODk0NjdjMWJmYzhlOGQ5NzhkZmI0MjVkMjY4NWMyNTczIiwKICAgICAgICAgICIweDY0ODRhYTcxNjU0NWNhMmNmM2E3MGMzZmE4ZmUzMzdlMGEzZDIxMTYyZjBkNjI5OWE3YmY4MTkyYmZkMmE3NmYiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0KICAgICAgXS5tYXAoKGkpID0+IGkubWFwKChqKSA9PiBCaWdJbnQoaikpKSkpKCk7CiAgICAgIG1hcFNXVSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gbWFwVG9DdXJ2ZVNpbXBsZVNXVShGcCwgewogICAgICAgIEE6IEJpZ0ludCgiMHgzZjg3MzFhYmRkNjYxYWRjYTA4YTU1NThmMGY1ZDI3MmU5NTNkMzYzY2I2ZjBlNWQ0MDU0NDdjMDFhNDQ0NTMzIiksCiAgICAgICAgQjogQmlnSW50KCIxNzcxIiksCiAgICAgICAgWjogRnAuY3JlYXRlKEJpZ0ludCgiLTExIikpCiAgICAgIH0pKSgpOwogICAgICBodGYgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGNyZWF0ZUhhc2hlcihzZWNwMjU2azEuUHJvamVjdGl2ZVBvaW50LCAoc2NhbGFycykgPT4gewogICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gbWFwU1dVKEZwLmNyZWF0ZShzY2FsYXJzWzBdKSk7CiAgICAgICAgcmV0dXJuIGlzb01hcCh4LCB5KTsKICAgICAgfSwgewogICAgICAgIERTVDogInNlY3AyNTZrMV9YTUQ6U0hBLTI1Nl9TU1dVX1JPXyIsCiAgICAgICAgZW5jb2RlRFNUOiAic2VjcDI1NmsxX1hNRDpTSEEtMjU2X1NTV1VfTlVfIiwKICAgICAgICBwOiBGcC5PUkRFUiwKICAgICAgICBtOiAxLAogICAgICAgIGs6IDEyOCwKICAgICAgICBleHBhbmQ6ICJ4bWQiLAogICAgICAgIGhhc2g6IHNoYTI1NgogICAgICB9KSkoKTsKICAgICAgaGFzaFRvQ3VydmUgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGh0Zi5oYXNoVG9DdXJ2ZSkoKTsKICAgICAgZW5jb2RlVG9DdXJ2ZSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gaHRmLmVuY29kZVRvQ3VydmUpKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcwogIHZhciBFeGVjdXRpb25SZXZlcnRlZEVycm9yLCBGZWVDYXBUb29IaWdoRXJyb3IsIEZlZUNhcFRvb0xvd0Vycm9yLCBOb25jZVRvb0hpZ2hFcnJvciwgTm9uY2VUb29Mb3dFcnJvciwgTm9uY2VNYXhWYWx1ZUVycm9yLCBJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLCBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yLCBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvciwgVGlwQWJvdmVGZWVDYXBFcnJvciwgVW5rbm93bk5vZGVFcnJvcjsKICB2YXIgaW5pdF9ub2RlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0R3dlaSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWVzc2FnZSB9ID0ge30pIHsKICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IG1lc3NhZ2U/LnJlcGxhY2UoImV4ZWN1dGlvbiByZXZlcnRlZDogIiwgIiIpPy5yZXBsYWNlKCJleGVjdXRpb24gcmV2ZXJ0ZWQiLCAiIik7CiAgICAgICAgICBzdXBlcihgRXhlY3V0aW9uIHJldmVydGVkICR7cmVhc29uID8gYHdpdGggcmVhc29uOiAke3JlYXNvbn1gIDogImZvciBhbiB1bmtub3duIHJlYXNvbiJ9LmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJFeGVjdXRpb25SZXZlcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDMKICAgICAgfSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGVjdXRpb25SZXZlcnRlZEVycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9leGVjdXRpb24gcmV2ZXJ0ZWQvCiAgICAgIH0pOwogICAgICBGZWVDYXBUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkgY2Fubm90IGJlIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGFsbG93ZWQgdmFsdWUgKDJeMjU2LTEpLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29IaWdoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWVDYXBUb29IaWdoRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiAyXF4yNTYtMXxmZWUgY2FwIGhpZ2hlciB0aGFuIDJcXjI1Ni0xLwogICAgICB9KTsKICAgICAgRmVlQ2FwVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfWAgOiAiIn0gZ3dlaSkgY2Fubm90IGJlIGxvd2VyIHRoYW4gdGhlIGJsb2NrIGJhc2UgZmVlLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29Mb3dFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlZUNhcFRvb0xvd0Vycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9tYXggZmVlIHBlciBnYXMgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfGZlZSBjYXAgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfHRyYW5zYWN0aW9uIGlzIG91dGRhdGVkLwogICAgICB9KTsKICAgICAgTm9uY2VUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG5vbmNlIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBoaWdoZXIgdGhhbiB0aGUgbmV4dCBvbmUgZXhwZWN0ZWQuYCwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vSGlnaEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb25jZVRvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgdG9vIGhpZ2gvCiAgICAgIH0pOwogICAgICBOb25jZVRvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBsb3dlciB0aGFuIHRoZSBjdXJyZW50IG5vbmNlIG9mIHRoZSBhY2NvdW50LmAsCiAgICAgICAgICAgICJUcnkgaW5jcmVhc2luZyB0aGUgbm9uY2Ugb3IgZmluZCB0aGUgbGF0ZXN0IG5vbmNlIHdpdGggYGdldFRyYW5zYWN0aW9uQ291bnRgLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vTG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlVG9vTG93RXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL25vbmNlIHRvbyBsb3d8dHJhbnNhY3Rpb24gYWxyZWFkeSBpbXBvcnRlZHxhbHJlYWR5IGtub3duLwogICAgICB9KTsKICAgICAgTm9uY2VNYXhWYWx1ZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBOb25jZSBwcm92aWRlZCBmb3IgdGhlIHRyYW5zYWN0aW9uICR7bm9uY2UgPyBgKCR7bm9uY2V9KSBgIDogIiJ9ZXhjZWVkcyB0aGUgbWF4aW11bSBhbGxvd2VkIG5vbmNlLmAsIHsgY2F1c2UsIG5hbWU6ICJOb25jZU1heFZhbHVlRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlTWF4VmFsdWVFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgaGFzIG1heCB2YWx1ZS8KICAgICAgfSk7CiAgICAgIEluc3VmZmljaWVudEZ1bmRzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJUaGUgdG90YWwgY29zdCAoZ2FzICogZ2FzIGZlZSArIHZhbHVlKSBvZiBleGVjdXRpbmcgdGhpcyB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBiYWxhbmNlIG9mIHRoZSBhY2NvdW50LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlRoaXMgZXJyb3IgY291bGQgYXJpc2Ugd2hlbiB0aGUgYWNjb3VudCBkb2VzIG5vdCBoYXZlIGVub3VnaCBmdW5kcyB0bzoiLAogICAgICAgICAgICAgICIgLSBwYXkgZm9yIHRoZSB0b3RhbCBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIHBheSBmb3IgdGhlIHZhbHVlIHRvIHNlbmQuIiwKICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgIlRoZSBjb3N0IG9mIHRoZSB0cmFuc2FjdGlvbiBpcyBjYWxjdWxhdGVkIGFzIGBnYXMgKiBnYXMgZmVlICsgdmFsdWVgLCB3aGVyZToiLAogICAgICAgICAgICAgICIgLSBgZ2FzYCBpcyB0aGUgYW1vdW50IG9mIGdhcyBuZWVkZWQgZm9yIHRyYW5zYWN0aW9uIHRvIGV4ZWN1dGUsIiwKICAgICAgICAgICAgICAiIC0gYGdhcyBmZWVgIGlzIHRoZSBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIGB2YWx1ZWAgaXMgdGhlIGFtb3VudCBvZiBldGhlciB0byBzZW5kIHRvIHRoZSByZWNpcGllbnQuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiSW5zdWZmaWNpZW50RnVuZHNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluc3VmZmljaWVudEZ1bmRzRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL2luc3VmZmljaWVudCBmdW5kc3xleGNlZWRzIHRyYW5zYWN0aW9uIHNlbmRlciBhY2NvdW50IGJhbGFuY2UvCiAgICAgIH0pOwogICAgICBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIGdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgYW1vdW50IG9mIGdhcyAke2dhcyA/IGAoJHtnYXN9KSBgIDogIiJ9cHJvdmlkZWQgZm9yIHRoZSB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBsaW1pdCBhbGxvd2VkIGZvciB0aGUgYmxvY2suYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIkludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gaGlnaHxnYXMgbGltaXQgcmVhY2hlZC8KICAgICAgfSk7CiAgICAgIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBnYXMgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihgVGhlIGFtb3VudCBvZiBnYXMgJHtnYXMgPyBgKCR7Z2FzfSkgYCA6ICIifXByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gaXMgdG9vIGxvdy5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiSW50cmluc2ljR2FzVG9vTG93RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRyaW5zaWNHYXNUb29Mb3dFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gbG93LwogICAgICB9KTsKICAgICAgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSB0cmFuc2FjdGlvbiB0eXBlIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgY2hhaW4uIiwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL3RyYW5zYWN0aW9uIHR5cGUgbm90IHZhbGlkLwogICAgICB9KTsKICAgICAgVGlwQWJvdmVGZWVDYXBFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFRoZSBwcm92aWRlZCB0aXAgKFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCR7bWF4UHJpb3JpdHlGZWVQZXJHYXMgPyBgID0gJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAgOiAiIn0pIGNhbm5vdCBiZSBoaWdoZXIgdGhhbiB0aGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVGlwQWJvdmVGZWVDYXBFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpcEFib3ZlRmVlQ2FwRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBwcmlvcml0eSBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiBtYXggZmVlIHBlciBnYXN8dGlwIGhpZ2hlciB0aGFuIGZlZSBjYXAvCiAgICAgIH0pOwogICAgICBVbmtub3duTm9kZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlIH0pIHsKICAgICAgICAgIHN1cGVyKGBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBleGVjdXRpbmc6ICR7Y2F1c2U/LnNob3J0TWVzc2FnZX1gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVW5rbm93bk5vZGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMKICBmdW5jdGlvbiBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKGVyci5kZXRhaWxzIHx8ICIiKS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIgPyBlcnIud2FsaygoZSkgPT4gZT8uY29kZSA9PT0gRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvci5jb2RlKSA6IGVycjsKICAgIGlmIChleGVjdXRpb25SZXZlcnRlZEVycm9yIGluc3RhbmNlb2YgQmFzZUVycm9yMikKICAgICAgcmV0dXJuIG5ldyBFeGVjdXRpb25SZXZlcnRlZEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1lc3NhZ2U6IGV4ZWN1dGlvblJldmVydGVkRXJyb3IuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChFeGVjdXRpb25SZXZlcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtZXNzYWdlOiBlcnIuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChGZWVDYXBUb29IaWdoRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoewogICAgICAgIGNhdXNlOiBlcnIsCiAgICAgICAgbWF4RmVlUGVyR2FzOiBhcmdzPy5tYXhGZWVQZXJHYXMKICAgICAgfSk7CiAgICBpZiAoRmVlQ2FwVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29Mb3dFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtYXhGZWVQZXJHYXM6IGFyZ3M/Lm1heEZlZVBlckdhcwogICAgICB9KTsKICAgIGlmIChOb25jZVRvb0hpZ2hFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBOb25jZVRvb0xvd0Vycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlTWF4VmFsdWVFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlTWF4VmFsdWVFcnJvcih7IGNhdXNlOiBlcnIsIG5vbmNlOiBhcmdzPy5ub25jZSB9KTsKICAgIGlmIChJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW5zdWZmaWNpZW50RnVuZHNFcnJvcih7IGNhdXNlOiBlcnIgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vSGlnaEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgZ2FzOiBhcmdzPy5nYXMgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcih7IGNhdXNlOiBlcnIsIGdhczogYXJncz8uZ2FzIH0pOwogICAgaWYgKFRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IoeyBjYXVzZTogZXJyIH0pOwogICAgaWYgKFRpcEFib3ZlRmVlQ2FwRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1heEZlZVBlckdhczogYXJncz8ubWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiBhcmdzPy5tYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9KTsKICAgIHJldHVybiBuZXcgVW5rbm93bk5vZGVFcnJvcih7CiAgICAgIGNhdXNlOiBlcnIKICAgIH0pOwogIH0KICB2YXIgaW5pdF9nZXROb2RlRXJyb3IgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2V4dHJhY3QuanMKICBmdW5jdGlvbiBleHRyYWN0KHZhbHVlXywgeyBmb3JtYXQgfSkgewogICAgaWYgKCFmb3JtYXQpCiAgICAgIHJldHVybiB7fTsKICAgIGNvbnN0IHZhbHVlID0ge307CiAgICBmdW5jdGlvbiBleHRyYWN0Xyhmb3JtYXR0ZWQyKSB7CiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmb3JtYXR0ZWQyKTsKICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgIGlmIChrZXkgaW4gdmFsdWVfKQogICAgICAgICAgdmFsdWVba2V5XSA9IHZhbHVlX1trZXldOwogICAgICAgIGlmIChmb3JtYXR0ZWQyW2tleV0gJiYgdHlwZW9mIGZvcm1hdHRlZDJba2V5XSA9PT0gIm9iamVjdCIgJiYgIUFycmF5LmlzQXJyYXkoZm9ybWF0dGVkMltrZXldKSkKICAgICAgICAgIGV4dHJhY3RfKGZvcm1hdHRlZDJba2V5XSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdCh2YWx1ZV8gfHwge30pOwogICAgZXh0cmFjdF8oZm9ybWF0dGVkKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgdmFyIGluaXRfZXh0cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9leHRyYWN0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvZm9ybWF0dGVyLmpzCiAgZnVuY3Rpb24gZGVmaW5lRm9ybWF0dGVyKHR5cGUsIGZvcm1hdCkgewogICAgcmV0dXJuICh7IGV4Y2x1ZGUsIGZvcm1hdDogb3ZlcnJpZGVzIH0pID0+IHsKICAgICAgcmV0dXJuIHsKICAgICAgICBleGNsdWRlLAogICAgICAgIGZvcm1hdDogKGFyZ3MpID0+IHsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdChhcmdzKTsKICAgICAgICAgIGlmIChleGNsdWRlKSB7CiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGV4Y2x1ZGUpIHsKICAgICAgICAgICAgICBkZWxldGUgZm9ybWF0dGVkW2tleV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLmZvcm1hdHRlZCwKICAgICAgICAgICAgLi4ub3ZlcnJpZGVzKGFyZ3MpCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgdHlwZQogICAgICB9OwogICAgfTsKICB9CiAgdmFyIGluaXRfZm9ybWF0dGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2Zvcm1hdHRlci5qcyIoKSB7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdChyZXF1ZXN0KSB7CiAgICBjb25zdCBycGNSZXF1ZXN0ID0ge307CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYXV0aG9yaXphdGlvbkxpc3QgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmF1dGhvcml6YXRpb25MaXN0ID0gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QocmVxdWVzdC5hdXRob3JpemF0aW9uTGlzdCk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYWNjZXNzTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QuYWNjZXNzTGlzdCA9IHJlcXVlc3QuYWNjZXNzTGlzdDsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmJsb2JzICE9PSAidW5kZWZpbmVkIikgewogICAgICBpZiAodHlwZW9mIHJlcXVlc3QuYmxvYnNbMF0gIT09ICJzdHJpbmciKQogICAgICAgIHJwY1JlcXVlc3QuYmxvYnMgPSByZXF1ZXN0LmJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4KSk7CiAgICAgIGVsc2UKICAgICAgICBycGNSZXF1ZXN0LmJsb2JzID0gcmVxdWVzdC5ibG9iczsKICAgIH0KICAgIGlmICh0eXBlb2YgcmVxdWVzdC5kYXRhICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5kYXRhID0gcmVxdWVzdC5kYXRhOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmZyb20gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmZyb20gPSByZXF1ZXN0LmZyb207CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5nYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lmdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lmdhc1ByaWNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5nYXNQcmljZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyA9IG51bWJlclRvSGV4KHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lm1heEZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID0gbnVtYmVyVG9IZXgocmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3Qubm9uY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm5vbmNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5ub25jZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudG8gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnRvID0gcmVxdWVzdC50bzsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC50eXBlICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC50eXBlID0gcnBjVHJhbnNhY3Rpb25UeXBlW3JlcXVlc3QudHlwZV07CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudmFsdWUgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnZhbHVlID0gbnVtYmVyVG9IZXgocmVxdWVzdC52YWx1ZSk7CiAgICByZXR1cm4gcnBjUmVxdWVzdDsKICB9CiAgZnVuY3Rpb24gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGFkZHJlc3M6IGF1dGhvcml6YXRpb24uY29udHJhY3RBZGRyZXNzLAogICAgICByOiBhdXRob3JpemF0aW9uLnIsCiAgICAgIHM6IGF1dGhvcml6YXRpb24ucywKICAgICAgY2hhaW5JZDogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IG51bWJlclRvSGV4KGF1dGhvcml6YXRpb24ubm9uY2UpLAogICAgICAuLi50eXBlb2YgYXV0aG9yaXphdGlvbi55UGFyaXR5ICE9PSAidW5kZWZpbmVkIiA/IHsgeVBhcml0eTogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi55UGFyaXR5KSB9IDoge30sCiAgICAgIC4uLnR5cGVvZiBhdXRob3JpemF0aW9uLnYgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiBhdXRob3JpemF0aW9uLnlQYXJpdHkgPT09ICJ1bmRlZmluZWQiID8geyB2OiBudW1iZXJUb0hleChhdXRob3JpemF0aW9uLnYpIH0gOiB7fQogICAgfSkpOwogIH0KICB2YXIgcnBjVHJhbnNhY3Rpb25UeXBlLCBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3Q7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9mb3JtYXR0ZXIoKTsKICAgICAgcnBjVHJhbnNhY3Rpb25UeXBlID0gewogICAgICAgIGxlZ2FjeTogIjB4MCIsCiAgICAgICAgZWlwMjkzMDogIjB4MSIsCiAgICAgICAgZWlwMTU1OTogIjB4MiIsCiAgICAgICAgZWlwNDg0NDogIjB4MyIsCiAgICAgICAgZWlwNzcwMjogIjB4NCIKICAgICAgfTsKICAgICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUZvcm1hdHRlcigidHJhbnNhY3Rpb25SZXF1ZXN0IiwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMKICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU1hcHBpbmcoc3RhdGVNYXBwaW5nKSB7CiAgICBpZiAoIXN0YXRlTWFwcGluZyB8fCBzdGF0ZU1hcHBpbmcubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgcmV0dXJuIHN0YXRlTWFwcGluZy5yZWR1Y2UoKGFjYywgeyBzbG90LCB2YWx1ZSB9KSA9PiB7CiAgICAgIGlmIChzbG90Lmxlbmd0aCAhPT0gNjYpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRCeXRlc0xlbmd0aEVycm9yKHsKICAgICAgICAgIHNpemU6IHNsb3QubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBpZiAodmFsdWUubGVuZ3RoICE9PSA2NikKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IoewogICAgICAgICAgc2l6ZTogdmFsdWUubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBhY2Nbc2xvdF0gPSB2YWx1ZTsKICAgICAgcmV0dXJuIGFjYzsKICAgIH0sIHt9KTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudFN0YXRlT3ZlcnJpZGUocGFyYW1ldGVycykgewogICAgY29uc3QgeyBiYWxhbmNlLCBub25jZSwgc3RhdGUsIHN0YXRlRGlmZiwgY29kZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlID0ge307CiAgICBpZiAoY29kZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5jb2RlID0gY29kZTsKICAgIGlmIChiYWxhbmNlICE9PSB2b2lkIDApCiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLmJhbGFuY2UgPSBudW1iZXJUb0hleChiYWxhbmNlKTsKICAgIGlmIChub25jZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5ub25jZSA9IG51bWJlclRvSGV4KG5vbmNlKTsKICAgIGlmIChzdGF0ZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5zdGF0ZSA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZSk7CiAgICBpZiAoc3RhdGVEaWZmICE9PSB2b2lkIDApIHsKICAgICAgaWYgKHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlKQogICAgICAgIHRocm93IG5ldyBTdGF0ZUFzc2lnbm1lbnRDb25mbGljdEVycm9yKCk7CiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlRGlmZiA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZURpZmYpOwogICAgfQogICAgcmV0dXJuIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHBhcmFtZXRlcnMpIHsKICAgIGlmICghcGFyYW1ldGVycykKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSB7fTsKICAgIGZvciAoY29uc3QgeyBhZGRyZXNzLCAuLi5hY2NvdW50U3RhdGUgfSBvZiBwYXJhbWV0ZXJzKSB7CiAgICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIGlmIChycGNTdGF0ZU92ZXJyaWRlW2FkZHJlc3NdKQogICAgICAgIHRocm93IG5ldyBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yKHsgYWRkcmVzcyB9KTsKICAgICAgcnBjU3RhdGVPdmVycmlkZVthZGRyZXNzXSA9IHNlcmlhbGl6ZUFjY291bnRTdGF0ZU92ZXJyaWRlKGFjY291bnRTdGF0ZSk7CiAgICB9CiAgICByZXR1cm4gcnBjU3RhdGVPdmVycmlkZTsKICB9CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZTIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2FkZHJlc3MoKTsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfc3RhdGVPdmVycmlkZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvbnVtYmVyLmpzCiAgdmFyIG1heEludDgsIG1heEludDE2LCBtYXhJbnQyNCwgbWF4SW50MzIsIG1heEludDQwLCBtYXhJbnQ0OCwgbWF4SW50NTYsIG1heEludDY0LCBtYXhJbnQ3MiwgbWF4SW50ODAsIG1heEludDg4LCBtYXhJbnQ5NiwgbWF4SW50MTA0LCBtYXhJbnQxMTIsIG1heEludDEyMCwgbWF4SW50MTI4LCBtYXhJbnQxMzYsIG1heEludDE0NCwgbWF4SW50MTUyLCBtYXhJbnQxNjAsIG1heEludDE2OCwgbWF4SW50MTc2LCBtYXhJbnQxODQsIG1heEludDE5MiwgbWF4SW50MjAwLCBtYXhJbnQyMDgsIG1heEludDIxNiwgbWF4SW50MjI0LCBtYXhJbnQyMzIsIG1heEludDI0MCwgbWF4SW50MjQ4LCBtYXhJbnQyNTYsIG1pbkludDgsIG1pbkludDE2LCBtaW5JbnQyNCwgbWluSW50MzIsIG1pbkludDQwLCBtaW5JbnQ0OCwgbWluSW50NTYsIG1pbkludDY0LCBtaW5JbnQ3MiwgbWluSW50ODAsIG1pbkludDg4LCBtaW5JbnQ5NiwgbWluSW50MTA0LCBtaW5JbnQxMTIsIG1pbkludDEyMCwgbWluSW50MTI4LCBtaW5JbnQxMzYsIG1pbkludDE0NCwgbWluSW50MTUyLCBtaW5JbnQxNjAsIG1pbkludDE2OCwgbWluSW50MTc2LCBtaW5JbnQxODQsIG1pbkludDE5MiwgbWluSW50MjAwLCBtaW5JbnQyMDgsIG1pbkludDIxNiwgbWluSW50MjI0LCBtaW5JbnQyMzIsIG1pbkludDI0MCwgbWluSW50MjQ4LCBtaW5JbnQyNTYsIG1heFVpbnQ4LCBtYXhVaW50MTYsIG1heFVpbnQyNCwgbWF4VWludDMyLCBtYXhVaW50NDAsIG1heFVpbnQ0OCwgbWF4VWludDU2LCBtYXhVaW50NjQsIG1heFVpbnQ3MiwgbWF4VWludDgwLCBtYXhVaW50ODgsIG1heFVpbnQ5NiwgbWF4VWludDEwNCwgbWF4VWludDExMiwgbWF4VWludDEyMCwgbWF4VWludDEyOCwgbWF4VWludDEzNiwgbWF4VWludDE0NCwgbWF4VWludDE1MiwgbWF4VWludDE2MCwgbWF4VWludDE2OCwgbWF4VWludDE3NiwgbWF4VWludDE4NCwgbWF4VWludDE5MiwgbWF4VWludDIwMCwgbWF4VWludDIwOCwgbWF4VWludDIxNiwgbWF4VWludDIyNCwgbWF4VWludDIzMiwgbWF4VWludDI0MCwgbWF4VWludDI0OCwgbWF4VWludDI1NjsKICB2YXIgaW5pdF9udW1iZXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9udW1iZXIuanMiKCkgewogICAgICBtYXhJbnQ4ID0gMm4gKiogKDhuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDE2ID0gMm4gKiogKDE2biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQyNCA9IDJuICoqICgyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MzIgPSAybiAqKiAoMzJuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDQwID0gMm4gKiogKDQwbiAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ0OCA9IDJuICoqICg0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50NTYgPSAybiAqKiAoNTZuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDY0ID0gMm4gKiogKDY0biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ3MiA9IDJuICoqICg3Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50ODAgPSAybiAqKiAoODBuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDg4ID0gMm4gKiogKDg4biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ5NiA9IDJuICoqICg5Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTA0ID0gMm4gKiogKDEwNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTEyID0gMm4gKiogKDExMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTIwID0gMm4gKiogKDEyMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTI4ID0gMm4gKiogKDEyOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTM2ID0gMm4gKiogKDEzNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTQ0ID0gMm4gKiogKDE0NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTUyID0gMm4gKiogKDE1Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTYwID0gMm4gKiogKDE2MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTY4ID0gMm4gKiogKDE2OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTc2ID0gMm4gKiogKDE3Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTg0ID0gMm4gKiogKDE4NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTkyID0gMm4gKiogKDE5Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjAwID0gMm4gKiogKDIwMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjA4ID0gMm4gKiogKDIwOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjE2ID0gMm4gKiogKDIxNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjI0ID0gMm4gKiogKDIyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjMyID0gMm4gKiogKDIzMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQwID0gMm4gKiogKDI0MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQ4ID0gMm4gKiogKDI0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjU2ID0gMm4gKiogKDI1Nm4gLSAxbikgLSAxbjsKICAgICAgbWluSW50OCA9IC0oMm4gKiogKDhuIC0gMW4pKTsKICAgICAgbWluSW50MTYgPSAtKDJuICoqICgxNm4gLSAxbikpOwogICAgICBtaW5JbnQyNCA9IC0oMm4gKiogKDI0biAtIDFuKSk7CiAgICAgIG1pbkludDMyID0gLSgybiAqKiAoMzJuIC0gMW4pKTsKICAgICAgbWluSW50NDAgPSAtKDJuICoqICg0MG4gLSAxbikpOwogICAgICBtaW5JbnQ0OCA9IC0oMm4gKiogKDQ4biAtIDFuKSk7CiAgICAgIG1pbkludDU2ID0gLSgybiAqKiAoNTZuIC0gMW4pKTsKICAgICAgbWluSW50NjQgPSAtKDJuICoqICg2NG4gLSAxbikpOwogICAgICBtaW5JbnQ3MiA9IC0oMm4gKiogKDcybiAtIDFuKSk7CiAgICAgIG1pbkludDgwID0gLSgybiAqKiAoODBuIC0gMW4pKTsKICAgICAgbWluSW50ODggPSAtKDJuICoqICg4OG4gLSAxbikpOwogICAgICBtaW5JbnQ5NiA9IC0oMm4gKiogKDk2biAtIDFuKSk7CiAgICAgIG1pbkludDEwNCA9IC0oMm4gKiogKDEwNG4gLSAxbikpOwogICAgICBtaW5JbnQxMTIgPSAtKDJuICoqICgxMTJuIC0gMW4pKTsKICAgICAgbWluSW50MTIwID0gLSgybiAqKiAoMTIwbiAtIDFuKSk7CiAgICAgIG1pbkludDEyOCA9IC0oMm4gKiogKDEyOG4gLSAxbikpOwogICAgICBtaW5JbnQxMzYgPSAtKDJuICoqICgxMzZuIC0gMW4pKTsKICAgICAgbWluSW50MTQ0ID0gLSgybiAqKiAoMTQ0biAtIDFuKSk7CiAgICAgIG1pbkludDE1MiA9IC0oMm4gKiogKDE1Mm4gLSAxbikpOwogICAgICBtaW5JbnQxNjAgPSAtKDJuICoqICgxNjBuIC0gMW4pKTsKICAgICAgbWluSW50MTY4ID0gLSgybiAqKiAoMTY4biAtIDFuKSk7CiAgICAgIG1pbkludDE3NiA9IC0oMm4gKiogKDE3Nm4gLSAxbikpOwogICAgICBtaW5JbnQxODQgPSAtKDJuICoqICgxODRuIC0gMW4pKTsKICAgICAgbWluSW50MTkyID0gLSgybiAqKiAoMTkybiAtIDFuKSk7CiAgICAgIG1pbkludDIwMCA9IC0oMm4gKiogKDIwMG4gLSAxbikpOwogICAgICBtaW5JbnQyMDggPSAtKDJuICoqICgyMDhuIC0gMW4pKTsKICAgICAgbWluSW50MjE2ID0gLSgybiAqKiAoMjE2biAtIDFuKSk7CiAgICAgIG1pbkludDIyNCA9IC0oMm4gKiogKDIyNG4gLSAxbikpOwogICAgICBtaW5JbnQyMzIgPSAtKDJuICoqICgyMzJuIC0gMW4pKTsKICAgICAgbWluSW50MjQwID0gLSgybiAqKiAoMjQwbiAtIDFuKSk7CiAgICAgIG1pbkludDI0OCA9IC0oMm4gKiogKDI0OG4gLSAxbikpOwogICAgICBtaW5JbnQyNTYgPSAtKDJuICoqICgyNTZuIC0gMW4pKTsKICAgICAgbWF4VWludDggPSAybiAqKiA4biAtIDFuOwogICAgICBtYXhVaW50MTYgPSAybiAqKiAxNm4gLSAxbjsKICAgICAgbWF4VWludDI0ID0gMm4gKiogMjRuIC0gMW47CiAgICAgIG1heFVpbnQzMiA9IDJuICoqIDMybiAtIDFuOwogICAgICBtYXhVaW50NDAgPSAybiAqKiA0MG4gLSAxbjsKICAgICAgbWF4VWludDQ4ID0gMm4gKiogNDhuIC0gMW47CiAgICAgIG1heFVpbnQ1NiA9IDJuICoqIDU2biAtIDFuOwogICAgICBtYXhVaW50NjQgPSAybiAqKiA2NG4gLSAxbjsKICAgICAgbWF4VWludDcyID0gMm4gKiogNzJuIC0gMW47CiAgICAgIG1heFVpbnQ4MCA9IDJuICoqIDgwbiAtIDFuOwogICAgICBtYXhVaW50ODggPSAybiAqKiA4OG4gLSAxbjsKICAgICAgbWF4VWludDk2ID0gMm4gKiogOTZuIC0gMW47CiAgICAgIG1heFVpbnQxMDQgPSAybiAqKiAxMDRuIC0gMW47CiAgICAgIG1heFVpbnQxMTIgPSAybiAqKiAxMTJuIC0gMW47CiAgICAgIG1heFVpbnQxMjAgPSAybiAqKiAxMjBuIC0gMW47CiAgICAgIG1heFVpbnQxMjggPSAybiAqKiAxMjhuIC0gMW47CiAgICAgIG1heFVpbnQxMzYgPSAybiAqKiAxMzZuIC0gMW47CiAgICAgIG1heFVpbnQxNDQgPSAybiAqKiAxNDRuIC0gMW47CiAgICAgIG1heFVpbnQxNTIgPSAybiAqKiAxNTJuIC0gMW47CiAgICAgIG1heFVpbnQxNjAgPSAybiAqKiAxNjBuIC0gMW47CiAgICAgIG1heFVpbnQxNjggPSAybiAqKiAxNjhuIC0gMW47CiAgICAgIG1heFVpbnQxNzYgPSAybiAqKiAxNzZuIC0gMW47CiAgICAgIG1heFVpbnQxODQgPSAybiAqKiAxODRuIC0gMW47CiAgICAgIG1heFVpbnQxOTIgPSAybiAqKiAxOTJuIC0gMW47CiAgICAgIG1heFVpbnQyMDAgPSAybiAqKiAyMDBuIC0gMW47CiAgICAgIG1heFVpbnQyMDggPSAybiAqKiAyMDhuIC0gMW47CiAgICAgIG1heFVpbnQyMTYgPSAybiAqKiAyMTZuIC0gMW47CiAgICAgIG1heFVpbnQyMjQgPSAybiAqKiAyMjRuIC0gMW47CiAgICAgIG1heFVpbnQyMzIgPSAybiAqKiAyMzJuIC0gMW47CiAgICAgIG1heFVpbnQyNDAgPSAybiAqKiAyNDBuIC0gMW47CiAgICAgIG1heFVpbnQyNDggPSAybiAqKiAyNDhuIC0gMW47CiAgICAgIG1heFVpbnQyNTYgPSAybiAqKiAyNTZuIC0gMW47CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRSZXF1ZXN0LmpzCiAgZnVuY3Rpb24gYXNzZXJ0UmVxdWVzdChhcmdzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgdG8gfSA9IGFyZ3M7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgaWYgKGFjY291bnQgJiYgIWlzQWRkcmVzcyhhY2NvdW50LmFkZHJlc3MpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcyB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmICh0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmICh0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKSkKICAgICAgdGhyb3cgbmV3IEZlZUNvbmZsaWN0RXJyb3IoKTsKICAgIGlmIChtYXhGZWVQZXJHYXMgJiYgbWF4RmVlUGVyR2FzID4gbWF4VWludDI1NikKICAgICAgdGhyb3cgbmV3IEZlZUNhcFRvb0hpZ2hFcnJvcih7IG1heEZlZVBlckdhcyB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPiBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcyB9KTsKICB9CiAgdmFyIGluaXRfYXNzZXJ0UmVxdWVzdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vYXNzZXJ0UmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfcGFyc2VBY2NvdW50KCk7CiAgICAgIGluaXRfbnVtYmVyKCk7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X25vZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9pc0FkZHJlc3NFcXVhbC5qcwogIGZ1bmN0aW9uIGlzQWRkcmVzc0VxdWFsKGEsIGIpIHsKICAgIGlmICghaXNBZGRyZXNzKGEsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBhIH0pOwogICAgaWYgKCFpc0FkZHJlc3MoYiwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGIgfSk7CiAgICByZXR1cm4gYS50b0xvd2VyQ2FzZSgpID09PSBiLnRvTG93ZXJDYXNlKCk7CiAgfQogIHZhciBpbml0X2lzQWRkcmVzc0VxdWFsID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2lzQWRkcmVzc0VxdWFsLmpzIigpIHsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZGVjb2RlRnVuY3Rpb25SZXN1bHQuanMKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNCB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgaWYgKCFhYmlJdGVtLm91dHB1dHMpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yKGFiaUl0ZW0ubmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgY29uc3QgdmFsdWVzID0gZGVjb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLm91dHB1dHMsIGRhdGEpOwogICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMSkKICAgICAgcmV0dXJuIHZhbHVlczsKICAgIGlmICh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMSkKICAgICAgcmV0dXJuIHZhbHVlc1swXTsKICAgIHJldHVybiB2b2lkIDA7CiAgfQogIHZhciBkb2NzUGF0aDQ7CiAgdmFyIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvblJlc3VsdC5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2dldEFiaUl0ZW0oKTsKICAgICAgZG9jc1BhdGg0ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZUZ1bmN0aW9uUmVzdWx0IjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9hYmlzLmpzCiAgdmFyIG11bHRpY2FsbDNBYmksIHVuaXZlcnNhbFJlc29sdmVyRXJyb3JzLCB1bml2ZXJzYWxSZXNvbHZlclJlc29sdmVBYmksIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSwgdGV4dFJlc29sdmVyQWJpLCBhZGRyZXNzUmVzb2x2ZXJBYmksIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwgZXJjMjBBYmksIGVyYzIwQWJpX2J5dGVzMzIsIGVyYzcyMUFiaSwgZXJjNDYyNkFiaTsKICB2YXIgaW5pdF9hYmlzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWJpcy5qcyIoKSB7CiAgICAgIG11bHRpY2FsbDNBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJ0YXJnZXQiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJhbGxvd0ZhaWx1cmUiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJjYWxsRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJjYWxscyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiYWdncmVnYXRlMyIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJyZXR1cm5EYXRhIiwKICAgICAgICAgICAgICB0eXBlOiAidHVwbGVbXSIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJFcnJvcnMgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG5hbWU6ICJSZXNvbHZlck5vdEZvdW5kIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBuYW1lOiAiUmVzb2x2ZXJXaWxkY2FyZE5vdFN1cHBvcnRlZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyTm90Q29udHJhY3QiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyRXJyb3IiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdGF0dXMiLAogICAgICAgICAgICAgICAgICB0eXBlOiAidWludDE2IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbmFtZTogIm1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgbmFtZTogImVycm9ycyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiSHR0cEVycm9yIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmVzb2x2ZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlcyIgfSwKICAgICAgICAgICAgeyBuYW1lOiAiZGF0YSIsIHR5cGU6ICJieXRlcyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJyZXNvbHZlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7IG5hbWU6ICJuYW1lIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJkYXRhIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJnYXRld2F5cyIsIHR5cGU6ICJzdHJpbmdbXSIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmV2ZXJzZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJyZXZlcnNlTmFtZSIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJyZXNvbHZlZE5hbWUiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmVzb2x2ZWRBZGRyZXNzIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJldmVyc2VSZXNvbHZlciIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlciIgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogInJldmVyc2UiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogImJ5dGVzIiwgbmFtZTogInJldmVyc2VOYW1lIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJzdHJpbmdbXSIsIG5hbWU6ICJnYXRld2F5cyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInJlc29sdmVkTmFtZSIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlZEFkZHJlc3MiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmV2ZXJzZVJlc29sdmVyIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJlc29sdmVyIiB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICB0ZXh0UmVzb2x2ZXJBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInRleHQiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICAgICAgeyBuYW1lOiAia2V5IiwgdHlwZTogInN0cmluZyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgIH0KICAgICAgXTsKICAgICAgYWRkcmVzc1Jlc29sdmVyQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJhZGRyIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbeyBuYW1lOiAiIiwgdHlwZTogImFkZHJlc3MiIH1dCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiYWRkciIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJjb2luVHlwZSIsIHR5cGU6ICJ1aW50MjU2IiB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJieXRlcyIgfV0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiaXNWYWxpZFNpZyIKICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzIwQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic3ltYm9sIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXIiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICBlcmMyMEFiaV9ieXRlczMyID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJieXRlczMyIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYnl0ZXMzMiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0b3RhbFN1cHBseSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmVjaXBpZW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhbW91bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzcyMUFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZXZlbnQiLAogICAgICAgICAgbmFtZTogIkFwcHJvdmFsIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImV2ZW50IiwKICAgICAgICAgIG5hbWU6ICJBcHByb3ZhbEZvckFsbCIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm9wZXJhdG9yIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhcHByb3ZlZCIsCiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRva2VuSWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImFwcHJvdmUiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiZ2V0QXBwcm92ZWQiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImlzQXBwcm92ZWRGb3JBbGwiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAibmFtZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogIm93bmVyT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic2FmZVRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJwYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImZyb20iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNhZmVUcmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiaWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImRhdGEiLAogICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNldEFwcHJvdmFsRm9yQWxsIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFwcHJvdmVkIiwKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImluZGV4IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJpbmRleCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG9rZW5JZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG9rZW5VUkkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRva2VJZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbXQogICAgICAgIH0KICAgICAgXTsKICAgICAgZXJjNDYyNkFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiRGVwb3NpdCIsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiV2l0aGRyYXciLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImFsbG93YW5jZSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJhcHByb3ZlIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogImFzc2V0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldFRva2VuQWRkcmVzcyIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJjb252ZXJ0VG9Bc3NldHMiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiY29udmVydFRvU2hhcmVzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJkZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJjYWxsZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heERlcG9zaXQiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm1heEFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImNhbGxlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAibWF4TWludCIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFJlZGVlbSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFdpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJtYXhBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJtaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdEZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdNaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdSZWRlZW0iLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicHJldmlld1dpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicmVkZWVtIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsQXNzZXRzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b3RhbE1hbmFnZWRBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsU3VwcGx5IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiZnJvbSIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG8iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAid2l0aGRyYXciLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9CiAgICAgIF07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3QuanMKICB2YXIgYWdncmVnYXRlM1NpZ25hdHVyZTsKICB2YXIgaW5pdF9jb250cmFjdDIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9jb250cmFjdC5qcyIoKSB7CiAgICAgIGFnZ3JlZ2F0ZTNTaWduYXR1cmUgPSAiMHg4MmFkNTZjYiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3RzLmpzCiAgdmFyIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwgZGVwbG95bGVzc0NhbGxWaWFGYWN0b3J5Qnl0ZWNvZGUsIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckJ5dGVDb2RlOwogIHZhciBpbml0X2NvbnRyYWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2NvbnRyYWN0cy5qcyIoKSB7CiAgICAgIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDE4ZTM4MDM4MDYxMDE4ZTgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMTI0NTY1YjYwMDA4MDgzNTE2MDIwODUwMTYwMDBmNTkwNTA4MDNiNjEwMDQ4NTc2MDAwODBmZDViNjAwMDgwODM1MTYwMjA4NTAxNjAwMDg1NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDA2NzU3M2Q4MWZkNWIzZDgxZjM1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDgyNjAxZjgzMDExMjYxMDA5MjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMGFiNTc2MTAwYWI2MTAwNmI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTAwZDk1NzYxMDBkOTYxMDA2YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTAwZjE1NzYwMDA4MGZkNWI2MDAwNWI4MjgxMTAxNTYxMDExMDU3NjAyMDgxODYwMTgxMDE1MTgzODMwMTgyMDE1MjAxNjEwMGY0NTY1YjUwNjAwMDkxODEwMTYwMjAwMTkxOTA5MTUyOTM5MjUwNTA1MDU2NWI2MDAwODA2MDQwODM4NTAzMTIxNTYxMDEzNzU3NjAwMDgwZmQ1YjgyNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTRkNTc2MDAwODBmZDViNjEwMTU5ODU4Mjg2MDE2MTAwODE1NjViNjAyMDg1MDE1MTkwOTM1MDkwNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTc3NTc2MDAwODBmZDViNjEwMTgzODU4Mjg2MDE2MTAwODE1NjViOTE1MDUwOTI1MDkyOTA1MDU2ZmUiOwogICAgICBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDJjMDM4MDM4MDYxMDJjMDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMWU2NTY1YjgzNjAwMTYwMDE2MGEwMWIwMzE2M2I2MDAwMDM2MTAwZTQ1NzYwMDA4MDgzNjAwMTYwMDE2MGEwMWIwMzE2ODM2MDQwNTE2MTAwNWM5MTkwNjEwMjcwNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwOTk1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwOWU1NjViNjA2MDkxNTA1YjUwOTE1MDkxNTA4MTE1ODA2MTAwYjg1NzUwNjAwMTYwMDE2MGEwMWIwMzg2MTYzYjE1NWIxNTYxMDBlMTU3ODA2MDQwNTE2MzEwMWJiOThkNjBlMDFiODE1MjYwMDQwMTYxMDBkODkxOTA2MTAyOGM1NjViNjA0MDUxODA5MTAzOTBmZDViNTA1MDViNjAwMDgwODQ1MTYwMjA4NjAxNjAwMDg4NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDEwMzU3M2Q4MWZkNWIzZDgxZjM1YjgwNTE2MDAxNjAwMTYwYTAxYjAzODExNjgxMTQ2MTAxMWU1NzYwMDA4MGZkNWI5MTkwNTA1NjViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwNDE2MDA0NTI2MDI0NjAwMGZkNWI2MDAwNWI4MzgxMTAxNTYxMDE1NDU3ODE4MTAxNTE4MzgyMDE1MjYwMjAwMTYxMDEzYzU2NWI1MDUwNjAwMDkxMDE1MjU2NWI2MDAwODI2MDFmODMwMTEyNjEwMTZlNTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTAxODc1NzYxMDE4NzYxMDEyMzU2NWI2MDQwNTE2MDFmODIwMTYwMWYxOTkwODExNjYwM2YwMTE2ODEwMTYwMDE2MDAxNjA0MDFiMDM4MTExODI4MjEwMTcxNTYxMDFiNTU3NjEwMWI1NjEwMTIzNTY1YjYwNDA1MjgxODE1MjgzODIwMTYwMjAwMTg1MTAxNTYxMDFjZDU3NjAwMDgwZmQ1YjYxMDFkZTgyNjAyMDgzMDE2MDIwODcwMTYxMDEzOTU2NWI5NDkzNTA1MDUwNTA1NjViNjAwMDgwNjAwMDgwNjA4MDg1ODcwMzEyMTU2MTAxZmM1NzYwMDA4MGZkNWI2MTAyMDU4NTYxMDEwNzU2NWI2MDIwODYwMTUxOTA5NDUwNjAwMTYwMDE2MDQwMWIwMzgxMTExNTYxMDIyMTU3NjAwMDgwZmQ1YjYxMDIyZDg3ODI4ODAxNjEwMTVkNTY1YjkzNTA1MDYxMDIzYzYwNDA4NjAxNjEwMTA3NTY1YjYwNjA4NjAxNTE5MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMjU4NTc2MDAwODBmZDViNjEwMjY0ODc4Mjg4MDE2MTAxNWQ1NjViOTE1MDUwOTI5NTkxOTQ1MDkyNTA1NjViNjAwMDgyNTE2MTAyODI4MTg0NjAyMDg3MDE2MTAxMzk1NjViOTE5MDkxMDE5MjkxNTA1MDU2NWI2MDIwODE1MjYwMDA4MjUxODA2MDIwODQwMTUyNjEwMmFiODE2MDQwODUwMTYwMjA4NzAxNjEwMTM5NTY1YjYwMWYwMTYwMWYxOTE2OTE5MDkxMDE2MDQwMDE5MjkxNTA1MDU2ZmUiOwogICAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDY5NDM4MDM4MDYxMDY5NDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwNTFlNTY1YjYwMDA2MTAwM2M4NDg0ODQ2MTAwNDg1NjViOTA1MDgwNjAwMDUyNjAwMTYwMWZmMzViNjAwMDdmNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjYxMDA3NDgzNjEwNDBjNTY1YjAzNjEwMWU3NTc2MDAwNjA2MDgwODQ4MDYwMjAwMTkwNTE4MTAxOTA2MTAwOTI5MTkwNjEwNTc3NTY1YjYwNDA1MTkyOTU1MDkwOTM1MDkxNTA2MDAwOTA2MDAxNjAwMTYwYTAxYjAzODUxNjkwNjEwMGI2OTA4NTkwNjEwNWRkNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwZjM1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwZjg1NjViNjA2MDkxNTA1YjUwNTA5MDUwODc2MDAxNjAwMTYwYTAxYjAzMTYzYjYwMDAwMzYxMDE2MDU3ODA2MTAxNjA1NzYwNDA1MTYyNDYxYmNkNjBlNTFiODE1MjYwMjA2MDA0ODIwMTUyNjAxZTYwMjQ4MjAxNTI3ZjUzNjk2NzZlNjE3NDc1NzI2NTU2NjE2YzY5NjQ2MTc0NmY3MjNhMjA2NDY1NzA2YzZmNzk2ZDY1NmU3NDAwMDA2MDQ0ODIwMTUyNjA2NDAxNWI2MDQwNTE4MDkxMDM5MGZkNWI2MDQwNTE2MzBiMTM1ZDNmNjBlMTFiODA4MjUyOTA2MDAxNjAwMTYwYTAxYjAzOGExNjkwNjMxNjI2YmE3ZTkwNjEwMTkwOTA4YjkwODc5MDYwMDQwMTYxMDVmOTU2NWI2MDIwNjA0MDUxODA4MzAzODE4NjVhZmExNTgwMTU2MTAxYWQ1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNTA2MDQwNTEzZDYwMWYxOTYwMWY4MjAxMTY4MjAxODA2MDQwNTI1MDgxMDE5MDYxMDFkMTkxOTA2MTA2MzM1NjViNjAwMTYwMDE2MGUwMWIwMzE5MTYxNDk0NTA1MDUwNTA1MDYxMDQwNTU2NWI2MDAxNjAwMTYwYTAxYjAzODQxNjNiMTU2MTAyN2E1NzYwNDA1MTYzMGIxMzVkM2Y2MGUxMWI4MDgyNTI5MDYwMDE2MDAxNjBhMDFiMDM4NjE2OTA2MzE2MjZiYTdlOTA2MTAyMjc5MDg3OTA4NzkwNjAwNDAxNjEwNWY5NTY1YjYwMjA2MDQwNTE4MDgzMDM4MTg2NWFmYTE1ODAxNTYxMDI0NDU3M2Q2MDAwODAzZTNkNjAwMGZkNWI1MDUwNTA1MDYwNDA1MTNkNjAxZjE5NjAxZjgyMDExNjgyMDE4MDYwNDA1MjUwODEwMTkwNjEwMjY4OTE5MDYxMDYzMzU2NWI2MDAxNjAwMTYwZTAxYjAzMTkxNjE0OTA1MDYxMDQwNTU2NWI4MTUxNjA0MTE0NjEwMmRmNTc2MDQwNTE2MjQ2MWJjZDYwZTUxYjgxNTI2MDIwNjAwNDgyMDE1MjYwM2E2MDI0ODIwMTUyNjAwMDgwNTE2MDIwNjEwNjc0ODMzOTgxNTE5MTUyNjA0NDgyMDE1MjdmM2EyMDY5NmU3NjYxNmM2OTY0MjA3MzY5Njc2ZTYxNzQ3NTcyNjUyMDZjNjU2ZTY3NzQ2ODAwMDAwMDAwMDAwMDYwNjQ4MjAxNTI2MDg0MDE2MTAxNTc1NjViNjEwMmU3NjEwNDI1NTY1YjUwNjAyMDgyMDE1MTYwNDA4MDg0MDE1MTg0NTE4NTkzOTI2MDAwOTE4NTkxOTA4MTEwNjEwMzBjNTc2MTAzMGM2MTA2NWQ1NjViMDE2MDIwMDE1MTYwZjgxYzkwNTA2MDFiODExNDgwMTU5MDYxMDMyYjU3NTA4MDYwZmYxNjYwMWMxNDE1NWIxNTYxMDM4YzU3NjA0MDUxNjI0NjFiY2Q2MGU1MWI4MTUyNjAyMDYwMDQ4MjAxNTI2MDNiNjAyNDgyMDE1MjYwMDA4MDUxNjAyMDYxMDY3NDgzMzk4MTUxOTE1MjYwNDQ4MjAxNTI3ZjNhMjA2OTZlNzY2MTZjNjk2NDIwNzM2OTY3NmU2MTc0NzU3MjY1MjA3NjIwNzY2MTZjNzU2NTAwMDAwMDAwMDA2MDY0ODIwMTUyNjA4NDAxNjEwMTU3NTY1YjYwNDA4MDUxNjAwMDgxNTI2MDIwODEwMTgwODM1Mjg5OTA1MjYwZmY4MzE2OTE4MTAxOTE5MDkxNTI2MDYwODEwMTg0OTA1MjYwODA4MTAxODM5MDUyNjAwMTYwMDE2MGEwMWIwMzg5MTY5MDYwMDE5MDYwYTAwMTYwMjA2MDQwNTE2MDIwODEwMzkwODA4NDAzOTA4NTVhZmExNTgwMTU2MTAzZWE1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNjAyMDYwNDA1MTAzNTE2MDAxNjAwMTYwYTAxYjAzMTYxNDk0NTA1MDUwNTA1MDViOTM5MjUwNTA1MDU2NWI2MDAwNjAyMDgyNTExMDE1NjEwNDFkNTc2MDAwODBmZDViNTA4MDUxMDE1MTkwNTY1YjYwNDA1MTgwNjA2MDAxNjA0MDUyODA2MDAzOTA2MDIwODIwMjgwMzY4MzM3NTA5MTkyOTE1MDUwNTY1YjYwMDE2MDAxNjBhMDFiMDM4MTE2ODExNDYxMDQ1ODU3NjAwMDgwZmQ1YjUwNTY1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDViODM4MTEwMTU2MTA0OGM1NzgxODEwMTUxODM4MjAxNTI2MDIwMDE2MTA0NzQ1NjViNTA1MDYwMDA5MTAxNTI1NjViNjAwMDgyNjAxZjgzMDExMjYxMDRhNjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNGJmNTc2MTA0YmY2MTA0NWI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTA0ZWQ1NzYxMDRlZDYxMDQ1YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTA1MDU1NzYwMDA4MGZkNWI2MTA1MTY4MjYwMjA4MzAxNjAyMDg3MDE2MTA0NzE1NjViOTQ5MzUwNTA1MDUwNTY1YjYwMDA4MDYwMDA2MDYwODQ4NjAzMTIxNTYxMDUzMzU3NjAwMDgwZmQ1YjgzNTE2MTA1M2U4MTYxMDQ0MzU2NWI2MDIwODUwMTUxNjA0MDg2MDE1MTkxOTQ1MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNTYxNTc2MDAwODBmZDViNjEwNTZkODY4Mjg3MDE2MTA0OTU1NjViOTE1MDUwOTI1MDkyNTA5MjU2NWI2MDAwODA2MDAwNjA2MDg0ODYwMzEyMTU2MTA1OGM1NzYwMDA4MGZkNWI4MzUxNjEwNTk3ODE2MTA0NDM1NjViNjAyMDg1MDE1MTkwOTM1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1YjM1NzYwMDA4MGZkNWI2MTA1YmY4NjgyODcwMTYxMDQ5NTU2NWI2MDQwODYwMTUxOTA5MzUwOTA1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1NjE1NzYwMDA4MGZkNWI2MDAwODI1MTYxMDVlZjgxODQ2MDIwODcwMTYxMDQ3MTU2NWI5MTkwOTEwMTkyOTE1MDUwNTY1YjgyODE1MjYwNDA2MDIwODIwMTUyNjAwMDgyNTE4MDYwNDA4NDAxNTI2MTA2MWU4MTYwNjA4NTAxNjAyMDg3MDE2MTA0NzE1NjViNjAxZjAxNjAxZjE5MTY5MTkwOTEwMTYwNjAwMTkzOTI1MDUwNTA1NjViNjAwMDYwMjA4Mjg0MDMxMjE1NjEwNjQ1NTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjBlMDFiMDMxOTgxMTY4MTE0NjEwNDA1NTc2MDAwODBmZDViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwMzI2MDA0NTI2MDI0NjAwMGZkZmU1MzY5Njc2ZTYxNzQ3NTcyNjU1NjYxNmM2OTY0NjE3NDZmNzIyMzcyNjU2MzZmNzY2NTcyNTM2OTY3NmU2NTcyIjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jaGFpbi5qcwogIHZhciBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QsIENoYWluTWlzbWF0Y2hFcnJvciwgQ2hhaW5Ob3RGb3VuZEVycm9yLCBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvciwgSW52YWxpZENoYWluSWRFcnJvcjsKICB2YXIgaW5pdF9jaGFpbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NoYWluLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja051bWJlciwgY2hhaW4sIGNvbnRyYWN0IH0pIHsKICAgICAgICAgIHN1cGVyKGBDaGFpbiAiJHtjaGFpbi5uYW1lfSIgZG9lcyBub3Qgc3VwcG9ydCBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIuYCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiVGhpcyBjb3VsZCBiZSBkdWUgdG8gYW55IG9mIHRoZSBmb2xsb3dpbmc6IiwKICAgICAgICAgICAgICAuLi5ibG9ja051bWJlciAmJiBjb250cmFjdC5ibG9ja0NyZWF0ZWQgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkID4gYmxvY2tOdW1iZXIgPyBbCiAgICAgICAgICAgICAgICBgLSBUaGUgY29udHJhY3QgIiR7Y29udHJhY3QubmFtZX0iIHdhcyBub3QgZGVwbG95ZWQgdW50aWwgYmxvY2sgJHtjb250cmFjdC5ibG9ja0NyZWF0ZWR9IChjdXJyZW50IGJsb2NrICR7YmxvY2tOdW1iZXJ9KS5gCiAgICAgICAgICAgICAgXSA6IFsKICAgICAgICAgICAgICAgIGAtIFRoZSBjaGFpbiBkb2VzIG5vdCBoYXZlIHRoZSBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIgY29uZmlndXJlZC5gCiAgICAgICAgICAgICAgXQogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0IgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBDaGFpbk1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2hhaW4sIGN1cnJlbnRDaGFpbklkIH0pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgY3VycmVudCBjaGFpbiBvZiB0aGUgd2FsbGV0IChpZDogJHtjdXJyZW50Q2hhaW5JZH0pIGRvZXMgbm90IG1hdGNoIHRoZSB0YXJnZXQgY2hhaW4gZm9yIHRoZSB0cmFuc2FjdGlvbiAoaWQ6ICR7Y2hhaW4uaWR9IFx1MjAxMyAke2NoYWluLm5hbWV9KS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBDdXJyZW50IENoYWluIElEOiAgJHtjdXJyZW50Q2hhaW5JZH1gLAogICAgICAgICAgICAgIGBFeHBlY3RlZCBDaGFpbiBJRDogJHtjaGFpbi5pZH0gXHUyMDEzICR7Y2hhaW4ubmFtZX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDaGFpbk1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIENoYWluTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJObyBjaGFpbiB3YXMgcHJvdmlkZWQgdG8gdGhlIHJlcXVlc3QuIiwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgY2hhaW4gd2l0aCB0aGUgYGNoYWluYCBhcmd1bWVudCBvbiB0aGUgQWN0aW9uLCBvciBieSBzdXBwbHlpbmcgYSBgY2hhaW5gIHRvIFdhbGxldENsaWVudC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkNoYWluTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoIk5vIGNoYWluIHdhcyBwcm92aWRlZCB0byB0aGUgQ2xpZW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIkNsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQ2hhaW5JZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNoYWluSWQgfSkgewogICAgICAgICAgc3VwZXIodHlwZW9mIGNoYWluSWQgPT09ICJudW1iZXIiID8gYENoYWluIElEICIke2NoYWluSWR9IiBpcyBpbnZhbGlkLmAgOiAiQ2hhaW4gSUQgaXMgaW52YWxpZC4iLCB7IG5hbWU6ICJJbnZhbGlkQ2hhaW5JZEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRGVwbG95RGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gYnl0ZWNvZGU7CiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGFiaTIuZmluZCgoeCkgPT4gInR5cGUiIGluIHggJiYgeC50eXBlID09PSAiY29uc3RydWN0b3IiKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3Rvck5vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgaWYgKCEoImlucHV0cyIgaW4gZGVzY3JpcHRpb24pKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoNSB9KTsKICAgIGlmICghZGVzY3JpcHRpb24uaW5wdXRzIHx8IGRlc2NyaXB0aW9uLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgY29uc3QgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoZGVzY3JpcHRpb24uaW5wdXRzLCBhcmdzKTsKICAgIHJldHVybiBjb25jYXRIZXgoW2J5dGVjb2RlLCBkYXRhXSk7CiAgfQogIHZhciBkb2NzUGF0aDU7CiAgdmFyIGluaXRfZW5jb2RlRGVwbG95RGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZURlcGxveURhdGEuanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgZG9jc1BhdGg1ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZURlcGxveURhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMKICBmdW5jdGlvbiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7IGJsb2NrTnVtYmVyLCBjaGFpbiwgY29udHJhY3Q6IG5hbWUgfSkgewogICAgY29uc3QgY29udHJhY3QgPSBjaGFpbj8uY29udHJhY3RzPy5bbmFtZV07CiAgICBpZiAoIWNvbnRyYWN0KQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogeyBuYW1lIH0KICAgICAgfSk7CiAgICBpZiAoYmxvY2tOdW1iZXIgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkICYmIGNvbnRyYWN0LmJsb2NrQ3JlYXRlZCA+IGJsb2NrTnVtYmVyKQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogY29udHJhY3QuYmxvY2tDcmVhdGVkCiAgICAgICAgfQogICAgICB9KTsKICAgIHJldHVybiBjb250cmFjdC5hZGRyZXNzOwogIH0KICB2YXIgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMiKCkgewogICAgICBpbml0X2NoYWluKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q2FsbEVycm9yLmpzCiAgZnVuY3Rpb24gZ2V0Q2FsbEVycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBDYWxsRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQogIHZhciBpbml0X2dldENhbGxFcnJvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZXJyb3JzL2dldENhbGxFcnJvci5qcyIoKSB7CiAgICAgIGluaXRfY29udHJhY3QoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICAgIGluaXRfZ2V0Tm9kZUVycm9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMKICBmdW5jdGlvbiB3aXRoUmVzb2x2ZXJzKCkgewogICAgbGV0IHJlc29sdmUgPSAoKSA9PiB2b2lkIDA7CiAgICBsZXQgcmVqZWN0ID0gKCkgPT4gdm9pZCAwOwogICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlXywgcmVqZWN0XykgPT4gewogICAgICByZXNvbHZlID0gcmVzb2x2ZV87CiAgICAgIHJlamVjdCA9IHJlamVjdF87CiAgICB9KTsKICAgIHJldHVybiB7IHByb21pc2UsIHJlc29sdmUsIHJlamVjdCB9OwogIH0KICB2YXIgaW5pdF93aXRoUmVzb2x2ZXJzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS9jcmVhdGVCYXRjaFNjaGVkdWxlci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUJhdGNoU2NoZWR1bGVyKHsgZm4sIGlkLCBzaG91bGRTcGxpdEJhdGNoLCB3YWl0OiB3YWl0MiA9IDAsIHNvcnQgfSkgewogICAgY29uc3QgZXhlYyA9IGFzeW5jICgpID0+IHsKICAgICAgY29uc3Qgc2NoZWR1bGVyID0gZ2V0U2NoZWR1bGVyKCk7CiAgICAgIGZsdXNoKCk7CiAgICAgIGNvbnN0IGFyZ3MgPSBzY2hlZHVsZXIubWFwKCh7IGFyZ3M6IGFyZ3MyIH0pID0+IGFyZ3MyKTsKICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKQogICAgICAgIHJldHVybjsKICAgICAgZm4oYXJncykudGhlbigoZGF0YSkgPT4gewogICAgICAgIGlmIChzb3J0ICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpCiAgICAgICAgICBkYXRhLnNvcnQoc29ydCk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVzb2x2ZSB9ID0gc2NoZWR1bGVyW2ldOwogICAgICAgICAgcmVzb2x2ZT8uKFtkYXRhW2ldLCBkYXRhXSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVqZWN0IH0gPSBzY2hlZHVsZXJbaV07CiAgICAgICAgICByZWplY3Q/LihlcnIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgZmx1c2ggPSAoKSA9PiBzY2hlZHVsZXJDYWNoZS5kZWxldGUoaWQpOwogICAgY29uc3QgZ2V0QmF0Y2hlZEFyZ3MgPSAoKSA9PiBnZXRTY2hlZHVsZXIoKS5tYXAoKHsgYXJncyB9KSA9PiBhcmdzKTsKICAgIGNvbnN0IGdldFNjaGVkdWxlciA9ICgpID0+IHNjaGVkdWxlckNhY2hlLmdldChpZCkgfHwgW107CiAgICBjb25zdCBzZXRTY2hlZHVsZXIgPSAoaXRlbSkgPT4gc2NoZWR1bGVyQ2FjaGUuc2V0KGlkLCBbLi4uZ2V0U2NoZWR1bGVyKCksIGl0ZW1dKTsKICAgIHJldHVybiB7CiAgICAgIGZsdXNoLAogICAgICBhc3luYyBzY2hlZHVsZShhcmdzKSB7CiAgICAgICAgY29uc3QgeyBwcm9taXNlLCByZXNvbHZlLCByZWplY3QgfSA9IHdpdGhSZXNvbHZlcnMoKTsKICAgICAgICBjb25zdCBzcGxpdDIgPSBzaG91bGRTcGxpdEJhdGNoPy4oWy4uLmdldEJhdGNoZWRBcmdzKCksIGFyZ3NdKTsKICAgICAgICBpZiAoc3BsaXQyKQogICAgICAgICAgZXhlYygpOwogICAgICAgIGNvbnN0IGhhc0FjdGl2ZVNjaGVkdWxlciA9IGdldFNjaGVkdWxlcigpLmxlbmd0aCA+IDA7CiAgICAgICAgaWYgKGhhc0FjdGl2ZVNjaGVkdWxlcikgewogICAgICAgICAgc2V0U2NoZWR1bGVyKHsgYXJncywgcmVzb2x2ZSwgcmVqZWN0IH0pOwogICAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgICAgfQogICAgICAgIHNldFNjaGVkdWxlcih7IGFyZ3MsIHJlc29sdmUsIHJlamVjdCB9KTsKICAgICAgICBzZXRUaW1lb3V0KGV4ZWMsIHdhaXQyKTsKICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgfQogICAgfTsKICB9CiAgdmFyIHNjaGVkdWxlckNhY2hlOwogIHZhciBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL2NyZWF0ZUJhdGNoU2NoZWR1bGVyLmpzIigpIHsKICAgICAgaW5pdF93aXRoUmVzb2x2ZXJzKCk7CiAgICAgIHNjaGVkdWxlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzCiAgdmFyIE9mZmNoYWluTG9va3VwRXJyb3IsIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciwgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yOwogIHZhciBpbml0X2NjaXAgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzIigpIHsKICAgICAgaW5pdF9zdHJpbmdpZnkoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfdXRpbHMzKCk7CiAgICAgIE9mZmNoYWluTG9va3VwRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2FsbGJhY2tTZWxlY3RvciwgY2F1c2UsIGRhdGEsIGV4dHJhRGF0YSwgc2VuZGVyLCB1cmxzIH0pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgZm9yIGFuIG9mZmNoYWluIHJlc3VsdC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgfHwgW10sCiAgICAgICAgICAgICAgY2F1c2UubWV0YU1lc3NhZ2VzPy5sZW5ndGggPyAiIiA6IFtdLAogICAgICAgICAgICAgICJPZmZjaGFpbiBHYXRld2F5IENhbGw6IiwKICAgICAgICAgICAgICB1cmxzICYmIFsKICAgICAgICAgICAgICAgICIgIEdhdGV3YXkgVVJMKHMpOiIsCiAgICAgICAgICAgICAgICAuLi51cmxzLm1hcCgodXJsKSA9PiBgICAgICR7Z2V0VXJsKHVybCl9YCkKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGAgIFNlbmRlcjogJHtzZW5kZXJ9YCwKICAgICAgICAgICAgICBgICBEYXRhOiAke2RhdGF9YCwKICAgICAgICAgICAgICBgICBDYWxsYmFjayBzZWxlY3RvcjogJHtjYWxsYmFja1NlbGVjdG9yfWAsCiAgICAgICAgICAgICAgYCAgRXh0cmEgZGF0YTogJHtleHRyYURhdGF9YAogICAgICAgICAgICBdLmZsYXQoKSwKICAgICAgICAgICAgbmFtZTogIk9mZmNoYWluTG9va3VwRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyByZXN1bHQsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiT2ZmY2hhaW4gZ2F0ZXdheSByZXNwb25zZSBpcyBtYWxmb3JtZWQuIFJlc3BvbnNlIGRhdGEgbXVzdCBiZSBhIGhleCB2YWx1ZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBHYXRld2F5IFVSTDogJHtnZXRVcmwodXJsKX1gLAogICAgICAgICAgICAgIGBSZXNwb25zZTogJHtzdHJpbmdpZnkocmVzdWx0KX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cFJlc3BvbnNlTWFsZm9ybWVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwU2VuZGVyTWlzbWF0Y2hFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzZW5kZXIsIHRvIH0pIHsKICAgICAgICAgIHN1cGVyKCJSZXZlcnRlZCBzZW5kZXIgYWRkcmVzcyBkb2VzIG5vdCBtYXRjaCB0YXJnZXQgY29udHJhY3QgYWRkcmVzcyAoYHRvYCkuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgQ29udHJhY3QgYWRkcmVzczogJHt0b31gLAogICAgICAgICAgICAgIGBPZmZjaGFpbkxvb2t1cCBzZW5kZXIgYWRkcmVzczogJHtzZW5kZXJ9YAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcwogIHZhciBjY2lwX2V4cG9ydHMgPSB7fTsKICBfX2V4cG9ydChjY2lwX2V4cG9ydHMsIHsKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlCiAgfSk7CiAgYXN5bmMgZnVuY3Rpb24gb2ZmY2hhaW5Mb29rdXAoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgdG8gfSkgewogICAgY29uc3QgeyBhcmdzIH0gPSBkZWNvZGVFcnJvclJlc3VsdCh7CiAgICAgIGRhdGEsCiAgICAgIGFiaTogW29mZmNoYWluTG9va3VwQWJpSXRlbV0KICAgIH0pOwogICAgY29uc3QgW3NlbmRlciwgdXJscywgY2FsbERhdGEsIGNhbGxiYWNrU2VsZWN0b3IsIGV4dHJhRGF0YV0gPSBhcmdzOwogICAgY29uc3QgeyBjY2lwUmVhZCB9ID0gY2xpZW50OwogICAgY29uc3QgY2NpcFJlcXVlc3RfID0gY2NpcFJlYWQgJiYgdHlwZW9mIGNjaXBSZWFkPy5yZXF1ZXN0ID09PSAiZnVuY3Rpb24iID8gY2NpcFJlYWQucmVxdWVzdCA6IGNjaXBSZXF1ZXN0OwogICAgdHJ5IHsKICAgICAgaWYgKCFpc0FkZHJlc3NFcXVhbCh0bywgc2VuZGVyKSkKICAgICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yKHsgc2VuZGVyLCB0byB9KTsKICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2NpcFJlcXVlc3RfKHsgZGF0YTogY2FsbERhdGEsIHNlbmRlciwgdXJscyB9KTsKICAgICAgY29uc3QgeyBkYXRhOiBkYXRhXyB9ID0gYXdhaXQgY2FsbChjbGllbnQsIHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZywKICAgICAgICBkYXRhOiBjb25jYXQoWwogICAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFtyZXN1bHQsIGV4dHJhRGF0YV0pCiAgICAgICAgXSksCiAgICAgICAgdG8KICAgICAgfSk7CiAgICAgIHJldHVybiBkYXRhXzsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBFcnJvcih7CiAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIGRhdGEsCiAgICAgICAgZXh0cmFEYXRhLAogICAgICAgIHNlbmRlciwKICAgICAgICB1cmxzCiAgICAgIH0pOwogICAgfQogIH0KICBhc3luYyBmdW5jdGlvbiBjY2lwUmVxdWVzdCh7IGRhdGEsIHNlbmRlciwgdXJscyB9KSB7CiAgICBsZXQgZXJyb3IgPSBuZXcgRXJyb3IoIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVybHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgdXJsID0gdXJsc1tpXTsKICAgICAgY29uc3QgbWV0aG9kID0gdXJsLmluY2x1ZGVzKCJ7ZGF0YX0iKSA/ICJHRVQiIDogIlBPU1QiOwogICAgICBjb25zdCBib2R5ID0gbWV0aG9kID09PSAiUE9TVCIgPyB7IGRhdGEsIHNlbmRlciB9IDogdm9pZCAwOwogICAgICBjb25zdCBoZWFkZXJzID0gbWV0aG9kID09PSAiUE9TVCIgPyB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSA6IHt9OwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLnJlcGxhY2UoIntzZW5kZXJ9Iiwgc2VuZGVyKS5yZXBsYWNlKCJ7ZGF0YX0iLCBkYXRhKSwgewogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgbWV0aG9kCiAgICAgICAgfSk7CiAgICAgICAgbGV0IHJlc3VsdDsKICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpIHsKICAgICAgICAgIHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpLmRhdGE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgZXJyb3IgPSBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgIGRldGFpbHM6IHJlc3VsdD8uZXJyb3IgPyBzdHJpbmdpZnkocmVzdWx0LmVycm9yKSA6IHJlc3BvbnNlLnN0YXR1c1RleHQsCiAgICAgICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMsCiAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICghaXNIZXgocmVzdWx0KSkgewogICAgICAgICAgZXJyb3IgPSBuZXcgT2ZmY2hhaW5Mb29rdXBSZXNwb25zZU1hbGZvcm1lZEVycm9yKHsKICAgICAgICAgICAgcmVzdWx0LAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGVycm9yID0gbmV3IEh0dHBSZXF1ZXN0RXJyb3IoewogICAgICAgICAgYm9keSwKICAgICAgICAgIGRldGFpbHM6IGVyci5tZXNzYWdlLAogICAgICAgICAgdXJsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIHRocm93IGVycm9yOwogIH0KICB2YXIgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmUsIG9mZmNoYWluTG9va3VwQWJpSXRlbTsKICB2YXIgaW5pdF9jY2lwMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcyIoKSB7CiAgICAgIGluaXRfY2FsbCgpOwogICAgICBpbml0X2NjaXAoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIGluaXRfZGVjb2RlRXJyb3JSZXN1bHQoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICAgICAgaW5pdF9jb25jYXQoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgICBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZSA9ICIweDU1NmYxODMwIjsKICAgICAgb2ZmY2hhaW5Mb29rdXBBYmlJdGVtID0gewogICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cCIsCiAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInVybHMiLAogICAgICAgICAgICB0eXBlOiAic3RyaW5nW10iCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbERhdGEiLAogICAgICAgICAgICB0eXBlOiAiYnl0ZXMiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbGJhY2tGdW5jdGlvbiIsCiAgICAgICAgICAgIHR5cGU6ICJieXRlczQiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiZXh0cmFEYXRhIiwKICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NhbGwuanMKICBhc3luYyBmdW5jdGlvbiBjYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBiYXRjaCA9IEJvb2xlYW4oY2xpZW50LmJhdGNoPy5tdWx0aWNhbGwpLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYWNjZXNzTGlzdCwgYmxvYnMsIGNvZGUsIGRhdGE6IGRhdGFfLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSwgLi4ucmVzdCB9ID0gYXJnczsKICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50XyA/IHBhcnNlQWNjb3VudChhY2NvdW50XykgOiB2b2lkIDA7CiAgICBpZiAoY29kZSAmJiAoZmFjdG9yeSB8fCBmYWN0b3J5RGF0YSkpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJDYW5ub3QgcHJvdmlkZSBib3RoIGBjb2RlYCAmIGBmYWN0b3J5YC9gZmFjdG9yeURhdGFgIGFzIHBhcmFtZXRlcnMuIik7CiAgICBpZiAoY29kZSAmJiB0bykKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkNhbm5vdCBwcm92aWRlIGJvdGggYGNvZGVgICYgYHRvYCBhcyBwYXJhbWV0ZXJzLiIpOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSA9IGNvZGUgJiYgZGF0YV87CiAgICBjb25zdCBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnkgPSBmYWN0b3J5ICYmIGZhY3RvcnlEYXRhICYmIHRvICYmIGRhdGFfOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGwgPSBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlIHx8IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeTsKICAgIGNvbnN0IGRhdGEgPSAoKCkgPT4gewogICAgICBpZiAoZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlRGF0YSh7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgZGF0YTogZGF0YV8KICAgICAgICB9KTsKICAgICAgaWYgKGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHsKICAgICAgICAgIGRhdGE6IGRhdGFfLAogICAgICAgICAgZmFjdG9yeSwKICAgICAgICAgIGZhY3RvcnlEYXRhLAogICAgICAgICAgdG8KICAgICAgICB9KTsKICAgICAgcmV0dXJuIGRhdGFfOwogICAgfSkoKTsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWc7CiAgICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpOwogICAgICBjb25zdCBjaGFpbkZvcm1hdCA9IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVycz8udHJhbnNhY3Rpb25SZXF1ZXN0Py5mb3JtYXQ7CiAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgICAgLy8gUGljayBvdXQgZXh0cmEgZGF0YSB0aGF0IG1pZ2h0IGV4aXN0IG9uIHRoZSBjaGFpbidzIHRyYW5zYWN0aW9uIHJlcXVlc3QgdHlwZS4KICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgYmxvYnMsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgbm9uY2UsCiAgICAgICAgdG86IGRlcGxveWxlc3NDYWxsID8gdm9pZCAwIDogdG8sCiAgICAgICAgdmFsdWUKICAgICAgfSk7CiAgICAgIGlmIChiYXRjaCAmJiBzaG91bGRQZXJmb3JtTXVsdGljYWxsKHsgcmVxdWVzdCB9KSAmJiAhcnBjU3RhdGVPdmVycmlkZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgc2NoZWR1bGVNdWx0aWNhbGwoY2xpZW50LCB7CiAgICAgICAgICAgIC4uLnJlcXVlc3QsCiAgICAgICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgICAgICBibG9ja1RhZwogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcikgJiYgIShlcnIgaW5zdGFuY2VvZiBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QpKQogICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUgPyBbCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgYmxvY2ssCiAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgXSA6IFtyZXF1ZXN0LCBibG9ja10KICAgICAgfSk7CiAgICAgIGlmIChyZXNwb25zZSA9PT0gIjB4IikKICAgICAgICByZXR1cm4geyBkYXRhOiB2b2lkIDAgfTsKICAgICAgcmV0dXJuIHsgZGF0YTogcmVzcG9uc2UgfTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBjb25zdCBkYXRhMiA9IGdldFJldmVydEVycm9yRGF0YShlcnIpOwogICAgICBjb25zdCB7IG9mZmNoYWluTG9va3VwOiBvZmZjaGFpbkxvb2t1cDIsIG9mZmNoYWluTG9va3VwU2lnbmF0dXJlOiBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZTIgfSA9IGF3YWl0IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gKGluaXRfY2NpcDIoKSwgY2NpcF9leHBvcnRzKSk7CiAgICAgIGlmIChjbGllbnQuY2NpcFJlYWQgIT09IGZhbHNlICYmIGRhdGEyPy5zbGljZSgwLCAxMCkgPT09IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlMiAmJiB0bykKICAgICAgICByZXR1cm4geyBkYXRhOiBhd2FpdCBvZmZjaGFpbkxvb2t1cDIoY2xpZW50LCB7IGRhdGE6IGRhdGEyLCB0byB9KSB9OwogICAgICBpZiAoZGVwbG95bGVzc0NhbGwgJiYgZGF0YTI/LnNsaWNlKDAsIDEwKSA9PT0gIjB4MTAxYmI5OGQiKQogICAgICAgIHRocm93IG5ldyBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcih7IGZhY3RvcnkgfSk7CiAgICAgIHRocm93IGdldENhbGxFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2hvdWxkUGVyZm9ybU11bHRpY2FsbCh7IHJlcXVlc3QgfSkgewogICAgY29uc3QgeyBkYXRhLCB0bywgLi4ucmVxdWVzdF8gfSA9IHJlcXVlc3Q7CiAgICBpZiAoIWRhdGEpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChkYXRhLnN0YXJ0c1dpdGgoYWdncmVnYXRlM1NpZ25hdHVyZSkpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICghdG8pCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChPYmplY3QudmFsdWVzKHJlcXVlc3RfKS5maWx0ZXIoKHgpID0+IHR5cGVvZiB4ICE9PSAidW5kZWZpbmVkIikubGVuZ3RoID4gMCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlTXVsdGljYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBiYXRjaFNpemUgPSAxMDI0LCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBjbGllbnQuYmF0Y2g/Lm11bHRpY2FsbCA9PT0gIm9iamVjdCIgPyBjbGllbnQuYmF0Y2gubXVsdGljYWxsIDoge307CiAgICBjb25zdCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCBkYXRhLCBtdWx0aWNhbGxBZGRyZXNzOiBtdWx0aWNhbGxBZGRyZXNzXywgdG8gfSA9IGFyZ3M7CiAgICBsZXQgbXVsdGljYWxsQWRkcmVzcyA9IG11bHRpY2FsbEFkZHJlc3NfOwogICAgaWYgKCFtdWx0aWNhbGxBZGRyZXNzKSB7CiAgICAgIGlmICghY2xpZW50LmNoYWluKQogICAgICAgIHRocm93IG5ldyBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcigpOwogICAgICBtdWx0aWNhbGxBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJtdWx0aWNhbGwzIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7Y2xpZW50LnVpZH0uJHtibG9ja31gLAogICAgICB3YWl0OiB3YWl0MiwKICAgICAgc2hvdWxkU3BsaXRCYXRjaChhcmdzMikgewogICAgICAgIGNvbnN0IHNpemUzID0gYXJnczIucmVkdWNlKChzaXplNCwgeyBkYXRhOiBkYXRhMiB9KSA9PiBzaXplNCArIChkYXRhMi5sZW5ndGggLSAyKSwgMCk7CiAgICAgICAgcmV0dXJuIHNpemUzID4gYmF0Y2hTaXplICogMjsKICAgICAgfSwKICAgICAgZm46IGFzeW5jIChyZXF1ZXN0cykgPT4gewogICAgICAgIGNvbnN0IGNhbGxzID0gcmVxdWVzdHMubWFwKChyZXF1ZXN0KSA9PiAoewogICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgY2FsbERhdGE6IHJlcXVlc3QuZGF0YSwKICAgICAgICAgIHRhcmdldDogcmVxdWVzdC50bwogICAgICAgIH0pKTsKICAgICAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IG11bHRpY2FsbDNBYmksCiAgICAgICAgICBhcmdzOiBbY2FsbHNdLAogICAgICAgICAgZnVuY3Rpb25OYW1lOiAiYWdncmVnYXRlMyIKICAgICAgICB9KTsKICAgICAgICBjb25zdCBkYXRhMiA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICAgIHBhcmFtczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGF0YTogY2FsbGRhdGEsCiAgICAgICAgICAgICAgdG86IG11bHRpY2FsbEFkZHJlc3MKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYmxvY2sKICAgICAgICAgIF0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZGVjb2RlRnVuY3Rpb25SZXN1bHQoewogICAgICAgICAgYWJpOiBtdWx0aWNhbGwzQWJpLAogICAgICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImFnZ3JlZ2F0ZTMiLAogICAgICAgICAgZGF0YTogZGF0YTIgfHwgIjB4IgogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFt7IHJldHVybkRhdGEsIHN1Y2Nlc3MgfV0gPSBhd2FpdCBzY2hlZHVsZSh7IGRhdGEsIHRvIH0pOwogICAgaWYgKCFzdWNjZXNzKQogICAgICB0aHJvdyBuZXcgUmF3Q29udHJhY3RFcnJvcih7IGRhdGE6IHJldHVybkRhdGEgfSk7CiAgICBpZiAocmV0dXJuRGF0YSA9PT0gIjB4IikKICAgICAgcmV0dXJuIHsgZGF0YTogdm9pZCAwIH07CiAgICByZXR1cm4geyBkYXRhOiByZXR1cm5EYXRhIH07CiAgfQogIGZ1bmN0aW9uIHRvRGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYnl0ZXMsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgICAgYXJnczogW2NvZGUsIGRhdGFdCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHRvIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYWRkcmVzcywgYnl0ZXMsIGFkZHJlc3MsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlLAogICAgICBhcmdzOiBbdG8sIGRhdGEsIGZhY3RvcnksIGZhY3RvcnlEYXRhXQogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGdldFJldmVydEVycm9yRGF0YShlcnIpIHsKICAgIGlmICghKGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIpKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgY29uc3QgZXJyb3IgPSBlcnIud2FsaygpOwogICAgcmV0dXJuIHR5cGVvZiBlcnJvcj8uZGF0YSA9PT0gIm9iamVjdCIgPyBlcnJvci5kYXRhPy5kYXRhIDogZXJyb3IuZGF0YTsKICB9CiAgdmFyIGluaXRfY2FsbCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY2FsbC5qcyIoKSB7CiAgICAgIGluaXRfZXhwb3J0cygpOwogICAgICBpbml0X3BhcnNlQWNjb3VudCgpOwogICAgICBpbml0X2FiaXMoKTsKICAgICAgaW5pdF9jb250cmFjdDIoKTsKICAgICAgaW5pdF9jb250cmFjdHMoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfY2hhaW4oKTsKICAgICAgaW5pdF9jb250cmFjdCgpOwogICAgICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgICAgIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogICAgICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogICAgICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9nZXRDYWxsRXJyb3IoKTsKICAgICAgaW5pdF9leHRyYWN0KCk7CiAgICAgIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CiAgICAgIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKICAgICAgaW5pdF9zdGF0ZU92ZXJyaWRlMigpOwogICAgICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0TmF0aXZlV2ViU29ja2V0KCkgewogICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gV2ViU29ja2V0OwogICAgaWYgKHR5cGVvZiBnbG9iYWwuV2ViU29ja2V0ICE9PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIGdsb2JhbC5XZWJTb2NrZXQ7CiAgICBpZiAodHlwZW9mIHdpbmRvdy5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gd2luZG93LldlYlNvY2tldDsKICAgIGlmICh0eXBlb2Ygc2VsZi5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gc2VsZi5XZWJTb2NrZXQ7CiAgICB0aHJvdyBuZXcgRXJyb3IoImBXZWJTb2NrZXRgIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudCIpOwogIH0KICB2YXIgaW5pdF91dGlsczUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcwogIHZhciBuYXRpdmVfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KG5hdGl2ZV9leHBvcnRzLCB7CiAgICBXZWJTb2NrZXQ6ICgpID0+IFdlYlNvY2tldDIKICB9KTsKICB2YXIgV2ViU29ja2V0MjsKICB2YXIgaW5pdF9uYXRpdmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcyIoKSB7CiAgICAgIGluaXRfdXRpbHM1KCk7CiAgICAgIFdlYlNvY2tldDIgPSBnZXROYXRpdmVXZWJTb2NrZXQoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgdmFyIGVzbV9leHBvcnRzID0ge307CiAgX19leHBvcnQoZXNtX2V4cG9ydHMsIHsKICAgIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yLAogICAgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IsCiAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLAogICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3I6ICgpID0+IEFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yLAogICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IsCiAgICBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IsCiAgICBBYmlFbmNvZGluZ0J5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciwKICAgIEFiaUVuY29kaW5nTGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yLAogICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFcnJvcklucHV0c05vdEZvdW5kRXJyb3IsCiAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3I6ICgpID0+IEFiaUVycm9yTm90Rm91bmRFcnJvciwKICAgIEFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRXZlbnROb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFdmVudE5vdEZvdW5kRXJyb3IsCiAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3I6ICgpID0+IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwKICAgIEFiaUV2ZW50U2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsCiAgICBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yOiAoKSA9PiBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yLAogICAgQmFzZUVycm9yOiAoKSA9PiBCYXNlRXJyb3IyLAogICAgQmFzZUZlZVNjYWxhckVycm9yOiAoKSA9PiBCYXNlRmVlU2NhbGFyRXJyb3IsCiAgICBCbG9ja05vdEZvdW5kRXJyb3I6ICgpID0+IEJsb2NrTm90Rm91bmRFcnJvciwKICAgIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsCiAgICBDYWxsRXhlY3V0aW9uRXJyb3I6ICgpID0+IENhbGxFeGVjdXRpb25FcnJvciwKICAgIENoYWluRGlzY29ubmVjdGVkRXJyb3I6ICgpID0+IENoYWluRGlzY29ubmVjdGVkRXJyb3IsCiAgICBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3Q6ICgpID0+IENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCwKICAgIENoYWluTWlzbWF0Y2hFcnJvcjogKCkgPT4gQ2hhaW5NaXNtYXRjaEVycm9yLAogICAgQ2hhaW5Ob3RGb3VuZEVycm9yOiAoKSA9PiBDaGFpbk5vdEZvdW5kRXJyb3IsCiAgICBDaXJjdWxhclJlZmVyZW5jZUVycm9yOiAoKSA9PiBDaXJjdWxhclJlZmVyZW5jZUVycm9yLAogICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3I6ICgpID0+IENsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yLAogICAgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IsCiAgICBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcjogKCkgPT4gQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IsCiAgICBEZWNvZGVMb2dEYXRhTWlzbWF0Y2g6ICgpID0+IERlY29kZUxvZ0RhdGFNaXNtYXRjaCwKICAgIERlY29kZUxvZ1RvcGljc01pc21hdGNoOiAoKSA9PiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCwKICAgIEVJUDExOTNQcm92aWRlclJwY0Vycm9yOiAoKSA9PiBQcm92aWRlclJwY0Vycm9yMiwKICAgIEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3I6ICgpID0+IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IsCiAgICBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3I6ICgpID0+IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvciwKICAgIEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3I6ICgpID0+IEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3IsCiAgICBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3I6ICgpID0+IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvciwKICAgIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3I6ICgpID0+IEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IsCiAgICBFeGVjdXRpb25SZXZlcnRlZEVycm9yOiAoKSA9PiBFeGVjdXRpb25SZXZlcnRlZEVycm9yLAogICAgRmVlQ2FwVG9vSGlnaEVycm9yOiAoKSA9PiBGZWVDYXBUb29IaWdoRXJyb3IsCiAgICBGZWVDYXBUb29Mb3dFcnJvcjogKCkgPT4gRmVlQ2FwVG9vTG93RXJyb3IsCiAgICBGZWVDb25mbGljdEVycm9yOiAoKSA9PiBGZWVDb25mbGljdEVycm9yLAogICAgRmlsdGVyVHlwZU5vdFN1cHBvcnRlZEVycm9yOiAoKSA9PiBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBIdHRwUmVxdWVzdEVycm9yOiAoKSA9PiBIdHRwUmVxdWVzdEVycm9yLAogICAgSW5zdWZmaWNpZW50RnVuZHNFcnJvcjogKCkgPT4gSW5zdWZmaWNpZW50RnVuZHNFcnJvciwKICAgIEludGVnZXJPdXRPZlJhbmdlRXJyb3I6ICgpID0+IEludGVnZXJPdXRPZlJhbmdlRXJyb3IsCiAgICBJbnRlcm5hbFJwY0Vycm9yOiAoKSA9PiBJbnRlcm5hbFJwY0Vycm9yLAogICAgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yOiAoKSA9PiBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsCiAgICBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcjogKCkgPT4gSW50cmluc2ljR2FzVG9vTG93RXJyb3IsCiAgICBJbnZhbGlkQWJpRGVjb2RpbmdUeXBlRXJyb3I6ICgpID0+IEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciwKICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvcjogKCkgPT4gSW52YWxpZEFiaUVuY29kaW5nVHlwZUVycm9yLAogICAgSW52YWxpZEFiaUl0ZW1FcnJvcjogKCkgPT4gSW52YWxpZEFiaUl0ZW1FcnJvciwKICAgIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwKICAgIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I6ICgpID0+IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IsCiAgICBJbnZhbGlkQWRkcmVzc0Vycm9yOiAoKSA9PiBJbnZhbGlkQWRkcmVzc0Vycm9yLAogICAgSW52YWxpZEFycmF5RXJyb3I6ICgpID0+IEludmFsaWRBcnJheUVycm9yLAogICAgSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IsCiAgICBJbnZhbGlkQ2hhaW5JZEVycm9yOiAoKSA9PiBJbnZhbGlkQ2hhaW5JZEVycm9yLAogICAgSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvcjogKCkgPT4gSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvciwKICAgIEludmFsaWREZWZpbml0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciwKICAgIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3I6ICgpID0+IEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsCiAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yLAogICAgSW52YWxpZEhleFZhbHVlRXJyb3I6ICgpID0+IEludmFsaWRIZXhWYWx1ZUVycm9yLAogICAgSW52YWxpZElucHV0UnBjRXJyb3I6ICgpID0+IEludmFsaWRJbnB1dFJwY0Vycm9yLAogICAgSW52YWxpZExlZ2FjeVZFcnJvcjogKCkgPT4gSW52YWxpZExlZ2FjeVZFcnJvciwKICAgIEludmFsaWRNb2RpZmllckVycm9yOiAoKSA9PiBJbnZhbGlkTW9kaWZpZXJFcnJvciwKICAgIEludmFsaWRQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZFBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUGFyYW1zUnBjRXJyb3IsCiAgICBJbnZhbGlkUGFyZW50aGVzaXNFcnJvcjogKCkgPT4gSW52YWxpZFBhcmVudGhlc2lzRXJyb3IsCiAgICBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcjogKCkgPT4gSW52YWxpZFByaW1hcnlUeXBlRXJyb3IsCiAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLAogICAgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3I6ICgpID0+IEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLAogICAgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsCiAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLAogICAgSW52YWxpZFNpZ25hdHVyZUVycm9yOiAoKSA9PiBJbnZhbGlkU2lnbmF0dXJlRXJyb3IsCiAgICBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcjogKCkgPT4gSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IsCiAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciwKICAgIEludmFsaWRTdHJ1Y3RUeXBlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IsCiAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3I6ICgpID0+IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwKICAgIExpbWl0RXhjZWVkZWRScGNFcnJvcjogKCkgPT4gTGltaXRFeGNlZWRlZFJwY0Vycm9yLAogICAgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3I6ICgpID0+IE1heEZlZVBlckdhc1Rvb0xvd0Vycm9yLAogICAgTWV0aG9kTm90Rm91bmRScGNFcnJvcjogKCkgPT4gTWV0aG9kTm90Rm91bmRScGNFcnJvciwKICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yOiAoKSA9PiBNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwKICAgIE5vbmNlTWF4VmFsdWVFcnJvcjogKCkgPT4gTm9uY2VNYXhWYWx1ZUVycm9yLAogICAgTm9uY2VUb29IaWdoRXJyb3I6ICgpID0+IE5vbmNlVG9vSGlnaEVycm9yLAogICAgTm9uY2VUb29Mb3dFcnJvcjogKCkgPT4gTm9uY2VUb29Mb3dFcnJvciwKICAgIFBhcnNlUnBjRXJyb3I6ICgpID0+IFBhcnNlUnBjRXJyb3IsCiAgICBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yOiAoKSA9PiBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLAogICAgUHJvdmlkZXJScGNFcnJvcjogKCkgPT4gUHJvdmlkZXJScGNFcnJvciwKICAgIFJhd0NvbnRyYWN0RXJyb3I6ICgpID0+IFJhd0NvbnRyYWN0RXJyb3IsCiAgICBSZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3I6ICgpID0+IFJlc291cmNlTm90Rm91bmRScGNFcnJvciwKICAgIFJlc291cmNlVW5hdmFpbGFibGVScGNFcnJvcjogKCkgPT4gUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLAogICAgUnBjRXJyb3I6ICgpID0+IFJwY0Vycm9yLAogICAgUnBjUmVxdWVzdEVycm9yOiAoKSA9PiBScGNSZXF1ZXN0RXJyb3IsCiAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3I6ICgpID0+IFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwKICAgIFNpemVPdmVyZmxvd0Vycm9yOiAoKSA9PiBTaXplT3ZlcmZsb3dFcnJvciwKICAgIFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcjogKCkgPT4gU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yLAogICAgU29ja2V0Q2xvc2VkRXJyb3I6ICgpID0+IFNvY2tldENsb3NlZEVycm9yLAogICAgU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3I6ICgpID0+IFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yLAogICAgU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvcjogKCkgPT4gU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvciwKICAgIFN3aXRjaENoYWluRXJyb3I6ICgpID0+IFN3aXRjaENoYWluRXJyb3IsCiAgICBUaW1lb3V0RXJyb3I6ICgpID0+IFRpbWVvdXRFcnJvciwKICAgIFRpcEFib3ZlRmVlQ2FwRXJyb3I6ICgpID0+IFRpcEFib3ZlRmVlQ2FwRXJyb3IsCiAgICBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLAogICAgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yLAogICAgVHJhbnNhY3Rpb25SZWplY3RlZFJwY0Vycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsCiAgICBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvcjogKCkgPT4gVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yOiAoKSA9PiBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLAogICAgVW5rbm93bk5vZGVFcnJvcjogKCkgPT4gVW5rbm93bk5vZGVFcnJvciwKICAgIFVua25vd25ScGNFcnJvcjogKCkgPT4gVW5rbm93blJwY0Vycm9yLAogICAgVW5rbm93blNpZ25hdHVyZUVycm9yOiAoKSA9PiBVbmtub3duU2lnbmF0dXJlRXJyb3IsCiAgICBVbmtub3duVHlwZUVycm9yOiAoKSA9PiBVbmtub3duVHlwZUVycm9yLAogICAgVW5zdXBwb3J0ZWRQYWNrZWRBYmlUeXBlOiAoKSA9PiBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUsCiAgICBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3I6ICgpID0+IFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwKICAgIFVybFJlcXVpcmVkRXJyb3I6ICgpID0+IFVybFJlcXVpcmVkRXJyb3IsCiAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3I6ICgpID0+IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciwKICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I6ICgpID0+IFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IsCiAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3I6ICgpID0+IFdlYlNvY2tldFJlcXVlc3RFcnJvciwKICAgIGFzc2VydEN1cnJlbnRDaGFpbjogKCkgPT4gYXNzZXJ0Q3VycmVudENoYWluLAogICAgYXNzZXJ0UmVxdWVzdDogKCkgPT4gYXNzZXJ0UmVxdWVzdCwKICAgIGFzc2VydFRyYW5zYWN0aW9uRUlQMTU1OTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5LAogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAyOTMwOiAoKSA9PiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAsCiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3ksCiAgICBibG9ic1RvQ29tbWl0bWVudHM6ICgpID0+IGJsb2JzVG9Db21taXRtZW50cywKICAgIGJsb2JzVG9Qcm9vZnM6ICgpID0+IGJsb2JzVG9Qcm9vZnMsCiAgICBib29sVG9CeXRlczogKCkgPT4gYm9vbFRvQnl0ZXMsCiAgICBib29sVG9IZXg6ICgpID0+IGJvb2xUb0hleCwKICAgIGJ5dGVzVG9CaWdJbnQ6ICgpID0+IGJ5dGVzVG9CaWdJbnQsCiAgICBieXRlc1RvQm9vbDogKCkgPT4gYnl0ZXNUb0Jvb2wsCiAgICBieXRlc1RvSGV4OiAoKSA9PiBieXRlc1RvSGV4LAogICAgYnl0ZXNUb051bWJlcjogKCkgPT4gYnl0ZXNUb051bWJlciwKICAgIGJ5dGVzVG9SbHA6ICgpID0+IGJ5dGVzVG9SbHAsCiAgICBieXRlc1RvU3RyaW5nOiAoKSA9PiBieXRlc1RvU3RyaW5nLAogICAgY2NpcEZldGNoOiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNoZWNrc3VtQWRkcmVzczogKCkgPT4gY2hlY2tzdW1BZGRyZXNzLAogICAgY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaDogKCkgPT4gY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaCwKICAgIGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXM6ICgpID0+IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmU6ICgpID0+IGNvbXBhY3RTaWduYXR1cmVUb1NpZ25hdHVyZSwKICAgIGNvbmNhdDogKCkgPT4gY29uY2F0LAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMiwKICAgIGNvbmNhdEhleDogKCkgPT4gY29uY2F0SGV4LAogICAgY3JlYXRlQ2xpZW50OiAoKSA9PiBjcmVhdGVDbGllbnQsCiAgICBjcmVhdGVOb25jZU1hbmFnZXI6ICgpID0+IGNyZWF0ZU5vbmNlTWFuYWdlciwKICAgIGNyZWF0ZVB1YmxpY0NsaWVudDogKCkgPT4gY3JlYXRlUHVibGljQ2xpZW50LAogICAgY3JlYXRlVGVzdENsaWVudDogKCkgPT4gY3JlYXRlVGVzdENsaWVudCwKICAgIGNyZWF0ZVRyYW5zcG9ydDogKCkgPT4gY3JlYXRlVHJhbnNwb3J0LAogICAgY3JlYXRlV2FsbGV0Q2xpZW50OiAoKSA9PiBjcmVhdGVXYWxsZXRDbGllbnQsCiAgICBjdXN0b206ICgpID0+IGN1c3RvbSwKICAgIGRlY29kZUFiaVBhcmFtZXRlcnM6ICgpID0+IGRlY29kZUFiaVBhcmFtZXRlcnMsCiAgICBkZWNvZGVEZXBsb3lEYXRhOiAoKSA9PiBkZWNvZGVEZXBsb3lEYXRhLAogICAgZGVjb2RlRXJyb3JSZXN1bHQ6ICgpID0+IGRlY29kZUVycm9yUmVzdWx0LAogICAgZGVjb2RlRXZlbnRMb2c6ICgpID0+IGRlY29kZUV2ZW50TG9nLAogICAgZGVjb2RlRnVuY3Rpb25EYXRhOiAoKSA9PiBkZWNvZGVGdW5jdGlvbkRhdGEsCiAgICBkZWNvZGVGdW5jdGlvblJlc3VsdDogKCkgPT4gZGVjb2RlRnVuY3Rpb25SZXN1bHQsCiAgICBkZWZpbmVCbG9jazogKCkgPT4gZGVmaW5lQmxvY2ssCiAgICBkZWZpbmVDaGFpbjogKCkgPT4gZGVmaW5lQ2hhaW4sCiAgICBkZWZpbmVLemc6ICgpID0+IGRlZmluZUt6ZywKICAgIGRlZmluZVRyYW5zYWN0aW9uOiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvbiwKICAgIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZGVmaW5lVHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlQnl0ZWNvZGU6ICgpID0+IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgIGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlOiAoKSA9PiBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSwKICAgIGRvbWFpblNlcGFyYXRvcjogKCkgPT4gZG9tYWluU2VwYXJhdG9yLAogICAgZW5jb2RlQWJpUGFyYW1ldGVyczogKCkgPT4gZW5jb2RlQWJpUGFyYW1ldGVycywKICAgIGVuY29kZURlcGxveURhdGE6ICgpID0+IGVuY29kZURlcGxveURhdGEsCiAgICBlbmNvZGVFcnJvclJlc3VsdDogKCkgPT4gZW5jb2RlRXJyb3JSZXN1bHQsCiAgICBlbmNvZGVFdmVudFRvcGljczogKCkgPT4gZW5jb2RlRXZlbnRUb3BpY3MsCiAgICBlbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IGVuY29kZUZ1bmN0aW9uRGF0YSwKICAgIGVuY29kZUZ1bmN0aW9uUmVzdWx0OiAoKSA9PiBlbmNvZGVGdW5jdGlvblJlc3VsdCwKICAgIGVuY29kZVBhY2tlZDogKCkgPT4gZW5jb2RlUGFja2VkLAogICAgZXJjMjBBYmk6ICgpID0+IGVyYzIwQWJpLAogICAgZXJjMjBBYmlfYnl0ZXMzMjogKCkgPT4gZXJjMjBBYmlfYnl0ZXMzMiwKICAgIGVyYzQ2MjZBYmk6ICgpID0+IGVyYzQ2MjZBYmksCiAgICBlcmM3MjFBYmk6ICgpID0+IGVyYzcyMUFiaSwKICAgIGV0aGVyVW5pdHM6ICgpID0+IGV0aGVyVW5pdHMsCiAgICBleHRyYWN0Q2hhaW46ICgpID0+IGV4dHJhY3RDaGFpbiwKICAgIGZhbGxiYWNrOiAoKSA9PiBmYWxsYmFjaywKICAgIGZvcm1hdEJsb2NrOiAoKSA9PiBmb3JtYXRCbG9jaywKICAgIGZvcm1hdEV0aGVyOiAoKSA9PiBmb3JtYXRFdGhlciwKICAgIGZvcm1hdEd3ZWk6ICgpID0+IGZvcm1hdEd3ZWksCiAgICBmb3JtYXRMb2c6ICgpID0+IGZvcm1hdExvZywKICAgIGZvcm1hdFRyYW5zYWN0aW9uOiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvbiwKICAgIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZm9ybWF0VHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBmb3JtYXRVbml0czogKCkgPT4gZm9ybWF0VW5pdHMsCiAgICBmcm9tQmxvYnM6ICgpID0+IGZyb21CbG9icywKICAgIGZyb21CeXRlczogKCkgPT4gZnJvbUJ5dGVzLAogICAgZnJvbUhleDogKCkgPT4gZnJvbUhleCwKICAgIGZyb21SbHA6ICgpID0+IGZyb21SbHAsCiAgICBnZXRBYmlJdGVtOiAoKSA9PiBnZXRBYmlJdGVtLAogICAgZ2V0QWRkcmVzczogKCkgPT4gZ2V0QWRkcmVzcywKICAgIGdldENoYWluQ29udHJhY3RBZGRyZXNzOiAoKSA9PiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcywKICAgIGdldENvbnRyYWN0OiAoKSA9PiBnZXRDb250cmFjdCwKICAgIGdldENvbnRyYWN0QWRkcmVzczogKCkgPT4gZ2V0Q29udHJhY3RBZGRyZXNzMiwKICAgIGdldENvbnRyYWN0RXJyb3I6ICgpID0+IGdldENvbnRyYWN0RXJyb3IsCiAgICBnZXRDcmVhdGUyQWRkcmVzczogKCkgPT4gZ2V0Q3JlYXRlMkFkZHJlc3MsCiAgICBnZXRDcmVhdGVBZGRyZXNzOiAoKSA9PiBnZXRDcmVhdGVBZGRyZXNzLAogICAgZ2V0RXZlbnRTZWxlY3RvcjogKCkgPT4gdG9FdmVudFNlbGVjdG9yLAogICAgZ2V0RXZlbnRTaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0RnVuY3Rpb25TZWxlY3RvcjogKCkgPT4gdG9GdW5jdGlvblNlbGVjdG9yLAogICAgZ2V0RnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZSwKICAgIGdldFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0VHJhbnNhY3Rpb25UeXBlLAogICAgZ2V0VHlwZXNGb3JFSVA3MTJEb21haW46ICgpID0+IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluLAogICAgZ3dlaVVuaXRzOiAoKSA9PiBnd2VpVW5pdHMsCiAgICBoYXNoRG9tYWluOiAoKSA9PiBoYXNoRG9tYWluLAogICAgaGFzaE1lc3NhZ2U6ICgpID0+IGhhc2hNZXNzYWdlLAogICAgaGFzaFR5cGVkRGF0YTogKCkgPT4gaGFzaFR5cGVkRGF0YSwKICAgIGhleFRvQmlnSW50OiAoKSA9PiBoZXhUb0JpZ0ludCwKICAgIGhleFRvQm9vbDogKCkgPT4gaGV4VG9Cb29sLAogICAgaGV4VG9CeXRlczogKCkgPT4gaGV4VG9CeXRlcywKICAgIGhleFRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gcGFyc2VDb21wYWN0U2lnbmF0dXJlLAogICAgaGV4VG9OdW1iZXI6ICgpID0+IGhleFRvTnVtYmVyLAogICAgaGV4VG9SbHA6ICgpID0+IGhleFRvUmxwLAogICAgaGV4VG9TaWduYXR1cmU6ICgpID0+IHBhcnNlU2lnbmF0dXJlMiwKICAgIGhleFRvU3RyaW5nOiAoKSA9PiBoZXhUb1N0cmluZywKICAgIGh0dHA6ICgpID0+IGh0dHAsCiAgICBpc0FkZHJlc3M6ICgpID0+IGlzQWRkcmVzcywKICAgIGlzQWRkcmVzc0VxdWFsOiAoKSA9PiBpc0FkZHJlc3NFcXVhbCwKICAgIGlzQnl0ZXM6ICgpID0+IGlzQnl0ZXMzLAogICAgaXNFcmM2NDkyU2lnbmF0dXJlOiAoKSA9PiBpc0VyYzY0OTJTaWduYXR1cmUsCiAgICBpc0hhc2g6ICgpID0+IGlzSGFzaCwKICAgIGlzSGV4OiAoKSA9PiBpc0hleCwKICAgIGtlY2NhazI1NjogKCkgPT4ga2VjY2FrMjU2LAogICAgbGFiZWxoYXNoOiAoKSA9PiBsYWJlbGhhc2gsCiAgICBtYXhJbnQxMDQ6ICgpID0+IG1heEludDEwNCwKICAgIG1heEludDExMjogKCkgPT4gbWF4SW50MTEyLAogICAgbWF4SW50MTIwOiAoKSA9PiBtYXhJbnQxMjAsCiAgICBtYXhJbnQxMjg6ICgpID0+IG1heEludDEyOCwKICAgIG1heEludDEzNjogKCkgPT4gbWF4SW50MTM2LAogICAgbWF4SW50MTQ0OiAoKSA9PiBtYXhJbnQxNDQsCiAgICBtYXhJbnQxNTI6ICgpID0+IG1heEludDE1MiwKICAgIG1heEludDE2OiAoKSA9PiBtYXhJbnQxNiwKICAgIG1heEludDE2MDogKCkgPT4gbWF4SW50MTYwLAogICAgbWF4SW50MTY4OiAoKSA9PiBtYXhJbnQxNjgsCiAgICBtYXhJbnQxNzY6ICgpID0+IG1heEludDE3NiwKICAgIG1heEludDE4NDogKCkgPT4gbWF4SW50MTg0LAogICAgbWF4SW50MTkyOiAoKSA9PiBtYXhJbnQxOTIsCiAgICBtYXhJbnQyMDA6ICgpID0+IG1heEludDIwMCwKICAgIG1heEludDIwODogKCkgPT4gbWF4SW50MjA4LAogICAgbWF4SW50MjE2OiAoKSA9PiBtYXhJbnQyMTYsCiAgICBtYXhJbnQyMjQ6ICgpID0+IG1heEludDIyNCwKICAgIG1heEludDIzMjogKCkgPT4gbWF4SW50MjMyLAogICAgbWF4SW50MjQ6ICgpID0+IG1heEludDI0LAogICAgbWF4SW50MjQwOiAoKSA9PiBtYXhJbnQyNDAsCiAgICBtYXhJbnQyNDg6ICgpID0+IG1heEludDI0OCwKICAgIG1heEludDI1NjogKCkgPT4gbWF4SW50MjU2LAogICAgbWF4SW50MzI6ICgpID0+IG1heEludDMyLAogICAgbWF4SW50NDA6ICgpID0+IG1heEludDQwLAogICAgbWF4SW50NDg6ICgpID0+IG1heEludDQ4LAogICAgbWF4SW50NTY6ICgpID0+IG1heEludDU2LAogICAgbWF4SW50NjQ6ICgpID0+IG1heEludDY0LAogICAgbWF4SW50NzI6ICgpID0+IG1heEludDcyLAogICAgbWF4SW50ODogKCkgPT4gbWF4SW50OCwKICAgIG1heEludDgwOiAoKSA9PiBtYXhJbnQ4MCwKICAgIG1heEludDg4OiAoKSA9PiBtYXhJbnQ4OCwKICAgIG1heEludDk2OiAoKSA9PiBtYXhJbnQ5NiwKICAgIG1heFVpbnQxMDQ6ICgpID0+IG1heFVpbnQxMDQsCiAgICBtYXhVaW50MTEyOiAoKSA9PiBtYXhVaW50MTEyLAogICAgbWF4VWludDEyMDogKCkgPT4gbWF4VWludDEyMCwKICAgIG1heFVpbnQxMjg6ICgpID0+IG1heFVpbnQxMjgsCiAgICBtYXhVaW50MTM2OiAoKSA9PiBtYXhVaW50MTM2LAogICAgbWF4VWludDE0NDogKCkgPT4gbWF4VWludDE0NCwKICAgIG1heFVpbnQxNTI6ICgpID0+IG1heFVpbnQxNTIsCiAgICBtYXhVaW50MTY6ICgpID0+IG1heFVpbnQxNiwKICAgIG1heFVpbnQxNjA6ICgpID0+IG1heFVpbnQxNjAsCiAgICBtYXhVaW50MTY4OiAoKSA9PiBtYXhVaW50MTY4LAogICAgbWF4VWludDE3NjogKCkgPT4gbWF4VWludDE3NiwKICAgIG1heFVpbnQxODQ6ICgpID0+IG1heFVpbnQxODQsCiAgICBtYXhVaW50MTkyOiAoKSA9PiBtYXhVaW50MTkyLAogICAgbWF4VWludDIwMDogKCkgPT4gbWF4VWludDIwMCwKICAgIG1heFVpbnQyMDg6ICgpID0+IG1heFVpbnQyMDgsCiAgICBtYXhVaW50MjE2OiAoKSA9PiBtYXhVaW50MjE2LAogICAgbWF4VWludDIyNDogKCkgPT4gbWF4VWludDIyNCwKICAgIG1heFVpbnQyMzI6ICgpID0+IG1heFVpbnQyMzIsCiAgICBtYXhVaW50MjQ6ICgpID0+IG1heFVpbnQyNCwKICAgIG1heFVpbnQyNDA6ICgpID0+IG1heFVpbnQyNDAsCiAgICBtYXhVaW50MjQ4OiAoKSA9PiBtYXhVaW50MjQ4LAogICAgbWF4VWludDI1NjogKCkgPT4gbWF4VWludDI1NiwKICAgIG1heFVpbnQzMjogKCkgPT4gbWF4VWludDMyLAogICAgbWF4VWludDQwOiAoKSA9PiBtYXhVaW50NDAsCiAgICBtYXhVaW50NDg6ICgpID0+IG1heFVpbnQ0OCwKICAgIG1heFVpbnQ1NjogKCkgPT4gbWF4VWludDU2LAogICAgbWF4VWludDY0OiAoKSA9PiBtYXhVaW50NjQsCiAgICBtYXhVaW50NzI6ICgpID0+IG1heFVpbnQ3MiwKICAgIG1heFVpbnQ4OiAoKSA9PiBtYXhVaW50OCwKICAgIG1heFVpbnQ4MDogKCkgPT4gbWF4VWludDgwLAogICAgbWF4VWludDg4OiAoKSA9PiBtYXhVaW50ODgsCiAgICBtYXhVaW50OTY6ICgpID0+IG1heFVpbnQ5NiwKICAgIG1pbkludDEwNDogKCkgPT4gbWluSW50MTA0LAogICAgbWluSW50MTEyOiAoKSA9PiBtaW5JbnQxMTIsCiAgICBtaW5JbnQxMjA6ICgpID0+IG1pbkludDEyMCwKICAgIG1pbkludDEyODogKCkgPT4gbWluSW50MTI4LAogICAgbWluSW50MTM2OiAoKSA9PiBtaW5JbnQxMzYsCiAgICBtaW5JbnQxNDQ6ICgpID0+IG1pbkludDE0NCwKICAgIG1pbkludDE1MjogKCkgPT4gbWluSW50MTUyLAogICAgbWluSW50MTY6ICgpID0+IG1pbkludDE2LAogICAgbWluSW50MTYwOiAoKSA9PiBtaW5JbnQxNjAsCiAgICBtaW5JbnQxNjg6ICgpID0+IG1pbkludDE2OCwKICAgIG1pbkludDE3NjogKCkgPT4gbWluSW50MTc2LAogICAgbWluSW50MTg0OiAoKSA9PiBtaW5JbnQxODQsCiAgICBtaW5JbnQxOTI6ICgpID0+IG1pbkludDE5MiwKICAgIG1pbkludDIwMDogKCkgPT4gbWluSW50MjAwLAogICAgbWluSW50MjA4OiAoKSA9PiBtaW5JbnQyMDgsCiAgICBtaW5JbnQyMTY6ICgpID0+IG1pbkludDIxNiwKICAgIG1pbkludDIyNDogKCkgPT4gbWluSW50MjI0LAogICAgbWluSW50MjMyOiAoKSA9PiBtaW5JbnQyMzIsCiAgICBtaW5JbnQyNDogKCkgPT4gbWluSW50MjQsCiAgICBtaW5JbnQyNDA6ICgpID0+IG1pbkludDI0MCwKICAgIG1pbkludDI0ODogKCkgPT4gbWluSW50MjQ4LAogICAgbWluSW50MjU2OiAoKSA9PiBtaW5JbnQyNTYsCiAgICBtaW5JbnQzMjogKCkgPT4gbWluSW50MzIsCiAgICBtaW5JbnQ0MDogKCkgPT4gbWluSW50NDAsCiAgICBtaW5JbnQ0ODogKCkgPT4gbWluSW50NDgsCiAgICBtaW5JbnQ1NjogKCkgPT4gbWluSW50NTYsCiAgICBtaW5JbnQ2NDogKCkgPT4gbWluSW50NjQsCiAgICBtaW5JbnQ3MjogKCkgPT4gbWluSW50NzIsCiAgICBtaW5JbnQ4OiAoKSA9PiBtaW5JbnQ4LAogICAgbWluSW50ODA6ICgpID0+IG1pbkludDgwLAogICAgbWluSW50ODg6ICgpID0+IG1pbkludDg4LAogICAgbWluSW50OTY6ICgpID0+IG1pbkludDk2LAogICAgbXVsdGljYWxsM0FiaTogKCkgPT4gbXVsdGljYWxsM0FiaSwKICAgIG5hbWVoYXNoOiAoKSA9PiBuYW1laGFzaCwKICAgIG5vbmNlTWFuYWdlcjogKCkgPT4gbm9uY2VNYW5hZ2VyLAogICAgbnVtYmVyVG9CeXRlczogKCkgPT4gbnVtYmVyVG9CeXRlcywKICAgIG51bWJlclRvSGV4OiAoKSA9PiBudW1iZXJUb0hleCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlLAogICAgcGFkOiAoKSA9PiBwYWQsCiAgICBwYWRCeXRlczogKCkgPT4gcGFkQnl0ZXMsCiAgICBwYWRIZXg6ICgpID0+IHBhZEhleCwKICAgIHBhcnNlQWJpOiAoKSA9PiBwYXJzZUFiaSwKICAgIHBhcnNlQWJpSXRlbTogKCkgPT4gcGFyc2VBYmlJdGVtLAogICAgcGFyc2VBYmlQYXJhbWV0ZXI6ICgpID0+IHBhcnNlQWJpUGFyYW1ldGVyMiwKICAgIHBhcnNlQWJpUGFyYW1ldGVyczogKCkgPT4gcGFyc2VBYmlQYXJhbWV0ZXJzLAogICAgcGFyc2VDb21wYWN0U2lnbmF0dXJlOiAoKSA9PiBwYXJzZUNvbXBhY3RTaWduYXR1cmUsCiAgICBwYXJzZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHBhcnNlRXJjNjQ5MlNpZ25hdHVyZSwKICAgIHBhcnNlRXRoZXI6ICgpID0+IHBhcnNlRXRoZXIsCiAgICBwYXJzZUV2ZW50TG9nczogKCkgPT4gcGFyc2VFdmVudExvZ3MsCiAgICBwYXJzZUd3ZWk6ICgpID0+IHBhcnNlR3dlaSwKICAgIHBhcnNlU2lnbmF0dXJlOiAoKSA9PiBwYXJzZVNpZ25hdHVyZTIsCiAgICBwYXJzZVRyYW5zYWN0aW9uOiAoKSA9PiBwYXJzZVRyYW5zYWN0aW9uLAogICAgcGFyc2VVbml0czogKCkgPT4gcGFyc2VVbml0cywKICAgIHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGEsCiAgICBwcmVzaWduTWVzc2FnZVByZWZpeDogKCkgPT4gcHJlc2lnbk1lc3NhZ2VQcmVmaXgsCiAgICBwdWJsaWNBY3Rpb25zOiAoKSA9PiBwdWJsaWNBY3Rpb25zLAogICAgcmVjb3ZlckFkZHJlc3M6ICgpID0+IHJlY292ZXJBZGRyZXNzLAogICAgcmVjb3Zlck1lc3NhZ2VBZGRyZXNzOiAoKSA9PiByZWNvdmVyTWVzc2FnZUFkZHJlc3MsCiAgICByZWNvdmVyUHVibGljS2V5OiAoKSA9PiByZWNvdmVyUHVibGljS2V5LAogICAgcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzczogKCkgPT4gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcywKICAgIHJlY292ZXJUeXBlZERhdGFBZGRyZXNzOiAoKSA9PiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcywKICAgIHJpcGVtZDE2MDogKCkgPT4gcmlwZW1kMTYwMiwKICAgIHJwY1NjaGVtYTogKCkgPT4gcnBjU2NoZW1hLAogICAgcnBjVHJhbnNhY3Rpb25UeXBlOiAoKSA9PiBycGNUcmFuc2FjdGlvblR5cGUsCiAgICBzZXJpYWxpemVBY2Nlc3NMaXN0OiAoKSA9PiBzZXJpYWxpemVBY2Nlc3NMaXN0LAogICAgc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUsCiAgICBzZXJpYWxpemVTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZVRyYW5zYWN0aW9uOiAoKSA9PiBzZXJpYWxpemVUcmFuc2FjdGlvbiwKICAgIHNlcmlhbGl6ZVR5cGVkRGF0YTogKCkgPT4gc2VyaWFsaXplVHlwZWREYXRhLAogICAgc2V0RXJyb3JDb25maWc6ICgpID0+IHNldEVycm9yQ29uZmlnLAogICAgc2V0dXBLemc6ICgpID0+IHNldHVwS3pnLAogICAgc2hhMjU2OiAoKSA9PiBzaGEyNTYyLAogICAgc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlczogKCkgPT4gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcywKICAgIHNpZ25hdHVyZVRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlLAogICAgc2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNpemU6ICgpID0+IHNpemUsCiAgICBzbGljZTogKCkgPT4gc2xpY2UsCiAgICBzbGljZUJ5dGVzOiAoKSA9PiBzbGljZUJ5dGVzLAogICAgc2xpY2VIZXg6ICgpID0+IHNsaWNlSGV4LAogICAgc3RyaW5nVG9CeXRlczogKCkgPT4gc3RyaW5nVG9CeXRlcywKICAgIHN0cmluZ1RvSGV4OiAoKSA9PiBzdHJpbmdUb0hleCwKICAgIHN0cmluZ2lmeTogKCkgPT4gc3RyaW5naWZ5LAogICAgdGVzdEFjdGlvbnM6ICgpID0+IHRlc3RBY3Rpb25zLAogICAgdG9CbG9iU2lkZWNhcnM6ICgpID0+IHRvQmxvYlNpZGVjYXJzLAogICAgdG9CbG9iczogKCkgPT4gdG9CbG9icywKICAgIHRvQnl0ZXM6ICgpID0+IHRvQnl0ZXMsCiAgICB0b0V2ZW50SGFzaDogKCkgPT4gdG9TaWduYXR1cmVIYXNoLAogICAgdG9FdmVudFNlbGVjdG9yOiAoKSA9PiB0b0V2ZW50U2VsZWN0b3IsCiAgICB0b0V2ZW50U2lnbmF0dXJlOiAoKSA9PiB0b1NpZ25hdHVyZSwKICAgIHRvRnVuY3Rpb25IYXNoOiAoKSA9PiB0b1NpZ25hdHVyZUhhc2gsCiAgICB0b0Z1bmN0aW9uU2VsZWN0b3I6ICgpID0+IHRvRnVuY3Rpb25TZWxlY3RvciwKICAgIHRvRnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgdG9IZXg6ICgpID0+IHRvSGV4LAogICAgdG9QcmVmaXhlZE1lc3NhZ2U6ICgpID0+IHRvUHJlZml4ZWRNZXNzYWdlLAogICAgdG9SbHA6ICgpID0+IHRvUmxwLAogICAgdHJhbnNhY3Rpb25UeXBlOiAoKSA9PiB0cmFuc2FjdGlvblR5cGUsCiAgICB0cmltOiAoKSA9PiB0cmltLAogICAgdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpOiAoKSA9PiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JBYmksCiAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZTogKCkgPT4gdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQnl0ZUNvZGUsCiAgICB2YWxpZGF0ZVR5cGVkRGF0YTogKCkgPT4gdmFsaWRhdGVUeXBlZERhdGEsCiAgICB2ZXJpZnlIYXNoOiAoKSA9PiB2ZXJpZnlIYXNoLAogICAgdmVyaWZ5TWVzc2FnZTogKCkgPT4gdmVyaWZ5TWVzc2FnZSwKICAgIHZlcmlmeVR5cGVkRGF0YTogKCkgPT4gdmVyaWZ5VHlwZWREYXRhLAogICAgd2FsbGV0QWN0aW9uczogKCkgPT4gd2FsbGV0QWN0aW9ucywKICAgIHdlYlNvY2tldDogKCkgPT4gd2ViU29ja2V0LAogICAgd2VpVW5pdHM6ICgpID0+IHdlaVVuaXRzLAogICAgd2l0aFJldHJ5OiAoKSA9PiB3aXRoUmV0cnksCiAgICB3aXRoVGltZW91dDogKCkgPT4gd2l0aFRpbWVvdXQsCiAgICB6ZXJvQWRkcmVzczogKCkgPT4gemVyb0FkZHJlc3MsCiAgICB6ZXJvSGFzaDogKCkgPT4gemVyb0hhc2gKICB9KTsKICBpbml0X2V4cG9ydHMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2dldEFjdGlvbi5qcwogIGZ1bmN0aW9uIGdldEFjdGlvbihjbGllbnQsIGFjdGlvbkZuLCBuYW1lKSB7CiAgICBjb25zdCBhY3Rpb25faW1wbGljaXQgPSBjbGllbnRbYWN0aW9uRm4ubmFtZV07CiAgICBpZiAodHlwZW9mIGFjdGlvbl9pbXBsaWNpdCA9PT0gImZ1bmN0aW9uIikKICAgICAgcmV0dXJuIGFjdGlvbl9pbXBsaWNpdDsKICAgIGNvbnN0IGFjdGlvbl9leHBsaWNpdCA9IGNsaWVudFtuYW1lXTsKICAgIGlmICh0eXBlb2YgYWN0aW9uX2V4cGxpY2l0ID09PSAiZnVuY3Rpb24iKQogICAgICByZXR1cm4gYWN0aW9uX2V4cGxpY2l0OwogICAgcmV0dXJuIChwYXJhbXMpID0+IGFjdGlvbkZuKGNsaWVudCwgcGFyYW1zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X2FiaSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2xvZy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICBzdXBlcihgRmlsdGVyIHR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQuYCwgewogICAgICAgIG5hbWU6ICJGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIGluaXRfZ2V0QWJpSXRlbSgpOwogIHZhciBkb2NzUGF0aCA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVFdmVudFRvcGljcyI7CiAgZnVuY3Rpb24gZW5jb2RlRXZlbnRUb3BpY3MocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGV2ZW50TmFtZSwgYXJncyB9ID0gcGFyYW1ldGVyczsKICAgIGxldCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGlmIChldmVudE5hbWUpIHsKICAgICAgY29uc3QgaXRlbSA9IGdldEFiaUl0ZW0oeyBhYmk6IGFiaTIsIG5hbWU6IGV2ZW50TmFtZSB9KTsKICAgICAgaWYgKCFpdGVtKQogICAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3IoZXZlbnROYW1lLCB7IGRvY3NQYXRoIH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoIH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9FdmVudFNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IHRvcGljcyA9IFtdOwogICAgaWYgKGFyZ3MgJiYgImlucHV0cyIgaW4gYWJpSXRlbSkgewogICAgICBjb25zdCBpbmRleGVkSW5wdXRzID0gYWJpSXRlbS5pbnB1dHM/LmZpbHRlcigocGFyYW0pID0+ICJpbmRleGVkIiBpbiBwYXJhbSAmJiBwYXJhbS5pbmRleGVkKTsKICAgICAgY29uc3QgYXJnc18gPSBBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGluZGV4ZWRJbnB1dHM/Lm1hcCgoeCkgPT4gYXJnc1t4Lm5hbWVdKSA/PyBbXSA6IFtdOwogICAgICBpZiAoYXJnc18ubGVuZ3RoID4gMCkgewogICAgICAgIHRvcGljcyA9IGluZGV4ZWRJbnB1dHM/Lm1hcCgocGFyYW0sIGkpID0+IHsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NfW2ldKSkKICAgICAgICAgICAgcmV0dXJuIGFyZ3NfW2ldLm1hcCgoXywgaikgPT4gZW5jb2RlQXJnKHsgcGFyYW0sIHZhbHVlOiBhcmdzX1tpXVtqXSB9KSk7CiAgICAgICAgICByZXR1cm4gYXJnc19baV0gPyBlbmNvZGVBcmcoeyBwYXJhbSwgdmFsdWU6IGFyZ3NfW2ldIH0pIDogbnVsbDsKICAgICAgICB9KSA/PyBbXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIFtzaWduYXR1cmUsIC4uLnRvcGljc107CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFyZyh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInN0cmluZyIgfHwgcGFyYW0udHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGtlY2NhazI1Nih0b0J5dGVzKHZhbHVlKSk7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInR1cGxlIiB8fCBwYXJhbS50eXBlLm1hdGNoKC9eKC4qKVxbKFxkKyk/XF0kLykpCiAgICAgIHRocm93IG5ldyBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IocGFyYW0udHlwZSk7CiAgICByZXR1cm4gZW5jb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCBbdmFsdWVdKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZmlsdGVycy9jcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUuanMKICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7IG1ldGhvZCB9KSB7CiAgICBjb25zdCByZXF1ZXN0TWFwID0ge307CiAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siKQogICAgICBjbGllbnQudHJhbnNwb3J0Lm9uUmVzcG9uc2U/LigoeyBtZXRob2Q6IG1ldGhvZF8sIHJlc3BvbnNlOiBpZCwgc3RhdHVzLCB0cmFuc3BvcnQgfSkgPT4gewogICAgICAgIGlmIChzdGF0dXMgPT09ICJzdWNjZXNzIiAmJiBtZXRob2QgPT09IG1ldGhvZF8pCiAgICAgICAgICByZXF1ZXN0TWFwW2lkXSA9IHRyYW5zcG9ydC5yZXF1ZXN0OwogICAgICB9KTsKICAgIHJldHVybiAoaWQpID0+IHJlcXVlc3RNYXBbaWRdIHx8IGNsaWVudC5yZXF1ZXN0OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBhYmk6IGFiaTIsIGFyZ3MsIGV2ZW50TmFtZSwgZnJvbUJsb2NrLCBzdHJpY3QsIHRvQmxvY2sgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIgogICAgfSk7CiAgICBjb25zdCB0b3BpY3MgPSBldmVudE5hbWUgPyBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lCiAgICB9KSA6IHZvaWQgMDsKICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgdG9waWNzCiAgICAgICAgfQogICAgICBdCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lLAogICAgICBpZCwKICAgICAgcmVxdWVzdDogZ2V0UmVxdWVzdChpZCksCiAgICAgIHN0cmljdDogQm9vbGVhbihzdHJpY3QpLAogICAgICB0eXBlOiAiZXZlbnQiCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlQ29udHJhY3RHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q29udHJhY3RFcnJvci5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGluaXRfcnBjKCk7CiAgdmFyIEVYRUNVVElPTl9SRVZFUlRFRF9FUlJPUl9DT0RFID0gMzsKICBmdW5jdGlvbiBnZXRDb250cmFjdEVycm9yKGVyciwgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGZ1bmN0aW9uTmFtZSwgc2VuZGVyIH0pIHsKICAgIGNvbnN0IHsgY29kZSwgZGF0YSwgbWVzc2FnZSwgc2hvcnRNZXNzYWdlIH0gPSBlcnIgaW5zdGFuY2VvZiBSYXdDb250cmFjdEVycm9yID8gZXJyIDogZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMiA/IGVyci53YWxrKChlcnIyKSA9PiAiZGF0YSIgaW4gZXJyMikgfHwgZXJyLndhbGsoKSA6IHt9OwogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKQogICAgICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IoeyBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmIChbRVhFQ1VUSU9OX1JFVkVSVEVEX0VSUk9SX0NPREUsIEludGVybmFsUnBjRXJyb3IuY29kZV0uaW5jbHVkZXMoY29kZSkgJiYgKGRhdGEgfHwgbWVzc2FnZSB8fCBzaG9ydE1lc3NhZ2UpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICBkYXRhOiB0eXBlb2YgZGF0YSA9PT0gIm9iamVjdCIgPyBkYXRhLmRhdGEgOiBkYXRhLAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgbWVzc2FnZTogc2hvcnRNZXNzYWdlID8/IG1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gZXJyOwogICAgfSkoKTsKICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgY29udHJhY3RBZGRyZXNzOiBhZGRyZXNzLAogICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICBmdW5jdGlvbk5hbWUsCiAgICAgIHNlbmRlcgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZXN0aW1hdGVHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfYmFzZSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcHVibGljS2V5VG9BZGRyZXNzLmpzCiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBmdW5jdGlvbiBwdWJsaWNLZXlUb0FkZHJlc3MocHVibGljS2V5KSB7CiAgICBjb25zdCBhZGRyZXNzID0ga2VjY2FrMjU2KGAweCR7cHVibGljS2V5LnN1YnN0cmluZyg0KX1gKS5zdWJzdHJpbmcoMjYpOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhgMHgke2FkZHJlc3N9YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3JlY292ZXJQdWJsaWNLZXkuanMKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJQdWJsaWNLZXkoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pIHsKICAgIGNvbnN0IGhhc2hIZXggPSBpc0hleChoYXNoMykgPyBoYXNoMyA6IHRvSGV4KGhhc2gzKTsKICAgIGNvbnN0IHsgc2VjcDI1NmsxOiBzZWNwMjU2azEyIH0gPSBhd2FpdCBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IChpbml0X3NlY3AyNTZrMSgpLCBzZWNwMjU2azFfZXhwb3J0cykpOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9ICgoKSA9PiB7CiAgICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlID09PSAib2JqZWN0IiAmJiAiciIgaW4gc2lnbmF0dXJlICYmICJzIiBpbiBzaWduYXR1cmUpIHsKICAgICAgICBjb25zdCB7IHIsIHMsIHYsIHlQYXJpdHkgfSA9IHNpZ25hdHVyZTsKICAgICAgICBjb25zdCB5UGFyaXR5T3JWMiA9IE51bWJlcih5UGFyaXR5ID8/IHYpOwogICAgICAgIGNvbnN0IHJlY292ZXJ5Qml0MiA9IHRvUmVjb3ZlcnlCaXQoeVBhcml0eU9yVjIpOwogICAgICAgIHJldHVybiBuZXcgc2VjcDI1NmsxMi5TaWduYXR1cmUoaGV4VG9CaWdJbnQociksIGhleFRvQmlnSW50KHMpKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdDIpOwogICAgICB9CiAgICAgIGNvbnN0IHNpZ25hdHVyZUhleCA9IGlzSGV4KHNpZ25hdHVyZSkgPyBzaWduYXR1cmUgOiB0b0hleChzaWduYXR1cmUpOwogICAgICBjb25zdCB5UGFyaXR5T3JWID0gaGV4VG9OdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgICAgY29uc3QgcmVjb3ZlcnlCaXQgPSB0b1JlY292ZXJ5Qml0KHlQYXJpdHlPclYpOwogICAgICByZXR1cm4gc2VjcDI1NmsxMi5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnN1YnN0cmluZygyLCAxMzApKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdCk7CiAgICB9KSgpOwogICAgY29uc3QgcHVibGljS2V5ID0gc2lnbmF0dXJlXy5yZWNvdmVyUHVibGljS2V5KGhhc2hIZXguc3Vic3RyaW5nKDIpKS50b0hleChmYWxzZSk7CiAgICByZXR1cm4gYDB4JHtwdWJsaWNLZXl9YDsKICB9CiAgZnVuY3Rpb24gdG9SZWNvdmVyeUJpdCh5UGFyaXR5T3JWKSB7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMCB8fCB5UGFyaXR5T3JWID09PSAxKQogICAgICByZXR1cm4geVBhcml0eU9yVjsKICAgIGlmICh5UGFyaXR5T3JWID09PSAyNykKICAgICAgcmV0dXJuIDA7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgIHJldHVybiAxOwogICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHlQYXJpdHlPclYgdmFsdWUiKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlckFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyQWRkcmVzcyh7IGhhc2g6IGhhc2gzLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHB1YmxpY0tleVRvQWRkcmVzcyhhd2FpdCByZWNvdmVyUHVibGljS2V5KHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvUmxwLmpzCiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jdXJzb3IyKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUmxwKGJ5dGVzMiwgdG8gPSAiaGV4IikgewogICAgY29uc3QgZW5jb2RhYmxlID0gZ2V0RW5jb2RhYmxlKGJ5dGVzMik7CiAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkoZW5jb2RhYmxlLmxlbmd0aCkpOwogICAgZW5jb2RhYmxlLmVuY29kZShjdXJzb3IpOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKTsKICAgIHJldHVybiBjdXJzb3IuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9SbHAoYnl0ZXMyLCB0byA9ICJieXRlcyIpIHsKICAgIHJldHVybiB0b1JscChieXRlczIsIHRvKTsKICB9CiAgZnVuY3Rpb24gaGV4VG9SbHAoaGV4LCB0byA9ICJoZXgiKSB7CiAgICByZXR1cm4gdG9SbHAoaGV4LCB0byk7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZShieXRlczIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGJ5dGVzMikpCiAgICAgIHJldHVybiBnZXRFbmNvZGFibGVMaXN0KGJ5dGVzMi5tYXAoKHgpID0+IGdldEVuY29kYWJsZSh4KSkpOwogICAgcmV0dXJuIGdldEVuY29kYWJsZUJ5dGVzKGJ5dGVzMik7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZUxpc3QobGlzdCkgewogICAgY29uc3QgYm9keUxlbmd0aCA9IGxpc3QucmVkdWNlKChhY2MsIHgpID0+IGFjYyArIHgubGVuZ3RoLCAwKTsKICAgIGNvbnN0IHNpemVPZkJvZHlMZW5ndGggPSBnZXRTaXplT2ZMZW5ndGgoYm9keUxlbmd0aCk7CiAgICBjb25zdCBsZW5ndGggPSAoKCkgPT4gewogICAgICBpZiAoYm9keUxlbmd0aCA8PSA1NSkKICAgICAgICByZXR1cm4gMSArIGJvZHlMZW5ndGg7CiAgICAgIHJldHVybiAxICsgc2l6ZU9mQm9keUxlbmd0aCArIGJvZHlMZW5ndGg7CiAgICB9KSgpOwogICAgcmV0dXJuIHsKICAgICAgbGVuZ3RoLAogICAgICBlbmNvZGUoY3Vyc29yKSB7CiAgICAgICAgaWYgKGJvZHlMZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxOTIgKyBib2R5TGVuZ3RoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDE5MiArIDU1ICsgc2l6ZU9mQm9keUxlbmd0aCk7CiAgICAgICAgICBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMSkKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50OChib2R5TGVuZ3RoKTsKICAgICAgICAgIGVsc2UgaWYgKHNpemVPZkJvZHlMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJvZHlMZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMykKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50MjQoYm9keUxlbmd0aCk7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDMyKGJvZHlMZW5ndGgpOwogICAgICAgIH0KICAgICAgICBmb3IgKGNvbnN0IHsgZW5jb2RlOiBlbmNvZGUyIH0gb2YgbGlzdCkgewogICAgICAgICAgZW5jb2RlMihjdXJzb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gZ2V0RW5jb2RhYmxlQnl0ZXMoYnl0ZXNPckhleCkgewogICAgY29uc3QgYnl0ZXMyID0gdHlwZW9mIGJ5dGVzT3JIZXggPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhieXRlc09ySGV4KSA6IGJ5dGVzT3JIZXg7CiAgICBjb25zdCBzaXplT2ZCeXRlc0xlbmd0aCA9IGdldFNpemVPZkxlbmd0aChieXRlczIubGVuZ3RoKTsKICAgIGNvbnN0IGxlbmd0aCA9ICgoKSA9PiB7CiAgICAgIGlmIChieXRlczIubGVuZ3RoID09PSAxICYmIGJ5dGVzMlswXSA8IDEyOCkKICAgICAgICByZXR1cm4gMTsKICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpCiAgICAgICAgcmV0dXJuIDEgKyBieXRlczIubGVuZ3RoOwogICAgICByZXR1cm4gMSArIHNpemVPZkJ5dGVzTGVuZ3RoICsgYnl0ZXMyLmxlbmd0aDsKICAgIH0pKCk7CiAgICByZXR1cm4gewogICAgICBsZW5ndGgsCiAgICAgIGVuY29kZShjdXJzb3IpIHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCA9PT0gMSAmJiBieXRlczJbMF0gPCAxMjgpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxMjggKyBieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDEyOCArIDU1ICsgc2l6ZU9mQnl0ZXNMZW5ndGgpOwogICAgICAgICAgaWYgKHNpemVPZkJ5dGVzTGVuZ3RoID09PSAxKQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQ4KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDMpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDI0KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQzMihieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldFNpemVPZkxlbmd0aChsZW5ndGgpIHsKICAgIGlmIChsZW5ndGggPCAyICoqIDgpCiAgICAgIHJldHVybiAxOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMTYpCiAgICAgIHJldHVybiAyOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMjQpCiAgICAgIHJldHVybiAzOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMzIpCiAgICAgIHJldHVybiA0OwogICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkxlbmd0aCBpcyB0b28gbGFyZ2UuIik7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hBdXRob3JpemF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgdG8gfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1Nihjb25jYXRIZXgoWwogICAgICAiMHgwNSIsCiAgICAgIHRvUmxwKFsKICAgICAgICBjaGFpbklkID8gbnVtYmVyVG9IZXgoY2hhaW5JZCkgOiAiMHgiLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZSA/IG51bWJlclRvSGV4KG5vbmNlKSA6ICIweCIKICAgICAgXSkKICAgIF0pKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGhleFRvQnl0ZXMoaGFzaDMpOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2V4cGVyaW1lbnRhbC9laXA3NzAyL3V0aWxzL3JlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGF1dGhvcml6YXRpb24sIHNpZ25hdHVyZSB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiByZWNvdmVyQWRkcmVzcyh7CiAgICAgIGhhc2g6IGhhc2hBdXRob3JpemF0aW9uKGF1dGhvcml6YXRpb24pLAogICAgICBzaWduYXR1cmU6IHNpZ25hdHVyZSA/PyBhdXRob3JpemF0aW9uCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfZm9ybWF0RXRoZXIoKTsKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X3RyYW5zYWN0aW9uKCk7CiAgdmFyIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoY2F1c2UsIHsgYWNjb3VudCwgZG9jc1BhdGg6IGRvY3NQYXRoOSwgY2hhaW4sIGRhdGEsIGdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG5vbmNlLCB0bywgdmFsdWUgfSkgewogICAgICBjb25zdCBwcmV0dHlBcmdzID0gcHJldHR5UHJpbnQoewogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgdG8sCiAgICAgICAgdmFsdWU6IHR5cGVvZiB2YWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0RXRoZXIodmFsdWUpfSAke2NoYWluPy5uYXRpdmVDdXJyZW5jeT8uc3ltYm9sIHx8ICJFVEgifWAsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2U6IHR5cGVvZiBnYXNQcmljZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShnYXNQcmljZSl9IGd3ZWlgLAogICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgbm9uY2UKICAgICAgfSk7CiAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgIGNhdXNlLAogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAiRXN0aW1hdGUgR2FzIEFyZ3VtZW50czoiLAogICAgICAgICAgcHJldHR5QXJncwogICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgIG5hbWU6ICJFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yIgogICAgICB9KTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXRFc3RpbWF0ZUdhc0Vycm9yLmpzCiAgaW5pdF9ub2RlKCk7CiAgaW5pdF9nZXROb2RlRXJyb3IoKTsKICBmdW5jdGlvbiBnZXRFc3RpbWF0ZUdhc0Vycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgIC4uLmFyZ3MKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlR2FzLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUyKCk7CiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9wcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9mZWUuanMKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICB2YXIgQmFzZUZlZVNjYWxhckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiYGJhc2VGZWVNdWx0aXBsaWVyYCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxLiIsIHsKICAgICAgICBuYW1lOiAiQmFzZUZlZVNjYWxhckVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQ2hhaW4gZG9lcyBub3Qgc3VwcG9ydCBFSVAtMTU1OSBmZWVzLiIsIHsKICAgICAgICBuYW1lOiAiRWlwMTU1OUZlZXNOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKICB2YXIgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhQcmlvcml0eUZlZVBlckdhcyB9KSB7CiAgICAgIHN1cGVyKGBcYG1heEZlZVBlckdhc1xgIGNhbm5vdCBiZSBsZXNzIHRoYW4gdGhlIFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCAoJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaSkuYCwgeyBuYW1lOiAiTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvY2suanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQmxvY2tOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgYmxvY2tIYXNoLCBibG9ja051bWJlciB9KSB7CiAgICAgIGxldCBpZGVudGlmaWVyID0gIkJsb2NrIjsKICAgICAgaWYgKGJsb2NrSGFzaCkKICAgICAgICBpZGVudGlmaWVyID0gYEJsb2NrIGF0IGhhc2ggIiR7YmxvY2tIYXNofSJgOwogICAgICBpZiAoYmxvY2tOdW1iZXIpCiAgICAgICAgaWRlbnRpZmllciA9IGBCbG9jayBhdCBudW1iZXIgIiR7YmxvY2tOdW1iZXJ9ImA7CiAgICAgIHN1cGVyKGAke2lkZW50aWZpZXJ9IGNvdWxkIG5vdCBiZSBmb3VuZC5gLCB7IG5hbWU6ICJCbG9ja05vdEZvdW5kRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9jay5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvYmxvY2suanMKICBpbml0X2Zvcm1hdHRlcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvbi5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZm9ybWF0dGVyKCk7CiAgdmFyIHRyYW5zYWN0aW9uVHlwZSA9IHsKICAgICIweDAiOiAibGVnYWN5IiwKICAgICIweDEiOiAiZWlwMjkzMCIsCiAgICAiMHgyIjogImVpcDE1NTkiLAogICAgIjB4MyI6ICJlaXA0ODQ0IiwKICAgICIweDQiOiAiZWlwNzcwMiIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbl8gPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICBibG9ja0hhc2g6IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA/IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA6IG51bGwsCiAgICAgIGJsb2NrTnVtYmVyOiB0cmFuc2FjdGlvbi5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvbi5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBjaGFpbklkOiB0cmFuc2FjdGlvbi5jaGFpbklkID8gaGV4VG9OdW1iZXIodHJhbnNhY3Rpb24uY2hhaW5JZCkgOiB2b2lkIDAsCiAgICAgIGdhczogdHJhbnNhY3Rpb24uZ2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLmdhcykgOiB2b2lkIDAsCiAgICAgIGdhc1ByaWNlOiB0cmFuc2FjdGlvbi5nYXNQcmljZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi5nYXNQcmljZSkgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckJsb2JHYXM6IHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPyBCaWdJbnQodHJhbnNhY3Rpb24ubWF4RmVlUGVyQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckdhczogdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA/IEJpZ0ludCh0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG5vbmNlOiB0cmFuc2FjdGlvbi5ub25jZSA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uLm5vbmNlKSA6IHZvaWQgMCwKICAgICAgdG86IHRyYW5zYWN0aW9uLnRvID8gdHJhbnNhY3Rpb24udG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvbi50cmFuc2FjdGlvbkluZGV4ID8gTnVtYmVyKHRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgdHlwZTogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uVHlwZVt0cmFuc2FjdGlvbi50eXBlXSA6IHZvaWQgMCwKICAgICAgdHlwZUhleDogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uLnR5cGUgOiB2b2lkIDAsCiAgICAgIHZhbHVlOiB0cmFuc2FjdGlvbi52YWx1ZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi52YWx1ZSkgOiB2b2lkIDAsCiAgICAgIHY6IHRyYW5zYWN0aW9uLnYgPyBCaWdJbnQodHJhbnNhY3Rpb24udikgOiB2b2lkIDAKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb24uYXV0aG9yaXphdGlvbkxpc3QpCiAgICAgIHRyYW5zYWN0aW9uXy5hdXRob3JpemF0aW9uTGlzdCA9IGZvcm1hdEF1dGhvcml6YXRpb25MaXN0Mih0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCk7CiAgICB0cmFuc2FjdGlvbl8ueVBhcml0eSA9ICgoKSA9PiB7CiAgICAgIGlmICh0cmFuc2FjdGlvbi55UGFyaXR5KQogICAgICAgIHJldHVybiBOdW1iZXIodHJhbnNhY3Rpb24ueVBhcml0eSk7CiAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb25fLnYgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAwbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjduKQogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAxbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjhuKQogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID49IDM1bikKICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbl8udiAlIDJuID09PSAwbiA/IDEgOiAwOwogICAgICB9CiAgICAgIHJldHVybiB2b2lkIDA7CiAgICB9KSgpOwogICAgaWYgKHRyYW5zYWN0aW9uXy50eXBlID09PSAibGVnYWN5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLmFjY2Vzc0xpc3Q7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ueVBhcml0eTsKICAgIH0KICAgIGlmICh0cmFuc2FjdGlvbl8udHlwZSA9PT0gImVpcDI5MzAiKSB7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICB9CiAgICBpZiAodHJhbnNhY3Rpb25fLnR5cGUgPT09ICJlaXAxNTU5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLm1heEZlZVBlckJsb2JHYXM7CiAgICB9CiAgICByZXR1cm4gdHJhbnNhY3Rpb25fOwogIH0KICB2YXIgZGVmaW5lVHJhbnNhY3Rpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJ0cmFuc2FjdGlvbiIsIGZvcm1hdFRyYW5zYWN0aW9uKTsKICBmdW5jdGlvbiBmb3JtYXRBdXRob3JpemF0aW9uTGlzdDIoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGNvbnRyYWN0QWRkcmVzczogYXV0aG9yaXphdGlvbi5hZGRyZXNzLAogICAgICBjaGFpbklkOiBOdW1iZXIoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IE51bWJlcihhdXRob3JpemF0aW9uLm5vbmNlKSwKICAgICAgcjogYXV0aG9yaXphdGlvbi5yLAogICAgICBzOiBhdXRob3JpemF0aW9uLnMsCiAgICAgIHlQYXJpdHk6IE51bWJlcihhdXRob3JpemF0aW9uLnlQYXJpdHkpCiAgICB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9ibG9jay5qcwogIGZ1bmN0aW9uIGZvcm1hdEJsb2NrKGJsb2NrKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBibG9jay50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbiA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICByZXR1cm4gZm9ybWF0VHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICAuLi5ibG9jaywKICAgICAgYmFzZUZlZVBlckdhczogYmxvY2suYmFzZUZlZVBlckdhcyA/IEJpZ0ludChibG9jay5iYXNlRmVlUGVyR2FzKSA6IG51bGwsCiAgICAgIGJsb2JHYXNVc2VkOiBibG9jay5ibG9iR2FzVXNlZCA/IEJpZ0ludChibG9jay5ibG9iR2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGRpZmZpY3VsdHk6IGJsb2NrLmRpZmZpY3VsdHkgPyBCaWdJbnQoYmxvY2suZGlmZmljdWx0eSkgOiB2b2lkIDAsCiAgICAgIGV4Y2Vzc0Jsb2JHYXM6IGJsb2NrLmV4Y2Vzc0Jsb2JHYXMgPyBCaWdJbnQoYmxvY2suZXhjZXNzQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIGdhc0xpbWl0OiBibG9jay5nYXNMaW1pdCA/IEJpZ0ludChibG9jay5nYXNMaW1pdCkgOiB2b2lkIDAsCiAgICAgIGdhc1VzZWQ6IGJsb2NrLmdhc1VzZWQgPyBCaWdJbnQoYmxvY2suZ2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGhhc2g6IGJsb2NrLmhhc2ggPyBibG9jay5oYXNoIDogbnVsbCwKICAgICAgbG9nc0Jsb29tOiBibG9jay5sb2dzQmxvb20gPyBibG9jay5sb2dzQmxvb20gOiBudWxsLAogICAgICBub25jZTogYmxvY2subm9uY2UgPyBibG9jay5ub25jZSA6IG51bGwsCiAgICAgIG51bWJlcjogYmxvY2subnVtYmVyID8gQmlnSW50KGJsb2NrLm51bWJlcikgOiBudWxsLAogICAgICBzaXplOiBibG9jay5zaXplID8gQmlnSW50KGJsb2NrLnNpemUpIDogdm9pZCAwLAogICAgICB0aW1lc3RhbXA6IGJsb2NrLnRpbWVzdGFtcCA/IEJpZ0ludChibG9jay50aW1lc3RhbXApIDogdm9pZCAwLAogICAgICB0cmFuc2FjdGlvbnMsCiAgICAgIHRvdGFsRGlmZmljdWx0eTogYmxvY2sudG90YWxEaWZmaWN1bHR5ID8gQmlnSW50KGJsb2NrLnRvdGFsRGlmZmljdWx0eSkgOiBudWxsCiAgICB9OwogIH0KICB2YXIgZGVmaW5lQmxvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJibG9jayIsIGZvcm1hdEJsb2NrKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2soY2xpZW50LCB7IGJsb2NrSGFzaCwgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gPz8gImxhdGVzdCI7CiAgICBjb25zdCBpbmNsdWRlVHJhbnNhY3Rpb25zID0gaW5jbHVkZVRyYW5zYWN0aW9uc18gPz8gZmFsc2U7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgYmxvY2sgPSBudWxsOwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeUhhc2giLAogICAgICAgIHBhcmFtczogW2Jsb2NrSGFzaCwgaW5jbHVkZVRyYW5zYWN0aW9uc10KICAgICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICB9IGVsc2UgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeU51bWJlciIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcsIGluY2x1ZGVUcmFuc2FjdGlvbnNdCiAgICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIH0KICAgIGlmICghYmxvY2spCiAgICAgIHRocm93IG5ldyBCbG9ja05vdEZvdW5kRXJyb3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyIH0pOwogICAgY29uc3QgZm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy5ibG9jaz8uZm9ybWF0IHx8IGZvcm1hdEJsb2NrOwogICAgcmV0dXJuIGZvcm1hdChibG9jayk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0R2FzUHJpY2UuanMKICBhc3luYyBmdW5jdGlvbiBnZXRHYXNQcmljZShjbGllbnQpIHsKICAgIGNvbnN0IGdhc1ByaWNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2FzUHJpY2UiCiAgICB9KTsKICAgIHJldHVybiBCaWdJbnQoZ2FzUHJpY2UpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMuanMKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgcmV0dXJuIGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYmxvY2s6IGJsb2NrXywgY2hhaW4gPSBjbGllbnQuY2hhaW4sIHJlcXVlc3QgfSA9IGFyZ3MgfHwge307CiAgICB0cnkgewogICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhcyA9IGNoYWluPy5mZWVzPy5tYXhQcmlvcml0eUZlZVBlckdhcyA/PyBjaGFpbj8uZmVlcz8uZGVmYXVsdFByaW9yaXR5RmVlOwogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29uc3QgYmxvY2sgPSBibG9ja18gfHwgYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhc18gPSBhd2FpdCBtYXhQcmlvcml0eUZlZVBlckdhcyh7CiAgICAgICAgICBibG9jaywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgICBpZiAobWF4UHJpb3JpdHlGZWVQZXJHYXNfID09PSBudWxsKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7CiAgICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzXzsKICAgICAgfQogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gbWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGNvbnN0IG1heFByaW9yaXR5RmVlUGVyR2FzSGV4ID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9tYXhQcmlvcml0eUZlZVBlckdhcyIKICAgICAgfSk7CiAgICAgIHJldHVybiBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhc0hleCk7CiAgICB9IGNhdGNoIHsKICAgICAgY29uc3QgW2Jsb2NrLCBnYXNQcmljZV0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgYmxvY2tfID8gUHJvbWlzZS5yZXNvbHZlKGJsb2NrXykgOiBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoe30pLAogICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEdhc1ByaWNlLCAiZ2V0R2FzUHJpY2UiKSh7fSkKICAgICAgXSk7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBnYXNQcmljZSAtIGJsb2NrLmJhc2VGZWVQZXJHYXM7CiAgICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyA8IDBuKQogICAgICAgIHJldHVybiAwbjsKICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlRmVlc1Blckdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIHJldHVybiBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVGZWVzUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBibG9jazogYmxvY2tfLCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgcmVxdWVzdCwgdHlwZSA9ICJlaXAxNTU5IiB9ID0gYXJncyB8fCB7fTsKICAgIGNvbnN0IGJhc2VGZWVNdWx0aXBsaWVyID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBjaGFpbj8uZmVlcz8uYmFzZUZlZU11bHRpcGxpZXIgPT09ICJmdW5jdGlvbiIpCiAgICAgICAgcmV0dXJuIGNoYWluLmZlZXMuYmFzZUZlZU11bHRpcGxpZXIoewogICAgICAgICAgYmxvY2s6IGJsb2NrXywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgcmV0dXJuIGNoYWluPy5mZWVzPy5iYXNlRmVlTXVsdGlwbGllciA/PyAxLjI7CiAgICB9KSgpOwogICAgaWYgKGJhc2VGZWVNdWx0aXBsaWVyIDwgMSkKICAgICAgdGhyb3cgbmV3IEJhc2VGZWVTY2FsYXJFcnJvcigpOwogICAgY29uc3QgZGVjaW1hbHMgPSBiYXNlRmVlTXVsdGlwbGllci50b1N0cmluZygpLnNwbGl0KCIuIilbMV0/Lmxlbmd0aCA/PyAwOwogICAgY29uc3QgZGVub21pbmF0b3IgPSAxMCAqKiBkZWNpbWFsczsKICAgIGNvbnN0IG11bHRpcGx5ID0gKGJhc2UyKSA9PiBiYXNlMiAqIEJpZ0ludChNYXRoLmNlaWwoYmFzZUZlZU11bHRpcGxpZXIgKiBkZW5vbWluYXRvcikpIC8gQmlnSW50KGRlbm9taW5hdG9yKTsKICAgIGNvbnN0IGJsb2NrID0gYmxvY2tfID8gYmxvY2tfIDogYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgIGlmICh0eXBlb2YgY2hhaW4/LmZlZXM/LmVzdGltYXRlRmVlc1BlckdhcyA9PT0gImZ1bmN0aW9uIikgewogICAgICBjb25zdCBmZWVzMiA9IGF3YWl0IGNoYWluLmZlZXMuZXN0aW1hdGVGZWVzUGVyR2FzKHsKICAgICAgICBibG9jazogYmxvY2tfLAogICAgICAgIGNsaWVudCwKICAgICAgICBtdWx0aXBseSwKICAgICAgICByZXF1ZXN0LAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICAgIGlmIChmZWVzMiAhPT0gbnVsbCkKICAgICAgICByZXR1cm4gZmVlczI7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSB0eXBlb2YgcmVxdWVzdD8ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPT09ICJiaWdpbnQiID8gcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA6IGF3YWl0IGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgYmxvY2ssCiAgICAgICAgY2hhaW4sCiAgICAgICAgcmVxdWVzdAogICAgICB9KTsKICAgICAgY29uc3QgYmFzZUZlZVBlckdhcyA9IG11bHRpcGx5KGJsb2NrLmJhc2VGZWVQZXJHYXMpOwogICAgICBjb25zdCBtYXhGZWVQZXJHYXMgPSByZXF1ZXN0Py5tYXhGZWVQZXJHYXMgPz8gYmFzZUZlZVBlckdhcyArIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICByZXR1cm4gewogICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfQogICAgY29uc3QgZ2FzUHJpY2UgPSByZXF1ZXN0Py5nYXNQcmljZSA/PyBtdWx0aXBseShhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRHYXNQcmljZSwgImdldEdhc1ByaWNlIikoe30pKTsKICAgIHJldHVybiB7CiAgICAgIGdhc1ByaWNlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25Db3VudChjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYmxvY2tOdW1iZXIgfSkgewogICAgY29uc3QgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkNvdW50IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVyKSB9KTsKICAgIHJldHVybiBoZXhUb051bWJlcihjb3VudCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9ibG9ic1RvQ29tbWl0bWVudHMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb0NvbW1pdG1lbnRzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsga3pnIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdG8gPSBwYXJhbWV0ZXJzLnRvID8/ICh0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgYmxvYnMgPSB0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyBwYXJhbWV0ZXJzLmJsb2JzLm1hcCgoeCkgPT4gaGV4VG9CeXRlcyh4KSkgOiBwYXJhbWV0ZXJzLmJsb2JzOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykKICAgICAgY29tbWl0bWVudHMucHVzaChVaW50OEFycmF5LmZyb20oa3pnLmJsb2JUb0t6Z0NvbW1pdG1lbnQoYmxvYikpKTsKICAgIHJldHVybiB0byA9PT0gImJ5dGVzIiA/IGNvbW1pdG1lbnRzIDogY29tbWl0bWVudHMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2Jsb2JzVG9Qcm9vZnMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb1Byb29mcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGt6ZyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGNvbW1pdG1lbnRzID0gdHlwZW9mIHBhcmFtZXRlcnMuY29tbWl0bWVudHNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5jb21taXRtZW50cy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5jb21taXRtZW50czsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9icy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBibG9iID0gYmxvYnNbaV07CiAgICAgIGNvbnN0IGNvbW1pdG1lbnQgPSBjb21taXRtZW50c1tpXTsKICAgICAgcHJvb2ZzLnB1c2goVWludDhBcnJheS5mcm9tKGt6Zy5jb21wdXRlQmxvYkt6Z1Byb29mKGJsb2IsIGNvbW1pdG1lbnQpKSk7CiAgICB9CiAgICByZXR1cm4gdG8gPT09ICJieXRlcyIgPyBwcm9vZnMgOiBwcm9vZnMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2NvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2guanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3NoYTI1Ni5qcwogIGluaXRfc2hhMjU2KCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBzaGEyNTYyKHZhbHVlLCB0b18pIHsKICAgIGNvbnN0IHRvID0gdG9fIHx8ICJoZXgiOwogICAgY29uc3QgYnl0ZXMyID0gc2hhMjU2KGlzSGV4KHZhbHVlLCB7IHN0cmljdDogZmFsc2UgfSkgPyB0b0J5dGVzKHZhbHVlKSA6IHZhbHVlKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGJ5dGVzMjsKICAgIHJldHVybiB0b0hleChieXRlczIpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaC5qcwogIGZ1bmN0aW9uIGNvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2gocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb21taXRtZW50LCB2ZXJzaW9uOiB2ZXJzaW9uMyA9IDEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0byA9IHBhcmFtZXRlcnMudG8gPz8gKHR5cGVvZiBjb21taXRtZW50ID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCB2ZXJzaW9uZWRIYXNoID0gc2hhMjU2Mihjb21taXRtZW50LCAiYnl0ZXMiKTsKICAgIHZlcnNpb25lZEhhc2guc2V0KFt2ZXJzaW9uM10sIDApOwogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gdmVyc2lvbmVkSGFzaCA6IGJ5dGVzVG9IZXgodmVyc2lvbmVkSGFzaCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9jb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gY29tbWl0bWVudHNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGNvbW1pdG1lbnRzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIGNvbW1pdG1lbnRzWzBdID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCBoYXNoZXMgPSBbXTsKICAgIGZvciAoY29uc3QgY29tbWl0bWVudCBvZiBjb21taXRtZW50cykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2Jsb2IuanMKICB2YXIgYmxvYnNQZXJUcmFuc2FjdGlvbiA9IDY7CiAgdmFyIGJ5dGVzUGVyRmllbGRFbGVtZW50ID0gMzI7CiAgdmFyIGZpZWxkRWxlbWVudHNQZXJCbG9iID0gNDA5NjsKICB2YXIgYnl0ZXNQZXJCbG9iID0gYnl0ZXNQZXJGaWVsZEVsZW1lbnQgKiBmaWVsZEVsZW1lbnRzUGVyQmxvYjsKICB2YXIgbWF4Qnl0ZXNQZXJUcmFuc2FjdGlvbiA9IGJ5dGVzUGVyQmxvYiAqIGJsb2JzUGVyVHJhbnNhY3Rpb24gLSAvLyB0ZXJtaW5hdG9yIGJ5dGUgKDB4ODApLgogIDEgLSAvLyB6ZXJvIGJ5dGUgKDB4MDApIGFwcGVuZGVkIHRvIGVhY2ggZmllbGQgZWxlbWVudC4KICAxICogZmllbGRFbGVtZW50c1BlckJsb2IgKiBibG9ic1BlclRyYW5zYWN0aW9uOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2t6Zy5qcwogIHZhciB2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6ZyA9IDE7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvYi5qcwogIGluaXRfYmFzZSgpOwogIHZhciBCbG9iU2l6ZVRvb0xhcmdlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhTaXplLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKCJCbG9iIHNpemUgaXMgdG9vIGxhcmdlLiIsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFtgTWF4OiAke21heFNpemV9IGJ5dGVzYCwgYEdpdmVuOiAke3NpemUzfSBieXRlc2BdLAogICAgICAgIG5hbWU6ICJCbG9iU2l6ZVRvb0xhcmdlRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEVtcHR5QmxvYkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQmxvYiBkYXRhIG11c3Qgbm90IGJlIGVtcHR5LiIsIHsgbmFtZTogIkVtcHR5QmxvYkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkVmVyc2lvbmVkSGFzaFNpemVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKGBWZXJzaW9uZWQgaGFzaCAiJHtoYXNoM30iIHNpemUgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkV4cGVjdGVkOiAzMiIsIGBSZWNlaXZlZDogJHtzaXplM31gXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFZlcnNpb25lZEhhc2hTaXplRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEludmFsaWRWZXJzaW9uZWRIYXNoVmVyc2lvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMsIHZlcnNpb246IHZlcnNpb24zIH0pIHsKICAgICAgc3VwZXIoYFZlcnNpb25lZCBoYXNoICIke2hhc2gzfSIgdmVyc2lvbiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgIGBFeHBlY3RlZDogJHt2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6Z31gLAogICAgICAgICAgYFJlY2VpdmVkOiAke3ZlcnNpb24zfWAKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJJbnZhbGlkVmVyc2lvbmVkSGFzaFZlcnNpb25FcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvdG9CbG9icy5qcwogIGluaXRfY3Vyc29yMigpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiB0b0Jsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuZGF0YSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgZGF0YSA9IHR5cGVvZiBwYXJhbWV0ZXJzLmRhdGEgPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhwYXJhbWV0ZXJzLmRhdGEpIDogcGFyYW1ldGVycy5kYXRhOwogICAgY29uc3Qgc2l6ZV8gPSBzaXplKGRhdGEpOwogICAgaWYgKCFzaXplXykKICAgICAgdGhyb3cgbmV3IEVtcHR5QmxvYkVycm9yKCk7CiAgICBpZiAoc2l6ZV8gPiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uKQogICAgICB0aHJvdyBuZXcgQmxvYlNpemVUb29MYXJnZUVycm9yKHsKICAgICAgICBtYXhTaXplOiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uLAogICAgICAgIHNpemU6IHNpemVfCiAgICAgIH0pOwogICAgY29uc3QgYmxvYnMgPSBbXTsKICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgbGV0IHBvc2l0aW9uID0gMDsKICAgIHdoaWxlIChhY3RpdmUpIHsKICAgICAgY29uc3QgYmxvYiA9IGNyZWF0ZUN1cnNvcihuZXcgVWludDhBcnJheShieXRlc1BlckJsb2IpKTsKICAgICAgbGV0IHNpemUzID0gMDsKICAgICAgd2hpbGUgKHNpemUzIDwgZmllbGRFbGVtZW50c1BlckJsb2IpIHsKICAgICAgICBjb25zdCBieXRlczIgPSBkYXRhLnNsaWNlKHBvc2l0aW9uLCBwb3NpdGlvbiArIChieXRlc1BlckZpZWxkRWxlbWVudCAtIDEpKTsKICAgICAgICBibG9iLnB1c2hCeXRlKDApOwogICAgICAgIGJsb2IucHVzaEJ5dGVzKGJ5dGVzMik7CiAgICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPCAzMSkgewogICAgICAgICAgYmxvYi5wdXNoQnl0ZSgxMjgpOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgc2l6ZTMrKzsKICAgICAgICBwb3NpdGlvbiArPSAzMTsKICAgICAgfQogICAgICBibG9icy5wdXNoKGJsb2IpOwogICAgfQogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gYmxvYnMubWFwKCh4KSA9PiB4LmJ5dGVzKSA6IGJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4LmJ5dGVzKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi90b0Jsb2JTaWRlY2Fycy5qcwogIGZ1bmN0aW9uIHRvQmxvYlNpZGVjYXJzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwga3pnLCB0byB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGJsb2JzID0gcGFyYW1ldGVycy5ibG9icyA/PyB0b0Jsb2JzKHsgZGF0YSwgdG8gfSk7CiAgICBjb25zdCBjb21taXRtZW50cyA9IHBhcmFtZXRlcnMuY29tbWl0bWVudHMgPz8gYmxvYnNUb0NvbW1pdG1lbnRzKHsgYmxvYnMsIGt6ZywgdG8gfSk7CiAgICBjb25zdCBwcm9vZnMgPSBwYXJhbWV0ZXJzLnByb29mcyA/PyBibG9ic1RvUHJvb2ZzKHsgYmxvYnMsIGNvbW1pdG1lbnRzLCBremcsIHRvIH0pOwogICAgY29uc3Qgc2lkZWNhcnMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvYnMubGVuZ3RoOyBpKyspCiAgICAgIHNpZGVjYXJzLnB1c2goewogICAgICAgIGJsb2I6IGJsb2JzW2ldLAogICAgICAgIGNvbW1pdG1lbnQ6IGNvbW1pdG1lbnRzW2ldLAogICAgICAgIHByb29mOiBwcm9vZnNbaV0KICAgICAgfSk7CiAgICByZXR1cm4gc2lkZWNhcnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vZ2V0VHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uVHlwZSh0cmFuc2FjdGlvbikgewogICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbi50eXBlOwogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLmJsb2JzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYlZlcnNpb25lZEhhc2hlcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiB0cmFuc2FjdGlvbi5zaWRlY2FycyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNDg0NCI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgfQogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5nYXNQcmljZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gImVpcDI5MzAiOwogICAgICByZXR1cm4gImxlZ2FjeSI7CiAgICB9CiAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3IoeyB0cmFuc2FjdGlvbiB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDaGFpbklkLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZChjbGllbnQpIHsKICAgIGNvbnN0IGNoYWluSWRIZXggPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9jaGFpbklkIgogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIoY2hhaW5JZEhleCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIHZhciBkZWZhdWx0UGFyYW1ldGVycyA9IFsKICAgICJibG9iVmVyc2lvbmVkSGFzaGVzIiwKICAgICJjaGFpbklkIiwKICAgICJmZWVzIiwKICAgICJnYXMiLAogICAgIm5vbmNlIiwKICAgICJ0eXBlIgogIF07CiAgYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgYmxvYnMsIGNoYWluLCBnYXMsIGt6Zywgbm9uY2UsIG5vbmNlTWFuYWdlcjogbm9uY2VNYW5hZ2VyMiwgcGFyYW1ldGVycyA9IGRlZmF1bHRQYXJhbWV0ZXJzLCB0eXBlIH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IGFjY291bnRfOwogICAgY29uc3QgcmVxdWVzdCA9IHsgLi4uYXJncywgLi4uYWNjb3VudCA/IHsgZnJvbTogYWNjb3VudD8uYWRkcmVzcyB9IDoge30gfTsKICAgIGxldCBibG9jazsKICAgIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrMigpIHsKICAgICAgaWYgKGJsb2NrKQogICAgICAgIHJldHVybiBibG9jazsKICAgICAgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoeyBibG9ja1RhZzogImxhdGVzdCIgfSk7CiAgICAgIHJldHVybiBibG9jazsKICAgIH0KICAgIGxldCBjaGFpbklkOwogICAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZDIoKSB7CiAgICAgIGlmIChjaGFpbklkKQogICAgICAgIHJldHVybiBjaGFpbklkOwogICAgICBpZiAoY2hhaW4pCiAgICAgICAgcmV0dXJuIGNoYWluLmlkOwogICAgICBpZiAodHlwZW9mIGFyZ3MuY2hhaW5JZCAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIGFyZ3MuY2hhaW5JZDsKICAgICAgY29uc3QgY2hhaW5JZF8gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRDaGFpbklkLCAiZ2V0Q2hhaW5JZCIpKHt9KTsKICAgICAgY2hhaW5JZCA9IGNoYWluSWRfOwogICAgICByZXR1cm4gY2hhaW5JZDsKICAgIH0KICAgIGlmICgocGFyYW1ldGVycy5pbmNsdWRlcygiYmxvYlZlcnNpb25lZEhhc2hlcyIpIHx8IHBhcmFtZXRlcnMuaW5jbHVkZXMoInNpZGVjYXJzIikpICYmIGJsb2JzICYmIGt6ZykgewogICAgICBjb25zdCBjb21taXRtZW50cyA9IGJsb2JzVG9Db21taXRtZW50cyh7IGJsb2JzLCBremcgfSk7CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJibG9iVmVyc2lvbmVkSGFzaGVzIikpIHsKICAgICAgICBjb25zdCB2ZXJzaW9uZWRIYXNoZXMgPSBjb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzKHsKICAgICAgICAgIGNvbW1pdG1lbnRzLAogICAgICAgICAgdG86ICJoZXgiCiAgICAgICAgfSk7CiAgICAgICAgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gdmVyc2lvbmVkSGFzaGVzOwogICAgICB9CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJzaWRlY2FycyIpKSB7CiAgICAgICAgY29uc3QgcHJvb2ZzID0gYmxvYnNUb1Byb29mcyh7IGJsb2JzLCBjb21taXRtZW50cywga3pnIH0pOwogICAgICAgIGNvbnN0IHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoewogICAgICAgICAgYmxvYnMsCiAgICAgICAgICBjb21taXRtZW50cywKICAgICAgICAgIHByb29mcywKICAgICAgICAgIHRvOiAiaGV4IgogICAgICAgIH0pOwogICAgICAgIHJlcXVlc3Quc2lkZWNhcnMgPSBzaWRlY2FyczsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImNoYWluSWQiKSkKICAgICAgcmVxdWVzdC5jaGFpbklkID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJub25jZSIpICYmIHR5cGVvZiBub25jZSA9PT0gInVuZGVmaW5lZCIgJiYgYWNjb3VudCkgewogICAgICBpZiAobm9uY2VNYW5hZ2VyMikgewogICAgICAgIGNvbnN0IGNoYWluSWQyID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgICAgICByZXF1ZXN0Lm5vbmNlID0gYXdhaXQgbm9uY2VNYW5hZ2VyMi5jb25zdW1lKHsKICAgICAgICAgIGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywKICAgICAgICAgIGNoYWluSWQ6IGNoYWluSWQyLAogICAgICAgICAgY2xpZW50CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVxdWVzdC5ub25jZSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uQ291bnQsICJnZXRUcmFuc2FjdGlvbkNvdW50IikoewogICAgICAgICAgYWRkcmVzczogYWNjb3VudC5hZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBpZiAoKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSB8fCBwYXJhbWV0ZXJzLmluY2x1ZGVzKCJ0eXBlIikpICYmIHR5cGVvZiB0eXBlID09PSAidW5kZWZpbmVkIikgewogICAgICB0cnkgewogICAgICAgIHJlcXVlc3QudHlwZSA9IGdldFRyYW5zYWN0aW9uVHlwZShyZXF1ZXN0KTsKICAgICAgfSBjYXRjaCB7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgcmVxdWVzdC50eXBlID0gdHlwZW9mIGJsb2NrMj8uYmFzZUZlZVBlckdhcyA9PT0gImJpZ2ludCIgPyAiZWlwMTU1OSIgOiAibGVnYWN5IjsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSkgewogICAgICBpZiAocmVxdWVzdC50eXBlICE9PSAibGVnYWN5IiAmJiByZXF1ZXN0LnR5cGUgIT09ICJlaXAyOTMwIikgewogICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiByZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgICBjb25zdCB7IG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSA9IGF3YWl0IGludGVybmFsX2VzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIHsKICAgICAgICAgICAgYmxvY2s6IGJsb2NrMiwKICAgICAgICAgICAgY2hhaW4sCiAgICAgICAgICAgIHJlcXVlc3QKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIiAmJiBhcmdzLm1heEZlZVBlckdhcyAmJiBhcmdzLm1heEZlZVBlckdhcyA8IG1heFByaW9yaXR5RmVlUGVyR2FzKQogICAgICAgICAgICB0aHJvdyBuZXcgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IoewogICAgICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA9IG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICAgICAgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBtYXhGZWVQZXJHYXM7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgYXJncy5tYXhGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICAgIHRocm93IG5ldyBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yKCk7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgY29uc3QgeyBnYXNQcmljZTogZ2FzUHJpY2VfIH0gPSBhd2FpdCBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgICBibG9jazogYmxvY2syLAogICAgICAgICAgY2hhaW4sCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgdHlwZTogImxlZ2FjeSIKICAgICAgICB9KTsKICAgICAgICByZXF1ZXN0Lmdhc1ByaWNlID0gZ2FzUHJpY2VfOwogICAgICB9CiAgICB9CiAgICBpZiAocGFyYW1ldGVycy5pbmNsdWRlcygiZ2FzIikgJiYgdHlwZW9mIGdhcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJlcXVlc3QuZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICAuLi5yZXF1ZXN0LAogICAgICAgIGFjY291bnQ6IGFjY291bnQgPyB7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywgdHlwZTogImpzb24tcnBjIiB9IDogYWNjb3VudAogICAgICB9KTsKICAgIGFzc2VydFJlcXVlc3QocmVxdWVzdCk7CiAgICBkZWxldGUgcmVxdWVzdC5wYXJhbWV0ZXJzOwogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmFsYW5jZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEJhbGFuY2UiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYWxhbmNlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50IH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IHZvaWQgMDsKICAgIHRyeSB7CiAgICAgIGxldCBlc3RpbWF0ZUdhc19ycGMgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBibG9jazogYmxvY2syLCByZXF1ZXN0OiByZXF1ZXN0MiwgcnBjU3RhdGVPdmVycmlkZTogcnBjU3RhdGVPdmVycmlkZTIgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9lc3RpbWF0ZUdhcyIsCiAgICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUyID8gW3JlcXVlc3QyLCBibG9jazIgPz8gImxhdGVzdCIsIHJwY1N0YXRlT3ZlcnJpZGUyXSA6IGJsb2NrMiA/IFtyZXF1ZXN0MiwgYmxvY2syXSA6IFtyZXF1ZXN0Ml0KICAgICAgICB9KTsKICAgICAgfTsKICAgICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBhdXRob3JpemF0aW9uTGlzdCwgYmxvYnMsIGJsb2JWZXJzaW9uZWRIYXNoZXMsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHZhbHVlLCBzdGF0ZU92ZXJyaWRlLCAuLi5yZXN0IH0gPSBhd2FpdCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0KGNsaWVudCwgewogICAgICAgIC4uLmFyZ3MsCiAgICAgICAgcGFyYW1ldGVyczogKAogICAgICAgICAgLy8gU29tZSBSUEMgUHJvdmlkZXJzIGRvIG5vdCBjb21wdXRlIHZlcnNpb25lZCBoYXNoZXMgZnJvbSBibG9icy4gV2Ugd2lsbCBuZWVkCiAgICAgICAgICAvLyB0byBjb21wdXRlIHRoZW0uCiAgICAgICAgICBhY2NvdW50Py50eXBlID09PSAibG9jYWwiID8gdm9pZCAwIDogWyJibG9iVmVyc2lvbmVkSGFzaGVzIl0KICAgICAgICApCiAgICAgIH0pOwogICAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgICBjb25zdCBycGNTdGF0ZU92ZXJyaWRlID0gc2VyaWFsaXplU3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKTsKICAgICAgY29uc3QgdG8gPSBhd2FpdCAoYXN5bmMgKCkgPT4gewogICAgICAgIGlmIChyZXN0LnRvKQogICAgICAgICAgcmV0dXJuIHJlc3QudG87CiAgICAgICAgaWYgKGF1dGhvcml6YXRpb25MaXN0ICYmIGF1dGhvcml6YXRpb25MaXN0Lmxlbmd0aCA+IDApCiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVjb3ZlckF1dGhvcml6YXRpb25BZGRyZXNzKHsKICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYXV0aG9yaXphdGlvbkxpc3RbMF0KICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImB0b2AgaXMgcmVxdWlyZWQuIENvdWxkIG5vdCBpbmZlciBmcm9tIGBhdXRob3JpemF0aW9uTGlzdGAiKTsKICAgICAgICAgIH0pOwogICAgICAgIHJldHVybiB2b2lkIDA7CiAgICAgIH0pKCk7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGNoYWluRm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdDsKICAgICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAvLyBQaWNrIG91dCBleHRyYSBkYXRhIHRoYXQgbWlnaHQgZXhpc3Qgb24gdGhlIGNoYWluJ3MgdHJhbnNhY3Rpb24gcmVxdWVzdCB0eXBlLgogICAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICBibG9icywKICAgICAgICBibG9iVmVyc2lvbmVkSGFzaGVzLAogICAgICAgIGRhdGEsCiAgICAgICAgZ2FzLAogICAgICAgIGdhc1ByaWNlLAogICAgICAgIG1heEZlZVBlckJsb2JHYXMsCiAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgIG5vbmNlLAogICAgICAgIHRvLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgICBsZXQgZXN0aW1hdGUgPSBCaWdJbnQoYXdhaXQgZXN0aW1hdGVHYXNfcnBjKHsgYmxvY2ssIHJlcXVlc3QsIHJwY1N0YXRlT3ZlcnJpZGUgfSkpOwogICAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSBhd2FpdCBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzOiByZXF1ZXN0LmZyb20gfSk7CiAgICAgICAgY29uc3QgZXN0aW1hdGVzID0gYXdhaXQgUHJvbWlzZS5hbGwoYXV0aG9yaXphdGlvbkxpc3QubWFwKGFzeW5jIChhdXRob3JpemF0aW9uKSA9PiB7CiAgICAgICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcyB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgICAgIGNvbnN0IGVzdGltYXRlMiA9IGF3YWl0IGVzdGltYXRlR2FzX3JwYyh7CiAgICAgICAgICAgIGJsb2NrLAogICAgICAgICAgICByZXF1ZXN0OiB7CiAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3Q6IHZvaWQgMCwKICAgICAgICAgICAgICBkYXRhLAogICAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgICAgdG86IGNvbnRyYWN0QWRkcmVzcywKICAgICAgICAgICAgICB2YWx1ZTogbnVtYmVyVG9IZXgodmFsdWUyKQogICAgICAgICAgICB9LAogICAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiAxMDAwMDBuKTsKICAgICAgICAgIHJldHVybiAybiAqIEJpZ0ludChlc3RpbWF0ZTIpOwogICAgICAgIH0pKTsKICAgICAgICBlc3RpbWF0ZSArPSBlc3RpbWF0ZXMucmVkdWNlKChhY2MsIGN1cnIpID0+IGFjYyArIGN1cnIsIDBuKTsKICAgICAgfQogICAgICByZXR1cm4gZXN0aW1hdGU7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgdGhyb3cgZ2V0RXN0aW1hdGVHYXNFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUNvbnRyYWN0R2FzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVDb250cmFjdEdhcyhjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgY29uc3QgZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICBkYXRhLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLnJlcXVlc3QKICAgICAgfSk7CiAgICAgIHJldHVybiBnYXM7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zdCBhY2NvdW50ID0gcmVxdWVzdC5hY2NvdW50ID8gcGFyc2VBY2NvdW50KHJlcXVlc3QuYWNjb3VudCkgOiB2b2lkIDA7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvZXN0aW1hdGVDb250cmFjdEdhcyIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGluaXRfZ2V0QWJpSXRlbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL3BhcnNlRXZlbnRMb2dzLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUV2ZW50TG9nLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X3NpemUoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwogIGluaXRfY3Vyc29yKCk7CiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIHZhciBkb2NzUGF0aDMgPSAiL2RvY3MvY29udHJhY3QvZGVjb2RlRXZlbnRMb2ciOwogIGZ1bmN0aW9uIGRlY29kZUV2ZW50TG9nKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhLCBzdHJpY3Q6IHN0cmljdF8sIHRvcGljcyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gdHJ1ZTsKICAgIGNvbnN0IFtzaWduYXR1cmUsIC4uLmFyZ1RvcGljc10gPSB0b3BpY3M7CiAgICBpZiAoIXNpZ25hdHVyZSkKICAgICAgdGhyb3cgbmV3IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCBhYmlJdGVtID0gKCgpID0+IHsKICAgICAgaWYgKGFiaTIubGVuZ3RoID09PSAxKQogICAgICAgIHJldHVybiBhYmkyWzBdOwogICAgICByZXR1cm4gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgc2lnbmF0dXJlID09PSB0b0V2ZW50U2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIH0pKCk7CiAgICBpZiAoIShhYmlJdGVtICYmICJuYW1lIiBpbiBhYmlJdGVtKSB8fCBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCB7IG5hbWUsIGlucHV0cyB9ID0gYWJpSXRlbTsKICAgIGNvbnN0IGlzVW5uYW1lZCA9IGlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgIGxldCBhcmdzID0gaXNVbm5hbWVkID8gW10gOiB7fTsKICAgIGNvbnN0IGluZGV4ZWRJbnB1dHMgPSBpbnB1dHMuZmlsdGVyKCh4KSA9PiAiaW5kZXhlZCIgaW4geCAmJiB4LmluZGV4ZWQpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRleGVkSW5wdXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHBhcmFtID0gaW5kZXhlZElucHV0c1tpXTsKICAgICAgY29uc3QgdG9waWMgPSBhcmdUb3BpY3NbaV07CiAgICAgIGlmICghdG9waWMpCiAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ1RvcGljc01pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBwYXJhbQogICAgICAgIH0pOwogICAgICBhcmdzW2lzVW5uYW1lZCA/IGkgOiBwYXJhbS5uYW1lIHx8IGldID0gZGVjb2RlVG9waWMoeyBwYXJhbSwgdmFsdWU6IHRvcGljIH0pOwogICAgfQogICAgY29uc3Qgbm9uSW5kZXhlZElucHV0cyA9IGlucHV0cy5maWx0ZXIoKHgpID0+ICEoImluZGV4ZWQiIGluIHggJiYgeC5pbmRleGVkKSk7CiAgICBpZiAobm9uSW5kZXhlZElucHV0cy5sZW5ndGggPiAwKSB7CiAgICAgIGlmIChkYXRhICYmIGRhdGEgIT09ICIweCIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgZGVjb2RlZERhdGEgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKG5vbkluZGV4ZWRJbnB1dHMsIGRhdGEpOwogICAgICAgICAgaWYgKGRlY29kZWREYXRhKSB7CiAgICAgICAgICAgIGlmIChpc1VubmFtZWQpCiAgICAgICAgICAgICAgYXJncyA9IFsuLi5hcmdzLCAuLi5kZWNvZGVkRGF0YV07CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9uSW5kZXhlZElucHV0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYXJnc1tub25JbmRleGVkSW5wdXRzW2ldLm5hbWVdID0gZGVjb2RlZERhdGFbaV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KSB7CiAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciB8fCBlcnIgaW5zdGFuY2VvZiBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ0RhdGFNaXNtYXRjaCh7CiAgICAgICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgICAgIHBhcmFtczogbm9uSW5kZXhlZElucHV0cywKICAgICAgICAgICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdHJpY3QpIHsKICAgICAgICB0aHJvdyBuZXcgRGVjb2RlTG9nRGF0YU1pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBkYXRhOiAiMHgiLAogICAgICAgICAgcGFyYW1zOiBub25JbmRleGVkSW5wdXRzLAogICAgICAgICAgc2l6ZTogMAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICBldmVudE5hbWU6IG5hbWUsCiAgICAgIGFyZ3M6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGFyZ3MgOiB2b2lkIDAKICAgIH07CiAgfQogIGZ1bmN0aW9uIGRlY29kZVRvcGljKHsgcGFyYW0sIHZhbHVlIH0pIHsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIiB8fCBwYXJhbS50eXBlID09PSAiYnl0ZXMiIHx8IHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIgfHwgcGFyYW0udHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pKQogICAgICByZXR1cm4gdmFsdWU7CiAgICBjb25zdCBkZWNvZGVkQXJnID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCB2YWx1ZSkgfHwgW107CiAgICByZXR1cm4gZGVjb2RlZEFyZ1swXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcGFyc2VFdmVudExvZ3MuanMKICBmdW5jdGlvbiBwYXJzZUV2ZW50TG9ncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgbG9ncywgc3RyaWN0ID0gdHJ1ZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50TmFtZSA9ICgoKSA9PiB7CiAgICAgIGlmICghcGFyYW1ldGVycy5ldmVudE5hbWUpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1ldGVycy5ldmVudE5hbWUpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLmV2ZW50TmFtZTsKICAgICAgcmV0dXJuIFtwYXJhbWV0ZXJzLmV2ZW50TmFtZV07CiAgICB9KSgpOwogICAgcmV0dXJuIGxvZ3MubWFwKChsb2cpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBhYmlJdGVtID0gYWJpMi5maW5kKChhYmlJdGVtMikgPT4gYWJpSXRlbTIudHlwZSA9PT0gImV2ZW50IiAmJiBsb2cudG9waWNzWzBdID09PSB0b0V2ZW50U2VsZWN0b3IoYWJpSXRlbTIpKTsKICAgICAgICBpZiAoIWFiaUl0ZW0pCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBjb25zdCBldmVudCA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgIC4uLmxvZywKICAgICAgICAgIGFiaTogW2FiaUl0ZW1dLAogICAgICAgICAgc3RyaWN0CiAgICAgICAgfSk7CiAgICAgICAgaWYgKGV2ZW50TmFtZSAmJiAhZXZlbnROYW1lLmluY2x1ZGVzKGV2ZW50LmV2ZW50TmFtZSkpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoIWluY2x1ZGVzQXJncyh7CiAgICAgICAgICBhcmdzOiBldmVudC5hcmdzLAogICAgICAgICAgaW5wdXRzOiBhYmlJdGVtLmlucHV0cywKICAgICAgICAgIG1hdGNoQXJnczogYXJncwogICAgICAgIH0pKQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHsgLi4uZXZlbnQsIC4uLmxvZyB9OwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBsZXQgZXZlbnROYW1lMjsKICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3IpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nRGF0YU1pc21hdGNoIHx8IGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ1RvcGljc01pc21hdGNoKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIGV2ZW50TmFtZTIgPSBlcnIuYWJpSXRlbS5uYW1lOwogICAgICAgICAgaXNVbm5hbWVkID0gZXJyLmFiaUl0ZW0uaW5wdXRzPy5zb21lKCh4KSA9PiAhKCJuYW1lIiBpbiB4ICYmIHgubmFtZSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4geyAuLi5sb2csIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sIGV2ZW50TmFtZTogZXZlbnROYW1lMiB9OwogICAgICB9CiAgICB9KS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGluY2x1ZGVzQXJncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MsIGlucHV0cywgbWF0Y2hBcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFtYXRjaEFyZ3MpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKCFhcmdzKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBmdW5jdGlvbiBpc0VxdWFsKGlucHV0LCB2YWx1ZSwgYXJnKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09ICJhZGRyZXNzIikKICAgICAgICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbCh2YWx1ZSwgYXJnKTsKICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gInN0cmluZyIgfHwgaW5wdXQudHlwZSA9PT0gImJ5dGVzIikKICAgICAgICAgIHJldHVybiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpID09PSBhcmc7CiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBhcmc7CiAgICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogICAgaWYgKEFycmF5LmlzQXJyYXkoYXJncykgJiYgQXJyYXkuaXNBcnJheShtYXRjaEFyZ3MpKSB7CiAgICAgIHJldHVybiBtYXRjaEFyZ3MuZXZlcnkoKHZhbHVlLCBpbmRleDIpID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzW2luZGV4Ml07CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2luZGV4Ml0pKTsKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZW9mIGFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KGFyZ3MpICYmIHR5cGVvZiBtYXRjaEFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KG1hdGNoQXJncykpCiAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhtYXRjaEFyZ3MpLmV2ZXJ5KChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzLmZpbmQoKGlucHV0MikgPT4gaW5wdXQyLm5hbWUgPT09IGtleSk7CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2tleV0pKTsKICAgICAgfSk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0TG9ncy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvbG9nLmpzCiAgZnVuY3Rpb24gZm9ybWF0TG9nKGxvZywgeyBhcmdzLCBldmVudE5hbWUgfSA9IHt9KSB7CiAgICByZXR1cm4gewogICAgICAuLi5sb2csCiAgICAgIGJsb2NrSGFzaDogbG9nLmJsb2NrSGFzaCA/IGxvZy5ibG9ja0hhc2ggOiBudWxsLAogICAgICBibG9ja051bWJlcjogbG9nLmJsb2NrTnVtYmVyID8gQmlnSW50KGxvZy5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBsb2dJbmRleDogbG9nLmxvZ0luZGV4ID8gTnVtYmVyKGxvZy5sb2dJbmRleCkgOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkhhc2g6IGxvZy50cmFuc2FjdGlvbkhhc2ggPyBsb2cudHJhbnNhY3Rpb25IYXNoIDogbnVsbCwKICAgICAgdHJhbnNhY3Rpb25JbmRleDogbG9nLnRyYW5zYWN0aW9uSW5kZXggPyBOdW1iZXIobG9nLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgLi4uZXZlbnROYW1lID8geyBhcmdzLCBldmVudE5hbWUgfSA6IHt9CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldExvZ3MuanMKICBhc3luYyBmdW5jdGlvbiBnZXRMb2dzKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja0hhc2gsIGZyb21CbG9jaywgdG9CbG9jaywgZXZlbnQsIGV2ZW50czogZXZlbnRzXywgYXJncywgc3RyaWN0OiBzdHJpY3RfIH0gPSB7fSkgewogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IGV2ZW50cyA9IGV2ZW50c18gPz8gKGV2ZW50ID8gW2V2ZW50XSA6IHZvaWQgMCk7CiAgICBsZXQgdG9waWNzID0gW107CiAgICBpZiAoZXZlbnRzKSB7CiAgICAgIGNvbnN0IGVuY29kZWQgPSBldmVudHMuZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgIGFyZ3M6IGV2ZW50c18gPyB2b2lkIDAgOiBhcmdzCiAgICAgIH0pKTsKICAgICAgdG9waWNzID0gW2VuY29kZWRdOwogICAgICBpZiAoZXZlbnQpCiAgICAgICAgdG9waWNzID0gdG9waWNzWzBdOwogICAgfQogICAgbGV0IGxvZ3M7CiAgICBpZiAoYmxvY2tIYXNoKSB7CiAgICAgIGxvZ3MgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldExvZ3MiLAogICAgICAgIHBhcmFtczogW3sgYWRkcmVzcywgdG9waWNzLCBibG9ja0hhc2ggfV0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBsb2dzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRMb2dzIiwKICAgICAgICBwYXJhbXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgdG9waWNzLAogICAgICAgICAgICBmcm9tQmxvY2s6IHR5cGVvZiBmcm9tQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgoZnJvbUJsb2NrKSA6IGZyb21CbG9jaywKICAgICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWV2ZW50cykKICAgICAgcmV0dXJuIGZvcm1hdHRlZExvZ3M7CiAgICByZXR1cm4gcGFyc2VFdmVudExvZ3MoewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgbG9nczogZm9ybWF0dGVkTG9ncywKICAgICAgc3RyaWN0CiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJsb2NrSGFzaCwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIHRvQmxvY2ssIHN0cmljdCB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50ID0gZXZlbnROYW1lID8gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgbmFtZTogZXZlbnROYW1lIH0pIDogdm9pZCAwOwogICAgY29uc3QgZXZlbnRzID0gIWV2ZW50ID8gYWJpMi5maWx0ZXIoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IikgOiB2b2lkIDA7CiAgICByZXR1cm4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0TG9ncywgImdldExvZ3MiKSh7CiAgICAgIGFkZHJlc3MsCiAgICAgIGFyZ3MsCiAgICAgIGJsb2NrSGFzaCwKICAgICAgZXZlbnQsCiAgICAgIGV2ZW50cywKICAgICAgZnJvbUJsb2NrLAogICAgICB0b0Jsb2NrLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3JlYWRDb250cmFjdC5qcwogIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQoKTsKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogIGluaXRfY2FsbCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlYWRDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZnVuY3Rpb25OYW1lCiAgICB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgLi4ucmVzdCwKICAgICAgICBkYXRhOiBjYWxsZGF0YSwKICAgICAgICB0bzogYWRkcmVzcwogICAgICB9KTsKICAgICAgcmV0dXJuIGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9yZWFkQ29udHJhY3QiLAogICAgICAgIGZ1bmN0aW9uTmFtZQogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9zaW11bGF0ZUNvbnRyYWN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2NhbGwoKTsKICBhc3luYyBmdW5jdGlvbiBzaW11bGF0ZUNvbnRyYWN0KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRhdGFTdWZmaXgsIGZ1bmN0aW9uTmFtZSwgLi4uY2FsbFJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBhY2NvdW50ID0gY2FsbFJlcXVlc3QuYWNjb3VudCA/IHBhcnNlQWNjb3VudChjYWxsUmVxdWVzdC5hY2NvdW50KSA6IGNsaWVudC5hY2NvdW50OwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgYmF0Y2g6IGZhbHNlLAogICAgICAgIGRhdGE6IGAke2NhbGxkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLmNhbGxSZXF1ZXN0LAogICAgICAgIGFjY291bnQKICAgICAgfSk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgICBjb25zdCBtaW5pbWl6ZWRBYmkgPSBhYmkyLmZpbHRlcigoYWJpSXRlbSkgPT4gIm5hbWUiIGluIGFiaUl0ZW0gJiYgYWJpSXRlbS5uYW1lID09PSBwYXJhbWV0ZXJzLmZ1bmN0aW9uTmFtZSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgcmVzdWx0LAogICAgICAgIHJlcXVlc3Q6IHsKICAgICAgICAgIGFiaTogbWluaW1pemVkQWJpLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkYXRhU3VmZml4LAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgLi4uY2FsbFJlcXVlc3QsCiAgICAgICAgICBhY2NvdW50CiAgICAgICAgfQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9zaW11bGF0ZUNvbnRyYWN0IiwKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgc2VuZGVyOiBhY2NvdW50Py5hZGRyZXNzCiAgICAgIH0pOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhdGNoQ29udHJhY3RFdmVudC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9ycGMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL29ic2VydmUuanMKICB2YXIgbGlzdGVuZXJzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjbGVhbnVwQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjYWxsYmFja0NvdW50ID0gMDsKICBmdW5jdGlvbiBvYnNlcnZlKG9ic2VydmVySWQsIGNhbGxiYWNrcywgZm4pIHsKICAgIGNvbnN0IGNhbGxiYWNrSWQgPSArK2NhbGxiYWNrQ291bnQ7CiAgICBjb25zdCBnZXRMaXN0ZW5lcnMgPSAoKSA9PiBsaXN0ZW5lcnNDYWNoZS5nZXQob2JzZXJ2ZXJJZCkgfHwgW107CiAgICBjb25zdCB1bnN1YnNjcmliZSA9ICgpID0+IHsKICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICBsaXN0ZW5lcnNDYWNoZS5zZXQob2JzZXJ2ZXJJZCwgbGlzdGVuZXJzMi5maWx0ZXIoKGNiKSA9PiBjYi5pZCAhPT0gY2FsbGJhY2tJZCkpOwogICAgfTsKICAgIGNvbnN0IHVud2F0Y2ggPSAoKSA9PiB7CiAgICAgIGNvbnN0IGNsZWFudXAyID0gY2xlYW51cENhY2hlLmdldChvYnNlcnZlcklkKTsKICAgICAgaWYgKGdldExpc3RlbmVycygpLmxlbmd0aCA9PT0gMSAmJiBjbGVhbnVwMikKICAgICAgICBjbGVhbnVwMigpOwogICAgICB1bnN1YnNjcmliZSgpOwogICAgfTsKICAgIGNvbnN0IGxpc3RlbmVycyA9IGdldExpc3RlbmVycygpOwogICAgbGlzdGVuZXJzQ2FjaGUuc2V0KG9ic2VydmVySWQsIFsKICAgICAgLi4ubGlzdGVuZXJzLAogICAgICB7IGlkOiBjYWxsYmFja0lkLCBmbnM6IGNhbGxiYWNrcyB9CiAgICBdKTsKICAgIGlmIChsaXN0ZW5lcnMgJiYgbGlzdGVuZXJzLmxlbmd0aCA+IDApCiAgICAgIHJldHVybiB1bndhdGNoOwogICAgY29uc3QgZW1pdCA9IHt9OwogICAgZm9yIChjb25zdCBrZXkgaW4gY2FsbGJhY2tzKSB7CiAgICAgIGVtaXRba2V5XSA9ICguLi5hcmdzKSA9PiB7CiAgICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICAgIGlmIChsaXN0ZW5lcnMyLmxlbmd0aCA9PT0gMCkKICAgICAgICAgIHJldHVybjsKICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVyczIpCiAgICAgICAgICBsaXN0ZW5lci5mbnNba2V5XT8uKC4uLmFyZ3MpOwogICAgICB9OwogICAgfQogICAgY29uc3QgY2xlYW51cCA9IGZuKGVtaXQpOwogICAgaWYgKHR5cGVvZiBjbGVhbnVwID09PSAiZnVuY3Rpb24iKQogICAgICBjbGVhbnVwQ2FjaGUuc2V0KG9ic2VydmVySWQsIGNsZWFudXApOwogICAgcmV0dXJuIHVud2F0Y2g7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvd2FpdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHdhaXQodGltZSkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMpID0+IHNldFRpbWVvdXQocmVzLCB0aW1lKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcG9sbC5qcwogIGZ1bmN0aW9uIHBvbGwoZm4sIHsgZW1pdE9uQmVnaW4sIGluaXRpYWxXYWl0VGltZSwgaW50ZXJ2YWwgfSkgewogICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICBjb25zdCB1bndhdGNoID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICBjb25zdCB3YXRjaCA9IGFzeW5jICgpID0+IHsKICAgICAgbGV0IGRhdGEgPSB2b2lkIDA7CiAgICAgIGlmIChlbWl0T25CZWdpbikKICAgICAgICBkYXRhID0gYXdhaXQgZm4oeyB1bnBvbGw6IHVud2F0Y2ggfSk7CiAgICAgIGNvbnN0IGluaXRpYWxXYWl0ID0gYXdhaXQgaW5pdGlhbFdhaXRUaW1lPy4oZGF0YSkgPz8gaW50ZXJ2YWw7CiAgICAgIGF3YWl0IHdhaXQoaW5pdGlhbFdhaXQpOwogICAgICBjb25zdCBwb2xsMiA9IGFzeW5jICgpID0+IHsKICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBhd2FpdCBmbih7IHVucG9sbDogdW53YXRjaCB9KTsKICAgICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgICBwb2xsMigpOwogICAgICB9OwogICAgICBwb2xsMigpOwogICAgfTsKICAgIHdhdGNoKCk7CiAgICByZXR1cm4gdW53YXRjaDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaENvbnRyYWN0RXZlbnQuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoQ2FjaGUuanMKICB2YXIgcHJvbWlzZUNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICB2YXIgcmVzcG9uc2VDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgZnVuY3Rpb24gZ2V0Q2FjaGUoY2FjaGVLZXkyKSB7CiAgICBjb25zdCBidWlsZENhY2hlID0gKGNhY2hlS2V5MywgY2FjaGUpID0+ICh7CiAgICAgIGNsZWFyOiAoKSA9PiBjYWNoZS5kZWxldGUoY2FjaGVLZXkzKSwKICAgICAgZ2V0OiAoKSA9PiBjYWNoZS5nZXQoY2FjaGVLZXkzKSwKICAgICAgc2V0OiAoZGF0YSkgPT4gY2FjaGUuc2V0KGNhY2hlS2V5MywgZGF0YSkKICAgIH0pOwogICAgY29uc3QgcHJvbWlzZSA9IGJ1aWxkQ2FjaGUoY2FjaGVLZXkyLCBwcm9taXNlQ2FjaGUpOwogICAgY29uc3QgcmVzcG9uc2UgPSBidWlsZENhY2hlKGNhY2hlS2V5MiwgcmVzcG9uc2VDYWNoZSk7CiAgICByZXR1cm4gewogICAgICBjbGVhcjogKCkgPT4gewogICAgICAgIHByb21pc2UuY2xlYXIoKTsKICAgICAgICByZXNwb25zZS5jbGVhcigpOwogICAgICB9LAogICAgICBwcm9taXNlLAogICAgICByZXNwb25zZQogICAgfTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gd2l0aENhY2hlKGZuLCB7IGNhY2hlS2V5OiBjYWNoZUtleTIsIGNhY2hlVGltZSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB9KSB7CiAgICBjb25zdCBjYWNoZSA9IGdldENhY2hlKGNhY2hlS2V5Mik7CiAgICBjb25zdCByZXNwb25zZSA9IGNhY2hlLnJlc3BvbnNlLmdldCgpOwogICAgaWYgKHJlc3BvbnNlICYmIGNhY2hlVGltZSA+IDApIHsKICAgICAgY29uc3QgYWdlID0gKC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSByZXNwb25zZS5jcmVhdGVkLmdldFRpbWUoKTsKICAgICAgaWYgKGFnZSA8IGNhY2hlVGltZSkKICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgIH0KICAgIGxldCBwcm9taXNlID0gY2FjaGUucHJvbWlzZS5nZXQoKTsKICAgIGlmICghcHJvbWlzZSkgewogICAgICBwcm9taXNlID0gZm4oKTsKICAgICAgY2FjaGUucHJvbWlzZS5zZXQocHJvbWlzZSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBkYXRhID0gYXdhaXQgcHJvbWlzZTsKICAgICAgY2FjaGUucmVzcG9uc2Uuc2V0KHsgY3JlYXRlZDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIGRhdGEgfSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSBmaW5hbGx5IHsKICAgICAgY2FjaGUucHJvbWlzZS5jbGVhcigpOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrTnVtYmVyLmpzCiAgdmFyIGNhY2hlS2V5ID0gKGlkKSA9PiBgYmxvY2tOdW1iZXIuJHtpZH1gOwogIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrTnVtYmVyKGNsaWVudCwgeyBjYWNoZVRpbWUgPSBjbGllbnQuY2FjaGVUaW1lIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBhd2FpdCB3aXRoQ2FjaGUoKCkgPT4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfYmxvY2tOdW1iZXIiCiAgICB9KSwgeyBjYWNoZUtleTogY2FjaGVLZXkoY2xpZW50LnVpZCksIGNhY2hlVGltZSB9KTsKICAgIHJldHVybiBCaWdJbnQoYmxvY2tOdW1iZXJIZXgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZpbHRlckNoYW5nZXMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRGaWx0ZXJDaGFuZ2VzKF9jbGllbnQsIHsgZmlsdGVyIH0pIHsKICAgIGNvbnN0IHN0cmljdCA9ICJzdHJpY3QiIGluIGZpbHRlciAmJiBmaWx0ZXIuc3RyaWN0OwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckNoYW5nZXMiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGlmICh0eXBlb2YgbG9nc1swXSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBsb2dzOwogICAgY29uc3QgZm9ybWF0dGVkTG9ncyA9IGxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKTsKICAgIGlmICghKCJhYmkiIGluIGZpbHRlcikgfHwgIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3VuaW5zdGFsbEZpbHRlci5qcwogIGFzeW5jIGZ1bmN0aW9uIHVuaW5zdGFsbEZpbHRlcihfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICByZXR1cm4gZmlsdGVyLnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfdW5pbnN0YWxsRmlsdGVyIiwKICAgICAgcGFyYW1zOiBbZmlsdGVyLmlkXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hDb250cmFjdEV2ZW50LmpzCiAgZnVuY3Rpb24gd2F0Y2hDb250cmFjdEV2ZW50KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJhdGNoID0gdHJ1ZSwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGVuYWJsZVBvbGxpbmcgPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHBvbGxfICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gcG9sbF87CiAgICAgIGlmICh0eXBlb2YgZnJvbUJsb2NrID09PSAiYmlnaW50IikKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siICYmIGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0c1swXS5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0pKCk7CiAgICBjb25zdCBwb2xsQ29udHJhY3RFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQ29udHJhY3RFdmVudCIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGJhdGNoLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZXZlbnROYW1lLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBzdHJpY3QsCiAgICAgICAgZnJvbUJsb2NrCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uTG9ncywgb25FcnJvciB9LCAoZW1pdCkgPT4gewogICAgICAgIGxldCBwcmV2aW91c0Jsb2NrTnVtYmVyOwogICAgICAgIGlmIChmcm9tQmxvY2sgIT09IHZvaWQgMCkKICAgICAgICAgIHByZXZpb3VzQmxvY2tOdW1iZXIgPSBmcm9tQmxvY2sgLSAxbjsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGxldCBpbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmaWx0ZXIgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLCAiY3JlYXRlQ29udHJhY3RFdmVudEZpbHRlciIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciA8IGJsb2NrTnVtYmVyKSB7CiAgICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICAgIGZyb21CbG9jazogcHJldmlvdXNCbG9ja051bWJlciArIDFuLAogICAgICAgICAgICAgICAgICB0b0Jsb2NrOiBibG9ja051bWJlciwKICAgICAgICAgICAgICAgICAgc3RyaWN0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUNvbnRyYWN0RXZlbnQgPSAoKSA9PiB7CiAgICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gZmFsc2U7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaENvbnRyYWN0RXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50TmFtZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgc3RyaWN0CiAgICAgIF0pOwogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgOwogICAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSAoKCkgPT4gewogICAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHMuZmluZCgodHJhbnNwb3J0MykgPT4gdHJhbnNwb3J0My5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpOwogICAgICAgICAgICAgICAgaWYgKCF0cmFuc3BvcnQyKQogICAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc3BvcnQyLnZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgY29uc3QgdG9waWNzID0gZXZlbnROYW1lID8gZW5jb2RlRXZlbnRUb3BpY3MoewogICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgYXJncwogICAgICAgICAgICB9KSA6IFtdOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJsb2dzIiwgeyBhZGRyZXNzLCB0b3BpY3MgfV0sCiAgICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBjb25zdCBsb2cgPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZXZlbnROYW1lOiBldmVudE5hbWUyLCBhcmdzOiBhcmdzMiB9ID0gZGVjb2RlRXZlbnRMb2coewogICAgICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgICB0b3BpY3M6IGxvZy50b3BpY3MsCiAgICAgICAgICAgICAgICAgICAgc3RyaWN0OiBzdHJpY3RfCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRMb2cobG9nLCB7CiAgICAgICAgICAgICAgICAgICAgYXJnczogYXJnczIsCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TmFtZTI7CiAgICAgICAgICAgICAgICAgIGxldCBpc1VubmFtZWQ7CiAgICAgICAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dEYXRhTWlzbWF0Y2ggfHwgZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUyID0gZXJyLmFiaUl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgICAgICBpc1VubmFtZWQgPSBlcnIuYWJpSXRlbS5pbnB1dHM/LnNvbWUoKHgpID0+ICEoIm5hbWUiIGluIHggJiYgeC5uYW1lKSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgewogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSkoKTsKICAgICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgICAgfSk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQ29udHJhY3RFdmVudCgpIDogc3Vic2NyaWJlQ29udHJhY3RFdmVudCgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FjY291bnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQWNjb3VudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICBzdXBlcihbCiAgICAgICAgIkNvdWxkIG5vdCBmaW5kIGFuIEFjY291bnQgdG8gZXhlY3V0ZSB3aXRoIHRoaXMgQWN0aW9uLiIsCiAgICAgICAgIlBsZWFzZSBwcm92aWRlIGFuIEFjY291bnQgd2l0aCB0aGUgYGFjY291bnRgIGFyZ3VtZW50IG9uIHRoZSBBY3Rpb24sIG9yIGJ5IHN1cHBseWluZyBhbiBgYWNjb3VudGAgdG8gdGhlIENsaWVudC4iCiAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgZG9jc1NsdWc6ICJhY2NvdW50IiwKICAgICAgICBuYW1lOiAiQWNjb3VudE5vdEZvdW5kRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEFjY291bnRUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5LCBtZXRhTWVzc2FnZXMsIHR5cGUgfSkgewogICAgICBzdXBlcihgQWNjb3VudCB0eXBlICIke3R5cGV9IiBpcyBub3Qgc3VwcG9ydGVkLmAsIHsKICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgIG1ldGFNZXNzYWdlcywKICAgICAgICBuYW1lOiAiQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2Jhc2UoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2Fzc2VydEN1cnJlbnRDaGFpbi5qcwogIGluaXRfY2hhaW4oKTsKICBmdW5jdGlvbiBhc3NlcnRDdXJyZW50Q2hhaW4oeyBjaGFpbiwgY3VycmVudENoYWluSWQgfSkgewogICAgaWYgKCFjaGFpbikKICAgICAgdGhyb3cgbmV3IENoYWluTm90Rm91bmRFcnJvcigpOwogICAgaWYgKGN1cnJlbnRDaGFpbklkICE9PSBjaGFpbi5pZCkKICAgICAgdGhyb3cgbmV3IENoYWluTWlzbWF0Y2hFcnJvcih7IGNoYWluLCBjdXJyZW50Q2hhaW5JZCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0VHJhbnNhY3Rpb25FcnJvci5qcwogIGluaXRfbm9kZSgpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2dldE5vZGVFcnJvcigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIC4uLmFyZ3MgfSkgewogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBjb25zdCBjYXVzZTIgPSBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKTsKICAgICAgaWYgKGNhdXNlMiBpbnN0YW5jZW9mIFVua25vd25Ob2RlRXJyb3IpCiAgICAgICAgcmV0dXJuIGVycjsKICAgICAgcmV0dXJuIGNhdXNlMjsKICAgIH0pKCk7CiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2xydSgpOwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFJhd1RyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2VuZFJhd1RyYW5zYWN0aW9uKGNsaWVudCwgeyBzZXJpYWxpemVkVHJhbnNhY3Rpb24gfSkgewogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NlbmRSYXdUcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbl0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zZW5kVHJhbnNhY3Rpb24uanMKICB2YXIgc3VwcG9ydHNXYWxsZXROYW1lc3BhY2UgPSBuZXcgTHJ1TWFwKDEyOCk7CiAgYXN5bmMgZnVuY3Rpb24gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIGJsb2JzLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJCbG9iR2FzLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdmFsdWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogbnVsbDsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QocGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IHRvID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgICBpZiAocGFyYW1ldGVycy50bykKICAgICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLnRvOwogICAgICAgIGlmIChhdXRob3JpemF0aW9uTGlzdCAmJiBhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggPiAwKQogICAgICAgICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyh7CiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGF1dGhvcml6YXRpb25MaXN0WzBdCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgdG9gIGlzIHJlcXVpcmVkLiBDb3VsZCBub3QgaW5mZXIgZnJvbSBgYXV0aG9yaXphdGlvbkxpc3RgLiIpOwogICAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgfSkoKTsKICAgICAgaWYgKGFjY291bnQ/LnR5cGUgPT09ICJqc29uLXJwYyIgfHwgYWNjb3VudCA9PT0gbnVsbCkgewogICAgICAgIGxldCBjaGFpbklkOwogICAgICAgIGlmIChjaGFpbiAhPT0gbnVsbCkgewogICAgICAgICAgY2hhaW5JZCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldENoYWluSWQsICJnZXRDaGFpbklkIikoe30pOwogICAgICAgICAgYXNzZXJ0Q3VycmVudENoYWluKHsKICAgICAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgICAgIGNoYWluCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAgIGJsb2JzLAogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgICBtYXhGZWVQZXJCbG9iR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUKICAgICAgICB9KTsKICAgICAgICBjb25zdCBtZXRob2QgPSBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5nZXQoY2xpZW50LnVpZCkgPyAid2FsbGV0X3NlbmRUcmFuc2FjdGlvbiIgOiAiZXRoX3NlbmRUcmFuc2FjdGlvbiI7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgcGFyYW1zOiBbcmVxdWVzdF0KICAgICAgICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIkludmFsaWRJbnB1dFJwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiTWV0aG9kTm90Rm91bmRScGNFcnJvciIgfHwgZXJyb3IubmFtZSA9PT0gIk1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIikKICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBtZXRob2Q6ICJ3YWxsZXRfc2VuZFRyYW5zYWN0aW9uIiwKICAgICAgICAgICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgICAgICAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSkudGhlbigoaGFzaDMpID0+IHsKICAgICAgICAgICAgICBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5zZXQoY2xpZW50LnVpZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0dXJuIGhhc2gzOwogICAgICAgICAgICB9KTsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gImxvY2FsIikgewogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LCAicHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdCIpKHsKICAgICAgICAgIGFjY291bnQsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3QsCiAgICAgICAgICBibG9icywKICAgICAgICAgIGNoYWluLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGdhcywKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBub25jZU1hbmFnZXI6IGFjY291bnQubm9uY2VNYW5hZ2VyLAogICAgICAgICAgcGFyYW1ldGVyczogWy4uLmRlZmF1bHRQYXJhbWV0ZXJzLCAic2lkZWNhcnMiXSwKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgLi4ucmVzdCwKICAgICAgICAgIHRvCiAgICAgICAgfSk7CiAgICAgICAgY29uc3Qgc2VyaWFsaXplciA9IGNoYWluPy5zZXJpYWxpemVycz8udHJhbnNhY3Rpb247CiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gYXdhaXQgYWNjb3VudC5zaWduVHJhbnNhY3Rpb24ocmVxdWVzdCwgewogICAgICAgICAgc2VyaWFsaXplcgogICAgICAgIH0pOwogICAgICAgIHJldHVybiBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBzZW5kUmF3VHJhbnNhY3Rpb24sICJzZW5kUmF3VHJhbnNhY3Rpb24iKSh7CiAgICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gInNtYXJ0IikKICAgICAgICB0aHJvdyBuZXcgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcih7CiAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgIkNvbnNpZGVyIHVzaW5nIHRoZSBgc2VuZFVzZXJPcGVyYXRpb25gIEFjdGlvbiBpbnN0ZWFkLiIKICAgICAgICAgIF0sCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvYnVuZGxlci9zZW5kVXNlck9wZXJhdGlvbiIsCiAgICAgICAgICB0eXBlOiAic21hcnQiCiAgICAgICAgfSk7CiAgICAgIHRocm93IG5ldyBBY2NvdW50VHlwZU5vdFN1cHBvcnRlZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIsCiAgICAgICAgdHlwZTogYWNjb3VudD8udHlwZQogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcikKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIHRocm93IGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7CiAgICAgICAgLi4ucGFyYW1ldGVycywKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBwYXJhbWV0ZXJzLmNoYWluIHx8IHZvaWQgMAogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC93cml0ZUNvbnRyYWN0LmpzCiAgYXN5bmMgZnVuY3Rpb24gd3JpdGVDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBhZGRyZXNzLCBhcmdzLCBkYXRhU3VmZml4LCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L3dyaXRlQ29udHJhY3QiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IG51bGw7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgcmV0dXJuIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHNlbmRUcmFuc2FjdGlvbiwgInNlbmRUcmFuc2FjdGlvbiIpKHsKICAgICAgICBkYXRhOiBgJHtkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgLi4ucmVxdWVzdAogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3Qvd3JpdGVDb250cmFjdCIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2dldENvbnRyYWN0LmpzCiAgZnVuY3Rpb24gZ2V0Q29udHJhY3QoeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGNsaWVudDogY2xpZW50XyB9KSB7CiAgICBjb25zdCBjbGllbnQgPSBjbGllbnRfOwogICAgY29uc3QgW3B1YmxpY0NsaWVudCwgd2FsbGV0Q2xpZW50XSA9ICgoKSA9PiB7CiAgICAgIGlmICghY2xpZW50KQogICAgICAgIHJldHVybiBbdm9pZCAwLCB2b2lkIDBdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50ICYmICJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW2NsaWVudC5wdWJsaWMsIGNsaWVudC53YWxsZXRdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50KQogICAgICAgIHJldHVybiBbY2xpZW50LnB1YmxpYywgdm9pZCAwXTsKICAgICAgaWYgKCJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW3ZvaWQgMCwgY2xpZW50LndhbGxldF07CiAgICAgIHJldHVybiBbY2xpZW50LCBjbGllbnRdOwogICAgfSkoKTsKICAgIGNvbnN0IGhhc1B1YmxpY0NsaWVudCA9IHB1YmxpY0NsaWVudCAhPT0gdm9pZCAwICYmIHB1YmxpY0NsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGhhc1dhbGxldENsaWVudCA9IHdhbGxldENsaWVudCAhPT0gdm9pZCAwICYmIHdhbGxldENsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGNvbnRyYWN0ID0ge307CiAgICBsZXQgaGFzUmVhZEZ1bmN0aW9uID0gZmFsc2U7CiAgICBsZXQgaGFzV3JpdGVGdW5jdGlvbiA9IGZhbHNlOwogICAgbGV0IGhhc0V2ZW50ID0gZmFsc2U7CiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgYWJpMikgewogICAgICBpZiAoaXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgIGlmIChpdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInZpZXciIHx8IGl0ZW0uc3RhdGVNdXRhYmlsaXR5ID09PSAicHVyZSIpCiAgICAgICAgICBoYXNSZWFkRnVuY3Rpb24gPSB0cnVlOwogICAgICAgIGVsc2UKICAgICAgICAgIGhhc1dyaXRlRnVuY3Rpb24gPSB0cnVlOwogICAgICBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICJldmVudCIpCiAgICAgICAgaGFzRXZlbnQgPSB0cnVlOwogICAgICBpZiAoaGFzUmVhZEZ1bmN0aW9uICYmIGhhc1dyaXRlRnVuY3Rpb24gJiYgaGFzRXZlbnQpCiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBpZiAoaGFzUHVibGljQ2xpZW50KSB7CiAgICAgIGlmIChoYXNSZWFkRnVuY3Rpb24pCiAgICAgICAgY29udHJhY3QucmVhZCA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0IikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGZ1bmN0aW9uTmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LnNpbXVsYXRlID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCBzaW11bGF0ZUNvbnRyYWN0LCAic2ltdWxhdGVDb250cmFjdCIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICBpZiAoaGFzRXZlbnQpIHsKICAgICAgICBjb250cmFjdC5jcmVhdGVFdmVudEZpbHRlciA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGV2ZW50TmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCBhYmlFdmVudCA9IGFiaTIuZmluZCgoeCkgPT4geC50eXBlID09PSAiZXZlbnQiICYmIHgubmFtZSA9PT0gZXZlbnROYW1lKTsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEV2ZW50UGFyYW1ldGVycyhwYXJhbWV0ZXJzLCBhYmlFdmVudCk7CiAgICAgICAgICAgICAgcmV0dXJuIGdldEFjdGlvbihwdWJsaWNDbGllbnQsIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIsICJjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyIikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGV2ZW50TmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgY29udHJhY3QuZ2V0RXZlbnRzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZXZlbnROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IGFiaUV2ZW50ID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgeC5uYW1lID09PSBldmVudE5hbWUpOwogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RXZlbnRQYXJhbWV0ZXJzKHBhcmFtZXRlcnMsIGFiaUV2ZW50KTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGNvbnRyYWN0LndhdGNoRXZlbnQgPSBuZXcgUHJveHkoe30sIHsKICAgICAgICAgIGdldChfLCBldmVudE5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuICguLi5wYXJhbWV0ZXJzKSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgYWJpRXZlbnQgPSBhYmkyLmZpbmQoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IiAmJiB4Lm5hbWUgPT09IGV2ZW50TmFtZSk7CiAgICAgICAgICAgICAgY29uc3QgeyBhcmdzLCBvcHRpb25zIH0gPSBnZXRFdmVudFBhcmFtZXRlcnMocGFyYW1ldGVycywgYWJpRXZlbnQpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCB3YXRjaENvbnRyYWN0RXZlbnQsICJ3YXRjaENvbnRyYWN0RXZlbnQiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgaWYgKGhhc1dhbGxldENsaWVudCkgewogICAgICBpZiAoaGFzV3JpdGVGdW5jdGlvbikKICAgICAgICBjb250cmFjdC53cml0ZSA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHdhbGxldENsaWVudCwgd3JpdGVDb250cmFjdCwgIndyaXRlQ29udHJhY3QiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGlmIChoYXNQdWJsaWNDbGllbnQgfHwgaGFzV2FsbGV0Q2xpZW50KSB7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LmVzdGltYXRlR2FzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIGNvbnN0IGNsaWVudDIgPSBwdWJsaWNDbGllbnQgPz8gd2FsbGV0Q2xpZW50OwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24oY2xpZW50MiwgZXN0aW1hdGVDb250cmFjdEdhcywgImVzdGltYXRlQ29udHJhY3RHYXMiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsCiAgICAgICAgICAgICAgICBhY2NvdW50OiBvcHRpb25zLmFjY291bnQgPz8gd2FsbGV0Q2xpZW50LmFjY291bnQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGNvbnRyYWN0LmFkZHJlc3MgPSBhZGRyZXNzOwogICAgY29udHJhY3QuYWJpID0gYWJpMjsKICAgIHJldHVybiBjb250cmFjdDsKICB9CiAgZnVuY3Rpb24gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHZhbHVlcykgewogICAgY29uc3QgaGFzQXJncyA9IHZhbHVlcy5sZW5ndGggJiYgQXJyYXkuaXNBcnJheSh2YWx1ZXNbMF0pOwogICAgY29uc3QgYXJncyA9IGhhc0FyZ3MgPyB2YWx1ZXNbMF0gOiBbXTsKICAgIGNvbnN0IG9wdGlvbnMgPSAoaGFzQXJncyA/IHZhbHVlc1sxXSA6IHZhbHVlc1swXSkgPz8ge307CiAgICByZXR1cm4geyBhcmdzLCBvcHRpb25zIH07CiAgfQogIGZ1bmN0aW9uIGdldEV2ZW50UGFyYW1ldGVycyh2YWx1ZXMsIGFiaUV2ZW50KSB7CiAgICBsZXQgaGFzQXJncyA9IGZhbHNlOwogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzWzBdKSkKICAgICAgaGFzQXJncyA9IHRydWU7CiAgICBlbHNlIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxKSB7CiAgICAgIGhhc0FyZ3MgPSBhYmlFdmVudC5pbnB1dHMuc29tZSgoeCkgPT4geC5pbmRleGVkKTsKICAgIH0gZWxzZSBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMikgewogICAgICBoYXNBcmdzID0gdHJ1ZTsKICAgIH0KICAgIGNvbnN0IGFyZ3MgPSBoYXNBcmdzID8gdmFsdWVzWzBdIDogdm9pZCAwOwogICAgY29uc3Qgb3B0aW9ucyA9IChoYXNBcmdzID8gdmFsdWVzWzFdIDogdmFsdWVzWzBdKSA/PyB7fTsKICAgIHJldHVybiB7IGFyZ3MsIG9wdGlvbnMgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZWlwNzEyLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgc3VwZXIoYE5vIEVJUC03MTIgZG9tYWluIGZvdW5kIG9uIGNvbnRyYWN0ICIke2FkZHJlc3N9Ii5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiRW5zdXJlIHRoYXQ6IiwKICAgICAgICAgIGAtIFRoZSBjb250cmFjdCBpcyBkZXBsb3llZCBhdCB0aGUgYWRkcmVzcyAiJHthZGRyZXNzfSIuYCwKICAgICAgICAgICItIGBlaXA3MTJEb21haW4oKWAgZnVuY3Rpb24gZXhpc3RzIG9uIHRoZSBjb250cmFjdC4iLAogICAgICAgICAgIi0gYGVpcDcxMkRvbWFpbigpYCBmdW5jdGlvbiBtYXRjaGVzIHNpZ25hdHVyZSB0byBFUkMtNTI2NyBzcGVjaWZpY2F0aW9uLiIKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFaXA3MTJEb21haW5Ob3RGb3VuZEVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RWlwNzEyRG9tYWluKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSB9ID0gcGFyYW1ldGVyczsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFtmaWVsZHMsIG5hbWUsIHZlcnNpb24zLCBjaGFpbklkLCB2ZXJpZnlpbmdDb250cmFjdCwgc2FsdCwgZXh0ZW5zaW9uc10gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgICAgYWJpLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgZnVuY3Rpb25OYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgICBmYWN0b3J5LAogICAgICAgIGZhY3RvcnlEYXRhCiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGRvbWFpbjogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIHZlcnNpb246IHZlcnNpb24zLAogICAgICAgICAgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpLAogICAgICAgICAgdmVyaWZ5aW5nQ29udHJhY3QsCiAgICAgICAgICBzYWx0CiAgICAgICAgfSwKICAgICAgICBleHRlbnNpb25zLAogICAgICAgIGZpZWxkcwogICAgICB9OwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgIGlmIChlcnJvci5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yIiAmJiBlcnJvci5jYXVzZS5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IiKSB7CiAgICAgICAgdGhyb3cgbmV3IEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICB9CiAgICAgIHRocm93IGVycm9yOwogICAgfQogIH0KICB2YXIgYWJpID0gWwogICAgewogICAgICBpbnB1dHM6IFtdLAogICAgICBuYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgb3V0cHV0czogWwogICAgICAgIHsgbmFtZTogImZpZWxkcyIsIHR5cGU6ICJieXRlczEiIH0sCiAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAidmVyc2lvbiIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAiY2hhaW5JZCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgIHsgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwgdHlwZTogImFkZHJlc3MiIH0sCiAgICAgICAgeyBuYW1lOiAic2FsdCIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIHsgbmFtZTogImV4dGVuc2lvbnMiLCB0eXBlOiAidWludDI1NltdIiB9CiAgICAgIF0sCiAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICB9CiAgXTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L2FkZENoYWluLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGFkZENoYWluKGNsaWVudCwgeyBjaGFpbiB9KSB7CiAgICBjb25zdCB7IGlkLCBuYW1lLCBuYXRpdmVDdXJyZW5jeSwgcnBjVXJscywgYmxvY2tFeHBsb3JlcnMgfSA9IGNoYWluOwogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfYWRkRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKSwKICAgICAgICAgIGNoYWluTmFtZTogbmFtZSwKICAgICAgICAgIG5hdGl2ZUN1cnJlbmN5LAogICAgICAgICAgcnBjVXJsczogcnBjVXJscy5kZWZhdWx0Lmh0dHAsCiAgICAgICAgICBibG9ja0V4cGxvcmVyVXJsczogYmxvY2tFeHBsb3JlcnMgPyBPYmplY3QudmFsdWVzKGJsb2NrRXhwbG9yZXJzKS5tYXAoKHsgdXJsIH0pID0+IHVybCkgOiB2b2lkIDAKICAgICAgICB9CiAgICAgIF0KICAgIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VpZC5qcwogIHZhciBzaXplMiA9IDI1NjsKICB2YXIgaW5kZXggPSBzaXplMjsKICB2YXIgYnVmZmVyOwogIGZ1bmN0aW9uIHVpZChsZW5ndGggPSAxMSkgewogICAgaWYgKCFidWZmZXIgfHwgaW5kZXggKyBsZW5ndGggPiBzaXplMiAqIDIpIHsKICAgICAgYnVmZmVyID0gIiI7CiAgICAgIGluZGV4ID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplMjsgaSsrKSB7CiAgICAgICAgYnVmZmVyICs9ICgyNTYgKyBNYXRoLnJhbmRvbSgpICogMjU2IHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGJ1ZmZlci5zdWJzdHJpbmcoaW5kZXgsIGluZGV4KysgKyBsZW5ndGgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGNhY2hlVGltZSA9IHBhcmFtZXRlcnMucG9sbGluZ0ludGVydmFsID8/IDRlMywgY2NpcFJlYWQsIGtleSA9ICJiYXNlIiwgbmFtZSA9ICJCYXNlIENsaWVudCIsIHBvbGxpbmdJbnRlcnZhbCA9IDRlMywgdHlwZSA9ICJiYXNlIiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNoYWluID0gcGFyYW1ldGVycy5jaGFpbjsKICAgIGNvbnN0IGFjY291bnQgPSBwYXJhbWV0ZXJzLmFjY291bnQgPyBwYXJzZUFjY291bnQocGFyYW1ldGVycy5hY2NvdW50KSA6IHZvaWQgMDsKICAgIGNvbnN0IHsgY29uZmlnLCByZXF1ZXN0LCB2YWx1ZSB9ID0gcGFyYW1ldGVycy50cmFuc3BvcnQoewogICAgICBjaGFpbiwKICAgICAgcG9sbGluZ0ludGVydmFsCiAgICB9KTsKICAgIGNvbnN0IHRyYW5zcG9ydCA9IHsgLi4uY29uZmlnLCAuLi52YWx1ZSB9OwogICAgY29uc3QgY2xpZW50ID0gewogICAgICBhY2NvdW50LAogICAgICBiYXRjaCwKICAgICAgY2FjaGVUaW1lLAogICAgICBjY2lwUmVhZCwKICAgICAgY2hhaW4sCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgcG9sbGluZ0ludGVydmFsLAogICAgICByZXF1ZXN0LAogICAgICB0cmFuc3BvcnQsCiAgICAgIHR5cGUsCiAgICAgIHVpZDogdWlkKCkKICAgIH07CiAgICBmdW5jdGlvbiBleHRlbmQoYmFzZTIpIHsKICAgICAgcmV0dXJuIChleHRlbmRGbikgPT4gewogICAgICAgIGNvbnN0IGV4dGVuZGVkID0gZXh0ZW5kRm4oYmFzZTIpOwogICAgICAgIGZvciAoY29uc3Qga2V5MiBpbiBjbGllbnQpCiAgICAgICAgICBkZWxldGUgZXh0ZW5kZWRba2V5Ml07CiAgICAgICAgY29uc3QgY29tYmluZWQgPSB7IC4uLmJhc2UyLCAuLi5leHRlbmRlZCB9OwogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNvbWJpbmVkLCB7IGV4dGVuZDogZXh0ZW5kKGNvbWJpbmVkKSB9KTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNsaWVudCwgeyBleHRlbmQ6IGV4dGVuZChjbGllbnQpIH0pOwogIH0KICBmdW5jdGlvbiBycGNTY2hlbWEoKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9idWlsZFJlcXVlc3QuanMKICBpbml0X2Jhc2UoKTsKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X3JwYygpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoRGVkdXBlLmpzCiAgaW5pdF9scnUoKTsKICB2YXIgcHJvbWlzZUNhY2hlMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTHJ1TWFwKDgxOTIpOwogIGZ1bmN0aW9uIHdpdGhEZWR1cGUoZm4sIHsgZW5hYmxlZCA9IHRydWUsIGlkIH0pIHsKICAgIGlmICghZW5hYmxlZCB8fCAhaWQpCiAgICAgIHJldHVybiBmbigpOwogICAgaWYgKHByb21pc2VDYWNoZTIuZ2V0KGlkKSkKICAgICAgcmV0dXJuIHByb21pc2VDYWNoZTIuZ2V0KGlkKTsKICAgIGNvbnN0IHByb21pc2UgPSBmbigpLmZpbmFsbHkoKCkgPT4gcHJvbWlzZUNhY2hlMi5kZWxldGUoaWQpKTsKICAgIHByb21pc2VDYWNoZTIuc2V0KGlkLCBwcm9taXNlKTsKICAgIHJldHVybiBwcm9taXNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Byb21pc2Uvd2l0aFJldHJ5LmpzCiAgZnVuY3Rpb24gd2l0aFJldHJ5KGZuLCB7IGRlbGF5OiBkZWxheV8gPSAxMDAsIHJldHJ5Q291bnQgPSAyLCBzaG91bGRSZXRyeTogc2hvdWxkUmV0cnkyID0gKCkgPT4gdHJ1ZSB9ID0ge30pIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IGF0dGVtcHRSZXRyeSA9IGFzeW5jICh7IGNvdW50ID0gMCB9ID0ge30pID0+IHsKICAgICAgICBjb25zdCByZXRyeSA9IGFzeW5jICh7IGVycm9yIH0pID0+IHsKICAgICAgICAgIGNvbnN0IGRlbGF5ID0gdHlwZW9mIGRlbGF5XyA9PT0gImZ1bmN0aW9uIiA/IGRlbGF5Xyh7IGNvdW50LCBlcnJvciB9KSA6IGRlbGF5XzsKICAgICAgICAgIGlmIChkZWxheSkKICAgICAgICAgICAgYXdhaXQgd2FpdChkZWxheSk7CiAgICAgICAgICBhdHRlbXB0UmV0cnkoeyBjb3VudDogY291bnQgKyAxIH0pOwogICAgICAgIH07CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmbigpOwogICAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGlmIChjb3VudCA8IHJldHJ5Q291bnQgJiYgYXdhaXQgc2hvdWxkUmV0cnkyKHsgY291bnQsIGVycm9yOiBlcnIgfSkpCiAgICAgICAgICAgIHJldHVybiByZXRyeSh7IGVycm9yOiBlcnIgfSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIGF0dGVtcHRSZXRyeSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYnVpbGRSZXF1ZXN0LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBmdW5jdGlvbiBidWlsZFJlcXVlc3QocmVxdWVzdCwgb3B0aW9ucyA9IHt9KSB7CiAgICByZXR1cm4gYXN5bmMgKGFyZ3MsIG92ZXJyaWRlT3B0aW9ucyA9IHt9KSA9PiB7CiAgICAgIGNvbnN0IHsgZGVkdXBlID0gZmFsc2UsIHJldHJ5RGVsYXkgPSAxNTAsIHJldHJ5Q291bnQgPSAzLCB1aWQ6IHVpZDIgfSA9IHsKICAgICAgICAuLi5vcHRpb25zLAogICAgICAgIC4uLm92ZXJyaWRlT3B0aW9ucwogICAgICB9OwogICAgICBjb25zdCByZXF1ZXN0SWQgPSBkZWR1cGUgPyBrZWNjYWsyNTYoc3RyaW5nVG9IZXgoYCR7dWlkMn0uJHtzdHJpbmdpZnkoYXJncyl9YCkpIDogdm9pZCAwOwogICAgICByZXR1cm4gd2l0aERlZHVwZSgoKSA9PiB3aXRoUmV0cnkoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVxdWVzdChhcmdzKTsKICAgICAgICB9IGNhdGNoIChlcnJfKSB7CiAgICAgICAgICBjb25zdCBlcnIgPSBlcnJfOwogICAgICAgICAgc3dpdGNoIChlcnIuY29kZSkgewogICAgICAgICAgICAvLyAtMzI3MDAKICAgICAgICAgICAgY2FzZSBQYXJzZVJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNlUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyNjAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFJlcXVlc3RScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjYwMQogICAgICAgICAgICBjYXNlIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90Rm91bmRScGNFcnJvcihlcnIsIHsgbWV0aG9kOiBhcmdzLm1ldGhvZCB9KTsKICAgICAgICAgICAgLy8gLTMyNjAyCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFBhcmFtc1JwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbXNScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzI2MDMKICAgICAgICAgICAgY2FzZSBJbnRlcm5hbFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZElucHV0UnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZElucHV0UnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAxCiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlc291cmNlTm90Rm91bmRScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzIwMDIKICAgICAgICAgICAgY2FzZSBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjAwMwogICAgICAgICAgICBjYXNlIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA0CiAgICAgICAgICAgIGNhc2UgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IoZXJyLCB7CiAgICAgICAgICAgICAgICBtZXRob2Q6IGFyZ3MubWV0aG9kCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIC0zMjAwNQogICAgICAgICAgICBjYXNlIExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA2CiAgICAgICAgICAgIGNhc2UgSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MDAxCiAgICAgICAgICAgIGNhc2UgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MTAwCiAgICAgICAgICAgIGNhc2UgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQyMDAKICAgICAgICAgICAgY2FzZSBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQ5MDAKICAgICAgICAgICAgY2FzZSBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gNDkwMQogICAgICAgICAgICBjYXNlIENoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2hhaW5EaXNjb25uZWN0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0OTAyCiAgICAgICAgICAgIGNhc2UgU3dpdGNoQ2hhaW5FcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBTd2l0Y2hDaGFpbkVycm9yKGVycik7CiAgICAgICAgICAgIC8vIENBSVAtMjU6IFVzZXIgUmVqZWN0ZWQgRXJyb3IKICAgICAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLndhbGxldGNvbm5lY3QuY29tLzIuMC9zcGVjcy9jbGllbnRzL3NpZ24vZXJyb3ItY29kZXMjcmVqZWN0ZWQtY2FpcC0yNQogICAgICAgICAgICBjYXNlIDVlMzoKICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yKGVycik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgaWYgKGVycl8gaW5zdGFuY2VvZiBCYXNlRXJyb3IyKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyXzsKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5rbm93blJwY0Vycm9yKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZGVsYXk6ICh7IGNvdW50LCBlcnJvciB9KSA9PiB7CiAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yKSB7CiAgICAgICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBlcnJvcj8uaGVhZGVycz8uZ2V0KCJSZXRyeS1BZnRlciIpOwogICAgICAgICAgICBpZiAocmV0cnlBZnRlcj8ubWF0Y2goL1xkLykpCiAgICAgICAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUludChyZXRyeUFmdGVyKSAqIDFlMzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB+figxIDw8IGNvdW50KSAqIHJldHJ5RGVsYXk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHNob3VsZFJldHJ5OiAoeyBlcnJvciB9KSA9PiBzaG91bGRSZXRyeShlcnJvcikKICAgICAgfSksIHsgZW5hYmxlZDogZGVkdXBlLCBpZDogcmVxdWVzdElkIH0pOwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkUmV0cnkoZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSAtMSkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLmNvZGUgPT09IExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3IuY29kZSA9PT0gSW50ZXJuYWxScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yICYmIGVycm9yLnN0YXR1cykgewogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwOCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDEzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MjkpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwMCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNTAyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA1MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwNCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2NyZWF0ZVRyYW5zcG9ydC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zcG9ydCh7IGtleSwgbmFtZSwgcmVxdWVzdCwgcmV0cnlDb3VudCA9IDMsIHJldHJ5RGVsYXkgPSAxNTAsIHRpbWVvdXQsIHR5cGUgfSwgdmFsdWUpIHsKICAgIGNvbnN0IHVpZDIgPSB1aWQoKTsKICAgIHJldHVybiB7CiAgICAgIGNvbmZpZzogewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIHJlcXVlc3QsCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZQogICAgICB9LAogICAgICByZXF1ZXN0OiBidWlsZFJlcXVlc3QocmVxdWVzdCwgeyByZXRyeUNvdW50LCByZXRyeURlbGF5LCB1aWQ6IHVpZDIgfSksCiAgICAgIHZhbHVlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvdHJhbnNwb3J0cy9jdXN0b20uanMKICBmdW5jdGlvbiBjdXN0b20ocHJvdmlkZXIsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtleSA9ICJjdXN0b20iLCBuYW1lID0gIkN1c3RvbSBQcm92aWRlciIsIHJldHJ5RGVsYXkgfSA9IGNvbmZpZzsKICAgIHJldHVybiAoeyByZXRyeUNvdW50OiBkZWZhdWx0UmV0cnlDb3VudCB9KSA9PiBjcmVhdGVUcmFuc3BvcnQoewogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHJlcXVlc3Q6IHByb3ZpZGVyLnJlcXVlc3QuYmluZChwcm92aWRlciksCiAgICAgIHJldHJ5Q291bnQ6IGNvbmZpZy5yZXRyeUNvdW50ID8/IGRlZmF1bHRSZXRyeUNvdW50LAogICAgICByZXRyeURlbGF5LAogICAgICB0eXBlOiAiY3VzdG9tIgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2ZhbGxiYWNrLmpzCiAgaW5pdF9ycGMoKTsKICBmdW5jdGlvbiBmYWxsYmFjayh0cmFuc3BvcnRzXywgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsga2V5ID0gImZhbGxiYWNrIiwgbmFtZSA9ICJGYWxsYmFjayIsIHJhbmsgPSBmYWxzZSwgcmV0cnlDb3VudCwgcmV0cnlEZWxheSB9ID0gY29uZmlnOwogICAgcmV0dXJuICh7IGNoYWluLCBwb2xsaW5nSW50ZXJ2YWwgPSA0ZTMsIHRpbWVvdXQsIC4uLnJlc3QgfSkgPT4gewogICAgICBsZXQgdHJhbnNwb3J0cyA9IHRyYW5zcG9ydHNfOwogICAgICBsZXQgb25SZXNwb25zZSA9ICgpID0+IHsKICAgICAgfTsKICAgICAgY29uc3QgdHJhbnNwb3J0ID0gY3JlYXRlVHJhbnNwb3J0KHsKICAgICAgICBrZXksCiAgICAgICAgbmFtZSwKICAgICAgICBhc3luYyByZXF1ZXN0KHsgbWV0aG9kLCBwYXJhbXMgfSkgewogICAgICAgICAgY29uc3QgZmV0Y2gyID0gYXN5bmMgKGkgPSAwKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSB0cmFuc3BvcnRzW2ldKHsKICAgICAgICAgICAgICAuLi5yZXN0LAogICAgICAgICAgICAgIGNoYWluLAogICAgICAgICAgICAgIHJldHJ5Q291bnQ6IDAsCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRyYW5zcG9ydDIucmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2QsCiAgICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBvblJlc3BvbnNlKHsKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHJlc3BvbnNlLAogICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQyLAogICAgICAgICAgICAgICAgc3RhdHVzOiAic3VjY2VzcyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIG9uUmVzcG9uc2UoewogICAgICAgICAgICAgICAgZXJyb3I6IGVyciwKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0MiwKICAgICAgICAgICAgICAgIHN0YXR1czogImVycm9yIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlmIChzaG91bGRUaHJvdyhlcnIpKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgIGlmIChpID09PSB0cmFuc3BvcnRzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgcmV0dXJuIGZldGNoMihpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gZmV0Y2gyKCk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHJldHJ5RGVsYXksCiAgICAgICAgdHlwZTogImZhbGxiYWNrIgogICAgICB9LCB7CiAgICAgICAgb25SZXNwb25zZTogKGZuKSA9PiBvblJlc3BvbnNlID0gZm4sCiAgICAgICAgdHJhbnNwb3J0czogdHJhbnNwb3J0cy5tYXAoKGZuKSA9PiBmbih7IGNoYWluLCByZXRyeUNvdW50OiAwIH0pKQogICAgICB9KTsKICAgICAgaWYgKHJhbmspIHsKICAgICAgICBjb25zdCByYW5rT3B0aW9ucyA9IHR5cGVvZiByYW5rID09PSAib2JqZWN0IiA/IHJhbmsgOiB7fTsKICAgICAgICByYW5rVHJhbnNwb3J0cyh7CiAgICAgICAgICBjaGFpbiwKICAgICAgICAgIGludGVydmFsOiByYW5rT3B0aW9ucy5pbnRlcnZhbCA/PyBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgICBvblRyYW5zcG9ydHM6ICh0cmFuc3BvcnRzXzIpID0+IHRyYW5zcG9ydHMgPSB0cmFuc3BvcnRzXzIsCiAgICAgICAgICBzYW1wbGVDb3VudDogcmFua09wdGlvbnMuc2FtcGxlQ291bnQsCiAgICAgICAgICB0aW1lb3V0OiByYW5rT3B0aW9ucy50aW1lb3V0LAogICAgICAgICAgdHJhbnNwb3J0cywKICAgICAgICAgIHdlaWdodHM6IHJhbmtPcHRpb25zLndlaWdodHMKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gdHJhbnNwb3J0OwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkVGhyb3coZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSA1ZTMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGZ1bmN0aW9uIHJhbmtUcmFuc3BvcnRzKHsgY2hhaW4sIGludGVydmFsID0gNGUzLCBvblRyYW5zcG9ydHMsIHNhbXBsZUNvdW50ID0gMTAsIHRpbWVvdXQgPSAxZTMsIHRyYW5zcG9ydHMsIHdlaWdodHMgPSB7fSB9KSB7CiAgICBjb25zdCB7IHN0YWJpbGl0eTogc3RhYmlsaXR5V2VpZ2h0ID0gMC43LCBsYXRlbmN5OiBsYXRlbmN5V2VpZ2h0ID0gMC4zIH0gPSB3ZWlnaHRzOwogICAgY29uc3Qgc2FtcGxlcyA9IFtdOwogICAgY29uc3QgcmFua1RyYW5zcG9ydHNfID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBzYW1wbGUgPSBhd2FpdCBQcm9taXNlLmFsbCh0cmFuc3BvcnRzLm1hcChhc3luYyAodHJhbnNwb3J0KSA9PiB7CiAgICAgICAgY29uc3QgdHJhbnNwb3J0XyA9IHRyYW5zcG9ydCh7IGNoYWluLCByZXRyeUNvdW50OiAwLCB0aW1lb3V0IH0pOwogICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTsKICAgICAgICBsZXQgZW5kOwogICAgICAgIGxldCBzdWNjZXNzOwogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCB0cmFuc3BvcnRfLnJlcXVlc3QoeyBtZXRob2Q6ICJuZXRfbGlzdGVuaW5nIiB9KTsKICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgc3VjY2VzcyA9IDA7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGVuZCA9IERhdGUubm93KCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxhdGVuY3kgPSBlbmQgLSBzdGFydDsKICAgICAgICByZXR1cm4geyBsYXRlbmN5LCBzdWNjZXNzIH07CiAgICAgIH0pKTsKICAgICAgc2FtcGxlcy5wdXNoKHNhbXBsZSk7CiAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA+IHNhbXBsZUNvdW50KQogICAgICAgIHNhbXBsZXMuc2hpZnQoKTsKICAgICAgY29uc3QgbWF4TGF0ZW5jeSA9IE1hdGgubWF4KC4uLnNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBNYXRoLm1heCguLi5zYW1wbGUyLm1hcCgoeyBsYXRlbmN5IH0pID0+IGxhdGVuY3kpKSkpOwogICAgICBjb25zdCBzY29yZXMgPSB0cmFuc3BvcnRzLm1hcCgoXywgaSkgPT4gewogICAgICAgIGNvbnN0IGxhdGVuY2llcyA9IHNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBzYW1wbGUyW2ldLmxhdGVuY3kpOwogICAgICAgIGNvbnN0IG1lYW5MYXRlbmN5ID0gbGF0ZW5jaWVzLnJlZHVjZSgoYWNjLCBsYXRlbmN5KSA9PiBhY2MgKyBsYXRlbmN5LCAwKSAvIGxhdGVuY2llcy5sZW5ndGg7CiAgICAgICAgY29uc3QgbGF0ZW5jeVNjb3JlID0gMSAtIG1lYW5MYXRlbmN5IC8gbWF4TGF0ZW5jeTsKICAgICAgICBjb25zdCBzdWNjZXNzZXMgPSBzYW1wbGVzLm1hcCgoc2FtcGxlMikgPT4gc2FtcGxlMltpXS5zdWNjZXNzKTsKICAgICAgICBjb25zdCBzdGFiaWxpdHlTY29yZSA9IHN1Y2Nlc3Nlcy5yZWR1Y2UoKGFjYywgc3VjY2VzcykgPT4gYWNjICsgc3VjY2VzcywgMCkgLyBzdWNjZXNzZXMubGVuZ3RoOwogICAgICAgIGlmIChzdGFiaWxpdHlTY29yZSA9PT0gMCkKICAgICAgICAgIHJldHVybiBbMCwgaV07CiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgIGxhdGVuY3lXZWlnaHQgKiBsYXRlbmN5U2NvcmUgKyBzdGFiaWxpdHlXZWlnaHQgKiBzdGFiaWxpdHlTY29yZSwKICAgICAgICAgIGkKICAgICAgICBdOwogICAgICB9KS5zb3J0KChhLCBiKSA9PiBiWzBdIC0gYVswXSk7CiAgICAgIG9uVHJhbnNwb3J0cyhzY29yZXMubWFwKChbLCBpXSkgPT4gdHJhbnNwb3J0c1tpXSkpOwogICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgICB9OwogICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc3BvcnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgVXJsUmVxdWlyZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoIk5vIFVSTCB3YXMgcHJvdmlkZWQgdG8gdGhlIFRyYW5zcG9ydC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBSUEMgVVJMIHRvIHRoZSBUcmFuc3BvcnQuIiwgewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY2xpZW50cy9pbnRybyIsCiAgICAgICAgbmFtZTogIlVybFJlcXVpcmVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL3RyYW5zcG9ydHMvaHR0cC5qcwogIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9odHRwLmpzCiAgaW5pdF9yZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhUaW1lb3V0LmpzCiAgZnVuY3Rpb24gd2l0aFRpbWVvdXQoZm4sIHsgZXJyb3JJbnN0YW5jZSA9IG5ldyBFcnJvcigidGltZWQgb3V0IiksIHRpbWVvdXQsIHNpZ25hbCB9KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICA7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgbGV0IHRpbWVvdXRJZDsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgICAgICAgIGlmICh0aW1lb3V0ID4gMCkgewogICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoc2lnbmFsKSB7CiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlamVjdChlcnJvckluc3RhbmNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHRpbWVvdXQpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShhd2FpdCBmbih7IHNpZ25hbDogY29udHJvbGxlcj8uc2lnbmFsIHx8IG51bGwgfSkpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVycj8ubmFtZSA9PT0gIkFib3J0RXJyb3IiKQogICAgICAgICAgICByZWplY3QoZXJyb3JJbnN0YW5jZSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2h0dHAuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2lkLmpzCiAgZnVuY3Rpb24gY3JlYXRlSWRTdG9yZSgpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnQ6IDAsCiAgICAgIHRha2UoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudCsrOwogICAgICB9LAogICAgICByZXNldCgpIHsKICAgICAgICB0aGlzLmN1cnJlbnQgPSAwOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgaWRDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBjcmVhdGVJZFN0b3JlKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvaHR0cC5qcwogIGZ1bmN0aW9uIGdldEh0dHBScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIHJlcXVlc3QocGFyYW1zKSB7CiAgICAgICAgY29uc3QgeyBib2R5LCBvblJlcXVlc3QgPSBvcHRpb25zLm9uUmVxdWVzdCwgb25SZXNwb25zZSA9IG9wdGlvbnMub25SZXNwb25zZSwgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCA/PyAxZTQgfSA9IHBhcmFtczsKICAgICAgICBjb25zdCBmZXRjaE9wdGlvbnMgPSB7CiAgICAgICAgICAuLi5vcHRpb25zLmZldGNoT3B0aW9ucyA/PyB7fSwKICAgICAgICAgIC4uLnBhcmFtcy5mZXRjaE9wdGlvbnMgPz8ge30KICAgICAgICB9OwogICAgICAgIGNvbnN0IHsgaGVhZGVycywgbWV0aG9kLCBzaWduYWw6IHNpZ25hbF8gfSA9IGZldGNoT3B0aW9uczsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3aXRoVGltZW91dChhc3luYyAoeyBzaWduYWwgfSkgPT4gewogICAgICAgICAgICBjb25zdCBpbml0ID0gewogICAgICAgICAgICAgIC4uLmZldGNoT3B0aW9ucywKICAgICAgICAgICAgICBib2R5OiBBcnJheS5pc0FycmF5KGJvZHkpID8gc3RyaW5naWZ5KGJvZHkubWFwKChib2R5MikgPT4gKHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkyLmlkID8/IGlkQ2FjaGUudGFrZSgpLAogICAgICAgICAgICAgICAgLi4uYm9keTIKICAgICAgICAgICAgICB9KSkpIDogc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkuaWQgPz8gaWRDYWNoZS50YWtlKCksCiAgICAgICAgICAgICAgICAuLi5ib2R5CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIC4uLmhlYWRlcnMKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kIHx8ICJQT1NUIiwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbF8gfHwgKHRpbWVvdXQgPiAwID8gc2lnbmFsIDogbnVsbCkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KHVybCwgaW5pdCk7CiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBhd2FpdCBvblJlcXVlc3Q/LihyZXF1ZXN0LCBpbml0KSA/PyB7IC4uLmluaXQsIHVybCB9OwogICAgICAgICAgICBjb25zdCByZXNwb25zZTIgPSBhd2FpdCBmZXRjaChhcmdzLnVybCA/PyB1cmwsIGFyZ3MpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UyOwogICAgICAgICAgfSwgewogICAgICAgICAgICBlcnJvckluc3RhbmNlOiBuZXcgVGltZW91dEVycm9yKHsgYm9keSwgdXJsIH0pLAogICAgICAgICAgICB0aW1lb3V0LAogICAgICAgICAgICBzaWduYWw6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKG9uUmVzcG9uc2UpCiAgICAgICAgICAgIGF3YWl0IG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhIHx8ICJ7fSIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgZGF0YSA9IHsgZXJyb3I6IGRhdGEgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICB0aHJvdyBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBkZXRhaWxzOiBzdHJpbmdpZnkoZGF0YS5lcnJvcikgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCwKICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLAogICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICAgIHVybAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEh0dHBSZXF1ZXN0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBUaW1lb3V0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIHRocm93IG5ldyBIdHRwUmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICAgICAgdXJsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBmdW5jdGlvbiBodHRwKHVybCwgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGZldGNoT3B0aW9ucywga2V5ID0gImh0dHAiLCBuYW1lID0gIkhUVFAgSlNPTi1SUEMiLCBvbkZldGNoUmVxdWVzdCwgb25GZXRjaFJlc3BvbnNlLCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHsgYmF0Y2hTaXplID0gMWUzLCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBiYXRjaCA9PT0gIm9iamVjdCIgPyBiYXRjaCA6IHt9OwogICAgICBjb25zdCByZXRyeUNvdW50ID0gY29uZmlnLnJldHJ5Q291bnQgPz8gcmV0cnlDb3VudF87CiAgICAgIGNvbnN0IHRpbWVvdXQgPSB0aW1lb3V0XyA/PyBjb25maWcudGltZW91dCA/PyAxZTQ7CiAgICAgIGNvbnN0IHVybF8gPSB1cmwgfHwgY2hhaW4/LnJwY1VybHMuZGVmYXVsdC5odHRwWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgY29uc3QgcnBjQ2xpZW50ID0gZ2V0SHR0cFJwY0NsaWVudCh1cmxfLCB7CiAgICAgICAgZmV0Y2hPcHRpb25zLAogICAgICAgIG9uUmVxdWVzdDogb25GZXRjaFJlcXVlc3QsCiAgICAgICAgb25SZXNwb25zZTogb25GZXRjaFJlc3BvbnNlLAogICAgICAgIHRpbWVvdXQKICAgICAgfSk7CiAgICAgIHJldHVybiBjcmVhdGVUcmFuc3BvcnQoewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIGFzeW5jIHJlcXVlc3QoeyBtZXRob2QsIHBhcmFtcyB9KSB7CiAgICAgICAgICBjb25zdCBib2R5ID0geyBtZXRob2QsIHBhcmFtcyB9OwogICAgICAgICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICAgICAgICBpZDogdXJsXywKICAgICAgICAgICAgd2FpdDogd2FpdDIsCiAgICAgICAgICAgIHNob3VsZFNwbGl0QmF0Y2gocmVxdWVzdHMpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdHMubGVuZ3RoID4gYmF0Y2hTaXplOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmbjogKGJvZHkyKSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgICAgYm9keTogYm9keTIKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHNvcnQ6IChhLCBiKSA9PiBhLmlkIC0gYi5pZAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCBmbiA9IGFzeW5jIChib2R5MikgPT4gYmF0Y2ggPyBzY2hlZHVsZShib2R5MikgOiBbCiAgICAgICAgICAgIGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBib2R5OiBib2R5MgogICAgICAgICAgICB9KQogICAgICAgICAgXTsKICAgICAgICAgIGNvbnN0IFt7IGVycm9yLCByZXN1bHQgfV0gPSBhd2FpdCBmbihib2R5KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogImh0dHAiCiAgICAgIH0sIHsKICAgICAgICBmZXRjaE9wdGlvbnMsCiAgICAgICAgdXJsOiB1cmxfCiAgICAgIH0pOwogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGluaXRfdHJpbSgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9lcnJvcnMuanMKICBpbml0X3NvbGlkaXR5KCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGZ1bmN0aW9uIGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCBjYWxsVHlwZSkgewogICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMikpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGNhdXNlID0gZXJyLndhbGsoKGUpID0+IGUgaW5zdGFuY2VvZiBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcik7CiAgICBpZiAoIShjYXVzZSBpbnN0YW5jZW9mIENvbnRyYWN0RnVuY3Rpb25SZXZlcnRlZEVycm9yKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyTm90Rm91bmQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJSZXNvbHZlcldpbGRjYXJkTm90U3VwcG9ydGVkIikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2F1c2UuZGF0YT8uZXJyb3JOYW1lID09PSAiUmVzb2x2ZXJOb3RDb250cmFjdCIpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJIdHRwRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5yZWFzb24/LmluY2x1ZGVzKCJXaWxkY2FyZCBvbiBub24tZXh0ZW5kZWQgcmVzb2x2ZXJzIGlzIG5vdCBzdXBwb3J0ZWQiKSkKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2FsbFR5cGUgPT09ICJyZXZlcnNlIiAmJiBjYXVzZS5yZWFzb24gPT09IHBhbmljUmVhc29uc1s1MF0pCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvZW5jb2RlZExhYmVsVG9MYWJlbGhhc2guanMKICBpbml0X2lzSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHsKICAgIGlmIChsYWJlbC5sZW5ndGggIT09IDY2KQogICAgICByZXR1cm4gbnVsbDsKICAgIGlmIChsYWJlbC5pbmRleE9mKCJbIikgIT09IDApCiAgICAgIHJldHVybiBudWxsOwogICAgaWYgKGxhYmVsLmluZGV4T2YoIl0iKSAhPT0gNjUpCiAgICAgIHJldHVybiBudWxsOwogICAgY29uc3QgaGFzaDMgPSBgMHgke2xhYmVsLnNsaWNlKDEsIDY1KX1gOwogICAgaWYgKCFpc0hleChoYXNoMykpCiAgICAgIHJldHVybiBudWxsOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGZ1bmN0aW9uIG5hbWVoYXNoKG5hbWUpIHsKICAgIGxldCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbmFtZSkKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICAgIGNvbnN0IGxhYmVscyA9IG5hbWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSBsYWJlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpIC09IDEpIHsKICAgICAgY29uc3QgaGFzaEZyb21FbmNvZGVkTGFiZWwgPSBlbmNvZGVkTGFiZWxUb0xhYmVsaGFzaChsYWJlbHNbaV0pOwogICAgICBjb25zdCBoYXNoZWQgPSBoYXNoRnJvbUVuY29kZWRMYWJlbCA/IHRvQnl0ZXMoaGFzaEZyb21FbmNvZGVkTGFiZWwpIDoga2VjY2FrMjU2KHN0cmluZ1RvQnl0ZXMobGFiZWxzW2ldKSwgImJ5dGVzIik7CiAgICAgIHJlc3VsdCA9IGtlY2NhazI1Nihjb25jYXQoW3Jlc3VsdCwgaGFzaGVkXSksICJieXRlcyIpOwogICAgfQogICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvcGFja2V0VG9CeXRlcy5qcwogIGluaXRfdG9CeXRlcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2VuY29kZUxhYmVsaGFzaC5qcwogIGZ1bmN0aW9uIGVuY29kZUxhYmVsaGFzaChoYXNoMykgewogICAgcmV0dXJuIGBbJHtoYXNoMy5zbGljZSgyKX1dYDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvbGFiZWxoYXNoLmpzCiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgZnVuY3Rpb24gbGFiZWxoYXNoKGxhYmVsKSB7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbGFiZWwpCiAgICAgIHJldHVybiBieXRlc1RvSGV4KHJlc3VsdCk7CiAgICByZXR1cm4gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHx8IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGxhYmVsKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL3BhY2tldFRvQnl0ZXMuanMKICBmdW5jdGlvbiBwYWNrZXRUb0J5dGVzKHBhY2tldCkgewogICAgY29uc3QgdmFsdWUgPSBwYWNrZXQucmVwbGFjZSgvXlwufFwuJC9nbSwgIiIpOwogICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDEpOwogICAgY29uc3QgYnl0ZXMyID0gbmV3IFVpbnQ4QXJyYXkoc3RyaW5nVG9CeXRlcyh2YWx1ZSkuYnl0ZUxlbmd0aCArIDIpOwogICAgbGV0IG9mZnNldCA9IDA7CiAgICBjb25zdCBsaXN0ID0gdmFsdWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewogICAgICBsZXQgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMobGlzdFtpXSk7CiAgICAgIGlmIChlbmNvZGVkLmJ5dGVMZW5ndGggPiAyNTUpCiAgICAgICAgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMoZW5jb2RlTGFiZWxoYXNoKGxhYmVsaGFzaChsaXN0W2ldKSkpOwogICAgICBieXRlczJbb2Zmc2V0XSA9IGVuY29kZWQubGVuZ3RoOwogICAgICBieXRlczIuc2V0KGVuY29kZWQsIG9mZnNldCArIDEpOwogICAgICBvZmZzZXQgKz0gZW5jb2RlZC5sZW5ndGggKyAxOwogICAgfQogICAgaWYgKGJ5dGVzMi5ieXRlTGVuZ3RoICE9PSBvZmZzZXQgKyAxKQogICAgICByZXR1cm4gYnl0ZXMyLnNsaWNlKDAsIG9mZnNldCArIDEpOwogICAgcmV0dXJuIGJ5dGVzMjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBjb2luVHlwZSwgbmFtZSwgZ2F0ZXdheVVybHMsIHN0cmljdCwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBmdW5jdGlvbkRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoewogICAgICAgIGFiaTogYWRkcmVzc1Jlc29sdmVyQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogImFkZHIiLAogICAgICAgIC4uLmNvaW5UeXBlICE9IG51bGwgPyB7IGFyZ3M6IFtuYW1laGFzaChuYW1lKSwgQmlnSW50KGNvaW5UeXBlKV0gfSA6IHsgYXJnczogW25hbWVoYXNoKG5hbWUpXSB9CiAgICAgIH0pOwogICAgICBjb25zdCByZWFkQ29udHJhY3RQYXJhbWV0ZXJzID0gewogICAgICAgIGFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcywKICAgICAgICBhYmk6IHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJyZXNvbHZlIiwKICAgICAgICBhcmdzOiBbdG9IZXgocGFja2V0VG9CeXRlcyhuYW1lKSksIGZ1bmN0aW9uRGF0YV0sCiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgYmxvY2tUYWcKICAgICAgfTsKICAgICAgY29uc3QgcmVhZENvbnRyYWN0QWN0aW9uID0gZ2V0QWN0aW9uKGNsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0Iik7CiAgICAgIGNvbnN0IHJlcyA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKHJlc1swXSA9PT0gIjB4IikKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgY29uc3QgYWRkcmVzcyA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFkZHJlc3NSZXNvbHZlckFiaSwKICAgICAgICBhcmdzOiBjb2luVHlwZSAhPSBudWxsID8gW25hbWVoYXNoKG5hbWUpLCBCaWdJbnQoY29pblR5cGUpXSA6IHZvaWQgMCwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJhZGRyIiwKICAgICAgICBkYXRhOiByZXNbMF0KICAgICAgfSk7CiAgICAgIGlmIChhZGRyZXNzID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBpZiAodHJpbShhZGRyZXNzKSA9PT0gIjB4MDAiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gYWRkcmVzczsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHRocm93IGVycjsKICAgICAgaWYgKGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCAicmVzb2x2ZSIpKQogICAgICAgIHJldHVybiBudWxsOwogICAgICB0aHJvdyBlcnI7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2Vucy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEgfSkgewogICAgICBzdXBlcigiVW5hYmxlIHRvIGV4dHJhY3QgaW1hZ2UgZnJvbSBtZXRhZGF0YS4gVGhlIG1ldGFkYXRhIG1heSBiZSBtYWxmb3JtZWQgb3IgaW52YWxpZC4iLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiLSBNZXRhZGF0YSBtdXN0IGJlIGEgSlNPTiBvYmplY3Qgd2l0aCBhdCBsZWFzdCBhbiBgaW1hZ2VgLCBgaW1hZ2VfdXJsYCBvciBgaW1hZ2VfZGF0YWAgcHJvcGVydHkuIiwKICAgICAgICAgICIiLAogICAgICAgICAgYFByb3ZpZGVkIGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9YAogICAgICAgIF0sCiAgICAgICAgbmFtZTogIkVuc0F2YXRhckludmFsaWRNZXRhZGF0YUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyByZWFzb24gfSkgewogICAgICBzdXBlcihgRU5TIE5GVCBhdmF0YXIgVVJJIGlzIGludmFsaWQuICR7cmVhc29ufWAsIHsKICAgICAgICBuYW1lOiAiRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyB1cmkgfSkgewogICAgICBzdXBlcihgVW5hYmxlIHRvIHJlc29sdmUgRU5TIGF2YXRhciBVUkkgIiR7dXJpfSIuIFRoZSBVUkkgbWF5IGJlIG1hbGZvcm1lZCwgaW52YWxpZCwgb3IgZG9lcyBub3QgcmVzcG9uZCB3aXRoIGEgdmFsaWQgaW1hZ2UuYCwgeyBuYW1lOiAiRW5zQXZhdGFyVXJpUmVzb2x1dGlvbkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgbmFtZXNwYWNlIH0pIHsKICAgICAgc3VwZXIoYEVOUyBORlQgYXZhdGFyIG5hbWVzcGFjZSAiJHtuYW1lc3BhY2V9IiBpcyBub3Qgc3VwcG9ydGVkLiBNdXN0IGJlICJlcmM3MjEiIG9yICJlcmMxMTU1Ii5gLCB7IG5hbWU6ICJFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yIiB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2F2YXRhci91dGlscy5qcwogIHZhciBuZXR3b3JrUmVnZXggPSAvKD88cHJvdG9jb2w+aHR0cHM/OlwvXC9bXlwvXSp8aXBmczpcL3xpcG5zOlwvfGFyOlwvKT8oPzxyb290PlwvKT8oPzxzdWJwYXRoPmlwZnNcL3xpcG5zXC8pPyg/PHRhcmdldD5bXHdcLS5dKykoPzxzdWJ0YXJnZXQ+XC8uKik/LzsKICB2YXIgaXBmc0hhc2hSZWdleCA9IC9eKFFtWzEtOUEtSEotTlAtWmEta20tel17NDQsfXxiW0EtWmEtejItN117NTgsfXxCW0EtWjItN117NTgsfXx6WzEtOUEtSEotTlAtWmEta20tel17NDgsfXxGWzAtOUEtRl17NTAsfSkoXC8oPzx0YXJnZXQ+W1x3XC0uXSspKT8oPzxzdWJ0YXJnZXQ+XC8uKik/JC87CiAgdmFyIGJhc2U2NFJlZ2V4ID0gL15kYXRhOihbYS16QS1aXC0vK10qKTtiYXNlNjQsKFteIl0uKikvOwogIHZhciBkYXRhVVJJUmVnZXggPSAvXmRhdGE6KFthLXpBLVpcLS8rXSopPyg7W2EtekEtWjAtOV0uKj8pPygsKS87CiAgYXN5bmMgZnVuY3Rpb24gaXNJbWFnZVVyaSh1cmkpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVyaSwgeyBtZXRob2Q6ICJIRUFEIiB9KTsKICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVzLmhlYWRlcnMuZ2V0KCJjb250ZW50LXR5cGUiKTsKICAgICAgICByZXR1cm4gY29udGVudFR5cGU/LnN0YXJ0c1dpdGgoImltYWdlLyIpOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICJvYmplY3QiICYmIHR5cGVvZiBlcnJvci5yZXNwb25zZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFnbG9iYWxUaGlzLmhhc093blByb3BlcnR5KCJJbWFnZSIpKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfTsKICAgICAgICBpbWcub25lcnJvciA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgIH07CiAgICAgICAgaW1nLnNyYyA9IHVyaTsKICAgICAgfSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEdhdGV3YXkoY3VzdG9tMiwgZGVmYXVsdEdhdGV3YXkpIHsKICAgIGlmICghY3VzdG9tMikKICAgICAgcmV0dXJuIGRlZmF1bHRHYXRld2F5OwogICAgaWYgKGN1c3RvbTIuZW5kc1dpdGgoIi8iKSkKICAgICAgcmV0dXJuIGN1c3RvbTIuc2xpY2UoMCwgLTEpOwogICAgcmV0dXJuIGN1c3RvbTI7CiAgfQogIGZ1bmN0aW9uIHJlc29sdmVBdmF0YXJVcmkoeyB1cmksIGdhdGV3YXlVcmxzIH0pIHsKICAgIGNvbnN0IGlzRW5jb2RlZCA9IGJhc2U2NFJlZ2V4LnRlc3QodXJpKTsKICAgIGlmIChpc0VuY29kZWQpCiAgICAgIHJldHVybiB7IHVyaSwgaXNPbkNoYWluOiB0cnVlLCBpc0VuY29kZWQgfTsKICAgIGNvbnN0IGlwZnNHYXRld2F5ID0gZ2V0R2F0ZXdheShnYXRld2F5VXJscz8uaXBmcywgImh0dHBzOi8vaXBmcy5pbyIpOwogICAgY29uc3QgYXJ3ZWF2ZUdhdGV3YXkgPSBnZXRHYXRld2F5KGdhdGV3YXlVcmxzPy5hcndlYXZlLCAiaHR0cHM6Ly9hcndlYXZlLm5ldCIpOwogICAgY29uc3QgbmV0d29ya1JlZ2V4TWF0Y2ggPSB1cmkubWF0Y2gobmV0d29ya1JlZ2V4KTsKICAgIGNvbnN0IHsgcHJvdG9jb2wsIHN1YnBhdGgsIHRhcmdldCwgc3VidGFyZ2V0ID0gIiIgfSA9IG5ldHdvcmtSZWdleE1hdGNoPy5ncm91cHMgfHwge307CiAgICBjb25zdCBpc0lQTlMgPSBwcm90b2NvbCA9PT0gImlwbnM6LyIgfHwgc3VicGF0aCA9PT0gImlwbnMvIjsKICAgIGNvbnN0IGlzSVBGUyA9IHByb3RvY29sID09PSAiaXBmczovIiB8fCBzdWJwYXRoID09PSAiaXBmcy8iIHx8IGlwZnNIYXNoUmVnZXgudGVzdCh1cmkpOwogICAgaWYgKHVyaS5zdGFydHNXaXRoKCJodHRwIikgJiYgIWlzSVBOUyAmJiAhaXNJUEZTKSB7CiAgICAgIGxldCByZXBsYWNlZFVyaSA9IHVyaTsKICAgICAgaWYgKGdhdGV3YXlVcmxzPy5hcndlYXZlKQogICAgICAgIHJlcGxhY2VkVXJpID0gdXJpLnJlcGxhY2UoL2h0dHBzOlwvXC9hcndlYXZlLm5ldC9nLCBnYXRld2F5VXJscz8uYXJ3ZWF2ZSk7CiAgICAgIHJldHVybiB7IHVyaTogcmVwbGFjZWRVcmksIGlzT25DaGFpbjogZmFsc2UsIGlzRW5jb2RlZDogZmFsc2UgfTsKICAgIH0KICAgIGlmICgoaXNJUE5TIHx8IGlzSVBGUykgJiYgdGFyZ2V0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBgJHtpcGZzR2F0ZXdheX0vJHtpc0lQTlMgPyAiaXBucyIgOiAiaXBmcyJ9LyR7dGFyZ2V0fSR7c3VidGFyZ2V0fWAsCiAgICAgICAgaXNPbkNoYWluOiBmYWxzZSwKICAgICAgICBpc0VuY29kZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICBpZiAocHJvdG9jb2wgPT09ICJhcjovIiAmJiB0YXJnZXQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB1cmk6IGAke2Fyd2VhdmVHYXRld2F5fS8ke3RhcmdldH0ke3N1YnRhcmdldCB8fCAiIn1gLAogICAgICAgIGlzT25DaGFpbjogZmFsc2UsCiAgICAgICAgaXNFbmNvZGVkOiBmYWxzZQogICAgICB9OwogICAgfQogICAgbGV0IHBhcnNlZFVyaSA9IHVyaS5yZXBsYWNlKGRhdGFVUklSZWdleCwgIiIpOwogICAgaWYgKHBhcnNlZFVyaS5zdGFydHNXaXRoKCI8c3ZnIikpIHsKICAgICAgcGFyc2VkVXJpID0gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJHtidG9hKHBhcnNlZFVyaSl9YDsKICAgIH0KICAgIGlmIChwYXJzZWRVcmkuc3RhcnRzV2l0aCgiZGF0YToiKSB8fCBwYXJzZWRVcmkuc3RhcnRzV2l0aCgieyIpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBwYXJzZWRVcmksCiAgICAgICAgaXNPbkNoYWluOiB0cnVlLAogICAgICAgIGlzRW5jb2RlZDogZmFsc2UKICAgICAgfTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgfQogIGZ1bmN0aW9uIGdldEpzb25JbWFnZShkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJvYmplY3QiIHx8ICEoImltYWdlIiBpbiBkYXRhKSAmJiAhKCJpbWFnZV91cmwiIGluIGRhdGEpICYmICEoImltYWdlX2RhdGEiIGluIGRhdGEpKSB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvcih7IGRhdGEgfSk7CiAgICB9CiAgICByZXR1cm4gZGF0YS5pbWFnZSB8fCBkYXRhLmltYWdlX3VybCB8fCBkYXRhLmltYWdlX2RhdGE7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE1ldGFkYXRhQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICB0cnkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmkpLnRoZW4oKHJlczIpID0+IHJlczIuanNvbigpKTsKICAgICAgY29uc3QgaW1hZ2UgPSBhd2FpdCBwYXJzZUF2YXRhclVyaSh7CiAgICAgICAgZ2F0ZXdheVVybHMsCiAgICAgICAgdXJpOiBnZXRKc29uSW1hZ2UocmVzKQogICAgICB9KTsKICAgICAgcmV0dXJuIGltYWdlOwogICAgfSBjYXRjaCB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgICB9CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHBhcnNlQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWRVUkksIGlzT25DaGFpbiB9ID0gcmVzb2x2ZUF2YXRhclVyaSh7IHVyaSwgZ2F0ZXdheVVybHMgfSk7CiAgICBpZiAoaXNPbkNoYWluKQogICAgICByZXR1cm4gcmVzb2x2ZWRVUkk7CiAgICBjb25zdCBpc0ltYWdlID0gYXdhaXQgaXNJbWFnZVVyaShyZXNvbHZlZFVSSSk7CiAgICBpZiAoaXNJbWFnZSkKICAgICAgcmV0dXJuIHJlc29sdmVkVVJJOwogICAgdGhyb3cgbmV3IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvcih7IHVyaSB9KTsKICB9CiAgZnVuY3Rpb24gcGFyc2VOZnRVcmkodXJpXykgewogICAgbGV0IHVyaSA9IHVyaV87CiAgICBpZiAodXJpLnN0YXJ0c1dpdGgoImRpZDpuZnQ6IikpIHsKICAgICAgdXJpID0gdXJpLnJlcGxhY2UoImRpZDpuZnQ6IiwgIiIpLnJlcGxhY2UoL18vZywgIi8iKTsKICAgIH0KICAgIGNvbnN0IFtyZWZlcmVuY2UsIGFzc2V0X25hbWVzcGFjZSwgdG9rZW5JRF0gPSB1cmkuc3BsaXQoIi8iKTsKICAgIGNvbnN0IFtlaXBfbmFtZXNwYWNlLCBjaGFpbklEXSA9IHJlZmVyZW5jZS5zcGxpdCgiOiIpOwogICAgY29uc3QgW2VyY19uYW1lc3BhY2UsIGNvbnRyYWN0QWRkcmVzc10gPSBhc3NldF9uYW1lc3BhY2Uuc3BsaXQoIjoiKTsKICAgIGlmICghZWlwX25hbWVzcGFjZSB8fCBlaXBfbmFtZXNwYWNlLnRvTG93ZXJDYXNlKCkgIT09ICJlaXAxNTUiKQogICAgICB0aHJvdyBuZXcgRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yKHsgcmVhc29uOiAiT25seSBFSVAtMTU1IHN1cHBvcnRlZCIgfSk7CiAgICBpZiAoIWNoYWluSUQpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJDaGFpbiBJRCBub3QgZm91bmQiIH0pOwogICAgaWYgKCFjb250cmFjdEFkZHJlc3MpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoewogICAgICAgIHJlYXNvbjogIkNvbnRyYWN0IGFkZHJlc3Mgbm90IGZvdW5kIgogICAgICB9KTsKICAgIGlmICghdG9rZW5JRCkKICAgICAgdGhyb3cgbmV3IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvcih7IHJlYXNvbjogIlRva2VuIElEIG5vdCBmb3VuZCIgfSk7CiAgICBpZiAoIWVyY19uYW1lc3BhY2UpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJFUkMgbmFtZXNwYWNlIG5vdCBmb3VuZCIgfSk7CiAgICByZXR1cm4gewogICAgICBjaGFpbklEOiBOdW1iZXIucGFyc2VJbnQoY2hhaW5JRCksCiAgICAgIG5hbWVzcGFjZTogZXJjX25hbWVzcGFjZS50b0xvd2VyQ2FzZSgpLAogICAgICBjb250cmFjdEFkZHJlc3MsCiAgICAgIHRva2VuSUQKICAgIH07CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSkgewogICAgaWYgKG5mdC5uYW1lc3BhY2UgPT09ICJlcmM3MjEiKSB7CiAgICAgIHJldHVybiByZWFkQ29udHJhY3QoY2xpZW50LCB7CiAgICAgICAgYWRkcmVzczogbmZ0LmNvbnRyYWN0QWRkcmVzcywKICAgICAgICBhYmk6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInRva2VuVVJJIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogInRva2VuSWQiLCB0eXBlOiAidWludDI1NiIgfV0sCiAgICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidG9rZW5VUkkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIGlmIChuZnQubmFtZXNwYWNlID09PSAiZXJjMTE1NSIpIHsKICAgICAgcmV0dXJuIHJlYWRDb250cmFjdChjbGllbnQsIHsKICAgICAgICBhZGRyZXNzOiBuZnQuY29udHJhY3RBZGRyZXNzLAogICAgICAgIGFiaTogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAidXJpIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIl9pZCIsIHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJzdHJpbmciIH1dCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJ1cmkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yKHsgbmFtZXNwYWNlOiBuZnQubmFtZXNwYWNlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9hdmF0YXIvcGFyc2VBdmF0YXJSZWNvcmQuanMKICBhc3luYyBmdW5jdGlvbiBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KSB7CiAgICBpZiAoL2VpcDE1NTovaS50ZXN0KHJlY29yZCkpCiAgICAgIHJldHVybiBwYXJzZU5mdEF2YXRhclVyaShjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KTsKICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogcmVjb3JkLCBnYXRld2F5VXJscyB9KTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gcGFyc2VOZnRBdmF0YXJVcmkoY2xpZW50LCB7IGdhdGV3YXlVcmxzLCByZWNvcmQgfSkgewogICAgY29uc3QgbmZ0ID0gcGFyc2VOZnRVcmkocmVjb3JkKTsKICAgIGNvbnN0IG5mdFVyaSA9IGF3YWl0IGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSk7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWROZnRVcmksIGlzT25DaGFpbiwgaXNFbmNvZGVkIH0gPSByZXNvbHZlQXZhdGFyVXJpKHsgdXJpOiBuZnRVcmksIGdhdGV3YXlVcmxzIH0pOwogICAgaWYgKGlzT25DaGFpbiAmJiAocmVzb2x2ZWROZnRVcmkuaW5jbHVkZXMoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIikgfHwgcmVzb2x2ZWROZnRVcmkuc3RhcnRzV2l0aCgieyIpKSkgewogICAgICBjb25zdCBlbmNvZGVkSnNvbiA9IGlzRW5jb2RlZCA/ICgKICAgICAgICAvLyBpZiBpdCBpcyBlbmNvZGVkLCBkZWNvZGUgaXQKICAgICAgICBhdG9iKHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIiwgIiIpKQogICAgICApIDogKAogICAgICAgIC8vIGlmIGl0IGlzbid0IGVuY29kZWQgYXNzdW1lIGl0IGlzIGEgSlNPTiBzdHJpbmcsIGJ1dCBpdCBjb3VsZCBiZSBhbnl0aGluZyAoaXQgd2lsbCBlcnJvciBpZiBpdCBpcykKICAgICAgICByZXNvbHZlZE5mdFVyaQogICAgICApOwogICAgICBjb25zdCBkZWNvZGVkID0gSlNPTi5wYXJzZShlbmNvZGVkSnNvbik7CiAgICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogZ2V0SnNvbkltYWdlKGRlY29kZWQpLCBnYXRld2F5VXJscyB9KTsKICAgIH0KICAgIGxldCB1cmlUb2tlbklkID0gbmZ0LnRva2VuSUQ7CiAgICBpZiAobmZ0Lm5hbWVzcGFjZSA9PT0gImVyYzExNTUiKQogICAgICB1cmlUb2tlbklkID0gdXJpVG9rZW5JZC5yZXBsYWNlKCIweCIsICIiKS5wYWRTdGFydCg2NCwgIjAiKTsKICAgIHJldHVybiBnZXRNZXRhZGF0YUF2YXRhclVyaSh7CiAgICAgIGdhdGV3YXlVcmxzLAogICAgICB1cmk6IHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoLyg/OjB4KT97aWR9LywgdXJpVG9rZW5JZCkKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc1RleHQuanMKICBpbml0X2FiaXMoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc1RleHQoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwga2V5LCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXNvbHZlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJlc29sdmUiLAogICAgICAgIGFyZ3M6IFsKICAgICAgICAgIHRvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpLAogICAgICAgICAgZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgICAgIGZ1bmN0aW9uTmFtZTogInRleHQiLAogICAgICAgICAgICBhcmdzOiBbbmFtZWhhc2gobmFtZSksIGtleV0KICAgICAgICAgIH0pCiAgICAgICAgXSwKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZwogICAgICB9OwogICAgICBjb25zdCByZWFkQ29udHJhY3RBY3Rpb24gPSBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKTsKICAgICAgY29uc3QgcmVzID0gZ2F0ZXdheVVybHMgPyBhd2FpdCByZWFkQ29udHJhY3RBY3Rpb24oewogICAgICAgIC4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMsCiAgICAgICAgYXJnczogWy4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMuYXJncywgZ2F0ZXdheVVybHNdCiAgICAgIH0pIDogYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHJlYWRDb250cmFjdFBhcmFtZXRlcnMpOwogICAgICBpZiAocmVzWzBdID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBjb25zdCByZWNvcmQgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidGV4dCIsCiAgICAgICAgZGF0YTogcmVzWzBdCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVjb3JkID09PSAiIiA/IG51bGwgOiByZWNvcmQ7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgaWYgKHN0cmljdCkKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIGlmIChpc051bGxVbml2ZXJzYWxSZXNvbHZlckVycm9yKGVyciwgInJlc29sdmUiKSkKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgdGhyb3cgZXJyOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc0F2YXRhci5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc0F2YXRhcihjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBhc3NldEdhdGV3YXlVcmxzLCBuYW1lLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgfSkgewogICAgY29uc3QgcmVjb3JkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RW5zVGV4dCwgImdldEVuc1RleHQiKSh7CiAgICAgIGJsb2NrTnVtYmVyLAogICAgICBibG9ja1RhZywKICAgICAga2V5OiAiYXZhdGFyIiwKICAgICAgbmFtZSwKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBnYXRld2F5VXJscywKICAgICAgc3RyaWN0CiAgICB9KTsKICAgIGlmICghcmVjb3JkKQogICAgICByZXR1cm4gbnVsbDsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhd2FpdCBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsKICAgICAgICByZWNvcmQsCiAgICAgICAgZ2F0ZXdheVVybHM6IGFzc2V0R2F0ZXdheVVybHMKICAgICAgfSk7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9lbnMvZ2V0RW5zTmFtZS5qcwogIGluaXRfYWJpcygpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zTmFtZShjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHJldmVyc2VOb2RlID0gYCR7YWRkcmVzcy50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygyKX0uYWRkci5yZXZlcnNlYDsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXZlcnNlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJldmVyc2UiLAogICAgICAgIGFyZ3M6IFt0b0hleChwYWNrZXRUb0J5dGVzKHJldmVyc2VOb2RlKSldLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnCiAgICAgIH07CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdEFjdGlvbiA9IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpOwogICAgICBjb25zdCBbbmFtZSwgcmVzb2x2ZWRBZGRyZXNzXSA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKGFkZHJlc3MudG9Mb3dlckNhc2UoKSAhPT0gcmVzb2x2ZWRBZGRyZXNzLnRvTG93ZXJDYXNlKCkpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHJldHVybiBuYW1lOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIGlmIChzdHJpY3QpCiAgICAgICAgdGhyb3cgZXJyOwogICAgICBpZiAoaXNOdWxsVW5pdmVyc2FsUmVzb2x2ZXJFcnJvcihlcnIsICJyZXZlcnNlIikpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHRocm93IGVycjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNSZXNvbHZlci5qcwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zUmVzb2x2ZXIoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBbcmVzb2x2ZXJBZGRyZXNzXSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpKHsKICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBhYmk6IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIgfV0sCiAgICAgICAgICBuYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgICAgIG91dHB1dHM6IFt7IHR5cGU6ICJhZGRyZXNzIiB9LCB7IHR5cGU6ICJieXRlczMyIiB9XSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXSwKICAgICAgZnVuY3Rpb25OYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgYXJnczogW3RvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnCiAgICB9KTsKICAgIHJldHVybiByZXNvbHZlckFkZHJlc3M7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy9kZWNvcmF0b3JzL3B1YmxpYy5qcwogIGluaXRfY2FsbCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlQmxvY2tGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVCbG9ja0ZpbHRlcihjbGllbnQpIHsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgY29uc3QgaWQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAiYmxvY2siIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlRXZlbnRGaWx0ZXIuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCB7IGFkZHJlc3MsIGFyZ3MsIGV2ZW50LCBldmVudHM6IGV2ZW50c18sIGZyb21CbG9jaywgc3RyaWN0LCB0b0Jsb2NrIH0gPSB7fSkgewogICAgY29uc3QgZXZlbnRzID0gZXZlbnRzXyA/PyAoZXZlbnQgPyBbZXZlbnRdIDogdm9pZCAwKTsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdGaWx0ZXIiCiAgICB9KTsKICAgIGxldCB0b3BpY3MgPSBbXTsKICAgIGlmIChldmVudHMpIHsKICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50cy5mbGF0TWFwKChldmVudDIpID0+IGVuY29kZUV2ZW50VG9waWNzKHsKICAgICAgICBhYmk6IFtldmVudDJdLAogICAgICAgIGV2ZW50TmFtZTogZXZlbnQyLm5hbWUsCiAgICAgICAgYXJncwogICAgICB9KSk7CiAgICAgIHRvcGljcyA9IFtlbmNvZGVkXTsKICAgICAgaWYgKGV2ZW50KQogICAgICAgIHRvcGljcyA9IHRvcGljc1swXTsKICAgIH0KICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgLi4udG9waWNzLmxlbmd0aCA/IHsgdG9waWNzIH0gOiB7fQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lOiBldmVudCA/IGV2ZW50Lm5hbWUgOiB2b2lkIDAsCiAgICAgIGZyb21CbG9jaywKICAgICAgaWQsCiAgICAgIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLAogICAgICBzdHJpY3Q6IEJvb2xlYW4oc3RyaWN0KSwKICAgICAgdG9CbG9jaywKICAgICAgdHlwZTogImV2ZW50IgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSB7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3UGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyIgogICAgfSk7CiAgICBjb25zdCBpZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX25ld1BlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAidHJhbnNhY3Rpb24iIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmxvYkJhc2VGZWUuanMKICBhc3luYyBmdW5jdGlvbiBnZXRCbG9iQmFzZUZlZShjbGllbnQpIHsKICAgIGNvbnN0IGJhc2VGZWUgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9ibG9iQmFzZUZlZSIKICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYXNlRmVlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9ja1RyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgbGV0IGNvdW50OwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBjb3VudCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50QnlIYXNoIiwKICAgICAgICBwYXJhbXM6IFtibG9ja0hhc2hdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIHsKICAgICAgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldEJsb2NrVHJhbnNhY3Rpb25Db3VudEJ5TnVtYmVyIiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgcmV0dXJuIGhleFRvTnVtYmVyKGNvdW50KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb2RlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldENvZGUoY2xpZW50LCB7IGFkZHJlc3MsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0pIHsKICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgIT09IHZvaWQgMCA/IG51bWJlclRvSGV4KGJsb2NrTnVtYmVyKSA6IHZvaWQgMDsKICAgIGNvbnN0IGhleCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldENvZGUiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIGlmIChoZXggPT09ICIweCIpCiAgICAgIHJldHVybiB2b2lkIDA7CiAgICByZXR1cm4gaGV4OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZlZUhpc3RvcnkuanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2ZlZUhpc3RvcnkuanMKICBmdW5jdGlvbiBmb3JtYXRGZWVIaXN0b3J5KGZlZUhpc3RvcnkpIHsKICAgIHJldHVybiB7CiAgICAgIGJhc2VGZWVQZXJHYXM6IGZlZUhpc3RvcnkuYmFzZUZlZVBlckdhcy5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSwKICAgICAgZ2FzVXNlZFJhdGlvOiBmZWVIaXN0b3J5Lmdhc1VzZWRSYXRpbywKICAgICAgb2xkZXN0QmxvY2s6IEJpZ0ludChmZWVIaXN0b3J5Lm9sZGVzdEJsb2NrKSwKICAgICAgcmV3YXJkOiBmZWVIaXN0b3J5LnJld2FyZD8ubWFwKChyZXdhcmQpID0+IHJld2FyZC5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RmVlSGlzdG9yeS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEZlZUhpc3RvcnkoY2xpZW50LCB7IGJsb2NrQ291bnQsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCByZXdhcmRQZXJjZW50aWxlcyB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgZmVlSGlzdG9yeSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2ZlZUhpc3RvcnkiLAogICAgICBwYXJhbXM6IFsKICAgICAgICBudW1iZXJUb0hleChibG9ja0NvdW50KSwKICAgICAgICBibG9ja051bWJlckhleCB8fCBibG9ja1RhZywKICAgICAgICByZXdhcmRQZXJjZW50aWxlcwogICAgICBdCiAgICB9LCB7IGRlZHVwZTogQm9vbGVhbihibG9ja051bWJlckhleCkgfSk7CiAgICByZXR1cm4gZm9ybWF0RmVlSGlzdG9yeShmZWVIaXN0b3J5KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRGaWx0ZXJMb2dzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyTG9ncyhfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICBjb25zdCBzdHJpY3QgPSBmaWx0ZXIuc3RyaWN0ID8/IGZhbHNlOwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckxvZ3MiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFByb29mLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZGVmaW5lQ2hhaW4uanMKICBmdW5jdGlvbiBkZWZpbmVDaGFpbihjaGFpbikgewogICAgcmV0dXJuIHsKICAgICAgZm9ybWF0dGVyczogdm9pZCAwLAogICAgICBmZWVzOiB2b2lkIDAsCiAgICAgIHNlcmlhbGl6ZXJzOiB2b2lkIDAsCiAgICAgIC4uLmNoYWluCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2V4dHJhY3RDaGFpbi5qcwogIGZ1bmN0aW9uIGV4dHJhY3RDaGFpbih7IGNoYWlucywgaWQgfSkgewogICAgcmV0dXJuIGNoYWlucy5maW5kKChjaGFpbikgPT4gY2hhaW4uaWQgPT09IGlkKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9yZWdleC5qcwogIHZhciBhcnJheVJlZ2V4ID0gL14oLiopXFsoWzAtOV0qKVxdJC87CiAgdmFyIGJ5dGVzUmVnZXgyID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgdmFyIGludGVnZXJSZWdleDIgPSAvXih1P2ludCkoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9zb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyKCk7CiAgdmFyIHNvY2tldENsaWVudENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRTb2NrZXRScGNDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBnZXRTb2NrZXQ6IGdldFNvY2tldDIsIGtlZXBBbGl2ZSA9IHRydWUsIGtleSA9ICJzb2NrZXQiLCByZWNvbm5lY3QgPSB0cnVlLCB1cmwgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGludGVydmFsOiBrZWVwQWxpdmVJbnRlcnZhbCA9IDNlNCB9ID0gdHlwZW9mIGtlZXBBbGl2ZSA9PT0gIm9iamVjdCIgPyBrZWVwQWxpdmUgOiB7fTsKICAgIGNvbnN0IHsgYXR0ZW1wdHMgPSA1LCBkZWxheSA9IDJlMyB9ID0gdHlwZW9mIHJlY29ubmVjdCA9PT0gIm9iamVjdCIgPyByZWNvbm5lY3QgOiB7fTsKICAgIGxldCBzb2NrZXRDbGllbnQgPSBzb2NrZXRDbGllbnRDYWNoZS5nZXQoYCR7a2V5fToke3VybH1gKTsKICAgIGlmIChzb2NrZXRDbGllbnQpCiAgICAgIHJldHVybiBzb2NrZXRDbGllbnQ7CiAgICBsZXQgcmVjb25uZWN0Q291bnQgPSAwOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7a2V5fToke3VybH1gLAogICAgICBmbjogYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHJlcXVlc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBsZXQgZXJyb3I7CiAgICAgICAgbGV0IHNvY2tldDsKICAgICAgICBsZXQga2VlcEFsaXZlVGltZXI7CiAgICAgICAgYXN5bmMgZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRTb2NrZXQyKHsKICAgICAgICAgICAgb25DbG9zZSgpIHsKICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlcXVlc3Qgb2YgcmVxdWVzdHMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uRXJyb3I/LihuZXcgU29ja2V0Q2xvc2VkRXJyb3IoeyB1cmwgfSkpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybCB9KSk7CiAgICAgICAgICAgICAgcmVxdWVzdHMuY2xlYXIoKTsKICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLmNsZWFyKCk7CiAgICAgICAgICAgICAgaWYgKHJlY29ubmVjdCAmJiByZWNvbm5lY3RDb3VudCA8IGF0dGVtcHRzKQogICAgICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgIHJlY29ubmVjdENvdW50Kys7CiAgICAgICAgICAgICAgICAgIGF3YWl0IHNldHVwKCkuY2F0Y2goY29uc29sZS5lcnJvcik7CiAgICAgICAgICAgICAgICB9LCBkZWxheSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRXJyb3IoZXJyb3JfKSB7CiAgICAgICAgICAgICAgZXJyb3IgPSBlcnJvcl87CiAgICAgICAgICAgICAgZm9yIChjb25zdCByZXF1ZXN0IG9mIHJlcXVlc3RzLnZhbHVlcygpKQogICAgICAgICAgICAgICAgcmVxdWVzdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXF1ZXN0cy5jbGVhcigpOwogICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuY2xlYXIoKTsKICAgICAgICAgICAgICBpZiAocmVjb25uZWN0ICYmIHJlY29ubmVjdENvdW50IDwgYXR0ZW1wdHMpCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgcmVjb25uZWN0Q291bnQrKzsKICAgICAgICAgICAgICAgICAgYXdhaXQgc2V0dXAoKS5jYXRjaChjb25zb2xlLmVycm9yKTsKICAgICAgICAgICAgICAgIH0sIGRlbGF5KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25PcGVuKCkgewogICAgICAgICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgICAgICAgIHJlY29ubmVjdENvdW50ID0gMDsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25SZXNwb25zZShkYXRhKSB7CiAgICAgICAgICAgICAgY29uc3QgaXNTdWJzY3JpcHRpb24gPSBkYXRhLm1ldGhvZCA9PT0gImV0aF9zdWJzY3JpcHRpb24iOwogICAgICAgICAgICAgIGNvbnN0IGlkID0gaXNTdWJzY3JpcHRpb24gPyBkYXRhLnBhcmFtcy5zdWJzY3JpcHRpb24gOiBkYXRhLmlkOwogICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gaXNTdWJzY3JpcHRpb24gPyBzdWJzY3JpcHRpb25zIDogcmVxdWVzdHM7CiAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjYWNoZS5nZXQoaWQpOwogICAgICAgICAgICAgIGlmIChjYWxsYmFjaykKICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9uUmVzcG9uc2UoZGF0YSk7CiAgICAgICAgICAgICAgaWYgKCFpc1N1YnNjcmlwdGlvbikKICAgICAgICAgICAgICAgIGNhY2hlLmRlbGV0ZShpZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgc29ja2V0ID0gcmVzdWx0OwogICAgICAgICAgaWYgKGtlZXBBbGl2ZSkgewogICAgICAgICAgICBpZiAoa2VlcEFsaXZlVGltZXIpCiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChrZWVwQWxpdmVUaW1lcik7CiAgICAgICAgICAgIGtlZXBBbGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gc29ja2V0LnBpbmc/LigpLCBrZWVwQWxpdmVJbnRlcnZhbCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgICBhd2FpdCBzZXR1cCgpOwogICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgIHNvY2tldENsaWVudCA9IHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBrZWVwQWxpdmVUaW1lciAmJiBjbGVhckludGVydmFsKGtlZXBBbGl2ZVRpbWVyKTsKICAgICAgICAgICAgc29ja2V0LmNsb3NlKCk7CiAgICAgICAgICAgIHNvY2tldENsaWVudENhY2hlLmRlbGV0ZShgJHtrZXl9OiR7dXJsfWApOwogICAgICAgICAgfSwKICAgICAgICAgIGdldCBzb2NrZXQoKSB7CiAgICAgICAgICAgIHJldHVybiBzb2NrZXQ7CiAgICAgICAgICB9LAogICAgICAgICAgcmVxdWVzdCh7IGJvZHksIG9uRXJyb3IsIG9uUmVzcG9uc2UgfSkgewogICAgICAgICAgICBpZiAoZXJyb3IgJiYgb25FcnJvcikKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTsKICAgICAgICAgICAgY29uc3QgaWQgPSBib2R5LmlkID8/IGlkQ2FjaGUudGFrZSgpOwogICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuaWQgPT09ICJudW1iZXIiICYmIGlkICE9PSByZXNwb25zZS5pZCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAoYm9keS5tZXRob2QgPT09ICJldGhfc3Vic2NyaWJlIiAmJiB0eXBlb2YgcmVzcG9uc2UucmVzdWx0ID09PSAic3RyaW5nIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuc2V0KHJlc3BvbnNlLnJlc3VsdCwgewogICAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgb25FcnJvcgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaWYgKGJvZHkubWV0aG9kID09PSAiZXRoX3Vuc3Vic2NyaWJlIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZGVsZXRlKGJvZHkucGFyYW1zPy5bMF0pOwogICAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZXF1ZXN0cy5zZXQoaWQsIHsgb25SZXNwb25zZTogY2FsbGJhY2ssIG9uRXJyb3IgfSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgc29ja2V0LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBqc29ucnBjOiAiMi4wIiwKICAgICAgICAgICAgICAgICAgaWQsCiAgICAgICAgICAgICAgICAgIC4uLmJvZHkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IyKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0QXN5bmMoeyBib2R5LCB0aW1lb3V0ID0gMWU0IH0pIHsKICAgICAgICAgICAgcmV0dXJuIHdpdGhUaW1lb3V0KCgpID0+IG5ldyBQcm9taXNlKChvblJlc3BvbnNlLCBvbkVycm9yKSA9PiB0aGlzLnJlcXVlc3QoewogICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgb25FcnJvciwKICAgICAgICAgICAgICBvblJlc3BvbnNlCiAgICAgICAgICAgIH0pKSwgewogICAgICAgICAgICAgIGVycm9ySW5zdGFuY2U6IG5ldyBUaW1lb3V0RXJyb3IoeyBib2R5LCB1cmwgfSksCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0cywKICAgICAgICAgIHN1YnNjcmlwdGlvbnMsCiAgICAgICAgICB1cmwKICAgICAgICB9OwogICAgICAgIHNvY2tldENsaWVudENhY2hlLnNldChgJHtrZXl9OiR7dXJsfWAsIHNvY2tldENsaWVudCk7CiAgICAgICAgcmV0dXJuIFtzb2NrZXRDbGllbnRdOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFtfLCBbc29ja2V0Q2xpZW50X11dID0gYXdhaXQgc2NoZWR1bGUoKTsKICAgIHJldHVybiBzb2NrZXRDbGllbnRfOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBhc3luYyBmdW5jdGlvbiBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IHsga2VlcEFsaXZlLCByZWNvbm5lY3QgfSA9IG9wdGlvbnM7CiAgICByZXR1cm4gZ2V0U29ja2V0UnBjQ2xpZW50KHsKICAgICAgYXN5bmMgZ2V0U29ja2V0KHsgb25DbG9zZSwgb25FcnJvciwgb25PcGVuLCBvblJlc3BvbnNlIH0pIHsKICAgICAgICBjb25zdCBXZWJTb2NrZXQzID0gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiAoaW5pdF9uYXRpdmUoKSwgbmF0aXZlX2V4cG9ydHMpKS50aGVuKChtb2R1bGUpID0+IG1vZHVsZS5XZWJTb2NrZXQpOwogICAgICAgIGNvbnN0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQzKHVybCk7CiAgICAgICAgZnVuY3Rpb24gb25DbG9zZV8oKSB7CiAgICAgICAgICBvbkNsb3NlKCk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIG9uTWVzc2FnZSk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZXJyb3IiLCBvbkVycm9yKTsKICAgICAgICAgIHNvY2tldC5yZW1vdmVFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gb25NZXNzYWdlKHsgZGF0YSB9KSB7CiAgICAgICAgICBvblJlc3BvbnNlKEpTT04ucGFyc2UoZGF0YSkpOwogICAgICAgIH0KICAgICAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBvbk1lc3NhZ2UpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJlcnJvciIsIG9uRXJyb3IpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICBpZiAoc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldDMuQ09OTkVDVElORykgewogICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICBpZiAoIXNvY2tldCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHNvY2tldC5vbm9wZW4gPSByZXNvbHZlOwogICAgICAgICAgICBzb2NrZXQub25lcnJvciA9IHJlamVjdDsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCB7IGNsb3NlOiBjbG9zZV8gfSA9IHNvY2tldDsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihzb2NrZXQsIHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBjbG9zZV8uYmluZChzb2NrZXQpKCk7CiAgICAgICAgICAgIG9uQ2xvc2UoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBwaW5nKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgV2ViU29ja2V0UmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgICBjYXVzZTogbmV3IFNvY2tldENsb3NlZEVycm9yKHsgdXJsOiBzb2NrZXQudXJsIH0pCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjb25zdCBib2R5ID0gewogICAgICAgICAgICAgICAganNvbnJwYzogIjIuMCIsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICJuZXRfdmVyc2lvbiIsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShib2R5KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0KHsgYm9keSB9KSB7CiAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IFdlYlNvY2tldFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgICBib2R5LAogICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgY2F1c2U6IG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybDogc29ja2V0LnVybCB9KQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoYm9keSkpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBrZWVwQWxpdmUsCiAgICAgIHJlY29ubmVjdCwKICAgICAgdXJsCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvY29tcGF0LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0U29ja2V0KHVybCkgewogICAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybCk7CiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihjbGllbnQuc29ja2V0LCB7CiAgICAgIHJlcXVlc3RzOiBjbGllbnQucmVxdWVzdHMsCiAgICAgIHN1YnNjcmlwdGlvbnM6IGNsaWVudC5zdWJzY3JpcHRpb25zCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90eXBlZERhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfYWRkcmVzcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3R5cGVkRGF0YS5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICAgIHN1cGVyKGBJbnZhbGlkIHByaW1hcnkgdHlwZSBcYCR7cHJpbWFyeVR5cGV9XGAgbXVzdCBiZSBvbmUgb2YgXGAke0pTT04uc3RyaW5naWZ5KE9iamVjdC5rZXlzKHR5cGVzKSl9XGAuYCwgewogICAgICAgIGRvY3NQYXRoOiAiL2FwaS9nbG9zc2FyeS9FcnJvcnMjdHlwZWRkYXRhaW52YWxpZHByaW1hcnl0eXBlZXJyb3IiLAogICAgICAgIG1ldGFNZXNzYWdlczogWyJDaGVjayB0aGF0IHRoZSBwcmltYXJ5IHR5cGUgaXMgYSBrZXkgaW4gYHR5cGVzYC4iXQogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkU3RydWN0VHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdHlwZSB9KSB7CiAgICAgIHN1cGVyKGBTdHJ1Y3QgdHlwZSAiJHt0eXBlfSIgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIlN0cnVjdCB0eXBlIG11c3Qgbm90IGJlIGEgU29saWRpdHkgdHlwZS4iXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFN0cnVjdFR5cGVFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hUeXBlZERhdGEuanMKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hUeXBlZERhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBkb21haW4gPSB7fSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0eXBlcyA9IHsKICAgICAgRUlQNzEyRG9tYWluOiBnZXRUeXBlc0ZvckVJUDcxMkRvbWFpbih7IGRvbWFpbiB9KSwKICAgICAgLi4ucGFyYW1ldGVycy50eXBlcwogICAgfTsKICAgIHZhbGlkYXRlVHlwZWREYXRhKHsKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlLAogICAgICBwcmltYXJ5VHlwZSwKICAgICAgdHlwZXMKICAgIH0pOwogICAgY29uc3QgcGFydHMgPSBbIjB4MTkwMSJdOwogICAgaWYgKGRvbWFpbikKICAgICAgcGFydHMucHVzaChoYXNoRG9tYWluKHsKICAgICAgICBkb21haW4sCiAgICAgICAgdHlwZXMKICAgICAgfSkpOwogICAgaWYgKHByaW1hcnlUeXBlICE9PSAiRUlQNzEyRG9tYWluIikKICAgICAgcGFydHMucHVzaChoYXNoU3RydWN0KHsKICAgICAgICBkYXRhOiBtZXNzYWdlLAogICAgICAgIHByaW1hcnlUeXBlLAogICAgICAgIHR5cGVzCiAgICAgIH0pKTsKICAgIHJldHVybiBrZWNjYWsyNTYoY29uY2F0KHBhcnRzKSk7CiAgfQogIGZ1bmN0aW9uIGhhc2hEb21haW4oeyBkb21haW4sIHR5cGVzIH0pIHsKICAgIHJldHVybiBoYXNoU3RydWN0KHsKICAgICAgZGF0YTogZG9tYWluLAogICAgICBwcmltYXJ5VHlwZTogIkVJUDcxMkRvbWFpbiIsCiAgICAgIHR5cGVzCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gaGFzaFN0cnVjdCh7IGRhdGEsIHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICBjb25zdCBlbmNvZGVkID0gZW5jb2RlRGF0YSh7CiAgICAgIGRhdGEsCiAgICAgIHByaW1hcnlUeXBlLAogICAgICB0eXBlcwogICAgfSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWQpOwogIH0KICBmdW5jdGlvbiBlbmNvZGVEYXRhKHsgZGF0YSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pIHsKICAgIGNvbnN0IGVuY29kZWRUeXBlcyA9IFt7IHR5cGU6ICJieXRlczMyIiB9XTsKICAgIGNvbnN0IGVuY29kZWRWYWx1ZXMgPSBbaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSldOwogICAgZm9yIChjb25zdCBmaWVsZCBvZiB0eXBlc1twcmltYXJ5VHlwZV0pIHsKICAgICAgY29uc3QgW3R5cGUsIHZhbHVlXSA9IGVuY29kZUZpZWxkKHsKICAgICAgICB0eXBlcywKICAgICAgICBuYW1lOiBmaWVsZC5uYW1lLAogICAgICAgIHR5cGU6IGZpZWxkLnR5cGUsCiAgICAgICAgdmFsdWU6IGRhdGFbZmllbGQubmFtZV0KICAgICAgfSk7CiAgICAgIGVuY29kZWRUeXBlcy5wdXNoKHR5cGUpOwogICAgICBlbmNvZGVkVmFsdWVzLnB1c2godmFsdWUpOwogICAgfQogICAgcmV0dXJuIGVuY29kZUFiaVBhcmFtZXRlcnMoZW5jb2RlZFR5cGVzLCBlbmNvZGVkVmFsdWVzKTsKICB9CiAgZnVuY3Rpb24gaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgY29uc3QgZW5jb2RlZEhhc2hUeXBlID0gdG9IZXgoZW5jb2RlVHlwZSh7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWRIYXNoVHlwZSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZVR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgY29uc3QgdW5zb3J0ZWREZXBzID0gZmluZFR5cGVEZXBlbmRlbmNpZXMoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSk7CiAgICB1bnNvcnRlZERlcHMuZGVsZXRlKHByaW1hcnlUeXBlKTsKICAgIGNvbnN0IGRlcHMgPSBbcHJpbWFyeVR5cGUsIC4uLkFycmF5LmZyb20odW5zb3J0ZWREZXBzKS5zb3J0KCldOwogICAgZm9yIChjb25zdCB0eXBlIG9mIGRlcHMpIHsKICAgICAgcmVzdWx0ICs9IGAke3R5cGV9KCR7dHlwZXNbdHlwZV0ubWFwKCh7IG5hbWUsIHR5cGU6IHQgfSkgPT4gYCR7dH0gJHtuYW1lfWApLmpvaW4oIiwiKX0pYDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IHByaW1hcnlUeXBlXywgdHlwZXMgfSwgcmVzdWx0cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpIHsKICAgIGNvbnN0IG1hdGNoID0gcHJpbWFyeVR5cGVfLm1hdGNoKC9eXHcqL3UpOwogICAgY29uc3QgcHJpbWFyeVR5cGUgPSBtYXRjaD8uWzBdOwogICAgaWYgKHJlc3VsdHMuaGFzKHByaW1hcnlUeXBlKSB8fCB0eXBlc1twcmltYXJ5VHlwZV0gPT09IHZvaWQgMCkgewogICAgICByZXR1cm4gcmVzdWx0czsKICAgIH0KICAgIHJlc3VsdHMuYWRkKHByaW1hcnlUeXBlKTsKICAgIGZvciAoY29uc3QgZmllbGQgb2YgdHlwZXNbcHJpbWFyeVR5cGVdKSB7CiAgICAgIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IGZpZWxkLnR5cGUsIHR5cGVzIH0sIHJlc3VsdHMpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUZpZWxkKHsgdHlwZXMsIG5hbWUsIHR5cGUsIHZhbHVlIH0pIHsKICAgIGlmICh0eXBlc1t0eXBlXSAhPT0gdm9pZCAwKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgeyB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICBrZWNjYWsyNTYoZW5jb2RlRGF0YSh7IGRhdGE6IHZhbHVlLCBwcmltYXJ5VHlwZTogdHlwZSwgdHlwZXMgfSkpCiAgICAgIF07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikgewogICAgICBjb25zdCBwcmVwZW5kID0gdmFsdWUubGVuZ3RoICUgMiA/ICIwIiA6ICIiOwogICAgICB2YWx1ZSA9IGAweCR7cHJlcGVuZCArIHZhbHVlLnNsaWNlKDIpfWA7CiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHZhbHVlKV07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHRvSGV4KHZhbHVlKSldOwogICAgaWYgKHR5cGUubGFzdEluZGV4T2YoIl0iKSA9PT0gdHlwZS5sZW5ndGggLSAxKSB7CiAgICAgIGNvbnN0IHBhcnNlZFR5cGUgPSB0eXBlLnNsaWNlKDAsIHR5cGUubGFzdEluZGV4T2YoIlsiKSk7CiAgICAgIGNvbnN0IHR5cGVWYWx1ZVBhaXJzID0gdmFsdWUubWFwKChpdGVtKSA9PiBlbmNvZGVGaWVsZCh7CiAgICAgICAgbmFtZSwKICAgICAgICB0eXBlOiBwYXJzZWRUeXBlLAogICAgICAgIHR5cGVzLAogICAgICAgIHZhbHVlOiBpdGVtCiAgICAgIH0pKTsKICAgICAgcmV0dXJuIFsKICAgICAgICB7IHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIGtlY2NhazI1NihlbmNvZGVBYmlQYXJhbWV0ZXJzKHR5cGVWYWx1ZVBhaXJzLm1hcCgoW3RdKSA9PiB0KSwgdHlwZVZhbHVlUGFpcnMubWFwKChbLCB2XSkgPT4gdikpKQogICAgICBdOwogICAgfQogICAgcmV0dXJuIFt7IHR5cGUgfSwgdmFsdWVdOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplVHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZG9tYWluOiBkb21haW5fLCBtZXNzYWdlOiBtZXNzYWdlXywgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgbm9ybWFsaXplRGF0YSA9IChzdHJ1Y3QsIGRhdGFfKSA9PiB7CiAgICAgIGNvbnN0IGRhdGEgPSB7IC4uLmRhdGFfIH07CiAgICAgIGZvciAoY29uc3QgcGFyYW0gb2Ygc3RydWN0KSB7CiAgICAgICAgY29uc3QgeyBuYW1lLCB0eXBlIH0gPSBwYXJhbTsKICAgICAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKQogICAgICAgICAgZGF0YVtuYW1lXSA9IGRhdGFbbmFtZV0udG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgICByZXR1cm4gZGF0YTsKICAgIH07CiAgICBjb25zdCBkb21haW4gPSAoKCkgPT4gewogICAgICBpZiAoIXR5cGVzLkVJUDcxMkRvbWFpbikKICAgICAgICByZXR1cm4ge307CiAgICAgIGlmICghZG9tYWluXykKICAgICAgICByZXR1cm4ge307CiAgICAgIHJldHVybiBub3JtYWxpemVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluXyk7CiAgICB9KSgpOwogICAgY29uc3QgbWVzc2FnZSA9ICgoKSA9PiB7CiAgICAgIGlmIChwcmltYXJ5VHlwZSA9PT0gIkVJUDcxMkRvbWFpbiIpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgcmV0dXJuIG5vcm1hbGl6ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlXyk7CiAgICB9KSgpOwogICAgcmV0dXJuIHN0cmluZ2lmeSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVR5cGVkRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdmFsaWRhdGVEYXRhID0gKHN0cnVjdCwgZGF0YSkgPT4gewogICAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHN0cnVjdCkgewogICAgICAgIGNvbnN0IHsgbmFtZSwgdHlwZSB9ID0gcGFyYW07CiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW25hbWVdOwogICAgICAgIGNvbnN0IGludGVnZXJNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICAgICAgaWYgKGludGVnZXJNYXRjaCAmJiAodHlwZW9mIHZhbHVlID09PSAibnVtYmVyIiB8fCB0eXBlb2YgdmFsdWUgPT09ICJiaWdpbnQiKSkgewogICAgICAgICAgY29uc3QgW190eXBlLCBiYXNlMiwgc2l6ZV9dID0gaW50ZWdlck1hdGNoOwogICAgICAgICAgbnVtYmVyVG9IZXgodmFsdWUsIHsKICAgICAgICAgICAgc2lnbmVkOiBiYXNlMiA9PT0gImludCIsCiAgICAgICAgICAgIHNpemU6IE51bWJlci5wYXJzZUludChzaXplXykgLyA4CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGUgPT09ICJhZGRyZXNzIiAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFpc0FkZHJlc3ModmFsdWUpKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgICAgICBjb25zdCBieXRlc01hdGNoID0gdHlwZS5tYXRjaChieXRlc1JlZ2V4Mik7CiAgICAgICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgICAgIGNvbnN0IFtfdHlwZSwgc2l6ZV9dID0gYnl0ZXNNYXRjaDsKICAgICAgICAgIGlmIChzaXplXyAmJiBzaXplKHZhbHVlKSAhPT0gTnVtYmVyLnBhcnNlSW50KHNpemVfKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IoewogICAgICAgICAgICAgIGV4cGVjdGVkU2l6ZTogTnVtYmVyLnBhcnNlSW50KHNpemVfKSwKICAgICAgICAgICAgICBnaXZlblNpemU6IHNpemUodmFsdWUpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCBzdHJ1Y3QyID0gdHlwZXNbdHlwZV07CiAgICAgICAgaWYgKHN0cnVjdDIpIHsKICAgICAgICAgIHZhbGlkYXRlUmVmZXJlbmNlKHR5cGUpOwogICAgICAgICAgdmFsaWRhdGVEYXRhKHN0cnVjdDIsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBpZiAodHlwZXMuRUlQNzEyRG9tYWluICYmIGRvbWFpbikKICAgICAgdmFsaWRhdGVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluKTsKICAgIGlmIChwcmltYXJ5VHlwZSAhPT0gIkVJUDcxMkRvbWFpbiIpIHsKICAgICAgaWYgKHR5cGVzW3ByaW1hcnlUeXBlXSkKICAgICAgICB2YWxpZGF0ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlKTsKICAgICAgZWxzZQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0VHlwZXNGb3JFSVA3MTJEb21haW4oeyBkb21haW4gfSkgewogICAgcmV0dXJuIFsKICAgICAgdHlwZW9mIGRvbWFpbj8ubmFtZSA9PT0gInN0cmluZyIgJiYgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgIGRvbWFpbj8udmVyc2lvbiAmJiB7IG5hbWU6ICJ2ZXJzaW9uIiwgdHlwZTogInN0cmluZyIgfSwKICAgICAgdHlwZW9mIGRvbWFpbj8uY2hhaW5JZCA9PT0gIm51bWJlciIgJiYgewogICAgICAgIG5hbWU6ICJjaGFpbklkIiwKICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgfSwKICAgICAgZG9tYWluPy52ZXJpZnlpbmdDb250cmFjdCAmJiB7CiAgICAgICAgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwKICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgfSwKICAgICAgZG9tYWluPy5zYWx0ICYmIHsgbmFtZTogInNhbHQiLCB0eXBlOiAiYnl0ZXMzMiIgfQogICAgXS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGRvbWFpblNlcGFyYXRvcih7IGRvbWFpbiB9KSB7CiAgICByZXR1cm4gaGFzaERvbWFpbih7CiAgICAgIGRvbWFpbiwKICAgICAgdHlwZXM6IHsKICAgICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pCiAgICAgIH0KICAgIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVJlZmVyZW5jZSh0eXBlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiIHx8IHR5cGUgPT09ICJib29sIiB8fCB0eXBlID09PSAic3RyaW5nIiB8fCB0eXBlLnN0YXJ0c1dpdGgoImJ5dGVzIikgfHwgdHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgdHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IoeyB0eXBlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvbkRhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvbkRhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGRhdGEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzbGljZShkYXRhLCAwLCA0KTsKICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJmdW5jdGlvbiIgJiYgc2lnbmF0dXJlID09PSB0b0Z1bmN0aW9uU2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVGdW5jdGlvbkRhdGEiCiAgICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgZnVuY3Rpb25OYW1lOiBkZXNjcmlwdGlvbi5uYW1lLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBkZXNjcmlwdGlvbiAmJiBkZXNjcmlwdGlvbi5pbnB1dHMgJiYgZGVzY3JpcHRpb24uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgc2xpY2UoZGF0YSwgNCkpIDogdm9pZCAwCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVFcnJvclJlc3VsdC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg2ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUVycm9yUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVFcnJvclJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZXJyb3JOYW1lLCBhcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGVycm9yTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZXJyb3JOYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9yTm90Rm91bmRFcnJvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgQWJpRXJyb3JOb3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg2IH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9GdW5jdGlvblNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IGRhdGEgPSAiMHgiOwogICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGggPiAwKSB7CiAgICAgIGlmICghYWJpSXRlbS5pbnB1dHMpCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvcihhYmlJdGVtLm5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMsIGFyZ3MpOwogICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbc2lnbmF0dXJlLCBkYXRhXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaW5kZXguanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uUmVzdWx0LmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg3ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUZ1bmN0aW9uUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lLCByZXN1bHQgfSA9IHBhcmFtZXRlcnM7CiAgICBsZXQgYWJpSXRlbSA9IGFiaTJbMF07CiAgICBpZiAoZnVuY3Rpb25OYW1lKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSBnZXRBYmlJdGVtKHsgYWJpOiBhYmkyLCBuYW1lOiBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmICghaXRlbSkKICAgICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg3IH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBpZiAoIWFiaUl0ZW0ub3V0cHV0cykKICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IoYWJpSXRlbS5uYW1lLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBsZXQgdmFsdWVzID0gQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0IDogW3Jlc3VsdF07CiAgICBpZiAoYWJpSXRlbS5vdXRwdXRzLmxlbmd0aCA9PT0gMCAmJiAhdmFsdWVzWzBdKQogICAgICB2YWx1ZXMgPSBbXTsKICAgIHJldHVybiBlbmNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0ub3V0cHV0cywgdmFsdWVzKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlUGFja2VkLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9wYWQoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlUGFja2VkKHR5cGVzLCB2YWx1ZXMpIHsKICAgIGlmICh0eXBlcy5sZW5ndGggIT09IHZhbHVlcy5sZW5ndGgpCiAgICAgIHRocm93IG5ldyBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IoewogICAgICAgIGV4cGVjdGVkTGVuZ3RoOiB0eXBlcy5sZW5ndGgsCiAgICAgICAgZ2l2ZW5MZW5ndGg6IHZhbHVlcy5sZW5ndGgKICAgICAgfSk7CiAgICBjb25zdCBkYXRhID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHR5cGUgPSB0eXBlc1tpXTsKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07CiAgICAgIGRhdGEucHVzaChlbmNvZGUodHlwZSwgdmFsdWUpKTsKICAgIH0KICAgIHJldHVybiBjb25jYXRIZXgoZGF0YSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZSh0eXBlLCB2YWx1ZSwgaXNBcnJheSA9IGZhbHNlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIGNvbnN0IGFkZHJlc3MgPSB2YWx1ZTsKICAgICAgaWYgKCFpc0FkZHJlc3MoYWRkcmVzcykpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICByZXR1cm4gcGFkKGFkZHJlc3MudG9Mb3dlckNhc2UoKSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBzdHJpbmdUb0hleCh2YWx1ZSk7CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIHZhbHVlOwogICAgaWYgKHR5cGUgPT09ICJib29sIikKICAgICAgcmV0dXJuIHBhZChib29sVG9IZXgodmFsdWUpLCB7IHNpemU6IGlzQXJyYXkgPyAzMiA6IDEgfSk7CiAgICBjb25zdCBpbnRNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICBpZiAoaW50TWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBiYXNlVHlwZSwgYml0cyA9ICIyNTYiXSA9IGludE1hdGNoOwogICAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChiaXRzKSAvIDg7CiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IHNpemUzLAogICAgICAgIHNpZ25lZDogYmFzZVR5cGUgPT09ICJpbnQiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYnl0ZXNNYXRjaCA9IHR5cGUubWF0Y2goYnl0ZXNSZWdleDIpOwogICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBzaXplM10gPSBieXRlc01hdGNoOwogICAgICBpZiAoTnVtYmVyLnBhcnNlSW50KHNpemUzKSAhPT0gKHZhbHVlLmxlbmd0aCAtIDIpIC8gMikKICAgICAgICB0aHJvdyBuZXcgQnl0ZXNTaXplTWlzbWF0Y2hFcnJvcih7CiAgICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChzaXplMyksCiAgICAgICAgICBnaXZlblNpemU6ICh2YWx1ZS5sZW5ndGggLSAyKSAvIDIKICAgICAgICB9KTsKICAgICAgcmV0dXJuIHBhZCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIsIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwgfSk7CiAgICB9CiAgICBjb25zdCBhcnJheU1hdGNoID0gdHlwZS5tYXRjaChhcnJheVJlZ2V4KTsKICAgIGlmIChhcnJheU1hdGNoICYmIEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGNvbnN0IFtfdHlwZSwgY2hpbGRUeXBlXSA9IGFycmF5TWF0Y2g7CiAgICAgIGNvbnN0IGRhdGEgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGEucHVzaChlbmNvZGUoY2hpbGRUeXBlLCB2YWx1ZVtpXSwgdHJ1ZSkpOwogICAgICB9CiAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkKICAgICAgICByZXR1cm4gIjB4IjsKICAgICAgcmV0dXJuIGNvbmNhdEhleChkYXRhKTsKICAgIH0KICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUodHlwZSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9nZXRDb250cmFjdEFkZHJlc3MuanMKICBpbml0X2NvbmNhdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0J5dGVzLmpzCiAgZnVuY3Rpb24gaXNCeXRlczModmFsdWUpIHsKICAgIGlmICghdmFsdWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJvYmplY3QiKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoISgiQllURVNfUEVSX0VMRU1FTlQiIGluIHZhbHVlKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHZhbHVlLkJZVEVTX1BFUl9FTEVNRU5UID09PSAxICYmIHZhbHVlLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldENvbnRyYWN0QWRkcmVzcy5qcwogIGluaXRfcGFkKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgZnVuY3Rpb24gZ2V0Q29udHJhY3RBZGRyZXNzMihvcHRzKSB7CiAgICBpZiAob3B0cy5vcGNvZGUgPT09ICJDUkVBVEUyIikKICAgICAgcmV0dXJuIGdldENyZWF0ZTJBZGRyZXNzKG9wdHMpOwogICAgcmV0dXJuIGdldENyZWF0ZUFkZHJlc3Mob3B0cyk7CiAgfQogIGZ1bmN0aW9uIGdldENyZWF0ZUFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGxldCBub25jZSA9IHRvQnl0ZXMob3B0cy5ub25jZSk7CiAgICBpZiAobm9uY2VbMF0gPT09IDApCiAgICAgIG5vbmNlID0gbmV3IFVpbnQ4QXJyYXkoW10pOwogICAgcmV0dXJuIGdldEFkZHJlc3MoYDB4JHtrZWNjYWsyNTYodG9SbHAoW2Zyb20sIG5vbmNlXSwgImJ5dGVzIikpLnNsaWNlKDI2KX1gKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q3JlYXRlMkFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGNvbnN0IHNhbHQgPSBwYWQoaXNCeXRlczMob3B0cy5zYWx0KSA/IG9wdHMuc2FsdCA6IHRvQnl0ZXMob3B0cy5zYWx0KSwgewogICAgICBzaXplOiAzMgogICAgfSk7CiAgICBjb25zdCBieXRlY29kZUhhc2ggPSAoKCkgPT4gewogICAgICBpZiAoImJ5dGVjb2RlSGFzaCIgaW4gb3B0cykgewogICAgICAgIGlmIChpc0J5dGVzMyhvcHRzLmJ5dGVjb2RlSGFzaCkpCiAgICAgICAgICByZXR1cm4gb3B0cy5ieXRlY29kZUhhc2g7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMob3B0cy5ieXRlY29kZUhhc2gpOwogICAgICB9CiAgICAgIHJldHVybiBrZWNjYWsyNTYob3B0cy5ieXRlY29kZSwgImJ5dGVzIik7CiAgICB9KSgpOwogICAgcmV0dXJuIGdldEFkZHJlc3Moc2xpY2Uoa2VjY2FrMjU2KGNvbmNhdChbdG9CeXRlcygiMHhmZiIpLCBmcm9tLCBzYWx0LCBieXRlY29kZUhhc2hdKSksIDEyKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvblJlY2VpcHQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X2Zvcm1hdHRlcigpOwogIHZhciByZWNlaXB0U3RhdHVzZXMgPSB7CiAgICAiMHgwIjogInJldmVydGVkIiwKICAgICIweDEiOiAic3VjY2VzcyIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCh0cmFuc2FjdGlvblJlY2VpcHQpIHsKICAgIGNvbnN0IHJlY2VpcHQgPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uUmVjZWlwdCwKICAgICAgYmxvY2tOdW1iZXI6IHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvblJlY2VpcHQuYmxvY2tOdW1iZXIpIDogbnVsbCwKICAgICAgY29udHJhY3RBZGRyZXNzOiB0cmFuc2FjdGlvblJlY2VpcHQuY29udHJhY3RBZGRyZXNzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmNvbnRyYWN0QWRkcmVzcyA6IG51bGwsCiAgICAgIGN1bXVsYXRpdmVHYXNVc2VkOiB0cmFuc2FjdGlvblJlY2VpcHQuY3VtdWxhdGl2ZUdhc1VzZWQgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmN1bXVsYXRpdmVHYXNVc2VkKSA6IG51bGwsCiAgICAgIGVmZmVjdGl2ZUdhc1ByaWNlOiB0cmFuc2FjdGlvblJlY2VpcHQuZWZmZWN0aXZlR2FzUHJpY2UgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmVmZmVjdGl2ZUdhc1ByaWNlKSA6IG51bGwsCiAgICAgIGdhc1VzZWQ6IHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkID8gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkKSA6IG51bGwsCiAgICAgIGxvZ3M6IHRyYW5zYWN0aW9uUmVjZWlwdC5sb2dzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKSA6IG51bGwsCiAgICAgIHRvOiB0cmFuc2FjdGlvblJlY2VpcHQudG8gPyB0cmFuc2FjdGlvblJlY2VpcHQudG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvblJlY2VpcHQudHJhbnNhY3Rpb25JbmRleCA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uUmVjZWlwdC50cmFuc2FjdGlvbkluZGV4KSA6IG51bGwsCiAgICAgIHN0YXR1czogdHJhbnNhY3Rpb25SZWNlaXB0LnN0YXR1cyA/IHJlY2VpcHRTdGF0dXNlc1t0cmFuc2FjdGlvblJlY2VpcHQuc3RhdHVzXSA6IG51bGwsCiAgICAgIHR5cGU6IHRyYW5zYWN0aW9uUmVjZWlwdC50eXBlID8gdHJhbnNhY3Rpb25UeXBlW3RyYW5zYWN0aW9uUmVjZWlwdC50eXBlXSB8fCB0cmFuc2FjdGlvblJlY2VpcHQudHlwZSA6IG51bGwKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSkKICAgICAgcmVjZWlwdC5ibG9iR2FzUHJpY2UgPSBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSk7CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNVc2VkKQogICAgICByZWNlaXB0LmJsb2JHYXNVc2VkID0gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9iR2FzVXNlZCk7CiAgICByZXR1cm4gcmVjZWlwdDsKICB9CiAgdmFyIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVGb3JtYXR0ZXIoInRyYW5zYWN0aW9uUmVjZWlwdCIsIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9pbmRleC5qcwogIGluaXRfZnJvbUhleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbVJscC5qcwogIGluaXRfYmFzZSgpOwogIGluaXRfZW5jb2RpbmcoKTsKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbVJscCh2YWx1ZSwgdG8gPSAiaGV4IikgewogICAgY29uc3QgYnl0ZXMyID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMyAmJiB2YWx1ZS5sZW5ndGggJSAyICE9PSAwKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRIZXhWYWx1ZUVycm9yKHZhbHVlKTsKICAgICAgICByZXR1cm4gaGV4VG9CeXRlcyh2YWx1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSkoKTsKICAgIGNvbnN0IGN1cnNvciA9IGNyZWF0ZUN1cnNvcihieXRlczIsIHsKICAgICAgcmVjdXJzaXZlUmVhZExpbWl0OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkKICAgIH0pOwogICAgY29uc3QgcmVzdWx0ID0gZnJvbVJscEN1cnNvcihjdXJzb3IsIHRvKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0byA9ICJoZXgiKSB7CiAgICBpZiAoY3Vyc29yLmJ5dGVzLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKSA6IGN1cnNvci5ieXRlczsKICAgIGNvbnN0IHByZWZpeCA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgaWYgKHByZWZpeCA8IDEyOCkKICAgICAgY3Vyc29yLmRlY3JlbWVudFBvc2l0aW9uKDEpOwogICAgaWYgKHByZWZpeCA8IDE5MikgewogICAgICBjb25zdCBsZW5ndGgyID0gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgMTI4KTsKICAgICAgY29uc3QgYnl0ZXMyID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgyKTsKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoYnl0ZXMyKSA6IGJ5dGVzMjsKICAgIH0KICAgIGNvbnN0IGxlbmd0aCA9IHJlYWRMZW5ndGgoY3Vyc29yLCBwcmVmaXgsIDE5Mik7CiAgICByZXR1cm4gcmVhZExpc3QoY3Vyc29yLCBsZW5ndGgsIHRvKTsKICB9CiAgZnVuY3Rpb24gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgb2Zmc2V0KSB7CiAgICBpZiAob2Zmc2V0ID09PSAxMjggJiYgcHJlZml4IDwgMTI4KQogICAgICByZXR1cm4gMTsKICAgIGlmIChwcmVmaXggPD0gb2Zmc2V0ICsgNTUpCiAgICAgIHJldHVybiBwcmVmaXggLSBvZmZzZXQ7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDEpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQ4KCk7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDIpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQxNigpOwogICAgaWYgKHByZWZpeCA9PT0gb2Zmc2V0ICsgNTUgKyAzKQogICAgICByZXR1cm4gY3Vyc29yLnJlYWRVaW50MjQoKTsKICAgIGlmIChwcmVmaXggPT09IG9mZnNldCArIDU1ICsgNCkKICAgICAgcmV0dXJuIGN1cnNvci5yZWFkVWludDMyKCk7CiAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiSW52YWxpZCBSTFAgcHJlZml4Iik7CiAgfQogIGZ1bmN0aW9uIHJlYWRMaXN0KGN1cnNvciwgbGVuZ3RoLCB0bykgewogICAgY29uc3QgcG9zaXRpb24gPSBjdXJzb3IucG9zaXRpb247CiAgICBjb25zdCB2YWx1ZSA9IFtdOwogICAgd2hpbGUgKGN1cnNvci5wb3NpdGlvbiAtIHBvc2l0aW9uIDwgbGVuZ3RoKQogICAgICB2YWx1ZS5wdXNoKGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0bykpOwogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudFNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9GdW5jdGlvblNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudEhhc2guanMKICBpbml0X3RvU2lnbmF0dXJlSGFzaCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC90b0Z1bmN0aW9uSGFzaC5qcwogIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2lzSGFzaC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3NpemUoKTsKICBmdW5jdGlvbiBpc0hhc2goaGFzaDMpIHsKICAgIHJldHVybiBpc0hleChoYXNoMykgJiYgc2l6ZShoYXNoMykgPT09IDMyOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3JpcGVtZDE2MC5qcwogIGluaXRfbWQoKTsKICBpbml0X3V0aWxzMigpOwogIHZhciBSaG8gPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkoWzcsIDQsIDEzLCAxLCAxMCwgNiwgMTUsIDMsIDEyLCAwLCA5LCA1LCAyLCAxNCwgMTEsIDhdKTsKICB2YXIgSWQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5KDE2KS5maWxsKDApLm1hcCgoXywgaSkgPT4gaSkpOwogIHZhciBQaSA9IC8qIEBfX1BVUkVfXyAqLyBJZC5tYXAoKGkpID0+ICg5ICogaSArIDUpICUgMTYpOwogIHZhciBpZHhMID0gW0lkXTsKICB2YXIgaWR4UiA9IFtQaV07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspCiAgICBmb3IgKGxldCBqIG9mIFtpZHhMLCBpZHhSXSkKICAgICAgai5wdXNoKGpbaV0ubWFwKChrKSA9PiBSaG9ba10pKTsKICB2YXIgc2hpZnRzID0gLyogQF9fUFVSRV9fICovIFsKICAgIFsxMSwgMTQsIDE1LCAxMiwgNSwgOCwgNywgOSwgMTEsIDEzLCAxNCwgMTUsIDYsIDcsIDksIDhdLAogICAgWzEyLCAxMywgMTEsIDE1LCA2LCA5LCA5LCA3LCAxMiwgMTUsIDExLCAxMywgNywgOCwgNywgN10sCiAgICBbMTMsIDE1LCAxNCwgMTEsIDcsIDcsIDYsIDgsIDEzLCAxNCwgMTMsIDEyLCA1LCA1LCA2LCA5XSwKICAgIFsxNCwgMTEsIDEyLCAxNCwgOCwgNiwgNSwgNSwgMTUsIDEyLCAxNSwgMTQsIDksIDksIDgsIDZdLAogICAgWzE1LCAxMiwgMTMsIDEzLCA5LCA1LCA4LCA2LCAxNCwgMTEsIDEyLCAxMSwgOCwgNiwgNSwgNV0KICBdLm1hcCgoaSkgPT4gbmV3IFVpbnQ4QXJyYXkoaSkpOwogIHZhciBzaGlmdHNMID0gLyogQF9fUFVSRV9fICovIGlkeEwubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBzaGlmdHNSID0gLyogQF9fUFVSRV9fICovIGlkeFIubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBLbCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgMCwKICAgIDE1MTg1MDAyNDksCiAgICAxODU5Nzc1MzkzLAogICAgMjQwMDk1OTcwOCwKICAgIDI4NDA4NTM4MzgKICBdKTsKICB2YXIgS3IgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgIDEzNTI4Mjk5MjYsCiAgICAxNTQ4NjAzNjg0LAogICAgMTgzNjA3MjY5MSwKICAgIDIwNTM5OTQyMTcsCiAgICAwCiAgXSk7CiAgZnVuY3Rpb24gZihncm91cCwgeCwgeSwgeikgewogICAgaWYgKGdyb3VwID09PSAwKQogICAgICByZXR1cm4geCBeIHkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDEpCiAgICAgIHJldHVybiB4ICYgeSB8IH54ICYgejsKICAgIGVsc2UgaWYgKGdyb3VwID09PSAyKQogICAgICByZXR1cm4gKHggfCB+eSkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDMpCiAgICAgIHJldHVybiB4ICYgeiB8IHkgJiB+ejsKICAgIGVsc2UKICAgICAgcmV0dXJuIHggXiAoeSB8IH56KTsKICB9CiAgdmFyIFJfQlVGID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50MzJBcnJheSgxNik7CiAgdmFyIFJJUEVNRDE2MCA9IGNsYXNzIGV4dGVuZHMgSGFzaE1EIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcig2NCwgMjAsIDgsIHRydWUpOwogICAgICB0aGlzLmgwID0gMTczMjU4NDE5MyB8IDA7CiAgICAgIHRoaXMuaDEgPSA0MDIzMjMzNDE3IHwgMDsKICAgICAgdGhpcy5oMiA9IDI1NjIzODMxMDIgfCAwOwogICAgICB0aGlzLmgzID0gMjcxNzMzODc4IHwgMDsKICAgICAgdGhpcy5oNCA9IDMyODUzNzc1MjAgfCAwOwogICAgfQogICAgZ2V0KCkgewogICAgICBjb25zdCB7IGgwLCBoMSwgaDIsIGgzLCBoNCB9ID0gdGhpczsKICAgICAgcmV0dXJuIFtoMCwgaDEsIGgyLCBoMywgaDRdOwogICAgfQogICAgc2V0KGgwLCBoMSwgaDIsIGgzLCBoNCkgewogICAgICB0aGlzLmgwID0gaDAgfCAwOwogICAgICB0aGlzLmgxID0gaDEgfCAwOwogICAgICB0aGlzLmgyID0gaDIgfCAwOwogICAgICB0aGlzLmgzID0gaDMgfCAwOwogICAgICB0aGlzLmg0ID0gaDQgfCAwOwogICAgfQogICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrLCBvZmZzZXQgKz0gNCkKICAgICAgICBSX0JVRltpXSA9IHZpZXcuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7CiAgICAgIGxldCBhbCA9IHRoaXMuaDAgfCAwLCBhciA9IGFsLCBibCA9IHRoaXMuaDEgfCAwLCBiciA9IGJsLCBjbCA9IHRoaXMuaDIgfCAwLCBjciA9IGNsLCBkbCA9IHRoaXMuaDMgfCAwLCBkciA9IGRsLCBlbCA9IHRoaXMuaDQgfCAwLCBlciA9IGVsOwogICAgICBmb3IgKGxldCBncm91cCA9IDA7IGdyb3VwIDwgNTsgZ3JvdXArKykgewogICAgICAgIGNvbnN0IHJHcm91cCA9IDQgLSBncm91cDsKICAgICAgICBjb25zdCBoYmwgPSBLbFtncm91cF0sIGhiciA9IEtyW2dyb3VwXTsKICAgICAgICBjb25zdCBybCA9IGlkeExbZ3JvdXBdLCByciA9IGlkeFJbZ3JvdXBdOwogICAgICAgIGNvbnN0IHNsID0gc2hpZnRzTFtncm91cF0sIHNyID0gc2hpZnRzUltncm91cF07CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB0bCA9IHJvdGwoYWwgKyBmKGdyb3VwLCBibCwgY2wsIGRsKSArIFJfQlVGW3JsW2ldXSArIGhibCwgc2xbaV0pICsgZWwgfCAwOwogICAgICAgICAgYWwgPSBlbCwgZWwgPSBkbCwgZGwgPSByb3RsKGNsLCAxMCkgfCAwLCBjbCA9IGJsLCBibCA9IHRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHsKICAgICAgICAgIGNvbnN0IHRyID0gcm90bChhciArIGYockdyb3VwLCBiciwgY3IsIGRyKSArIFJfQlVGW3JyW2ldXSArIGhiciwgc3JbaV0pICsgZXIgfCAwOwogICAgICAgICAgYXIgPSBlciwgZXIgPSBkciwgZHIgPSByb3RsKGNyLCAxMCkgfCAwLCBjciA9IGJyLCBiciA9IHRyOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNldCh0aGlzLmgxICsgY2wgKyBkciB8IDAsIHRoaXMuaDIgKyBkbCArIGVyIHwgMCwgdGhpcy5oMyArIGVsICsgYXIgfCAwLCB0aGlzLmg0ICsgYWwgKyBiciB8IDAsIHRoaXMuaDAgKyBibCArIGNyIHwgMCk7CiAgICB9CiAgICByb3VuZENsZWFuKCkgewogICAgICBSX0JVRi5maWxsKDApOwogICAgfQogICAgZGVzdHJveSgpIHsKICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlOwogICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICB0aGlzLnNldCgwLCAwLCAwLCAwLCAwKTsKICAgIH0KICB9OwogIHZhciByaXBlbWQxNjAgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBSSVBFTUQxNjAoKSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3JpcGVtZDE2MC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcmlwZW1kMTYwMih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IHJpcGVtZDE2MChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pID8gdG9CeXRlcyh2YWx1ZSkgOiB2YWx1ZSk7CiAgICBpZiAodG8gPT09ICJieXRlcyIpCiAgICAgIHJldHVybiBieXRlczI7CiAgICByZXR1cm4gdG9IZXgoYnl0ZXMyKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvaGFzaE1lc3NhZ2UuanMKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3N0cmluZ3MuanMKICB2YXIgcHJlc2lnbk1lc3NhZ2VQcmVmaXggPSAiGUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS90b1ByZWZpeGVkTWVzc2FnZS5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2VfKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXyA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHN0cmluZ1RvSGV4KG1lc3NhZ2VfKTsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXy5yYXcgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBtZXNzYWdlXy5yYXc7CiAgICAgIHJldHVybiBieXRlc1RvSGV4KG1lc3NhZ2VfLnJhdyk7CiAgICB9KSgpOwogICAgY29uc3QgcHJlZml4ID0gc3RyaW5nVG9IZXgoYCR7cHJlc2lnbk1lc3NhZ2VQcmVmaXh9JHtzaXplKG1lc3NhZ2UpfWApOwogICAgcmV0dXJuIGNvbmNhdChbcHJlZml4LCBtZXNzYWdlXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hNZXNzYWdlLmpzCiAgZnVuY3Rpb24gaGFzaE1lc3NhZ2UobWVzc2FnZSwgdG9fKSB7CiAgICByZXR1cm4ga2VjY2FrMjU2KHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2UpLCB0b18pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9yZWNvdmVyTWVzc2FnZUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaE1lc3NhZ2UobWVzc2FnZSksIHNpZ25hdHVyZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclR5cGVkRGF0YUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHNpZ25hdHVyZSwgdHlwZXMgfSA9IHBhcmFtZXRlcnM7CiAgICByZXR1cm4gcmVjb3ZlckFkZHJlc3MoewogICAgICBoYXNoOiBoYXNoVHlwZWREYXRhKHsKICAgICAgICBkb21haW4sCiAgICAgICAgbWVzc2FnZSwKICAgICAgICBwcmltYXJ5VHlwZSwKICAgICAgICB0eXBlcwogICAgICB9KSwKICAgICAgc2lnbmF0dXJlCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5SGFzaC5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlIYXNoKHsgYWRkcmVzcywgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSB7CiAgICByZXR1cm4gaXNBZGRyZXNzRXF1YWwoZ2V0QWRkcmVzcyhhZGRyZXNzKSwgYXdhaXQgcmVjb3ZlckFkZHJlc3MoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5TWVzc2FnZS5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlNZXNzYWdlKHsgYWRkcmVzcywgbWVzc2FnZSwgc2lnbmF0dXJlIH0pIHsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS92ZXJpZnlUeXBlZERhdGEuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZG9tYWluLCBtZXNzYWdlLCBwcmltYXJ5VHlwZSwgc2lnbmF0dXJlLCB0eXBlcyB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyh7CiAgICAgIGRvbWFpbiwKICAgICAgbWVzc2FnZSwKICAgICAgcHJpbWFyeVR5cGUsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgdHlwZXMKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcGFyc2VFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYnl0ZXMuanMKICB2YXIgZXJjNjQ5Mk1hZ2ljQnl0ZXMgPSAiMHg2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyIjsKICB2YXIgemVyb0hhc2ggPSAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9pc0VyYzY0OTJTaWduYXR1cmUuanMKICBpbml0X3NsaWNlKCk7CiAgZnVuY3Rpb24gaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIHNsaWNlSGV4KHNpZ25hdHVyZSwgLTMyKSA9PT0gZXJjNjQ5Mk1hZ2ljQnl0ZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlRXJjNjQ5MlNpZ25hdHVyZS5qcwogIGZ1bmN0aW9uIHBhcnNlRXJjNjQ5MlNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIGlmICghaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHNpZ25hdHVyZSB9OwogICAgY29uc3QgW2FkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZV9dID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbeyB0eXBlOiAiYWRkcmVzcyIgfSwgeyB0eXBlOiAiYnl0ZXMiIH0sIHsgdHlwZTogImJ5dGVzIiB9XSwgc2lnbmF0dXJlKTsKICAgIHJldHVybiB7IGFkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZTogc2lnbmF0dXJlXyB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBmdW5jdGlvbiBzZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZGF0YSwgc2lnbmF0dXJlLCB0byA9ICJoZXgiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9IGNvbmNhdEhleChbCiAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImFkZHJlc3MiIH0sIHsgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFthZGRyZXNzLCBkYXRhLCBzaWduYXR1cmVdKSwKICAgICAgZXJjNjQ5Mk1hZ2ljQnl0ZXMKICAgIF0pOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIHNpZ25hdHVyZV87CiAgICByZXR1cm4gaGV4VG9CeXRlcyhzaWduYXR1cmVfKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9nZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X2Zyb21IZXgoKTsKICBmdW5jdGlvbiBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3Qgc2VyaWFsaXplZFR5cGUgPSBzbGljZUhleChzZXJpYWxpemVkVHJhbnNhY3Rpb24sIDAsIDEpOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwNCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgPT09ICIweDAzIikKICAgICAgcmV0dXJuICJlaXA0ODQ0IjsKICAgIGlmIChzZXJpYWxpemVkVHlwZSA9PT0gIjB4MDIiKQogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwMSIpCiAgICAgIHJldHVybiAiZWlwMjkzMCI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgIT09ICIweCIgJiYgaGV4VG9OdW1iZXIoc2VyaWFsaXplZFR5cGUpID49IDE5MikKICAgICAgcmV0dXJuICJsZWdhY3kiOwogICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlRXJyb3IoeyBzZXJpYWxpemVkVHlwZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRUcmFuc2FjdGlvbi5qcwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jaGFpbigpOwogIGluaXRfbm9kZSgpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIGFzc2VydFRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBhdXRob3JpemF0aW9uTGlzdCB9ID0gdHJhbnNhY3Rpb247CiAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgZm9yIChjb25zdCBhdXRob3JpemF0aW9uIG9mIGF1dGhvcml6YXRpb25MaXN0KSB7CiAgICAgICAgY29uc3QgeyBjb250cmFjdEFkZHJlc3MsIGNoYWluSWQgfSA9IGF1dGhvcml6YXRpb247CiAgICAgICAgaWYgKCFpc0FkZHJlc3MoY29udHJhY3RBZGRyZXNzKSkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogY29udHJhY3RBZGRyZXNzIH0pOwogICAgICAgIGlmIChjaGFpbklkIDwgMCkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgICAgfQogICAgfQogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGJsb2JWZXJzaW9uZWRIYXNoZXMgfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMubGVuZ3RoID09PSAwKQogICAgICAgIHRocm93IG5ldyBFbXB0eUJsb2JFcnJvcigpOwogICAgICBmb3IgKGNvbnN0IGhhc2gzIG9mIGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgICBjb25zdCBzaXplXyA9IHNpemUoaGFzaDMpOwogICAgICAgIGNvbnN0IHZlcnNpb24zID0gaGV4VG9OdW1iZXIoc2xpY2UoaGFzaDMsIDAsIDEpKTsKICAgICAgICBpZiAoc2l6ZV8gIT09IDMyKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRWZXJzaW9uZWRIYXNoU2l6ZUVycm9yKHsgaGFzaDogaGFzaDMsIHNpemU6IHNpemVfIH0pOwogICAgICAgIGlmICh2ZXJzaW9uMyAhPT0gdmVyc2lvbmVkSGFzaFZlcnNpb25LemcpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFZlcnNpb25lZEhhc2hWZXJzaW9uRXJyb3IoewogICAgICAgICAgICBoYXNoOiBoYXNoMywKICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbjMKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGNoYWluSWQgPD0gMCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRDaGFpbklkRXJyb3IoeyBjaGFpbklkIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKG1heEZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzIH0pOwogICAgaWYgKG1heFByaW9yaXR5RmVlUGVyR2FzICYmIG1heEZlZVBlckdhcyAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyA+IG1heEZlZVBlckdhcykKICAgICAgdGhyb3cgbmV3IFRpcEFib3ZlRmVlQ2FwRXJyb3IoeyBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIHRvIH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIEVJUC0yOTMwIFRyYW5zYWN0aW9uIGF0dHJpYnV0ZS4iKTsKICAgIGlmIChnYXNQcmljZSAmJiBnYXNQcmljZSA+IG1heFVpbnQyNTYpCiAgICAgIHRocm93IG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoeyBtYXhGZWVQZXJHYXM6IGdhc1ByaWNlIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBjaGFpbklkLCBtYXhQcmlvcml0eUZlZVBlckdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKHR5cGVvZiBjaGFpbklkICE9PSAidW5kZWZpbmVkIiAmJiBjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIExlZ2FjeSBUcmFuc2FjdGlvbiBhdHRyaWJ1dGUuIik7CiAgICBpZiAoZ2FzUHJpY2UgJiYgZ2FzUHJpY2UgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzOiBnYXNQcmljZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9wYXJzZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfcGFkKCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VUcmFuc2FjdGlvbihzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDE1NTkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXA0ODQ0IikKICAgICAgcmV0dXJuIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDc3MDIiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDc3MDIoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uTGVnYWN5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA3NzAyKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIHYsIHIsIHNdID0gdHJhbnNhY3Rpb25BcnJheTsKICAgIGlmICh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCAhPT0gMTAgJiYgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggIT09IDEzKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIGF1dGhvcml6YXRpb25MaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNzcwMiIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA3NzAyIgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckdhcykgJiYgbWF4RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJHYXMpOwogICAgaWYgKGlzSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAoYWNjZXNzTGlzdC5sZW5ndGggIT09IDAgJiYgYWNjZXNzTGlzdCAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uYWNjZXNzTGlzdCA9IHBhcnNlQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGlmIChhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggIT09IDAgJiYgYXV0aG9yaXphdGlvbkxpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmF1dGhvcml6YXRpb25MaXN0ID0gcGFyc2VBdXRob3JpemF0aW9uTGlzdChhdXRob3JpemF0aW9uTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEzID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25PcldyYXBwZXJBcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgaGFzTmV0d29ya1dyYXBwZXIgPSB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5Lmxlbmd0aCA9PT0gNDsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSBoYXNOZXR3b3JrV3JhcHBlciA/IHRyYW5zYWN0aW9uT3JXcmFwcGVyQXJyYXlbMF0gOiB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5OwogICAgY29uc3Qgd3JhcHBlckFycmF5ID0gaGFzTmV0d29ya1dyYXBwZXIgPyB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5LnNsaWNlKDEpIDogW107CiAgICBjb25zdCBbY2hhaW5JZCwgbm9uY2UsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBtYXhGZWVQZXJHYXMsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCBtYXhGZWVQZXJCbG9iR2FzLCBibG9iVmVyc2lvbmVkSGFzaGVzLCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBjb25zdCBbYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdID0gd3JhcHBlckFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExIHx8IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxNCkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IoewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGNoYWluSWQsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNDg0NCIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcywKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA0ODQ0IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckJsb2JHYXMpICYmIG1heEZlZVBlckJsb2JHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJCbG9iR2FzKTsKICAgIGlmIChpc0hleChtYXhGZWVQZXJHYXMpICYmIG1heEZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4RmVlUGVyR2FzKTsKICAgIGlmIChpc0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4UHJpb3JpdHlGZWVQZXJHYXMpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBpZiAoYmxvYnMgJiYgY29tbWl0bWVudHMgJiYgcHJvb2ZzKQogICAgICB0cmFuc2FjdGlvbi5zaWRlY2FycyA9IHRvQmxvYlNpZGVjYXJzKHsKICAgICAgICBibG9icywKICAgICAgICBjb21taXRtZW50cywKICAgICAgICBwcm9vZnMKICAgICAgfSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDE0ID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVAxNTU5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgdiwgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEyKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvcih7CiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIG5vbmNlLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgICBnYXMsCiAgICAgICAgICB0bywKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDkgPyB7CiAgICAgICAgICAgIHYsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIHMKICAgICAgICAgIH0gOiB7fQogICAgICAgIH0sCiAgICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uLAogICAgICAgIHR5cGU6ICJlaXAxNTU5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICBjaGFpbklkOiBoZXhUb051bWJlcihjaGFpbklkKSwKICAgICAgdHlwZTogImVpcDE1NTkiCiAgICB9OwogICAgaWYgKGlzSGV4KHRvKSAmJiB0byAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udG8gPSB0bzsKICAgIGlmIChpc0hleChnYXMpICYmIGdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzID0gaGV4VG9CaWdJbnQoZ2FzKTsKICAgIGlmIChpc0hleChkYXRhKSAmJiBkYXRhICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5kYXRhID0gZGF0YTsKICAgIGlmIChpc0hleChub25jZSkgJiYgbm9uY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm5vbmNlID0gaGV4VG9OdW1iZXIobm9uY2UpOwogICAgaWYgKGlzSGV4KHZhbHVlKSAmJiB2YWx1ZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udmFsdWUgPSBoZXhUb0JpZ0ludCh2YWx1ZSk7CiAgICBpZiAoaXNIZXgobWF4RmVlUGVyR2FzKSAmJiBtYXhGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heEZlZVBlckdhcyk7CiAgICBpZiAoaXNIZXgobWF4UHJpb3JpdHlGZWVQZXJHYXMpICYmIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heFByaW9yaXR5RmVlUGVyR2FzKTsKICAgIGlmIChhY2Nlc3NMaXN0Lmxlbmd0aCAhPT0gMCAmJiBhY2Nlc3NMaXN0ICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ID0gcGFyc2VBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxMiA/IHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIDogdm9pZCAwOwogICAgcmV0dXJuIHsgLi4uc2lnbmF0dXJlLCAuLi50cmFuc2FjdGlvbiB9OwogIH0KICBmdW5jdGlvbiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSB0b1RyYW5zYWN0aW9uQXJyYXkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IFtjaGFpbklkLCBub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBpZiAoISh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gOCB8fCB0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gMTEpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBnYXNQcmljZSwKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIC4uLnRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID4gOCA/IHsKICAgICAgICAgICAgdiwKICAgICAgICAgICAgciwKICAgICAgICAgICAgcwogICAgICAgICAgfSA6IHt9CiAgICAgICAgfSwKICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdHlwZTogImVpcDI5MzAiCiAgICAgIH0pOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7CiAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICB0eXBlOiAiZWlwMjkzMCIKICAgIH07CiAgICBpZiAoaXNIZXgodG8pICYmIHRvICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi50byA9IHRvOwogICAgaWYgKGlzSGV4KGdhcykgJiYgZ2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5nYXMgPSBoZXhUb0JpZ0ludChnYXMpOwogICAgaWYgKGlzSGV4KGRhdGEpICYmIGRhdGEgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmRhdGEgPSBkYXRhOwogICAgaWYgKGlzSGV4KG5vbmNlKSAmJiBub25jZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubm9uY2UgPSBoZXhUb051bWJlcihub25jZSk7CiAgICBpZiAoaXNIZXgodmFsdWUpICYmIHZhbHVlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi52YWx1ZSA9IGhleFRvQmlnSW50KHZhbHVlKTsKICAgIGlmIChpc0hleChnYXNQcmljZSkgJiYgZ2FzUHJpY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhc1ByaWNlID0gaGV4VG9CaWdJbnQoZ2FzUHJpY2UpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25MZWdhY3koc2VyaWFsaXplZFRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbkFycmF5ID0gZnJvbVJscChzZXJpYWxpemVkVHJhbnNhY3Rpb24sICJoZXgiKTsKICAgIGNvbnN0IFtub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBjaGFpbklkT3JWXywgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBub25jZSwKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDYgPyB7CiAgICAgICAgICAgIHY6IGNoYWluSWRPclZfLAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAibGVnYWN5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICB0eXBlOiAibGVnYWN5IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KGdhc1ByaWNlKSAmJiBnYXNQcmljZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzUHJpY2UgPSBoZXhUb0JpZ0ludChnYXNQcmljZSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbik7CiAgICBpZiAodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IGNoYWluSWRPclYgPSBpc0hleChjaGFpbklkT3JWXykgJiYgY2hhaW5JZE9yVl8gIT09ICIweCIgPyBoZXhUb0JpZ0ludChjaGFpbklkT3JWXykgOiAwbjsKICAgIGlmIChzID09PSAiMHgiICYmIHIgPT09ICIweCIpIHsKICAgICAgaWYgKGNoYWluSWRPclYgPiAwKQogICAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBOdW1iZXIoY2hhaW5JZE9yVik7CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0KICAgIGNvbnN0IHYgPSBjaGFpbklkT3JWOwogICAgY29uc3QgY2hhaW5JZCA9IE51bWJlcigodiAtIDM1bikgLyAybik7CiAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBjaGFpbklkOwogICAgZWxzZSBpZiAodiAhPT0gMjduICYmIHYgIT09IDI4bikKICAgICAgdGhyb3cgbmV3IEludmFsaWRMZWdhY3lWRXJyb3IoeyB2IH0pOwogICAgdHJhbnNhY3Rpb24udiA9IHY7CiAgICB0cmFuc2FjdGlvbi5zID0gczsKICAgIHRyYW5zYWN0aW9uLnIgPSByOwogICAgdHJhbnNhY3Rpb24ueVBhcml0eSA9IHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICB9CiAgZnVuY3Rpb24gdG9UcmFuc2FjdGlvbkFycmF5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgcmV0dXJuIGZyb21SbHAoYDB4JHtzZXJpYWxpemVkVHJhbnNhY3Rpb24uc2xpY2UoNCl9YCwgImhleCIpOwogIH0KICBmdW5jdGlvbiBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdF8pIHsKICAgIGNvbnN0IGFjY2Vzc0xpc3QgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWNjZXNzTGlzdF8ubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW2FkZHJlc3MsIHN0b3JhZ2VLZXlzXSA9IGFjY2Vzc0xpc3RfW2ldOwogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICBhY2Nlc3NMaXN0LnB1c2goewogICAgICAgIGFkZHJlc3MsCiAgICAgICAgc3RvcmFnZUtleXM6IHN0b3JhZ2VLZXlzLm1hcCgoa2V5KSA9PiBpc0hhc2goa2V5KSA/IGtleSA6IHRyaW0oa2V5KSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYWNjZXNzTGlzdDsKICB9CiAgZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uTGlzdChzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGNvbnN0IGF1dGhvcml6YXRpb25MaXN0ID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdC5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBbY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgeVBhcml0eSwgciwgc10gPSBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3RbaV07CiAgICAgIGF1dGhvcml6YXRpb25MaXN0LnB1c2goewogICAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZTogaGV4VG9OdW1iZXIobm9uY2UpLAogICAgICAgIC4uLnBhcnNlRUlQMTU1U2lnbmF0dXJlKFt5UGFyaXR5LCByLCBzXSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYXV0aG9yaXphdGlvbkxpc3Q7CiAgfQogIGZ1bmN0aW9uIHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIHsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkuc2xpY2UoLTMpOwogICAgY29uc3QgdiA9IHNpZ25hdHVyZVswXSA9PT0gIjB4IiB8fCBoZXhUb0JpZ0ludChzaWduYXR1cmVbMF0pID09PSAwbiA/IDI3biA6IDI4bjsKICAgIHJldHVybiB7CiAgICAgIHI6IHBhZEhleChzaWduYXR1cmVbMV0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHM6IHBhZEhleChzaWduYXR1cmVbMl0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHYsCiAgICAgIHlQYXJpdHk6IHYgPT09IDI3biA/IDAgOiAxCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3RyYW5zYWN0aW9uL3NlcmlhbGl6ZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QuanMKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGlmICghYXV0aG9yaXphdGlvbkxpc3QgfHwgYXV0aG9yaXphdGlvbkxpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QgPSBbXTsKICAgIGZvciAoY29uc3QgYXV0aG9yaXphdGlvbiBvZiBhdXRob3JpemF0aW9uTGlzdCkgewogICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UsIC4uLnNpZ25hdHVyZSB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0LnB1c2goWwogICAgICAgIGNoYWluSWQgPyB0b0hleChjaGFpbklkKSA6ICIweCIsCiAgICAgICAgY29udHJhY3RBZGRyZXNzLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh7fSwgc2lnbmF0dXJlKQogICAgICBdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vc2VyaWFsaXplQWNjZXNzTGlzdC5qcwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCkgewogICAgaWYgKCFhY2Nlc3NMaXN0IHx8IGFjY2Vzc0xpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQWNjZXNzTGlzdCA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2Nlc3NMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWRkcmVzcywgc3RvcmFnZUtleXMgfSA9IGFjY2Vzc0xpc3RbaV07CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3RvcmFnZUtleXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBpZiAoc3RvcmFnZUtleXNbal0ubGVuZ3RoIC0gMiAhPT0gNjQpIHsKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcih7IHN0b3JhZ2VLZXk6IHN0b3JhZ2VLZXlzW2pdIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpIHsKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIH0KICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QucHVzaChbYWRkcmVzcywgc3RvcmFnZUtleXNdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQWNjZXNzTGlzdDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9zZXJpYWxpemVUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRUcmFuc2FjdGlvblR5cGUodHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXAxNTU5IikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQMTU1OSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgICBpZiAodHlwZSA9PT0gImVpcDQ4NDQiKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogICAgaWYgKHR5cGUgPT09ICJlaXA3NzAyIikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3NzAyKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgYXV0aG9yaXphdGlvbkxpc3QsIGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0ID0gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDA0IiwKICAgICAgdG9SbHAoWwogICAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgbWF4RmVlUGVyR2FzID8gdG9IZXgobWF4RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgICAgdG8gPz8gIjB4IiwKICAgICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgICAgZGF0YSA/PyAiMHgiLAogICAgICAgIHNlcmlhbGl6ZWRBY2Nlc3NMaXN0LAogICAgICAgIHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKQogICAgICBdKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNDg0NCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBjb25zdCB7IGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgbGV0IGJsb2JWZXJzaW9uZWRIYXNoZXMgPSB0cmFuc2FjdGlvbi5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgbGV0IHNpZGVjYXJzID0gdHJhbnNhY3Rpb24uc2lkZWNhcnM7CiAgICBpZiAodHJhbnNhY3Rpb24uYmxvYnMgJiYgKHR5cGVvZiBibG9iVmVyc2lvbmVkSGFzaGVzID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2Ygc2lkZWNhcnMgPT09ICJ1bmRlZmluZWQiKSkgewogICAgICBjb25zdCBibG9iczIgPSB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYnNbMF0gPT09ICJzdHJpbmciID8gdHJhbnNhY3Rpb24uYmxvYnMgOiB0cmFuc2FjdGlvbi5ibG9icy5tYXAoKHgpID0+IGJ5dGVzVG9IZXgoeCkpOwogICAgICBjb25zdCBremcgPSB0cmFuc2FjdGlvbi5remc7CiAgICAgIGNvbnN0IGNvbW1pdG1lbnRzMiA9IGJsb2JzVG9Db21taXRtZW50cyh7CiAgICAgICAgYmxvYnM6IGJsb2JzMiwKICAgICAgICBremcKICAgICAgfSk7CiAgICAgIGlmICh0eXBlb2YgYmxvYlZlcnNpb25lZEhhc2hlcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA9IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMoewogICAgICAgICAgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMgogICAgICAgIH0pOwogICAgICBpZiAodHlwZW9mIHNpZGVjYXJzID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNvbnN0IHByb29mczIgPSBibG9ic1RvUHJvb2ZzKHsgYmxvYnM6IGJsb2JzMiwgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMiwga3pnIH0pOwogICAgICAgIHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoeyBibG9iczogYmxvYnMyLCBjb21taXRtZW50czogY29tbWl0bWVudHMyLCBwcm9vZnM6IHByb29mczIgfSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgbWF4RmVlUGVyQmxvYkdhcyA/IHRvSGV4KG1heEZlZVBlckJsb2JHYXMpIDogIjB4IiwKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA/PyBbXSwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICBjb25zdCBibG9icyA9IFtdOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgaWYgKHNpZGVjYXJzKQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZGVjYXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgeyBibG9iLCBjb21taXRtZW50LCBwcm9vZiB9ID0gc2lkZWNhcnNbaV07CiAgICAgICAgYmxvYnMucHVzaChibG9iKTsKICAgICAgICBjb21taXRtZW50cy5wdXNoKGNvbW1pdG1lbnQpOwogICAgICAgIHByb29mcy5wdXNoKHByb29mKTsKICAgICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAzIiwKICAgICAgc2lkZWNhcnMgPyAoCiAgICAgICAgLy8gSWYgc2lkZWNhcnMgYXJlIGVuYWJsZWQsIGVudmVsb3BlIHR1cm5zIGludG8gYSAid3JhcHBlciI6CiAgICAgICAgdG9SbHAoW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdKQogICAgICApIDogKAogICAgICAgIC8vIElmIHNpZGVjYXJzIGFyZSBkaXNhYmxlZCwgc3RhbmRhcmQgZW52ZWxvcGUgaXMgdXNlZDoKICAgICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICAgICkKICAgIF0pOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGFjY2Vzc0xpc3QsIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4MDIiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVAyOTMwKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgZ2FzLCBkYXRhLCBub25jZSwgdG8sIHZhbHVlLCBhY2Nlc3NMaXN0LCBnYXNQcmljZSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IiwKICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QsCiAgICAgIC4uLnRvWVBhcml0eVNpZ25hdHVyZUFycmF5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAxIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uTGVnYWN5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCA9IDAsIGdhcywgZGF0YSwgbm9uY2UsIHRvLCB2YWx1ZSwgZ2FzUHJpY2UgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3kodHJhbnNhY3Rpb24pOwogICAgbGV0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IgogICAgXTsKICAgIGlmIChzaWduYXR1cmUpIHsKICAgICAgY29uc3QgdiA9ICgoKSA9PiB7CiAgICAgICAgaWYgKHNpZ25hdHVyZS52ID49IDM1bikgewogICAgICAgICAgY29uc3QgaW5mZXJyZWRDaGFpbklkID0gKHNpZ25hdHVyZS52IC0gMzVuKSAvIDJuOwogICAgICAgICAgaWYgKGluZmVycmVkQ2hhaW5JZCA+IDApCiAgICAgICAgICAgIHJldHVybiBzaWduYXR1cmUudjsKICAgICAgICAgIHJldHVybiAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDM1biA/IDBuIDogMW4pOwogICAgICAgIH0KICAgICAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgICAgICByZXR1cm4gQmlnSW50KGNoYWluSWQgKiAyKSArIEJpZ0ludCgzNW4gKyBzaWduYXR1cmUudiAtIDI3bik7CiAgICAgICAgY29uc3QgdjIgPSAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDI3biA/IDBuIDogMW4pOwogICAgICAgIGlmIChzaWduYXR1cmUudiAhPT0gdjIpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZExlZ2FjeVZFcnJvcih7IHY6IHNpZ25hdHVyZS52IH0pOwogICAgICAgIHJldHVybiB2MjsKICAgICAgfSkoKTsKICAgICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgICBjb25zdCBzID0gdHJpbShzaWduYXR1cmUucyk7CiAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgICAuLi5zZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdG9IZXgodiksCiAgICAgICAgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsCiAgICAgICAgcyA9PT0gIjB4MDAiID8gIjB4IiA6IHMKICAgICAgXTsKICAgIH0gZWxzZSBpZiAoY2hhaW5JZCA+IDApIHsKICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICAgIC4uLnNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0b0hleChjaGFpbklkKSwKICAgICAgICAiMHgiLAogICAgICAgICIweCIKICAgICAgXTsKICAgIH0KICAgIHJldHVybiB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiB0b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlXykgewogICAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbmF0dXJlXyA/PyB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHsgdiwgeVBhcml0eSB9ID0gc2lnbmF0dXJlOwogICAgaWYgKHR5cGVvZiBzaWduYXR1cmUuciA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlLnMgPT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gW107CiAgICBpZiAodHlwZW9mIHYgPT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiB5UGFyaXR5ID09PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIFtdOwogICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgY29uc3QgcyA9IHRyaW0oc2lnbmF0dXJlLnMpOwogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHlQYXJpdHkgPT09ICJudW1iZXIiKQogICAgICAgIHJldHVybiB5UGFyaXR5ID8gdG9IZXgoMSkgOiAiMHgiOwogICAgICBpZiAodiA9PT0gMG4pCiAgICAgICAgcmV0dXJuICIweCI7CiAgICAgIGlmICh2ID09PSAxbikKICAgICAgICByZXR1cm4gdG9IZXgoMSk7CiAgICAgIHJldHVybiB2ID09PSAyN24gPyAiMHgiIDogdG9IZXgoMSk7CiAgICB9KSgpOwogICAgcmV0dXJuIFt5UGFyaXR5XywgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsIHMgPT09ICIweDAwIiA/ICIweCIgOiBzXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdW5pdC5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdmFsdWUgfSkgewogICAgICBzdXBlcihgTnVtYmVyIFxgJHt2YWx1ZX1cYCBpcyBub3QgYSB2YWxpZCBkZWNpbWFsIG51bWJlci5gLCB7CiAgICAgICAgbmFtZTogIkludmFsaWREZWNpbWFsTnVtYmVyRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L3BhcnNlVW5pdHMuanMKICBmdW5jdGlvbiBwYXJzZVVuaXRzKHZhbHVlLCBkZWNpbWFscykgewogICAgaWYgKCEvXigtPykoWzAtOV0qKVwuPyhbMC05XSopJC8udGVzdCh2YWx1ZSkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yKHsgdmFsdWUgfSk7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uID0gIjAiXSA9IHZhbHVlLnNwbGl0KCIuIik7CiAgICBjb25zdCBuZWdhdGl2ZSA9IGludGVnZXIuc3RhcnRzV2l0aCgiLSIpOwogICAgaWYgKG5lZ2F0aXZlKQogICAgICBpbnRlZ2VyID0gaW50ZWdlci5zbGljZSgxKTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICBpZiAoZGVjaW1hbHMgPT09IDApIHsKICAgICAgaWYgKE1hdGgucm91bmQoTnVtYmVyKGAuJHtmcmFjdGlvbn1gKSkgPT09IDEpCiAgICAgICAgaW50ZWdlciA9IGAke0JpZ0ludChpbnRlZ2VyKSArIDFufWA7CiAgICAgIGZyYWN0aW9uID0gIiI7CiAgICB9IGVsc2UgaWYgKGZyYWN0aW9uLmxlbmd0aCA+IGRlY2ltYWxzKSB7CiAgICAgIGNvbnN0IFtsZWZ0LCB1bml0LCByaWdodF0gPSBbCiAgICAgICAgZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMgLSAxKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscyAtIDEsIGRlY2ltYWxzKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscykKICAgICAgXTsKICAgICAgY29uc3Qgcm91bmRlZCA9IE1hdGgucm91bmQoTnVtYmVyKGAke3VuaXR9LiR7cmlnaHR9YCkpOwogICAgICBpZiAocm91bmRlZCA+IDkpCiAgICAgICAgZnJhY3Rpb24gPSBgJHtCaWdJbnQobGVmdCkgKyBCaWdJbnQoMSl9MGAucGFkU3RhcnQobGVmdC5sZW5ndGggKyAxLCAiMCIpOwogICAgICBlbHNlCiAgICAgICAgZnJhY3Rpb24gPSBgJHtsZWZ0fSR7cm91bmRlZH1gOwogICAgICBpZiAoZnJhY3Rpb24ubGVuZ3RoID4gZGVjaW1hbHMpIHsKICAgICAgICBmcmFjdGlvbiA9IGZyYWN0aW9uLnNsaWNlKDEpOwogICAgICAgIGludGVnZXIgPSBgJHtCaWdJbnQoaW50ZWdlcikgKyAxbn1gOwogICAgICB9CiAgICAgIGZyYWN0aW9uID0gZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMpOwogICAgfSBlbHNlIHsKICAgICAgZnJhY3Rpb24gPSBmcmFjdGlvbi5wYWRFbmQoZGVjaW1hbHMsICIwIik7CiAgICB9CiAgICByZXR1cm4gQmlnSW50KGAke25lZ2F0aXZlID8gIi0iIDogIiJ9JHtpbnRlZ2VyfSR7ZnJhY3Rpb259YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUV0aGVyLmpzCiAgaW5pdF91bml0KCk7CiAgZnVuY3Rpb24gcGFyc2VFdGhlcihldGhlciwgdW5pdCA9ICJ3ZWkiKSB7CiAgICByZXR1cm4gcGFyc2VVbml0cyhldGhlciwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUd3ZWkuanMKICBpbml0X3VuaXQoKTsKICBmdW5jdGlvbiBwYXJzZUd3ZWkoZXRoZXIsIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIHBhcnNlVW5pdHMoZXRoZXIsIGd3ZWlVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbm9uY2VNYW5hZ2VyLmpzCiAgaW5pdF9scnUoKTsKICBmdW5jdGlvbiBjcmVhdGVOb25jZU1hbmFnZXIocGFyYW1ldGVycykgewogICAgY29uc3QgeyBzb3VyY2UgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkZWx0YU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgICBjb25zdCBub25jZU1hcCA9IG5ldyBMcnVNYXAoODE5Mik7CiAgICBjb25zdCBwcm9taXNlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGNvbnN0IGdldEtleSA9ICh7IGFkZHJlc3MsIGNoYWluSWQgfSkgPT4gYCR7YWRkcmVzc30uJHtjaGFpbklkfWA7CiAgICByZXR1cm4gewogICAgICBhc3luYyBjb25zdW1lKHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLmdldCh7IGFkZHJlc3MsIGNoYWluSWQsIGNsaWVudCB9KTsKICAgICAgICB0aGlzLmluY3JlbWVudCh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBwcm9taXNlOwogICAgICAgIGF3YWl0IHNvdXJjZS5zZXQoeyBhZGRyZXNzLCBjaGFpbklkIH0sIG5vbmNlKTsKICAgICAgICBub25jZU1hcC5zZXQoa2V5LCBub25jZSk7CiAgICAgICAgcmV0dXJuIG5vbmNlOwogICAgICB9LAogICAgICBhc3luYyBpbmNyZW1lbnQoeyBhZGRyZXNzLCBjaGFpbklkIH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICBkZWx0YU1hcC5zZXQoa2V5LCBkZWx0YSArIDEpOwogICAgICB9LAogICAgICBhc3luYyBnZXQoeyBhZGRyZXNzLCBjaGFpbklkLCBjbGllbnQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgbGV0IHByb21pc2UgPSBwcm9taXNlTWFwLmdldChrZXkpOwogICAgICAgIGlmICghcHJvbWlzZSkgewogICAgICAgICAgcHJvbWlzZSA9IChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBzb3VyY2UuZ2V0KHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pOwogICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzTm9uY2UgPSBub25jZU1hcC5nZXQoa2V5KSA/PyAwOwogICAgICAgICAgICAgIGlmIChwcmV2aW91c05vbmNlID4gMCAmJiBub25jZSA8PSBwcmV2aW91c05vbmNlKQogICAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzTm9uY2UgKyAxOwogICAgICAgICAgICAgIG5vbmNlTWFwLmRlbGV0ZShrZXkpOwogICAgICAgICAgICAgIHJldHVybiBub25jZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICB0aGlzLnJlc2V0KHsgYWRkcmVzcywgY2hhaW5JZCB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkoKTsKICAgICAgICAgIHByb21pc2VNYXAuc2V0KGtleSwgcHJvbWlzZSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICByZXR1cm4gZGVsdGEgKyBhd2FpdCBwcm9taXNlOwogICAgICB9LAogICAgICByZXNldCh7IGFkZHJlc3MsIGNoYWluSWQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgZGVsdGFNYXAuZGVsZXRlKGtleSk7CiAgICAgICAgcHJvbWlzZU1hcC5kZWxldGUoa2V5KTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24ganNvblJwYygpIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIGdldChwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBhZGRyZXNzLCBjbGllbnQgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGdldFRyYW5zYWN0aW9uQ291bnQoY2xpZW50LCB7CiAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9LAogICAgICBzZXQoKSB7CiAgICAgIH0KICAgIH07CiAgfQogIHZhciBub25jZU1hbmFnZXIgPSAvKiBAX19QVVJFX18gKi8gY3JlYXRlTm9uY2VNYW5hZ2VyKHsKICAgIHNvdXJjZToganNvblJwYygpCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3Byb29mLmpzCiAgZnVuY3Rpb24gZm9ybWF0U3RvcmFnZVByb29mKHN0b3JhZ2VQcm9vZikgewogICAgcmV0dXJuIHN0b3JhZ2VQcm9vZi5tYXAoKHByb29mKSA9PiAoewogICAgICAuLi5wcm9vZiwKICAgICAgdmFsdWU6IEJpZ0ludChwcm9vZi52YWx1ZSkKICAgIH0pKTsKICB9CiAgZnVuY3Rpb24gZm9ybWF0UHJvb2YocHJvb2YpIHsKICAgIHJldHVybiB7CiAgICAgIC4uLnByb29mLAogICAgICBiYWxhbmNlOiBwcm9vZi5iYWxhbmNlID8gQmlnSW50KHByb29mLmJhbGFuY2UpIDogdm9pZCAwLAogICAgICBub25jZTogcHJvb2Yubm9uY2UgPyBoZXhUb051bWJlcihwcm9vZi5ub25jZSkgOiB2b2lkIDAsCiAgICAgIHN0b3JhZ2VQcm9vZjogcHJvb2Yuc3RvcmFnZVByb29mID8gZm9ybWF0U3RvcmFnZVByb29mKHByb29mLnN0b3JhZ2VQcm9vZikgOiB2b2lkIDAKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0UHJvb2YuanMKICBhc3luYyBmdW5jdGlvbiBnZXRQcm9vZihjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIHN0b3JhZ2VLZXlzIH0pIHsKICAgIGNvbnN0IGJsb2NrVGFnID0gYmxvY2tUYWdfID8/ICJsYXRlc3QiOwogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgcHJvb2YgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRQcm9vZiIsCiAgICAgIHBhcmFtczogW2FkZHJlc3MsIHN0b3JhZ2VLZXlzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIGZvcm1hdFByb29mKHByb29mKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0Iiwgc2xvdCB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2V0U3RvcmFnZUF0IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgc2xvdCwgYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWddCiAgICB9KTsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbihjbGllbnQsIHsgYmxvY2tIYXNoLCBibG9ja051bWJlciwgYmxvY2tUYWc6IGJsb2NrVGFnXywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gfHwgImxhdGVzdCI7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgdHJhbnNhY3Rpb24gPSBudWxsOwogICAgaWYgKGhhc2gzKSB7CiAgICAgIHRyYW5zYWN0aW9uID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkJ5SGFzaCIsCiAgICAgICAgcGFyYW1zOiBbaGFzaDNdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIGlmIChibG9ja0hhc2gpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja0hhc2hBbmRJbmRleCIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tIYXNoLCBudW1iZXJUb0hleChpbmRleDIpXQogICAgICB9LCB7IGRlZHVwZTogdHJ1ZSB9KTsKICAgIH0gZWxzZSBpZiAoYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja051bWJlckFuZEluZGV4IiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZywgbnVtYmVyVG9IZXgoaW5kZXgyKV0KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgaWYgKCF0cmFuc2FjdGlvbikKICAgICAgdGhyb3cgbmV3IFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvcih7CiAgICAgICAgYmxvY2tIYXNoLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnLAogICAgICAgIGhhc2g6IGhhc2gzLAogICAgICAgIGluZGV4OiBpbmRleDIKICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uPy5mb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb247CiAgICByZXR1cm4gZm9ybWF0KHRyYW5zYWN0aW9uKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMoY2xpZW50LCB7IGhhc2g6IGhhc2gzLCB0cmFuc2FjdGlvblJlY2VpcHQgfSkgewogICAgY29uc3QgW2Jsb2NrTnVtYmVyLCB0cmFuc2FjdGlvbl0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSksCiAgICAgIGhhc2gzID8gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb24sICJnZXRUcmFuc2FjdGlvbiIpKHsgaGFzaDogaGFzaDMgfSkgOiB2b2lkIDAKICAgIF0pOwogICAgY29uc3QgdHJhbnNhY3Rpb25CbG9ja051bWJlciA9IHRyYW5zYWN0aW9uUmVjZWlwdD8uYmxvY2tOdW1iZXIgfHwgdHJhbnNhY3Rpb24/LmJsb2NrTnVtYmVyOwogICAgaWYgKCF0cmFuc2FjdGlvbkJsb2NrTnVtYmVyKQogICAgICByZXR1cm4gMG47CiAgICByZXR1cm4gYmxvY2tOdW1iZXIgLSB0cmFuc2FjdGlvbkJsb2NrTnVtYmVyICsgMW47CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIHsgaGFzaDogaGFzaDMgfSkgewogICAgY29uc3QgcmVjZWlwdCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCIsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICBpZiAoIXJlY2VpcHQpCiAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yKHsgaGFzaDogaGFzaDMgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVjZWlwdD8uZm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDsKICAgIHJldHVybiBmb3JtYXQocmVjZWlwdCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvbXVsdGljYWxsLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIG11bHRpY2FsbChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWxsb3dGYWlsdXJlID0gdHJ1ZSwgYmF0Y2hTaXplOiBiYXRjaFNpemVfLCBibG9ja051bWJlciwgYmxvY2tUYWcsIG11bHRpY2FsbEFkZHJlc3M6IG11bHRpY2FsbEFkZHJlc3NfLCBzdGF0ZU92ZXJyaWRlIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY29udHJhY3RzMiA9IHBhcmFtZXRlcnMuY29udHJhY3RzOwogICAgY29uc3QgYmF0Y2hTaXplID0gYmF0Y2hTaXplXyA/PyAodHlwZW9mIGNsaWVudC5iYXRjaD8ubXVsdGljYWxsID09PSAib2JqZWN0IiAmJiBjbGllbnQuYmF0Y2gubXVsdGljYWxsLmJhdGNoU2l6ZSB8fCAxMDI0KTsKICAgIGxldCBtdWx0aWNhbGxBZGRyZXNzID0gbXVsdGljYWxsQWRkcmVzc187CiAgICBpZiAoIW11bHRpY2FsbEFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIG11bHRpY2FsbEFkZHJlc3MgaXMgcmVxdWlyZWQuIik7CiAgICAgIG11bHRpY2FsbEFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogIm11bHRpY2FsbDMiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgY2h1bmtlZENhbGxzID0gW1tdXTsKICAgIGxldCBjdXJyZW50Q2h1bmsgPSAwOwogICAgbGV0IGN1cnJlbnRDaHVua1NpemUgPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250cmFjdHMyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUgfSA9IGNvbnRyYWN0czJbaV07CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgY2FsbERhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgICAgICBjdXJyZW50Q2h1bmtTaXplICs9IChjYWxsRGF0YS5sZW5ndGggLSAyKSAvIDI7CiAgICAgICAgaWYgKAogICAgICAgICAgLy8gQ2hlY2sgaWYgYmF0Y2hpbmcgaXMgZW5hYmxlZC4KICAgICAgICAgIGJhdGNoU2l6ZSA+IDAgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgc2l6ZSBvZiB0aGUgYmF0Y2ggZXhjZWVkcyB0aGUgc2l6ZSBsaW1pdC4KICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPiBiYXRjaFNpemUgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY2h1bmsgaXMgbm90IGFscmVhZHkgZW1wdHkuCiAgICAgICAgICBjaHVua2VkQ2FsbHNbY3VycmVudENodW5rXS5sZW5ndGggPiAwCiAgICAgICAgKSB7CiAgICAgICAgICBjdXJyZW50Q2h1bmsrKzsKICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPSAoY2FsbERhdGEubGVuZ3RoIC0gMikgLyAyOwogICAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbXTsKICAgICAgICB9CiAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbCiAgICAgICAgICAuLi5jaHVua2VkQ2FsbHNbY3VycmVudENodW5rXSwKICAgICAgICAgIHsKICAgICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgICBjYWxsRGF0YSwKICAgICAgICAgICAgdGFyZ2V0OiBhZGRyZXNzCiAgICAgICAgICB9CiAgICAgICAgXTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L211bHRpY2FsbCIsCiAgICAgICAgICBmdW5jdGlvbk5hbWUKICAgICAgICB9KTsKICAgICAgICBpZiAoIWFsbG93RmFpbHVyZSkKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIGNodW5rZWRDYWxsc1tjdXJyZW50Q2h1bmtdID0gWwogICAgICAgICAgLi4uY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10sCiAgICAgICAgICB7CiAgICAgICAgICAgIGFsbG93RmFpbHVyZTogdHJ1ZSwKICAgICAgICAgICAgY2FsbERhdGE6ICIweCIsCiAgICAgICAgICAgIHRhcmdldDogYWRkcmVzcwogICAgICAgICAgfQogICAgICAgIF07CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGFnZ3JlZ2F0ZTNSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGNodW5rZWRDYWxscy5tYXAoKGNhbGxzKSA9PiBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgIGFiaTogbXVsdGljYWxsM0FiaSwKICAgICAgYWRkcmVzczogbXVsdGljYWxsQWRkcmVzcywKICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnLAogICAgICBmdW5jdGlvbk5hbWU6ICJhZ2dyZWdhdGUzIiwKICAgICAgc3RhdGVPdmVycmlkZQogICAgfSkpKTsKICAgIGNvbnN0IHJlc3VsdHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWdncmVnYXRlM1Jlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcmVzdWx0ID0gYWdncmVnYXRlM1Jlc3VsdHNbaV07CiAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAicmVqZWN0ZWQiKSB7CiAgICAgICAgaWYgKCFhbGxvd0ZhaWx1cmUpCiAgICAgICAgICB0aHJvdyByZXN1bHQucmVhc29uOwogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY2h1bmtlZENhbGxzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2goewogICAgICAgICAgICBzdGF0dXM6ICJmYWlsdXJlIiwKICAgICAgICAgICAgZXJyb3I6IHJlc3VsdC5yZWFzb24sCiAgICAgICAgICAgIHJlc3VsdDogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3QgYWdncmVnYXRlM1Jlc3VsdCA9IHJlc3VsdC52YWx1ZTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhZ2dyZWdhdGUzUmVzdWx0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgY29uc3QgeyByZXR1cm5EYXRhLCBzdWNjZXNzIH0gPSBhZ2dyZWdhdGUzUmVzdWx0W2pdOwogICAgICAgIGNvbnN0IHsgY2FsbERhdGEgfSA9IGNodW5rZWRDYWxsc1tpXVtqXTsKICAgICAgICBjb25zdCB7IGFiaTogYWJpMiwgYWRkcmVzcywgZnVuY3Rpb25OYW1lLCBhcmdzIH0gPSBjb250cmFjdHMyW3Jlc3VsdHMubGVuZ3RoXTsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGNhbGxEYXRhID09PSAiMHgiKQogICAgICAgICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICAgICAgICBpZiAoIXN1Y2Nlc3MpCiAgICAgICAgICAgIHRocm93IG5ldyBSYXdDb250cmFjdEVycm9yKHsgZGF0YTogcmV0dXJuRGF0YSB9KTsKICAgICAgICAgIGNvbnN0IHJlc3VsdDIgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgZGF0YTogcmV0dXJuRGF0YSwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHJlc3VsdHMucHVzaChhbGxvd0ZhaWx1cmUgPyB7IHJlc3VsdDogcmVzdWx0Miwgc3RhdHVzOiAic3VjY2VzcyIgfSA6IHJlc3VsdDIpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvbXVsdGljYWxsIiwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICghYWxsb3dGYWlsdXJlKQogICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgIHJlc3VsdHMucHVzaCh7IGVycm9yLCByZXN1bHQ6IHZvaWQgMCwgc3RhdHVzOiAiZmFpbHVyZSIgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IGNvbnRyYWN0czIubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigibXVsdGljYWxsIHJlc3VsdHMgbWlzbWF0Y2giKTsKICAgIHJldHVybiByZXN1bHRzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3ZlcmlmeUhhc2guanMKICBpbml0X2FiaXMoKTsKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfY29udHJhY3QoKTsKICBpbml0X2VuY29kZURlcGxveURhdGEoKTsKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25hdHVyZSh7IHIsIHMsIHRvID0gImhleCIsIHYsIHlQYXJpdHkgfSkgewogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAoeVBhcml0eSA9PT0gMCB8fCB5UGFyaXR5ID09PSAxKQogICAgICAgIHJldHVybiB5UGFyaXR5OwogICAgICBpZiAodiAmJiAodiA9PT0gMjduIHx8IHYgPT09IDI4biB8fCB2ID49IDM1bikpCiAgICAgICAgcmV0dXJuIHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGB2YCBvciBgeVBhcml0eWAgdmFsdWUiKTsKICAgIH0pKCk7CiAgICBjb25zdCBzaWduYXR1cmUgPSBgMHgke25ldyBzZWNwMjU2azEuU2lnbmF0dXJlKGhleFRvQmlnSW50KHIpLCBoZXhUb0JpZ0ludChzKSkudG9Db21wYWN0SGV4KCl9JHt5UGFyaXR5XyA9PT0gMCA/ICIxYiIgOiAiMWMifWA7CiAgICBpZiAodG8gPT09ICJoZXgiKQogICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoc2lnbmF0dXJlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlIYXNoLmpzCiAgaW5pdF9jYWxsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5SGFzaDIoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBoYXNoOiBoYXNoMywgc2lnbmF0dXJlLCB1bml2ZXJzYWxTaWduYXR1cmVWZXJpZmllckFkZHJlc3MgPSBjbGllbnQuY2hhaW4/LmNvbnRyYWN0cz8udW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI/LmFkZHJlc3MsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmVIZXggPSAoKCkgPT4gewogICAgICBpZiAoaXNIZXgoc2lnbmF0dXJlKSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gIm9iamVjdCIgJiYgInIiIGluIHNpZ25hdHVyZSAmJiAicyIgaW4gc2lnbmF0dXJlKQogICAgICAgIHJldHVybiBzZXJpYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoc2lnbmF0dXJlKTsKICAgIH0pKCk7CiAgICBjb25zdCB3cmFwcGVkU2lnbmF0dXJlID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFmYWN0b3J5ICYmICFmYWN0b3J5RGF0YSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlSGV4OwogICAgICBpZiAoaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZUhleCkpCiAgICAgICAgcmV0dXJuIHNpZ25hdHVyZUhleDsKICAgICAgcmV0dXJuIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUoewogICAgICAgIGFkZHJlc3M6IGZhY3RvcnksCiAgICAgICAgZGF0YTogZmFjdG9yeURhdGEsCiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVIZXgKICAgICAgfSk7CiAgICB9KSgpOwogICAgdHJ5IHsKICAgICAgY29uc3QgYXJncyA9IHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyQWRkcmVzcyA/IHsKICAgICAgICB0bzogdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXJBZGRyZXNzLAogICAgICAgIGRhdGE6IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImlzVmFsaWRTaWciLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA6IHsKICAgICAgICBkYXRhOiBlbmNvZGVEZXBsb3lEYXRhKHsKICAgICAgICAgIGFiaTogdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXSwKICAgICAgICAgIGJ5dGVjb2RlOiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfTsKICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjYWxsLCAiY2FsbCIpKGFyZ3MpOwogICAgICByZXR1cm4gaGV4VG9Cb29sKGRhdGEgPz8gIjB4MCIpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB2ZXJpZmllZCA9IGlzQWRkcmVzc0VxdWFsKGdldEFkZHJlc3MoYWRkcmVzcyksIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgICAgICAgaWYgKHZlcmlmaWVkKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIENhbGxFeGVjdXRpb25FcnJvcikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCB7IGFkZHJlc3MsIG1lc3NhZ2UsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBzaWduYXR1cmUsIC4uLmNhbGxSZXF1ZXN0IH0pIHsKICAgIGNvbnN0IGhhc2gzID0gaGFzaE1lc3NhZ2UobWVzc2FnZSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvdmVyaWZ5VHlwZWREYXRhLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhMihjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHNpZ25hdHVyZSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4sIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaGFzaDMgPSBoYXNoVHlwZWREYXRhKHsgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4gfSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdC5qcwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X3dpdGhSZXNvbHZlcnMoKTsKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja051bWJlci5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gd2F0Y2hCbG9ja051bWJlcihjbGllbnQsIHsgZW1pdE9uQmVnaW4gPSBmYWxzZSwgZW1pdE1pc3NlZCA9IGZhbHNlLCBvbkJsb2NrTnVtYmVyLCBvbkVycm9yLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGxldCBwcmV2QmxvY2tOdW1iZXI7CiAgICBjb25zdCBwb2xsQmxvY2tOdW1iZXIgPSAoKSA9PiB7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaEJsb2NrTnVtYmVyIiwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGVtaXRPbkJlZ2luLAogICAgICAgIGVtaXRNaXNzZWQsCiAgICAgICAgcG9sbGluZ0ludGVydmFsCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uQmxvY2tOdW1iZXIsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7IGNhY2hlVGltZTogMCB9KTsKICAgICAgICAgIGlmIChwcmV2QmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgaWYgKGJsb2NrTnVtYmVyID09PSBwcmV2QmxvY2tOdW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2tOdW1iZXIgLSBwcmV2QmxvY2tOdW1iZXIgPiAxICYmIGVtaXRNaXNzZWQpIHsKICAgICAgICAgICAgICBmb3IgKGxldCBpID0gcHJldkJsb2NrTnVtYmVyICsgMW47IGkgPCBibG9ja051bWJlcjsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoaSwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXByZXZCbG9ja051bWJlciB8fCBibG9ja051bWJlciA+IHByZXZCbG9ja051bWJlcikgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoYmxvY2tOdW1iZXIsIHByZXZCbG9ja051bWJlcik7CiAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja051bWJlciA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQmxvY2tOdW1iZXIiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZW1pdE9uQmVnaW4sCiAgICAgICAgZW1pdE1pc3NlZAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrTnVtYmVyLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIikgewogICAgICAgICAgICAgICAgY29uc3QgdHJhbnNwb3J0MiA9IGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0cy5maW5kKCh0cmFuc3BvcnQzKSA9PiB0cmFuc3BvcnQzLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0Iik7CiAgICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zcG9ydDIudmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJuZXdIZWFkcyJdLAogICAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBoZXhUb0JpZ0ludChkYXRhLnJlc3VsdD8ubnVtYmVyKTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9ja051bWJlcihibG9ja051bWJlciwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmVfOwogICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBlbmFibGVQb2xsaW5nID8gcG9sbEJsb2NrTnVtYmVyKCkgOiBzdWJzY3JpYmVCbG9ja051bWJlcigpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHQuanMKICBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0KGNsaWVudCwgewogICAgY29uZmlybWF0aW9ucyA9IDEsCiAgICBoYXNoOiBoYXNoMywKICAgIG9uUmVwbGFjZWQsCiAgICBwb2xsaW5nSW50ZXJ2YWwgPSBjbGllbnQucG9sbGluZ0ludGVydmFsLAogICAgcmV0cnlDb3VudCA9IDYsCiAgICByZXRyeURlbGF5ID0gKHsgY291bnQgfSkgPT4gfn4oMSA8PCBjb3VudCkgKiAyMDAsCiAgICAvLyBleHBvbmVudGlhbCBiYWNrb2ZmCiAgICB0aW1lb3V0ID0gMThlNAogIH0pIHsKICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWyJ3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0IiwgY2xpZW50LnVpZCwgaGFzaDNdKTsKICAgIGxldCB0cmFuc2FjdGlvbjsKICAgIGxldCByZXBsYWNlZFRyYW5zYWN0aW9uOwogICAgbGV0IHJlY2VpcHQ7CiAgICBsZXQgcmV0cnlpbmcgPSBmYWxzZTsKICAgIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0IH0gPSB3aXRoUmVzb2x2ZXJzKCk7CiAgICBjb25zdCB0aW1lciA9IHRpbWVvdXQgPyBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvcih7IGhhc2g6IGhhc2gzIH0pKSwgdGltZW91dCkgOiB2b2lkIDA7CiAgICBjb25zdCBfdW5vYnNlcnZlID0gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uUmVwbGFjZWQsIHJlc29sdmUsIHJlamVjdCB9LCAoZW1pdCkgPT4gewogICAgICBjb25zdCBfdW53YXRjaCA9IGdldEFjdGlvbihjbGllbnQsIHdhdGNoQmxvY2tOdW1iZXIsICJ3YXRjaEJsb2NrTnVtYmVyIikoewogICAgICAgIGVtaXRNaXNzZWQ6IHRydWUsCiAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgcG9sbDogdHJ1ZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgYXN5bmMgb25CbG9ja051bWJlcihibG9ja051bWJlcl8pIHsKICAgICAgICAgIGNvbnN0IGRvbmUgPSAoZm4pID0+IHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgICAgICAgICAgX3Vud2F0Y2goKTsKICAgICAgICAgICAgZm4oKTsKICAgICAgICAgICAgX3Vub2JzZXJ2ZSgpOwogICAgICAgICAgfTsKICAgICAgICAgIGxldCBibG9ja051bWJlciA9IGJsb2NrTnVtYmVyXzsKICAgICAgICAgIGlmIChyZXRyeWluZykKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlY2VpcHQpIHsKICAgICAgICAgICAgICBpZiAoY29uZmlybWF0aW9ucyA+IDEgJiYgKCFyZWNlaXB0LmJsb2NrTnVtYmVyIHx8IGJsb2NrTnVtYmVyIC0gcmVjZWlwdC5ibG9ja051bWJlciArIDFuIDwgY29uZmlybWF0aW9ucykpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgZG9uZSgoKSA9PiBlbWl0LnJlc29sdmUocmVjZWlwdCkpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgIGF3YWl0IHdpdGhSZXRyeShhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uLCAiZ2V0VHJhbnNhY3Rpb24iKSh7IGhhc2g6IGhhc2gzIH0pOwogICAgICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyKQogICAgICAgICAgICAgICAgICBibG9ja051bWJlciA9IHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgcmV0cnlDb3VudAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHJ5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVjZWlwdCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uUmVjZWlwdCwgImdldFRyYW5zYWN0aW9uUmVjZWlwdCIpKHsgaGFzaDogaGFzaDMgfSk7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zID4gMSAmJiAoIXJlY2VpcHQuYmxvY2tOdW1iZXIgfHwgYmxvY2tOdW1iZXIgLSByZWNlaXB0LmJsb2NrTnVtYmVyICsgMW4gPCBjb25maXJtYXRpb25zKSkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZXNvbHZlKHJlY2VpcHQpKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIHx8IGVyciBpbnN0YW5jZW9mIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IpIHsKICAgICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgICByZXRyeWluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCB3aXRoUmV0cnkoKCkgPT4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHsKICAgICAgICAgICAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVUcmFuc2FjdGlvbnM6IHRydWUKICAgICAgICAgICAgICAgIH0pLCB7CiAgICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgICByZXRyeUNvdW50LAogICAgICAgICAgICAgICAgICBzaG91bGRSZXRyeTogKHsgZXJyb3IgfSkgPT4gZXJyb3IgaW5zdGFuY2VvZiBCbG9ja05vdEZvdW5kRXJyb3IKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50VHJhbnNhY3Rpb24gPSBibG9jay50cmFuc2FjdGlvbnMuZmluZCgoeyBmcm9tLCBub25jZSB9KSA9PiBmcm9tID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLmZyb20gJiYgbm9uY2UgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24ubm9uY2UpOwogICAgICAgICAgICAgICAgaWYgKCFyZXBsYWNlbWVudFRyYW5zYWN0aW9uKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICByZWNlaXB0ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LCAiZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IikoewogICAgICAgICAgICAgICAgICBoYXNoOiByZXBsYWNlbWVudFRyYW5zYWN0aW9uLmhhc2gKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnMgPiAxICYmICghcmVjZWlwdC5ibG9ja051bWJlciB8fCBibG9ja051bWJlciAtIHJlY2VpcHQuYmxvY2tOdW1iZXIgKyAxbiA8IGNvbmZpcm1hdGlvbnMpKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgcmVhc29uID0gInJlcGxhY2VkIjsKICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24udmFsdWUpIHsKICAgICAgICAgICAgICAgICAgcmVhc29uID0gInJlcHJpY2VkIjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVwbGFjZW1lbnRUcmFuc2FjdGlvbi5mcm9tID09PSByZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IDBuKSB7CiAgICAgICAgICAgICAgICAgIHJlYXNvbiA9ICJjYW5jZWxsZWQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9uZSgoKSA9PiB7CiAgICAgICAgICAgICAgICAgIGVtaXQub25SZXBsYWNlZD8uKHsKICAgICAgICAgICAgICAgICAgICByZWFzb24sCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbjogcmVwbGFjZW1lbnRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IHJlY2VpcHQKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGVtaXQucmVzb2x2ZShyZWNlaXB0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycl8pIHsKICAgICAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZWplY3QoZXJyXykpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBkb25lKCgpID0+IGVtaXQucmVqZWN0KGVycikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIHByb21pc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja3MuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoQmxvY2tzKGNsaWVudCwgeyBibG9ja1RhZyA9ICJsYXRlc3QiLCBlbWl0TWlzc2VkID0gZmFsc2UsIGVtaXRPbkJlZ2luID0gZmFsc2UsIG9uQmxvY2ssIG9uRXJyb3IsIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGNvbnN0IGluY2x1ZGVUcmFuc2FjdGlvbnMgPSBpbmNsdWRlVHJhbnNhY3Rpb25zXyA/PyBmYWxzZTsKICAgIGxldCBwcmV2QmxvY2s7CiAgICBjb25zdCBwb2xsQmxvY2tzID0gKCkgPT4gewogICAgICBjb25zdCBvYnNlcnZlcklkID0gc3RyaW5naWZ5KFsKICAgICAgICAid2F0Y2hCbG9ja3MiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgZW1pdE1pc3NlZCwKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrLCBvbkVycm9yIH0sIChlbWl0KSA9PiBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoewogICAgICAgICAgICBibG9ja1RhZywKICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYmxvY2subnVtYmVyICYmIHByZXZCbG9jaz8ubnVtYmVyKSB7CiAgICAgICAgICAgIGlmIChibG9jay5udW1iZXIgPT09IHByZXZCbG9jay5udW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2subnVtYmVyIC0gcHJldkJsb2NrLm51bWJlciA+IDEgJiYgZW1pdE1pc3NlZCkgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSBwcmV2QmxvY2s/Lm51bWJlciArIDFuOyBpIDwgYmxvY2subnVtYmVyOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrMiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgICAgIGJsb2NrTnVtYmVyOiBpLAogICAgICAgICAgICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9jayhibG9jazIsIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIC8vIElmIG5vIHByZXZpb3VzIGJsb2NrIGV4aXN0cywgZW1pdC4KICAgICAgICAgICAgIXByZXZCbG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBibG9jayB0YWcgaXMgInBlbmRpbmciIHdpdGggbm8gYmxvY2sgbnVtYmVyLCBlbWl0LgogICAgICAgICAgICBibG9ja1RhZyA9PT0gInBlbmRpbmciICYmICFibG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBuZXh0IGJsb2NrIG51bWJlciBpcyBncmVhdGVyIHRoYW4gdGhlIHByZXZpb3VzIGJsb2NrIG51bWJlciwgZW1pdC4KICAgICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byBlbWl0IGJsb2NrcyBpbiB0aGUgcGFzdC4KICAgICAgICAgICAgYmxvY2subnVtYmVyICYmIGJsb2NrLm51bWJlciA+IHByZXZCbG9jay5udW1iZXIKICAgICAgICAgICkgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgIHByZXZCbG9jayA9IGJsb2NrOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja3MgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgZW1pdEZldGNoZWQgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGVtaXRPbkJlZ2luKSB7CiAgICAgICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgICB9KS50aGVuKChibG9jaykgPT4gewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGlmICghZW1pdEZldGNoZWQpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgb25CbG9jayhibG9jaywgdm9pZCAwKTsKICAgICAgICAgICAgICBlbWl0RmV0Y2hlZCA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibmV3SGVhZHMiXSwKICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LmJsb2NrPy5mb3JtYXQgfHwgZm9ybWF0QmxvY2s7CiAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBmb3JtYXQoZGF0YS5yZXN1bHQpOwogICAgICAgICAgICAgIG9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgZW1pdEZldGNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQmxvY2tzKCkgOiBzdWJzY3JpYmVCbG9ja3MoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaEV2ZW50LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBpbml0X2FiaSgpOwogIGluaXRfcnBjKCk7CiAgZnVuY3Rpb24gd2F0Y2hFdmVudChjbGllbnQsIHsgYWRkcmVzcywgYXJncywgYmF0Y2ggPSB0cnVlLCBldmVudCwgZXZlbnRzLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAodHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIiAmJiBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHNbMF0uY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KSgpOwogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IHBvbGxFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoRXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50LAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBmcm9tQmxvY2sKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IHByZXZpb3VzQmxvY2tOdW1iZXI7CiAgICAgICAgaWYgKGZyb21CbG9jayAhPT0gdm9pZCAwKQogICAgICAgICAgcHJldmlvdXNCbG9ja051bWJlciA9IGZyb21CbG9jayAtIDFuOwogICAgICAgIGxldCBmaWx0ZXI7CiAgICAgICAgbGV0IGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgY29uc3QgdW53YXRjaCA9IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgICAgaWYgKCFpbml0aWFsaXplZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZUV2ZW50RmlsdGVyLCAiY3JlYXRlRXZlbnRGaWx0ZXIiKSh7CiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIGV2ZW50LAogICAgICAgICAgICAgICAgZXZlbnRzLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciAhPT0gYmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgICAgIGxvZ3MgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRMb2dzLCAiZ2V0TG9ncyIpKHsKICAgICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgICAgZXZlbnQsCiAgICAgICAgICAgICAgICAgIGV2ZW50cywKICAgICAgICAgICAgICAgICAgZnJvbUJsb2NrOiBwcmV2aW91c0Jsb2NrTnVtYmVyICsgMW4sCiAgICAgICAgICAgICAgICAgIHRvQmxvY2s6IGJsb2NrTnVtYmVyCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUV2ZW50ID0gKCkgPT4gewogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBldmVudHNfID0gZXZlbnRzID8/IChldmVudCA/IFtldmVudF0gOiB2b2lkIDApOwogICAgICAgICAgbGV0IHRvcGljcyA9IFtdOwogICAgICAgICAgaWYgKGV2ZW50c18pIHsKICAgICAgICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50c18uZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgICAgICAgIGFyZ3MKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB0b3BpY3MgPSBbZW5jb2RlZF07CiAgICAgICAgICAgIGlmIChldmVudCkKICAgICAgICAgICAgICB0b3BpY3MgPSB0b3BpY3NbMF07CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibG9ncyIsIHsgYWRkcmVzcywgdG9waWNzIH1dLAogICAgICAgICAgICBvbkRhdGEoZGF0YSkgewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGNvbnN0IGxvZyA9IGRhdGEucmVzdWx0OwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCB7IGV2ZW50TmFtZSwgYXJnczogYXJnczIgfSA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgICAgICAgICAgYWJpOiBldmVudHNfID8/IFtdLAogICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgdG9waWNzOiBsb2cudG9waWNzLAogICAgICAgICAgICAgICAgICBzdHJpY3QKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgeyBhcmdzOiBhcmdzMiwgZXZlbnROYW1lIH0pOwogICAgICAgICAgICAgICAgb25Mb2dzKFtmb3JtYXR0ZWRdKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGxldCBldmVudE5hbWU7CiAgICAgICAgICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ0RhdGFNaXNtYXRjaCB8fCBlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCkgewogICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSA9IGVyci5hYmlJdGVtLm5hbWU7CiAgICAgICAgICAgICAgICAgIGlzVW5uYW1lZCA9IGVyci5hYmlJdGVtLmlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdExvZyhsb2csIHsKICAgICAgICAgICAgICAgICAgYXJnczogaXNVbm5hbWVkID8gW10gOiB7fSwKICAgICAgICAgICAgICAgICAgZXZlbnROYW1lCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB1bnN1YnNjcmliZSA9IHVuc3Vic2NyaWJlXzsKICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICByZXR1cm4gZW5hYmxlUG9sbGluZyA/IHBvbGxFdmVudCgpIDogc3Vic2NyaWJlRXZlbnQoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyhjbGllbnQsIHsgYmF0Y2ggPSB0cnVlLCBvbkVycm9yLCBvblRyYW5zYWN0aW9ucywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwgfSkgewogICAgY29uc3QgZW5hYmxlUG9sbGluZyA9IHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIgPyBwb2xsXyA6IGNsaWVudC50cmFuc3BvcnQudHlwZSAhPT0gIndlYlNvY2tldCI7CiAgICBjb25zdCBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucyA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyIsCiAgICAgICAgY2xpZW50LnVpZCwKICAgICAgICBiYXRjaCwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25UcmFuc2FjdGlvbnMsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghZmlsdGVyKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciwgImNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIpKHt9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHVud2F0Y2goKTsKICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgaGFzaGVzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgaWYgKGhhc2hlcy5sZW5ndGggPT09IDApCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmF0Y2gpCiAgICAgICAgICAgICAgZW1pdC5vblRyYW5zYWN0aW9ucyhoYXNoZXMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBoYXNoMyBvZiBoYXNoZXMpCiAgICAgICAgICAgICAgICBlbWl0Lm9uVHJhbnNhY3Rpb25zKFtoYXNoM10pOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZVBlbmRpbmdUcmFuc2FjdGlvbnMgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgeyB1bnN1YnNjcmliZTogdW5zdWJzY3JpYmVfIH0gPSBhd2FpdCBjbGllbnQudHJhbnNwb3J0LnN1YnNjcmliZSh7CiAgICAgICAgICAgIHBhcmFtczogWyJuZXdQZW5kaW5nVHJhbnNhY3Rpb25zIl0sCiAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgaWYgKCFhY3RpdmUpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICBvblRyYW5zYWN0aW9ucyhbdHJhbnNhY3Rpb25dKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucygpIDogc3Vic2NyaWJlUGVuZGluZ1RyYW5zYWN0aW9ucygpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Npd2UvcGFyc2VTaXdlTWVzc2FnZS5qcwogIGZ1bmN0aW9uIHBhcnNlU2l3ZU1lc3NhZ2UobWVzc2FnZSkgewogICAgY29uc3QgeyBzY2hlbWUsIHN0YXRlbWVudCwgLi4ucHJlZml4IH0gPSBtZXNzYWdlLm1hdGNoKHByZWZpeFJlZ2V4KT8uZ3JvdXBzID8/IHt9OwogICAgY29uc3QgeyBjaGFpbklkLCBleHBpcmF0aW9uVGltZSwgaXNzdWVkQXQsIG5vdEJlZm9yZSwgcmVxdWVzdElkLCAuLi5zdWZmaXggfSA9IG1lc3NhZ2UubWF0Y2goc3VmZml4UmVnZXgpPy5ncm91cHMgPz8ge307CiAgICBjb25zdCByZXNvdXJjZXMgPSBtZXNzYWdlLnNwbGl0KCJSZXNvdXJjZXM6IilbMV0/LnNwbGl0KCJcbi0gIikuc2xpY2UoMSk7CiAgICByZXR1cm4gewogICAgICAuLi5wcmVmaXgsCiAgICAgIC4uLnN1ZmZpeCwKICAgICAgLi4uY2hhaW5JZCA/IHsgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpIH0gOiB7fSwKICAgICAgLi4uZXhwaXJhdGlvblRpbWUgPyB7IGV4cGlyYXRpb25UaW1lOiBuZXcgRGF0ZShleHBpcmF0aW9uVGltZSkgfSA6IHt9LAogICAgICAuLi5pc3N1ZWRBdCA/IHsgaXNzdWVkQXQ6IG5ldyBEYXRlKGlzc3VlZEF0KSB9IDoge30sCiAgICAgIC4uLm5vdEJlZm9yZSA/IHsgbm90QmVmb3JlOiBuZXcgRGF0ZShub3RCZWZvcmUpIH0gOiB7fSwKICAgICAgLi4ucmVxdWVzdElkID8geyByZXF1ZXN0SWQgfSA6IHt9LAogICAgICAuLi5yZXNvdXJjZXMgPyB7IHJlc291cmNlcyB9IDoge30sCiAgICAgIC4uLnNjaGVtZSA/IHsgc2NoZW1lIH0gOiB7fSwKICAgICAgLi4uc3RhdGVtZW50ID8geyBzdGF0ZW1lbnQgfSA6IHt9CiAgICB9OwogIH0KICB2YXIgcHJlZml4UmVnZXggPSAvXig/Oig/PHNjaGVtZT5bYS16QS1aXVthLXpBLVowLTkrLS5dKik6XC9cLyk/KD88ZG9tYWluPlthLXpBLVowLTkrLS5dKig/OjpbMC05XXsxLDV9KT8pICg/OndhbnRzIHlvdSB0byBzaWduIGluIHdpdGggeW91ciBFdGhlcmV1bSBhY2NvdW50OlxuKSg/PGFkZHJlc3M+MHhbYS1mQS1GMC05XXs0MH0pXG5cbig/Oig/PHN0YXRlbWVudD4uKilcblxuKT8vOwogIHZhciBzdWZmaXhSZWdleCA9IC8oPzpVUkk6ICg/PHVyaT4uKykpXG4oPzpWZXJzaW9uOiAoPzx2ZXJzaW9uPi4rKSlcbig/OkNoYWluIElEOiAoPzxjaGFpbklkPlxkKykpXG4oPzpOb25jZTogKD88bm9uY2U+W2EtekEtWjAtOV0rKSlcbig/Oklzc3VlZCBBdDogKD88aXNzdWVkQXQ+LispKSg/OlxuRXhwaXJhdGlvbiBUaW1lOiAoPzxleHBpcmF0aW9uVGltZT4uKykpPyg/OlxuTm90IEJlZm9yZTogKD88bm90QmVmb3JlPi4rKSk/KD86XG5SZXF1ZXN0IElEOiAoPzxyZXF1ZXN0SWQ+LispKT8vOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2l3ZS92YWxpZGF0ZVNpd2VNZXNzYWdlLmpzCiAgaW5pdF9pc0FkZHJlc3NFcXVhbCgpOwogIGZ1bmN0aW9uIHZhbGlkYXRlU2l3ZU1lc3NhZ2UocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBkb21haW4sIG1lc3NhZ2UsIG5vbmNlLCBzY2hlbWUsIHRpbWUgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSB9ID0gcGFyYW1ldGVyczsKICAgIGlmIChkb21haW4gJiYgbWVzc2FnZS5kb21haW4gIT09IGRvbWFpbikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG5vbmNlICYmIG1lc3NhZ2Uubm9uY2UgIT09IG5vbmNlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoc2NoZW1lICYmIG1lc3NhZ2Uuc2NoZW1lICE9PSBzY2hlbWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChtZXNzYWdlLmV4cGlyYXRpb25UaW1lICYmIHRpbWUgPj0gbWVzc2FnZS5leHBpcmF0aW9uVGltZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG1lc3NhZ2Uubm90QmVmb3JlICYmIHRpbWUgPCBtZXNzYWdlLm5vdEJlZm9yZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgdHJ5IHsKICAgICAgaWYgKCFtZXNzYWdlLmFkZHJlc3MpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcyAmJiAhaXNBZGRyZXNzRXF1YWwobWVzc2FnZS5hZGRyZXNzLCBhZGRyZXNzKSkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9zaXdlL3ZlcmlmeVNpd2VNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5U2l3ZU1lc3NhZ2UoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGRvbWFpbiwgbWVzc2FnZSwgbm9uY2UsIHNjaGVtZSwgc2lnbmF0dXJlLCB0aW1lID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgcGFyc2VkID0gcGFyc2VTaXdlTWVzc2FnZShtZXNzYWdlKTsKICAgIGlmICghcGFyc2VkLmFkZHJlc3MpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZVNpd2VNZXNzYWdlKHsKICAgICAgYWRkcmVzcywKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlOiBwYXJzZWQsCiAgICAgIG5vbmNlLAogICAgICBzY2hlbWUsCiAgICAgIHRpbWUKICAgIH0pOwogICAgaWYgKCFpc1ZhbGlkKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBoYXNoMyA9IGhhc2hNZXNzYWdlKG1lc3NhZ2UpOwogICAgcmV0dXJuIHZlcmlmeUhhc2gyKGNsaWVudCwgewogICAgICBhZGRyZXNzOiBwYXJzZWQuYWRkcmVzcywKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgLi4uY2FsbFJlcXVlc3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvZGVjb3JhdG9ycy9wdWJsaWMuanMKICBmdW5jdGlvbiBwdWJsaWNBY3Rpb25zKGNsaWVudCkgewogICAgcmV0dXJuIHsKICAgICAgY2FsbDogKGFyZ3MpID0+IGNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlQmxvY2tGaWx0ZXI6ICgpID0+IGNyZWF0ZUJsb2NrRmlsdGVyKGNsaWVudCksCiAgICAgIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXI6IChhcmdzKSA9PiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgYXJncyksCiAgICAgIGNyZWF0ZUV2ZW50RmlsdGVyOiAoYXJncykgPT4gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlUGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyOiAoKSA9PiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSwKICAgICAgZXN0aW1hdGVDb250cmFjdEdhczogKGFyZ3MpID0+IGVzdGltYXRlQ29udHJhY3RHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUdhcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCYWxhbmNlOiAoYXJncykgPT4gZ2V0QmFsYW5jZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9iQmFzZUZlZTogKCkgPT4gZ2V0QmxvYkJhc2VGZWUoY2xpZW50KSwKICAgICAgZ2V0QmxvY2s6IChhcmdzKSA9PiBnZXRCbG9jayhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9ja051bWJlcjogKGFyZ3MpID0+IGdldEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudDogKGFyZ3MpID0+IGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCeXRlY29kZTogKGFyZ3MpID0+IGdldENvZGUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0Q2hhaW5JZDogKCkgPT4gZ2V0Q2hhaW5JZChjbGllbnQpLAogICAgICBnZXRDb2RlOiAoYXJncykgPT4gZ2V0Q29kZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRDb250cmFjdEV2ZW50czogKGFyZ3MpID0+IGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgYXJncyksCiAgICAgIGdldEVpcDcxMkRvbWFpbjogKGFyZ3MpID0+IGdldEVpcDcxMkRvbWFpbihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBZGRyZXNzOiAoYXJncykgPT4gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBdmF0YXI6IChhcmdzKSA9PiBnZXRFbnNBdmF0YXIoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zTmFtZTogKGFyZ3MpID0+IGdldEVuc05hbWUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zUmVzb2x2ZXI6IChhcmdzKSA9PiBnZXRFbnNSZXNvbHZlcihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNUZXh0OiAoYXJncykgPT4gZ2V0RW5zVGV4dChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRGZWVIaXN0b3J5OiAoYXJncykgPT4gZ2V0RmVlSGlzdG9yeShjbGllbnQsIGFyZ3MpLAogICAgICBlc3RpbWF0ZUZlZXNQZXJHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyQ2hhbmdlczogKGFyZ3MpID0+IGdldEZpbHRlckNoYW5nZXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyTG9nczogKGFyZ3MpID0+IGdldEZpbHRlckxvZ3MoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0R2FzUHJpY2U6ICgpID0+IGdldEdhc1ByaWNlKGNsaWVudCksCiAgICAgIGdldExvZ3M6IChhcmdzKSA9PiBnZXRMb2dzKGNsaWVudCwgYXJncyksCiAgICAgIGdldFByb29mOiAoYXJncykgPT4gZ2V0UHJvb2YoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhczogKGFyZ3MpID0+IGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0U3RvcmFnZUF0OiAoYXJncykgPT4gZ2V0U3RvcmFnZUF0KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zKGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uQ291bnQ6IChhcmdzKSA9PiBnZXRUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uUmVjZWlwdDogKGFyZ3MpID0+IGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICBtdWx0aWNhbGw6IChhcmdzKSA9PiBtdWx0aWNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdDogKGFyZ3MpID0+IHByZXBhcmVUcmFuc2FjdGlvblJlcXVlc3QoY2xpZW50LCBhcmdzKSwKICAgICAgcmVhZENvbnRyYWN0OiAoYXJncykgPT4gcmVhZENvbnRyYWN0KGNsaWVudCwgYXJncyksCiAgICAgIHNlbmRSYXdUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRSYXdUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICBzaW11bGF0ZUNvbnRyYWN0OiAoYXJncykgPT4gc2ltdWxhdGVDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlNZXNzYWdlOiAoYXJncykgPT4gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCBhcmdzKSwKICAgICAgdmVyaWZ5U2l3ZU1lc3NhZ2U6IChhcmdzKSA9PiB2ZXJpZnlTaXdlTWVzc2FnZShjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlUeXBlZERhdGE6IChhcmdzKSA9PiB2ZXJpZnlUeXBlZERhdGEyKGNsaWVudCwgYXJncyksCiAgICAgIHVuaW5zdGFsbEZpbHRlcjogKGFyZ3MpID0+IHVuaW5zdGFsbEZpbHRlcihjbGllbnQsIGFyZ3MpLAogICAgICB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0OiAoYXJncykgPT4gd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEJsb2NrczogKGFyZ3MpID0+IHdhdGNoQmxvY2tzKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQmxvY2tOdW1iZXI6IChhcmdzKSA9PiB3YXRjaEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQ29udHJhY3RFdmVudDogKGFyZ3MpID0+IHdhdGNoQ29udHJhY3RFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEV2ZW50OiAoYXJncykgPT4gd2F0Y2hFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnM6IChhcmdzKSA9PiB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVB1YmxpY0NsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVB1YmxpY0NsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJwdWJsaWMiLCBuYW1lID0gIlB1YmxpYyBDbGllbnQiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2xpZW50ID0gY3JlYXRlQ2xpZW50KHsKICAgICAgLi4ucGFyYW1ldGVycywKICAgICAga2V5LAogICAgICBuYW1lLAogICAgICB0eXBlOiAicHVibGljQ2xpZW50IgogICAgfSk7CiAgICByZXR1cm4gY2xpZW50LmV4dGVuZChwdWJsaWNBY3Rpb25zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvZHJvcFRyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gZHJvcFRyYW5zYWN0aW9uKGNsaWVudCwgeyBoYXNoOiBoYXNoMyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2Ryb3BUcmFuc2FjdGlvbmAsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2R1bXBTdGF0ZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGR1bXBTdGF0ZShjbGllbnQpIHsKICAgIHJldHVybiBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2R1bXBTdGF0ZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRBdXRvbWluZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEF1dG9taW5lKGNsaWVudCkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX21pbmluZyIKICAgICAgfSk7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9nZXRBdXRvbWluZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRUeHBvb2xDb250ZW50LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHhwb29sQ29udGVudChjbGllbnQpIHsKICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9jb250ZW50IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2dldFR4cG9vbFN0YXR1cy5qcwogIGluaXRfZnJvbUhleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFR4cG9vbFN0YXR1cyhjbGllbnQpIHsKICAgIGNvbnN0IHsgcGVuZGluZywgcXVldWVkIH0gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9zdGF0dXMiCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIHBlbmRpbmc6IGhleFRvTnVtYmVyKHBlbmRpbmcpLAogICAgICBxdWV1ZWQ6IGhleFRvTnVtYmVyKHF1ZXVlZCkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2ltcGVyc29uYXRlQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIGltcGVyc29uYXRlQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2ltcGVyc29uYXRlQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5jcmVhc2VUaW1lLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGluY3JlYXNlVGltZShjbGllbnQsIHsgc2Vjb25kcyB9KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1faW5jcmVhc2VUaW1lIiwKICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoc2Vjb25kcyldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5zcGVjdFR4cG9vbC5qcwogIGFzeW5jIGZ1bmN0aW9uIGluc3BlY3RUeHBvb2woY2xpZW50KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ0eHBvb2xfaW5zcGVjdCIKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9sb2FkU3RhdGUuanMKICBhc3luYyBmdW5jdGlvbiBsb2FkU3RhdGUoY2xpZW50LCB7IHN0YXRlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbG9hZFN0YXRlYCwKICAgICAgcGFyYW1zOiBbc3RhdGVdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvbWluZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBtaW5lKGNsaWVudCwgeyBibG9ja3MsIGludGVydmFsIH0pIHsKICAgIGlmIChjbGllbnQubW9kZSA9PT0gImdhbmFjaGUiKQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXZtX21pbmUiLAogICAgICAgIHBhcmFtczogW3sgYmxvY2tzOiBudW1iZXJUb0hleChibG9ja3MpIH1dCiAgICAgIH0pOwogICAgZWxzZQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbWluZWAsCiAgICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoYmxvY2tzKSwgbnVtYmVyVG9IZXgoaW50ZXJ2YWwgfHwgMCldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZW1vdmVCbG9ja1RpbWVzdGFtcEludGVydmFsLmpzCiAgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZXNldC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlc2V0KGNsaWVudCwgeyBibG9ja051bWJlciwganNvblJwY1VybCB9ID0ge30pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVzZXRgLAogICAgICBwYXJhbXM6IFt7IGZvcmtpbmc6IHsgYmxvY2tOdW1iZXI6IE51bWJlcihibG9ja051bWJlciksIGpzb25ScGNVcmwgfSB9XQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3JldmVydC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJldmVydChjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1fcmV2ZXJ0IiwKICAgICAgcGFyYW1zOiBbaWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24uanMKICBpbml0X2V4dHJhY3QoKTsKICBpbml0X3RyYW5zYWN0aW9uUmVxdWVzdCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBkYXRhLCBmcm9tLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlLCAuLi5yZXN0IH0gPSBhcmdzOwogICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICBhY2Nlc3NMaXN0LAogICAgICBkYXRhLAogICAgICBmcm9tLAogICAgICBnYXMsCiAgICAgIGdhc1ByaWNlLAogICAgICBtYXhGZWVQZXJHYXMsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICBub25jZSwKICAgICAgdG8sCiAgICAgIHZhbHVlCiAgICB9KTsKICAgIGNvbnN0IGhhc2gzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24iLAogICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgfSk7CiAgICByZXR1cm4gaGFzaDM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEF1dG9taW5lLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0QXV0b21pbmUoY2xpZW50LCBlbmFibGVkKSB7CiAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJnYW5hY2hlIikgewogICAgICBpZiAoZW5hYmxlZCkKICAgICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIm1pbmVyX3N0YXJ0IiB9KTsKICAgICAgZWxzZQogICAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsgbWV0aG9kOiAibWluZXJfc3RvcCIgfSk7CiAgICB9IGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV2bV9zZXRBdXRvbWluZSIsCiAgICAgICAgcGFyYW1zOiBbZW5hYmxlZF0KICAgICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEJhbGFuY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0QmFsYW5jZShjbGllbnQsIHsgYWRkcmVzcywgdmFsdWUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudEJhbGFuY2UiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIG51bWJlclRvSGV4KHZhbHVlKV0KICAgICAgfSk7CiAgICBlbHNlCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRCYWxhbmNlYCwKICAgICAgICBwYXJhbXM6IFthZGRyZXNzLCBudW1iZXJUb0hleCh2YWx1ZSldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRCbG9ja0dhc0xpbWl0LmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCB7IGdhc0xpbWl0IH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NldEJsb2NrR2FzTGltaXQiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNMaW1pdCldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrVGltZXN0YW1wSW50ZXJ2YWwoY2xpZW50LCB7IGludGVydmFsIH0pIHsKICAgIGNvbnN0IGludGVydmFsXyA9ICgoKSA9PiB7CiAgICAgIGlmIChjbGllbnQubW9kZSA9PT0gImhhcmRoYXQiKQogICAgICAgIHJldHVybiBpbnRlcnZhbCAqIDFlMzsKICAgICAgcmV0dXJuIGludGVydmFsOwogICAgfSkoKTsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRDb2RlLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0Q29kZShjbGllbnQsIHsgYWRkcmVzcywgYnl0ZWNvZGUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudENvZGUiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICAgIGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvZGVgLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0Q29pbmJhc2UuanMKICBhc3luYyBmdW5jdGlvbiBzZXRDb2luYmFzZShjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvaW5iYXNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzc10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRJbnRlcnZhbE1pbmluZy5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEludGVydmFsTWluaW5nKGNsaWVudCwgeyBpbnRlcnZhbCB9KSB7CiAgICBjb25zdCBpbnRlcnZhbF8gPSAoKCkgPT4gewogICAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJoYXJkaGF0IikKICAgICAgICByZXR1cm4gaW50ZXJ2YWwgKiAxZTM7CiAgICAgIHJldHVybiBpbnRlcnZhbDsKICAgIH0pKCk7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXRJbnRlcnZhbE1pbmluZyIsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRMb2dnaW5nRW5hYmxlZC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgZW5hYmxlZCkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRMb2dnaW5nRW5hYmxlZGAsCiAgICAgIHBhcmFtczogW2VuYWJsZWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TWluR2FzUHJpY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0TWluR2FzUHJpY2UoY2xpZW50LCB7IGdhc1ByaWNlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TWluR2FzUHJpY2VgLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNQcmljZSldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhcy5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgeyBiYXNlRmVlUGVyR2FzIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhc2AsCiAgICAgIHBhcmFtczogW251bWJlclRvSGV4KGJhc2VGZWVQZXJHYXMpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5leHRCbG9ja1RpbWVzdGFtcC5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tUaW1lc3RhbXAoY2xpZW50LCB7IHRpbWVzdGFtcCB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXROZXh0QmxvY2tUaW1lc3RhbXAiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleCh0aW1lc3RhbXApXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5vbmNlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldE5vbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBub25jZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldE5vbmNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgbnVtYmVyVG9IZXgobm9uY2UpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldFJwY1VybC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldFJwY1VybChjbGllbnQsIGpzb25ScGNVcmwpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0UnBjVXJsYCwKICAgICAgcGFyYW1zOiBbanNvblJwY1VybF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBpbmRleDogaW5kZXgyLCB2YWx1ZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldFN0b3JhZ2VBdGAsCiAgICAgIHBhcmFtczogWwogICAgICAgIGFkZHJlc3MsCiAgICAgICAgdHlwZW9mIGluZGV4MiA9PT0gIm51bWJlciIgPyBudW1iZXJUb0hleChpbmRleDIpIDogaW5kZXgyLAogICAgICAgIHZhbHVlCiAgICAgIF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zbmFwc2hvdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNuYXBzaG90KGNsaWVudCkgewogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NuYXBzaG90IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvdGVzdC5qcwogIGZ1bmN0aW9uIHRlc3RBY3Rpb25zKHsgbW9kZTogbW9kZTIgfSkgewogICAgcmV0dXJuIChjbGllbnRfKSA9PiB7CiAgICAgIGNvbnN0IGNsaWVudCA9IGNsaWVudF8uZXh0ZW5kKCgpID0+ICh7CiAgICAgICAgbW9kZTogbW9kZTIKICAgICAgfSkpOwogICAgICByZXR1cm4gewogICAgICAgIGRyb3BUcmFuc2FjdGlvbjogKGFyZ3MpID0+IGRyb3BUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICAgIGR1bXBTdGF0ZTogKCkgPT4gZHVtcFN0YXRlKGNsaWVudCksCiAgICAgICAgZ2V0QXV0b21pbmU6ICgpID0+IGdldEF1dG9taW5lKGNsaWVudCksCiAgICAgICAgZ2V0VHhwb29sQ29udGVudDogKCkgPT4gZ2V0VHhwb29sQ29udGVudChjbGllbnQpLAogICAgICAgIGdldFR4cG9vbFN0YXR1czogKCkgPT4gZ2V0VHhwb29sU3RhdHVzKGNsaWVudCksCiAgICAgICAgaW1wZXJzb25hdGVBY2NvdW50OiAoYXJncykgPT4gaW1wZXJzb25hdGVBY2NvdW50KGNsaWVudCwgYXJncyksCiAgICAgICAgaW5jcmVhc2VUaW1lOiAoYXJncykgPT4gaW5jcmVhc2VUaW1lKGNsaWVudCwgYXJncyksCiAgICAgICAgaW5zcGVjdFR4cG9vbDogKCkgPT4gaW5zcGVjdFR4cG9vbChjbGllbnQpLAogICAgICAgIGxvYWRTdGF0ZTogKGFyZ3MpID0+IGxvYWRTdGF0ZShjbGllbnQsIGFyZ3MpLAogICAgICAgIG1pbmU6IChhcmdzKSA9PiBtaW5lKGNsaWVudCwgYXJncyksCiAgICAgICAgcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbDogKCkgPT4gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpLAogICAgICAgIHJlc2V0OiAoYXJncykgPT4gcmVzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgICByZXZlcnQ6IChhcmdzKSA9PiByZXZlcnQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZW5kVW5zaWduZWRUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QXV0b21pbmU6IChhcmdzKSA9PiBzZXRBdXRvbWluZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEJhbGFuY2U6IChhcmdzKSA9PiBzZXRCYWxhbmNlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QmxvY2tHYXNMaW1pdDogKGFyZ3MpID0+IHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRCbG9ja1RpbWVzdGFtcEludGVydmFsOiAoYXJncykgPT4gc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldENvZGU6IChhcmdzKSA9PiBzZXRDb2RlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Q29pbmJhc2U6IChhcmdzKSA9PiBzZXRDb2luYmFzZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEludGVydmFsTWluaW5nOiAoYXJncykgPT4gc2V0SW50ZXJ2YWxNaW5pbmcoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRMb2dnaW5nRW5hYmxlZDogKGFyZ3MpID0+IHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TWluR2FzUHJpY2U6IChhcmdzKSA9PiBzZXRNaW5HYXNQcmljZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldE5leHRCbG9ja0Jhc2VGZWVQZXJHYXM6IChhcmdzKSA9PiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TmV4dEJsb2NrVGltZXN0YW1wOiAoYXJncykgPT4gc2V0TmV4dEJsb2NrVGltZXN0YW1wKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Tm9uY2U6IChhcmdzKSA9PiBzZXROb25jZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFJwY1VybDogKGFyZ3MpID0+IHNldFJwY1VybChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFN0b3JhZ2VBdDogKGFyZ3MpID0+IHNldFN0b3JhZ2VBdChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNuYXBzaG90OiAoKSA9PiBzbmFwc2hvdChjbGllbnQpLAogICAgICAgIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudDogKGFyZ3MpID0+IHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIGFyZ3MpCiAgICAgIH07CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlVGVzdENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRlc3RDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBrZXkgPSAidGVzdCIsIG5hbWUgPSAiVGVzdCBDbGllbnQiLCBtb2RlOiBtb2RlMiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNsaWVudCA9IGNyZWF0ZUNsaWVudCh7CiAgICAgIC4uLnBhcmFtZXRlcnMsCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgdHlwZTogInRlc3RDbGllbnQiCiAgICB9KTsKICAgIHJldHVybiBjbGllbnQuZXh0ZW5kKChjb25maWcpID0+ICh7CiAgICAgIG1vZGU6IG1vZGUyLAogICAgICAuLi50ZXN0QWN0aW9ucyh7IG1vZGU6IG1vZGUyIH0pKGNvbmZpZykKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9kZXBsb3lDb250cmFjdC5qcwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGZ1bmN0aW9uIGRlcGxveUNvbnRyYWN0KHdhbGxldENsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlLCAuLi5yZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVEZXBsb3lEYXRhKHsgYWJpOiBhYmkyLCBhcmdzLCBieXRlY29kZSB9KTsKICAgIHJldHVybiBzZW5kVHJhbnNhY3Rpb24od2FsbGV0Q2xpZW50LCB7CiAgICAgIC4uLnJlcXVlc3QsCiAgICAgIGRhdGE6IGNhbGxkYXRhCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRBZGRyZXNzZXMuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBpZiAoY2xpZW50LmFjY291bnQ/LnR5cGUgPT09ICJsb2NhbCIpCiAgICAgIHJldHVybiBbY2xpZW50LmFjY291bnQuYWRkcmVzc107CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9hY2NvdW50cyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gYWRkcmVzc2VzLm1hcCgoYWRkcmVzcykgPT4gY2hlY2tzdW1BZGRyZXNzKGFkZHJlc3MpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldFBlcm1pc3Npb25zKGNsaWVudCkgewogICAgY29uc3QgcGVybWlzc2lvbnMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIndhbGxldF9nZXRQZXJtaXNzaW9ucyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gcGVybWlzc2lvbnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcmVxdWVzdEFkZHJlc3Nlcy5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9yZXF1ZXN0QWNjb3VudHMiIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogICAgcmV0dXJuIGFkZHJlc3Nlcy5tYXAoKGFkZHJlc3MpID0+IGdldEFkZHJlc3MoYWRkcmVzcykpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3JlcXVlc3RQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIHBlcm1pc3Npb25zKSB7CiAgICByZXR1cm4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfcmVxdWVzdFBlcm1pc3Npb25zIiwKICAgICAgcGFyYW1zOiBbcGVybWlzc2lvbnNdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduTWVzc2FnZShjbGllbnQsIHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgbWVzc2FnZSB9KSB7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBpZiAoYWNjb3VudC5zaWduTWVzc2FnZSkKICAgICAgcmV0dXJuIGFjY291bnQuc2lnbk1lc3NhZ2UoeyBtZXNzYWdlIH0pOwogICAgY29uc3QgbWVzc2FnZV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBzdHJpbmdUb0hleChtZXNzYWdlKTsKICAgICAgaWYgKG1lc3NhZ2UucmF3IGluc3RhbmNlb2YgVWludDhBcnJheSkKICAgICAgICByZXR1cm4gdG9IZXgobWVzc2FnZS5yYXcpOwogICAgICByZXR1cm4gbWVzc2FnZS5yYXc7CiAgICB9KSgpOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAicGVyc29uYWxfc2lnbiIsCiAgICAgIHBhcmFtczogW21lc3NhZ2VfLCBhY2NvdW50LmFkZHJlc3NdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnblRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X3RvSGV4KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduVHJhbnNhY3Rpb24oY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGNoYWluID0gY2xpZW50LmNoYWluLCAuLi50cmFuc2FjdGlvbiB9ID0gcGFyYW1ldGVyczsKICAgIGlmICghYWNjb3VudF8pCiAgICAgIHRocm93IG5ldyBBY2NvdW50Tm90Rm91bmRFcnJvcih7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9hY3Rpb25zL3dhbGxldC9zaWduVHJhbnNhY3Rpb24iCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBhc3NlcnRSZXF1ZXN0KHsKICAgICAgYWNjb3VudCwKICAgICAgLi4ucGFyYW1ldGVycwogICAgfSk7CiAgICBjb25zdCBjaGFpbklkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q2hhaW5JZCwgImdldENoYWluSWQiKSh7fSk7CiAgICBpZiAoY2hhaW4gIT09IG51bGwpCiAgICAgIGFzc2VydEN1cnJlbnRDaGFpbih7CiAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgY2hhaW4KICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXR0ZXJzNCA9IGNoYWluPy5mb3JtYXR0ZXJzIHx8IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVyczsKICAgIGNvbnN0IGZvcm1hdCA9IGZvcm1hdHRlcnM0Py50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdCB8fCBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3Q7CiAgICBpZiAoYWNjb3VudC5zaWduVHJhbnNhY3Rpb24pCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UcmFuc2FjdGlvbih7CiAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgY2hhaW5JZAogICAgICB9LCB7IHNlcmlhbGl6ZXI6IGNsaWVudC5jaGFpbj8uc2VyaWFsaXplcnM/LnRyYW5zYWN0aW9uIH0pOwogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIC4uLmZvcm1hdCh0cmFuc2FjdGlvbiksCiAgICAgICAgICBjaGFpbklkOiBudW1iZXJUb0hleChjaGFpbklkKSwKICAgICAgICAgIGZyb206IGFjY291bnQuYWRkcmVzcwogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3NpZ25UeXBlZERhdGEuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNpZ25UeXBlZERhdGEoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnblR5cGVkRGF0YSIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gcGFyc2VBY2NvdW50KGFjY291bnRfKTsKICAgIGNvbnN0IHR5cGVzID0gewogICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pLAogICAgICAuLi5wYXJhbWV0ZXJzLnR5cGVzCiAgICB9OwogICAgdmFsaWRhdGVUeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGlmIChhY2NvdW50LnNpZ25UeXBlZERhdGEpCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGNvbnN0IHR5cGVkRGF0YSA9IHNlcmlhbGl6ZVR5cGVkRGF0YSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UeXBlZERhdGFfdjQiLAogICAgICBwYXJhbXM6IFthY2NvdW50LmFkZHJlc3MsIHR5cGVkRGF0YV0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zd2l0Y2hDaGFpbi5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzd2l0Y2hDaGFpbihjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfc3dpdGNoRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKQogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dhdGNoQXNzZXQuanMKICBhc3luYyBmdW5jdGlvbiB3YXRjaEFzc2V0KGNsaWVudCwgcGFyYW1zKSB7CiAgICBjb25zdCBhZGRlZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAid2FsbGV0X3dhdGNoQXNzZXQiLAogICAgICBwYXJhbXMKICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgIHJldHVybiBhZGRlZDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvd2FsbGV0LmpzCiAgZnVuY3Rpb24gd2FsbGV0QWN0aW9ucyhjbGllbnQpIHsKICAgIHJldHVybiB7CiAgICAgIGFkZENoYWluOiAoYXJncykgPT4gYWRkQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgZGVwbG95Q29udHJhY3Q6IChhcmdzKSA9PiBkZXBsb3lDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRBZGRyZXNzZXM6ICgpID0+IGdldEFkZHJlc3NlcyhjbGllbnQpLAogICAgICBnZXRDaGFpbklkOiAoKSA9PiBnZXRDaGFpbklkKGNsaWVudCksCiAgICAgIGdldFBlcm1pc3Npb25zOiAoKSA9PiBnZXRQZXJtaXNzaW9ucyhjbGllbnQpLAogICAgICBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0OiAoYXJncykgPT4gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpLAogICAgICByZXF1ZXN0QWRkcmVzc2VzOiAoKSA9PiByZXF1ZXN0QWRkcmVzc2VzKGNsaWVudCksCiAgICAgIHJlcXVlc3RQZXJtaXNzaW9uczogKGFyZ3MpID0+IHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIGFyZ3MpLAogICAgICBzZW5kUmF3VHJhbnNhY3Rpb246IChhcmdzKSA9PiBzZW5kUmF3VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgc2VuZFRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25NZXNzYWdlOiAoYXJncykgPT4gc2lnbk1lc3NhZ2UoY2xpZW50LCBhcmdzKSwKICAgICAgc2lnblRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2lnblRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25UeXBlZERhdGE6IChhcmdzKSA9PiBzaWduVHlwZWREYXRhKGNsaWVudCwgYXJncyksCiAgICAgIHN3aXRjaENoYWluOiAoYXJncykgPT4gc3dpdGNoQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgd2F0Y2hBc3NldDogKGFyZ3MpID0+IHdhdGNoQXNzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgd3JpdGVDb250cmFjdDogKGFyZ3MpID0+IHdyaXRlQ29udHJhY3QoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVdhbGxldENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVdhbGxldENsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJ3YWxsZXQiLCBuYW1lID0gIldhbGxldCBDbGllbnQiLCB0cmFuc3BvcnQgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjbGllbnQgPSBjcmVhdGVDbGllbnQoewogICAgICAuLi5wYXJhbWV0ZXJzLAogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHRyYW5zcG9ydCwKICAgICAgdHlwZTogIndhbGxldENsaWVudCIKICAgIH0pOwogICAgcmV0dXJuIGNsaWVudC5leHRlbmQod2FsbGV0QWN0aW9ucyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL3dlYlNvY2tldC5qcwogIGluaXRfcmVxdWVzdCgpOwogIGZ1bmN0aW9uIHdlYlNvY2tldCh1cmwsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtlZXBBbGl2ZSwga2V5ID0gIndlYlNvY2tldCIsIG5hbWUgPSAiV2ViU29ja2V0IEpTT04tUlBDIiwgcmVjb25uZWN0LCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHJldHJ5Q291bnQgPSBjb25maWcucmV0cnlDb3VudCA/PyByZXRyeUNvdW50XzsKICAgICAgY29uc3QgdGltZW91dCA9IHRpbWVvdXRfID8/IGNvbmZpZy50aW1lb3V0ID8/IDFlNDsKICAgICAgY29uc3QgdXJsXyA9IHVybCB8fCBjaGFpbj8ucnBjVXJscy5kZWZhdWx0LndlYlNvY2tldD8uWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydCh7CiAgICAgICAga2V5LAogICAgICAgIG5hbWUsCiAgICAgICAgYXN5bmMgcmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pIHsKICAgICAgICAgIGNvbnN0IGJvZHkgPSB7IG1ldGhvZCwgcGFyYW1zIH07CiAgICAgICAgICBjb25zdCBycGNDbGllbnQgPSBhd2FpdCBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsXywgewogICAgICAgICAgICBrZWVwQWxpdmUsCiAgICAgICAgICAgIHJlY29ubmVjdAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCB7IGVycm9yLCByZXN1bHQgfSA9IGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0QXN5bmMoewogICAgICAgICAgICBib2R5LAogICAgICAgICAgICB0aW1lb3V0CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogIndlYlNvY2tldCIKICAgICAgfSwgewogICAgICAgIGdldFNvY2tldCgpIHsKICAgICAgICAgIHJldHVybiBnZXRTb2NrZXQodXJsXyk7CiAgICAgICAgfSwKICAgICAgICBnZXRScGNDbGllbnQoKSB7CiAgICAgICAgICByZXR1cm4gZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgc3Vic2NyaWJlKHsgcGFyYW1zLCBvbkRhdGEsIG9uRXJyb3IgfSkgewogICAgICAgICAgY29uc3QgcnBjQ2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgICAgY29uc3QgeyByZXN1bHQ6IHN1YnNjcmlwdGlvbklkIH0gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIGJvZHk6IHsKICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfc3Vic2NyaWJlIiwKICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsKICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZS5lcnJvcik7CiAgICAgICAgICAgICAgICBvbkVycm9yPy4ocmVzcG9uc2UuZXJyb3IpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmlkID09PSAibnVtYmVyIikgewogICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5tZXRob2QgIT09ICJldGhfc3Vic2NyaXB0aW9uIikKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBvbkRhdGEocmVzcG9uc2UucGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQsCiAgICAgICAgICAgIGFzeW5jIHVuc3Vic2NyaWJlKCkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcnBjQ2xpZW50LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfdW5zdWJzY3JpYmUiLAogICAgICAgICAgICAgICAgICBwYXJhbXM6IFtzdWJzY3JpcHRpb25JZF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiByZXNvbHZlCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hYmlzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWRkcmVzcy5qcwogIHZhciB6ZXJvQWRkcmVzcyA9ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfdW5pdCgpOwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9ycGMoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9lbmNvZGluZygpOwogIGluaXRfbm9kZSgpOwogIGluaXRfcmVxdWVzdCgpOwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2RhdGEoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3R5cGVzL2VpcDExOTMuanMKICB2YXIgUHJvdmlkZXJScGNFcnJvcjIgPSBjbGFzcyBleHRlbmRzIEVycm9yIHsKICAgIGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UpIHsKICAgICAgc3VwZXIobWVzc2FnZSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICB9KTsKICAgICAgdGhpcy5jb2RlID0gY29kZTsKICAgICAgdGhpcy5kZXRhaWxzID0gbWVzc2FnZTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVEZXBsb3lEYXRhLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKICB2YXIgZG9jc1BhdGg4ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZURlcGxveURhdGEiOwogIGZ1bmN0aW9uIGRlY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGJ5dGVjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKGRhdGEgPT09IGJ5dGVjb2RlKQogICAgICByZXR1cm4geyBieXRlY29kZSB9OwogICAgY29uc3QgZGVzY3JpcHRpb24gPSBhYmkyLmZpbmQoKHgpID0+ICJ0eXBlIiBpbiB4ICYmIHgudHlwZSA9PT0gImNvbnN0cnVjdG9yIik7CiAgICBpZiAoIWRlc2NyaXB0aW9uKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGlmICghKCJpbnB1dHMiIGluIGRlc2NyaXB0aW9uKSkKICAgICAgdGhyb3cgbmV3IEFiaUNvbnN0cnVjdG9yUGFyYW1zTm90Rm91bmRFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDggfSk7CiAgICBpZiAoIWRlc2NyaXB0aW9uLmlucHV0cyB8fCBkZXNjcmlwdGlvbi5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGNvbnN0IGFyZ3MgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgYDB4JHtkYXRhLnJlcGxhY2UoYnl0ZWNvZGUsICIiKX1gKTsKICAgIHJldHVybiB7IGFyZ3MsIGJ5dGVjb2RlIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9jb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gY29tcGFjdFNpZ25hdHVyZVRvU2lnbmF0dXJlKHsgciwgeVBhcml0eUFuZFMgfSkgewogICAgY29uc3QgeVBhcml0eUFuZFNfYnl0ZXMgPSBoZXhUb0J5dGVzKHlQYXJpdHlBbmRTKTsKICAgIGNvbnN0IHlQYXJpdHkgPSB5UGFyaXR5QW5kU19ieXRlc1swXSAmIDEyOCA/IDEgOiAwOwogICAgY29uc3QgcyA9IHlQYXJpdHlBbmRTX2J5dGVzOwogICAgaWYgKHlQYXJpdHkgPT09IDEpCiAgICAgIHNbMF0gJj0gMTI3OwogICAgcmV0dXJuIHsgciwgczogYnl0ZXNUb0hleChzKSwgeVBhcml0eSB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9wYXJzZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBwYXJzZUNvbXBhY3RTaWduYXR1cmUoc2lnbmF0dXJlSGV4KSB7CiAgICBjb25zdCB7IHIsIHMgfSA9IHNlY3AyNTZrMS5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnNsaWNlKDIsIDEzMCkpOwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eUFuZFM6IG51bWJlclRvSGV4KHMsIHsgc2l6ZTogMzIgfSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlU2lnbmF0dXJlLmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VTaWduYXR1cmUyKHNpZ25hdHVyZUhleCkgewogICAgY29uc3QgeyByLCBzIH0gPSBzZWNwMjU2azEuU2lnbmF0dXJlLmZyb21Db21wYWN0KHNpZ25hdHVyZUhleC5zbGljZSgyLCAxMzApKTsKICAgIGNvbnN0IHlQYXJpdHlPclYgPSBOdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgIGNvbnN0IFt2LCB5UGFyaXR5XSA9ICgoKSA9PiB7CiAgICAgIGlmICh5UGFyaXR5T3JWID09PSAwIHx8IHlQYXJpdHlPclYgPT09IDEpCiAgICAgICAgcmV0dXJuIFt2b2lkIDAsIHlQYXJpdHlPclZdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjcpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDBdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDFdOwogICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgeVBhcml0eU9yViB2YWx1ZSIpOwogICAgfSkoKTsKICAgIGlmICh0eXBlb2YgdiAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiB7CiAgICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgICBzOiBudW1iZXJUb0hleChzLCB7IHNpemU6IDMyIH0pLAogICAgICAgIHYsCiAgICAgICAgeVBhcml0eQogICAgICB9OwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgczogbnVtYmVyVG9IZXgocywgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcy5qcwogIGluaXRfa2VjY2FrMjU2KCk7CiAgYXN5bmMgZnVuY3Rpb24gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgc2lnbmF0dXJlOiBzaWduYXR1cmVfIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSBwYXJzZVRyYW5zYWN0aW9uKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVfID8/IHsKICAgICAgcjogdHJhbnNhY3Rpb24uciwKICAgICAgczogdHJhbnNhY3Rpb24ucywKICAgICAgdjogdHJhbnNhY3Rpb24udiwKICAgICAgeVBhcml0eTogdHJhbnNhY3Rpb24ueVBhcml0eQogICAgfTsKICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBzZXJpYWxpemVUcmFuc2FjdGlvbih7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICByOiB2b2lkIDAsCiAgICAgIHM6IHZvaWQgMCwKICAgICAgdjogdm9pZCAwLAogICAgICB5UGFyaXR5OiB2b2lkIDAsCiAgICAgIHNpZGVjYXJzOiB2b2lkIDAKICAgIH0pOwogICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsKICAgICAgaGFzaDoga2VjY2FrMjU2KHNlcmlhbGl6ZWQpLAogICAgICBzaWduYXR1cmUKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zaWduYXR1cmVUb0NvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgY29uc3QgeyByLCBzLCB2LCB5UGFyaXR5IH0gPSBzaWduYXR1cmU7CiAgICBjb25zdCB5UGFyaXR5XyA9IE51bWJlcih5UGFyaXR5ID8/IHYgLSAyN24pOwogICAgbGV0IHlQYXJpdHlBbmRTID0gczsKICAgIGlmICh5UGFyaXR5XyA9PT0gMSkgewogICAgICBjb25zdCBieXRlczIgPSBoZXhUb0J5dGVzKHMpOwogICAgICBieXRlczJbMF0gfD0gMTI4OwogICAgICB5UGFyaXR5QW5kUyA9IGJ5dGVzVG9IZXgoYnl0ZXMyKTsKICAgIH0KICAgIHJldHVybiB7IHIsIHlQYXJpdHlBbmRTIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3NlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUoeyByLCB5UGFyaXR5QW5kUyB9KSB7CiAgICByZXR1cm4gYDB4JHtuZXcgc2VjcDI1NmsxLlNpZ25hdHVyZShoZXhUb0JpZ0ludChyKSwgaGV4VG9CaWdJbnQoeVBhcml0eUFuZFMpKS50b0NvbXBhY3RIZXgoKX1gOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfZnJvbUJ5dGVzKCk7CiAgaW5pdF9jY2lwMigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9zaWRlY2Fyc1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNpZGVjYXJzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHNpZGVjYXJzWzBdLmJsb2IgPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGhhc2hlcyA9IFtdOwogICAgZm9yIChjb25zdCB7IGNvbW1pdG1lbnQgfSBvZiBzaWRlY2FycykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9mcm9tQmxvYnMuanMKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbUJsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGxlbmd0aCA9IGJsb2JzLnJlZHVjZSgobGVuZ3RoMiwgYmxvYikgPT4gbGVuZ3RoMiArIGJsb2IubGVuZ3RoLCAwKTsKICAgIGNvbnN0IGRhdGEgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkobGVuZ3RoKSk7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykgewogICAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IoYmxvYik7CiAgICAgIHdoaWxlIChhY3RpdmUgJiYgY3Vyc29yLnBvc2l0aW9uIDwgYmxvYi5sZW5ndGgpIHsKICAgICAgICBjdXJzb3IuaW5jcmVtZW50UG9zaXRpb24oMSk7CiAgICAgICAgbGV0IGNvbnN1bWUgPSAzMTsKICAgICAgICBpZiAoYmxvYi5sZW5ndGggLSBjdXJzb3IucG9zaXRpb24gPCAzMSkKICAgICAgICAgIGNvbnN1bWUgPSBibG9iLmxlbmd0aCAtIGN1cnNvci5wb3NpdGlvbjsKICAgICAgICBmb3IgKGNvbnN0IF8gaW4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29uc3VtZSB9KSkgewogICAgICAgICAgY29uc3QgYnl0ZSA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgICAgICAgY29uc3QgaXNUZXJtaW5hdG9yID0gYnl0ZSA9PT0gMTI4ICYmICFjdXJzb3IuaW5zcGVjdEJ5dGVzKGN1cnNvci5yZW1haW5pbmcpLmluY2x1ZGVzKDEyOCk7CiAgICAgICAgICBpZiAoaXNUZXJtaW5hdG9yKSB7CiAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGRhdGEucHVzaEJ5dGUoYnl0ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25zdCB0cmltbWVkRGF0YSA9IGRhdGEuYnl0ZXMuc2xpY2UoMCwgZGF0YS5wb3NpdGlvbik7CiAgICByZXR1cm4gdG8gPT09ICJoZXgiID8gYnl0ZXNUb0hleCh0cmltbWVkRGF0YSkgOiB0cmltbWVkRGF0YTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9remcvZGVmaW5lS3pnLmpzCiAgZnVuY3Rpb24gZGVmaW5lS3pnKHsgYmxvYlRvS3pnQ29tbWl0bWVudCwgY29tcHV0ZUJsb2JLemdQcm9vZiB9KSB7CiAgICByZXR1cm4gewogICAgICBibG9iVG9LemdDb21taXRtZW50LAogICAgICBjb21wdXRlQmxvYkt6Z1Byb29mCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2t6Zy9zZXR1cEt6Zy5qcwogIGZ1bmN0aW9uIHNldHVwS3pnKHBhcmFtZXRlcnMsIHBhdGgpIHsKICAgIHRyeSB7CiAgICAgIHBhcmFtZXRlcnMubG9hZFRydXN0ZWRTZXR1cChwYXRoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc3QgZXJyb3IgPSBlOwogICAgICBpZiAoIWVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoInRydXN0ZWQgc2V0dXAgaXMgYWxyZWFkeSBsb2FkZWQiKSkKICAgICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICAgIHJldHVybiBkZWZpbmVLemcocGFyYW1ldGVycyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X2Zvcm1hdEV0aGVyKCk7CiAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgaW5pdF9mb3JtYXRVbml0cygpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF90b0Z1bmN0aW9uU2VsZWN0b3IoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3BhZCgpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3N0cmluZ2lmeSgpOwogIGluaXRfdHJpbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2luZGV4LmpzCiAgdmFyIGNoYWluc19leHBvcnRzID0ge307CiAgX19leHBvcnQoY2hhaW5zX2V4cG9ydHMsIHsKICAgIGFic3RyYWN0VGVzdG5ldDogKCkgPT4gYWJzdHJhY3RUZXN0bmV0LAogICAgYWNhbGE6ICgpID0+IGFjYWxhLAogICAgYWxpZW54OiAoKSA9PiBhbGllbngsCiAgICBhbGllbnhIYWxUZXN0bmV0OiAoKSA9PiBhbGllbnhIYWxUZXN0bmV0LAogICAgYW5jaWVudDg6ICgpID0+IGFuY2llbnQ4LAogICAgYW5jaWVudDhTZXBvbGlhOiAoKSA9PiBhbmNpZW50OFNlcG9saWEsCiAgICBhbnZpbDogKCkgPT4gYW52aWwsCiAgICBhcGVDaGFpbjogKCkgPT4gYXBlQ2hhaW4sCiAgICBhcGV4VGVzdG5ldDogKCkgPT4gYXBleFRlc3RuZXQsCiAgICBhcmJpdHJ1bTogKCkgPT4gYXJiaXRydW0sCiAgICBhcmJpdHJ1bUdvZXJsaTogKCkgPT4gYXJiaXRydW1Hb2VybGksCiAgICBhcmJpdHJ1bU5vdmE6ICgpID0+IGFyYml0cnVtTm92YSwKICAgIGFyYml0cnVtU2Vwb2xpYTogKCkgPT4gYXJiaXRydW1TZXBvbGlhLAogICAgYXJlb25OZXR3b3JrOiAoKSA9PiBhcmVvbk5ldHdvcmssCiAgICBhcmVvbk5ldHdvcmtUZXN0bmV0OiAoKSA9PiBhcmVvbk5ldHdvcmtUZXN0bmV0LAogICAgYXJ0ZWxhVGVzdG5ldDogKCkgPT4gYXJ0ZWxhVGVzdG5ldCwKICAgIGFzc2V0Q2hhaW46ICgpID0+IGFzc2V0Q2hhaW4sCiAgICBhc3NldENoYWluVGVzdG5ldDogKCkgPT4gYXNzZXRDaGFpblRlc3RuZXQsCiAgICBhc3RhcjogKCkgPT4gYXN0YXIsCiAgICBhc3RhclprRVZNOiAoKSA9PiBhc3RhclprRVZNLAogICAgYXN0YXJaa3lvdG86ICgpID0+IGFzdGFyWmt5b3RvLAogICAgYXRsZXRhT2x5bXBpYTogKCkgPT4gYXRsZXRhT2x5bXBpYSwKICAgIGF1cm9yYTogKCkgPT4gYXVyb3JhLAogICAgYXVyb3JhVGVzdG5ldDogKCkgPT4gYXVyb3JhVGVzdG5ldCwKICAgIGF1cm9yaWE6ICgpID0+IGF1cm9yaWEsCiAgICBhdmFsYW5jaGU6ICgpID0+IGF2YWxhbmNoZSwKICAgIGF2YWxhbmNoZUZ1amk6ICgpID0+IGF2YWxhbmNoZUZ1amksCiAgICBiMzogKCkgPT4gYjMsCiAgICBiM1NlcG9saWE6ICgpID0+IGIzU2Vwb2xpYSwKICAgIGJhaGFtdXQ6ICgpID0+IGJhaGFtdXQsCiAgICBiYXNlOiAoKSA9PiBiYXNlLAogICAgYmFzZUdvZXJsaTogKCkgPT4gYmFzZUdvZXJsaSwKICAgIGJhc2VTZXBvbGlhOiAoKSA9PiBiYXNlU2Vwb2xpYSwKICAgIGJlYW06ICgpID0+IGJlYW0sCiAgICBiZWFtVGVzdG5ldDogKCkgPT4gYmVhbVRlc3RuZXQsCiAgICBiZWFyTmV0d29ya0NoYWluTWFpbm5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpbk1haW5uZXQsCiAgICBiZWFyTmV0d29ya0NoYWluVGVzdG5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpblRlc3RuZXQsCiAgICBiZXJhY2hhaW5UZXN0bmV0OiAoKSA9PiBiZXJhY2hhaW5UZXN0bmV0LAogICAgYmVyYWNoYWluVGVzdG5ldGJBcnRpbzogKCkgPT4gYmVyYWNoYWluVGVzdG5ldGJBcnRpbywKICAgIGJldm1NYWlubmV0OiAoKSA9PiBiZXZtTWFpbm5ldCwKICAgIGJpZnJvc3Q6ICgpID0+IGJpZnJvc3QsCiAgICBiaXRUb3JyZW50OiAoKSA9PiBiaXRUb3JyZW50LAogICAgYml0VG9ycmVudFRlc3RuZXQ6ICgpID0+IGJpdFRvcnJlbnRUZXN0bmV0LAogICAgYml0a3ViOiAoKSA9PiBiaXRrdWIsCiAgICBiaXRrdWJUZXN0bmV0OiAoKSA9PiBiaXRrdWJUZXN0bmV0LAogICAgYml0bGF5ZXI6ICgpID0+IGJpdGxheWVyLAogICAgYml0bGF5ZXJUZXN0bmV0OiAoKSA9PiBiaXRsYXllclRlc3RuZXQsCiAgICBiaXRyb2NrOiAoKSA9PiBiaXRyb2NrLAogICAgYmxhc3Q6ICgpID0+IGJsYXN0LAogICAgYmxhc3RTZXBvbGlhOiAoKSA9PiBibGFzdFNlcG9saWEsCiAgICBib2I6ICgpID0+IGJvYiwKICAgIGJvYlNlcG9saWE6ICgpID0+IGJvYlNlcG9saWEsCiAgICBib2JhOiAoKSA9PiBib2JhLAogICAgYm9iYVNlcG9saWE6ICgpID0+IGJvYmFTZXBvbGlhLAogICAgYm90YW5peFRlc3RuZXQ6ICgpID0+IGJvdGFuaXhUZXN0bmV0LAogICAgYm91bmNlQml0OiAoKSA9PiBib3VuY2VCaXQsCiAgICBib3VuY2VCaXRUZXN0bmV0OiAoKSA9PiBib3VuY2VCaXRUZXN0bmV0LAogICAgYnJvbm9zOiAoKSA9PiBicm9ub3MsCiAgICBicm9ub3NUZXN0bmV0OiAoKSA9PiBicm9ub3NUZXN0bmV0LAogICAgYnNjOiAoKSA9PiBic2MsCiAgICBic2NHcmVlbmZpZWxkOiAoKSA9PiBic2NHcmVlbmZpZWxkLAogICAgYnNjVGVzdG5ldDogKCkgPT4gYnNjVGVzdG5ldCwKICAgIGJzcXVhcmVkOiAoKSA9PiBic3F1YXJlZCwKICAgIGJzcXVhcmVkVGVzdG5ldDogKCkgPT4gYnNxdWFyZWRUZXN0bmV0LAogICAgYnRyOiAoKSA9PiBidHIsCiAgICBidHJUZXN0bmV0OiAoKSA9PiBidHJUZXN0bmV0LAogICAgYnhuOiAoKSA9PiBieG4sCiAgICBieG5UZXN0bmV0OiAoKSA9PiBieG5UZXN0bmV0LAogICAgY2Fubm9uOiAoKSA9PiBjYW5ub24sCiAgICBjYW50bzogKCkgPT4gY2FudG8sCiAgICBjZWxvOiAoKSA9PiBjZWxvLAogICAgY2Vsb0FsZmFqb3JlczogKCkgPT4gY2Vsb0FsZmFqb3JlcywKICAgIGNoYW5nOiAoKSA9PiBjaGFuZywKICAgIGNoaWxpejogKCkgPT4gY2hpbGl6LAogICAgY2hpcHM6ICgpID0+IGNoaXBzLAogICAgY2xhc3NpYzogKCkgPT4gY2xhc3NpYywKICAgIGNvbmZsdXhFU3BhY2U6ICgpID0+IGNvbmZsdXhFU3BhY2UsCiAgICBjb25mbHV4RVNwYWNlVGVzdG5ldDogKCkgPT4gY29uZmx1eEVTcGFjZVRlc3RuZXQsCiAgICBjb3JlRGFvOiAoKSA9PiBjb3JlRGFvLAogICAgY3JhYjogKCkgPT4gY3JhYiwKICAgIGNyb25vczogKCkgPT4gY3Jvbm9zLAogICAgY3Jvbm9zVGVzdG5ldDogKCkgPT4gY3Jvbm9zVGVzdG5ldCwKICAgIGNyb25vc3prRVZNOiAoKSA9PiBjcm9ub3N6a0VWTSwKICAgIGNyb25vc3prRVZNVGVzdG5ldDogKCkgPT4gY3Jvbm9zemtFVk1UZXN0bmV0LAogICAgY3Jvc3NiZWxsOiAoKSA9PiBjcm9zc2JlbGwsCiAgICBjdXJ0aXM6ICgpID0+IGN1cnRpcywKICAgIGN5YmVyOiAoKSA9PiBjeWJlciwKICAgIGN5YmVyVGVzdG5ldDogKCkgPT4gY3liZXJUZXN0bmV0LAogICAgZGFyd2luaWE6ICgpID0+IGRhcndpbmlhLAogICAgZGNoYWluOiAoKSA9PiBkY2hhaW4sCiAgICBkY2hhaW5UZXN0bmV0OiAoKSA9PiBkY2hhaW5UZXN0bmV0LAogICAgZGVmaWNoYWluRXZtOiAoKSA9PiBkZWZpY2hhaW5Fdm0sCiAgICBkZWZpY2hhaW5Fdm1UZXN0bmV0OiAoKSA9PiBkZWZpY2hhaW5Fdm1UZXN0bmV0LAogICAgZGVnZW46ICgpID0+IGRlZ2VuLAogICAgZGZrOiAoKSA9PiBkZmssCiAgICBkb2RvY2hhaW5UZXN0bmV0OiAoKSA9PiBkb2RvY2hhaW5UZXN0bmV0LAogICAgZG9nZWNoYWluOiAoKSA9PiBkb2dlY2hhaW4sCiAgICBkb3NDaGFpbjogKCkgPT4gZG9zQ2hhaW4sCiAgICBkb3NDaGFpblRlc3RuZXQ6ICgpID0+IGRvc0NoYWluVGVzdG5ldCwKICAgIGRyZXllcnhNYWlubmV0OiAoKSA9PiBkcmV5ZXJ4TWFpbm5ldCwKICAgIGRyZXllcnhUZXN0bmV0OiAoKSA9PiBkcmV5ZXJ4VGVzdG5ldCwKICAgIGR1c3Rib3lJb1Q6ICgpID0+IGR1c3Rib3lJb1QsCiAgICBkeW1lbnNpb246ICgpID0+IGR5bWVuc2lvbiwKICAgIGVkZ2VsZXNzOiAoKSA9PiBlZGdlbGVzcywKICAgIGVkZ2VsZXNzVGVzdG5ldDogKCkgPT4gZWRnZWxlc3NUZXN0bmV0LAogICAgZWRnZXdhcmU6ICgpID0+IGVkZ2V3YXJlLAogICAgZWRnZXdhcmVUZXN0bmV0OiAoKSA9PiBlZGdld2FyZVRlc3RuZXQsCiAgICBla3RhOiAoKSA9PiBla3RhLAogICAgZWt0YVRlc3RuZXQ6ICgpID0+IGVrdGFUZXN0bmV0LAogICAgZWxhc3RvczogKCkgPT4gZWxhc3RvcywKICAgIGVsYXN0b3NUZXN0bmV0OiAoKSA9PiBlbGFzdG9zVGVzdG5ldCwKICAgIGVsZWN0cm9uZXVtOiAoKSA9PiBlbGVjdHJvbmV1bSwKICAgIGVsZWN0cm9uZXVtVGVzdG5ldDogKCkgPT4gZWxlY3Ryb25ldW1UZXN0bmV0LAogICAgZWx5c2l1bVRlc3RuZXQ6ICgpID0+IGVseXNpdW1UZXN0bmV0LAogICAgZW9uOiAoKSA9PiBlb24sCiAgICBlb3M6ICgpID0+IGVvcywKICAgIGVvc1Rlc3RuZXQ6ICgpID0+IGVvc1Rlc3RuZXQsCiAgICBldGhlcmxpbms6ICgpID0+IGV0aGVybGluaywKICAgIGV0aGVybGlua1Rlc3RuZXQ6ICgpID0+IGV0aGVybGlua1Rlc3RuZXQsCiAgICBldm1vczogKCkgPT4gZXZtb3MsCiAgICBldm1vc1Rlc3RuZXQ6ICgpID0+IGV2bW9zVGVzdG5ldCwKICAgIGV4Y2Vsb25NYWlubmV0OiAoKSA9PiBleGNlbG9uTWFpbm5ldCwKICAgIGZhbnRvbTogKCkgPT4gZmFudG9tLAogICAgZmFudG9tU29uaWNUZXN0bmV0OiAoKSA9PiBmYW50b21Tb25pY1Rlc3RuZXQsCiAgICBmYW50b21UZXN0bmV0OiAoKSA9PiBmYW50b21UZXN0bmV0LAogICAgZmlibzogKCkgPT4gZmlibywKICAgIGZpbGVjb2luOiAoKSA9PiBmaWxlY29pbiwKICAgIGZpbGVjb2luQ2FsaWJyYXRpb246ICgpID0+IGZpbGVjb2luQ2FsaWJyYXRpb24sCiAgICBmaWxlY29pbkh5cGVyc3BhY2U6ICgpID0+IGZpbGVjb2luSHlwZXJzcGFjZSwKICAgIGZsYXJlOiAoKSA9PiBmbGFyZSwKICAgIGZsYXJlVGVzdG5ldDogKCkgPT4gZmxhcmVUZXN0bmV0LAogICAgZmxvd01haW5uZXQ6ICgpID0+IGZsb3dNYWlubmV0LAogICAgZmxvd1ByZXZpZXduZXQ6ICgpID0+IGZsb3dQcmV2aWV3bmV0LAogICAgZmxvd1Rlc3RuZXQ6ICgpID0+IGZsb3dUZXN0bmV0LAogICAgZmx1ZW5jZTogKCkgPT4gZmx1ZW5jZSwKICAgIGZsdWVuY2VTdGFnZTogKCkgPT4gZmx1ZW5jZVN0YWdlLAogICAgZmx1ZW5jZVRlc3RuZXQ6ICgpID0+IGZsdWVuY2VUZXN0bmV0LAogICAgZm9ybWE6ICgpID0+IGZvcm1hLAogICAgZm91bmRyeTogKCkgPT4gZm91bmRyeSwKICAgIGZyYXh0YWw6ICgpID0+IGZyYXh0YWwsCiAgICBmcmF4dGFsVGVzdG5ldDogKCkgPT4gZnJheHRhbFRlc3RuZXQsCiAgICBmdW5raU1haW5uZXQ6ICgpID0+IGZ1bmtpTWFpbm5ldCwKICAgIGZ1bmtpU2Vwb2xpYTogKCkgPT4gZnVua2lTZXBvbGlhLAogICAgZnVzZTogKCkgPT4gZnVzZSwKICAgIGZ1c2VTcGFya25ldDogKCkgPT4gZnVzZVNwYXJrbmV0LAogICAgZnVzaW9uOiAoKSA9PiBmdXNpb24sCiAgICBmdXNpb25UZXN0bmV0OiAoKSA9PiBmdXNpb25UZXN0bmV0LAogICAgZ2FybmV0OiAoKSA9PiBnYXJuZXQsCiAgICBnZW5lc3lzOiAoKSA9PiBnZW5lc3lzLAogICAgZ25vc2lzOiAoKSA9PiBnbm9zaXMsCiAgICBnbm9zaXNDaGlhZG86ICgpID0+IGdub3Npc0NoaWFkbywKICAgIGdvQ2hhaW46ICgpID0+IGdvQ2hhaW4sCiAgICBnb2JpOiAoKSA9PiBnb2JpLAogICAgZ29lcmxpOiAoKSA9PiBnb2VybGksCiAgICBncmF2aXR5OiAoKSA9PiBncmF2aXR5LAogICAgZ3VydVRlc3RuZXQ6ICgpID0+IGd1cnVUZXN0bmV0LAogICAgaGFtOiAoKSA9PiBoYW0sCiAgICBoYXFxTWFpbm5ldDogKCkgPT4gaGFxcU1haW5uZXQsCiAgICBoYXFxVGVzdGVkZ2UyOiAoKSA9PiBoYXFxVGVzdGVkZ2UyLAogICAgaGFyZGhhdDogKCkgPT4gaGFyZGhhdCwKICAgIGhhcm1vbnlPbmU6ICgpID0+IGhhcm1vbnlPbmUsCiAgICBoYXNoa2V5VGVzdG5ldDogKCkgPT4gaGFzaGtleVRlc3RuZXQsCiAgICBoZWRlcmE6ICgpID0+IGhlZGVyYSwKICAgIGhlZGVyYVByZXZpZXduZXQ6ICgpID0+IGhlZGVyYVByZXZpZXduZXQsCiAgICBoZWRlcmFUZXN0bmV0OiAoKSA9PiBoZWRlcmFUZXN0bmV0LAogICAgaGVsYTogKCkgPT4gaGVsYSwKICAgIGhlbWlTZXBvbGlhOiAoKSA9PiBoZW1pU2Vwb2xpYSwKICAgIGhvbGVza3k6ICgpID0+IGhvbGVza3ksCiAgICBoeWNoYWluOiAoKSA9PiBoeWNoYWluLAogICAgaHljaGFpblRlc3RuZXQ6ICgpID0+IGh5Y2hhaW5UZXN0bmV0LAogICAgaW1tdXRhYmxlWmtFdm06ICgpID0+IGltbXV0YWJsZVprRXZtLAogICAgaW1tdXRhYmxlWmtFdm1UZXN0bmV0OiAoKSA9PiBpbW11dGFibGVaa0V2bVRlc3RuZXQsCiAgICBpbkVWTTogKCkgPT4gaW5FVk0sCiAgICBpb3RhOiAoKSA9PiBpb3RhLAogICAgaW90YVRlc3RuZXQ6ICgpID0+IGlvdGFUZXN0bmV0LAogICAgaW90ZXg6ICgpID0+IGlvdGV4LAogICAgaW90ZXhUZXN0bmV0OiAoKSA9PiBpb3RleFRlc3RuZXQsCiAgICBqYmM6ICgpID0+IGpiYywKICAgIGpiY1Rlc3RuZXQ6ICgpID0+IGpiY1Rlc3RuZXQsCiAgICBrYWlhOiAoKSA9PiBrYWlhLAogICAga2Fpcm9zOiAoKSA9PiBrYWlyb3MsCiAgICBrYWthcm90U2Vwb2xpYTogKCkgPT4ga2FrYXJvdFNlcG9saWEsCiAgICBrYWthcm90U3RhcmtuZXRTZXBvbGlhOiAoKSA9PiBrYWthcm90U3RhcmtuZXRTZXBvbGlhLAogICAga2FydXJhOiAoKSA9PiBrYXJ1cmEsCiAgICBrYXZhOiAoKSA9PiBrYXZhLAogICAga2F2YVRlc3RuZXQ6ICgpID0+IGthdmFUZXN0bmV0LAogICAga2NjOiAoKSA9PiBrY2MsCiAgICBraW50bzogKCkgPT4ga2ludG8sCiAgICBrbGF5dG46ICgpID0+IGtsYXl0biwKICAgIGtsYXl0bkJhb2JhYjogKCkgPT4ga2xheXRuQmFvYmFiLAogICAga29pOiAoKSA9PiBrb2ksCiAgICBrcm9tYTogKCkgPT4ga3JvbWEsCiAgICBrcm9tYVNlcG9saWE6ICgpID0+IGtyb21hU2Vwb2xpYSwKICAgIGwzeDogKCkgPT4gbDN4LAogICAgbDN4VGVzdG5ldDogKCkgPT4gbDN4VGVzdG5ldCwKICAgIGxhdml0YTogKCkgPT4gbGF2aXRhLAogICAgbGlnaHRsaW5rUGVnYXN1czogKCkgPT4gbGlnaHRsaW5rUGVnYXN1cywKICAgIGxpZ2h0bGlua1Bob2VuaXg6ICgpID0+IGxpZ2h0bGlua1Bob2VuaXgsCiAgICBsaW5lYTogKCkgPT4gbGluZWEsCiAgICBsaW5lYUdvZXJsaTogKCkgPT4gbGluZWFHb2VybGksCiAgICBsaW5lYVNlcG9saWE6ICgpID0+IGxpbmVhU2Vwb2xpYSwKICAgIGxpbmVhVGVzdG5ldDogKCkgPT4gbGluZWFUZXN0bmV0LAogICAgbGlzazogKCkgPT4gbGlzaywKICAgIGxpc2tTZXBvbGlhOiAoKSA9PiBsaXNrU2Vwb2xpYSwKICAgIGxvY2FsaG9zdDogKCkgPT4gbG9jYWxob3N0LAogICAgbG9vcDogKCkgPT4gbG9vcCwKICAgIGx1a3NvOiAoKSA9PiBsdWtzbywKICAgIGx1a3NvVGVzdG5ldDogKCkgPT4gbHVrc29UZXN0bmV0LAogICAgbHljYW46ICgpID0+IGx5Y2FuLAogICAgbHlyYTogKCkgPT4gbHlyYSwKICAgIG1haW5uZXQ6ICgpID0+IG1haW5uZXQsCiAgICBtYW5kYWxhOiAoKSA9PiBtYW5kYWxhLAogICAgbWFudGE6ICgpID0+IG1hbnRhLAogICAgbWFudGFTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWFudGFTZXBvbGlhVGVzdG5ldCwKICAgIG1hbnRhVGVzdG5ldDogKCkgPT4gbWFudGFUZXN0bmV0LAogICAgbWFudGxlOiAoKSA9PiBtYW50bGUsCiAgICBtYW50bGVTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWFudGxlU2Vwb2xpYVRlc3RuZXQsCiAgICBtYW50bGVUZXN0bmV0OiAoKSA9PiBtYW50bGVUZXN0bmV0LAogICAgbWFwUHJvdG9jb2w6ICgpID0+IG1hcFByb3RvY29sLAogICAgbWF0Y2hhaW46ICgpID0+IG1hdGNoYWluLAogICAgbWF0Y2hhaW5UZXN0bmV0OiAoKSA9PiBtYXRjaGFpblRlc3RuZXQsCiAgICBtZXJsaW46ICgpID0+IG1lcmxpbiwKICAgIG1ldGFjaGFpbjogKCkgPT4gbWV0YWNoYWluLAogICAgbWV0YWNoYWluSXN0YW5idWw6ICgpID0+IG1ldGFjaGFpbklzdGFuYnVsLAogICAgbWV0YWxMMjogKCkgPT4gbWV0YWxMMiwKICAgIG1ldGVyOiAoKSA9PiBtZXRlciwKICAgIG1ldGVyVGVzdG5ldDogKCkgPT4gbWV0ZXJUZXN0bmV0LAogICAgbWV0aXM6ICgpID0+IG1ldGlzLAogICAgbWV0aXNHb2VybGk6ICgpID0+IG1ldGlzR29lcmxpLAogICAgbWV2OiAoKSA9PiBtZXYsCiAgICBtZXZUZXN0bmV0OiAoKSA9PiBtZXZUZXN0bmV0LAogICAgbWludDogKCkgPT4gbWludCwKICAgIG1pbnRTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWludFNlcG9saWFUZXN0bmV0LAogICAgbW9kZTogKCkgPT4gbW9kZSwKICAgIG1vZGVUZXN0bmV0OiAoKSA9PiBtb2RlVGVzdG5ldCwKICAgIG1vb25iYXNlQWxwaGE6ICgpID0+IG1vb25iYXNlQWxwaGEsCiAgICBtb29uYmVhbTogKCkgPT4gbW9vbmJlYW0sCiAgICBtb29uYmVhbURldjogKCkgPT4gbW9vbmJlYW1EZXYsCiAgICBtb29ucml2ZXI6ICgpID0+IG1vb25yaXZlciwKICAgIG1vcnBoSG9sZXNreTogKCkgPT4gbW9ycGhIb2xlc2t5LAogICAgbW9ycGhTZXBvbGlhOiAoKSA9PiBtb3JwaFNlcG9saWEsCiAgICBuYXV0aWx1czogKCkgPT4gbmF1dGlsdXMsCiAgICBuZW9uRGV2bmV0OiAoKSA9PiBuZW9uRGV2bmV0LAogICAgbmVvbk1haW5uZXQ6ICgpID0+IG5lb25NYWlubmV0LAogICAgbmV4aTogKCkgPT4gbmV4aSwKICAgIG5leGlsaXg6ICgpID0+IG5leGlsaXgsCiAgICBvYXNpc1Rlc3RuZXQ6ICgpID0+IG9hc2lzVGVzdG5ldCwKICAgIG9hc3lzOiAoKSA9PiBvYXN5cywKICAgIG9keXNzZXlUZXN0bmV0OiAoKSA9PiBvZHlzc2V5VGVzdG5ldCwKICAgIG9rYzogKCkgPT4gb2tjLAogICAgb29ydE1haW5uZXREZXY6ICgpID0+IG9vcnRNYWlubmV0RGV2LAogICAgb3BCTkI6ICgpID0+IG9wQk5CLAogICAgb3BCTkJUZXN0bmV0OiAoKSA9PiBvcEJOQlRlc3RuZXQsCiAgICBvcHRpbWlzbTogKCkgPT4gb3B0aW1pc20sCiAgICBvcHRpbWlzbUdvZXJsaTogKCkgPT4gb3B0aW1pc21Hb2VybGksCiAgICBvcHRpbWlzbVNlcG9saWE6ICgpID0+IG9wdGltaXNtU2Vwb2xpYSwKICAgIG9wdG9waWE6ICgpID0+IG9wdG9waWEsCiAgICBvcHRvcGlhVGVzdG5ldDogKCkgPT4gb3B0b3BpYVRlc3RuZXQsCiAgICBvcmRlcmx5OiAoKSA9PiBvcmRlcmx5LAogICAgb3JkZXJseVNlcG9saWE6ICgpID0+IG9yZGVybHlTZXBvbGlhLAogICAgb3RpbURldm5ldDogKCkgPT4gb3RpbURldm5ldCwKICAgIHBhbG06ICgpID0+IHBhbG0sCiAgICBwYWxtVGVzdG5ldDogKCkgPT4gcGFsbVRlc3RuZXQsCiAgICBwZ246ICgpID0+IHBnbiwKICAgIHBnblRlc3RuZXQ6ICgpID0+IHBnblRlc3RuZXQsCiAgICBwaG9lbml4OiAoKSA9PiBwaG9lbml4LAogICAgcGxheWZpQWxiaXJlbzogKCkgPT4gcGxheWZpQWxiaXJlbywKICAgIHBsaW5nYTogKCkgPT4gcGxpbmdhLAogICAgcGx1bWVUZXN0bmV0OiAoKSA9PiBwbHVtZVRlc3RuZXQsCiAgICBwb2x5Z29uOiAoKSA9PiBwb2x5Z29uLAogICAgcG9seWdvbkFtb3k6ICgpID0+IHBvbHlnb25BbW95LAogICAgcG9seWdvbk11bWJhaTogKCkgPT4gcG9seWdvbk11bWJhaSwKICAgIHBvbHlnb25aa0V2bTogKCkgPT4gcG9seWdvblprRXZtLAogICAgcG9seWdvblprRXZtQ2FyZG9uYTogKCkgPT4gcG9seWdvblprRXZtQ2FyZG9uYSwKICAgIHBvbHlnb25aa0V2bVRlc3RuZXQ6ICgpID0+IHBvbHlnb25aa0V2bVRlc3RuZXQsCiAgICBwdWxzZWNoYWluOiAoKSA9PiBwdWxzZWNoYWluLAogICAgcHVsc2VjaGFpblY0OiAoKSA9PiBwdWxzZWNoYWluVjQsCiAgICBxTWFpbm5ldDogKCkgPT4gcU1haW5uZXQsCiAgICBxVGVzdG5ldDogKCkgPT4gcVRlc3RuZXQsCiAgICBxbDE6ICgpID0+IHFsMSwKICAgIHJlYWw6ICgpID0+IHJlYWwsCiAgICByZWRiZWxseVRlc3RuZXQ6ICgpID0+IHJlZGJlbGx5VGVzdG5ldCwKICAgIHJlZHN0b25lOiAoKSA9PiByZWRzdG9uZSwKICAgIHJleWFOZXR3b3JrOiAoKSA9PiByZXlhTmV0d29yaywKICAgIHJvbGx1eDogKCkgPT4gcm9sbHV4LAogICAgcm9sbHV4VGVzdG5ldDogKCkgPT4gcm9sbHV4VGVzdG5ldCwKICAgIHJvbmluOiAoKSA9PiByb25pbiwKICAgIHJvb3Q6ICgpID0+IHJvb3QsCiAgICByb290UG9yY2luaTogKCkgPT4gcm9vdFBvcmNpbmksCiAgICByb290c3RvY2s6ICgpID0+IHJvb3RzdG9jaywKICAgIHJvb3RzdG9ja1Rlc3RuZXQ6ICgpID0+IHJvb3RzdG9ja1Rlc3RuZXQsCiAgICByc3MzOiAoKSA9PiByc3MzLAogICAgcnNzM1NlcG9saWE6ICgpID0+IHJzczNTZXBvbGlhLAogICAgc2FpZ29uOiAoKSA9PiBzYWlnb24sCiAgICBzYW5rbzogKCkgPT4gc2Fua28sCiAgICBzYXBwaGlyZTogKCkgPT4gc2FwcGhpcmUsCiAgICBzYXBwaGlyZVRlc3RuZXQ6ICgpID0+IHNhcHBoaXJlVGVzdG5ldCwKICAgIHNhdG9zaGlWTTogKCkgPT4gc2F0b3NoaVZNLAogICAgc2F0b3NoaVZNVGVzdG5ldDogKCkgPT4gc2F0b3NoaVZNVGVzdG5ldCwKICAgIHNjcm9sbDogKCkgPT4gc2Nyb2xsLAogICAgc2Nyb2xsU2Vwb2xpYTogKCkgPT4gc2Nyb2xsU2Vwb2xpYSwKICAgIHNlaTogKCkgPT4gc2VpLAogICAgc2VpRGV2bmV0OiAoKSA9PiBzZWlEZXZuZXQsCiAgICBzZWlUZXN0bmV0OiAoKSA9PiBzZWlUZXN0bmV0LAogICAgc2Vwb2xpYTogKCkgPT4gc2Vwb2xpYSwKICAgIHNoYXBlOiAoKSA9PiBzaGFwZSwKICAgIHNoYXBlU2Vwb2xpYTogKCkgPT4gc2hhcGVTZXBvbGlhLAogICAgc2hhcmRldW1TcGhpbng6ICgpID0+IHNoYXJkZXVtU3BoaW54LAogICAgc2hpYmFyaXVtOiAoKSA9PiBzaGliYXJpdW0sCiAgICBzaGliYXJpdW1UZXN0bmV0OiAoKSA9PiBzaGliYXJpdW1UZXN0bmV0LAogICAgc2hpZGVuOiAoKSA9PiBzaGlkZW4sCiAgICBzaGltbWVyOiAoKSA9PiBzaGltbWVyLAogICAgc2hpbW1lclRlc3RuZXQ6ICgpID0+IHNoaW1tZXJUZXN0bmV0LAogICAgc2lsaWNvbjogKCkgPT4gc2lsaWNvbiwKICAgIHNpbGljb25TZXBvbGlhOiAoKSA9PiBzaWxpY29uU2Vwb2xpYSwKICAgIHNrYWxlQmxvY2tCcmF3bGVyczogKCkgPT4gc2thbGVCbG9ja0JyYXdsZXJzLAogICAgc2thbGVDYWx5cHNvOiAoKSA9PiBza2FsZUNhbHlwc28sCiAgICBza2FsZUNhbHlwc29UZXN0bmV0OiAoKSA9PiBza2FsZUNhbHlwc29UZXN0bmV0LAogICAgc2thbGVDcnlwdG9CbGFkZXM6ICgpID0+IHNrYWxlQ3J5cHRvQmxhZGVzLAogICAgc2thbGVDcnlwdG9Db2xvc3NldW06ICgpID0+IHNrYWxlQ3J5cHRvQ29sb3NzZXVtLAogICAgc2thbGVFdXJvcGE6ICgpID0+IHNrYWxlRXVyb3BhLAogICAgc2thbGVFdXJvcGFUZXN0bmV0OiAoKSA9PiBza2FsZUV1cm9wYVRlc3RuZXQsCiAgICBza2FsZUV4b3JkZTogKCkgPT4gc2thbGVFeG9yZGUsCiAgICBza2FsZUh1bWFuUHJvdG9jb2w6ICgpID0+IHNrYWxlSHVtYW5Qcm90b2NvbCwKICAgIHNrYWxlTmVidWxhOiAoKSA9PiBza2FsZU5lYnVsYSwKICAgIHNrYWxlTmVidWxhVGVzdG5ldDogKCkgPT4gc2thbGVOZWJ1bGFUZXN0bmV0LAogICAgc2thbGVSYXpvcjogKCkgPT4gc2thbGVSYXpvciwKICAgIHNrYWxlVGl0YW46ICgpID0+IHNrYWxlVGl0YW4sCiAgICBza2FsZVRpdGFuVGVzdG5ldDogKCkgPT4gc2thbGVUaXRhblRlc3RuZXQsCiAgICBza2V0Y2hwYWQ6ICgpID0+IHNrZXRjaHBhZCwKICAgIHNuYXg6ICgpID0+IHNuYXgsCiAgICBzbmF4VGVzdG5ldDogKCkgPT4gc25heFRlc3RuZXQsCiAgICBzb25laXVtTWluYXRvOiAoKSA9PiBzb25laXVtTWluYXRvLAogICAgc29uZ2JpcmQ6ICgpID0+IHNvbmdiaXJkLAogICAgc29uZ2JpcmRUZXN0bmV0OiAoKSA9PiBzb25nYmlyZFRlc3RuZXQsCiAgICBzb3Bob25UZXN0bmV0OiAoKSA9PiBzb3Bob25UZXN0bmV0LAogICAgc3BpY3k6ICgpID0+IHNwaWN5LAogICAgc3RlcDogKCkgPT4gc3RlcCwKICAgIHN0b3J5VGVzdG5ldDogKCkgPT4gc3RvcnlUZXN0bmV0LAogICAgc3RyYXRpczogKCkgPT4gc3RyYXRpcywKICAgIHN1cGVybHVtaW86ICgpID0+IHN1cGVybHVtaW8sCiAgICBzdXBlcnBvc2l0aW9uOiAoKSA9PiBzdXBlcnBvc2l0aW9uLAogICAgc3dhbjogKCkgPT4gc3dhbiwKICAgIHN3YW5Qcm94aW1hVGVzdG5ldDogKCkgPT4gc3dhblByb3hpbWFUZXN0bmV0LAogICAgc3dhblNhdHVyblRlc3RuZXQ6ICgpID0+IHN3YW5TYXR1cm5UZXN0bmV0LAogICAgc3lzY29pbjogKCkgPT4gc3lzY29pbiwKICAgIHN5c2NvaW5UZXN0bmV0OiAoKSA9PiBzeXNjb2luVGVzdG5ldCwKICAgIHRhaWtvOiAoKSA9PiB0YWlrbywKICAgIHRhaWtvSGVrbGE6ICgpID0+IHRhaWtvSGVrbGEsCiAgICB0YWlrb0pvbG5pcjogKCkgPT4gdGFpa29Kb2xuaXIsCiAgICB0YWlrb0thdGxhOiAoKSA9PiB0YWlrb0thdGxhLAogICAgdGFpa29UZXN0bmV0U2Vwb2xpYTogKCkgPT4gdGFpa29UZXN0bmV0U2Vwb2xpYSwKICAgIHRhcmF4YTogKCkgPT4gdGFyYXhhLAogICAgdGFyYXhhVGVzdG5ldDogKCkgPT4gdGFyYXhhVGVzdG5ldCwKICAgIHRlbGNvaW5UZXN0bmV0OiAoKSA9PiB0ZWxjb2luVGVzdG5ldCwKICAgIHRlbG9zOiAoKSA9PiB0ZWxvcywKICAgIHRlbG9zVGVzdG5ldDogKCkgPT4gdGVsb3NUZXN0bmV0LAogICAgdGVuZXQ6ICgpID0+IHRlbmV0LAogICAgdGhhaUNoYWluOiAoKSA9PiB0aGFpQ2hhaW4sCiAgICB0aHVuZGVyQ29yZTogKCkgPT4gdGh1bmRlckNvcmUsCiAgICB0aHVuZGVyVGVzdG5ldDogKCkgPT4gdGh1bmRlclRlc3RuZXQsCiAgICB0aWt0cml4VGVzdG5ldDogKCkgPT4gdGlrdHJpeFRlc3RuZXQsCiAgICB0cm9uOiAoKSA9PiB0cm9uLAogICAgdWx0cm9uOiAoKSA9PiB1bHRyb24sCiAgICB1bHRyb25UZXN0bmV0OiAoKSA9PiB1bHRyb25UZXN0bmV0LAogICAgdW5pY2hhaW5TZXBvbGlhOiAoKSA9PiB1bmljaGFpblNlcG9saWEsCiAgICB1bmlxdWU6ICgpID0+IHVuaXF1ZSwKICAgIHVuaXF1ZU9wYWw6ICgpID0+IHVuaXF1ZU9wYWwsCiAgICB1bmlxdWVRdWFydHo6ICgpID0+IHVuaXF1ZVF1YXJ0eiwKICAgIHVucmVhbDogKCkgPT4gdW5yZWFsLAogICAgdmVjaGFpbjogKCkgPT4gdmVjaGFpbiwKICAgIHZlbGFzOiAoKSA9PiB2ZWxhcywKICAgIHZpY3Rpb246ICgpID0+IHZpY3Rpb24sCiAgICB2aWN0aW9uVGVzdG5ldDogKCkgPT4gdmljdGlvblRlc3RuZXQsCiAgICB2aXNpb246ICgpID0+IHZpc2lvbiwKICAgIHZpc2lvblRlc3RuZXQ6ICgpID0+IHZpc2lvblRlc3RuZXQsCiAgICB3YW5jaGFpbjogKCkgPT4gd2FuY2hhaW4sCiAgICB3YW5jaGFpblRlc3RuZXQ6ICgpID0+IHdhbmNoYWluVGVzdG5ldCwKICAgIHdlYXZlVk1BbHBoYW5ldDogKCkgPT4gd2VhdmVWTUFscGhhbmV0LAogICAgd2VtaXg6ICgpID0+IHdlbWl4LAogICAgd2VtaXhUZXN0bmV0OiAoKSA9PiB3ZW1peFRlc3RuZXQsCiAgICB3b3JsZGNoYWluOiAoKSA9PiB3b3JsZGNoYWluLAogICAgd29ybGRjaGFpblNlcG9saWE6ICgpID0+IHdvcmxkY2hhaW5TZXBvbGlhLAogICAgeDFUZXN0bmV0OiAoKSA9PiB4TGF5ZXJUZXN0bmV0LAogICAgeExheWVyOiAoKSA9PiB4TGF5ZXIsCiAgICB4TGF5ZXJUZXN0bmV0OiAoKSA9PiB4TGF5ZXJUZXN0bmV0LAogICAgeGFpOiAoKSA9PiB4YWksCiAgICB4YWlUZXN0bmV0OiAoKSA9PiB4YWlUZXN0bmV0LAogICAgeGRjOiAoKSA9PiB4ZGMsCiAgICB4ZGNUZXN0bmV0OiAoKSA9PiB4ZGNUZXN0bmV0LAogICAgeHJTZXBvbGlhOiAoKSA9PiB4clNlcG9saWEsCiAgICB5b29sZG9WZXJzZTogKCkgPT4geW9vbGRvVmVyc2UsCiAgICB5b29sZG9WZXJzZVRlc3RuZXQ6ICgpID0+IHlvb2xkb1ZlcnNlVGVzdG5ldCwKICAgIHplbmNoYWluVGVzdG5ldDogKCkgPT4gemVuY2hhaW5UZXN0bmV0LAogICAgemV0YWNoYWluOiAoKSA9PiB6ZXRhY2hhaW4sCiAgICB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0OiAoKSA9PiB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0LAogICAgemhlamlhbmc6ICgpID0+IHpoZWppYW5nLAogICAgemlsbGlxYTogKCkgPT4gemlsbGlxYSwKICAgIHppbGxpcWFUZXN0bmV0OiAoKSA9PiB6aWxsaXFhVGVzdG5ldCwKICAgIHppcmN1aXQ6ICgpID0+IHppcmN1aXQsCiAgICB6aXJjdWl0VGVzdG5ldDogKCkgPT4gemlyY3VpdFRlc3RuZXQsCiAgICB6a0ZhaXI6ICgpID0+IHprRmFpciwKICAgIHprRmFpclRlc3RuZXQ6ICgpID0+IHprRmFpclRlc3RuZXQsCiAgICB6a0xpbmtOb3ZhOiAoKSA9PiB6a0xpbmtOb3ZhLAogICAgemtMaW5rTm92YVNlcG9saWFUZXN0bmV0OiAoKSA9PiB6a0xpbmtOb3ZhU2Vwb2xpYVRlc3RuZXQsCiAgICB6a1N5bmM6ICgpID0+IHprc3luYywKICAgIHprU3luY0luTWVtb3J5Tm9kZTogKCkgPT4gemtzeW5jSW5NZW1vcnlOb2RlLAogICAgemtTeW5jTG9jYWxOb2RlOiAoKSA9PiB6a3N5bmNMb2NhbE5vZGUsCiAgICB6a1N5bmNTZXBvbGlhVGVzdG5ldDogKCkgPT4gemtzeW5jU2Vwb2xpYVRlc3RuZXQsCiAgICB6a3N5bmM6ICgpID0+IHprc3luYywKICAgIHprc3luY0luTWVtb3J5Tm9kZTogKCkgPT4gemtzeW5jSW5NZW1vcnlOb2RlLAogICAgemtzeW5jTG9jYWxOb2RlOiAoKSA9PiB6a3N5bmNMb2NhbE5vZGUsCiAgICB6a3N5bmNTZXBvbGlhVGVzdG5ldDogKCkgPT4gemtzeW5jU2Vwb2xpYVRlc3RuZXQsCiAgICB6b3JhOiAoKSA9PiB6b3JhLAogICAgem9yYVNlcG9saWE6ICgpID0+IHpvcmFTZXBvbGlhLAogICAgem9yYVRlc3RuZXQ6ICgpID0+IHpvcmFUZXN0bmV0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZm9ybWF0dGVycy5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X3RyYW5zYWN0aW9uUmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2NvbnN0YW50cy9udW1iZXIuanMKICBpbml0X251bWJlcigpOwogIHZhciBnYXNQZXJQdWJkYXRhRGVmYXVsdCA9IDUwMDAwbjsKICB2YXIgbWF4Qnl0ZWNvZGVTaXplID0gbWF4VWludDE2ICogMzJuOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2Zvcm1hdHRlcnMuanMKICB2YXIgZm9ybWF0dGVycyA9IHsKICAgIGJsb2NrOiAvKiBAX19QVVJFX18gKi8gZGVmaW5lQmxvY2soewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGFyZ3MudHJhbnNhY3Rpb25zPy5tYXAoKHRyYW5zYWN0aW9uKSA9PiB7CiAgICAgICAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uID09PSAic3RyaW5nIikKICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0dGVycy50cmFuc2FjdGlvbj8uZm9ybWF0KHRyYW5zYWN0aW9uKTsKICAgICAgICAgIGlmIChmb3JtYXR0ZWQudHlwZUhleCA9PT0gIjB4NzEiKQogICAgICAgICAgICBmb3JtYXR0ZWQudHlwZSA9ICJlaXA3MTIiOwogICAgICAgICAgZWxzZSBpZiAoZm9ybWF0dGVkLnR5cGVIZXggPT09ICIweGZmIikKICAgICAgICAgICAgZm9ybWF0dGVkLnR5cGUgPSAicHJpb3JpdHkiOwogICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbDFCYXRjaE51bWJlcjogYXJncy5sMUJhdGNoTnVtYmVyID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoTnVtYmVyKSA6IG51bGwsCiAgICAgICAgICBsMUJhdGNoVGltZXN0YW1wOiBhcmdzLmwxQmF0Y2hUaW1lc3RhbXAgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hUaW1lc3RhbXApIDogbnVsbCwKICAgICAgICAgIHRyYW5zYWN0aW9ucwogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb246IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvbih7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7fTsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3MSIpCiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImVpcDcxMiI7CiAgICAgICAgZWxzZSBpZiAoYXJncy50eXBlID09PSAiMHhmZiIpCiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gInByaW9yaXR5IjsKICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBhcmdzLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hOdW1iZXIpIDogbnVsbCwKICAgICAgICAgIGwxQmF0Y2hUeEluZGV4OiBhcmdzLmwxQmF0Y2hUeEluZGV4ID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoVHhJbmRleCkgOiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlY2VpcHQoewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBhcmdzLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hOdW1iZXIpIDogbnVsbCwKICAgICAgICAgIGwxQmF0Y2hUeEluZGV4OiBhcmdzLmwxQmF0Y2hUeEluZGV4ID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoVHhJbmRleCkgOiBudWxsLAogICAgICAgICAgbG9nczogYXJncy5sb2dzLm1hcCgobG9nKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgLi4uZm9ybWF0TG9nKGxvZyksCiAgICAgICAgICAgICAgbDFCYXRjaE51bWJlcjogbG9nLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChsb2cubDFCYXRjaE51bWJlcikgOiBudWxsLAogICAgICAgICAgICAgIHRyYW5zYWN0aW9uTG9nSW5kZXg6IGhleFRvTnVtYmVyKGxvZy50cmFuc2FjdGlvbkxvZ0luZGV4KSwKICAgICAgICAgICAgICBsb2dUeXBlOiBsb2cubG9nVHlwZQogICAgICAgICAgICB9OwogICAgICAgICAgfSksCiAgICAgICAgICBsMlRvTDFMb2dzOiBhcmdzLmwyVG9MMUxvZ3MubWFwKChsMlRvTDFMb2cpID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBibG9ja051bWJlcjogaGV4VG9CaWdJbnQobDJUb0wxTG9nLmJsb2NrSGFzaCksCiAgICAgICAgICAgICAgYmxvY2tIYXNoOiBsMlRvTDFMb2cuYmxvY2tIYXNoLAogICAgICAgICAgICAgIGwxQmF0Y2hOdW1iZXI6IGhleFRvQmlnSW50KGwyVG9MMUxvZy5sMUJhdGNoTnVtYmVyKSwKICAgICAgICAgICAgICB0cmFuc2FjdGlvbkluZGV4OiBoZXhUb0JpZ0ludChsMlRvTDFMb2cudHJhbnNhY3Rpb25JbmRleCksCiAgICAgICAgICAgICAgc2hhcmRJZDogaGV4VG9CaWdJbnQobDJUb0wxTG9nLnNoYXJkSWQpLAogICAgICAgICAgICAgIGlzU2VydmljZTogbDJUb0wxTG9nLmlzU2VydmljZSwKICAgICAgICAgICAgICBzZW5kZXI6IGwyVG9MMUxvZy5zZW5kZXIsCiAgICAgICAgICAgICAga2V5OiBsMlRvTDFMb2cua2V5LAogICAgICAgICAgICAgIHZhbHVlOiBsMlRvTDFMb2cudmFsdWUsCiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25IYXNoOiBsMlRvTDFMb2cudHJhbnNhY3Rpb25IYXNoLAogICAgICAgICAgICAgIGxvZ0luZGV4OiBoZXhUb0JpZ0ludChsMlRvTDFMb2cubG9nSW5kZXgpCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KQogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb25SZXF1ZXN0OiAvKiBAX19QVVJFX18gKi8gZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0KHsKICAgICAgZXhjbHVkZTogWwogICAgICAgICJjdXN0b21TaWduYXR1cmUiLAogICAgICAgICJmYWN0b3J5RGVwcyIsCiAgICAgICAgImdhc1BlclB1YmRhdGEiLAogICAgICAgICJwYXltYXN0ZXIiLAogICAgICAgICJwYXltYXN0ZXJJbnB1dCIKICAgICAgXSwKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy5nYXNQZXJQdWJkYXRhIHx8IGFyZ3MucGF5bWFzdGVyICYmIGFyZ3MucGF5bWFzdGVySW5wdXQgfHwgYXJncy5mYWN0b3J5RGVwcyB8fCBhcmdzLmN1c3RvbVNpZ25hdHVyZSkKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGVpcDcxMk1ldGE6IHsKICAgICAgICAgICAgICAuLi5hcmdzLmdhc1BlclB1YmRhdGEgPyB7IGdhc1BlclB1YmRhdGE6IHRvSGV4KGFyZ3MuZ2FzUGVyUHViZGF0YSkgfSA6IHsgZ2FzUGVyUHViZGF0YTogdG9IZXgoZ2FzUGVyUHViZGF0YURlZmF1bHQpIH0sCiAgICAgICAgICAgICAgLi4uYXJncy5wYXltYXN0ZXIgJiYgYXJncy5wYXltYXN0ZXJJbnB1dCA/IHsKICAgICAgICAgICAgICAgIHBheW1hc3RlclBhcmFtczogewogICAgICAgICAgICAgICAgICBwYXltYXN0ZXI6IGFyZ3MucGF5bWFzdGVyLAogICAgICAgICAgICAgICAgICBwYXltYXN0ZXJJbnB1dDogQXJyYXkuZnJvbShoZXhUb0J5dGVzKGFyZ3MucGF5bWFzdGVySW5wdXQpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gOiB7fSwKICAgICAgICAgICAgICAuLi5hcmdzLmZhY3RvcnlEZXBzID8gewogICAgICAgICAgICAgICAgZmFjdG9yeURlcHM6IGFyZ3MuZmFjdG9yeURlcHMubWFwKChkZXApID0+IEFycmF5LmZyb20oaGV4VG9CeXRlcyhkZXApKSkKICAgICAgICAgICAgICB9IDoge30sCiAgICAgICAgICAgICAgLi4uYXJncy5jdXN0b21TaWduYXR1cmUgPyB7CiAgICAgICAgICAgICAgICBjdXN0b21TaWduYXR1cmU6IEFycmF5LmZyb20oaGV4VG9CeXRlcyhhcmdzLmN1c3RvbVNpZ25hdHVyZSkpCiAgICAgICAgICAgICAgfSA6IHt9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHR5cGU6ICIweDcxIgogICAgICAgICAgfTsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0pCiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy9zZXJpYWxpemVycy5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2Fzc2VydEVpcDcxMlRyYW5zYWN0aW9uLmpzCiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jaGFpbigpOwogIGluaXRfaXNBZGRyZXNzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZXJyb3JzL3RyYW5zYWN0aW9uLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEludmFsaWRFaXA3MTJUcmFuc2FjdGlvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcihbCiAgICAgICAgIlRyYW5zYWN0aW9uIGlzIG5vdCBhbiBFSVA3MTIgdHJhbnNhY3Rpb24uIiwKICAgICAgICAiIiwKICAgICAgICAiVHJhbnNhY3Rpb24gbXVzdDoiLAogICAgICAgICcgIC0gaW5jbHVkZSBgdHlwZTogImVpcDcxMiJgJywKICAgICAgICAiICAtIGluY2x1ZGUgb25lIG9mIHRoZSBmb2xsb3dpbmc6IGBjdXN0b21TaWduYXR1cmVgLCBgcGF5bWFzdGVyYCwgYHBheW1hc3RlcklucHV0YCwgYGdhc1BlclB1YmRhdGFgLCBgZmFjdG9yeURlcHNgIgogICAgICBdLmpvaW4oIlxuIiksIHsgbmFtZTogIkludmFsaWRFaXA3MTJUcmFuc2FjdGlvbkVycm9yIiB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2lzRWlwNzEyVHJhbnNhY3Rpb24uanMKICBmdW5jdGlvbiBpc0VJUDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImVpcDcxMiIpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKCJjdXN0b21TaWduYXR1cmUiIGluIHRyYW5zYWN0aW9uICYmIHRyYW5zYWN0aW9uLmN1c3RvbVNpZ25hdHVyZSB8fCAicGF5bWFzdGVyIiBpbiB0cmFuc2FjdGlvbiAmJiB0cmFuc2FjdGlvbi5wYXltYXN0ZXIgfHwgInBheW1hc3RlcklucHV0IiBpbiB0cmFuc2FjdGlvbiAmJiB0cmFuc2FjdGlvbi5wYXltYXN0ZXJJbnB1dCB8fCAiZ2FzUGVyUHViZGF0YSIgaW4gdHJhbnNhY3Rpb24gJiYgdHlwZW9mIHRyYW5zYWN0aW9uLmdhc1BlclB1YmRhdGEgPT09ICJiaWdpbnQiIHx8ICJmYWN0b3J5RGVwcyIgaW4gdHJhbnNhY3Rpb24gJiYgdHJhbnNhY3Rpb24uZmFjdG9yeURlcHMpCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9hc3NlcnRFaXA3MTJUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGNoYWluSWQsIHRvLCBmcm9tLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0IH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmICghaXNFSVA3MTJUcmFuc2FjdGlvbih0cmFuc2FjdGlvbikpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkRWlwNzEyVHJhbnNhY3Rpb25FcnJvcigpOwogICAgaWYgKCFjaGFpbklkIHx8IGNoYWluSWQgPD0gMCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRDaGFpbklkRXJyb3IoeyBjaGFpbklkIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKGZyb20gJiYgIWlzQWRkcmVzcyhmcm9tKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBmcm9tIH0pOwogICAgaWYgKHBheW1hc3RlciAmJiAhaXNBZGRyZXNzKHBheW1hc3RlcikpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogcGF5bWFzdGVyIH0pOwogICAgaWYgKHBheW1hc3RlciAmJiAhcGF5bWFzdGVySW5wdXQpIHsKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImBwYXltYXN0ZXJJbnB1dGAgbXVzdCBiZSBwcm92aWRlZCB3aGVuIGBwYXltYXN0ZXJgIGlzIGRlZmluZWQiKTsKICAgIH0KICAgIGlmICghcGF5bWFzdGVyICYmIHBheW1hc3RlcklucHV0KSB7CiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgcGF5bWFzdGVyYCBtdXN0IGJlIHByb3ZpZGVkIHdoZW4gYHBheW1hc3RlcklucHV0YCBpcyBkZWZpbmVkIik7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3NlcmlhbGl6ZXJzLmpzCiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb24yKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGlmIChpc0VJUDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSkKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNzEyKHRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgdmFyIHNlcmlhbGl6ZXJzID0gewogICAgdHJhbnNhY3Rpb246IHNlcmlhbGl6ZVRyYW5zYWN0aW9uMgogIH07CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3MTIodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgZ2FzLCBub25jZSwgdG8sIGZyb20sIHZhbHVlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBjdXN0b21TaWduYXR1cmUsIGZhY3RvcnlEZXBzLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0LCBnYXNQZXJQdWJkYXRhLCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgIG1heEZlZVBlckdhcyA/IHRvSGV4KG1heEZlZVBlckdhcykgOiAiMHgiLAogICAgICBnYXMgPyB0b0hleChnYXMpIDogIjB4IiwKICAgICAgdG8gPz8gIjB4IiwKICAgICAgdmFsdWUgPyB0b0hleCh2YWx1ZSkgOiAiMHgiLAogICAgICBkYXRhID8/ICIweDAiLAogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgdG9IZXgoIiIpLAogICAgICB0b0hleCgiIiksCiAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICBmcm9tID8/ICIweCIsCiAgICAgIGdhc1BlclB1YmRhdGEgPyB0b0hleChnYXNQZXJQdWJkYXRhKSA6IHRvSGV4KGdhc1BlclB1YmRhdGFEZWZhdWx0KSwKICAgICAgZmFjdG9yeURlcHMgPz8gW10sCiAgICAgIGN1c3RvbVNpZ25hdHVyZSA/PyAiMHgiLAogICAgICAvLyBFSVA3MTIgc2lnbmF0dXJlCiAgICAgIHBheW1hc3RlciAmJiBwYXltYXN0ZXJJbnB1dCA/IFtwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0XSA6IFtdCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDcxIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2dldEVpcDcxMkRvbWFpbi5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9oYXNoQnl0ZWNvZGUuanMKICBpbml0X3BhZCgpOwogIGluaXRfdG9CeXRlcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2Vycm9ycy9ieXRlY29kZS5qcwogIGluaXRfYmFzZSgpOwogIHZhciBCeXRlY29kZUxlbmd0aEV4Y2VlZHNNYXhTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBnaXZlbkxlbmd0aCwgbWF4Qnl0ZWNvZGVTaXplOiBtYXhCeXRlY29kZVNpemUyIH0pIHsKICAgICAgc3VwZXIoYEJ5dGVjb2RlIGNhbm5vdCBiZSBsb25nZXIgdGhhbiAke21heEJ5dGVjb2RlU2l6ZTJ9IGJ5dGVzLiBHaXZlbiBsZW5ndGg6ICR7Z2l2ZW5MZW5ndGh9YCwgeyBuYW1lOiAiQnl0ZWNvZGVMZW5ndGhFeGNlZWRzTWF4U2l6ZUVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBCeXRlY29kZUxlbmd0aEluV29yZHNNdXN0QmVPZGRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGdpdmVuTGVuZ3RoSW5Xb3JkcyB9KSB7CiAgICAgIHN1cGVyKGBCeXRlY29kZSBsZW5ndGggaW4gMzItYnl0ZSB3b3JkcyBtdXN0IGJlIG9kZC4gR2l2ZW4gbGVuZ3RoIGluIHdvcmRzOiAke2dpdmVuTGVuZ3RoSW5Xb3Jkc31gLCB7IG5hbWU6ICJCeXRlY29kZUxlbmd0aEluV29yZHNNdXN0QmVPZGRFcnJvciIgfSk7CiAgICB9CiAgfTsKICB2YXIgQnl0ZWNvZGVMZW5ndGhNdXN0QmVEaXZpc2libGVCeTMyRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBnaXZlbkxlbmd0aCB9KSB7CiAgICAgIHN1cGVyKGBUaGUgYnl0ZWNvZGUgbGVuZ3RoIGluIGJ5dGVzIG11c3QgYmUgZGl2aXNpYmxlIGJ5IDMyLiBHaXZlbiBsZW5ndGg6ICR7Z2l2ZW5MZW5ndGh9YCwgeyBuYW1lOiAiQnl0ZWNvZGVMZW5ndGhNdXN0QmVEaXZpc2libGVCeTMyRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvaGFzaEJ5dGVjb2RlLmpzCiAgZnVuY3Rpb24gaGFzaEJ5dGVjb2RlKGJ5dGVjb2RlKSB7CiAgICBjb25zdCBieXRlY29kZUJ5dGVzID0gdG9CeXRlcyhieXRlY29kZSk7CiAgICBpZiAoYnl0ZWNvZGVCeXRlcy5sZW5ndGggJSAzMiAhPT0gMCkKICAgICAgdGhyb3cgbmV3IEJ5dGVjb2RlTGVuZ3RoTXVzdEJlRGl2aXNpYmxlQnkzMkVycm9yKHsKICAgICAgICBnaXZlbkxlbmd0aDogYnl0ZWNvZGVCeXRlcy5sZW5ndGgKICAgICAgfSk7CiAgICBpZiAoYnl0ZWNvZGVCeXRlcy5sZW5ndGggPiBtYXhCeXRlY29kZVNpemUpCiAgICAgIHRocm93IG5ldyBCeXRlY29kZUxlbmd0aEV4Y2VlZHNNYXhTaXplRXJyb3IoewogICAgICAgIGdpdmVuTGVuZ3RoOiBieXRlY29kZUJ5dGVzLmxlbmd0aCwKICAgICAgICBtYXhCeXRlY29kZVNpemUKICAgICAgfSk7CiAgICBjb25zdCBoYXNoU3RyID0gc2hhMjU2MihieXRlY29kZUJ5dGVzKTsKICAgIGNvbnN0IGhhc2gzID0gdG9CeXRlcyhoYXNoU3RyKTsKICAgIGNvbnN0IGJ5dGVjb2RlTGVuZ3RoSW5Xb3JkcyA9IGJ5dGVjb2RlQnl0ZXMubGVuZ3RoIC8gMzI7CiAgICBpZiAoYnl0ZWNvZGVMZW5ndGhJbldvcmRzICUgMiA9PT0gMCkgewogICAgICB0aHJvdyBuZXcgQnl0ZWNvZGVMZW5ndGhJbldvcmRzTXVzdEJlT2RkRXJyb3IoewogICAgICAgIGdpdmVuTGVuZ3RoSW5Xb3JkczogYnl0ZWNvZGVMZW5ndGhJbldvcmRzCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYnl0ZWNvZGVMZW5ndGggPSB0b0J5dGVzKGJ5dGVjb2RlTGVuZ3RoSW5Xb3Jkcyk7CiAgICBjb25zdCBieXRlY29kZUxlbmd0aFBhZGRlZCA9IHBhZChieXRlY29kZUxlbmd0aCwgeyBzaXplOiAyIH0pOwogICAgY29uc3QgY29kZUhhc2hWZXJzaW9uID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDBdKTsKICAgIGhhc2gzLnNldChjb2RlSGFzaFZlcnNpb24sIDApOwogICAgaGFzaDMuc2V0KGJ5dGVjb2RlTGVuZ3RoUGFkZGVkLCAyKTsKICAgIHJldHVybiBoYXNoMzsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgdmFyIGdldEVpcDcxMkRvbWFpbjIgPSAodHJhbnNhY3Rpb24pID0+IHsKICAgIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IG1lc3NhZ2UgPSB0cmFuc2FjdGlvblRvTWVzc2FnZSh0cmFuc2FjdGlvbik7CiAgICByZXR1cm4gewogICAgICBkb21haW46IHsKICAgICAgICBuYW1lOiAiemtTeW5jIiwKICAgICAgICB2ZXJzaW9uOiAiMiIsCiAgICAgICAgY2hhaW5JZDogdHJhbnNhY3Rpb24uY2hhaW5JZAogICAgICB9LAogICAgICB0eXBlczogewogICAgICAgIFRyYW5zYWN0aW9uOiBbCiAgICAgICAgICB7IG5hbWU6ICJ0eFR5cGUiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogImZyb20iLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogInRvIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJnYXNMaW1pdCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAiZ2FzUGVyUHViZGF0YUJ5dGVMaW1pdCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAibWF4RmVlUGVyR2FzIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJtYXhQcmlvcml0eUZlZVBlckdhcyIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAicGF5bWFzdGVyIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJub25jZSIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAidmFsdWUiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogImRhdGEiLCB0eXBlOiAiYnl0ZXMiIH0sCiAgICAgICAgICB7IG5hbWU6ICJmYWN0b3J5RGVwcyIsIHR5cGU6ICJieXRlczMyW10iIH0sCiAgICAgICAgICB7IG5hbWU6ICJwYXltYXN0ZXJJbnB1dCIsIHR5cGU6ICJieXRlcyIgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgcHJpbWFyeVR5cGU6ICJUcmFuc2FjdGlvbiIsCiAgICAgIG1lc3NhZ2UKICAgIH07CiAgfTsKICBmdW5jdGlvbiB0cmFuc2FjdGlvblRvTWVzc2FnZSh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBnYXMsIG5vbmNlLCB0bywgZnJvbSwgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGZhY3RvcnlEZXBzLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0LCBnYXNQZXJQdWJkYXRhLCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIHJldHVybiB7CiAgICAgIHR4VHlwZTogMTEzbiwKICAgICAgZnJvbTogQmlnSW50KGZyb20pLAogICAgICB0bzogdG8gPyBCaWdJbnQodG8pIDogMG4sCiAgICAgIGdhc0xpbWl0OiBnYXMgPz8gMG4sCiAgICAgIGdhc1BlclB1YmRhdGFCeXRlTGltaXQ6IGdhc1BlclB1YmRhdGEgPz8gZ2FzUGVyUHViZGF0YURlZmF1bHQsCiAgICAgIG1heEZlZVBlckdhczogbWF4RmVlUGVyR2FzID8/IDBuLAogICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogbWF4UHJpb3JpdHlGZWVQZXJHYXMgPz8gMG4sCiAgICAgIHBheW1hc3RlcjogcGF5bWFzdGVyID8gQmlnSW50KHBheW1hc3RlcikgOiAwbiwKICAgICAgbm9uY2U6IG5vbmNlID8gQmlnSW50KG5vbmNlKSA6IDBuLAogICAgICB2YWx1ZTogdmFsdWUgPz8gMG4sCiAgICAgIGRhdGE6IGRhdGEgPyBkYXRhIDogIjB4MCIsCiAgICAgIGZhY3RvcnlEZXBzOiBmYWN0b3J5RGVwcz8ubWFwKChkZXApID0+IHRvSGV4KGhhc2hCeXRlY29kZShkZXApKSkgPz8gW10sCiAgICAgIHBheW1hc3RlcklucHV0OiBwYXltYXN0ZXJJbnB1dCA/IHBheW1hc3RlcklucHV0IDogIjB4IgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvY2hhaW5Db25maWcuanMKICB2YXIgY2hhaW5Db25maWcgPSB7CiAgICBmb3JtYXR0ZXJzLAogICAgc2VyaWFsaXplcnMsCiAgICBjdXN0b206IHsKICAgICAgZ2V0RWlwNzEyRG9tYWluOiBnZXRFaXA3MTJEb21haW4yCiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hYnN0cmFjdFRlc3RuZXQuanMKICB2YXIgYWJzdHJhY3RUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDExMTI0LAogICAgbmFtZTogIkFic3RyYWN0IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLnRlc3RuZXQuYWJzLnh5eiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFic3RyYWN0IEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuYWJzLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEY5Y2RhNjI0RkJDN2UwNTkzNTVjZTk4YTMxNjkzZDI5OUZBQ2Q5NjMiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzU4MzQ5CiAgICAgIH0sCiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZkI2ODgzMzAzNzk5NzZEQTgxZUI2NEZlNEJGNTBkNzQwMTc2M0I5QyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MzE2ODIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FjYWxhLmpzCiAgdmFyIGFjYWxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3ODcsCiAgICBuYW1lOiAiQWNhbGEiLAogICAgbmV0d29yazogImFjYWxhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBY2FsYSIsCiAgICAgIHN5bWJvbDogIkFDQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgtcnBjLWFjYWxhLmFjYS1hcGkubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ldGgtcnBjLWFjYWxhLmFjYS1hcGkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFjYWxhIEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5hY2FsYS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuYWNhbGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FsaWVuWC5qcwogIHZhciBhbGllbnggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjQxMDI0LAogICAgbmFtZTogIkFsaWVuWCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuYWxpZW54Y2hhaW4uaW8vaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFsaWVuWCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5hbGllbnhjaGFpbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYWxpZW5YSGFsVGVzdG5ldC5qcwogIHZhciBhbGllbnhIYWxUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDI0MTAyNSwKICAgIG5hbWU6ICJBTElFTlggSGFsIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2hhbC1ycGMuYWxpZW54Y2hhaW4uaW8vaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFsaWVuWCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYWwtZXhwbG9yZXIuYWxpZW54Y2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9jb250cmFjdHMuanMKICB2YXIgY29udHJhY3RzID0gewogICAgZ2FzUHJpY2VPcmFjbGU6IHsgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwRiIgfSwKICAgIGwxQmxvY2s6IHsgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxNSIgfSwKICAgIGwyQ3Jvc3NEb21haW5NZXNzZW5nZXI6IHsKICAgICAgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwNyIKICAgIH0sCiAgICBsMkVyYzcyMUJyaWRnZTogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDE0IiB9LAogICAgbDJTdGFuZGFyZEJyaWRnZTogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwIiB9LAogICAgbDJUb0wxTWVzc2FnZVBhc3NlcjogewogICAgICBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDE2IgogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9mb3JtYXR0ZXJzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgdmFyIGZvcm1hdHRlcnMyID0gewogICAgYmxvY2s6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVCbG9jayh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXJncy50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24gPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7CiAgICAgICAgICBpZiAoZm9ybWF0dGVkLnR5cGVIZXggPT09ICIweDdlIikgewogICAgICAgICAgICBmb3JtYXR0ZWQuaXNTeXN0ZW1UeCA9IHRyYW5zYWN0aW9uLmlzU3lzdGVtVHg7CiAgICAgICAgICAgIGZvcm1hdHRlZC5taW50ID0gdHJhbnNhY3Rpb24ubWludCA/IGhleFRvQmlnSW50KHRyYW5zYWN0aW9uLm1pbnQpIDogdm9pZCAwOwogICAgICAgICAgICBmb3JtYXR0ZWQuc291cmNlSGFzaCA9IHRyYW5zYWN0aW9uLnNvdXJjZUhhc2g7CiAgICAgICAgICAgIGZvcm1hdHRlZC50eXBlID0gImRlcG9zaXQiOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdHJhbnNhY3Rpb25zLAogICAgICAgICAgc3RhdGVSb290OiBhcmdzLnN0YXRlUm9vdAogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb246IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvbih7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7fTsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3ZSIpIHsKICAgICAgICAgIHRyYW5zYWN0aW9uLmlzU3lzdGVtVHggPSBhcmdzLmlzU3lzdGVtVHg7CiAgICAgICAgICB0cmFuc2FjdGlvbi5taW50ID0gYXJncy5taW50ID8gaGV4VG9CaWdJbnQoYXJncy5taW50KSA6IHZvaWQgMDsKICAgICAgICAgIHRyYW5zYWN0aW9uLnNvdXJjZUhhc2ggPSBhcmdzLnNvdXJjZUhhc2g7CiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImRlcG9zaXQiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb25SZWNlaXB0OiAvKiBAX19QVVJFX18gKi8gZGVmaW5lVHJhbnNhY3Rpb25SZWNlaXB0KHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbDFHYXNQcmljZTogYXJncy5sMUdhc1ByaWNlID8gaGV4VG9CaWdJbnQoYXJncy5sMUdhc1ByaWNlKSA6IG51bGwsCiAgICAgICAgICBsMUdhc1VzZWQ6IGFyZ3MubDFHYXNVc2VkID8gaGV4VG9CaWdJbnQoYXJncy5sMUdhc1VzZWQpIDogbnVsbCwKICAgICAgICAgIGwxRmVlOiBhcmdzLmwxRmVlID8gaGV4VG9CaWdJbnQoYXJncy5sMUZlZSkgOiBudWxsLAogICAgICAgICAgbDFGZWVTY2FsYXI6IGFyZ3MubDFGZWVTY2FsYXIgPyBOdW1iZXIoYXJncy5sMUZlZVNjYWxhcikgOiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgfSkKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vb3Atc3RhY2svc2VyaWFsaXplcnMuanMKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uMyh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBpZiAoaXNEZXBvc2l0KHRyYW5zYWN0aW9uKSkKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRGVwb3NpdCh0cmFuc2FjdGlvbik7CiAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgfQogIHZhciBzZXJpYWxpemVyczIgPSB7CiAgICB0cmFuc2FjdGlvbjogc2VyaWFsaXplVHJhbnNhY3Rpb24zCiAgfTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkRlcG9zaXQodHJhbnNhY3Rpb24pIHsKICAgIGFzc2VydFRyYW5zYWN0aW9uRGVwb3NpdCh0cmFuc2FjdGlvbik7CiAgICBjb25zdCB7IHNvdXJjZUhhc2gsIGRhdGEsIGZyb20sIGdhcywgaXNTeXN0ZW1UeCwgbWludDogbWludDIsIHRvLCB2YWx1ZSB9ID0gdHJhbnNhY3Rpb247CiAgICBjb25zdCBzZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBbCiAgICAgIHNvdXJjZUhhc2gsCiAgICAgIGZyb20sCiAgICAgIHRvID8/ICIweCIsCiAgICAgIG1pbnQyID8gdG9IZXgobWludDIpIDogIjB4IiwKICAgICAgdmFsdWUgPyB0b0hleCh2YWx1ZSkgOiAiMHgiLAogICAgICBnYXMgPyB0b0hleChnYXMpIDogIjB4IiwKICAgICAgaXNTeXN0ZW1UeCA/ICIweDEiIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDdlIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIGlzRGVwb3NpdCh0cmFuc2FjdGlvbikgewogICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUgPT09ICJkZXBvc2l0IikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLnNvdXJjZUhhc2ggIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25EZXBvc2l0KHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGZyb20sIHRvIH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChmcm9tICYmICFpc0FkZHJlc3MoZnJvbSkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogZnJvbSB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZzIgPSB7CiAgICBjb250cmFjdHMsCiAgICBmb3JtYXR0ZXJzOiBmb3JtYXR0ZXJzMiwKICAgIHNlcmlhbGl6ZXJzOiBzZXJpYWxpemVyczIKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FuY2llbnQ4LmpzCiAgdmFyIHNvdXJjZUlkID0gMTsKICB2YXIgYW5jaWVudDggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDg4ODg4ODg4OCwKICAgIG5hbWU6ICJBbmNpZW50OCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5jaWVudDguZ2ciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBbmNpZW50OCBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmFuY2llbnQ4LmdnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4uYW5jaWVudDguZ2cvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkXTogewogICAgICAgICAgYWRkcmVzczogIjB4QjA5REMwODQyOEM4YjRFRkI0ZmY5QzA4MjczODZDREYzNDI3Nzk5NiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDYzOUYyQUVDRTM5OEFhNzZiMDdlNTllRjZhYmUyY0ZlMzJiYWNiNjgiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTA3MDU3MQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ1ZTNlRGY1YjY4MTM1RDU1OUQ1NzJFMjZiRjg2M0ZCQzE5NTAwMzMiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTA3MDU3MQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYW5jaWVudDhTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMiA9IDExMTU1MTExOwogIHZhciBhbmNpZW50OFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI4MTIyMDI0LAogICAgbmFtZTogIkFuY2llbnQ4IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjdjItdGVzdG5ldC5hbmNpZW50OC5nZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFuY2llbnQ4IENlbGVzdGlhIFRlc3RuZXQgZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2NhbnYyLXRlc3RuZXQuYW5jaWVudDguZ2ciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2NhbnYyLXRlc3RuZXQuYW5jaWVudDguZ2cvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDk0MmZENTAxN2MwRjYwNTc1OTMwRDg1NzRFYWNhMTNCRWNENmUxYkIiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZmExZDlFMjZBNmFDRDdiMjIxMTVEMjc1NzJjMTIyMUI5ODAzYzk2MCIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NzI5MDgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4RjZCYzAxNDZkM2M3NEQ0ODMwNmU3OUFlMTM0QTI2MEU0MThDOTMzNSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NzI5MDgKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYW52aWwuanMKICB2YXIgYW52aWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMzM3LAogICAgbmFtZTogIkFudmlsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzOi8vMTI3LjAuMC4xOjg1NDUiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXBlQ2hhaW4uanMKICB2YXIgc291cmNlSWQzID0gNDIxNjE7CiAgdmFyIGFwZUNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMzEzOSwKICAgIG5hbWU6ICJBcGUgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkFwZUNvaW4iLAogICAgICBzeW1ib2w6ICJBUEUiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFwZWNoYWluLmNvbS9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5hcGVjaGFpbi5jb20vd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2FwZXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmFwZXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA4ODkKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcGV4VGVzdG5ldC5qcwogIHZhciBhcGV4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzk5MywKICAgIG5hbWU6ICJBUEVYIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuYXBleGxheWVyLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLXRlc3RuZXQuYXBleGxheWVyLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAtdGVzdG5ldC5hcGV4bGF5ZXIueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Zjc2NDJiZTMzYTZiMThEMTZhOTk1NjU3YWRiNWE2OENEMDQzOGFFMiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyODM3NzUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmJpdHJ1bS5qcwogIHZhciBhcmJpdHJ1bSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNjEsCiAgICBuYW1lOiAiQXJiaXRydW0gT25lIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FyYjEuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmFyYmlzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NjU0NzA3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmJpdHJ1bUdvZXJsaS5qcwogIHZhciBhcmJpdHJ1bUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNjEzLAogICAgbmFtZTogIkFyYml0cnVtIEdvZXJsaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQXJiaXRydW0gR29lcmxpIEV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2dvZXJsaS1yb2xsdXAuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ29lcmxpLmFyYmlzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDg4MTE0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJiaXRydW1Ob3ZhLmpzCiAgdmFyIGFyYml0cnVtTm92YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNzAsCiAgICBuYW1lOiAiQXJiaXRydW0gTm92YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ub3ZhLmFyYml0cnVtLmlvL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyYmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL25vdmEuYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW5vdmEuYXJiaXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDY5NjMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FyYml0cnVtU2Vwb2xpYS5qcwogIHZhciBhcmJpdHJ1bVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyMTYxNCwKICAgIG5hbWU6ICJBcmJpdHJ1bSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBcmJpdHJ1bSBTZXBvbGlhIEV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEtcm9sbHVwLmFyYml0cnVtLmlvL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyYmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEuYXJiaXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDgxOTMwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJlb25OZXR3b3JrLmpzCiAgdmFyIGFyZW9uTmV0d29yayA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDYzLAogICAgbmFtZTogIkFyZW9uIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiQVJFQSIsIHN5bWJvbDogIkFSRUEiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMuYXJlb24ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LXdzLmFyZW9uLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmVvbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJlb25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzNTMyODYKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJlb25OZXR3b3JrVGVzdG5ldC5qcwogIHZhciBhcmVvbk5ldHdvcmtUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjIsCiAgICBuYW1lOiAiQXJlb24gTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIlRBUkVBIiwgc3ltYm9sOiAiVEFSRUEiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMuYXJlb24ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LXdzLmFyZW9uLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmVvbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJlb25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcnRlbGFUZXN0bmV0LmpzCiAgdmFyIGFydGVsYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExODIyLAogICAgbmFtZTogIkFydGVsYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJBUlQiLCBzeW1ib2w6ICJBUlQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9iZXRhbmV0LXJwYzEuYXJ0ZWxhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcnRlbGEiLAogICAgICAgIHVybDogImh0dHBzOi8vYmV0YW5ldC1zY2FuLmFydGVsYS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2JldGFuZXQtc2Nhbi5hcnRlbGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGQwN2M4NjM1Zjc2ZTg3NDVFZTcwOTJmYmI2ZThmYmM1RmVGMDlERDciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzAwMTg3MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Fzc2V0Q2hhaW4uanMKICB2YXIgYXNzZXRDaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MjAsCiAgICBuYW1lOiAiQXNzZXRDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJlYWwgV29ybGQgQXNzZXQiLAogICAgICBzeW1ib2w6ICJSV0EiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5hc3NldGNoYWluLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzc2V0IENoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uYXNzZXRjaGFpbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi5hc3NldGNoYWluLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZSwKICAgIGNvbnRyYWN0czoge30KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hc3NldENoYWluVGVzdG5ldC5qcwogIHZhciBhc3NldENoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MjEsCiAgICBuYW1lOiAiQXNzZXRDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJlYWwgV29ybGQgQXNzZXQiLAogICAgICBzeW1ib2w6ICJSV0EiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9lbnVndS1ycGMuYXNzZXRjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBc3NldCBDaGFpbiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4tdGVzdG5ldC5hc3NldGNoYWluLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLXRlc3RuZXQuYXNzZXRjaGFpbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4OTg5RjgzMkQzNTk4OGNiNWUzZUIwMDFGYTJGZTc4OTQ2OUVDMzFFYSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNzE3NwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXN0YXIuanMKICB2YXIgYXN0YXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5MiwKICAgIG5hbWU6ICJBc3RhciIsCiAgICBuZXR3b3JrOiAiYXN0YXItbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQXN0YXIiLAogICAgICBzeW1ib2w6ICJBU1RSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hc3Rhci5hcGkub25maW5hbGl0eS5pby9wdWJsaWMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBc3RhciBTdWJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2FzdGFyLnN1YnNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzYxNzk0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FzdGFyWmtFVk0uanMKICB2YXIgYXN0YXJaa0VWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzc3NiwKICAgIG5hbWU6ICJBc3RhciB6a0VWTSIsCiAgICBuZXR3b3JrOiAiQXN0YXJaa0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtemtldm0uYXN0YXIubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzdGFyIHprRVZNIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FzdGFyLXprZXZtLmV4cGxvcmVyLnN0YXJ0YWxlLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5MzUyOAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hc3RhclpreW90by5qcwogIHZhciBhc3RhclpreW90byA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAzODM2MSwKICAgIG5hbWU6ICJBc3RhciB6a0VWTSBUZXN0bmV0IHpLeW90byIsCiAgICBuZXR3b3JrOiAiekt5b3RvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5zdGFydGFsZS5jb20vemt5b3RvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiekt5b3RvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3preW90by5leHBsb3Jlci5zdGFydGFsZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTk2MTUzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXRsZXRhT2x5bXBpYS5qcwogIHZhciBhdGxldGFPbHltcGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzQwLAogICAgbmFtZTogIkF0bGV0YSBPbHltcGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIkF0bGEiLCBzeW1ib2w6ICJBVExBIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vdGVzdG5ldC1ycGMuYXRsZXRhLm5ldHdvcms6OTk0NCIsCiAgICAgICAgICAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5hdGxldGEubmV0d29yayIKICAgICAgICBdLAogICAgICAgIHdzOiBbIndzczovL3Rlc3RuZXQtcnBjLmF0bGV0YS5uZXR3b3JrOjk5NDQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdGxldGEgT2x5bXBpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmF0bGV0YS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuYXRsZXRhLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgxNDcyZWM2MzkyMTgwZmI4NEYzNDVkMjQ1NWJDQzc1QjI2NTc3MTE1IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNzY0NzMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdXJvcmEuanMKICB2YXIgYXVyb3JhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzEzMTYxNTU0LAogICAgbmFtZTogIkF1cm9yYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuYXVyb3JhLmRldiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkF1cm9yYXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXVyb3Jhc2Nhbi5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXVyb3Jhc2Nhbi5kZXYvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYyOTA3ODE2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdXJvcmFUZXN0bmV0LmpzCiAgdmFyIGF1cm9yYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMTMxNjE1NTUsCiAgICBuYW1lOiAiQXVyb3JhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LmF1cm9yYS5kZXYiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdXJvcmFzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYXVyb3Jhc2Nhbi5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5hdXJvcmFzY2FuLmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXVyb3JpYS5qcwogIHZhciBhdXJvcmlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDUyMDUsCiAgICBuYW1lOiAiQXVyb3JpYSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJhdXJvcmlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBdXJvcmlhIFN0cmF0aXMiLAogICAgICBzeW1ib2w6ICJ0U1RSQVgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXVyb3JpYS5ycGMuc3RyYXRpc2V2bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdXJvcmlhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXVyb3JpYS5leHBsb3Jlci5zdHJhdGlzZXZtLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdmFsYW5jaGUuanMKICB2YXIgYXZhbGFuY2hlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MzExNCwKICAgIG5hbWU6ICJBdmFsYW5jaGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQXZhbGFuY2hlIiwKICAgICAgc3ltYm9sOiAiQVZBWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5hdmF4Lm5ldHdvcmsvZXh0L2JjL0MvcnBjIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU25vd1RyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3Nub3d0cmFjZS5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuc25vd3RyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDExOTA3OTM0CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdmFsYW5jaGVGdWppLmpzCiAgdmFyIGF2YWxhbmNoZUZ1amkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzMTEzLAogICAgbmFtZTogIkF2YWxhbmNoZSBGdWppIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkF2YWxhbmNoZSBGdWppIiwKICAgICAgc3ltYm9sOiAiQVZBWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5hdmF4LXRlc3QubmV0d29yay9leHQvYmMvQy9ycGMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbm93VHJhY2UiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5zbm93dHJhY2UuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3RuZXQuc25vd3RyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDcwOTY5NTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iMy5qcwogIHZhciBzb3VyY2VJZDQgPSA4NDUzOwogIHZhciBiMyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODMzMywKICAgIG5hbWU6ICJCMyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMuYjMuZnVuL2h0dHAiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmIzLmZ1biIKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iM1NlcG9saWEuanMKICB2YXIgc291cmNlSWQ1ID0gMTY4NTg3NzczOwogIHZhciBiM1NlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTMsCiAgICBuYW1lOiAiQjMgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5iMy5mdW4vaHR0cCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5iMy5mdW4iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkNQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JhaGFtdXQuanMKICB2YXIgYmFoYW11dCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTE2NSwKICAgIG5ldHdvcms6ICJiYWhhbXV0IiwKICAgIG5hbWU6ICJCYWhhbXV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGYXN0dG9rZW4iLCBzeW1ib2w6ICJGVE4iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYzEuYmFoYW11dC5pbyIsCiAgICAgICAgICAiaHR0cHM6Ly9iYWhhbXV0LXJwYy5wdWJsaWNub2RlLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMyLmJhaGFtdXQuaW8iCiAgICAgICAgXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly93czEuc2FoYXJhLmJhaGFtdXRjaGFpbi5jb20iLAogICAgICAgICAgIndzczovL2JhaGFtdXQtcnBjLnB1YmxpY25vZGUuY29tIiwKICAgICAgICAgICJ3c3M6Ly93czIuc2FoYXJhLmJhaGFtdXRjaGFpbi5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGdG5zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5mdG5zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cuZnRuc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFzZS5qcwogIHZhciBzb3VyY2VJZDYgPSAxOwogIHZhciBiYXNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4NDUzLAogICAgbmFtZTogIkJhc2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5iYXNlLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJhc2VzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jhc2VzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYmFzZXNjYW4ub3JnL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4NDNlZEI4OEM0QjgwZkREMkFkRkYyNDEyQTdCZWJGOWRGNDJjQjQwZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDU2MzE1YjkwYzQwNzMwOTI1ZWM1NDg1Y2YwMDRkODM1MDU4NTE4QTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MDIyCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0OTA0ODA0NEQ1N2UxQzkyQTc3Zjc5OTg4ZDIxRmE4ZkFGNzRFOTdlIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0ODIxNDMKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4MzE1NENmMTZjY2RiNEM2ZDkyMjYyOTY2NDE3NGI5MDRkODBGMkMzNSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDgyMTQzCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jhc2VHb2VybGkuanMKICB2YXIgc291cmNlSWQ3ID0gNTsKICB2YXIgYmFzZUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogODQ1MzEsCiAgICBuYW1lOiAiQmFzZSBHb2VybGkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkdvZXJsaSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9nb2VybGkuYmFzZS5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCYXNlc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuYmFzZXNjYW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS5iYXNlc2Nhbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDJBMzU4OTFmZjMwMzEzQ2NGYTZDRTg4ZGNmMzg1OGJiMDc1QTIyOTgiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMzc2OTg4CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlOTNjOGNEMEQ0MDkzNDEyMDVBNTkyZjhjNEFjMUE1ZmU1NTg1Y2ZBIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhmQTZEOEVlNUJFNzcwRjg0RkMwMDFEMDk4QzRiRDYwNEZlMDEyODRhIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ3CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFzZVNlcG9saWEuanMKICB2YXIgc291cmNlSWQ4ID0gMTExNTUxMTE7CiAgdmFyIGJhc2VTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4NDUzMiwKICAgIG5ldHdvcms6ICJiYXNlLXNlcG9saWEiLAogICAgbmFtZTogIkJhc2UgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuYmFzZS5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCYXNlc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmJhc2VzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5iYXNlc2Nhbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkNkU2ZEJmNEY3RUEwYWM0MTJmRDhiNjVFRDI5N2U2NEJCN2EwNkUxIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ4XTogewogICAgICAgICAgYWRkcmVzczogIjB4ODQ0NTdjYTlEMDE2M0ZiQzRiYmZlNERmYmIyMGJhNDZlNDhERjI1NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0OWY1M2U0MTQ1MmM3NDU4OWU4NWNhMTY3NzQyNmJhNDI2NDU5ZTg1IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ0NjY3NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhmZDBCZjcxRjYwNjYwRTJmNjA4ZWQ1NmUxNjU5QzQ1MGVCMTEzMTIwIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ0NjY3NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA1OTY0NwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDgKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFtLmpzCiAgdmFyIGJlYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzMzcsCiAgICBuYW1lOiAiQmVhbSIsCiAgICBuZXR3b3JrOiAiYmVhbSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCZWFtIiwKICAgICAgc3ltYm9sOiAiQkVBTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYnVpbGQub25iZWFtLmNvbS9ycGMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vYnVpbGQub25iZWFtLmNvbS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlYW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc3VibmV0cy5hdmF4Lm5ldHdvcmsvYmVhbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4NDk1NmYxNWVmZGMzZGMxNjY0NWU5MGNjMzU2ZWFmYTY1ZmZjNjVlYyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFtVGVzdG5ldC5qcwogIHZhciBiZWFtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMzMzcsCiAgICBuYW1lOiAiQmVhbSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJiZWFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJlYW0iLAogICAgICBzeW1ib2w6ICJCRUFNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9idWlsZC5vbmJlYW0uY29tL3JwYy90ZXN0bmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2J1aWxkLm9uYmVhbS5jb20vd3MvdGVzdG5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlYW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc3VibmV0cy10ZXN0LmF2YXgubmV0d29yay9iZWFtIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg5YmY0OWI3MDRlZTJhMDk1Yjk1YzFmMmQ0ZWI5MDEwNTEwYzQxYzllIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFyTmV0d29ya0NoYWluTWFpbm5ldC5qcwogIHZhciBiZWFyTmV0d29ya0NoYWluTWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjQxMjMwLAogICAgbmFtZTogIkJlYXIgTmV0d29yayBDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJlYXJOZXR3b3JrQ2hhaW4iLAogICAgICBzeW1ib2w6ICJCUk5LQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JybmtjLW1haW5uZXQuYmVhcm5ldHdvcmsubmV0Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJua1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYnJua3NjYW4uYmVhcm5ldHdvcmsubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2JybmtzY2FuLmJlYXJuZXR3b3JrLm5ldC9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFyTmV0d29ya0NoYWluVGVzdG5ldC5qcwogIHZhciBiZWFyTmV0d29ya0NoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzUxMjMwLAogICAgbmFtZTogIkJlYXIgTmV0d29yayBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRCUk5LQyIsCiAgICAgIHN5bWJvbDogInRCUk5LQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JybmtjLXRlc3QuYmVhcm5ldHdvcmsubmV0Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJua1Rlc3RTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jybmt0ZXN0LXNjYW4uYmVhcm5ldHdvcmsubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jybmt0ZXN0LXNjYW4uYmVhcm5ldHdvcmsubmV0L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZXJhY2hhaW5UZXN0bmV0LmpzCiAgdmFyIGJlcmFjaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDg1LAogICAgbmFtZTogIkJlcmFjaGFpbiBBcnRpbyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCRVJBIFRva2VuIiwKICAgICAgc3ltYm9sOiAiQkVSQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FydGlvLnJwYy5iZXJhY2hhaW4uY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmVyYWNoYWluIiwKICAgICAgICB1cmw6ICJodHRwczovL2FydGlvLmJlcmF0cmFpbC5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZXJhY2hhaW5UZXN0bmV0YkFydGlvLmpzCiAgdmFyIGJlcmFjaGFpblRlc3RuZXRiQXJ0aW8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDg0LAogICAgbmFtZTogIkJlcmFjaGFpbiBiQXJ0aW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQkVSQSBUb2tlbiIsCiAgICAgIHN5bWJvbDogIkJFUkEiCiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwOTI2OQogICAgICB9CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9iYXJ0aW8ucnBjLmJlcmFjaGFpbi5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZXJhY2hhaW4gYkFydGlvIEJlcmF0cmFpbCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iYXJ0aW8uYmVyYXRyYWlsLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jldm1NYWlubmV0LmpzCiAgdmFyIGJldm1NYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTUwMSwKICAgIG5hbWU6ICJCRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJpdGNvaW4iLCBzeW1ib2w6ICJCVEMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLW1haW5uZXQtMS5iZXZtLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmV2bXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi1tYWlubmV0LmJldm0uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi1tYWlubmV0LWFwaS5iZXZtLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpZnJvc3QuanMKICB2YXIgYmlmcm9zdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzA2OCwKICAgIG5hbWU6ICJCaWZyb3N0IE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJGQyIsIHN5bWJvbDogIkJGQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3B1YmxpYy0wMS5tYWlubmV0LmJpZnJvc3RuZXR3b3JrLmNvbS9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaWZyb3N0IEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWFpbm5ldC5iaWZyb3N0bmV0d29yay5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGt1Yi5qcwogIHZhciBiaXRrdWIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk2LAogICAgbmFtZTogIkJpdGt1YiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQml0a3ViIiwgc3ltYm9sOiAiS1VCIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmJpdGt1YmNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0a3ViIENoYWluIE1haW5uZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmJrY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3d3dy5ia2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iaXRrdWJUZXN0bmV0LmpzCiAgdmFyIGJpdGt1YlRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1OTI1LAogICAgbmFtZTogIkJpdGt1YiBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJCaXRrdWIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQml0a3ViIFRlc3QiLCBzeW1ib2w6ICJ0S1VCIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuYml0a3ViY2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRrdWIgQ2hhaW4gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmJrY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuYmtjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGxheWVyLmpzCiAgdmFyIGJpdGxheWVyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDA5MDEsCiAgICBuYW1lOiAiQml0bGF5ZXIgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQlRDIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5iaXRsYXllci5vcmciXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuYml0bGF5ZXIub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYml0bGF5ZXIgbWFpbm5ldCBzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5idHJzY2FuLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGxheWVyVGVzdG5ldC5qcwogIHZhciBiaXRsYXllclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMDgxMCwKICAgIG5hbWU6ICJCaXRsYXllciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCVEMiLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMuYml0bGF5ZXIub3JnIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQtd3MuYml0bGF5ZXIub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYml0bGF5ZXIgdGVzdG5ldCBzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnRyc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0cm9jay5qcwogIHZhciBiaXRyb2NrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTcxLAogICAgbmFtZTogIkJpdHJvY2sgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQlJPQ0siLCBzeW1ib2w6ICJCUk9DSyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Jyb2NrcnBjLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0cm9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5iaXQtcm9jay5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0VG9ycmVudC5qcwogIHZhciBiaXRUb3JyZW50ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOTksCiAgICBuYW1lOiAiQml0VG9ycmVudCIsCiAgICBuZXR3b3JrOiAiYml0dG9ycmVudC1jaGFpbi1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRUb3JyZW50Iiwgc3ltYm9sOiAiQlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5iaXR0b3JyZW50Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCdHRjc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9idHRjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmJ0dGNzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzEwNzg1NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdFRvcnJlbnRUZXN0bmV0LmpzCiAgdmFyIGJpdFRvcnJlbnRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDI4LAogICAgbmFtZTogIkJpdFRvcnJlbnQgQ2hhaW4gVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiYml0dG9ycmVudC1jaGFpbi10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRUb3JyZW50Iiwgc3ltYm9sOiAiQlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RycGMuYml0dG9ycmVudGNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnR0Y3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5idHRjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5idHRjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JsYXN0LmpzCiAgdmFyIHNvdXJjZUlkOSA9IDE7CiAgdmFyIGJsYXN0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MTQ1NywKICAgIG5hbWU6ICJCbGFzdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5ibGFzdC5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsYXN0c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibGFzdHNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmJsYXN0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjEyOTI5CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ5CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmxhc3RTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMTAgPSAxMTE1NTExMTsKICB2YXIgYmxhc3RTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjg1ODc3NzMsCiAgICBuYW1lOiAiQmxhc3QgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5ibGFzdC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsYXN0c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmJsYXN0c2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5ibGFzdHNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc1NjY5MAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDEwCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iLmpzCiAgdmFyIHNvdXJjZUlkMTEgPSAxOwogIHZhciBib2IgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNjA4MDgsCiAgICBuYW1lOiAiQk9CIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdvYm9iLnh5eiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ29ib2IueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdvYm9iLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMzEzMQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDExXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZERhNTNFMjNmOGEzMjY0MGIwNEQ3MjU2ZTY1MUMxZGI5OGRCMTFDMSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0NjI2MTUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDExXTogewogICAgICAgICAgYWRkcmVzczogIjB4OEFkZUUxMjQ0NDc0MzVmRTAzZTNDRDI0ZEYzZjRjQUUzMkU2NWEzRSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0NjI2MTUKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQxMQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvYmEuanMKICB2YXIgYm9iYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjg4LAogICAgbmFtZTogIkJvYmEgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuYm9iYS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CQVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYm9iYXNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0Njg1OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iYVNlcG9saWEuanMKICB2YXIgYm9iYVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4ODgyLAogICAgbmFtZTogIkJvYmEgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NlcG9saWEuYm9iYS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CQVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5ib2Jhc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDEyID0gMTExNTUxMTE7CiAgdmFyIGJvYlNlcG9saWEgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogODA4ODEzLAogICAgbmFtZTogIkJPQiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYm9iLXNlcG9saWEucnBjLmdvYm9iLnh5eiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ib2Itc2Vwb2xpYS5ycGMuZ29ib2IueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CIFNlcG9saWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYm9iLXNlcG9saWEuZXhwbG9yZXIuZ29ib2IueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM1Njc3CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxNEQwMDY5NDUyYjRBRTJiMjUwQjM5NWI4YWRBYjc3MUU0MjY3ZDJmIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg4NjdCMUFhODcyYjlDOGNCNUU5Rjc3NTVmZURDNDVCQjI0QWQwYWU0IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQxMgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvdGFuaXhUZXN0bmV0LmpzCiAgdmFyIGJvdGFuaXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjM2LAogICAgbmFtZTogIkJvdGFuaXggVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQm90YW5peCIsIHN5bWJvbDogIkJUQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3BvYS1ub2RlLmJvdGFuaXhsYWJzLmRldiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5ib3Rhbml4bGFicy5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5ib3Rhbml4bGFicy5kZXYiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm91bmNlQml0LmpzCiAgdmFyIGJvdW5jZUJpdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAwMSwKICAgIG5hbWU6ICJCb3VuY2VCaXQgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQm91bmNlQml0Iiwgc3ltYm9sOiAiQkIiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZnVsbG5vZGUtbWFpbm5ldC5ib3VuY2ViaXRhcGkuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQkIgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iYnNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvdW5jZUJpdFRlc3RuZXQuanMKICB2YXIgYm91bmNlQml0VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNmUzLAogICAgbmFtZTogIkJvdW5jZUJpdCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCb3VuY2VCaXQiLCBzeW1ib2w6ICJCQiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9mdWxsbm9kZS10ZXN0bmV0LmJvdW5jZWJpdGFwaS5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCQiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYmJzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jyb25vcy5qcwogIHZhciBicm9ub3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMzksCiAgICBuYW1lOiAiQnJvbm9zIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJSTyIsCiAgICAgIHN5bWJvbDogIkJSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5icm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJvbm9TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jyb3NjYW4uYnJvbm9zLm9yZyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jyb25vc1Rlc3RuZXQuanMKICB2YXIgYnJvbm9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAzOCwKICAgIG5hbWU6ICJCcm9ub3MgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCcm9ub3MgQ29pbiIsCiAgICAgIHN5bWJvbDogInRCUk8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldm0tdGVzdG5ldC5icm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJvbm9TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Ricm9zY2FuLmJyb25vcy5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNjLmpzCiAgdmFyIGJzYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTYsCiAgICBuYW1lOiAiQk5CIFNtYXJ0IENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5hbmtyLmNvbS9ic2MiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCc2NTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2JzY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5ic2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTU5MjE0NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzY0dyZWVuZmllbGQuanMKICB2YXIgYnNjR3JlZW5maWVsZCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAxNywKICAgIG5hbWU6ICJCTkIgR3JlZW5maWVsZCBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCTkIiLAogICAgICBzeW1ib2w6ICJCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ncmVlbmZpZWxkLWNoYWluLmJuYmNoYWluLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJOQiBHcmVlbmZpZWxkIE1haW5uZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ncmVlbmZpZWxkc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzY1Rlc3RuZXQuanMKICB2YXIgYnNjVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTcsCiAgICBuYW1lOiAiQmluYW5jZSBTbWFydCBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogInRCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9kYXRhLXNlZWQtcHJlYnNjLTEtczEuYm5iY2hhaW4ub3JnOjg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCc2NTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnNjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3RuZXQuYnNjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDIyNDgzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNxdWFyZWQuanMKICB2YXIgYnNxdWFyZWQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMywKICAgIG5hbWU6ICJCMiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYnNxdWFyZWQubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuYnNxdWFyZWQubmV0d29yayIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzcXVhcmVkVGVzdG5ldC5qcwogIHZhciBic3F1YXJlZFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMjMsCiAgICBuYW1lOiAiQjIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5ic3F1YXJlZC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLmJzcXVhcmVkLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnRyLmpzCiAgdmFyIGJ0ciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAwOTAxLAogICAgbmFtZTogIkJpdGxheWVyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmJpdGxheWVyLm9yZyIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYml0bGF5ZXItcnBjLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYW5rci5jb20vYml0bGF5ZXIiCiAgICAgICAgXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuYml0bGF5ZXIub3JnIiwgIndzczovL3dzLmJpdGxheWVyLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRsYXllcihCVFIpIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmJ0cnNjYW4uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnRyVGVzdG5ldC5qcwogIHZhciBidHJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDA4MTAsCiAgICBuYW1lOiAiQml0bGF5ZXIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5iaXRsYXllci5vcmciXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly90ZXN0bmV0LXdzLmJpdGxheWVyLm9yZyIsCiAgICAgICAgICAid3NzOi8vdGVzdG5ldC13cy5iaXRsYXllci1ycGMuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0bGF5ZXIoQlRSKSBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnRyc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnhuLmpzCiAgdmFyIGJ4biA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDk5OSwKICAgIG5hbWU6ICJCbGFja0ZvcnQgRXhjaGFuZ2UgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQmxhY2tGb3J0IFRva2VuIiwgc3ltYm9sOiAiQlhOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5ibGFja2ZvcnQubmV0d29yay9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmJsYWNrZm9ydC5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmJsYWNrZm9ydC5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2J4blRlc3RuZXQuanMKICB2YXIgYnhuVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDc3NywKICAgIG5hbWU6ICJCbGFja0ZvcnQgRXhjaGFuZ2UgTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCbGFja0ZvcnQgVGVzdG5ldCBUb2tlbiIsCiAgICAgIHN5bWJvbDogIlRCWE4iLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ibGFja2ZvcnQubmV0d29yay9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuYmxhY2tmb3J0Lm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5ibGFja2ZvcnQubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Fubm9uLmpzCiAgdmFyIGNhbm5vbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMzNzAsCiAgICBuYW1lOiAiQ2Fubm9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHA6Ly8xMjcuMC4wLjE6ODU0NSJdIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jYW50by5qcwogIHZhciBjYW50byA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzcwMCwKICAgIG5hbWU6ICJDYW50byIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDYW50byIsCiAgICAgIHN5bWJvbDogIkNBTlRPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vY2FudG8uZ3Jhdml0eWNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVHViZXIuQnVpbGQgKEJsb2Nrc2NvdXQpIiwKICAgICAgICB1cmw6ICJodHRwczovL3R1YmVyLmJ1aWxkIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI5MDU3ODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9mZWVzLmpzCiAgdmFyIGZlZXMgPSB7CiAgICAvKgogICAgICAgKiBFc3RpbWF0ZXMgdGhlIGZlZXMgcGVyIGdhcyBmb3IgYSB0cmFuc2FjdGlvbi4KICAgIAogICAgICAgKiBJZiB0aGUgdHJhbnNhY3Rpb24gaXMgdG8gYmUgcGFpZCBpbiBhIHRva2VuIChmZWVDdXJyZW5jeSBpcyBwcmVzZW50KSB0aGVuIHRoZSBmZWVzCiAgICAgICAqIGFyZSBlc3RpbWF0ZWQgaW4gdGhlIHZhbHVlIG9mIHRoZSB0b2tlbi4gT3RoZXJ3aXNlIGZhbGxzIGJhY2sgdG8gdGhlIGRlZmF1bHQKICAgICAgICogZXN0aW1hdGlvbiBieSByZXR1cm5pbmcgbnVsbC4KICAgICAgICoKICAgICAgICogQHBhcmFtIHBhcmFtcyBmZWUgZXN0aW1hdGlvbiBmdW5jdGlvbiBwYXJhbWV0ZXJzCiAgICAgICAqLwogICAgZXN0aW1hdGVGZWVzUGVyR2FzOiBhc3luYyAocGFyYW1zKSA9PiB7CiAgICAgIGlmICghcGFyYW1zLnJlcXVlc3Q/LmZlZUN1cnJlbmN5KQogICAgICAgIHJldHVybiBudWxsOwogICAgICBjb25zdCBbbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhc10gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgZXN0aW1hdGVGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KHBhcmFtcy5jbGllbnQsIHBhcmFtcy5yZXF1ZXN0LmZlZUN1cnJlbmN5KSwKICAgICAgICBlc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzSW5GZWVDdXJyZW5jeShwYXJhbXMuY2xpZW50LCBwYXJhbXMucmVxdWVzdC5mZWVDdXJyZW5jeSkKICAgICAgXSk7CiAgICAgIGNvbnN0IHN1Z2dlc3RlZE1heEZlZVBlckdhcyA9IHBhcmFtcy5tdWx0aXBseShtYXhGZWVQZXJHYXMpICsgbWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgbWF4RmVlUGVyR2FzOiBzdWdnZXN0ZWRNYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMKICAgICAgfTsKICAgIH0KICB9OwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlUGVyR2FzSW5GZWVDdXJyZW5jeShjbGllbnQsIGZlZUN1cnJlbmN5KSB7CiAgICBjb25zdCBmZWUgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nYXNQcmljZSIsCiAgICAgIHBhcmFtczogW2ZlZUN1cnJlbmN5XQogICAgfSk7CiAgICByZXR1cm4gQmlnSW50KGZlZSk7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KGNsaWVudCwgZmVlQ3VycmVuY3kpIHsKICAgIGNvbnN0IGZlZXNQZXJHYXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9tYXhQcmlvcml0eUZlZVBlckdhcyIsCiAgICAgIHBhcmFtczogW2ZlZUN1cnJlbmN5XQogICAgfSk7CiAgICByZXR1cm4gQmlnSW50KGZlZXNQZXJHYXMpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vZm9ybWF0dGVycy5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL3V0aWxzLmpzCiAgaW5pdF90cmltKCk7CiAgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlID09PSAwIHx8IHZhbHVlID09PSAwbiB8fCB2YWx1ZSA9PT0gdm9pZCAwIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSAiMCIgfHwgdmFsdWUgPT09ICIiIHx8IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgKHRyaW0odmFsdWUpLnRvTG93ZXJDYXNlKCkgPT09ICIweCIgfHwgdHJpbSh2YWx1ZSkudG9Mb3dlckNhc2UoKSA9PT0gIjB4MDAiKTsKICB9CiAgZnVuY3Rpb24gaXNQcmVzZW50KHZhbHVlKSB7CiAgICByZXR1cm4gIWlzRW1wdHkodmFsdWUpOwogIH0KICBmdW5jdGlvbiBpc0VJUDE1NTkodHJhbnNhY3Rpb24pIHsKICAgIHJldHVybiB0eXBlb2YgdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiB0eXBlb2YgdHJhbnNhY3Rpb24ubWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiOwogIH0KICBmdW5jdGlvbiBpc0NJUDY0KHRyYW5zYWN0aW9uKSB7CiAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImNpcDY0IikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBpc0VJUDE1NTkodHJhbnNhY3Rpb24pICYmIGlzUHJlc2VudCh0cmFuc2FjdGlvbi5mZWVDdXJyZW5jeSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9mb3JtYXR0ZXJzLmpzCiAgdmFyIGZvcm1hdHRlcnMzID0gewogICAgYmxvY2s6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVCbG9jayh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXJncy50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24gPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAuLi5mb3JtYXR0ZWQsCiAgICAgICAgICAgIC4uLnRyYW5zYWN0aW9uLmdhdGV3YXlGZWUgPyB7CiAgICAgICAgICAgICAgZ2F0ZXdheUZlZTogaGV4VG9CaWdJbnQodHJhbnNhY3Rpb24uZ2F0ZXdheUZlZSksCiAgICAgICAgICAgICAgZ2F0ZXdheUZlZVJlY2lwaWVudDogdHJhbnNhY3Rpb24uZ2F0ZXdheUZlZVJlY2lwaWVudAogICAgICAgICAgICB9IDoge30sCiAgICAgICAgICAgIGZlZUN1cnJlbmN5OiB0cmFuc2FjdGlvbi5mZWVDdXJyZW5jeQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdHJhbnNhY3Rpb25zLAogICAgICAgICAgLi4uYXJncy5yYW5kb21uZXNzID8geyByYW5kb21uZXNzOiBhcmdzLnJhbmRvbW5lc3MgfSA6IHt9CiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvbjogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3ZSIpCiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpc1N5c3RlbVR4OiBhcmdzLmlzU3lzdGVtVHgsCiAgICAgICAgICAgIG1pbnQ6IGFyZ3MubWludCA/IGhleFRvQmlnSW50KGFyZ3MubWludCkgOiB2b2lkIDAsCiAgICAgICAgICAgIHNvdXJjZUhhc2g6IGFyZ3Muc291cmNlSGFzaCwKICAgICAgICAgICAgdHlwZTogImRlcG9zaXQiCiAgICAgICAgICB9OwogICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0geyBmZWVDdXJyZW5jeTogYXJncy5mZWVDdXJyZW5jeSB9OwogICAgICAgIGlmIChhcmdzLnR5cGUgPT09ICIweDdiIikKICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiY2lwNjQiOwogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKGFyZ3MudHlwZSA9PT0gIjB4N2MiKQogICAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImNpcDQyIjsKICAgICAgICAgIHRyYW5zYWN0aW9uLmdhdGV3YXlGZWUgPSBhcmdzLmdhdGV3YXlGZWUgPyBoZXhUb0JpZ0ludChhcmdzLmdhdGV3YXlGZWUpIDogbnVsbDsKICAgICAgICAgIHRyYW5zYWN0aW9uLmdhdGV3YXlGZWVSZWNpcGllbnQgPSBhcmdzLmdhdGV3YXlGZWVSZWNpcGllbnQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlcXVlc3Q6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QoewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7fTsKICAgICAgICBpZiAoYXJncy5mZWVDdXJyZW5jeSkKICAgICAgICAgIHJlcXVlc3QuZmVlQ3VycmVuY3kgPSBhcmdzLmZlZUN1cnJlbmN5OwogICAgICAgIGlmIChpc0NJUDY0KGFyZ3MpKQogICAgICAgICAgcmVxdWVzdC50eXBlID0gIjB4N2IiOwogICAgICAgIHJldHVybiByZXF1ZXN0OwogICAgICB9CiAgICB9KQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL3NlcmlhbGl6ZXJzLmpzCiAgaW5pdF9udW1iZXIoKTsKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9ub2RlKCk7CiAgaW5pdF9pc0FkZHJlc3MoKTsKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbjQodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgaWYgKGlzQ0lQNjQodHJhbnNhY3Rpb24pKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25DSVA2NCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbjModHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgfQogIHZhciBzZXJpYWxpemVyczMgPSB7CiAgICB0cmFuc2FjdGlvbjogc2VyaWFsaXplVHJhbnNhY3Rpb240CiAgfTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkNJUDY0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGFzc2VydFRyYW5zYWN0aW9uQ0lQNjQodHJhbnNhY3Rpb24pOwogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGFjY2Vzc0xpc3QsIGZlZUN1cnJlbmN5LCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpLAogICAgICBmZWVDdXJyZW5jeSwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4N2IiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgdmFyIE1BWF9NQVhfRkVFX1BFUl9HQVMgPSBtYXhVaW50MjU2OwogIGZ1bmN0aW9uIGFzc2VydFRyYW5zYWN0aW9uQ0lQNjQodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIHRvLCBmZWVDdXJyZW5jeSB9ID0gdHJhbnNhY3Rpb247CiAgICBpZiAoY2hhaW5JZCA8PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZENoYWluSWRFcnJvcih7IGNoYWluSWQgfSk7CiAgICBpZiAodG8gJiYgIWlzQWRkcmVzcyh0bykpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogdG8gfSk7CiAgICBpZiAoZ2FzUHJpY2UpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgZ2FzUHJpY2VgIGlzIG5vdCBhIHZhbGlkIENJUC02NCBUcmFuc2FjdGlvbiBhdHRyaWJ1dGUuIik7CiAgICBpZiAoaXNQcmVzZW50KG1heEZlZVBlckdhcykgJiYgbWF4RmVlUGVyR2FzID4gTUFYX01BWF9GRUVfUEVSX0dBUykKICAgICAgdGhyb3cgbmV3IEZlZUNhcFRvb0hpZ2hFcnJvcih7IG1heEZlZVBlckdhcyB9KTsKICAgIGlmIChpc1ByZXNlbnQobWF4UHJpb3JpdHlGZWVQZXJHYXMpICYmIGlzUHJlc2VudChtYXhGZWVQZXJHYXMpICYmIG1heFByaW9yaXR5RmVlUGVyR2FzID4gbWF4RmVlUGVyR2FzKQogICAgICB0aHJvdyBuZXcgVGlwQWJvdmVGZWVDYXBFcnJvcih7IG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSk7CiAgICBpZiAoaXNQcmVzZW50KGZlZUN1cnJlbmN5KSAmJiAhaXNBZGRyZXNzKGZlZUN1cnJlbmN5KSkgewogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiYGZlZUN1cnJlbmN5YCBNVVNUIGJlIGEgdG9rZW4gYWRkcmVzcyBmb3IgQ0lQLTY0IHRyYW5zYWN0aW9ucy4iKTsKICAgIH0KICAgIGlmIChpc0VtcHR5KGZlZUN1cnJlbmN5KSkgewogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiYGZlZUN1cnJlbmN5YCBtdXN0IGJlIHByb3ZpZGVkIGZvciBDSVAtNjQgdHJhbnNhY3Rpb25zLiIpOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vY2hhaW5Db25maWcuanMKICB2YXIgY2hhaW5Db25maWczID0gewogICAgY29udHJhY3RzLAogICAgZm9ybWF0dGVyczogZm9ybWF0dGVyczMsCiAgICBzZXJpYWxpemVyczogc2VyaWFsaXplcnMzLAogICAgZmVlcwogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Vsby5qcwogIHZhciBjZWxvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMywKICAgIGlkOiA0MjIyMCwKICAgIG5hbWU6ICJDZWxvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNFTE8iLAogICAgICBzeW1ib2w6ICJDRUxPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZm9ybm8uY2Vsby5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDZWxvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2NlbG9zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5jZWxvc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTMxMTI1OTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Vsb0FsZmFqb3Jlcy5qcwogIHZhciBzb3VyY2VJZDEzID0gMTdlMzsKICB2YXIgY2Vsb0FsZmFqb3JlcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzMsCiAgICBpZDogNDQ3ODcsCiAgICBuYW1lOiAiQWxmYWpvcmVzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNFTE8iLAogICAgICBzeW1ib2w6ICJBLUNFTE8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FsZmFqb3Jlcy1mb3Juby5jZWxvLXRlc3RuZXQub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2VsbyBBbGZham9yZXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY2Vsby1hbGZham9yZXMuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vY2Vsby1hbGZham9yZXMuYmxvY2tzY291dC5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMy5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0NTY5MDAxCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4ODI1MjczNTM5MjdkOEQwNjliM0I0NTI5MDRjOTQyZEExNDlCQTM4MSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4RTI4QUFkY2Q5ODgzNzQ2YzBlNTA2OEY1OGY5ZWEwNjAyN2IyMTRjYiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0YTI2MzVlOWU0ZjZlNDU4MTdiMUQ0MDJhYzQ5MDRjMWQxNzUyNDM4IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxMTMyNAogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4RDFCMEUwNTgxOTczYzllQjdmODg2OTY3QTYwNmI5NDQxQTg5NzAzNyIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2hhbmcuanMKICB2YXIgY2hhbmcgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU4NTgsCiAgICBuYW1lOiAiQ2hhbmcgQ2hhaW4gRm91bmRhdGlvbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNUSCIsCiAgICAgIHN5bWJvbDogIkNUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmN0aHNjYW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hhbmcgQ2hhaW4gZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY3Roc2Nhbi5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jaGlsaXouanMKICB2YXIgY2hpbGl6ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODg4OCwKICAgIG5hbWU6ICJDaGlsaXogQ2hhaW4iLAogICAgbmV0d29yazogImNoaWxpei1jaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDSFoiLAogICAgICBzeW1ib2w6ICJDSFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmFua3IuY29tL2NoaWxpeiIsCiAgICAgICAgICAiaHR0cHM6Ly9jaGlsaXotcnBjLnB1YmxpY25vZGUuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hpbGl6IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uY2hpbGl6LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLmNoaWxpei5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2hpcHMuanMKICB2YXIgY2hpcHMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4ODIsCiAgICBuYW1lOiAiQ2hpcHMgTmV0d29yayIsCiAgICBuZXR3b3JrOiAiQ0hJUFMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSU9UQSIsCiAgICAgIHN5bWJvbDogIklPVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vbm9kZS5jaGlwcy5vb28vd2FzcC9hcGkvdjEvY2hhaW5zL2lvdGExcHAzZDNtbmFwM3VmbWdxbmpzbnczNDRzcW1mNXN2amgyNnkya2hubWM4OXN2Njc4OHkzcjIwN2E4Zm4vZXZtIgogICAgICAgIF0KICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NsYXNzaWMuanMKICB2YXIgY2xhc3NpYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjEsCiAgICBuYW1lOiAiRXRoZXJldW0gQ2xhc3NpYyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEMiLAogICAgICBzeW1ib2w6ICJFVEMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldGMucml2ZXQubGluayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5jb20vZXRjL21haW5uZXQiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb25mbHV4RVNwYWNlLmpzCiAgdmFyIGNvbmZsdXhFU3BhY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMzAsCiAgICBuYW1lOiAiQ29uZmx1eCBlU3BhY2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkNvbmZsdXgiLCBzeW1ib2w6ICJDRlgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0uY29uZmx1eHJwYy5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtLmNvbmZsdXhycGMuY29tL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ29uZmx1eFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtLmNvbmZsdXhzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhFRmYwMDc4OTEwZjYzOGNkODE5OTZjYzExN2JjY0QzZURmMkIwNzJGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY4NjAyOTM1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb25mbHV4RVNwYWNlVGVzdG5ldC5qcwogIHZhciBjb25mbHV4RVNwYWNlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzEsCiAgICBuYW1lOiAiQ29uZmx1eCBlU3BhY2UgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiY2Z4LWVzcGFjZS10ZXN0bmV0IiwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQ29uZmx1eCIsIHN5bWJvbDogIkNGWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V2bXRlc3RuZXQuY29uZmx1eHJwYy5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtdGVzdG5ldC5jb25mbHV4cnBjLmNvbS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvbmZsdXhTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bXRlc3RuZXQuY29uZmx1eHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEVGZjAwNzg5MTBmNjM4Y2Q4MTk5NmNjMTE3YmNjRDNlRGYyQjA3MkYiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE3NDk5MDUwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb3JlRGFvLmpzCiAgdmFyIGNvcmVEYW8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTYsCiAgICBuYW1lOiAiQ29yZSBEYW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ29yZSIsCiAgICAgIHN5bWJvbDogIkNPUkUiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuY29yZWRhby5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDb3JlRGFvIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uY29yZWRhby5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE5MDc5MzQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3JhYi5qcwogIHZhciBjcmFiID0gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ0LAogICAgbmFtZTogIkNyYWIgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDcmFiIE5ldHdvcmsgTmF0aXZlIFRva2VuIiwKICAgICAgc3ltYm9sOiAiQ1JBQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vY3JhYi1ycGMuZGFyd2luaWEubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9jcmFiLXJwYy5kYXJ3aW5pYS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsgbmFtZTogIkJsb2Nrc2NvdXQiLCB1cmw6ICJodHRwczovL2NyYWItc2Nhbi5kYXJ3aW5pYS5uZXR3b3JrIiB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwMzI1OTMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb25vcy5qcwogIHZhciBjcm9ub3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1LAogICAgbmFtZTogIkNyb25vcyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyb25vcyIsCiAgICAgIHN5bWJvbDogIkNSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmNyb25vcy5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXItYXBpLmNyb25vcy5vcmcvbWFpbm5ldC9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTk2MzExMgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3Jvbm9zVGVzdG5ldC5qcwogIHZhciBjcm9ub3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMzgsCiAgICBuYW1lOiAiQ3Jvbm9zIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ1JPIiwKICAgICAgc3ltYm9sOiAidENSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS10My5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Nyb25vcy5vcmcvZXhwbG9yZXIvdGVzdG5ldDMiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTAxOTEyNTEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jcm9ub3N6a0VWTS5qcwogIHZhciBjcm9ub3N6a0VWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzg4LAogICAgbmFtZTogIkNyb25vcyB6a0VWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyb25vcyB6a0VWTSBDUk8iLAogICAgICBzeW1ib2w6ICJ6a0NSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuemtldm0uY3Jvbm9zLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNyb25vcyB6a0VWTSAoTWFpbm5ldCkgQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtldm0uY3Jvbm9zLm9yZyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb25vc3prRVZNVGVzdG5ldC5qcwogIHZhciBjcm9ub3N6a0VWTVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4MiwKICAgIG5hbWU6ICJDcm9ub3MgemtFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDcm9ub3MgemtFVk0gVGVzdCBDb2luIiwKICAgICAgc3ltYm9sOiAiemtUQ1JPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC56a2V2bS5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIHprRVZNIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtldm0uY3Jvbm9zLm9yZy90ZXN0bmV0IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb3NzYmVsbC5qcwogIHZhciBjcm9zc2JlbGwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM3MzcsCiAgICBuYW1lOiAiQ3Jvc3NiZWxsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNTQiIsCiAgICAgIHN5bWJvbDogIkNTQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNyb3NzYmVsbC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNyb3NzU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmNyb3NzYmVsbC5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLmNyb3NzYmVsbC5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzgyNDYwMzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2N1cnRpcy5qcwogIHZhciBjdXJ0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMTExLAogICAgbmFtZTogIkN1cnRpcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQXBlQ29pbiIsIHN5bWJvbDogIkFQRSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5jdXJ0aXMuYXBlY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3VydGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmN1cnRpcy5hcGVjaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3liZXIuanMKICB2YXIgY3liZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc1NjAsCiAgICBuYW1lOiAiQ3liZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vY3liZXIuYWx0LnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2N5YmVyc2Nhbi5jbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jeWJlcnNjYW4uY28vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2N5YmVyVGVzdG5ldC5qcwogIHZhciBjeWJlclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTU1NzU2MCwKICAgIG5hbWU6ICJDeWJlciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2N5YmVyLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuY3liZXJzY2FuLmNvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuY3liZXJzY2FuLmNvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZmZjMzkxRjAwMTgyNjlkNDc1OEFFQTFhMTQ0NzcyRThGQjk5NTQ1RSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDQ1NDUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kYXJ3aW5pYS5qcwogIHZhciBkYXJ3aW5pYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDYsCiAgICBuYW1lOiAiRGFyd2luaWEgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJSSU5HIiwKICAgICAgc3ltYm9sOiAiUklORyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmRhcndpbmlhLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmRhcndpbmlhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiRXhwbG9yZXIiLCB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRhcndpbmlhLm5ldHdvcmsiIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjk0MjAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RjaGFpbi5qcwogIHZhciBkY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI3MTY0NDY0Mjk4MzdlMywKICAgIG5hbWU6ICJEY2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZGNoYWluLTI3MTY0NDY0Mjk4MzcwMDAtMS5qc29ucnBjLnNhZ2FycGMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEY2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZGNoYWluLTI3MTY0NDY0Mjk4MzcwMDAtMS5zYWdhZXhwbG9yZXIuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWRjaGFpbi0yNzE2NDQ2NDI5ODM3MDAwLTEuc2FnYWV4cGxvcmVyLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzCiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZGNoYWluVGVzdG5ldC5qcwogIHZhciBkY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyNzEzMDE3OTk3NTc4ZTMsCiAgICBuYW1lOiAiRGNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9kY2hhaW50ZXN0bmV0LTI3MTMwMTc5OTc1NzgwMDAtMS5qc29ucnBjLnRlc3RuZXQuc2FnYXJwYy5pbyIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRjaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kY2hhaW50ZXN0bmV0LTI3MTMwMTc5OTc1NzgwMDAtMS50ZXN0bmV0LnNhZ2FleHBsb3Jlci5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktZGNoYWludGVzdG5ldC0yNzEzMDE3OTk3NTc4MDAwLTEudGVzdG5ldC5zYWdhZXhwbG9yZXIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZWZpY2hhaW5Fdm0uanMKICB2YXIgZGVmaWNoYWluRXZtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTMwLAogICAgbmV0d29yazogImRlZmljaGFpbi1ldm0iLAogICAgbmFtZTogIkRlRmlDaGFpbiBFVk0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRGVGaUNoYWluIiwKICAgICAgc3ltYm9sOiAiREZJIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC5tYWlubmV0Lm9jZWFuLmplbGx5ZmlzaHNkay5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEZUZpU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tZXRhLmRlZmlzY2FuLmxpdmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTM3ODUyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZWZpY2hhaW5Fdm1UZXN0bmV0LmpzCiAgdmFyIGRlZmljaGFpbkV2bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMzEsCiAgICBuZXR3b3JrOiAiZGVmaWNoYWluLWV2bS10ZXN0bmV0IiwKICAgIG5hbWU6ICJEZUZpQ2hhaW4gRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRlRmlDaGFpbiIsCiAgICAgIHN5bWJvbDogIkRGSSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgudGVzdG5ldC5vY2Vhbi5qZWxseWZpc2hzZGsuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRGVGaVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbWV0YS5kZWZpc2Nhbi5saXZlLz9uZXR3b3JrPVRlc3ROZXQiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTU2NDYyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZGVnZW4uanMKICB2YXIgZGVnZW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY2NjY2NjY2NiwKICAgIG5hbWU6ICJEZWdlbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJEZWdlbiIsCiAgICAgIHN5bWJvbDogIkRFR0VOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZGVnZW4udGlwcyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZGVnZW4udGlwcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRlZ2VuIENoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRlZ2VuLnRpcHMiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZGVnZW4udGlwcy9hcGkvdjIiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZmsuanMKICB2YXIgZGZrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MzkzNSwKICAgIG5hbWU6ICJERksgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSmV3ZWwiLAogICAgICBzeW1ib2w6ICJKRVdFTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc3VibmV0cy5hdmF4Lm5ldHdvcmsvZGVmaS1raW5nZG9tcy9kZmstY2hhaW4vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiREZLU3VibmV0U2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zdWJuZXRzLmF2YXgubmV0d29yay9kZWZpLWtpbmdkb21zIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0NzkwNTUxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kb2RvY2hhaW5UZXN0bmV0LmpzCiAgdmFyIGRvZG9jaGFpblRlc3RuZXQgPSBkZWZpbmVDaGFpbih7CiAgICBpZDogNTM0NTcsCiAgICBuYW1lOiAiRE9ET2NoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiRE9ETyIsIHN5bWJvbDogIkRPRE8iIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZG9kb2NoYWluLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZG9kb2NoYWluLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kvd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJET0RPY2hhaW4gVGVzdG5ldCAoU2Vwb2xpYSkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1zY2FuLmRvZG9jaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZG9nZWNoYWluLmpzCiAgdmFyIGRvZ2VjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMmUzLAogICAgbmFtZTogIkRvZ2VjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJXcmFwcGVkIERvZ2Vjb2luIiwKICAgICAgc3ltYm9sOiAiV0RPR0UiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZG9nZWNoYWluLmRvZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRvZ2VDaGFpbkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRvZ2VjaGFpbi5kb2ciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZG9nZWNoYWluLmRvZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDY4YTg2MDlhNjBhMDA4RUZBNjMzZGZkZWM1OTJjMDNCMDMwY0M1MDgiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjUzODQwMzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Rvc0NoYWluLmpzCiAgdmFyIGRvc0NoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3OTc5LAogICAgbmFtZTogIkRPUyBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJET1MgQ2hhaW4iLAogICAgICBzeW1ib2w6ICJET1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWluLmRvc2NoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRPUyBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kb3NjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmRvc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjE5MDgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Rvc0NoYWluVGVzdG5ldC5qcwogIHZhciBkb3NDaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM5MzksCiAgICBuYW1lOiAiRE9TIENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRE9TIENoYWluIFRlc3RuZXQiLAogICAgICBzeW1ib2w6ICJET1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0LmRvc2NoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRPUyBDaGFpbiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3QuZG9zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS10ZXN0LmRvc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2OTYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RyZXllcnhNYWlubmV0LmpzCiAgdmFyIGRyZXllcnhNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzQ1MSwKICAgIG5hbWU6ICJEcmV5ZXJYIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRyZXllclgiLAogICAgICBzeW1ib2w6ICJEUlgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmRyZXllcnguY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRHJleWVyWCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uZHJleWVyeC5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kcmV5ZXJ4VGVzdG5ldC5qcwogIHZhciBkcmV5ZXJ4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjM0NTIsCiAgICBuYW1lOiAiRHJleWVyWCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJEcmV5ZXJYIiwKICAgICAgc3ltYm9sOiAiRFJYIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vdGVzdG5ldC1ycGMuZHJleWVyeC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEcmV5ZXJYIFRlc3RuZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXNjYW4uZHJleWVyeC5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZHVzdGJveUlvVC5qcwogIHZhciBkdXN0Ym95SW9UID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NTU4ODgsCiAgICBuYW1lOiAiRHVzdEJveSBJb1QiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRFNUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZHVzdGJveS1ycGMuamlibDIuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kdXN0Ym95LmppYmwyLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9kdXN0Ym95LmppYmwyLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEZGRDM0YWEyQzYyQjJENTJFMDBBMzYxZTQ2NkMyMjk3ODhmNGVENmEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTI2NTY5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2R5bWVuc2lvbi5qcwogIHZhciBkeW1lbnNpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMDAsCiAgICBuYW1lOiAiRHltZW5zaW9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJEWU0iLAogICAgICBzeW1ib2w6ICJEWU0iLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZHltZW5zaW9uLWV2bS1ycGMucHVibGljbm9kZS5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZHltZW5zaW9uLWV2bS1ycGMucHVibGljbm9kZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEeW0gRllJIiwKICAgICAgICB1cmw6ICJodHRwczovL2R5bS5meWkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VkZ2VsZXNzLmpzCiAgdmFyIGVkZ2VsZXNzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDI2LAogICAgbmFtZTogIkVkZ2VsZXNzIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkVkZ2VsZXNzIFdyYXBwZWQgRVRIIiwKICAgICAgc3ltYm9sOiAiRXdFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmVkZ2VsZXNzLm5ldHdvcmsvaHR0cCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZWRnZWxlc3MubmV0d29yay93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVkZ2VsZXNzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmVkZ2VsZXNzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lZGdlbGVzc1Rlc3RuZXQuanMKICB2YXIgZWRnZWxlc3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDIsCiAgICBuYW1lOiAiRWRnZWxlc3MgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRWRnZWxlc3MgV3JhcHBlZCBFVEgiLAogICAgICBzeW1ib2w6ICJFd0VUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9lZGdlbGVzcy10ZXN0bmV0LnJwYy5jYWxkZXJhLnh5ei9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2VkZ2VsZXNzLXRlc3RuZXQucnBjLmNhbGRlcmEueHl6L3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWRnZWxlc3MgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLmVkZ2VsZXNzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lZGdld2FyZS5qcwogIHZhciBlZGdld2FyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAyMSwKICAgIG5hbWU6ICJFZGdld2FyZSBFZGdlRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRWRnZXdhcmUiLAogICAgICBzeW1ib2w6ICJFREciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9lZGdld2FyZS1ldm0uamVsbGllZG93bC5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFZGdzY2FuIGJ5IEJoYXJhdGhjb29yZyIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lZGdzY2FuLmxpdmUiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZWRnc2Nhbi5saXZlL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxODExNzg3MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWRnZXdhcmVUZXN0bmV0LmpzCiAgdmFyIGVkZ2V3YXJlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAyMiwKICAgIG5hbWU6ICJCZXJlc2hlZXQgQmVyZUVWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRlc3RuZXQgRURHIiwKICAgICAgc3ltYm9sOiAidEVERyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JlcmVzaGVldC1ldm0uamVsbGllZG93bC5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFZGdzY2FuIGJ5IEJoYXJhdGhjb29yZyIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmVkZ3NjYW4ubGl2ZSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmVkZ3NjYW4ubGl2ZS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9la3RhLmpzCiAgdmFyIGVrdGEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTQsCiAgICBuYW1lOiAiRWt0YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFS1RBIiwKICAgICAgc3ltYm9sOiAiRUtUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW4uZWt0YS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVrdGFzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2VrdGFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2VrdGFzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VrdGFUZXN0bmV0LmpzCiAgdmFyIGVrdGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDA0LAogICAgbmFtZTogIkVrdGEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFS1RBIiwKICAgICAgc3ltYm9sOiAiRUtUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3QuZWt0YS5pbzo4NTQ1Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVzdCBFa3Rhc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0LmVrdGFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3QuZWt0YXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsYXN0b3MuanMKICB2YXIgZWxhc3RvcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAsCiAgICBuYW1lOiAiRWxhc3RvcyBTbWFydCBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRUxBIiwgc3ltYm9sOiAiRUxBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpMi5lbGFzdG9zLmlvL2V0aCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVsYXN0b3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXNjLmVsYXN0b3MuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsYXN0b3NUZXN0bmV0LmpzCiAgdmFyIGVsYXN0b3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMSwKICAgIG5hbWU6ICJFbGFzdG9zIFNtYXJ0IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInRFTEEiLCBzeW1ib2w6ICJ0RUxBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLXRlc3RuZXQuZWxhc3Rvcy5pby9ldGgiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFbGFzdG9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VzYy10ZXN0bmV0LmVsYXN0b3MuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWxlY3Ryb25ldW0uanMKICB2YXIgZWxlY3Ryb25ldW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMDE0LAogICAgbmFtZTogIkVsZWN0cm9uZXVtIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkVUTiIsCiAgICAgIHN5bWJvbDogIkVUTiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZWxlY3Ryb25ldW0uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWxlY3Ryb25ldW0gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tleHBsb3Jlci5lbGVjdHJvbmV1bS5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsZWN0cm9uZXVtVGVzdG5ldC5qcwogIHZhciBlbGVjdHJvbmV1bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMDE0MjAsCiAgICBuYW1lOiAiRWxlY3Ryb25ldW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRVROIiwKICAgICAgc3ltYm9sOiAiRVROIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLmVsZWN0cm9uZXVtLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVsZWN0cm9uZXVtIEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2NrZXhwbG9yZXIudGhlc2VjdXJpdHl0ZWFtLnJvY2tzIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VseXNpdW1UZXN0bmV0LmpzCiAgdmFyIGVseXNpdW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxMzM4LAogICAgbmFtZTogIkVseXNpdW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJMQVZBIiwKICAgICAgc3ltYm9sOiAiTEFWQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZWx5c2l1bS10ZXN0LXJwYy52dWxjYW5mb3JnZWQuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWx5c2l1bSB0ZXN0bmV0IGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VseXNpdW0tZXhwbG9yZXIudnVsY2FuZm9yZ2VkLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lb24uanMKICB2YXIgZW9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MzMyLAogICAgbmFtZTogIkhvcml6ZW4gRU9OIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlpFTiIsCiAgICAgIHN5bWJvbDogIlpFTiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2Vvbi1ycGMuaG9yaXplbmxhYnMuaW8vZXRodjEiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFT04gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZW9uLWV4cGxvcmVyLmhvcml6ZW5sYWJzLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Vvcy5qcwogIHZhciBlb3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3Nzc3LAogICAgbmFtZTogIkVPUyBFVk0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRU9TIiwKICAgICAgc3ltYm9sOiAiRU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmV2bS5lb3NuZXR3b3JrLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVPUyBFVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLmVvc25ldHdvcmsuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmV2bS5lb3NuZXR3b3JrLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzk0MzkzMwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZW9zVGVzdG5ldC5qcwogIHZhciBlb3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU1NywKICAgIG5hbWU6ICJFT1MgRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRU9TIiwKICAgICAgc3ltYm9sOiAiRU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRU9TIEVWTSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5MDY3OTQwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXRoZXJsaW5rLmpzCiAgdmFyIGV0aGVybGluayA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI3OTMsCiAgICBuYW1lOiAiRXRoZXJsaW5rIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRleiIsCiAgICAgIHN5bWJvbDogIlhUWiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL25vZGUubWFpbm5ldC5ldGhlcmxpbmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJsaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV0aGVybGluay5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzM4OTkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2V0aGVybGlua1Rlc3RuZXQuanMKICB2YXIgZXRoZXJsaW5rVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4MTIzLAogICAgbmFtZTogIkV0aGVybGluayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRleiIsCiAgICAgIHN5bWJvbDogIlhUWiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL25vZGUuZ2hvc3RuZXQuZXRoZXJsaW5rLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybGluayBUZXN0bmV0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuZXRoZXJsaW5rLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ldm1vcy5qcwogIHZhciBldm1vcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTAwMSwKICAgIG5hbWU6ICJFdm1vcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdm1vcyIsCiAgICAgIHN5bWJvbDogIkVWTU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXRoLmJkLmV2bW9zLm9yZzo4NTQ1Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXZtb3MgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXNjYW4ubGl2ZSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2V2bW9zVGVzdG5ldC5qcwogIHZhciBldm1vc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDllMywKICAgIG5hbWU6ICJFdm1vcyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV2bW9zIiwKICAgICAgc3ltYm9sOiAiRVZNT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldGguYmQuZXZtb3MuZGV2Ojg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdm1vcyBUZXN0bmV0IEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bS5ldm1vcy5kZXYvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXhjZWxvbk1haW5uZXQuanMKICB2YXIgZXhjZWxvbk1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMDUyMDAyLAogICAgbmFtZTogIkV4Y2Vsb24gTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiWExPTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFeGNlbG9uIiwKICAgICAgc3ltYm9sOiAieGxvbiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZWRnZXdhbGxldDEueGxvbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeGNlbG9uIGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4Y2Vsb24uaW8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mYW50b20uanMKICB2YXIgZmFudG9tID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNTAsCiAgICBuYW1lOiAiRmFudG9tIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZhbnRvbSIsCiAgICAgIHN5bWJvbDogIkZUTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5hbmtyLmNvbS9mYW50b20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGVE1TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Z0bXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5mdG1zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzMwMDE5ODcKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZhbnRvbVNvbmljVGVzdG5ldC5qcwogIHZhciBmYW50b21Tb25pY1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY0MjQwLAogICAgbmFtZTogIkZhbnRvbSBTb25pYyBPcGVuIFRlc3RuZXQiLAogICAgbmV0d29yazogImZhbnRvbS1zb25pYy10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZhbnRvbSIsCiAgICAgIHN5bWJvbDogIkZUTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwY2FwaS5zb25pYy5mYW50b20ubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZhbnRvbSBTb25pYyBPcGVuIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcHVibGljLXNvbmljLmZhbnRvbS5uZXR3b3JrIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZhbnRvbVRlc3RuZXQuanMKICB2YXIgZmFudG9tVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDAwMiwKICAgIG5hbWU6ICJGYW50b20gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGYW50b20iLAogICAgICBzeW1ib2w6ICJGVE0iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5mYW50b20ubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZUTVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mdG1zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmZ0bXNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA4MzI4Njg4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmliby5qcwogIHZhciBmaWJvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMwNiwKICAgIG5hbWU6ICJGaWJvIENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogImZpYm8iLAogICAgICBzeW1ib2w6ICJGSUJPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbmV0d29yay5oenJvYy5hcnQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGaWJvU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmZpYm9jaGFpbi5vcmciCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9maWxlY29pbi5qcwogIHZhciBmaWxlY29pbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzE0LAogICAgbmFtZTogIkZpbGVjb2luIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiZmlsZWNvaW4iLAogICAgICBzeW1ib2w6ICJGSUwiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkubm9kZS5nbGlmLmlvL3JwYy92MSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZpbGZveCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9maWxmb3guaW5mby9lbiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzI4NTk0CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9maWxlY29pbkNhbGlicmF0aW9uLmpzCiAgdmFyIGZpbGVjb2luQ2FsaWJyYXRpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxNDE1OSwKICAgIG5hbWU6ICJGaWxlY29pbiBDYWxpYnJhdGlvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJ0ZXN0bmV0IGZpbGVjb2luIiwKICAgICAgc3ltYm9sOiAidEZJTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5jYWxpYnJhdGlvbi5ub2RlLmdsaWYuaW8vcnBjL3YxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmlsc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jYWxpYnJhdGlvbi5maWxzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZpbGVjb2luSHlwZXJzcGFjZS5qcwogIHZhciBmaWxlY29pbkh5cGVyc3BhY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxNDEsCiAgICBuYW1lOiAiRmlsZWNvaW4gSHlwZXJzcGFjZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJ0ZXN0bmV0IGZpbGVjb2luIiwKICAgICAgc3ltYm9sOiAidEZJTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5oeXBlcnNwYWNlLm5vZGUuZ2xpZi5pby9ycGMvdjEiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGaWxmb3giLAogICAgICAgIHVybDogImh0dHBzOi8vaHlwZXJzcGFjZS5maWxmb3guaW5mby9lbiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbGFyZS5qcwogIHZhciBmbGFyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTQsCiAgICBuYW1lOiAiRmxhcmUgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGbGFyZSIsCiAgICAgIHN5bWJvbDogIkZMUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2ZsYXJlLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZsYXJlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2ZsYXJlLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZmxhcmUtZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzAwMjQ2MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmxhcmVUZXN0bmV0LmpzCiAgdmFyIGZsYXJlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTE0LAogICAgbmFtZTogIkZsYXJlIFRlc3RuZXQgQ29zdG9uMiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3N0b24yIEZsYXJlIiwKICAgICAgc3ltYm9sOiAiQzJGTFIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9jb3N0b24yLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvc3RvbjIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY29zdG9uMi1leHBsb3Jlci5mbGFyZS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Nvc3RvbjItZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmxvd01haW5uZXQuanMKICB2YXIgZmxvd01haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc0NywKICAgIG5hbWU6ICJGbG93RVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRmxvdyIsCiAgICAgIHN5bWJvbDogIkZMT1ciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuZXZtLm5vZGVzLm9uZmxvdy5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Zsb3dkaXZlci5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Zsb3dQcmV2aWV3bmV0LmpzCiAgdmFyIGZsb3dQcmV2aWV3bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NDYsCiAgICBuYW1lOiAiRmxvd0VWTSBQcmV2aWV3bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZsb3ciLAogICAgICBzeW1ib2w6ICJGTE9XIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wcmV2aWV3bmV0LmV2bS5ub2Rlcy5vbmZsb3cub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUHJldmlld25ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wcmV2aWV3bmV0LmZsb3dkaXZlci5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MjA1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbG93VGVzdG5ldC5qcwogIHZhciBmbG93VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTQ1LAogICAgbmFtZTogIkZsb3dFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGbG93IiwKICAgICAgc3ltYm9sOiAiRkxPVyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ldm0ubm9kZXMub25mbG93Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZsb3cgRGl2ZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mbG93ZGl2ZXIuaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTM3NTE4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbHVlbmNlLmpzCiAgdmFyIGZsdWVuY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk5OTk5OTksCiAgICBuYW1lOiAiRmx1ZW5jZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRkxUIiwgc3ltYm9sOiAiRkxUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQuZmx1ZW5jZS5kZXYiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MubWFpbm5ldC5mbHVlbmNlLmRldiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYWlubmV0LmZsdWVuY2UuZGV2IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQubWFpbm5ldC5mbHVlbmNlLmRldi9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbHVlbmNlU3RhZ2UuanMKICB2YXIgZmx1ZW5jZVN0YWdlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjM0MjAwMDAyMjAsCiAgICBuYW1lOiAiRmx1ZW5jZSBTdGFnZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEZMVCIsIHN5bWJvbDogInRGTFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RhZ2UuZmx1ZW5jZS5kZXYiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3Muc3RhZ2UuZmx1ZW5jZS5kZXYiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuc3RhZ2UuZmx1ZW5jZS5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5zdGFnZS5mbHVlbmNlLmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmx1ZW5jZVRlc3RuZXQuanMKICB2YXIgZmx1ZW5jZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMTY0ODAzLAogICAgbmFtZTogIkZsdWVuY2UgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEZMVCIsIHN5bWJvbDogInRGTFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5mbHVlbmNlLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy50ZXN0bmV0LmZsdWVuY2UuZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnRlc3RuZXQuZmx1ZW5jZS5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC50ZXN0bmV0LmZsdWVuY2UuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mb3JtYS5qcwogIHZhciBmb3JtYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTg0MTIyLAogICAgbmFtZTogIkZvcm1hIiwKICAgIG5ldHdvcms6ICJmb3JtYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBzeW1ib2w6ICJUSUEiLAogICAgICBuYW1lOiAiVElBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5mb3JtYS5hcnQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuZm9ybWEuYXJ0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRm9ybWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZm9ybWEuYXJ0IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhkNTNDNkZGQjEyM0Y3MzQ5QTMyOTgwRjg3ZmFlRDhGZkRjOWVmMDc5IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1MjcwNQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZm91bmRyeS5qcwogIHZhciBmb3VuZHJ5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMTMzNywKICAgIG5hbWU6ICJGb3VuZHJ5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzOi8vMTI3LjAuMC4xOjg1NDUiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnJheHRhbC5qcwogIHZhciBzb3VyY2VJZDE0ID0gMTsKICB2YXIgZnJheHRhbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjUyLAogICAgbmFtZTogIkZyYXh0YWwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZyYXggRXRoZXIiLCBzeW1ib2w6ICJmcnhFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZnJheC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJmcmF4c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mcmF4c2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmZyYXhzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDY2Q0M5MTZFZDVDNkMyRkE5NzAxNGY3RDFjRDE0MTUyOEFlMTcxZTQiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzNmNiNjVjMTk2N0EwRmIwRUVFMTE1NjlDNTFDMmYyYUExQ2E2ZjZEIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTkxMzUzMjMKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQxNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDM0QzBiRDU4NzdBNUVlNzA5OUQwZjU2ODhENjVGNGJCOTE1OEJERTIiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTEzNTMyMwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnJheHRhbFRlc3RuZXQuanMKICB2YXIgc291cmNlSWQxNSA9IDE3ZTM7CiAgdmFyIGZyYXh0YWxUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyNTIyLAogICAgbmFtZTogIkZyYXh0YWwgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnJheCBFdGhlciIsIHN5bWJvbDogImZyeEVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmZyYXguY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiZnJheHNjYW4gdGVzdG5ldCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ob2xlc2t5LmZyYXhzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktaG9sZXNreS5mcmF4c2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MTVFQTY0REExM0Y0ZDA4MzFlY2U0QWQzRThjMWFhMDEzMTY3RjMyIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDE1XTogewogICAgICAgICAgYWRkcmVzczogIjB4QjljNjRCZkE0OThkNWI5YTgzOThFZDZmNDZlYjc2ZDkwZEU1NTA1ZCIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxODQxNgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDE1XTogewogICAgICAgICAgYWRkcmVzczogIjB4MEJhYWZDMjE3MTYyZjY0OTMwOTA5YUQ5ZjJCMjcxMjUxMjFkNjMzMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxODQxNgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE1CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVua2lNYWlubmV0LmpzCiAgdmFyIHNvdXJjZUlkMTYgPSAxOwogIHZhciBmdW5raU1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDMzOTc5LAogICAgbmFtZTogIkZ1bmtpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy1tYWlubmV0LmZ1bmtpY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRnVua2kgTWFpbm5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mdW5raXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cwogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE2CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVua2lTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMTcgPSAxMTE1NTExMTsKICB2YXIgZnVua2lTZXBvbGlhID0gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDMzOTc5MDEsCiAgICBuZXR3b3JrOiAiZnVua2lTZXBvbGlhIiwKICAgIG5hbWU6ICJGdW5raSBTZXBvbGlhIFNhbmRib3giLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZnVua2ktdGVzdG5ldC5hbHQudGVjaG5vbG9neSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZ1bmtpIFNlcG9saWEgU2FuZGJveCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLXNhbmRib3guZnVua2ljaGFpbi5jb20vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjIwMjA0CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQxNwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Z1c2UuanMKICB2YXIgZnVzZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIyLAogICAgbmFtZTogIkZ1c2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZ1c2UiLCBzeW1ib2w6ICJGVVNFIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5mdXNlLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRnVzZSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5mdXNlLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmZ1c2UuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MTQ2NjI4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdXNlU3BhcmtuZXQuanMKICB2YXIgZnVzZVNwYXJrbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMsCiAgICBuYW1lOiAiRnVzZSBTcGFya25ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3BhcmsiLCBzeW1ib2w6ICJTUEFSSyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZnVzZXNwYXJrLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3BhcmtlbnQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZnVzZXNwYXJrLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmZ1c2VzcGFyay5pby9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdXNpb24uanMKICB2YXIgZnVzaW9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjY1OSwKICAgIG5hbWU6ICJGdXNpb24gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnVzaW9uIiwgc3ltYm9sOiAiRlNOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5mdXNpb25uZXR3b3JrLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuZnVzaW9ubmV0d29yay5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZTTnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZnNuc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA0NDE2MDUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVzaW9uVGVzdG5ldC5qcwogIHZhciBmdXNpb25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjY4OCwKICAgIG5hbWU6ICJGdXNpb24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnVzaW9uIiwgc3ltYm9sOiAiRlNOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5mdXNpb25uZXR3b3JrLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQuZnVzaW9ubmV0d29yay5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZTTnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mc25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQyODMwOQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dhcm5ldC5qcwogIHZhciBzb3VyY2VJZDE4ID0gMTdlMzsKICB2YXIgZ2FybmV0ID0gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgbmFtZTogIkdhcm5ldCBUZXN0bmV0IiwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBpZDogMTcwNjksCiAgICBzb3VyY2VJZDogc291cmNlSWQxOCwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5nYXJuZXRjaGFpbi5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmdhcm5ldGNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZ2FybmV0Y2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDU3ZWU0MDU4NmZiRTI4NkFmQzc1RTY3Y2I2OTUxMUE2RDlhRjU5MDkiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjc0Njg0CiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDE4XTogewogICAgICAgICAgYWRkcmVzczogIjB4Q2I4RTdBQzU2MWI4RUYwNEYyYTE1ODY1ZTlmYmMwNzY2RkVGNTY5QiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyNzQ2ODQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQxOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDA5YmNEZDMxMUZFMzk4RjgwYTc4QkUzN0U0ODlmNUQ0NDBEQjk1REUiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjc0Njg0CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ2VuZXN5cy5qcwogIHZhciBnZW5lc3lzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjUwNywKICAgIG5hbWU6ICJHZW5lc3lzIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR1NZUyIsCiAgICAgIHN5bWJvbDogIkdTWVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ2VuZXN5cy5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR2VuZXN5cyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nY2hhaW5leHBsb3Jlci5nZW5lc3lzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npcy5qcwogIHZhciBnbm9zaXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMCwKICAgIG5hbWU6ICJHbm9zaXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdub3Npc2NoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ25vc2lzY2hhaW4uY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkdub3Npc3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ25vc2lzc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuZ25vc2lzc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjEwMjI0OTEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npc0NoaWFkby5qcwogIHZhciBnbm9zaXNDaGlhZG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAwLAogICAgbmFtZTogIkdub3NpcyBDaGlhZG8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNoaWFkb2NoYWluLm5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuY2hpYWRvY2hhaW4ubmV0L3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NjczMTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9nb2JpLmpzCiAgdmFyIGdvYmkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NjMsCiAgICBuYW1lOiAiSG9yaXplbiBHb2JpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVzdCBaRU4iLAogICAgICBzeW1ib2w6ICJ0WkVOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZ29iaS10ZXN0bmV0Lmhvcml6ZW5sYWJzLmlvL2V0aHYxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR29iaSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2JpLWV4cGxvcmVyLmhvcml6ZW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvQ2hhaW4uanMKICB2YXIgZ29DaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAsCiAgICBuYW1lOiAiR29DaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJHTyIsCiAgICAgIHN5bWJvbDogIkdPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmdvY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHb0NoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdvY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvZXJsaS5qcwogIHZhciBnb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUsCiAgICBuYW1lOiAiR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJHb2VybGkgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vZXRoX2dvZXJsaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1nb2VybGkuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZmM0QUM3NUM0NkM5MTRhRjU4OTJkNmQzZUZGY2ViRDc5MTcyOTNGMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMzOTIwNgogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2NTA3NjcwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3Jhdml0eS5qcwogIHZhciBncmF2aXR5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjI1LAogICAgbmFtZTogIkdyYXZpdHkgQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRyIsIHN5bWJvbDogIkciLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3Jhdml0eS54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHcmF2aXR5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZjhhYzRCRUIyRjc1ZDJjRkZiNTg4YzYzMjUxMzQ3ZmRENjI5QjkyYyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjg1MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3VydVRlc3RuZXQuanMKICB2YXIgZ3VydVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI2MSwKICAgIG5hbWU6ICJHdXJ1IE5ldHdvcmsgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAidGVzdEdVUlUiLAogICAgICBzeW1ib2w6ICJ0R1VSVSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3VydW5ldHdvcmsuYWkvYXJjaGl2ZS8yNjEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHdXJ1c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmd1cnVuZXR3b3JrLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhbS5qcwogIHZhciBoYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUxMTIsCiAgICBuYW1lOiAiSGFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkhhbSIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmhhbS5mdW4iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmhhbS5mdW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIYW0gQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFtLmZ1biIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYW0uZnVuL2FwaS92MiIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcXFNYWlubmV0LmpzCiAgdmFyIGhhcXFNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTIzNSwKICAgIG5hbWU6ICJIQVFRIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmV0aC5oYXFxLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIQVFRIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYXFxLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFxcVRlc3RlZGdlMi5qcwogIHZhciBoYXFxVGVzdGVkZ2UyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NDIxMSwKICAgIG5hbWU6ICJIQVFRIFRlc3RlZGdlIDIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTVQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5ldGgudGVzdGVkZ2UyLmhhcXEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhBUVEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdGVkZ2UyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0ZWRnZTIuaGFxcS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcmRoYXQuanMKICB2YXIgaGFyZGhhdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEzMzcsCiAgICBuYW1lOiAiSGFyZGhhdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFybW9ueU9uZS5qcwogIHZhciBoYXJtb255T25lID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjY2NmU1LAogICAgbmFtZTogIkhhcm1vbnkgT25lIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJIYXJtb255IiwKICAgICAgc3ltYm9sOiAiT05FIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vaGFybW9ueSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhcm1vbnkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFybW9ueS5vbmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxODU3NTMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhc2hrZXlDaGFpblRlc3RuZXQuanMKICB2YXIgaGFzaGtleVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMywKICAgIG5hbWU6ICJIYXNoS2V5IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSGFzaEtleSBFY29Qb2ludHMiLAogICAgICBzeW1ib2w6ICJIU0siCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2hhc2hrZXljaGFpbi10ZXN0bmV0LmFsdC50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaEtleSBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXNoa2V5Y2hhaW4tdGVzdG5ldC1leHBsb3Jlci5hbHQudGVjaG5vbG9neSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYS5qcwogIHZhciBoZWRlcmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NSwKICAgIG5hbWU6ICJIZWRlcmEgTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLW1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL21haW5uZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYVByZXZpZXduZXQuanMKICB2YXIgaGVkZXJhUHJldmlld25ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjk3LAogICAgbmFtZTogIkhlZGVyYSBQcmV2aWV3bmV0IiwKICAgIG5ldHdvcms6ICJoZWRlcmEtcHJldmlld25ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBzeW1ib2w6ICJIQkFSIiwKICAgICAgbmFtZTogIkhCQVIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcHJldmlld25ldC5oYXNoaW8uaW8vYXBpIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGFzaHNjYW4uaW8vcHJldmlld25ldCIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oZWRlcmFUZXN0bmV0LmpzCiAgdmFyIGhlZGVyYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NiwKICAgIG5hbWU6ICJIZWRlcmEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL3Rlc3RuZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVsYS5qcwogIHZhciBoZWxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NjY4LAogICAgbmFtZTogIkhlbGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiSExVU0QiLAogICAgICBzeW1ib2w6ICJITFVTRCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5oZWxhY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGVsYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tYWlubmV0LWJsb2NrZXhwbG9yZXIuaGVsYWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVtaVNlcG9saWEuanMKICB2YXIgaGVtaVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc0MzExMSwKICAgIG5hbWU6ICJIZW1pIFNlcG9saWEiLAogICAgbmV0d29yazogIkhlbWkgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ycGMuaGVtaS5uZXR3b3JrL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhlbWkgU2Vwb2xpYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLmhlbWkueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hvbGVza3kuanMKICB2YXIgaG9sZXNreSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTdlMywKICAgIG5hbWU6ICJIb2xlc2t5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJIb2xlc2t5IEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoZXJldW0taG9sZXNreS1ycGMucHVibGljbm9kZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaG9sZXNreS5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWhvbGVza3kuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NwogICAgICB9LAogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODAxNjEzCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YTZBQzkzNUQ0OTcxRTNDRDEzM2I5NTBhRTA1M2JFQ0QxNmZFN2YzYiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5NzM0ODQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oeWNoYWluLmpzCiAgdmFyIGh5Y2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEsCiAgICBuYW1lOiAiSFlDSEFJTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oeWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaHljaGFpblRlc3RuZXQuanMKICB2YXIgaHljaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEyLAogICAgbmFtZTogIkhZQ0hBSU4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5oeWNoYWluLmNvbS9odHRwIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ltbXV0YWJsZVprRXZtLmpzCiAgdmFyIGltbXV0YWJsZVprRXZtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3MSwKICAgIG5hbWU6ICJJbW11dGFibGUgemtFVk0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5pbW11dGFibGUuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSW1tdXRhYmxlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmltbXV0YWJsZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuaW1tdXRhYmxlLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDIzNmJkQTQ1ODllNDRlNjg1MGY1YUM2YTc0QmZDYTM5OGE4NmM2YzAiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDMzNTk3MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaW1tdXRhYmxlWmtFdm1UZXN0bmV0LmpzCiAgdmFyIGltbXV0YWJsZVprRXZtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTM0NzMsCiAgICBuYW1lOiAiSW1tdXRhYmxlIHprRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmltbXV0YWJsZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJJbW11dGFibGUgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LmltbXV0YWJsZS5jb20vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgyQ0M3ODdFZDM2NDYwMEIwMjIyMzYxQzQxODgzMDhGYThFNjhiQTYwIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU5NzczOTEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pbkVWTS5qcwogIHZhciBpbkVWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjUyNSwKICAgIG5hbWU6ICJpbkVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkluamVjdGl2ZSIsCiAgICAgIHN5bWJvbDogIklOSiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQucnBjLmluZXZtLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiaW5FVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaW5ldm0uY2FsZGVyYWV4cGxvcmVyLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9pbmV2bS5jYWxkZXJhZXhwbG9yZXIueHl6L2FwaS92MiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTg2MDYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGEuanMKICB2YXIgaW90YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODgyMiwKICAgIG5hbWU6ICJJT1RBIEVWTSIsCiAgICBuZXR3b3JrOiAiaW90YWV2bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJJT1RBIiwKICAgICAgc3ltYm9sOiAiSU9UQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vanNvbi1ycGMuZXZtLmlvdGFsZWRnZXIubmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLmpzb24tcnBjLmV2bS5pb3RhbGVkZ2VyLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV2bS5pb3RhLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uaW90YS5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1MDIyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pb3RhVGVzdG5ldC5qcwogIHZhciBpb3RhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTA3NSwKICAgIG5hbWU6ICJJT1RBIEVWTSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJpb3RhZXZtLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSU9UQSIsCiAgICAgIHN5bWJvbDogIklPVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS50ZXN0bmV0LmlvdGFsZWRnZXIubmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLmpzb24tcnBjLmV2bS50ZXN0bmV0LmlvdGFsZWRnZXIubmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGV4LmpzCiAgdmFyIGlvdGV4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Njg5LAogICAgbmFtZTogIklvVGVYIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIklvVGVYIiwKICAgICAgc3ltYm9sOiAiSU9UWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYmFiZWwtYXBpLm1haW5uZXQuaW90ZXguaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vYmFiZWwtYXBpLm1haW5uZXQuaW90ZXguaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJJb1RlWFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaW90ZXhzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyMTYzNjcwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pb3RleFRlc3RuZXQuanMKICB2YXIgaW90ZXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjkwLAogICAgbmFtZTogIklvVGVYIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW9UZVgiLAogICAgICBzeW1ib2w6ICJJT1RYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9iYWJlbC1hcGkudGVzdG5ldC5pb3RleC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9iYWJlbC1hcGkudGVzdG5ldC5pb3RleC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIklvVGVYU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmlvdGV4c2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YjVjZWNENjg5NGM2ZjQ3M0VjNzI2QTE3NmYxNTEyMzk5QTJlMzU1ZCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNDM0NzU5MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2piYy5qcwogIHZhciBqYmMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4OTksCiAgICBuYW1lOiAiSklCQ0hBSU4gTDEiLAogICAgbmV0d29yazogImpiYyIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSkJDIiwgc3ltYm9sOiAiSkJDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLWwxLmppYmNoYWluLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLWwxLmppYmNoYWluLm5ldCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAtbDEuamliY2hhaW4ubmV0L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzBDOEM0ODZEMTQ2NkM1N0VmZTEzQzJiZjAwMGQ0YzU2RjQ3Q0JkQyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMjk5MDQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2piY1Rlc3RuZXQuanMKICB2YXIgamJjVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg5OTEsCiAgICBuYW1lOiAiSmliY2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEpCQyIsIHN5bWJvbDogInRKQkMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5qaWJjaGFpbi5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cC50ZXN0bmV0LmppYmNoYWluLm5ldCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAudGVzdG5ldC5qaWJjaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhhMWE4NThhZDkwNDFCNDc0MWU2MjAzNTVhM0Y5NkIzYzc4ZTcwZWNFIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMyODQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2FydXJhLmpzCiAgdmFyIGthcnVyYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjg2LAogICAgbmFtZTogIkthcnVyYSIsCiAgICBuZXR3b3JrOiAia2FydXJhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJLYXJ1cmEiLAogICAgICBzeW1ib2w6ICJLQVIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoLXJwYy1rYXJ1cmEuYWNhLWFwaS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V0aC1ycGMta2FydXJhLmFjYS1hcGkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthcnVyYSBCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQua2FydXJhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5rYXJ1cmEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2tha2Fyb3RTZXBvbGlhLmpzCiAgdmFyIGtha2Fyb3RTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxODAyMjAzNzY0LAogICAgbmFtZTogIktha2Fyb3QgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS1ycGMua2FrYXJvdC5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLYWthcm90IFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5rYWthcm90c2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2FrYXJvdFN0YXJrbmV0U2Vwb2xpYS5qcwogIHZhciBrYWthcm90U3RhcmtuZXRTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5MjA2Mzc5MDcyODgxNjUsCiAgICBuYW1lOiAiS2FrYXJvdCBTdGFya25ldCBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5rYWthcm90Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktha2Fyb3QgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmtha2Fyb3RzY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYXZhLmpzCiAgdmFyIGthdmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMjIsCiAgICBuYW1lOiAiS2F2YSBFVk0iLAogICAgbmV0d29yazogImthdmEtbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiS2F2YSIsCiAgICAgIHN5bWJvbDogIktBVkEiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5rYXZhLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2F2YSBFVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8va2F2YXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2thdmFzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzY2MTE2NQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYXZhVGVzdG5ldC5qcwogIHZhciBrYXZhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjIyMSwKICAgIG5hbWU6ICJLYXZhIEVWTSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJrYXZhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkthdmEiLAogICAgICBzeW1ib2w6ICJLQVZBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldm0udGVzdG5ldC5rYXZhLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2F2YSBFVk0gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmthdmFzY2FuLmNvbS8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5rYXZhc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhEZjFENzI0QTcxNjYyNjFlRUIwMTU0MThmZThjNzY3OUJCRWE3ZmQ2IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDcyNDIxNzkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rY2MuanMKICB2YXIga2NjID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjEsCiAgICBuYW1lOiAiS0NDIE1haW5uZXQiLAogICAgbmV0d29yazogIktDQyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIktDUyIsCiAgICAgIHN5bWJvbDogIktDUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8va2NjLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiS0NDIEV4cGxvcmVyIiwgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rY2MuaW8iIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE3NjA0MzAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2ludG8uanMKICB2YXIga2ludG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc4ODcsCiAgICBuYW1lOiAiS2ludG8gTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiS2ludG8gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmtpbnRvLnh5ei9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2ludG8gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIua2ludG8ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rbGF5dG4uanMKICB2YXIga2xheXRuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MjE3LAogICAgbmFtZTogIktsYXl0biIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLbGF5dG4iLAogICAgICBzeW1ib2w6ICJLTEFZIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLWVuLWN5cHJlc3Mua2xheXRuLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktsYXl0blNjb3BlIiwKICAgICAgICB1cmw6ICJodHRwczovL3Njb3BlLmtsYXl0bi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTYwMDI0MTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2thaWEuanMKICB2YXIga2FpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODIxNywKICAgIG5hbWU6ICJLYWlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkthaWEiLAogICAgICBzeW1ib2w6ICJLQUlBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLWVuLm5vZGUua2FpYS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthaWFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2thaWFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1jeXByZXNzLmtsYXl0bnNjb3BlLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTYwMDI0MTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2thaXJvcy5qcwogIHZhciBrYWlyb3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMDEsCiAgICBuYW1lOiAiS2Fpcm9zIFRlc3RuZXQiLAogICAgbmV0d29yazogImthaXJvcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLYWlyb3MgS0FJQSIsCiAgICAgIHN5bWJvbDogIktBSUEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wdWJsaWMtZW4ta2Fpcm9zLm5vZGUua2FpYS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthaWFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2thaXJvcy5rYWlhc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjMzOTA1OTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rbGF5dG5CYW9iYWIuanMKICB2YXIga2xheXRuQmFvYmFiID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDAxLAogICAgbmFtZTogIktsYXl0biBCYW9iYWIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAia2xheXRuLWJhb2JhYiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCYW9iYWIgS2xheXRuIiwKICAgICAgc3ltYm9sOiAiS0xBWSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1lbi1iYW9iYWIua2xheXRuLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktsYXl0blNjb3BlIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jhb2JhYi5rbGF5dG5zY29wZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTIzMzkwNTkzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva29pLmpzCiAgdmFyIGtvaSA9IGRlZmluZUNoYWluKHsKICAgIGlkOiA3MDEsCiAgICBuYW1lOiAiS29pIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiS29pIE5ldHdvcmsgTmF0aXZlIFRva2VuIiwKICAgICAgc3ltYm9sOiAiS1JJTkciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2tvaS1ycGMuZGFyd2luaWEubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9rb2ktcnBjLmRhcndpbmlhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiQmxvY2tzY291dCIsIHVybDogImh0dHBzOi8va29pLXNjYW4uZGFyd2luaWEubmV0d29yayIgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxODAwMDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rcm9tYS5qcwogIHZhciBrcm9tYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjU1LAogICAgbmFtZTogIktyb21hIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFVEgiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkua3JvbWEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktyb21hIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQua3JvbWEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lmtyb21hLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rcm9tYVNlcG9saWEuanMKICB2YXIga3JvbWFTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzU4LAogICAgbmFtZTogIktyb21hIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkuc2Vwb2xpYS5rcm9tYS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS3JvbWEgU2Vwb2xpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnNlcG9saWEua3JvbWEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnNlcG9saWEua3JvbWEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbDN4LmpzCiAgdmFyIGwzeCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMjQsCiAgICBuYW1lOiAiTDNYIFByb3RvY29sIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy1tYWlubmV0LmwzeC5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLW1haW5uZXQubDN4LmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkwzWCBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmwzeC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIubDN4LmNvbS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2wzeFRlc3RuZXQuanMKICB2YXIgbDN4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMjUsCiAgICBuYW1lOiAiTDNYIFByb3RvY29sIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQubDN4LmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtdGVzdG5ldC5sM3guY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTDNYIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItdGVzdG5ldC5sM3guY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQubDN4LmNvbS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGF2aXRhLmpzCiAgdmFyIGxhdml0YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzYwODkwLAogICAgbmFtZTogIkxBVklUQSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJ2VEZVRUwiLCBzeW1ib2w6ICJ2VEZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90c3ViMzYwODkwLWV0aC1ycGMudGhldGF0b2tlbi5vcmcvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTEFWSVRBIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3RzdWIzNjA4OTAtZXhwbG9yZXIudGhldGF0b2tlbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpZ2h0bGlua1BlZ2FzdXMuanMKICB2YXIgbGlnaHRsaW5rUGVnYXN1cyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTg5MSwKICAgIG5hbWU6ICJMaWdodExpbmsgUGVnYXN1cyBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJsaWdodGxpbmstcGVnYXN1cyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcmVwbGljYXRvci5wZWdhc3VzLmxpZ2h0bGluay5pby9ycGMvdjEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMaWdodExpbmsgUGVnYXN1cyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wZWdhc3VzLmxpZ2h0bGluay5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saWdodGxpbmtQaG9lbml4LmpzCiAgdmFyIGxpZ2h0bGlua1Bob2VuaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4OTAsCiAgICBuYW1lOiAiTGlnaHRMaW5rIFBob2VuaXggTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAibGlnaHRsaW5rLXBob2VuaXgiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JlcGxpY2F0b3IucGhvZW5peC5saWdodGxpbmsuaW8vcnBjL3YxIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTGlnaHRMaW5rIFBob2VuaXggRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGhvZW5peC5saWdodGxpbmsuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vbGluZWEvYWN0aW9ucy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfcGFyc2VBY2NvdW50KCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfZ2V0Q2FsbEVycm9yKCk7CiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZUdhczIoY2xpZW50LCBhcmdzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQgfSA9IGFyZ3M7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoKTsKICAgIGNvbnN0IGFjY291bnQgPSBwYXJzZUFjY291bnQoYWNjb3VudF8pOwogICAgdHJ5IHsKICAgICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBibG9ja051bWJlciwgYmxvY2tUYWcsIGRhdGEsIGdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG5vbmNlLCB0bywgdmFsdWUsIC4uLnJlc3QgfSA9IGFyZ3M7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWc7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGNoYWluRm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdDsKICAgICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAvLyBQaWNrIG91dCBleHRyYSBkYXRhIHRoYXQgbWlnaHQgZXhpc3Qgb24gdGhlIGNoYWluJ3MgdHJhbnNhY3Rpb24gcmVxdWVzdCB0eXBlLgogICAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICBkYXRhLAogICAgICAgIGdhcywKICAgICAgICBnYXNQcmljZSwKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgbm9uY2UsCiAgICAgICAgdG8sCiAgICAgICAgdmFsdWUKICAgICAgfSk7CiAgICAgIGNvbnN0IHsgYmFzZUZlZVBlckdhcywgZ2FzTGltaXQsIHByaW9yaXR5RmVlUGVyR2FzIH0gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAibGluZWFfZXN0aW1hdGVHYXMiLAogICAgICAgIHBhcmFtczogYmxvY2sgPyBbcmVxdWVzdCwgYmxvY2tdIDogW3JlcXVlc3RdCiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGJhc2VGZWVQZXJHYXM6IEJpZ0ludChiYXNlRmVlUGVyR2FzKSwKICAgICAgICBnYXNMaW1pdDogQmlnSW50KGdhc0xpbWl0KSwKICAgICAgICBwcmlvcml0eUZlZVBlckdhczogQmlnSW50KHByaW9yaXR5RmVlUGVyR2FzKQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHRocm93IGdldENhbGxFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9saW5lYS9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZzQgPSB7CiAgICBmZWVzOiB7CiAgICAgIGVzdGltYXRlRmVlc1BlckdhczogZXN0aW1hdGVGZWVzUGVyR2FzMiwKICAgICAgYXN5bmMgbWF4UHJpb3JpdHlGZWVQZXJHYXMoeyBibG9jaywgY2xpZW50LCByZXF1ZXN0IH0pIHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVzdGltYXRlRmVlc1BlckdhczIoewogICAgICAgICAgYmxvY2ssCiAgICAgICAgICBjbGllbnQsCiAgICAgICAgICBtdWx0aXBseTogKHgpID0+IHgsCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgdHlwZTogImVpcDE1NTkiCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFyZXNwb25zZT8ubWF4UHJpb3JpdHlGZWVQZXJHYXMpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gcmVzcG9uc2UubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIH0KICAgIH0KICB9OwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlc1BlckdhczIoeyBjbGllbnQsIG11bHRpcGx5LCByZXF1ZXN0LCB0eXBlIH0pIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZXN0aW1hdGVHYXMyKGNsaWVudCwgewogICAgICAgIC4uLnJlcXVlc3QsCiAgICAgICAgYWNjb3VudDogcmVxdWVzdD8uYWNjb3VudAogICAgICB9KTsKICAgICAgY29uc3QgeyBwcmlvcml0eUZlZVBlckdhczogbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSA9IHJlc3BvbnNlOwogICAgICBjb25zdCBiYXNlRmVlUGVyR2FzID0gbXVsdGlwbHkoQmlnSW50KHJlc3BvbnNlLmJhc2VGZWVQZXJHYXMpKTsKICAgICAgY29uc3QgbWF4RmVlUGVyR2FzID0gYmFzZUZlZVBlckdhcyArIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICBpZiAodHlwZSA9PT0gImxlZ2FjeSIpCiAgICAgICAgcmV0dXJuIHsgZ2FzUHJpY2U6IG1heEZlZVBlckdhcyB9OwogICAgICByZXR1cm4gewogICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfSBjYXRjaCB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYS5qcwogIHZhciBsaW5lYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzQsCiAgICBpZDogNTkxNDQsCiAgICBuYW1lOiAiTGluZWEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTGluZWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmxpbmVhLmJ1aWxkIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2xpbmVhc2Nhbi5idWlsZCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkubGluZWFzY2FuLmJ1aWxkL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYUdvZXJsaS5qcwogIHZhciBsaW5lYUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTkxNDAsCiAgICBuYW1lOiAiTGluZWEgR29lcmxpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkxpbmVhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdvZXJsaS5saW5lYS5idWlsZCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ29lcmxpLmxpbmVhLmJ1aWxkIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS5saW5lYXNjYW4uYnVpbGQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWdvZXJsaS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5ODYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpbmVhU2Vwb2xpYS5qcwogIHZhciBsaW5lYVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWc0LAogICAgaWQ6IDU5MTQxLAogICAgbmFtZTogIkxpbmVhIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTGluZWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2Vwb2xpYS5saW5lYS5idWlsZCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuc2Vwb2xpYS5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmxpbmVhc2Nhbi5idWlsZCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyNzQyNwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpbmVhVGVzdG5ldC5qcwogIHZhciBsaW5lYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5MTQwLAogICAgbmFtZTogIkxpbmVhIEdvZXJsaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJMaW5lYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5nb2VybGkubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmdvZXJsaS5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkubGluZWFzY2FuLmJ1aWxkIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5ODYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpc2suanMKICB2YXIgc291cmNlSWQxOSA9IDE7CiAgdmFyIGxpc2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMzUsCiAgICBuYW1lOiAiTGlzayIsCiAgICBuZXR3b3JrOiAibGlzayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFwaS5saXNrLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5saXNrLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lmxpc2suY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4QTlkNzFFMWRkN2NhMjZGMjZlNjU2RTY2ZDZBQTgxZWQ3Zjc0NWJmMCIKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDExM2NCOTkyODNBRjI0MkRhMEEwQzU0MzQ3NjY3ZWRGNTMxQWE3ZDYiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDI2ZEI5M0Y4YjhiNGY3MDE2MjQwYWY2MkY3NzMwOTc5ZDM1M2Y5QTciCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMTldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNjU4NzIzQmY3MGM3NjY3RGU2QjI1Rjk5ZmNjZTEzQTE2RDI1ZDA4IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE5CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGlza1NlcG9saWEuanMKICB2YXIgc291cmNlSWQyMCA9IDExMTU1MTExOwogIHZhciBsaXNrU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDIwMiwKICAgIG5ldHdvcms6ICJsaXNrLXNlcG9saWEiLAogICAgbmFtZTogIkxpc2sgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5zZXBvbGlhLWFwaS5saXNrLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS1ibG9ja3Njb3V0Lmxpc2suY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NlcG9saWEtYmxvY2tzY291dC5saXNrLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEEwRTM1RjU2QzMxOERFMWJENUQ5Y2E2QTk0RmU3ZTM3QzU2NjMzNDgiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlM2Q5MEYyMTQ5MDY4NkVjN2VGMzdCRTc4OEUwMmRmQzEyNzg3MjY0IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIwXTogewogICAgICAgICAgYWRkcmVzczogIjB4MUZiMzBlNDQ2ZUE3OTFjZDFmMDExNjc1RTVGM2Y1MzExYjcwZmFGNSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjAKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9sb2NhbGhvc3QuanMKICB2YXIgbG9jYWxob3N0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3LAogICAgbmFtZTogIkxvY2FsaG9zdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbG9vcC5qcwogIHZhciBsb29wID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU1MSwKICAgIG5hbWU6ICJMb29wTmV0d29yayBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJMT09QIiwKICAgICAgc3ltYm9sOiAiTE9PUCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkubWFpbm5ldGxvb3AuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTG9vcE5ldHdvcmsgQmxvY2tjaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0bG9vcC5jb20vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9sdWtzby5qcwogIHZhciBsdWtzbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIsCiAgICBuZXR3b3JrOiAibHVrc28iLAogICAgbmFtZTogIkxVS1NPIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJMVUtTTyIsCiAgICAgIHN5bWJvbDogIkxZWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWFpbm5ldC5sdWtzby5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLXJwYy5tYWlubmV0Lmx1a3NvLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMVUtTTyBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4ZWN1dGlvbi5tYWlubmV0Lmx1a3NvLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV4cGxvcmVyLmV4ZWN1dGlvbi5tYWlubmV0Lmx1a3NvLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ2ODE4MwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbHVrc29UZXN0bmV0LmpzCiAgdmFyIGx1a3NvVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIwMSwKICAgIG5hbWU6ICJMVUtTTyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkxVS1NPIFRlc3RuZXQiLAogICAgICBzeW1ib2w6ICJMWVh0IgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5sdWtzby5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLXJwYy50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMVUtTTyBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4ZWN1dGlvbi50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV4cGxvcmVyLmV4ZWN1dGlvbi50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYwNTM0OAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2x5Y2FuLmpzCiAgdmFyIGx5Y2FuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MjEsCiAgICBuYW1lOiAiTHljYW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTHljYW4iLAogICAgICBzeW1ib2w6ICJMWUMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJodHRwczovL3VzLWVhc3QubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgImh0dHBzOi8vdXMtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ldS1ub3J0aC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ldS13ZXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJodHRwczovL2FzaWEtc291dGhlYXN0Lmx5Y2FuY2hhaW4uY29tIgogICAgICAgIF0sCiAgICAgICAgd2ViU29ja2V0OiBbCiAgICAgICAgICAid3NzOi8vcnBjLmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly91cy1lYXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly91cy13ZXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly9ldS1ub3J0aC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vZXUtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vYXNpYS1zb3V0aGVhc3QubHljYW5jaGFpbi5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMeWNhbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5seWNhbmNoYWluLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2x5cmEuanMKICB2YXIgbHlyYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTU3LAogICAgbmFtZTogIkx5cmEgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmx5cmEuZmluYW5jZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkx5cmEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubHlyYS5maW5hbmNlIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmx5cmEuZmluYW5jZS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTkzNTE5OAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFpbm5ldC5qcwogIHZhciBtYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxLAogICAgbmFtZTogIkV0aGVyZXVtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Nsb3VkZmxhcmUtZXRoLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgZW5zUmVnaXN0cnk6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMDAwMDAwMDAwMEMyRTA3NGVDNjlBMGRGYjI5OTdCQTZDN2QyZTFlIgogICAgICB9LAogICAgICBlbnNVbml2ZXJzYWxSZXNvbHZlcjogewogICAgICAgIGFkZHJlc3M6ICIweGNlMDFmOGVlZTdFNDc5QzkyOEY4OTE5YWJENTNFNTUzYTM2Q2VGNjciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTkyNTgyMTMKICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQzNTM2MDEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbmRhbGEuanMKICB2YXIgbWFuZGFsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTk1LAogICAgbmFtZTogIk1hbmRhbGEgVEM5IiwKICAgIG5ldHdvcms6ICJtYW5kYWxhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJNYW5kYWxhIiwKICAgICAgc3ltYm9sOiAibUFDQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgtcnBjLXRjOS5hY2Etc3RhZ2luZy5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V0aC1ycGMtdGM5LmFjYS1zdGFnaW5nLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW5kYWxhIEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYW5kYWxhLmFjYS1zdGFnaW5nLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYW5kYWxhLmFjYS1zdGFnaW5nLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRhLmpzCiAgdmFyIG1hbnRhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjksCiAgICBuYW1lOiAiTWFudGEgUGFjaWZpYyBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJtYW50YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wYWNpZmljLXJwYy5tYW50YS5uZXR3b3JrL2h0dHAiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wYWNpZmljLWV4cGxvcmVyLm1hbnRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5tYW50YS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzI4OTAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRhU2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgbWFudGFTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzQ0MTAwNiwKICAgIG5hbWU6ICJNYW50YSBQYWNpZmljIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAibWFudGEtc2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3BhY2lmaWMtcnBjLnNlcG9saWEtdGVzdG5ldC5tYW50YS5uZXR3b3JrL2h0dHAiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50YSBTZXBvbGlhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5zZXBvbGlhLXRlc3RuZXQubWFudGEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9wYWNpZmljLWV4cGxvcmVyLnNlcG9saWEtdGVzdG5ldC5tYW50YS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2E1NDkxOGY3QjUyNUM4ZGY4OTQ2Njg4NDY1MDY3Njc0MTJiNTNFMyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0Nzk1ODQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50YVRlc3RuZXQuanMKICB2YXIgbWFudGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNDQxMDA1LAogICAgbmFtZTogIk1hbnRhIFBhY2lmaWMgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAibWFudGEtdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYW50YS10ZXN0bmV0LmNhbGRlcmFjaGFpbi54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1hbnRhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci50ZXN0bmV0Lm1hbnRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci50ZXN0bmV0Lm1hbnRhLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgyMTFCMTY0M2I5NUZlNzZmMTFlRDg4ODBFRTgxMEFCRDlBNGNmNTZDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQxOTkxNQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRsZS5qcwogIHZhciBtYW50bGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDVlMywKICAgIG5hbWU6ICJNYW50bGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTU5UIiwKICAgICAgc3ltYm9sOiAiTU5UIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLm1hbnRsZS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50bGUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vbWFudGxlc2Nhbi54eXovIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5tYW50bGVzY2FuLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzA0NzE3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50bGVTZXBvbGlhVGVzdG5ldC5qcwogIHZhciBtYW50bGVTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAwMywKICAgIG5hbWU6ICJNYW50bGUgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1OVCIsCiAgICAgIHN5bWJvbDogIk1OVCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5zZXBvbGlhLm1hbnRsZS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50bGUgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zZXBvbGlhLm1hbnRsZS54eXovIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnNlcG9saWEubWFudGxlLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDU4NDAxMgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRsZVRlc3RuZXQuanMKICB2YXIgbWFudGxlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAwMSwKICAgIG5hbWU6ICJNYW50bGUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNTlQiLAogICAgICBzeW1ib2w6ICJNTlQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5tYW50bGUueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGxlIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5tYW50bGUueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQubWFudGxlLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTYxMzMzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFwUHJvdG9jb2wuanMKICB2YXIgbWFwUHJvdG9jb2wgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyNzc2LAogICAgbmFtZTogIk1BUCBQcm90b2NvbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNQVBPIiwKICAgICAgc3ltYm9sOiAiTUFQTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tYXBsYWJzLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTUFQTyBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21hcG9zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYXRjaGFpbi5qcwogIHZhciBtYXRjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjk4LAogICAgbmFtZTogIk1hdGNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCTkIiLAogICAgICBzeW1ib2w6ICJCTkIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tYXRjaGFpbi5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1hdGNoYWluIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbWF0Y2hzY2FuLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWF0Y2hhaW5UZXN0bmV0LmpzCiAgdmFyIG1hdGNoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjk5LAogICAgbmFtZTogIk1hdGNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMubWF0Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYXRjaGFpbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQubWF0Y2hzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21lcmxpbi5qcwogIHZhciBtZXJsaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyMDAsCiAgICBuYW1lOiAiTWVybGluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCVEMiLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tZXJsaW5jaGFpbi5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5tZXJsaW5jaGFpbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLm1lcmxpbmNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFjaGFpbi5qcwogIHZhciBtZXRhY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MSwKICAgIG5hbWU6ICJNZXRhQ2hhaW4gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTWV0YXRpbWUgQ29pbiIsIHN5bWJvbDogIk1UQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXRhdGltZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRhRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWV0YXRpbWUuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAzMDAxIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFjaGFpbklzdGFuYnVsLmpzCiAgdmFyIG1ldGFjaGFpbklzdGFuYnVsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDUzLAogICAgbmFtZTogIk1ldGFDaGFpbiBJc3RhbmJ1bCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTWV0YXRpbWUgQ29pbiIsIHN5bWJvbDogIk1UQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2lzdGFuYnVsLXJwYy5tZXRhY2hhaW4uZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWV0YUV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2lzdGFuYnVsLWV4cGxvcmVyLm1ldGFjaGFpbi5kZXYiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDMwMDEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFsTDIuanMKICB2YXIgc291cmNlSWQyMSA9IDE7CiAgdmFyIG1ldGFsTDIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDE3NTAsCiAgICBuYW1lOiAiTWV0YWwgTDIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXRhbGwyLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMubWV0YWxsMi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRhbGwyLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRhbGwyLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDNCMUY3YURhMEZjYzI2QjEzNTE1YWY3NTJEZDA3ZkIxQ0FjMTE0MjYiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDIxXTogewogICAgICAgICAgYWRkcmVzczogIjB4M0YzN2FCZEUyQzZiNUIyZWQ2RjgwNDU3ODdEZjFFRDFFMzc1Mzk1NiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyMV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZkMGY2NUQ1OWI1NUIwRkVDNWQyZDE1MzY1MTU0RGNBREMxNDBCRjMiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjEKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXRlci5qcwogIHZhciBtZXRlciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODIsCiAgICBuYW1lOiAiTWV0ZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTVRSIiwKICAgICAgc3ltYm9sOiAiTVRSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLm1ldGVyLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWV0ZXJTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ubWV0ZXIuaW8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXRlclRlc3RuZXQuanMKICB2YXIgbWV0ZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MywKICAgIG5hbWU6ICJNZXRlciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1UUiIsCiAgICAgIHN5bWJvbDogIk1UUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwY3Rlc3QubWV0ZXIuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRlclRlc3RuZXRTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4td2FycmluZ3N0YWtlcy5tZXRlci5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGlzLmpzCiAgdmFyIG1ldGlzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDg4LAogICAgbmFtZTogIk1ldGlzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1ldGlzIiwKICAgICAgc3ltYm9sOiAiTUVUSVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hbmRyb21lZGEubWV0aXMuaW8vP293bmVyPTEwODgiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRpcyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRpcy5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkucm91dGVzY2FuLmlvL3YyL25ldHdvcmsvbWFpbm5ldC9ldm0vMTA4OC9ldGhlcnNjYW4vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIzMzg1NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGlzR29lcmxpLmpzCiAgdmFyIG1ldGlzR29lcmxpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1OTksCiAgICBuYW1lOiAiTWV0aXMgR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1ldGlzIEdvZXJsaSIsCiAgICAgIHN5bWJvbDogIk1FVElTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZ29lcmxpLmdhdGV3YXkubWV0aXNkZXZvcHMubGluayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1ldGlzIEdvZXJsaSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuZXhwbG9yZXIubWV0aXNkZXZvcHMubGluayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9nb2VybGkuZXhwbG9yZXIubWV0aXNkZXZvcHMubGluay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTAwNjIwNwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV2LmpzCiAgdmFyIG1ldiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzUxOCwKICAgIG5hbWU6ICJNRVZlcnNlIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTUVWZXJzZSIsCiAgICAgIHN5bWJvbDogIk1FViIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1ldmVyc2VtYWlubmV0LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm1ldmVyc2VzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDg2ODgxMzQwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXZUZXN0bmV0LmpzCiAgdmFyIG1ldlRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ3NTksCiAgICBuYW1lOiAiTUVWZXJzZSBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1FVmVyc2UiLAogICAgICBzeW1ib2w6ICJNRVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXZlcnNldGVzdG5ldC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQubWV2ZXJzZXNjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY0MzcxMTE1CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWludC5qcwogIHZhciBtaW50ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxODUsCiAgICBuYW1lOiAiTWludCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5taW50Y2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNaW50Y2hhaW4gZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWludGNoYWluLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9taW50U2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgbWludFNlcG9saWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjg2LAogICAgbmFtZTogIk1pbnQgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLm1pbnRjaGFpbi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1pbnRjaGFpbiBUZXN0bmV0IGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIubWludGNoYWluLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vZGUuanMKICB2YXIgc291cmNlSWQyMiA9IDE7CiAgdmFyIG1vZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDM0NDQzLAogICAgbmFtZTogIk1vZGUgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0Lm1vZGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vZGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21vZGVzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0NjU4ODIKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQzMTdiYTE0NkQ0OTMzRDg4OTUxOGEzZTVFMTFGZTdhNTMxOTliMDQiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDhCMzRiMTRjN2M3MTIzNDU5Q2YzMDc2YjhDYjkyOUJFMDk3ZDBDMDciCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MzVhREJiRTcyMjI2QkQ1MmU4MThFNzE4MTk1M2Y0MkUzYjBGRjIxIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDIyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9kZVRlc3RuZXQuanMKICB2YXIgc291cmNlSWQyMyA9IDExMTU1MTExOwogIHZhciBtb2RlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogOTE5LAogICAgbmFtZTogIk1vZGUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLm1vZGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5tb2RlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5tb2RlLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNjM0QkQ2NWJhMjdBQjYzODExYzc0QTYzMTE4QUNiMzEyNzAxQmZhIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzc3ODM5MwogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzMjBlMTU4MGVmZkYzN0UwMDhGMUM5MjcwMGQxZUJhNDdjMUIyM2ZEIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzc3ODM5NQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIzXTogewogICAgICAgICAgYWRkcmVzczogIjB4YkM1QzY3OTg3OUIyOTY1Mjk2NzU2Q0Q5NTlDM0M3Mzk3Njk5OTVFMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDM3NzgzOTIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhCQWJhODM3MzExM0ZiN2E2OGYxOTVkZUYxODczMmUwMWFGOGVEZkNGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwMTkwMDcKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyMwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vb25iYXNlQWxwaGEuanMKICB2YXIgbW9vbmJhc2VBbHBoYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4NywKICAgIG5hbWU6ICJNb29uYmFzZSBBbHBoYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJERVYiLAogICAgICBzeW1ib2w6ICJERVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5hcGkubW9vbmJhc2UubW9vbmJlYW0ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93c3MuYXBpLm1vb25iYXNlLm1vb25iZWFtLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb29uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tb29uYmFzZS5tb29uc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9tb29uYmFzZS5tb29uc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTg1MDY4NgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vb25iZWFtLmpzCiAgdmFyIG1vb25iZWFtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjg0LAogICAgbmFtZTogIk1vb25iZWFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkdMTVIiLAogICAgICBzeW1ib2w6ICJHTE1SIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tb29uYmVhbS5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbW9vbmJlYW0ucHVibGljLmJsYXN0YXBpLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTW9vbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbW9vbnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW1vb25iZWFtLm1vb25zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MDkwMDIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbmJlYW1EZXYuanMKICB2YXIgbW9vbmJlYW1EZXYgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyODEsCiAgICBuYW1lOiAiTW9vbmJlYW0gRGV2ZWxvcG1lbnQgTm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJERVYiLAogICAgICBzeW1ib2w6ICJERVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjk5NDQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vMTI3LjAuMC4xOjk5NDQiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbnJpdmVyLmpzCiAgdmFyIG1vb25yaXZlciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4NSwKICAgIG5hbWU6ICJNb29ucml2ZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTU9WUiIsCiAgICAgIHN5bWJvbDogIk1PVlIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21vb25yaXZlci5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbW9vbnJpdmVyLnB1YmxpYy5ibGFzdGFwaS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21vb25yaXZlci5tb29uc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktbW9vbnJpdmVyLm1vb25zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTk3OTA0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vcnBoSG9sZXNreS5qcwogIHZhciBtb3JwaEhvbGVza3kgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4MTAsCiAgICBuYW1lOiAiTW9ycGggSG9sZXNreSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtcXVpY2tub2RlLWhvbGVza3kubW9ycGhsMi5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtcXVpY2tub2RlLWhvbGVza3kubW9ycGhsMi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vcnBoIEhvbGVza3kgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItaG9sZXNreS5tb3JwaGwyLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLWFwaS1ob2xlc2t5Lm1vcnBobDIuaW8vYXBpPyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb3JwaFNlcG9saWEuanMKICB2YXIgbW9ycGhTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNzEwLAogICAgbmFtZTogIk1vcnBoIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQubW9ycGhsMi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vcnBoIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItdGVzdG5ldC5tb3JwaGwyLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLWFwaS10ZXN0bmV0Lm1vcnBobDIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25hdXRpbHVzLmpzCiAgdmFyIG5hdXRpbHVzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMjIyMiwKICAgIG5hbWU6ICJOYXV0aWx1cyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaQkMiLCBzeW1ib2w6ICJaQkMiLCBkZWNpbWFsczogOSB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FwaS5uYXV0aWx1cy5uYXV0Y2hhaW4ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTmF1dFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbmF1dHNjYW4uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbmVvbkRldm5ldC5qcwogIHZhciBuZW9uRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDUwMjI5MjYsCiAgICBuYW1lOiAiTmVvbiBFVk0gRGV2TmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJORU9OIiwgc3ltYm9sOiAiTkVPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Rldm5ldC5uZW9uZXZtLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk5lb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Rldm5ldC5uZW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA1MjA2MTEyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbmVvbk1haW5uZXQuanMKICB2YXIgbmVvbk1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0NTAyMjkzNCwKICAgIG5ldHdvcms6ICJuZW9uTWFpbm5ldCIsCiAgICBuYW1lOiAiTmVvbiBFVk0gTWFpbk5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTkVPTiIsIHN5bWJvbDogIk5FT04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9uZW9uLXByb3h5LW1haW5uZXQuc29sYW5hLnAycC5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZW9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9uZW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA2NTQ1NTI0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25leGkuanMKICB2YXIgbmV4aSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MiwKICAgIG5hbWU6ICJOZXhpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJOZXhpIiwgc3ltYm9sOiAiTkVYSSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5jaGFpbi5uZXhpLnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZXhpU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cubmV4aXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3d3dy5uZXhpc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMjc3QTQ2Q2M2OUE1N2VFM0E2QzhjMTU4YkE4NzQ4MzJGNzE4QjhFIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1NzcwMTYwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9uZXhpbGl4LmpzCiAgdmFyIG5leGlsaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0MCwKICAgIG5hbWU6ICJOZXhpbGl4IFNtYXJ0IENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk5leGlsaXgiLAogICAgICBzeW1ib2w6ICJORVhJTElYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjdXJsLnBvcy5uZXhpbGl4LmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk5leGlsaXhTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ubmV4aWxpeC5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDU4MzgxYzhlMkJGOWQwQzJDNDI1OWNBMTRCZEE5QWZlMDI4MzEyNDQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzQ0NDgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29hc2lzVGVzdG5ldC5qcwogIHZhciBvYXNpc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQwOTAsCiAgICBuZXR3b3JrOiAib2FzaXMtdGVzdG5ldCIsCiAgICBuYW1lOiAiT2FzaXMgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRmFzdHRva2VuIiwgc3ltYm9sOiAiRlROIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYzEub2FzaXMuYmFoYW11dGNoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZ0bnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vb2FzaXMuZnRuc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vb2FzaXMuZnRuc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29hc3lzLmpzCiAgdmFyIG9hc3lzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDgsCiAgICBuYW1lOiAiT2FzeXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk9hc3lzIiwgc3ltYm9sOiAiT0FTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQub2FzeXMuZ2FtZXMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPYXN5c1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5vYXN5cy5nYW1lcyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLm9hc3lzLmdhbWVzL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29keXNzZXlUZXN0bmV0LmpzCiAgdmFyIG9keXNzZXlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5MTE4NjcsCiAgICBuYW1lOiAiT2R5c3NleSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vZHlzc2V5Lml0aGFjYS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPZHlzc2V5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL29keXNzZXktZXhwbG9yZXIuaXRoYWNhLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9vZHlzc2V5LWV4cGxvcmVyLml0aGFjYS54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29rYy5qcwogIHZhciBva2MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY2LAogICAgbmFtZTogIk9LQyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPS1QiLAogICAgICBzeW1ib2w6ICJPS1QiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9leGNoYWlucnBjLm9rZXgub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAib2tsaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5va2xpbmsuY29tL29rYyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDM2NDc5MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb29ydG1haW5uZXREZXYuanMKICB2YXIgb29ydE1haW5uZXREZXYgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk3MDAsCiAgICBuYW1lOiAiT09SVCBNYWlubmV0RGV2IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk9PUlQiLAogICAgICBzeW1ib2w6ICJPT1JUIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZGV2LXJwYy5vb3J0ZWNoLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9PUlQgTWFpbm5ldERldiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kZXYtc2Nhbi5vb3J0ZWNoLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wQk5CLmpzCiAgdmFyIHNvdXJjZUlkMjQgPSA1NjsKICB2YXIgb3BCTkIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwNCwKICAgIG5hbWU6ICJvcEJOQiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQk5CIiwKICAgICAgc3ltYm9sOiAiQk5CIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vcGJuYi1tYWlubmV0LXJwYy5ibmJjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJvcEJOQiAoQlNDU2NhbikiLAogICAgICAgIHVybDogImh0dHBzOi8vb3BibmIuYnNjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW9wYm5iLmJzY3NjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MTI4ODEKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE1M0NBQjc5ZjQ3NjdFMmZmODYyQzk0YWE0OTU3MzI5NEIxM0QxNjkiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE4NzZFQTc3MDJDMGFkMEM2QTJhZTYwMzZERTc3MzNlZGZCY2E1MTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGMDVGMGU0MzYyODU5YzMzMzFDYjkzOTVDQkMyMDFFM0ZhNjc1N0VhIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDI0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3BCTkJUZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMjUgPSA5NzsKICB2YXIgb3BCTkJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NjExLAogICAgbmFtZTogIm9wQk5CIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAidEJOQiIsCiAgICAgIHN5bWJvbDogInRCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vcGJuYi10ZXN0bmV0LXJwYy5ibmJjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJvcGJuYnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5vcGJuYnNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM3MDUxMDgKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEZmMjM5NEJiODQzMDEyNTYyZjQzNDlDNjYzMmEwRWNCOTJmQzg4MTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQzODZDOEFCZjIwMDlhQzBjMjYzNDYyRGE1NjhERDlkNDZlNTJhMzEiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NzczMTFGZDJjQ2M1MTFCYmMwZjU4MUU4ZDlhMDdCMDMzRDVFODQwIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyNQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtLmpzCiAgdmFyIHNvdXJjZUlkMjYgPSAxOwogIHZhciBvcHRpbWlzbSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTAsCiAgICBuYW1lOiAiT1AgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0Lm9wdGltaXNtLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3B0aW1pc20gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vb3B0aW1pc3RpYy5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW9wdGltaXN0aWMuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQyNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGU1OTY1QWI1OTYyZURjNzQ3N0M4NTIwMjQzQTk1NTE3Q0QyNTJmQTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDI2XTogewogICAgICAgICAgYWRkcmVzczogIjB4ZGZlOTc4NjgyMzNkMWFhMjJlODE1YTI2Njk4MmYyY2YxNzY4NWEyNyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQyODYyNjMKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiRWI1RmM1NzkxMTUwNzE3NjRjNzQyM0E0ZjEyZURkZTQxZjEwNkVkIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDI2XTogewogICAgICAgICAgYWRkcmVzczogIjB4OTlDOWZjNDZmOTJFOGExYzBkZUMxYjE3NDdkMDEwOTAzRTg4NGJFMSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtR29lcmxpLmpzCiAgdmFyIHNvdXJjZUlkMjcgPSA1OwogIHZhciBvcHRpbWlzbUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDIwLAogICAgbmFtZTogIk9wdGltaXNtIEdvZXJsaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiR29lcmxpIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ29lcmxpLm9wdGltaXNtLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS1vcHRpbWlzbS5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZ29lcmxpLW9wdGltaXNtLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEU2RGZiYTA5NTM2MTZCYWNhYjBjOUE4ZWNiM2E5QkJhNzdGQzE1YzAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0OTQ2MQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDViNDdFMUEwOEVhNmQ5ODVENjY0OTMwMDU4NGU2NzIyRWM0QjEzODMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2MzZBZjE2YmYyZjY4MmREMzEwOWU2MDEwMmI4RTFBMDg5RmVkQWE4IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyNwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDI4ID0gMTExNTUxMTE7CiAgdmFyIG9wdGltaXNtU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTExNTU0MjAsCiAgICBuYW1lOiAiT1AgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEub3B0aW1pc20uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL29wdGltaXNtLXNlcG9saWEuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vb3B0aW1pc20tc2Vwb2xpYS5ibG9ja3Njb3V0LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkMjhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgwNUY5NjEzYURCMzAwMjZGRmQ2MzRmMzhlNUM0ZEZkMzBhMTk3RmExIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDkwRTljNGY4YTk5NGEyNTBGNmFFZmQ2MUNBRmI0RjJlODk1RDQ1OEYiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjIwMjA0CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDI4XTogewogICAgICAgICAgYWRkcmVzczogIjB4MTZGYzUwNThGMjU2NDgxOTQ0NzE5MzlkZjc1Q0YyN0EyZmRDNDhCQyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEZCYjA2MjFFMEIyM2I1NDc4QjYzMEJENTVhNWYyMWY2NzczMEIwRjEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDI4CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3B0b3BpYS5qcwogIHZhciBvcHRvcGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MjA1MCwKICAgIG5hbWU6ICJPcHRvcGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtbWFpbm5ldC5vcHRvcGlhLmFpIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3B0b3BpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLm9wdG9waWEuYWkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdG9waWFUZXN0bmV0LmpzCiAgdmFyIG9wdG9waWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MjA0OSwKICAgIG5hbWU6ICJPcHRvcGlhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0Lm9wdG9waWEuYWkiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPcHRvcGlhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4tdGVzdG5ldC5vcHRvcGlhLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29yZGVybHkuanMKICB2YXIgb3JkZXJseSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjkxLAogICAgbmFtZTogIk9yZGVybHkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5vcmRlcmx5Lm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPcmRlcmx5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm9yZGVybHkubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3JkZXJseVNlcG9saWEuanMKICB2YXIgb3JkZXJseVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ0NjAsCiAgICBuYW1lOiAiT3JkZXJseSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2wyLW9yZGVybHktbDItNDQ2MC1zZXBvbGlhLTh0YzNzZDdkdnkudC5jb25kdWl0Lnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9yZGVybHkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXJsMm5ldy1vcmRlcmx5LWwyLTQ0NjAtc2Vwb2xpYS04dGMzc2Q3ZHZ5LnQuY29uZHVpdC54eXoiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3RpbURldm5ldC5qcwogIHZhciBvdGltRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MTE0NDExNCwKICAgIG5hbWU6ICJPdGltIERldm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vZGV2bmV0Lm90aW0ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBiYXRjaEludm9rZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHg1RmJEQjIzMTU2NzhhZmVjYjM2N2YwMzJkOTNGNjQyZjY0MTgwYWEzIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGFsbS5qcwogIHZhciBwYWxtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTI5NzEwODEwOSwKICAgIG5hbWU6ICJQYWxtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlBBTE0iLAogICAgICBzeW1ib2w6ICJQQUxNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3BhbG0tbWFpbm5ldC5wdWJsaWMuYmxhc3RhcGkuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGFpbmxlbnMiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFsbS5jaGFpbmxlbnMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NDI5MjQ4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wYWxtVGVzdG5ldC5qcwogIHZhciBwYWxtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEyOTcxMDgwOTksCiAgICBuYW1lOiAiUGFsbSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlBBTE0iLAogICAgICBzeW1ib2w6ICJQQUxNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3BhbG0tbWFpbm5ldC5wdWJsaWMuYmxhc3RhcGkuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGFpbmxlbnMiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFsbS5jaGFpbmxlbnMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NDI5MjQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGduLmpzCiAgdmFyIHNvdXJjZUlkMjkgPSAxOwogIHZhciBwZ24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyNCwKICAgIG5ldHdvcms6ICJwZ24iLAogICAgbmFtZTogIlBHTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucHVibGljZ29vZHMubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBHTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5wdWJsaWNnb29kcy5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnB1YmxpY2dvb2RzLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg5RTYyMDRGNzUwY0Q4NjZiMjk5NTk0ZTJhQzllQTgyNEUyZTVmOTVjIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzM4MDIwOQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGIyNkZkOTg1YzU5NTliQkIzODJCQUZkRDBiODc5RTE0OWU0ODExNmMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhEMDIwNEI5NTI3QzFiQTdiRDc2NUZhNUNDRDkzNTVkMzgzMzgyNzJiIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGZvcm1hdHRlcnM6IGZvcm1hdHRlcnMyLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjkKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wZ25UZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMzAgPSAxMTE1NTExMTsKICB2YXIgcGduVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTgwMDgsCiAgICBuZXR3b3JrOiAicGduLXRlc3RuZXQiLAogICAgbmFtZTogIlBHTiAiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5wdWJsaWNnb29kcy5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUEdOIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Vwb2xpYS5wdWJsaWNnb29kcy5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnNlcG9saWEucHVibGljZ29vZHMubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEQ1YkFjMzE1MmZmQzI1MzE4Rjg0OEIzREQ1ZEE2Qzg1MTcxQmFFRWUiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEYwNEJkRDUzNTNCYjBFRkY2Q0E2MENmY0M3ODU5NDI3OGVCZkUxNzkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGYUU2YWJDQUYzMEQyM2UyMzNBQzdmYUY3NDdGMmZDM2E1YTZCZmEzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzc1NDkyNQogICAgICB9CiAgICB9LAogICAgZm9ybWF0dGVyczogZm9ybWF0dGVyczIsCiAgICBzb3VyY2VJZDogc291cmNlSWQzMCwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9waG9lbml4LmpzCiAgdmFyIHBob2VuaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMzgxLAogICAgbmFtZTogIlBob2VuaXggQmxvY2tjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUGhvZW5peCIsIHN5bWJvbDogIlBIWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5waG9lbml4cGxvcmVyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBob2VuaXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGhvZW5peHBsb3Jlci5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGhvZW5peHBsb3Jlci5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg0OThjRjc1N2E1NzVjRkYyYzJFZDlmNTMyZjU2RWZhNzk3Zjg2NDQyIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU2MjAxOTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BsYXlmaUFsYmlyZW8uanMKICB2YXIgcGxheWZpQWxiaXJlbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAxNjEyMTI3LAogICAgbmFtZTogIlBsYXlGaSBBbGJpcmVvIFRlc3RuZXQiLAogICAgbmV0d29yazogImFsYmlyZW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYWxiaXJlby1ycGMucGxheWZpLmFpIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2FsYmlyZW8tcnBjLXdzLnBsYXlmaS5haS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBsYXlGaSBBbGJpcmVvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FsYmlyZW8tZXhwbG9yZXIucGxheWZpLmFpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhGOWNkYTYyNEZCQzdlMDU5MzU1Y2U5OGEzMTY5M2QyOTlGQUNkOTYzIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BsaW5nYS5qcwogIHZhciBwbGluZ2EgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0MiwKICAgIG5hbWU6ICJQbGluZ2EiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlBsaW5nYSIsIHN5bWJvbDogIlBMSU5HQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwY3VybC5tYWlubmV0LnBsZ2NoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBsZ3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LnBsZ3NjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwOTg5NTc2MTYwZjJlNzA5MjkwOEJCOTQ3OTYzMWI5MDEwNjBiNmU0IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwNDQ4OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGx1bWVUZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMzEgPSAxMTE1NTExMTsKICB2YXIgcGx1bWVUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjEyMjExMzUsCiAgICBuYW1lOiAiUGx1bWUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiUGx1bWUgU2Vwb2xpYSBFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5wbHVtZW5ldHdvcmsueHl6L2h0dHAiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC1ycGMucGx1bWVuZXR3b3JrLnh5ei93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5wbHVtZW5ldHdvcmsueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIucGx1bWVuZXR3b3JrLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzEKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uLmpzCiAgdmFyIHBvbHlnb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzNywKICAgIG5hbWU6ICJQb2x5Z29uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJQT0wiLCBzeW1ib2w6ICJQT0wiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wb2x5Z29uLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjU3NzAxNjAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BvbHlnb25BbW95LmpzCiAgdmFyIHBvbHlnb25BbW95ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDAwMiwKICAgIG5hbWU6ICJQb2x5Z29uIEFtb3kiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk1BVElDIiwgc3ltYm9sOiAiTUFUSUMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtYW1veS5wb2x5Z29uLnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hbW95LnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktYW1veS5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxMjczODgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uTXVtYmFpLmpzCiAgdmFyIHBvbHlnb25NdW1iYWkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDAxLAogICAgbmFtZTogIlBvbHlnb24gTXVtYmFpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJNQVRJQyIsIHN5bWJvbDogIk1BVElDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFua3IuY29tL3BvbHlnb25fbXVtYmFpIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbXVtYmFpLnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktdGVzdG5ldC5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1NzcwMTYwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcG9seWdvblprRXZtLmpzCiAgdmFyIHBvbHlnb25aa0V2bSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEwMSwKICAgIG5hbWU6ICJQb2x5Z29uIHprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3prZXZtLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly96a2V2bS5wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXprZXZtLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTc3NDYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BvbHlnb25aa0V2bUNhcmRvbmEuanMKICB2YXIgcG9seWdvblprRXZtQ2FyZG9uYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjQ0MiwKICAgIG5hbWU6ICJQb2x5Z29uIHprRVZNIENhcmRvbmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNhcmRvbmEuemtldm0tcnBjLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBvbHlnb25TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2NhcmRvbmEtemtldm0ucG9seWdvbnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2NhcmRvbmEtemtldm0ucG9seWdvbnNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE0MDkxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uWmtFdm1UZXN0bmV0LmpzCiAgdmFyIHBvbHlnb25aa0V2bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0NDIsCiAgICBuYW1lOiAiUG9seWdvbiB6a0VWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5wdWJsaWMuemtldm0tdGVzdC5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXprZXZtLnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXprZXZtLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDUyNTY4NgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcHVsc2VjaGFpbi5qcwogIHZhciBwdWxzZWNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjksCiAgICBuYW1lOiAiUHVsc2VDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUHVsc2UiLCBzeW1ib2w6ICJQTFMiLCBkZWNpbWFsczogMTggfSwKICAgIHRlc3RuZXQ6IGZhbHNlLAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5wdWxzZWNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5wdWxzZWNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlB1bHNlU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnB1bHNlY2hhaW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5zY2FuLnB1bHNlY2hhaW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0MzUzNjAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wdWxzZWNoYWluVjQuanMKICB2YXIgcHVsc2VjaGFpblY0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NDMsCiAgICBuYW1lOiAiUHVsc2VDaGFpbiBWNCIsCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlY0IFB1bHNlIiwgc3ltYm9sOiAidjRQTFMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudjQudGVzdG5ldC5wdWxzZWNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy52NC50ZXN0bmV0LnB1bHNlY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUHVsc2VTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4udjQudGVzdG5ldC5wdWxzZWNoYWluLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnY0LnRlc3RuZXQucHVsc2VjaGFpbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGVuc1JlZ2lzdHJ5OiB7CiAgICAgICAgYWRkcmVzczogIjB4MDAwMDAwMDAwMDBDMkUwNzRlQzY5QTBkRmIyOTk3QkE2QzdkMmUxZSIKICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQzNTM2MDEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3FsMS5qcwogIHZhciBxbDEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc2NiwKICAgIG5hbWU6ICJRTDEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUU9NIiwKICAgICAgc3ltYm9sOiAiUU9NIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucW9tLm9uZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlFsMSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnFvbS5vbmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDdBNTIzNzA3MTZlYTczMDU4NTg4NEY1QkRCMGY2RTYwQzM5YjhDNjQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3FNYWlubmV0LmpzCiAgdmFyIHFNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNTQ0MSwKICAgIG5hbWU6ICJRIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUSIsCiAgICAgIHN5bWJvbDogIlEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMucS5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJRIE1haW5uZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucS5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIucS5vcmcvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcVRlc3RuZXQuanMKICB2YXIgcVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM1NDQzLAogICAgbmFtZTogIlEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJRIiwKICAgICAgc3ltYm9sOiAiUSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5xdGVzdG5ldC5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJRIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucXRlc3RuZXQub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnF0ZXN0bmV0Lm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmVhbC5qcwogIHZhciByZWFsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTExODgsCiAgICBuYW1lOiAicmUuYWwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogInJlRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBzeW1ib2w6ICJyZUVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JlYWwuZHJwYy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJyZS5hbCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yZS5hbCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yZS5hbC9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjk1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yZWRiZWxseVRlc3RuZXQuanMKICB2YXIgcmVkYmVsbHlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTMsCiAgICBuYW1lOiAiUmVkYmVsbHkgTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJSZWRiZWxseSBOYXRpdmUgQ29pbiIsCiAgICAgIHN5bWJvbDogIlJCTlQiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ292ZXJub3JzLnRlc3RuZXQucmVkYmVsbHkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybmFsIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQucmVkYmVsbHkubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ldGhlcm5hbC5mbHkuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yZWRzdG9uZS5qcwogIHZhciBzb3VyY2VJZDMyID0gMTsKICB2YXIgcmVkc3RvbmUgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBuYW1lOiAiUmVkc3RvbmUiLAogICAgaWQ6IDY5MCwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMyLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnJlZHN0b25lY2hhaW4uY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5yZWRzdG9uZWNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucmVkc3RvbmUueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEM3YkNiMGU4ODM5YTI4QTFjRmFkZDFDRjcxNmRlOTAxNkNkQTUxYWUiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTU3ODMyOQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGE0MjZBMDUyZjY1N0FFRWVmYzI5OGIzQjVjMzVhNDcwZTQ3MzlkNjkiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTU3ODMzNwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMyXTogewogICAgICAgICAgYWRkcmVzczogIjB4YzQ3M2NhN0UwMmFmMjRjMTI5YzJlRWY1MUYyYURmMDQxMWMxRGY2OSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5NTc4MzMxCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmV5YU5ldHdvcmsuanMKICB2YXIgcmV5YU5ldHdvcmsgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3MjksCiAgICBuYW1lOiAiUmV5YSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yZXlhLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MucmV5YS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUmV5YSBOZXR3b3JrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJleWEubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9sbHV4LmpzCiAgdmFyIHJvbGx1eCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTcwLAogICAgbmFtZTogIlJvbGx1eCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlN5c2NvaW4iLAogICAgICBzeW1ib2w6ICJTWVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yb2xsdXguY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5yb2xsdXguY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJvbGx1eEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJvbGx1eC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIucm9sbHV4LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE5MjIyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb2xsdXhUZXN0bmV0LmpzCiAgdmFyIHJvbGx1eFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3ZTMsCiAgICBuYW1lOiAiUm9sbHV4IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiU3lzY29pbiIsCiAgICAgIHN5bWJvbDogIlNZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRhbmVuYmF1bS5yb2xsdXguY29tLyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtdGFuZW5iYXVtLnJvbGx1eC5jb20vd3NzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9sbHV4VGVzdG5ldEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3JvbGx1eC50YW5lbmJhdW0uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcm9sbHV4LnRhbmVuYmF1bS5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTgxMzY3NQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9uaW4uanMKICB2YXIgcm9uaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjAsCiAgICBuYW1lOiAiUm9uaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJPTiIsIHN5bWJvbDogIlJPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FwaS5yb25pbmNoYWluLmNvbS9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSb25pbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcHAucm9uaW5jaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjYwMjM1MzUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Jvb3QuanMKICB2YXIgcm9vdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzY2OCwKICAgIG5hbWU6ICJUaGUgUm9vdCBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlhSUCIsCiAgICAgIHN5bWJvbDogIlhSUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcm9vdC5yb290bmV0LmxpdmUvYXJjaGl2ZSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9yb290LnJvb3RuZXQubGl2ZS9hcmNoaXZlL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9vdHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcm9vdHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGM5QzJFMjQyOUFlQzM1NDkxNmM0NzZCMzBkNzI5ZGVEZEM5NDk4OGQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTIxODMzOAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9vdFBvcmNpbmkuanMKICB2YXIgcm9vdFBvcmNpbmkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc2NzIsCiAgICBuYW1lOiAiVGhlIFJvb3QgTmV0d29yayAtIFBvcmNpbmkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWFJQIiwKICAgICAgc3ltYm9sOiAiWFJQIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wb3JjaW5pLnJvb3RuZXQuYXBwL2FyY2hpdmUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcG9yY2luaS5yb290bmV0LmFwcC9hcmNoaXZlL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9vdHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcG9yY2luaS5yb290c2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzlDMkUyNDI5QWVDMzU0OTE2YzQ3NkIzMGQ3MjlkZURkQzk0OTg4ZCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDU1NTY5MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Jvb3RzdG9jay5qcwogIHZhciByb290c3RvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMwLAogICAgbmFtZTogIlJvb3RzdG9jayBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJyb290c3RvY2siLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUm9vdHN0b2NrIEJpdGNvaW4iLAogICAgICBzeW1ib2w6ICJSQlRDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLW5vZGUucnNrLmNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNLIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJzay5jbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MjQ5NTQwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb290c3RvY2tUZXN0bmV0LmpzCiAgdmFyIHJvb3RzdG9ja1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxLAogICAgbmFtZTogIlJvb3RzdG9jayBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJyb290c3RvY2siLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUm9vdHN0b2NrIEJpdGNvaW4iLAogICAgICBzeW1ib2w6ICJ0UkJUQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1ub2RlLnRlc3RuZXQucnNrLmNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNLIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQucm9vdHN0b2NrLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JzczMuanMKICB2YXIgc291cmNlSWQzMyA9IDE7CiAgdmFyIHJzczMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEyNTUzLAogICAgbmFtZTogIlJTUzMgVlNMIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJTUzMiLCBzeW1ib2w6ICJSU1MzIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnJzczMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSU1MzIFZTTCBNYWlubmV0IFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5yc3MzLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4ucnNzMy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEU2ZjI0ZDJDMzJCMzEwOUIxOGVkMzNjRjA4ZUZiNDkwYjFlMDlDMTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNDE5MwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZBMTI0MzI0OTFiYmJFOGQzYmFiZjc1Rjc1OTc2Njc3NEM3NzhEYjQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTM4NzA1NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMzXTogewogICAgICAgICAgYWRkcmVzczogIjB4NGNiYWI2OTEwOEFhNzIxNTFFRGE1QTNjMTY0ZUE4Njg0NWYxODQzOCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQzMwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JzczNTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMzQgPSAxMTE1NTExMTsKICB2YXIgcnNzM1NlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDIzMzEsCiAgICBuYW1lOiAiUlNTMyBWU0wgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJSU1MzIiwgc3ltYm9sOiAiUlNTMyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LnJzczMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSU1MzIFZTTCBTZXBvbGlhIFRlc3RuZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnRlc3RuZXQucnNzMy5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnRlc3RuZXQucnNzMy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweERiNWM0NkMzRWFhNkVkNmFFOGIyMzc5Nzg1REY3ZGQwMjlDMGRDODEiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1NTY5NwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGNCRDc3RThFMUU3RjA2QjI1YmFEZTY3MTQyY2RFODI2NTJEYTdiNTciLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA1MzQ1MDM1CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkREQyOWJiNjNCMDgzOUZCMWNFMGVFNDM5RmYwMjc3Mzg1OTVEMDdCIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzNAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhaWdvbi5qcwogIHZhciBzYWlnb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjEsCiAgICBuYW1lOiAiU2FpZ29uIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJPTiIsIHN5bWJvbDogIlJPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhaWdvbi10ZXN0bmV0LnJvbmluY2hhaW4uY29tL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNhaWdvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zYWlnb24tYXBwLnJvbmluY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4NzM2ODcxCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2Fua28uanMKICB2YXIgc2Fua28gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTYsCiAgICBuYW1lOiAiU2Fua28iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkRNVCIsIHN5bWJvbDogIkRNVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2Fua28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2Fua28gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Fua28ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXBwaGlyZS5qcwogIHZhciBzYXBwaGlyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjMyOTQsCiAgICBuYW1lOiAiT2FzaXMgU2FwcGhpcmUiLAogICAgbmV0d29yazogInNhcHBoaXJlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTYXBwaGlyZSBSb3NlIiwgc3ltYm9sOiAiUk9TRSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhcHBoaXJlLm9hc2lzLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NhcHBoaXJlLm9hc2lzLmlvL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT2FzaXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIub2FzaXMuaW8vbWFpbm5ldC9zYXBwaGlyZSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3MzQ1MzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhcHBoaXJlVGVzdG5ldC5qcwogIHZhciBzYXBwaGlyZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzMjk1LAogICAgbmFtZTogIk9hc2lzIFNhcHBoaXJlIFRlc3RuZXQiLAogICAgbmV0d29yazogInNhcHBoaXJlLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNhcHBoaXJlIFRlc3QgUm9zZSIsIHN5bWJvbDogIlRFU1QiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldi93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9hc2lzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm9hc2lzLmlvL3Rlc3RuZXQvc2FwcGhpcmUiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2F0b3NoaXZtLmpzCiAgdmFyIHNhdG9zaGlWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEwOSwKICAgIG5hbWU6ICJTYXRvc2hpVk0gQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQlRDIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hbHBoYS1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3N2bXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc3Ztc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXRvc2hpdm1UZXN0bmV0LmpzCiAgdmFyIHNhdG9zaGlWTVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMTAsCiAgICBuYW1lOiAiU2F0b3NoaVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJUQyIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdC1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3Ztc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LnN2bXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Njcm9sbC5qcwogIHZhciBzY3JvbGwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MiwKICAgIG5hbWU6ICJTY3JvbGwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNjcm9sbC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93c3MtcnBjLnNjcm9sbC5pby93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNjcm9sbHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLnNjcm9sbHNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zY3JvbGxTZXBvbGlhLmpzCiAgdmFyIHNjcm9sbFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MSwKICAgIG5hbWU6ICJTY3JvbGwgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5zY3JvbGwuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTY3JvbGxzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEuc2Nyb2xsc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDk0NzMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWkuanMKICB2YXIgc2VpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI5LAogICAgbmFtZTogIlNlaSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLnNlaS1hcGlzLmNvbS8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtLXdzLnNlaS1hcGlzLmNvbS8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2VpdHJhY2UuY29tL3BhY2lmaWMtMS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWlEZXZuZXQuanMKICB2YXIgc2VpRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTM3MTUsCiAgICBuYW1lOiAiU2VpIERldm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2VpIiwgc3ltYm9sOiAiU0VJIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXZtLXJwYy1hcmN0aWMtMS5zZWktYXBpcy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2VpVGVzdG5ldC5qcwogIHZhciBzZWlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI4LAogICAgbmFtZTogIlNlaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLXRlc3RuZXQuc2VpLWFwaXMuY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V2bS13cy10ZXN0bmV0LnNlaS1hcGlzLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNlaXRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlaXRyYWNlLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZXBvbGlhLmpzCiAgdmFyIHNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTU1MTExLAogICAgbmFtZTogIlNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMyLnNlcG9saWEub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzUxNTMyCiAgICAgIH0sCiAgICAgIGVuc1JlZ2lzdHJ5OiB7IGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzhBZjk5OWUzODI3M0Q2NThCRTFiOTIxYjg4QTlEZGYwMDU3NjljQyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MzE3MDgwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hhcGUuanMKICB2YXIgc291cmNlSWQzNSA9IDE7CiAgdmFyIHNoYXBlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAzNjAsCiAgICBuYW1lOiAiU2hhcGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5zaGFwZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAic2hhcGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoYXBlc2Nhbi54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2hhcGVzY2FuLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZFZjhjNjlDZkU0NjM1ZDg2NmUzRTAyNzMyMDY4MDIyYzA2ZTcyNEQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTk0MAogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEVCMDZmRmExNjAxMUI1NjI4QmFCOThFMjk3NzYzNjFjODM3NDFkZDMiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTkzMwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM1XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjJFZGQ1ZjQ5MzBFYTkyZENhM2ZCODE2ODliREQ5YjlkMDc2YjU3QiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwMzY5OTM1CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGFwZVNlcG9saWEuanMKICB2YXIgc291cmNlSWQzNiA9IDExMTU1MTExOwogIHZhciBzaGFwZVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMDExLAogICAgbmFtZTogIlNoYXBlIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuc2hhcGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc2Vwb2xpYS5zaGFwZS5uZXR3b3JrLyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1zZXBvbGlhLnNoYXBlLm5ldHdvcmsvYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoYXJkZXVtU3BoaW54LmpzCiAgdmFyIHNoYXJkZXVtU3BoaW54ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDgyLAogICAgbmFtZTogIlNoYXJkZXVtIFNwaGlueCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU0hBUkRFVU0iLCBzeW1ib2w6ICJTSE0iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zcGhpbnguc2hhcmRldW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2hhcmRldW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc3BoaW54LnNoYXJkZXVtLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGliYXJpdW0uanMKICB2YXIgc2hpYmFyaXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDksCiAgICBuYW1lOiAiU2hpYmFyaXVtIiwKICAgIG5ldHdvcms6ICJzaGliYXJpdW0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJvbmUiLCBzeW1ib2w6ICJCT05FIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNoaWJycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zaGliYXJpdW1zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4NjRCZjY4MUFERDYwNTIzOTUxODhBODkxMDFBMUIzN2QzQjRDOTYxIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI2NTkwMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpYmFyaXVtVGVzdG5ldC5qcwogIHZhciBzaGliYXJpdW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTcsCiAgICBuYW1lOiAiUHVwcHluZXQgU2hpYmFyaXVtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJvbmUiLAogICAgICBzeW1ib2w6ICJCT05FIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVwcHluZXQuc2hpYnJwYy5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4QTQwMjliNzRGQkEzNjZjOTI2ZURGQTdEZDEwQjIxQzYyMTE3MGE0YyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDM1NzY5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpZGVuLmpzCiAgdmFyIHNoaWRlbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzM2LAogICAgbmFtZTogIlNoaWRlbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTRE4iLAogICAgICBzeW1ib2w6ICJTRE4iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NoaWRlbi5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vc2hpZGVuLXJwYy5kd2VsbGlyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaWRlbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoaWRlbi5zdWJzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGltbWVyLmpzCiAgdmFyIHNoaW1tZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0OCwKICAgIG5hbWU6ICJTaGltbWVyIiwKICAgIG5ldHdvcms6ICJzaGltbWVyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS5zaGltbWVyLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaGltbWVyIE5ldHdvcmsgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnNoaW1tZXIubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoaW1tZXJUZXN0bmV0LmpzCiAgdmFyIHNoaW1tZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDczLAogICAgbmFtZTogIlNoaW1tZXIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAic2hpbW1lci10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS50ZXN0bmV0LnNoaW1tZXIubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaW1tZXIgTmV0d29yayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0udGVzdG5ldC5zaGltbWVyLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaWxpY29uLmpzCiAgdmFyIHNpbGljb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzNTUsCiAgICBuYW1lOiAiU2lsaWNvbiB6a0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYy5zaWxpY29uLm5ldHdvcmsiLAogICAgICAgICAgImh0dHBzOi8vc2lsaWNvbi1tYWlubmV0Lm5vZGVpbmZyYS5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaWxpY29uU2NvcGUiLAogICAgICAgIHVybDogImh0dHBzOi8vc2NvcGUuc2lsaWNvbi5uZXR3b3JrIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2lsaWNvblNlcG9saWEuanMKICB2YXIgc2lsaWNvblNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3MjI2NDExNjAsCiAgICBuYW1lOiAiU2lsaWNvbiBTZXBvbGlhIHprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLXNlcG9saWEuc2lsaWNvbi5uZXR3b3JrIiwKICAgICAgICAgICJodHRwczovL3NpbGljb24tdGVzdG5ldC5ub2RlaW5mcmEuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2lsaWNvblNlcG9saWFTY29wZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY29wZS1zZXBvbGlhLnNpbGljb24ubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9icmF3bC5qcwogIHZhciBza2FsZUJsb2NrQnJhd2xlcnMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM5MTg0NTg5NCwKICAgIG5hbWU6ICJTS0FMRSB8IEJsb2NrIEJyYXdsZXJzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCUkFXTCIsIHN5bWJvbDogIkJSQVdMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mcmF5ZWQtZGVjZW50LWFudGFyZXMuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czoge30KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvLmpzCiAgdmFyIHNrYWxlQ2FseXBzbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTU2NDgzMDgxOCwKICAgIG5hbWU6ICJTS0FMRSB8IENhbHlwc28gTkZUIEh1YiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hvbm9yYWJsZS1zdGVlbC1yYXNhbGhhZ3VlIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMTA3NjI2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvVGVzdG5ldC5qcwogIHZhciBza2FsZUNhbHlwc29UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NzQzOTkxMzEsCiAgICBuYW1lOiAiU0tBTEUgQ2FseXBzbyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9naWFudC1oYWxmLWR1YWwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dpYW50LWhhbGYtZHVhbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ2lhbnQtaGFsZi1kdWFsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMyMjAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jcnlwdG9CbGFkZXMuanMKICB2YXIgc2thbGVDcnlwdG9CbGFkZXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjYwNjIxNTcsCiAgICBuYW1lOiAiU0tBTEUgfCBDcnlwdG9CbGFkZXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4Il0sCiAgICAgICAgd2ViU29ja2V0OiBbCiAgICAgICAgICAid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9hZmZlY3Rpb25hdGUtaW1tZWRpYXRlLXBvbGx1eCIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4LmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvY3J5cHRvQ29sb3NzZXVtLmpzCiAgdmFyIHNrYWxlQ3J5cHRvQ29sb3NzZXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDMyOTQyMTcyLAogICAgbmFtZTogIlNLQUxFIHwgQ3J5cHRvIENvbG9zc2V1bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaGF1bnRpbmctZGV2b3RlZC1kZW5lYiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hhdW50aW5nLWRldm90ZWQtZGVuZWIiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXVudGluZy1kZXZvdGVkLWRlbmViLmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvZXVyb3BhLmpzCiAgdmFyIHNrYWxlRXVyb3BhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDQ2Mzk5MTI2LAogICAgbmFtZTogIlNLQUxFIHwgRXVyb3BhIExpcXVpZGl0eSBIdWIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2VsYXRlZC10YW4tc2thdCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2VsYXRlZC10YW4tc2thdCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VsYXRlZC10YW4tc2thdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxMTM0OTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2V1cm9wYVRlc3RuZXQuanMKICB2YXIgc2thbGVFdXJvcGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDQ0NjczNDE5LAogICAgbmFtZTogIlNLQUxFIEV1cm9wYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9qdWljeS1sb3ctc21hbGwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2p1aWN5LWxvdy1zbWFsbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vanVpY3ktbG93LXNtYWxsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTA4NTgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9leG9yZGUuanMKICB2YXIgc2thbGVFeG9yZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIxMzk5Mjc1NTIsCiAgICBuYW1lOiAiU0tBTEUgfCBFeG9yZGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2xpZ2h0LXZhc3QtZGlwaGRhIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGlnaHQtdmFzdC1kaXBoZGEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9saWdodC12YXN0LWRpcGhkYS5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2h1bWFuUHJvdG9jb2wuanMKICB2YXIgc2thbGVIdW1hblByb3RvY29sID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjczMjI3NDUzLAogICAgbmFtZTogIlNLQUxFIHwgSHVtYW4gUHJvdG9jb2wiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dhbi1yZWQtYWluIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3Mvd2FuLXJlZC1haW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW4tcmVkLWFpbi5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL25lYnVsYS5qcwogIHZhciBza2FsZU5lYnVsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTQ4MjYwMTY0OSwKICAgIG5hbWU6ICJTS0FMRSB8IE5lYnVsYSBHYW1pbmcgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9ncmVlbi1naWRkeS1kZW5lYm9sYSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dyZWVuLWdpZGR5LWRlbmVib2xhIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ3JlZW4tZ2lkZHktZGVuZWJvbGEuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMzcyOTg2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9uZWJ1bGFUZXN0bmV0LmpzCiAgdmFyIHNrYWxlTmVidWxhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzcwODQ2MjQsCiAgICBuYW1lOiAiU0tBTEUgTmVidWxhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL2xhbmt5LWlsbC1mdW5ueS10ZXN0bmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGFua3ktaWxsLWZ1bm55LXRlc3RuZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9sYW5reS1pbGwtZnVubnktdGVzdG5ldC5leHBsb3Jlci50ZXN0bmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNTE0MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3Jhem9yLmpzCiAgdmFyIHNrYWxlUmF6b3IgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI3ODYxMTM1MSwKICAgIG5hbWU6ICJTS0FMRSB8IFJhem9yIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3R1cmJ1bGVudC11bmlxdWUtc2NoZWF0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvdHVyYnVsZW50LXVuaXF1ZS1zY2hlYXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90dXJidWxlbnQtdW5pcXVlLXNjaGVhdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3RpdGFuLmpzCiAgdmFyIHNrYWxlVGl0YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzNTAyMTYyMzQsCiAgICBuYW1lOiAiU0tBTEUgfCBUaXRhbiBDb21tdW5pdHkgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wYXJhbGxlbC1zdG9ybXktc3BpY2EuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDc2NDU4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS90aXRhblRlc3RuZXQuanMKICB2YXIgc2thbGVUaXRhblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAzNTIyMjAsCiAgICBuYW1lOiAiU0tBTEUgVGl0YW4gSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9hd2FyZS1mYWtlLXRyaW0tdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2F3YXJlLWZha2UtdHJpbS10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXdhcmUtZmFrZS10cmltLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQwNzIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2V0Y2hwYWQuanMKICB2YXIgc2tldGNocGFkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5ODQxMjMsCiAgICBuYW1lOiAiRm9ybWEgU2tldGNocGFkIiwKICAgIG5ldHdvcms6ICJza2V0Y2hwYWQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiVElBIiwKICAgICAgbmFtZTogIlRJQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2tldGNocGFkLTEuZm9ybWEuYXJ0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLnNrZXRjaHBhZC0xLmZvcm1hLmFydCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNrZXRjaHBhZCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5za2V0Y2hwYWQtMS5mb3JtYS5hcnQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heC5qcwogIHZhciBzb3VyY2VJZDM3ID0gMTsKICB2YXIgc25heCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjE5MiwKICAgIG5ldHdvcms6ICJzbmF4Y2hhaW4tbWFpbm5ldCIsCiAgICBuYW1lOiAiU25heENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc25heGNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU25heCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zbmF4Y2hhaW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQ3MjU2MkZjZjI2RDZiMjc5M2Y4RTBiMGZCNjYwYmEwRTVlMDhBNDYiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM3XTogewogICAgICAgICAgYWRkcmVzczogIjB4MjE3MmU0OTJGYzgwN0Y1ZDU2NDVEMEUzNTQzZjEzOUVDRjUzOTI5NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDc5ZjQ0NkQwMjRkNzREMEJiNkU2OTlDMTMxYzcwMzQ2M2M1RDY1RTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NTM0QmRiNmI1YzA2MGQzZTZhYTgzMzQzMzMzMzEzNWVGRThFMGFBIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDM3CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heFRlc3RuZXQuanMKICB2YXIgc291cmNlSWQzOCA9IDExMTU1MTExOwogIHZhciBzbmF4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTMwMDEsCiAgICBuZXR3b3JrOiAic25heGNoYWluLXRlc3RuZXQiLAogICAgbmFtZTogIlNuYXhDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZXBvbGlhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5zbmF4Y2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbmF4IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDIwNmE3NWQ4OWQ0NUYxNDZDNTQwMjBGMTMyRkY5M2JFREQwOWY1NUUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM4XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjBlM0EzNjhhNGNkQ0VmODVmZkI5NjRlMzcyNzI2RjU2QTQ2MjIxZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGI1YWZkZDBFOGRERjA4MUVmOTBlOEEzZTBjN2I1Nzk4ZTY2RTk1NEUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiZDM3RTFhNTlENEMwMEM5QTQ2Rjc1MDE4ZGZmZDg0MDYxYkM1Zjc0IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzOAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmVpdW1NaW5hdG8uanMKICB2YXIgc291cmNlSWQzOSA9IDExMTU1MTExOwogIHZhciBzb25laXVtTWluYXRvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxOTQ2LAogICAgbmFtZTogIlNvbmVpdW0gTWluYXRvIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWluYXRvLnNvbmVpdW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci10ZXN0bmV0LnNvbmVpdW0ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQuc29uZWl1bS5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDM5XTogewogICAgICAgICAgYWRkcmVzczogIjB4RjY5ZEI2Y0E1NTlDNTJkOUE0QkI2ZTJCMjkwMWY0OTBDYTM1RmJmNiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MTBlNTI4NkM3NDZlQzM4YmVlQjc1MzhkMDE0NmY2MEQyN2JlMzQzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NWVhMTQ4OTc0MUE1RDcyZkZkRDhlNjQ4NUIyMTZiQmRjQzE1QWYzIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNjQ2NjEzNgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM5XTogewogICAgICAgICAgYWRkcmVzczogIjB4NWY1YTQwNEE1ZWRhYmNERDgwREIwNUU4ZTU0QTc4YzlFQkYwMDBDMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDY0NjYxMzYKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzOQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmdiaXJkLmpzCiAgdmFyIHNvbmdiaXJkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOSwKICAgIG5hbWU6ICJTb25nYmlyZCBDYW5hcnktTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb25nYmlyZCIsCiAgICAgIHN5bWJvbDogIlNHQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NvbmdiaXJkLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNvbmdiaXJkIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NvbmdiaXJkLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc29uZ2JpcmQtZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zb25nYmlyZFRlc3RuZXQuanMKICB2YXIgc29uZ2JpcmRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNiwKICAgIG5hbWU6ICJTb25nYmlyZCBUZXN0bmV0IENvc3RvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3N0b24gRmxhcmUiLAogICAgICBzeW1ib2w6ICJDRkxSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vY29zdG9uLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvc3RvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc29waG9uVGVzdG5ldC5qcwogIHZhciBzb3Bob25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDUzMTA1MDEwNCwKICAgIG5hbWU6ICJTb3Bob24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb3Bob24iLAogICAgICBzeW1ib2w6ICJTT1BIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5zb3Bob24ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50ZXN0bmV0LnNvcGhvbi54eXovd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTb3Bob24gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5zb3Bob24ueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4M2MwNGQxMTJhZGVkQTJDNkQ5MDM3YmI2ZWNiNDJFN2YwYjEwOEFmIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NjQyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3BpY3kuanMKICB2YXIgc3BpY3kgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODgyLAogICAgbmFtZTogIkNoaWxpeiBTcGljeSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJjaGlsaXotc3BpY3ktVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDSFoiLAogICAgICBzeW1ib2w6ICJDSFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vc3BpY3ktcnBjLmNoaWxpei5jb20iLAogICAgICAgICAgImh0dHBzOi8vY2hpbGl6LXNwaWN5LXJwYy5wdWJsaWNub2RlLmNvbSIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3NwaWN5LXJwYy13cy5jaGlsaXouY29tIiwKICAgICAgICAgICJ3c3M6Ly9jaGlsaXotc3BpY3ktcnBjLnB1YmxpY25vZGUuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hpbGl6IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwOi8vc3BpY3ktZXhwbG9yZXIuY2hpbGl6LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cDovL3NwaWN5LWV4cGxvcmVyLmNoaWxpei5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3N0ZXAuanMKICB2YXIgc3RlcCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzNCwKICAgIG5hbWU6ICJTdGVwIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZJVEZJIiwgc3ltYm9sOiAiRklURkkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RlcC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3RlcCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3N0ZXBzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdG9yeVRlc3RuZXQuanMKICB2YXIgc3RvcnlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTEzLAogICAgbmFtZTogIlN0b3J5IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSVAiLAogICAgICBzeW1ib2w6ICJJUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuc3RvcnlycGMuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdG9yeSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3RvcnlzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdHJhdGlzLmpzCiAgdmFyIHN0cmF0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwNTEwNSwKICAgIG5hbWU6ICJTdHJhdGlzIE1haW5uZXQiLAogICAgbmV0d29yazogInN0cmF0aXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIlN0cmF0aXMiLAogICAgICBzeW1ib2w6ICJTVFJBWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RyYXRpc2V2bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdHJhdGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnN0cmF0aXNldm0uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3VwZXJsdW1pby5qcwogIHZhciBzdXBlcmx1bWlvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODY2LAogICAgbmFtZTogIlN1cGVyTHVtaW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5sdW1pby5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkx1bWlvIGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmx1bWlvLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdXBlcnBvc2l0aW9uLmpzCiAgdmFyIHN1cGVycG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU1MjQ0LAogICAgbmFtZTogIlN1cGVycG9zaXRpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5zdXBlcnBvc2l0aW9uLnNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3VwZXJwb3NpdGlvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zdXBlcnBvc2l0aW9uLnNvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuLmpzCiAgdmFyIHN3YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1NCwKICAgIG5hbWU6ICJTd2FuIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQtcnBjLnN3YW5jaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3N3YW5zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuUHJveGltYVRlc3RuZXQuanMKICB2YXIgc3dhblByb3hpbWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDI0MTEzMywKICAgIG5hbWU6ICJTd2FuIFByb3hpbWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLXByb3hpbWEuc3dhbmNoYWluLmlvCSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlN3YW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcHJveGltYS1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3dhblNhdHVyblRlc3RuZXQuanMKICB2YXIgc3dhblNhdHVyblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjQsCiAgICBuYW1lOiAiU3dhbiBTYXR1cm4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vc2F0dXJuLXJwYy5zd2FuY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NhdHVybi1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pbi5qcwogIHZhciBzeXNjb2luID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NywKICAgIG5hbWU6ICJTeXNjb2luIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiU3lzY29pbiIsCiAgICAgIHN5bWJvbDogIlNZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnN5c2NvaW4ub3JnIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5zeXNjb2luLm9yZy93c3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTeXNjb2luRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI4NzEzOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pblRlc3RuZXQuanMKICB2YXIgc3lzY29pblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MDAsCiAgICBuYW1lOiAiU3lzY29pbiBUYW5lbmJhdW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTeXNjb2luIiwKICAgICAgc3ltYm9sOiAiU1lTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGFuZW5iYXVtLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50YW5lbmJhdW0uaW8vd3NzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3lzY29pblRlc3RuZXRFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90YW5lbmJhdW0uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjcxMjg4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrby5qcwogIHZhciB0YWlrbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3ZTMsCiAgICBuYW1lOiAiVGFpa28gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQudGFpa28ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLm1haW5uZXQudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGFpa29zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3RhaWtvc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkudGFpa29zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2IyNDM2Nzc0QzNlMTkxYzg1MDU2ZDI0OEVGNDI2MGNlNWYyN0E5RCIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhaWtvSGVrbGEuanMKICB2YXIgdGFpa29IZWtsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3MDA5LAogICAgbmFtZTogIlRhaWtvIEhla2xhIEwyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5oZWtsYS50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUYWlrb3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGVrbGEudGFpa29zY2FuLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29Kb2xuaXIuanMKICB2YXIgdGFpa29Kb2xuaXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNywKICAgIG5hbWU6ICJUYWlrbyBKb2xuaXIgKEFscGhhLTUgVGVzdG5ldCkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmpvbG5pci50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmpvbG5pci50YWlrby54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzMyNzA2CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29LYXRsYS5qcwogIHZhciB0YWlrb0thdGxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjcwMDgsCiAgICBuYW1lOiAiVGFpa28gS2F0bGEgKEFscGhhLTYgVGVzdG5ldCkiLAogICAgbmV0d29yazogInRrby1rYXRsYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMua2F0bGEudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rYXRsYS50YWlrby54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrb1Rlc3RuZXRTZXBvbGlhLmpzCiAgdmFyIHRhaWtvVGVzdG5ldFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNSwKICAgIG5hbWU6ICJUYWlrbyAoQWxwaGEtMyBUZXN0bmV0KSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdC50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3QudGFpa28ueHl6IgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFyYXhhLmpzCiAgdmFyIHRhcmF4YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQxLAogICAgbmFtZTogIlRhcmF4YSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tYWlubmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhcmF4YVRlc3RuZXQuanMKICB2YXIgdGFyYXhhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQyLAogICAgbmFtZTogIlRhcmF4YSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90ZWxjb2luVGVzdG5ldC5qcwogIHZhciB0ZWxjb2luVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAxNywKICAgIG5hbWU6ICJUZWxjb2luIEFkaXJpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRlbGNvaW4iLCBzeW1ib2w6ICJURUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVsY29pbi5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAidGVsc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZWxzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbG9zLmpzCiAgdmFyIHRlbG9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MCwKICAgIG5hbWU6ICJUZWxvcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJUZWxvcyIsCiAgICAgIHN5bWJvbDogIlRMT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnRlbG9zLm5ldC9ldm0iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUZWxvc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0NjUzMDcwOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGVsb3NUZXN0bmV0LmpzCiAgdmFyIHRlbG9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDEsCiAgICBuYW1lOiAiVGVsb3MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVsb3MiLAogICAgICBzeW1ib2w6ICJUTE9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC50ZWxvcy5uZXQvZXZtIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVsb3NjYW4gKHRlc3RuZXQpIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbmV0LmpzCiAgdmFyIHRlbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU5LAogICAgbmFtZTogIlRlbmV0IiwKICAgIG5ldHdvcms6ICJ0ZW5ldC1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJURU5FVCIsCiAgICAgIHN5bWJvbDogIlRFTkVUIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVuZXQub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVuZXRTY2FuIE1haW5uZXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVuZXRzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3RlbmV0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RoYWlDaGFpbi5qcwogIHZhciB0aGFpQ2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcsCiAgICBuYW1lOiAiVGhhaUNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUQ0giLCBzeW1ib2w6ICJUQ0giLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGhhaWNoYWluLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwRGFENjEzMGU4MzJjMjE3MTlDNUNFM2JhZTkzNDU0RTE2QTg0ODI2IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ4MDYzODYKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGh1bmRlckNvcmUuanMKICB2YXIgdGh1bmRlckNvcmUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwOCwKICAgIG5hbWU6ICJUaHVuZGVyQ29yZSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUVCIsIHN5bWJvbDogIlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMudGh1bmRlcmNvcmUuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGh1bmRlckNvcmUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdmlld2Jsb2NrLmlvL3RodW5kZXJjb3JlIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aHVuZGVyVGVzdG5ldC5qcwogIHZhciB0aHVuZGVyVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTk3LAogICAgbmFtZTogIjVpcmVDaGFpbiBUaHVuZGVyIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIjVpcmUgVG9rZW4iLCBzeW1ib2w6ICI1SVJFIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuNWlyZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiNWlyZUNoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLjVpcmUubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aWt0cml4VGVzdG5ldC5qcwogIHZhciB0aWt0cml4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjIwOTIsCiAgICBuYW1lOiAiVGlrVHJpeCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJ0VFRYIiwKICAgICAgc3ltYm9sOiAidFRUWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90aWt0cml4LXJwYy54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUaWtUcml4IFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGlrdHJpeC54eXoiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdHJvbi5qcwogIHZhciB0cm9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MjgxMjY0MjgsCiAgICBuYW1lOiAiVHJvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVFJPTiIsIHN5bWJvbDogIlRSWCIsIGRlY2ltYWxzOiA2IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLnRyb25ncmlkLmlvL2pzb25ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUcm9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90cm9uc2Nhbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpbGlzdC50cm9uc2NhbmFwaS5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdWx0cm9uLmpzCiAgdmFyIHVsdHJvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMSwKICAgIG5hbWU6ICJVbHRyb24gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVUxYIiwgc3ltYm9sOiAiVUxYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdWx0cm9uLXJwYy5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbHRyb24gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly91bHhzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdWx0cm9uVGVzdG5ldC5qcwogIHZhciB1bHRyb25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMwLAogICAgbmFtZTogIlVsdHJvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJVTFgiLCBzeW1ib2w6ICJVTFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly91bHRyb24tZGV2LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVWx0cm9uIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudWx0cm9uLWRldi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy91bmljaGFpblNlcG9saWEuanMKICB2YXIgc291cmNlSWQ0MCA9IDExMTU1MTExOwogIHZhciB1bmljaGFpblNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEzMDEsCiAgICBuYW1lOiAiVW5pY2hhaW4gU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS51bmljaGFpbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEudW5pc2Nhbi54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEudW5pc2Nhbi54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQ0MF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDBkODNkYWI2MjlmMGUwRjlkMzZjMENiYzg5QjY5YTQ4OWYwNzUxYkQiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlYTU4ZmNBNjg0OWQ3OUVBZDFmMjY2MDg4NTVjMkQ2NDA3ZDU0Q2UyIgogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlZmY3M2U1YWEzQjlBRUMzMmM2NTlBYTNFMDA0NDRkMjBhODQzOTRiIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ0MAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VuaXF1ZS5qcwogIHZhciB1bmlxdWUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODAsCiAgICBuYW1lOiAiVW5pcXVlIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVU5RIiwKICAgICAgc3ltYm9sOiAiVU5RIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnVuaXF1ZS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVW5pcXVlIFN1YnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdW5pcXVlLnN1YnNjYW4uaW8vIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdW5pcXVlT3BhbC5qcwogIHZhciB1bmlxdWVPcGFsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODgyLAogICAgbmFtZTogIk9wYWwgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPUEwiLAogICAgICBzeW1ib2w6ICJPUEwiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtb3BhbC51bmlxdWUubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9wYWwgU3Vic2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9vcGFsLnN1YnNjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VuaXF1ZVF1YXJ0ei5qcwogIHZhciB1bmlxdWVRdWFydHogPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODEsCiAgICBuYW1lOiAiUXVhcnR6IE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUVRaIiwKICAgICAgc3ltYm9sOiAiUVRaIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLXF1YXJ0ei51bmlxdWUubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlF1YXJ0eiBTdWJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3F1YXJ0ei5zdWJzY2FuLmlvLyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VucmVhbC5qcwogIHZhciB1bnJlYWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4MjMzLAogICAgbmFtZTogIlVucmVhbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAicmVFVEgiLAogICAgICBkZWNpbWFsczogMTgsCiAgICAgIHN5bWJvbDogInJlRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnVucmVhbC1vcmJpdC5nZWxhdG8uZGlnaXRhbCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlVucmVhbCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly91bnJlYWwuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdW5yZWFsLmJsb2Nrc2NvdXQuY29tL2FwaS92MiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDhiNkIwZTYwRDhDRDg0ODk4RWE4Yjk4MTA2NUExMkY4NzZlQTU2NzciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0NQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmVjaGFpbi5qcwogIHZhciB2ZWNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDAwMDksCiAgICBuYW1lOiAiVmVjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVmVDaGFpbiIsIHN5bWJvbDogIlZFVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQudmVjaGFpbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWZWNoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmUudmVjaGFpbi5vcmciCiAgICAgIH0sCiAgICAgIHZlY2hhaW5TdGF0czogewogICAgICAgIG5hbWU6ICJWZWNoYWluIFN0YXRzIiwKICAgICAgICB1cmw6ICJodHRwczovL3ZlY2hhaW5zdGF0cy5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92ZWxhcy5qcwogIHZhciB2ZWxhcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTA2LAogICAgbmFtZTogIlZlbGFzIEVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWTFgiLCBzeW1ib2w6ICJWTFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm1leHBsb3Jlci52ZWxhcy5jb20vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVmVsYXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtZXhwbG9yZXIudmVsYXMuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92aWN0aW9uLmpzCiAgdmFyIHZpY3Rpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4LAogICAgbmFtZTogIlZpY3Rpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZpY3Rpb24iLCBzeW1ib2w6ICJWSUMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudmljdGlvbi54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWSUMgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly92aWNzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmljdGlvblRlc3RuZXQuanMKICB2YXIgdmljdGlvblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg5LAogICAgbmFtZTogIlZpY3Rpb24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVmljdGlvbiIsIHN5bWJvbDogIlZJQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0LnZpY3Rpb24ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVklDIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC52aWNzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjE3MDE3OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Zpc2lvbi5qcwogIHZhciB2aXNpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODg4OCwKICAgIG5hbWU6ICJWaXNpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZJU0lPTiIsIHN5bWJvbDogIlZTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vaW5mcmFncmlkLnYubmV0d29yay9ldGhlcmV1bS9jb21wYXRpYmxlIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVmlzaW9uIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdmlzaW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Zpc2lvblRlc3RuZXQuanMKICB2YXIgdmlzaW9uVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjY2NjY2LAogICAgbmFtZTogIlZpc2lvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWSVNJT04iLCBzeW1ib2w6ICJWUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3ZwaW9uZWVyLmluZnJhZ3JpZC52Lm5ldHdvcmsvZXRoZXJldW0vY29tcGF0aWJsZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlZpc2lvbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Zpc2lvbnNjYW4ub3JnLz9jaGFpbj12cGlvbmVlciIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93YW5jaGFpbi5qcwogIHZhciB3YW5jaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg4LAogICAgbmFtZTogIldhbmNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJXQU5DSEFJTiIsIHN5bWJvbDogIldBTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vZ3dhbi1zc2wud2FuZGV2cy5vcmc6NTY4OTEiLAogICAgICAgICAgImh0dHBzOi8vZ3dhbjItc3NsLndhbmRldnMub3JnIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV2FuU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW5zY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0RGNkExNTY2ZTc4RUI0NTk0Yzg2RmU3M0ZjZGM4MjQyOWU5N2ZiQiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNTMxMjM5MAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd2FuY2hhaW5UZXN0bmV0LmpzCiAgdmFyIHdhbmNoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTk5LAogICAgbmFtZTogIldhbmNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIldBTkNIQUlOIiwgc3ltYm9sOiAiV0FOdCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2d3YW4tc3NsLndhbmRldnMub3JnOjQ2ODkxIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV2FuU2NhblRlc3QiLAogICAgICAgIHVybDogImh0dHBzOi8vd2Fuc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDExYzg5YkY0NDk2YzM5RkI4MDUzNUZmYjRjOTI3MTU4MzlDQzUzMjQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQ3NDM0NDgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZWF2ZXZtQWxwaGFuZXQuanMKICB2YXIgd2VhdmVWTUFscGhhbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NDk2LAogICAgbmFtZTogIldlYXZlVk0gQWxwaGFuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRlc3RuZXQgV2VhdmVWTSIsIHN5bWJvbDogInRXVk0iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMud3ZtLmRldiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIldlYXZlVk0gQWxwaGFuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIud3ZtLmRldiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZW1peC5qcwogIHZhciB3ZW1peCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTExMSwKICAgIG5hbWU6ICJXRU1JWCIsCiAgICBuZXR3b3JrOiAid2VtaXgtbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiV0VNSVgiLCBzeW1ib2w6ICJXRU1JWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkud2VtaXguY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAid2VtaXhFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci53ZW1peC5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZW1peFRlc3RuZXQuanMKICB2YXIgd2VtaXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTEyLAogICAgbmFtZTogIldFTUlYIFRlc3RuZXQiLAogICAgbmV0d29yazogIndlbWl4LXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIldFTUlYIiwgc3ltYm9sOiAidFdFTUlYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS50ZXN0LndlbWl4LmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIndlbWl4RXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC53ZW1peHNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQud2VtaXhzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd29ybGRjaGFpbi5qcwogIHZhciBzb3VyY2VJZDQxID0gMTsKICB2YXIgd29ybGRjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDgwLAogICAgbmFtZTogIldvcmxkIENoYWluIiwKICAgIG5ldHdvcms6ICJ3b3JsZGNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly93b3JsZGNoYWluLW1haW5uZXQuZy5hbGNoZW15LmNvbS9wdWJsaWMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJXb3JsZHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd29ybGRzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkud29ybGRzY2FuLm9yZy9hcGkiCiAgICAgIH0sCiAgICAgIGJsb2Nrc2NvdXQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93b3JsZGNoYWluLW1haW5uZXQuZXhwbG9yZXIuYWxjaGVteS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vd29ybGRjaGFpbi1tYWlubmV0LmV4cGxvcmVyLmFsY2hlbXkuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDQxXTogewogICAgICAgICAgYWRkcmVzczogIjB4MEU5MGRDQUZCQzI0MkQyQzg2MUEyMEJiMjBFQzhFNzE4Mjk2NWE1MiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNDFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxOUE2ZDFFOTAzNDU5NjE5NjI5NUNGMTQ4NTA5Nzk2OTc4MzQzYzVEIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkNWVjMTRhODNCN2Q5NUJFMUUyQWMxMjUyM2UyZEVFMTJDYmVlYTZDIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQxXTogewogICAgICAgICAgYWRkcmVzczogIjB4NDcwNDU4QzkxOTc4RDJkOTI5NzA0NDg5QWQ3MzBEQzNFMzAwMTExMyIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQxCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd29ybGRjaGFpblNlcG9saWEuanMKICB2YXIgc291cmNlSWQ0MiA9IDExMTU1MTExOwogIHZhciB3b3JsZGNoYWluU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDgwMSwKICAgIG5hbWU6ICJXb3JsZCBDaGFpbiBTZXBvbGlhIiwKICAgIG5ldHdvcms6ICJ3b3JsZGNoYWluLXNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3dvcmxkY2hhaW4tc2Vwb2xpYS5nLmFsY2hlbXkuY29tL3B1YmxpYyJdIH0sCiAgICAgIHB1YmxpYzogeyBodHRwOiBbImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmcuYWxjaGVteS5jb20vcHVibGljIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV29ybGRzY2FuIFNlcG9saWEiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS53b3JsZHNjYW4ub3JnIgogICAgICB9LAogICAgICBibG9ja3Njb3V0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmV4cGxvcmVyLmFsY2hlbXkuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3dvcmxkY2hhaW4tc2Vwb2xpYS5leHBsb3Jlci5hbGNoZW15LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9LAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDhjRjk3RWU2MTZDOTg2YTA3MEY1MDIwZDk3M2I0NTZEMDEyMEMyNTMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4Yzg4ODZmOEJBYjZFYWViMjE1YURCNWYxYzY4NkJGNjk5MjQ4MzAwZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4RmY2RUJhMTA5MjcxZmU2ZDQyMzdFZWVENGJBYjFkRDlBNzdkRDFBNCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ3REY1NGIzOTg5ODU1ZWI2NjQ5NzMwMWE0YUFFYzMzRGJiM0Y4REUiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGFpLmpzCiAgdmFyIHhhaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjYwMjc5LAogICAgbmFtZTogIlhhaSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJYYWkiLCBzeW1ib2w6ICJYQUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly94YWktY2hhaW4ubmV0L3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIueGFpLWNoYWluLm5ldCIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMjI1NDkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGFpVGVzdG5ldC5qcwogIHZhciB4YWlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNzcxNDU1NTQyOSwKICAgIG5hbWU6ICJYYWkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic1hhaSIsIHN5bWJvbDogInNYQUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXYyLnhhaS1jaGFpbi5uZXQvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLXYyLnhhaS1jaGFpbi5uZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGRjLmpzCiAgdmFyIHhkYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAsCiAgICBuYW1lOiAiWGluRmluIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWERDIiwKICAgICAgc3ltYm9sOiAiWERDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnhkY3JwYy5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJYRENTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3hkY3NjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwQjE3OTVjY0E4RTRlQzRkZjAyMzQ2YTA4MmRmNTRENDM3RjhEOWFGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc1ODg0MDIwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy94ZGNUZXN0bmV0LmpzCiAgdmFyIHhkY1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUxLAogICAgbmFtZTogIkFwb3RoZW0gTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJUWERDIiwKICAgICAgc3ltYm9sOiAiVFhEQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2VycGMuYXBvdGhlbS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcG90aGVtLmJsb2Nrc3NjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTk3NjUzODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3hMYXllci5qcwogIHZhciB4TGF5ZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5NiwKICAgIG5hbWU6ICJYIExheWVyIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiT0tCIiwKICAgICAgc3ltYm9sOiAiT0tCIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnhsYXllci50ZWNoIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT0tMaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5va2xpbmsuY29tL3hsYXllciIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cub2tsaW5rLmNvbS9hcGkvdjUvZXhwbG9yZXIveGxheWVyL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NzQxNgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveExheWVyVGVzdG5ldC5qcwogIHZhciB4TGF5ZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOTUsCiAgICBuYW1lOiAiWDEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPS0IiLAogICAgICBzeW1ib2w6ICJPS0IiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly94bGF5ZXJ0ZXN0cnBjLm9reC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPS0xpbmsiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm9rbGluay5jb20veGxheWVyLXRlc3QiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjI0MzQ0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveHJTZXBvbGlhLmpzCiAgdmFyIHhyU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjczMCwKICAgIG5hbWU6ICJYUiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRYUiIsCiAgICAgIHN5bWJvbDogInRYUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3hyLXNlcG9saWEtdGVzdG5ldC5ycGMuY2FsZGVyYS54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8veHItc2Vwb2xpYS10ZXN0bmV0LmV4cGxvcmVyLmNhbGRlcmEueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3lvb2xkb1ZlcnNlLmpzCiAgdmFyIHlvb2xkb1ZlcnNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNSwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk9BUyIsIHN5bWJvbDogIk9BUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy55b29sZG8tdmVyc2UueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWW9vbGRvIFZlcnNlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnlvb2xkby12ZXJzZS54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy95b29sZG9WZXJzZVRlc3RuZXQuanMKICB2YXIgeW9vbGRvVmVyc2VUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNiwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiT0FTIiwgc3ltYm9sOiAiT0FTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIllvb2xkbyBWZXJzZSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96ZW5jaGFpblRlc3RuZXQuanMKICB2YXIgemVuY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NDA4LAogICAgbmFtZTogIlplbmNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWkNYIiwKICAgICAgc3ltYm9sOiAiWkNYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYy13cyJdCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjMwMDE5CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlplbnRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3plbnRyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3pldGFjaGFpbi5qcwogIHZhciB6ZXRhY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDdlMywKICAgIG5hbWU6ICJaZXRhQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWmV0YSIsCiAgICAgIHN5bWJvbDogIlpFVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3pldGFjaGFpbi1ldm0uYmxvY2twaS5uZXR3b3JrL3YxL3JwYy9wdWJsaWMiXQogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MzI3ODEKICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmV0YVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemV0YWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemV0YWNoYWluQXRoZW5zVGVzdG5ldC5qcwogIHZhciB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MDAxLAogICAgbmFtZTogIlpldGFDaGFpbiBBdGhlbnMgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJaZXRhIiwKICAgICAgc3ltYm9sOiAiYVpFVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3pldGFjaGFpbi1hdGhlbnMtZXZtLmJsb2NrcGkubmV0d29yay92MS9ycGMvcHVibGljIl0KICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNzE1MjE3CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlpldGFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2F0aGVucy5leHBsb3Jlci56ZXRhY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3poZWppYW5nLmpzCiAgdmFyIHpoZWppYW5nID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3ODAzLAogICAgbmFtZTogIlpoZWppYW5nIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaGVqaWFuZyBFdGhlciIsIHN5bWJvbDogIlpoZWpFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuemhlamlhbmcuZXRocGFuZGFvcHMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZWFjb25jaGFpbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly96aGVqaWFuZy5iZWFjb25jaGEuaW4iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemlsbGlxYS5qcwogIHZhciB6aWxsaXFhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjc2OSwKICAgIG5hbWU6ICJaaWxsaXFhIiwKICAgIG5ldHdvcms6ICJ6aWxsaXFhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaWxsaXFhIiwgc3ltYm9sOiAiWklMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLnppbGxpcWEuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJuYWwiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZteC56aWxsaXFhLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemlsbGlxYVRlc3RuZXQuanMKICB2YXIgemlsbGlxYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMTAxLAogICAgbmFtZTogIlppbGxpcWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemlsbGlxYS10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaWxsaXFhIiwgc3ltYm9sOiAiWklMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZGV2LWFwaS56aWxsaXFhLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybmFsIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bXgudGVzdG5ldC56aWxsaXFhLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aXJjdWl0LmpzCiAgdmFyIHppcmN1aXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ4OTAwLAogICAgbmFtZTogIlppcmN1aXQgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0MS1tYWlubmV0LnAycGlmeS5jb20iLAogICAgICAgICAgImh0dHBzOi8vemlyY3VpdDEtbWFpbm5ldC5saXF1aWZ5LmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0LW1haW5uZXQuZHJwYy5vcmciCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJaaXJjdWl0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnppcmN1aXQuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aXJjdWl0VGVzdG5ldC5qcwogIHZhciB6aXJjdWl0VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDg4OTksCiAgICBuYW1lOiAiWmlyY3VpdCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFVEgiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3ppcmN1aXQxLXRlc3RuZXQucDJwaWZ5LmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0MS10ZXN0bmV0LmxpcXVpZnkuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmlyY3VpdCBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuemlyY3VpdC5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjA0MDI4NwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prRmFpci5qcwogIHZhciB6a0ZhaXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyNzY2LAogICAgbmFtZTogIlpLRmFpciBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJ6a2ZhaXItbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJVU0QgQ29pbiIsCiAgICAgIHN5bWJvbDogIlVTREMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy56a2ZhaXIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0ZhaXIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi56a2ZhaXIuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi56a2ZhaXIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYwOTA5NTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtGYWlyVGVzdG5ldC5qcwogIHZhciB6a0ZhaXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Mzg1MSwKICAgIG5hbWU6ICJaS0ZhaXIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemtmYWlyLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVVNEIENvaW4iLAogICAgICBzeW1ib2w6ICJVU0RDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy56a2ZhaXIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0ZhaXIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1zY2FuLnprZmFpci5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a0xpbmtOb3ZhLmpzCiAgdmFyIHprTGlua05vdmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgxMDE4MCwKICAgIG5hbWU6ICJ6a0xpbmsgTm92YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuemtsaW5rLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiemtMaW5rIE5vdmEgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtsaW5rLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtMaW5rTm92YVNlcG9saWFUZXN0bmV0LmpzCiAgdmFyIHprTGlua05vdmFTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODEwMTgxLAogICAgbmFtZTogInprTGluayBOb3ZhIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLnJwYy56a2xpbmsuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0xpbmsgTm92YSBCbG9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnprbGluay5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prc3luYy5qcwogIHZhciB6a3N5bmMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcsCiAgICBpZDogMzI0LAogICAgbmFtZTogIlpLc3luYyBFcmEiLAogICAgbmV0d29yazogInprc3luYy1lcmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuZXJhLnprc3luYy5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LmVyYS56a3N5bmMuaW8vd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXJhLnprc3luYy5uZXR3b3JrLyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktZXJhLnprc3luYy5uZXR3b3JrL2FwaSIKICAgICAgfSwKICAgICAgbmF0aXZlOiB7CiAgICAgICAgbmFtZTogIlpLc3luYyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56a3N5bmMuaW8vIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2NrLWV4cGxvcmVyLWFwaS5tYWlubmV0Lnprc3luYy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEY5Y2RhNjI0RkJDN2UwNTkzNTVjZTk4YTMxNjkzZDI5OUZBQ2Q5NjMiCiAgICAgIH0sCiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZkI2ODgzMzAzNzk5NzZEQTgxZUI2NEZlNEJGNTBkNzQwMTc2M0I5QyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NTY1OTM4OAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtzeW5jSW5NZW1vcnlOb2RlLmpzCiAgdmFyIHprc3luY0luTWVtb3J5Tm9kZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAyNjAsCiAgICBuYW1lOiAiWktzeW5jIEluTWVtb3J5IE5vZGUiLAogICAgbmV0d29yazogInprc3luYy1pbi1tZW1vcnktbm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovL2xvY2FsaG9zdDo4MDExIl0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a3N5bmNMb2NhbE5vZGUuanMKICB2YXIgemtzeW5jTG9jYWxOb2RlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDI3MCwKICAgIG5hbWU6ICJaS3N5bmMgQ0xJIExvY2FsIE5vZGUiLAogICAgbmV0d29yazogInprc3luYy1jbGktbG9jYWwtbm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovL2xvY2FsaG9zdDozMDUwIl0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a3N5bmNTZXBvbGlhVGVzdG5ldC5qcwogIHZhciB6a3N5bmNTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAzMDAsCiAgICBuYW1lOiAiWktzeW5jIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemtzeW5jLXNlcG9saWEtdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLmVyYS56a3N5bmMuZGV2Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NlcG9saWEuZXJhLnprc3luYy5kZXYvd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS1lcmEuemtzeW5jLm5ldHdvcmsvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLWVyYS56a3N5bmMubmV0d29yay9hcGkiCiAgICAgIH0sCiAgICAgIG5hdGl2ZTogewogICAgICAgIG5hbWU6ICJaS3N5bmMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci56a3N5bmMuaW8vIiwKICAgICAgICBibG9ja0V4cGxvcmVyQXBpOiAiaHR0cHM6Ly9ibG9jay1leHBsb3Jlci1hcGkuc2Vwb2xpYS56a3N5bmMuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RjljZGE2MjRGQkM3ZTA1OTM1NWNlOThhMzE2OTNkMjk5RkFDZDk2MyIKICAgICAgfSwKICAgICAgdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmQjY4ODMzMDM3OTk3NkRBODFlQjY0RmU0QkY1MGQ3NDAxNzYzQjlDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM4NTU3MTIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96b3JhLmpzCiAgdmFyIHNvdXJjZUlkNDMgPSAxOwogIHZhciB6b3JhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA3Nzc3Nzc3LAogICAgbmFtZTogIlpvcmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy56b3JhLmVuZXJneSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuem9yYS5lbmVyZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56b3JhLmVuZXJneSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56b3JhLmVuZXJneS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ0M106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDlFNjIwNEY3NTBjRDg2NmIyOTk1OTRlMmFDOWVBODI0RTJlNWY5NWMiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1ODgyCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQzXTogewogICAgICAgICAgYWRkcmVzczogIjB4MWEwYWQwMTE5MTNBMTUwZjY5ZjZBMTlERjQ0N0EwQ2ZEOTU1MTA1NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0M106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDNlMkVhOUI5MkI3RTQ4QTUyMjk2ZkQyNjFkYzI2ZmQ5OTUyODQ2MzEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96b3JhU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDQ0ID0gMTExNTUxMTE7CiAgdmFyIHpvcmFTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA5OTk5OTk5OTksCiAgICBuYW1lOiAiWm9yYSBTZXBvbGlhIiwKICAgIG5ldHdvcms6ICJ6b3JhLXNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWm9yYSBTZXBvbGlhIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLnJwYy56b3JhLmVuZXJneSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9zZXBvbGlhLnJwYy56b3JhLmVuZXJneSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlpvcmEgU2Vwb2xpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnpvcmEuZW5lcmd5LyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnpvcmEuZW5lcmd5L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4MjYxNUI0ODFCZDNFNUExQzBDN0NhM0RhMWJkYzY2M0U4NjE1QWRlOSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDgzMTYwCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4ZWZmRTJDNmNBOUFiNzk3RDQxOGYwRDkxZUE2MDgwNzcxM2YzNTM2ZiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0NF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDUzNzZmMUQ1NDNkY2JCNUJENDE2YzU2QzE4OWU0Y0I3Mzk5ZkNjQ0IiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDQsCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvem9yYVRlc3RuZXQuanMKICB2YXIgc291cmNlSWQ0NSA9IDU7CiAgdmFyIHpvcmFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA5OTksCiAgICBuYW1lOiAiWm9yYSBHb2VybGkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJab3JhIEdvZXJsaSIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ycGMuem9yYS5lbmVyZ3kiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC5ycGMuem9yYS5lbmVyZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLnpvcmEuZW5lcmd5IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuZXhwbG9yZXIuem9yYS5lbmVyZ3kvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4OTEyMwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQ0NV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweERiOUY1MTc5MDM2NWU3ZGMxOTZlN0QwNzI3MjhkZjM5QmU5NThBQ2UiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDUsCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy9wcml2YXRlS2V5VG9BY2NvdW50LmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy90b0FjY291bnQuanMKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGZ1bmN0aW9uIHRvQWNjb3VudChzb3VyY2UpIHsKICAgIGlmICh0eXBlb2Ygc291cmNlID09PSAic3RyaW5nIikgewogICAgICBpZiAoIWlzQWRkcmVzcyhzb3VyY2UsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHNvdXJjZSB9KTsKICAgICAgcmV0dXJuIHsKICAgICAgICBhZGRyZXNzOiBzb3VyY2UsCiAgICAgICAgdHlwZTogImpzb24tcnBjIgogICAgICB9OwogICAgfQogICAgaWYgKCFpc0FkZHJlc3Moc291cmNlLmFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBzb3VyY2UuYWRkcmVzcyB9KTsKICAgIHJldHVybiB7CiAgICAgIGFkZHJlc3M6IHNvdXJjZS5hZGRyZXNzLAogICAgICBub25jZU1hbmFnZXI6IHNvdXJjZS5ub25jZU1hbmFnZXIsCiAgICAgIHNpZ246IHNvdXJjZS5zaWduLAogICAgICBleHBlcmltZW50YWxfc2lnbkF1dGhvcml6YXRpb246IHNvdXJjZS5leHBlcmltZW50YWxfc2lnbkF1dGhvcml6YXRpb24sCiAgICAgIHNpZ25NZXNzYWdlOiBzb3VyY2Uuc2lnbk1lc3NhZ2UsCiAgICAgIHNpZ25UcmFuc2FjdGlvbjogc291cmNlLnNpZ25UcmFuc2FjdGlvbiwKICAgICAgc2lnblR5cGVkRGF0YTogc291cmNlLnNpZ25UeXBlZERhdGEsCiAgICAgIHNvdXJjZTogImN1c3RvbSIsCiAgICAgIHR5cGU6ICJsb2NhbCIKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvc2lnbi5qcwogIGluaXRfc2VjcDI1NmsxKCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNpZ24oeyBoYXNoOiBoYXNoMywgcHJpdmF0ZUtleSwgdG8gPSAib2JqZWN0IiB9KSB7CiAgICBjb25zdCB7IHIsIHMsIHJlY292ZXJ5IH0gPSBzZWNwMjU2azEuc2lnbihoYXNoMy5zbGljZSgyKSwgcHJpdmF0ZUtleS5zbGljZSgyKSk7CiAgICBjb25zdCBzaWduYXR1cmUgPSB7CiAgICAgIHI6IG51bWJlclRvSGV4KHIsIHsgc2l6ZTogMzIgfSksCiAgICAgIHM6IG51bWJlclRvSGV4KHMsIHsgc2l6ZTogMzIgfSksCiAgICAgIHY6IHJlY292ZXJ5ID8gMjhuIDogMjduLAogICAgICB5UGFyaXR5OiByZWNvdmVyeQogICAgfTsKICAgIHJldHVybiAoKCkgPT4gewogICAgICBpZiAodG8gPT09ICJieXRlcyIgfHwgdG8gPT09ICJoZXgiKQogICAgICAgIHJldHVybiBzZXJpYWxpemVTaWduYXR1cmUoeyAuLi5zaWduYXR1cmUsIHRvIH0pOwogICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgfSkoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduQXV0aG9yaXphdGlvbi5qcwogIGFzeW5jIGZ1bmN0aW9uIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbihwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UsIHByaXZhdGVLZXksIHRvID0gIm9iamVjdCIgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBzaWduKHsKICAgICAgaGFzaDogaGFzaEF1dGhvcml6YXRpb24oeyBjb250cmFjdEFkZHJlc3MsIGNoYWluSWQsIG5vbmNlIH0pLAogICAgICBwcml2YXRlS2V5LAogICAgICB0bwogICAgfSk7CiAgICBpZiAodG8gPT09ICJvYmplY3QiKQogICAgICByZXR1cm4gewogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBjaGFpbklkLAogICAgICAgIG5vbmNlLAogICAgICAgIC4uLnNpZ25hdHVyZQogICAgICB9OwogICAgcmV0dXJuIHNpZ25hdHVyZTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduTWVzc2FnZS5qcwogIGFzeW5jIGZ1bmN0aW9uIHNpZ25NZXNzYWdlMih7IG1lc3NhZ2UsIHByaXZhdGVLZXkgfSkgewogICAgcmV0dXJuIGF3YWl0IHNpZ24oeyBoYXNoOiBoYXNoTWVzc2FnZShtZXNzYWdlKSwgcHJpdmF0ZUtleSwgdG86ICJoZXgiIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3V0aWxzL3NpZ25UcmFuc2FjdGlvbi5qcwogIGluaXRfa2VjY2FrMjU2KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2lnblRyYW5zYWN0aW9uMihwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHByaXZhdGVLZXksIHRyYW5zYWN0aW9uLCBzZXJpYWxpemVyID0gc2VyaWFsaXplVHJhbnNhY3Rpb24gfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYWJsZVRyYW5zYWN0aW9uID0gKCgpID0+IHsKICAgICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUgPT09ICJlaXA0ODQ0IikKICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgICBzaWRlY2FyczogZmFsc2UKICAgICAgICB9OwogICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICB9KSgpOwogICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgc2lnbih7CiAgICAgIGhhc2g6IGtlY2NhazI1NihzZXJpYWxpemVyKHNpZ25hYmxlVHJhbnNhY3Rpb24pKSwKICAgICAgcHJpdmF0ZUtleQogICAgfSk7CiAgICByZXR1cm4gc2VyaWFsaXplcih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduVHlwZWREYXRhLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2lnblR5cGVkRGF0YTIocGFyYW1ldGVycykgewogICAgY29uc3QgeyBwcml2YXRlS2V5LCAuLi50eXBlZERhdGEgfSA9IHBhcmFtZXRlcnM7CiAgICByZXR1cm4gYXdhaXQgc2lnbih7CiAgICAgIGhhc2g6IGhhc2hUeXBlZERhdGEodHlwZWREYXRhKSwKICAgICAgcHJpdmF0ZUtleSwKICAgICAgdG86ICJoZXgiCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy9wcml2YXRlS2V5VG9BY2NvdW50LmpzCiAgZnVuY3Rpb24gcHJpdmF0ZUtleVRvQWNjb3VudChwcml2YXRlS2V5LCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IHsgbm9uY2VNYW5hZ2VyOiBub25jZU1hbmFnZXIyIH0gPSBvcHRpb25zOwogICAgY29uc3QgcHVibGljS2V5ID0gdG9IZXgoc2VjcDI1NmsxLmdldFB1YmxpY0tleShwcml2YXRlS2V5LnNsaWNlKDIpLCBmYWxzZSkpOwogICAgY29uc3QgYWRkcmVzcyA9IHB1YmxpY0tleVRvQWRkcmVzcyhwdWJsaWNLZXkpOwogICAgY29uc3QgYWNjb3VudCA9IHRvQWNjb3VudCh7CiAgICAgIGFkZHJlc3MsCiAgICAgIG5vbmNlTWFuYWdlcjogbm9uY2VNYW5hZ2VyMiwKICAgICAgYXN5bmMgc2lnbih7IGhhc2g6IGhhc2gzIH0pIHsKICAgICAgICByZXR1cm4gc2lnbih7IGhhc2g6IGhhc2gzLCBwcml2YXRlS2V5LCB0bzogImhleCIgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbihhdXRob3JpemF0aW9uKSB7CiAgICAgICAgcmV0dXJuIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbih7IC4uLmF1dGhvcml6YXRpb24sIHByaXZhdGVLZXkgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25NZXNzYWdlKHsgbWVzc2FnZSB9KSB7CiAgICAgICAgcmV0dXJuIHNpZ25NZXNzYWdlMih7IG1lc3NhZ2UsIHByaXZhdGVLZXkgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgeyBzZXJpYWxpemVyIH0gPSB7fSkgewogICAgICAgIHJldHVybiBzaWduVHJhbnNhY3Rpb24yKHsgcHJpdmF0ZUtleSwgdHJhbnNhY3Rpb24sIHNlcmlhbGl6ZXIgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25UeXBlZERhdGEodHlwZWREYXRhKSB7CiAgICAgICAgcmV0dXJuIHNpZ25UeXBlZERhdGEyKHsgLi4udHlwZWREYXRhLCBwcml2YXRlS2V5IH0pOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIC4uLmFjY291bnQsCiAgICAgIHB1YmxpY0tleSwKICAgICAgc291cmNlOiAicHJpdmF0ZUtleSIKICAgIH07CiAgfQoKICAvLyBsaWJzL3NoaW5rYWktdmllbS9zcmMvaW5kZXgudHMKICB3aW5kb3cudmllbSA9IGVzbV9leHBvcnRzOwogIHdpbmRvdy5jaGFpbnMgPSBjaGFpbnNfZXhwb3J0czsKICB2YXIgVmllbVByb3ZpZGVyID0gY2xhc3MgewogICAgY2xpZW50OwogICAgc2VsZWN0ZWRBZGRyZXNzOwogICAgY29uc3RydWN0b3IoY2hhaW4sIHNrKSB7CiAgICAgIGNvbnN0IHByaXZhdGVLZXkgPSBzayB8fCAiMHhmNGMxYzZkOTIzMWE1ZjA4YWE4ZDk4MjRhMTQyYzRmYzVhNjYzY2ExYTZlY2Q2MTEyNmU1NGEwZDc1MDFkZjgyIjsKICAgICAgY29uc3QgYWNjb3VudCA9IHByaXZhdGVLZXlUb0FjY291bnQocHJpdmF0ZUtleSk7CiAgICAgIHRoaXMuY2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHsKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBjaGFpbiB8fCBhcmJpdHJ1bVNlcG9saWEsCiAgICAgICAgdHJhbnNwb3J0OiBodHRwKAogICAgICAgICAgImh0dHBzOi8vYXJiaXRydW0tc2Vwb2xpYS5ibG9ja3BpLm5ldHdvcmsvdjEvcnBjL3B1YmxpYyIKICAgICAgICApCiAgICAgIH0pLmV4dGVuZChwdWJsaWNBY3Rpb25zKTsKICAgICAgdGhpcy5jbGllbnQuZ2V0QWRkcmVzc2VzKCkudGhlbigoYWRkcmVzc2VzKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coImFkZHJlc3NlcyIsIGFkZHJlc3Nlcyk7CiAgICAgICAgdGhpcy5zZWxlY3RlZEFkZHJlc3MgPSBhZGRyZXNzZXNbMF07CiAgICAgIH0pOwogICAgfQogICAgYXN5bmMgZW5hYmxlKCkgewogICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0QWNjb3VudHMoKTsKICAgIH0KICAgIGFzeW5jIHJlcXVlc3QoeyBtZXRob2QsIHBhcmFtcyB9KSB7CiAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0IiwgbWV0aG9kLCBwYXJhbXMpOwogICAgICBzd2l0Y2ggKG1ldGhvZCkgewogICAgICAgIGNhc2UgImV0aF9yZXF1ZXN0QWNjb3VudHMiOgogICAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdEFjY291bnRzKCk7CiAgICAgICAgY2FzZSAiZXRoX2FjY291bnRzIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldEFjY291bnRzKCk7CiAgICAgICAgY2FzZSAiZXRoX3NlbmRUcmFuc2FjdGlvbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kVHJhbnNhY3Rpb24ocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfc2lnbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaWduKHBhcmFtc1swXSwgcGFyYW1zWzFdKTsKICAgICAgICBjYXNlICJwZXJzb25hbF9zaWduIjoKICAgICAgICAgIHJldHVybiB0aGlzLnBlcnNvbmFsU2lnbihwYXJhbXNbMF0sIHBhcmFtc1sxXSk7CiAgICAgICAgY2FzZSAiZXRoX3NpZ25UeXBlZERhdGEiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2lnblR5cGVkRGF0YShwYXJhbXNbMF0sIHBhcmFtc1sxXSk7CiAgICAgICAgY2FzZSAiZXRoX2NoYWluSWQiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2hhaW5JZCgpOwogICAgICAgIGNhc2UgIm5ldF92ZXJzaW9uIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldE5ldHdvcmtJZCgpOwogICAgICAgIGNhc2UgImV0aF9ibG9ja051bWJlciI6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCbG9ja051bWJlcigpOwogICAgICAgIGNhc2UgImV0aF9nZXRUcmFuc2FjdGlvbkNvdW50IjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zYWN0aW9uQ291bnQocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfZ2V0VHJhbnNhY3Rpb25CeUhhc2giOgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VHJhbnNhY3Rpb24ocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zYWN0aW9uUmVjZWlwdChwYXJhbXNbMF0pOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG1ldGhvZDogJHttZXRob2R9YCk7CiAgICAgIH0KICAgIH0KICAgIGFzeW5jIGdldFRyYW5zYWN0aW9uKGhhc2gzKSB7CiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VHJhbnNhY3Rpb24oeyBoYXNoOiBoYXNoMyB9KTsKICAgICAgY29uc29sZS5sb2coImdldFRyYW5zYWN0aW9uIiwgdHJhbnNhY3Rpb24pOwogICAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgICAgdHJhbnNhY3Rpb24udHlwZSA9ICIweDIiOwogICAgICB9CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0KICAgIGFzeW5jIGdldFRyYW5zYWN0aW9uUmVjZWlwdChoYXNoMykgewogICAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VHJhbnNhY3Rpb25SZWNlaXB0KHsgaGFzaDogaGFzaDMgfSk7CiAgICAgIGNvbnNvbGUubG9nKCJnZXRUcmFuc2FjdGlvblJlY2VpcHQiLCByZWNlaXB0KTsKICAgICAgaWYgKHJlY2VpcHQudHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgICAgcmVjZWlwdC50eXBlID0gIjB4MiI7CiAgICAgIH0KICAgICAgaWYgKHJlY2VpcHQuc3RhdHVzID09PSAic3VjY2VzcyIpIHsKICAgICAgICByZWNlaXB0LnN0YXR1cyA9ICIweDEiOwogICAgICB9CiAgICAgIHJldHVybiByZWNlaXB0OwogICAgfQogICAgYXN5bmMgZ2V0VHJhbnNhY3Rpb25Db3VudChhZGRyZXNzKSB7CiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uQ291bnQgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXRUcmFuc2FjdGlvbkNvdW50KHsgYWRkcmVzcyB9KTsKICAgICAgY29uc29sZS5sb2coInRyYW5zYWN0aW9uQ291bnQiLCB0cmFuc2FjdGlvbkNvdW50KTsKICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uQ291bnQ7CiAgICB9CiAgICBhc3luYyBnZXRCbG9ja051bWJlcigpIHsKICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXRCbG9ja051bWJlcigpOwogICAgICBjb25zb2xlLmxvZygiYmxvY2tOdW1iZXIiLCBibG9ja051bWJlcik7CiAgICAgIHJldHVybiBibG9ja051bWJlcjsKICAgIH0KICAgIGFzeW5jIHJlcXVlc3RBY2NvdW50cygpIHsKICAgICAgY29uc3QgW2FkZHJlc3NdID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0QWRkcmVzc2VzKCk7CiAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0QWNjb3VudHMiLCBhZGRyZXNzKTsKICAgICAgdGhpcy5zZWxlY3RlZEFkZHJlc3MgPSBhZGRyZXNzOwogICAgICByZXR1cm4gW2FkZHJlc3NdOwogICAgfQogICAgYXN5bmMgZ2V0QWNjb3VudHMoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkQWRkcmVzcyA/IFt0aGlzLnNlbGVjdGVkQWRkcmVzc10gOiBbXTsKICAgIH0KICAgIGFzeW5jIHNlbmRUcmFuc2FjdGlvbih0eCkgewogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRBZGRyZXNzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyBhY2NvdW50cyBhdmFpbGFibGUiKTsKICAgICAgfQogICAgICBpZiAoIXR4LnRvIHx8ICF0eC52YWx1ZSB8fCAhdHguZ2FzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIHJlcXVpcmVkIHRyYW5zYWN0aW9uIHBhcmFtZXRlcnMiKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygic2VuZFRyYW5zYWN0aW9uIHR4OiAiLCB0eCk7CiAgICAgIGNvbnNvbGUubG9nKCJUcmFuc2FjdGlvbiBnYXNQcmljZTogIiwgdHguZ2FzUHJpY2UpOwogICAgICBjb25zb2xlLmxvZygiVHJhbnNhY3Rpb24gZ2FzOiAiLCB0eC5nYXMpOwogICAgICBjb25zdCB2YWx1ZSA9IEJpZ0ludCh0eC52YWx1ZSk7CiAgICAgIGNvbnN0IHZhbHVlSW5FdGggPSBOdW1iZXIodmFsdWUpIC8gMTAgKiogMTg7CiAgICAgIGNvbnNvbGUubG9nKGBUcmFuc2FjdGlvbiB2YWx1ZSBpbiBFVEg6ICR7dmFsdWVJbkV0aH1gKTsKICAgICAgY29uc3QgdHJhbnNhY3Rpb25Db250ZW50ID0gewogICAgICAgIHRvOiB0eC50bywKICAgICAgICB2YWx1ZSwKICAgICAgICBkYXRhOiB0eC5kYXRhLAogICAgICAgIGNoYWluOiB0aGlzLmNsaWVudC5jaGFpbgogICAgICB9OwogICAgICBjb25zb2xlLmxvZygic2VuZFRyYW5zYWN0aW9uIiwgdHJhbnNhY3Rpb25Db250ZW50KTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgdGhpcy5jbGllbnQucHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdCh0cmFuc2FjdGlvbkNvbnRlbnQpOwogICAgICAgIGNvbnNvbGUubG9nKCJQcmVwYXJlZCB0cmFuc2FjdGlvbiByZXF1ZXN0OiIsIHJlcXVlc3QpOwogICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IGF3YWl0IHRoaXMuY2xpZW50LnNpZ25UcmFuc2FjdGlvbihyZXF1ZXN0KTsKICAgICAgICBjb25zb2xlLmxvZygiU2VyaWFsaXplZCB0cmFuc2FjdGlvbjoiLCBzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgICAgIGNvbnN0IGhhc2gzID0gYXdhaXQgdGhpcy5jbGllbnQuc2VuZFJhd1RyYW5zYWN0aW9uKHsKICAgICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbgogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCJzZW5kVHJhbnNhY3Rpb24gaGFzaCIsIGhhc2gzKTsKICAgICAgICByZXR1cm4gaGFzaDM7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigic2VuZFRyYW5zYWN0aW9uIGVycm9yIiwgZXJyb3IpOwogICAgICAgIHRocm93IGVycm9yOwogICAgICB9CiAgICB9CiAgICBhc3luYyBzaWduKGFkZHJlc3MsIG1lc3NhZ2UpIHsKICAgICAgaWYgKGFkZHJlc3MgIT09IHRoaXMuc2VsZWN0ZWRBZGRyZXNzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBZGRyZXNzIG1pc21hdGNoIik7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY2xpZW50LnNpZ25NZXNzYWdlKHsgYWNjb3VudDogYWRkcmVzcywgbWVzc2FnZSB9KTsKICAgIH0KICAgIGFzeW5jIHBlcnNvbmFsU2lnbihtZXNzYWdlLCBhZGRyZXNzKSB7CiAgICAgIGlmIChhZGRyZXNzICE9PSB0aGlzLnNlbGVjdGVkQWRkcmVzcykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQWRkcmVzcyBtaXNtYXRjaCIpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmNsaWVudC5zaWduTWVzc2FnZSh7IGFjY291bnQ6IGFkZHJlc3MsIG1lc3NhZ2UgfSk7CiAgICB9CiAgICBhc3luYyBzaWduVHlwZWREYXRhKGFkZHJlc3MsIHR5cGVkRGF0YSkgewogICAgICBpZiAoYWRkcmVzcyAhPT0gdGhpcy5zZWxlY3RlZEFkZHJlc3MpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkFkZHJlc3MgbWlzbWF0Y2giKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jbGllbnQuc2lnblR5cGVkRGF0YSh7CiAgICAgICAgYWNjb3VudDogYWRkcmVzcywKICAgICAgICBkb21haW46IHR5cGVkRGF0YS5kb21haW4sCiAgICAgICAgdHlwZXM6IHR5cGVkRGF0YS50eXBlcywKICAgICAgICBtZXNzYWdlOiB0eXBlZERhdGEubWVzc2FnZSwKICAgICAgICBwcmltYXJ5VHlwZTogdHlwZWREYXRhLnByaW1hcnlUeXBlCiAgICAgIH0pOwogICAgfQogICAgYXN5bmMgZ2V0Q2hhaW5JZCgpIHsKICAgICAgY29uc3QgY2hhaW5JZCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldENoYWluSWQoKTsKICAgICAgY29uc29sZS5sb2coImdldENoYWluSWQiLCBjaGFpbklkKTsKICAgICAgcmV0dXJuIGNoYWluSWQ7CiAgICB9CiAgICBhc3luYyBnZXROZXR3b3JrSWQoKSB7CiAgICAgIGNvbnN0IGNoYWluSWQgPSBhd2FpdCB0aGlzLmdldENoYWluSWQoKTsKICAgICAgcmV0dXJuIGNoYWluSWQudG9TdHJpbmcoKTsKICAgIH0KICB9OwogIGZ1bmN0aW9uIGFkZEVpcDY5NjNMaXN0ZW5lcihpbmZvLCBwcm92aWRlcikgewogICAgY29uc3QgYW5ub3VuY2VFdmVudCA9IG5ldyBDdXN0b21FdmVudCgKICAgICAgImVpcDY5NjM6YW5ub3VuY2VQcm92aWRlciIsCiAgICAgIHsKICAgICAgICBkZXRhaWw6IE9iamVjdC5mcmVlemUoeyBpbmZvLCBwcm92aWRlciB9KQogICAgICB9CiAgICApOwogICAgd2luZG93LmRpc3BhdGNoRXZlbnQoYW5ub3VuY2VFdmVudCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiZWlwNjk2MzpyZXF1ZXN0UHJvdmlkZXIiLCAoKSA9PiB7CiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGFubm91bmNlRXZlbnQpOwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGluaXRpYWxpemVWaWVtUHJvdmlkZXIoY2hhaW4sIHByb3ZpZGVySW5mbykgewogICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgVmllbVByb3ZpZGVyKGNoYWluLCBudWxsKTsKICAgIHdpbmRvdy5ldGhlcmV1bSA9IHsKICAgICAgcmVxdWVzdDogcHJvdmlkZXIucmVxdWVzdC5iaW5kKHByb3ZpZGVyKSwKICAgICAgZW5hYmxlOiBwcm92aWRlci5lbmFibGUuYmluZChwcm92aWRlciksCiAgICAgIG9uOiAoZXZlbnROYW1lLCBjYWxsYmFjaykgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGBFdmVudCBsaXN0ZW5lciBmb3IgJHtldmVudE5hbWV9IGFkZGVkLmApOwogICAgICB9LAogICAgICByZW1vdmVMaXN0ZW5lcjogKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhgRXZlbnQgbGlzdGVuZXIgZm9yICR7ZXZlbnROYW1lfSByZW1vdmVkLmApOwogICAgICB9LAogICAgICBpc0Nvbm5lY3RlZDogKCkgPT4gewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBzZW5kOiAobWV0aG9kLCBwYXJhbXMpID0+IHsKICAgICAgICBjb25zb2xlLndhcm4oInNlbmQgaXMgZGVwcmVjYXRlZC4gVXNlIHJlcXVlc3QgaW5zdGVhZC4iKTsKICAgICAgICByZXR1cm4gcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pOwogICAgICB9LAogICAgICBzZW5kQXN5bmM6IChwYXlsb2FkLCBjYWxsYmFjaykgPT4gewogICAgICAgIGNvbnNvbGUud2Fybigic2VuZEFzeW5jIGlzIGRlcHJlY2F0ZWQuIFVzZSByZXF1ZXN0IGluc3RlYWQuIik7CiAgICAgICAgcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZDogcGF5bG9hZC5tZXRob2QsIHBhcmFtczogcGF5bG9hZC5wYXJhbXMgfSkudGhlbigocmVzdWx0KSA9PiBjYWxsYmFjayhudWxsLCB7IHJlc3VsdCB9KSkuY2F0Y2goKGVycm9yKSA9PiBjYWxsYmFjayhlcnJvciwgbnVsbCkpOwogICAgICB9LAogICAgICBpc01ldGFNYXNrOiB0cnVlLAogICAgICAvLyBTZXQgdG8gdHJ1ZSBpZiBtaW1pY2tpbmcgTWV0YU1hc2sKICAgICAgc2VsZWN0ZWRBZGRyZXNzOiBwcm92aWRlci5zZWxlY3RlZEFkZHJlc3MsCiAgICAgIGNoYWluSWQ6IGNoYWluPy5pZCB8fCAiMHgxIgogICAgICAvLyBEZWZhdWx0IHRvIG1haW5uZXQgaWYgY2hhaW4gaXMgbm90IHByb3ZpZGVkCiAgICB9OwogICAgYWRkRWlwNjk2M0xpc3RlbmVyKHByb3ZpZGVySW5mbywgcHJvdmlkZXIpOwogICAgY29uc29sZS5sb2coIlZpZW0gcHJvdmlkZXIgaW5pdGlhbGl6ZWQiKTsKICB9CiAgdmFyIHZpZW1Qcm92aWRlckluZm8gPSB7CiAgICB1dWlkOiAiZDY5YmM0YzQtZTQzYS00ZDBhLTgzZDctYjZlN2I3NTA0YmViIiwKICAgIG5hbWU6ICJTaGlua2FpIFZpZW0gUHJvdmlkZXIiLAogICAgaWNvbjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU16WTNJaUJvWldsbmFIUTlJak0yTnlJZ2RtbGxkMEp2ZUQwaU1DQXdJRE0yTnlBek5qY2lJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4amFYSmpiR1VnWTNnOUlqRTRNeTQxSWlCamVUMGlNVGd6TGpVaUlISTlJakU0TXk0MUlpQm1hV3hzUFNJalJrVTJNVFl5SWk4K0NqeHdZWFJvSUdROUlrMHlOekl1TWprMUlESTNOQzQyTmpoRE1qY3dMamMxT0NBeU5qZ3VPVGMxSURJMk5pNDJNVGtnTWpZMkxqSXhOU0F5TmpBdU9EUTBJREkyTmk0M056bERNalE1TGpZMk5DQXlOamN1T0RZeklESTBOUzQ1TlRJZ01qWTBMakkzT1NBeU5EQXVOalEySURJMU5pNDBNRFJETWpVMExqWXlPQ0F5TlRrdU16WTNJREkyTXk0Mk5EWWdNalUxTGpjeU5TQXlOall1TkRZeklESTFOQzR4TURkRE1qY3dMakE1SURJMU1pNHdNVElnTWpjekxqYzJJREkwT1M0ek1qUWdNamN5TGpNd09TQXlORFF1TlRnMVF6STNNQzQ0T0RZZ01qTTVMamswTnlBeU5qWXVOakU1SURJek9TNHdNaklnTWpZeUxqSXpPQ0F5TXprdU9EWkRNalUyTGpBeU1pQXlOREV1TURRMUlESTFNQzR3TmpJZ01qUXhMamN6T0NBeU5EVXVNakkySURJek5TNDJPRFJETWpRMkxqSTFJREl6TkM0M05Ua2dNalEzTGpJM05DQXlNek11T0RBMklESTBPQzR6TWpjZ01qTXlMamc1TlVNeU5UQXVPVEF5SURJek1DNDJPRFVnTWpVeUxqZzVNeUF5TWpndU1EZzBJREkxTVM0MU9EUWdNakkwTGpVM00wTXlOVEF1TXpNeklESXlNUzR5TWlBeU5EY3VNVFl4SURJeE9TNHlPVGtnTWpRekxqa3pNaUF5TVRrdU9Ea3hRekkwTVM0eklESXlNQzR6T0RJZ01qTTJMakF5TXlBeU1qSXVNRE1nTWpNMExqUXhOaUF5TVRrdU16UXlUREl6TkM0ME9EY2dNakU1TGpNeE0wTXlNek11T0RjMUlESXhPUzR4TmprZ01qTXlMamt6TnlBeU1UWXVOalUwSURJek1pNDNNemNnTWpFMExqZ3hPVU15TXpFdU56azVJREl3TlM0NE5EWWdNak0xTGpZNE1pQXhPVGN1TWpNMUlESTBNQzQ1TVRZZ01Ua3dMakE0TWtNeU5EY3VORFExSURFNE1TNHhPVFlnTWpVeExqa3lOaUF4TnpFdU16azVJREkxTXk0NU1UY2dNVFl3TGpVek0wTXlOVGN1TURNeUlERTBNeTQwT0RNZ01qVXpMamN6TWlBeE1qY3VOakU0SURJME5DNDFNVFVnTVRFekxqQXpPVU15TXpNdU5UYzNJRGsxTGpjeU9ETWdNakU0TGpFMU9DQTROQzR6TWpjNElERTVOeTQ0TmlBNE1DNHhNemMxUXpFNU15NHdPVFVnTnprdU1UVTFJREU0T0M0ME5EUWdOemd1TmpNME9DQXhPRE11T1RNMUlEYzRMalUwT0RGRE1UYzVMalF4TVNBM09DNDJNelE0SURFM05DNDNOelFnTnprdU1UVTFJREUzTUM0d01Ea2dPREF1TVRNM05VTXhORGt1TnpJMklEZzBMak15TnpnZ01UTTBMakk1TXlBNU5TNDNNamd6SURFeU15NHpOVFFnTVRFekxqQXpPVU14TVRRdU1UVXhJREV5Tnk0Mk1UZ2dNVEV3TGpnMU1TQXhORE11TkRneklERXhNeTQ1TlRJZ01UWXdMalV6TTBNeE1UVXVPVEk1SURFM01TNDBNVFFnTVRJd0xqUXlOQ0F4T0RFdU1UazJJREV5Tmk0NU5UTWdNVGt3TGpBNE1rTXhNekl1TWpBeUlERTVOeTR5TXpVZ01UTTJMakE0TlNBeU1EVXVPRE15SURFek5TNHhNeklnTWpFMExqZ3hPVU14TXpRdU9UTXpJREl4Tmk0Mk5UUWdNVE16TGprNU5DQXlNVGt1TVRZNUlERXpNeTR6T0RJZ01qRTVMak14TTB3eE16TXVORFV6SURJeE9TNHpOREpETVRNeExqZzBOaUF5TWpJdU1ERTFJREV5Tmk0MU9ETWdNakl3TGpNNE1pQXhNak11T1RNNElESXhPUzQ0T1RGRE1USXdMamN5TXlBeU1Ua3VNams1SURFeE55NDFNemNnTWpJeExqSXlJREV4Tmk0eU9EVWdNakkwTGpVM00wTXhNVFF1T1RjMklESXlPQzR3T0RRZ01URTJMamsxTkNBeU16QXVOamcxSURFeE9TNDFORElnTWpNeUxqZzVOVU14TWpBdU5UazFJREl6TXk0NE1EWWdNVEl4TGpZeE9TQXlNelF1TnpVNUlERXlNaTQyTkRNZ01qTTFMalk0TkVNeE1UY3VPREEzSURJME1TNDNNemdnTVRFeExqZ3pNeUF5TkRFdU1EUTFJREV3TlM0Mk16RWdNak01TGpnMlF6RXdNUzR5TlNBeU16a3VNREl5SURrMkxqazRNamtnTWpNNUxqazBOeUE1TlM0MU5qQTFJREkwTkM0MU9EVkRPVFF1TVRBNU55QXlORGt1TXpJMElEazNMamMzT1RVZ01qVXlMakF4TWlBeE1ERXVOREEzSURJMU5DNHhNRGRETVRBMExqSXdPU0F5TlRVdU56STFJREV4TXk0eU5ERWdNalU1TGpNMU1pQXhNamN1TWpJeklESTFOaTQwTURSRE1USXhMamt4T0NBeU5qUXVNamM1SURFeE9DNHlNRFVnTWpZM0xqZzJNeUF4TURjdU1ESTFJREkyTmk0M056bERNVEF4TGpJMUlESTJOaTR5TVRVZ09UY3VNRGsyTnlBeU5qZ3VPVGMxSURrMUxqVTNORGNnTWpjMExqWTJPRU01TkM0d09ERXlJREk0TUM0eU16RWdPVGN1TURJMU5pQXlPRFF1TWpFNUlERXdNUzQyT1RFZ01qZzJMamczT0VNeE1EUXVOelE1SURJNE9DNDJNVElnTVRBNExqRTJNeUF5T0RrdU1qa3hJREV4TVM0M056WWdNamc1TGpNME9VTXhNekV1TlRZeUlESTRPUzQyTWpNZ01UUTNMamc1TVNBeU9ERXVORFU1SURFMk1pNDFPVGtnTWpZNUxqRTNPRU14TnpBdU5qa3lJREkyTWk0ME1UVWdNVGMzTGpNME9TQXlOVGd1T1RreElERTRNeTQ1TkRrZ01qVTRMamt3TkVNeE9UQXVOVFE1SURJMU9DNDVPVEVnTVRrM0xqRTVNU0F5TmpJdU5ERTFJREl3TlM0eU9Ua2dNalk1TGpFM09FTXlNakF1TURBM0lESTRNUzQwTlRrZ01qTTJMak16TmlBeU9Ea3VOakl6SURJMU5pNHhNaklnTWpnNUxqTTBPVU15TlRrdU56TTFJREk0T1M0ek1EVWdNall6TGpFME9DQXlPRGd1TmpFeUlESTJOaTR5TURjZ01qZzJMamczT0VNeU56QXVPRGcySURJNE5DNHlNVGtnTWpjekxqZ3hOeUF5T0RBdU1qTXhJREkzTWk0ek1qTWdNamMwTGpZMk9FZ3lOekl1TWprMVdrMHhOVFl1TmpJMElESXdOeTR5TmpKRE1UVXdMalV3T0NBeU1EY3VNalE0SURFME5TNDBOVGtnTWpBeUxqRXpNeUF4TkRVdU5EUTBJREU1TlM0NU5qTkRNVFExTGpRME5DQXhPRGt1TmpjNElERTFNQzQxTlRFZ01UZzBMalV6TkNBeE5UWXVPRFV5SURFNE5DNDBOelpETVRZeUxqZzBJREU0TkM0ME1UZ2dNVFk0TGpFM05DQXhPVEF1TURrM0lERTJPQzR4TVRjZ01UazJMalEyT1VNeE5qZ3VNRFl4SURJd01pNDNPRE1nTVRZekxqSTFNeUF5TURjdU1qa3hJREUxTmk0Mk1qUWdNakEzTGpJMk1scE5NakV4TGpJek1TQXlNRGN1TWpZeVF6SXdOQzQxT0RnZ01qQTNMakk1TVNBeE9Ua3VOemsxSURJd01pNDNOamtnTVRrNUxqY3pPQ0F4T1RZdU5EWTVRekU1T1M0Mk9ERWdNVGt3TGpBNU55QXlNRFV1TURJNUlERTROQzQwTVRnZ01qRXhMakF3TXlBeE9EUXVORGMyUXpJeE55NHpNRFFnTVRnMExqVTBPQ0F5TWpJdU5ERXhJREU0T1M0Mk9USWdNakl5TGpReE1TQXhPVFV1T1RZelF6SXlNaTQwTVRFZ01qQXlMakV6TXlBeU1UY3VNelEzSURJd055NHlORGdnTWpFeExqSXpNU0F5TURjdU1qWXlXaUlnWm1sc2JEMGlkMmhwZEdVaUx6NEtQQzl6ZG1jK0NnPT0iLAogICAgLy8gQmFzZTY0IGVuY29kZWQgaWNvbgogICAgcmRuczogImNvbS5zaGlua2FpLmRlc2t0b3AiCiAgfTsKICBpbml0aWFsaXplVmllbVByb3ZpZGVyKGFyYml0cnVtU2Vwb2xpYSwgdmllbVByb3ZpZGVySW5mbyk7Cn0pKCk7Ci8qISBCdW5kbGVkIGxpY2Vuc2UgaW5mb3JtYXRpb246CgpAbm9ibGUvaGFzaGVzL2VzbS91dGlscy5qczoKICAoKiEgbm9ibGUtaGFzaGVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qczoKICAoKiEgbm9ibGUtY3VydmVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC9tb2R1bGFyLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanM6CiAgKCohIG5vYmxlLWN1cnZlcyAtIE1JVCBMaWNlbnNlIChjKSAyMDIyIFBhdWwgTWlsbGVyIChwYXVsbWlsbHIuY29tKSAqKQoKQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKKi8K');
('KCgpID0+IHsKICB2YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogIHZhciBfX2dldE93blByb3BOYW1lcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzOwogIHZhciBfX2VzbSA9IChmbiwgcmVzKSA9PiBmdW5jdGlvbiBfX2luaXQoKSB7CiAgICByZXR1cm4gZm4gJiYgKHJlcyA9ICgwLCBmbltfX2dldE93blByb3BOYW1lcyhmbilbMF1dKShmbiA9IDApKSwgcmVzOwogIH07CiAgdmFyIF9fZXhwb3J0ID0gKHRhcmdldCwgYWxsKSA9PiB7CiAgICBmb3IgKHZhciBuYW1lIGluIGFsbCkKICAgICAgX19kZWZQcm9wKHRhcmdldCwgbmFtZSwgeyBnZXQ6IGFsbFtuYW1lXSwgZW51bWVyYWJsZTogdHJ1ZSB9KTsKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzCiAgdmFyIHZlcnNpb247CiAgdmFyIGluaXRfdmVyc2lvbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbiA9ICIxLjAuNiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcwogIHZhciBCYXNlRXJyb3I7CiAgdmFyIGluaXRfZXJyb3JzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2Vycm9ycy5qcyIoKSB7CiAgICAgIGluaXRfdmVyc2lvbigpOwogICAgICBCYXNlRXJyb3IgPSBjbGFzcyBfQmFzZUVycm9yIGV4dGVuZHMgRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHNob3J0TWVzc2FnZSwgYXJncyA9IHt9KSB7CiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRldGFpbHMgOiBhcmdzLmNhdXNlPy5tZXNzYWdlID8gYXJncy5jYXVzZS5tZXNzYWdlIDogYXJncy5kZXRhaWxzOwogICAgICAgICAgY29uc3QgZG9jc1BhdGg5ID0gYXJncy5jYXVzZSBpbnN0YW5jZW9mIF9CYXNlRXJyb3IgPyBhcmdzLmNhdXNlLmRvY3NQYXRoIHx8IGFyZ3MuZG9jc1BhdGggOiBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgY29uc3QgbWVzc2FnZSA9IFsKICAgICAgICAgICAgc2hvcnRNZXNzYWdlIHx8ICJBbiBlcnJvciBvY2N1cnJlZC4iLAogICAgICAgICAgICAiIiwKICAgICAgICAgICAgLi4uYXJncy5tZXRhTWVzc2FnZXMgPyBbLi4uYXJncy5tZXRhTWVzc2FnZXMsICIiXSA6IFtdLAogICAgICAgICAgICAuLi5kb2NzUGF0aDkgPyBbYERvY3M6IGh0dHBzOi8vYWJpdHlwZS5kZXYke2RvY3NQYXRoOX1gXSA6IFtdLAogICAgICAgICAgICAuLi5kZXRhaWxzID8gW2BEZXRhaWxzOiAke2RldGFpbHN9YF0gOiBbXSwKICAgICAgICAgICAgYFZlcnNpb246IGFiaXR5cGVAJHt2ZXJzaW9ufWAKICAgICAgICAgIF0uam9pbigiXG4iKTsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkZXRhaWxzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZG9jc1BhdGgiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtZXRhTWVzc2FnZXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaG9ydE1lc3NhZ2UiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkFiaVR5cGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKGFyZ3MuY2F1c2UpCiAgICAgICAgICAgIHRoaXMuY2F1c2UgPSBhcmdzLmNhdXNlOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5zaG9ydE1lc3NhZ2UgPSBzaG9ydE1lc3NhZ2U7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9yZWdleC5qcwogIGZ1bmN0aW9uIGV4ZWNUeXBlZChyZWdleCwgc3RyaW5nKSB7CiAgICBjb25zdCBtYXRjaCA9IHJlZ2V4LmV4ZWMoc3RyaW5nKTsKICAgIHJldHVybiBtYXRjaD8uZ3JvdXBzOwogIH0KICB2YXIgYnl0ZXNSZWdleCwgaW50ZWdlclJlZ2V4LCBpc1R1cGxlUmVnZXg7CiAgdmFyIGluaXRfcmVnZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vcmVnZXguanMiKCkgewogICAgICBieXRlc1JlZ2V4ID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgICAgIGludGVnZXJSZWdleCA9IC9edT9pbnQoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKICAgICAgaXNUdXBsZVJlZ2V4ID0gL15cKC4rP1wpLio/JC87CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaVBhcmFtZXRlci5qcwogIGZ1bmN0aW9uIGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpIHsKICAgIGxldCB0eXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBpZiAodHVwbGVSZWdleC50ZXN0KGFiaVBhcmFtZXRlci50eXBlKSAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKSB7CiAgICAgIHR5cGUgPSAiKCI7CiAgICAgIGNvbnN0IGxlbmd0aCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGFiaVBhcmFtZXRlci5jb21wb25lbnRzW2ldOwogICAgICAgIHR5cGUgKz0gZm9ybWF0QWJpUGFyYW1ldGVyKGNvbXBvbmVudCk7CiAgICAgICAgaWYgKGkgPCBsZW5ndGggLSAxKQogICAgICAgICAgdHlwZSArPSAiLCAiOwogICAgICB9CiAgICAgIGNvbnN0IHJlc3VsdCA9IGV4ZWNUeXBlZCh0dXBsZVJlZ2V4LCBhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIHR5cGUgKz0gYCkke3Jlc3VsdD8uYXJyYXkgPz8gIiJ9YDsKICAgICAgcmV0dXJuIGZvcm1hdEFiaVBhcmFtZXRlcih7CiAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICB9CiAgICBpZiAoImluZGV4ZWQiIGluIGFiaVBhcmFtZXRlciAmJiBhYmlQYXJhbWV0ZXIuaW5kZXhlZCkKICAgICAgdHlwZSA9IGAke3R5cGV9IGluZGV4ZWRgOwogICAgaWYgKGFiaVBhcmFtZXRlci5uYW1lKQogICAgICByZXR1cm4gYCR7dHlwZX0gJHthYmlQYXJhbWV0ZXIubmFtZX1gOwogICAgcmV0dXJuIHR5cGU7CiAgfQogIHZhciB0dXBsZVJlZ2V4OwogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIHR1cGxlUmVnZXggPSAvXnR1cGxlKD88YXJyYXk+KFxbKFxkKilcXSkqKSQvOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9mb3JtYXRBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpUGFyYW1ldGVycyhhYmlQYXJhbWV0ZXJzKSB7CiAgICBsZXQgcGFyYW1zID0gIiI7CiAgICBjb25zdCBsZW5ndGggPSBhYmlQYXJhbWV0ZXJzLmxlbmd0aDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gYWJpUGFyYW1ldGVyc1tpXTsKICAgICAgcGFyYW1zICs9IGZvcm1hdEFiaVBhcmFtZXRlcihhYmlQYXJhbWV0ZXIpOwogICAgICBpZiAoaSAhPT0gbGVuZ3RoIC0gMSkKICAgICAgICBwYXJhbXMgKz0gIiwgIjsKICAgIH0KICAgIHJldHVybiBwYXJhbXM7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpUGFyYW1ldGVycy5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVyKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Zvcm1hdEFiaUl0ZW0uanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtKGFiaUl0ZW0pIHsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiBgZnVuY3Rpb24gJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cyl9KSR7YWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgJiYgYWJpSXRlbS5zdGF0ZU11dGFiaWxpdHkgIT09ICJub25wYXlhYmxlIiA/IGAgJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eX1gIDogIiJ9JHthYmlJdGVtLm91dHB1dHMubGVuZ3RoID8gYCByZXR1cm5zICgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5vdXRwdXRzKX0pYCA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICByZXR1cm4gYGV2ZW50ICR7YWJpSXRlbS5uYW1lfSgke2Zvcm1hdEFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMpfSlgOwogICAgaWYgKGFiaUl0ZW0udHlwZSA9PT0gImVycm9yIikKICAgICAgcmV0dXJuIGBlcnJvciAke2FiaUl0ZW0ubmFtZX0oJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pYDsKICAgIGlmIChhYmlJdGVtLnR5cGUgPT09ICJjb25zdHJ1Y3RvciIpCiAgICAgIHJldHVybiBgY29uc3RydWN0b3IoJHtmb3JtYXRBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzKX0pJHthYmlJdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInBheWFibGUiID8gIiBwYXlhYmxlIiA6ICIifWA7CiAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZmFsbGJhY2siKQogICAgICByZXR1cm4gImZhbGxiYWNrKCkiOwogICAgcmV0dXJuICJyZWNlaXZlKCkgZXh0ZXJuYWwgcGF5YWJsZSI7CiAgfQogIHZhciBpbml0X2Zvcm1hdEFiaUl0ZW0gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZm9ybWF0QWJpSXRlbS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0QWJpUGFyYW1ldGVycygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMKICBmdW5jdGlvbiBpc0Vycm9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGVycm9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGVycm9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXZlbnRTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBleGVjVHlwZWQoZXZlbnRTaWduYXR1cmVSZWdleCwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LnRlc3Qoc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGV4ZWNUeXBlZChmdW5jdGlvblNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiBzdHJ1Y3RTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGV4ZWNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKHN0cnVjdFNpZ25hdHVyZVJlZ2V4LCBzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICBmdW5jdGlvbiBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZXhlY1R5cGVkKGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzRmFsbGJhY2tTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICByZXR1cm4gZmFsbGJhY2tTaWduYXR1cmVSZWdleC50ZXN0KHNpZ25hdHVyZSk7CiAgfQogIGZ1bmN0aW9uIGlzUmVjZWl2ZVNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIHJldHVybiByZWNlaXZlU2lnbmF0dXJlUmVnZXgudGVzdChzaWduYXR1cmUpOwogIH0KICB2YXIgZXJyb3JTaWduYXR1cmVSZWdleCwgZXZlbnRTaWduYXR1cmVSZWdleCwgZnVuY3Rpb25TaWduYXR1cmVSZWdleCwgc3RydWN0U2lnbmF0dXJlUmVnZXgsIGNvbnN0cnVjdG9yU2lnbmF0dXJlUmVnZXgsIGZhbGxiYWNrU2lnbmF0dXJlUmVnZXgsIHJlY2VpdmVTaWduYXR1cmVSZWdleCwgbW9kaWZpZXJzLCBldmVudE1vZGlmaWVycywgZnVuY3Rpb25Nb2RpZmllcnM7CiAgdmFyIGluaXRfc2lnbmF0dXJlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3NpZ25hdHVyZXMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGVycm9yU2lnbmF0dXJlUmVnZXggPSAvXmVycm9yICg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKVwoKD88cGFyYW1ldGVycz4uKj8pXCkkLzsKICAgICAgZXZlbnRTaWduYXR1cmVSZWdleCA9IC9eZXZlbnQgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopXCgoPzxwYXJhbWV0ZXJzPi4qPylcKSQvOwogICAgICBmdW5jdGlvblNpZ25hdHVyZVJlZ2V4ID0gL15mdW5jdGlvbiAoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKilcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86ICg/PHNjb3BlPmV4dGVybmFsfHB1YmxpY3sxfSkpPyg/OiAoPzxzdGF0ZU11dGFiaWxpdHk+cHVyZXx2aWV3fG5vbnBheWFibGV8cGF5YWJsZXsxfSkpPyg/OiByZXR1cm5zXHM/XCgoPzxyZXR1cm5zPi4qPylcKSk/JC87CiAgICAgIHN0cnVjdFNpZ25hdHVyZVJlZ2V4ID0gL15zdHJ1Y3QgKD88bmFtZT5bYS16QS1aJF9dW2EtekEtWjAtOSRfXSopIFx7KD88cHJvcGVydGllcz4uKj8pXH0kLzsKICAgICAgY29uc3RydWN0b3JTaWduYXR1cmVSZWdleCA9IC9eY29uc3RydWN0b3JcKCg/PHBhcmFtZXRlcnM+Lio/KVwpKD86XHMoPzxzdGF0ZU11dGFiaWxpdHk+cGF5YWJsZXsxfSkpPyQvOwogICAgICBmYWxsYmFja1NpZ25hdHVyZVJlZ2V4ID0gL15mYWxsYmFja1woXCkgZXh0ZXJuYWwoPzpccyg/PHN0YXRlTXV0YWJpbGl0eT5wYXlhYmxlezF9KSk/JC87CiAgICAgIHJlY2VpdmVTaWduYXR1cmVSZWdleCA9IC9ecmVjZWl2ZVwoXCkgZXh0ZXJuYWwgcGF5YWJsZSQvOwogICAgICBtb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgIm1lbW9yeSIsCiAgICAgICAgImluZGV4ZWQiLAogICAgICAgICJzdG9yYWdlIiwKICAgICAgICAiY2FsbGRhdGEiCiAgICAgIF0pOwogICAgICBldmVudE1vZGlmaWVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KFsiaW5kZXhlZCJdKTsKICAgICAgZnVuY3Rpb25Nb2RpZmllcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbCiAgICAgICAgImNhbGxkYXRhIiwKICAgICAgICAibWVtb3J5IiwKICAgICAgICAic3RvcmFnZSIKICAgICAgXSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzCiAgdmFyIEludmFsaWRBYmlJdGVtRXJyb3IsIFVua25vd25UeXBlRXJyb3IsIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcjsKICB2YXIgaW5pdF9hYmlJdGVtID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlJdGVtLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZEFiaUl0ZW1FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNpZ25hdHVyZSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBpdGVtLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogYHBhcnNlQWJpSXRlbSgke0pTT04uc3RyaW5naWZ5KHNpZ25hdHVyZSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaWl0ZW0tMSIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRBYmlJdGVtRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25UeXBlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0eXBlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHR5cGUuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgVHlwZSAiJHt0eXBlfSIgaXMgbm90IGEgdmFsaWQgQUJJIHR5cGUuIFBlcmhhcHMgeW91IGZvcmdvdCB0byBpbmNsdWRlIGEgc3RydWN0IHNpZ25hdHVyZT9gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIlVua25vd25UeXBlRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVua25vd25Tb2xpZGl0eVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIlVua25vd24gdHlwZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BUeXBlICIke3R5cGV9IiBpcyBub3QgYSB2YWxpZCBBQkkgdHlwZS5gXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNvbGlkaXR5VHlwZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvYWJpUGFyYW1ldGVyLmpzCiAgdmFyIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvciwgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwgSW52YWxpZFBhcmFtZXRlckVycm9yLCBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvciwgSW52YWxpZE1vZGlmaWVyRXJyb3IsIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I7CiAgdmFyIGluaXRfYWJpUGFyYW1ldGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9hYmlQYXJhbWV0ZXIuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcigiRmFpbGVkIHRvIHBhcnNlIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXIoJHtKU09OLnN0cmluZ2lmeShwYXJhbSwgbnVsbCwgMil9KWAsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2FwaS9odW1hbiNwYXJzZWFiaXBhcmFtZXRlci0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW1zIH0pIHsKICAgICAgICAgIHN1cGVyKCJGYWlsZWQgdG8gcGFyc2UgQUJJIHBhcmFtZXRlcnMuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBgcGFyc2VBYmlQYXJhbWV0ZXJzKCR7SlNPTi5zdHJpbmdpZnkocGFyYW1zLCBudWxsLCAyKX0pYCwKICAgICAgICAgICAgZG9jc1BhdGg6ICIvYXBpL2h1bWFuI3BhcnNlYWJpcGFyYW1ldGVycy0xIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFBhcmFtZXRlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0gfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkUGFyYW1ldGVyRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIG5hbWUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgQUJJIHBhcmFtZXRlci4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHBhcmFtLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgIiR7bmFtZX0iIGlzIGEgcHJvdGVjdGVkIFNvbGlkaXR5IGtleXdvcmQuIE1vcmUgaW5mbzogaHR0cHM6Ly9kb2NzLnNvbGlkaXR5bGFuZy5vcmcvZW4vbGF0ZXN0L2NoZWF0c2hlZXQuaHRtbGAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRNb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gCiAgICAgICAgICAgIF0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRNb2RpZmllckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgcGFyYW0sIHR5cGUsIG1vZGlmaWVyIH0pIHsKICAgICAgICAgIHN1cGVyKCJJbnZhbGlkIEFCSSBwYXJhbWV0ZXIuIiwgewogICAgICAgICAgICBkZXRhaWxzOiBwYXJhbSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYE1vZGlmaWVyICIke21vZGlmaWVyfSIgbm90IGFsbG93ZWQke3R5cGUgPyBgIGluICIke3R5cGV9IiB0eXBlYCA6ICIifS5gLAogICAgICAgICAgICAgIGBEYXRhIGxvY2F0aW9uIGNhbiBvbmx5IGJlIHNwZWNpZmllZCBmb3IgYXJyYXksIHN0cnVjdCwgb3IgbWFwcGluZyB0eXBlcywgYnV0ICIke21vZGlmaWVyfSIgd2FzIGdpdmVuLmAKICAgICAgICAgICAgXQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiSW52YWxpZEZ1bmN0aW9uTW9kaWZpZXJFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEFiaVR5cGVQYXJhbWV0ZXJFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGFiaVBhcmFtZXRlciB9KSB7CiAgICAgICAgICBzdXBlcigiSW52YWxpZCBBQkkgcGFyYW1ldGVyLiIsIHsKICAgICAgICAgICAgZGV0YWlsczogSlNPTi5zdHJpbmdpZnkoYWJpUGFyYW1ldGVyLCBudWxsLCAyKSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkFCSSBwYXJhbWV0ZXIgdHlwZSBpcyBpbnZhbGlkLiJdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJJbnZhbGlkQWJpVHlwZVBhcmFtZXRlckVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc2lnbmF0dXJlLmpzCiAgdmFyIEludmFsaWRTaWduYXR1cmVFcnJvciwgVW5rbm93blNpZ25hdHVyZUVycm9yLCBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I7CiAgdmFyIGluaXRfc2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL2Vycm9ycy9zaWduYXR1cmUuanMiKCkgewogICAgICBpbml0X2Vycm9ycygpOwogICAgICBJbnZhbGlkU2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgJHt0eXBlfSBzaWduYXR1cmUuYCwgewogICAgICAgICAgICBkZXRhaWxzOiBzaWduYXR1cmUKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgVW5rbm93blNpZ25hdHVyZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2lnbmF0dXJlIH0pIHsKICAgICAgICAgIHN1cGVyKCJVbmtub3duIHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiVW5rbm93blNpZ25hdHVyZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzaWduYXR1cmUgfSkgewogICAgICAgICAgc3VwZXIoIkludmFsaWQgc3RydWN0IHNpZ25hdHVyZS4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6IHNpZ25hdHVyZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIk5vIHByb3BlcnRpZXMgZXhpc3QuIl0KICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvZXJyb3JzL3N0cnVjdC5qcwogIHZhciBDaXJjdWxhclJlZmVyZW5jZUVycm9yOwogIHZhciBpbml0X3N0cnVjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3RydWN0LmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgQ2lyY3VsYXJSZWZlcmVuY2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoIkNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3RlZC4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BTdHJ1Y3QgIiR7dHlwZX0iIGlzIGEgY2lyY3VsYXIgcmVmZXJlbmNlLmBdCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAibmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6ICJDaXJjdWxhclJlZmVyZW5jZUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzCiAgdmFyIEludmFsaWRQYXJlbnRoZXNpc0Vycm9yOwogIHZhciBpbml0X3NwbGl0UGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9lcnJvcnMvc3BsaXRQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9lcnJvcnMoKTsKICAgICAgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjdXJyZW50LCBkZXB0aCB9KSB7CiAgICAgICAgICBzdXBlcigiVW5iYWxhbmNlZCBwYXJlbnRoZXNlcy4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGAiJHtjdXJyZW50LnRyaW0oKX0iIGhhcyB0b28gbWFueSAke2RlcHRoID4gMCA/ICJvcGVuaW5nIiA6ICJjbG9zaW5nIn0gcGFyZW50aGVzZXMuYAogICAgICAgICAgICBdLAogICAgICAgICAgICBkZXRhaWxzOiBgRGVwdGggIiR7ZGVwdGh9ImAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkludmFsaWRQYXJlbnRoZXNpc0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL2NhY2hlLmpzCiAgZnVuY3Rpb24gZ2V0UGFyYW1ldGVyQ2FjaGVLZXkocGFyYW0sIHR5cGUpIHsKICAgIGlmICh0eXBlKQogICAgICByZXR1cm4gYCR7dHlwZX06JHtwYXJhbX1gOwogICAgcmV0dXJuIHBhcmFtOwogIH0KICB2YXIgcGFyYW1ldGVyQ2FjaGU7CiAgdmFyIGluaXRfY2FjaGUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9jYWNoZS5qcyIoKSB7CiAgICAgIHBhcmFtZXRlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoWwogICAgICAgIC8vIFVubmFtZWQKICAgICAgICBbImFkZHJlc3MiLCB7IHR5cGU6ICJhZGRyZXNzIiB9XSwKICAgICAgICBbImJvb2wiLCB7IHR5cGU6ICJib29sIiB9XSwKICAgICAgICBbImJ5dGVzIiwgeyB0eXBlOiAiYnl0ZXMiIH1dLAogICAgICAgIFsiYnl0ZXMzMiIsIHsgdHlwZTogImJ5dGVzMzIiIH1dLAogICAgICAgIFsiaW50IiwgeyB0eXBlOiAiaW50MjU2IiB9XSwKICAgICAgICBbImludDI1NiIsIHsgdHlwZTogImludDI1NiIgfV0sCiAgICAgICAgWyJzdHJpbmciLCB7IHR5cGU6ICJzdHJpbmciIH1dLAogICAgICAgIFsidWludCIsIHsgdHlwZTogInVpbnQyNTYiIH1dLAogICAgICAgIFsidWludDgiLCB7IHR5cGU6ICJ1aW50OCIgfV0sCiAgICAgICAgWyJ1aW50MTYiLCB7IHR5cGU6ICJ1aW50MTYiIH1dLAogICAgICAgIFsidWludDI0IiwgeyB0eXBlOiAidWludDI0IiB9XSwKICAgICAgICBbInVpbnQzMiIsIHsgdHlwZTogInVpbnQzMiIgfV0sCiAgICAgICAgWyJ1aW50NjQiLCB7IHR5cGU6ICJ1aW50NjQiIH1dLAogICAgICAgIFsidWludDk2IiwgeyB0eXBlOiAidWludDk2IiB9XSwKICAgICAgICBbInVpbnQxMTIiLCB7IHR5cGU6ICJ1aW50MTEyIiB9XSwKICAgICAgICBbInVpbnQxNjAiLCB7IHR5cGU6ICJ1aW50MTYwIiB9XSwKICAgICAgICBbInVpbnQxOTIiLCB7IHR5cGU6ICJ1aW50MTkyIiB9XSwKICAgICAgICBbInVpbnQyNTYiLCB7IHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAvLyBOYW1lZAogICAgICAgIFsiYWRkcmVzcyBvd25lciIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAib3duZXIiIH1dLAogICAgICAgIFsiYWRkcmVzcyB0byIsIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAidG8iIH1dLAogICAgICAgIFsiYm9vbCBhcHByb3ZlZCIsIHsgdHlwZTogImJvb2wiLCBuYW1lOiAiYXBwcm92ZWQiIH1dLAogICAgICAgIFsiYnl0ZXMgX2RhdGEiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJfZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBkYXRhIiwgeyB0eXBlOiAiYnl0ZXMiLCBuYW1lOiAiZGF0YSIgfV0sCiAgICAgICAgWyJieXRlcyBzaWduYXR1cmUiLCB7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJzaWduYXR1cmUiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBoYXNoIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJoYXNoIiB9XSwKICAgICAgICBbImJ5dGVzMzIgciIsIHsgdHlwZTogImJ5dGVzMzIiLCBuYW1lOiAiciIgfV0sCiAgICAgICAgWyJieXRlczMyIHJvb3QiLCB7IHR5cGU6ICJieXRlczMyIiwgbmFtZTogInJvb3QiIH1dLAogICAgICAgIFsiYnl0ZXMzMiBzIiwgeyB0eXBlOiAiYnl0ZXMzMiIsIG5hbWU6ICJzIiB9XSwKICAgICAgICBbInN0cmluZyBuYW1lIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogIm5hbWUiIH1dLAogICAgICAgIFsic3RyaW5nIHN5bWJvbCIsIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJzeW1ib2wiIH1dLAogICAgICAgIFsic3RyaW5nIHRva2VuVVJJIiwgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInRva2VuVVJJIiB9XSwKICAgICAgICBbInVpbnQgdG9rZW5JZCIsIHsgdHlwZTogInVpbnQyNTYiLCBuYW1lOiAidG9rZW5JZCIgfV0sCiAgICAgICAgWyJ1aW50OCB2IiwgeyB0eXBlOiAidWludDgiLCBuYW1lOiAidiIgfV0sCiAgICAgICAgWyJ1aW50MjU2IGJhbGFuY2UiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogImJhbGFuY2UiIH1dLAogICAgICAgIFsidWludDI1NiB0b2tlbklkIiwgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiB9XSwKICAgICAgICBbInVpbnQyNTYgdmFsdWUiLCB7IHR5cGU6ICJ1aW50MjU2IiwgbmFtZTogInZhbHVlIiB9XSwKICAgICAgICAvLyBJbmRleGVkCiAgICAgICAgWwogICAgICAgICAgImV2ZW50OmFkZHJlc3MgaW5kZXhlZCBmcm9tIiwKICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAiZnJvbSIsIGluZGV4ZWQ6IHRydWUgfQogICAgICAgIF0sCiAgICAgICAgWyJldmVudDphZGRyZXNzIGluZGV4ZWQgdG8iLCB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInRvIiwgaW5kZXhlZDogdHJ1ZSB9XSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludCBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXSwKICAgICAgICBbCiAgICAgICAgICAiZXZlbnQ6dWludDI1NiBpbmRleGVkIHRva2VuSWQiLAogICAgICAgICAgeyB0eXBlOiAidWludDI1NiIsIG5hbWU6ICJ0b2tlbklkIiwgaW5kZXhlZDogdHJ1ZSB9CiAgICAgICAgXQogICAgICBdKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcwogIGZ1bmN0aW9uIHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZSwgc3RydWN0cyA9IHt9KSB7CiAgICBpZiAoaXNGdW5jdGlvblNpZ25hdHVyZShzaWduYXR1cmUpKSB7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY0Z1bmN0aW9uU2lnbmF0dXJlKHNpZ25hdHVyZSk7CiAgICAgIGlmICghbWF0Y2gpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSwgdHlwZTogImZ1bmN0aW9uIiB9KTsKICAgICAgY29uc3QgaW5wdXRQYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGlucHV0cyA9IFtdOwogICAgICBjb25zdCBpbnB1dExlbmd0aCA9IGlucHV0UGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSsrKSB7CiAgICAgICAgaW5wdXRzLnB1c2gocGFyc2VBYmlQYXJhbWV0ZXIoaW5wdXRQYXJhbXNbaV0sIHsKICAgICAgICAgIG1vZGlmaWVyczogZnVuY3Rpb25Nb2RpZmllcnMsCiAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0pKTsKICAgICAgfQogICAgICBjb25zdCBvdXRwdXRzID0gW107CiAgICAgIGlmIChtYXRjaC5yZXR1cm5zKSB7CiAgICAgICAgY29uc3Qgb3V0cHV0UGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnJldHVybnMpOwogICAgICAgIGNvbnN0IG91dHB1dExlbmd0aCA9IG91dHB1dFBhcmFtcy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRwdXRMZW5ndGg7IGkrKykgewogICAgICAgICAgb3V0cHV0cy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKG91dHB1dFBhcmFtc1tpXSwgewogICAgICAgICAgICBtb2RpZmllcnM6IGZ1bmN0aW9uTW9kaWZpZXJzLAogICAgICAgICAgICBzdHJ1Y3RzLAogICAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogbWF0Y2gubmFtZSwKICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHMsCiAgICAgICAgb3V0cHV0cwogICAgICB9OwogICAgfQogICAgaWYgKGlzRXZlbnRTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFdmVudFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJldmVudCIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgewogICAgICAgICAgbW9kaWZpZXJzOiBldmVudE1vZGlmaWVycywKICAgICAgICAgIHN0cnVjdHMsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiB7IG5hbWU6IG1hdGNoLm5hbWUsIHR5cGU6ICJldmVudCIsIGlucHV0czogYWJpUGFyYW1ldGVycyB9OwogICAgfQogICAgaWYgKGlzRXJyb3JTaWduYXR1cmUoc2lnbmF0dXJlKSkgewogICAgICBjb25zdCBtYXRjaCA9IGV4ZWNFcnJvclNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJlcnJvciIgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHNwbGl0UGFyYW1ldGVycyhtYXRjaC5wYXJhbWV0ZXJzKTsKICAgICAgY29uc3QgYWJpUGFyYW1ldGVycyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWJpUGFyYW1ldGVycy5wdXNoKHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtc1tpXSwgeyBzdHJ1Y3RzLCB0eXBlOiAiZXJyb3IiIH0pKTsKICAgICAgfQogICAgICByZXR1cm4geyBuYW1lOiBtYXRjaC5uYW1lLCB0eXBlOiAiZXJyb3IiLCBpbnB1dHM6IGFiaVBhcmFtZXRlcnMgfTsKICAgIH0KICAgIGlmIChpc0NvbnN0cnVjdG9yU2lnbmF0dXJlKHNpZ25hdHVyZSkpIHsKICAgICAgY29uc3QgbWF0Y2ggPSBleGVjQ29uc3RydWN0b3JTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgaWYgKCFtYXRjaCkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFNpZ25hdHVyZUVycm9yKHsgc2lnbmF0dXJlLCB0eXBlOiAiY29uc3RydWN0b3IiIH0pOwogICAgICBjb25zdCBwYXJhbXMgPSBzcGxpdFBhcmFtZXRlcnMobWF0Y2gucGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlcnMgPSBbXTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cywgdHlwZTogImNvbnN0cnVjdG9yIiB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiLAogICAgICAgIHN0YXRlTXV0YWJpbGl0eTogbWF0Y2guc3RhdGVNdXRhYmlsaXR5ID8/ICJub25wYXlhYmxlIiwKICAgICAgICBpbnB1dHM6IGFiaVBhcmFtZXRlcnMKICAgICAgfTsKICAgIH0KICAgIGlmIChpc0ZhbGxiYWNrU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHR5cGU6ICJmYWxsYmFjayIgfTsKICAgIGlmIChpc1JlY2VpdmVTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAicmVjZWl2ZSIsCiAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIKICAgICAgfTsKICAgIHRocm93IG5ldyBVbmtub3duU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUgfSk7CiAgfQogIGZ1bmN0aW9uIHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCBvcHRpb25zKSB7CiAgICBjb25zdCBwYXJhbWV0ZXJDYWNoZUtleSA9IGdldFBhcmFtZXRlckNhY2hlS2V5KHBhcmFtLCBvcHRpb25zPy50eXBlKTsKICAgIGlmIChwYXJhbWV0ZXJDYWNoZS5oYXMocGFyYW1ldGVyQ2FjaGVLZXkpKQogICAgICByZXR1cm4gcGFyYW1ldGVyQ2FjaGUuZ2V0KHBhcmFtZXRlckNhY2hlS2V5KTsKICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChwYXJhbSk7CiAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZChpc1R1cGxlID8gYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXggOiBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgcGFyYW0pOwogICAgaWYgKCFtYXRjaCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbWV0ZXJFcnJvcih7IHBhcmFtIH0pOwogICAgaWYgKG1hdGNoLm5hbWUgJiYgaXNTb2xpZGl0eUtleXdvcmQobWF0Y2gubmFtZSkpCiAgICAgIHRocm93IG5ldyBTb2xpZGl0eVByb3RlY3RlZEtleXdvcmRFcnJvcih7IHBhcmFtLCBuYW1lOiBtYXRjaC5uYW1lIH0pOwogICAgY29uc3QgbmFtZSA9IG1hdGNoLm5hbWUgPyB7IG5hbWU6IG1hdGNoLm5hbWUgfSA6IHt9OwogICAgY29uc3QgaW5kZXhlZCA9IG1hdGNoLm1vZGlmaWVyID09PSAiaW5kZXhlZCIgPyB7IGluZGV4ZWQ6IHRydWUgfSA6IHt9OwogICAgY29uc3Qgc3RydWN0cyA9IG9wdGlvbnM/LnN0cnVjdHMgPz8ge307CiAgICBsZXQgdHlwZTsKICAgIGxldCBjb21wb25lbnRzID0ge307CiAgICBpZiAoaXNUdXBsZSkgewogICAgICB0eXBlID0gInR1cGxlIjsKICAgICAgY29uc3QgcGFyYW1zID0gc3BsaXRQYXJhbWV0ZXJzKG1hdGNoLnR5cGUpOwogICAgICBjb25zdCBjb21wb25lbnRzXyA9IFtdOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbXMubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50c18ucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbXNbaV0sIHsgc3RydWN0cyB9KSk7CiAgICAgIH0KICAgICAgY29tcG9uZW50cyA9IHsgY29tcG9uZW50czogY29tcG9uZW50c18gfTsKICAgIH0gZWxzZSBpZiAobWF0Y2gudHlwZSBpbiBzdHJ1Y3RzKSB7CiAgICAgIHR5cGUgPSAidHVwbGUiOwogICAgICBjb21wb25lbnRzID0geyBjb21wb25lbnRzOiBzdHJ1Y3RzW21hdGNoLnR5cGVdIH07CiAgICB9IGVsc2UgaWYgKGR5bmFtaWNJbnRlZ2VyUmVnZXgudGVzdChtYXRjaC50eXBlKSkgewogICAgICB0eXBlID0gYCR7bWF0Y2gudHlwZX0yNTZgOwogICAgfSBlbHNlIHsKICAgICAgdHlwZSA9IG1hdGNoLnR5cGU7CiAgICAgIGlmICghKG9wdGlvbnM/LnR5cGUgPT09ICJzdHJ1Y3QiKSAmJiAhaXNTb2xpZGl0eVR5cGUodHlwZSkpCiAgICAgICAgdGhyb3cgbmV3IFVua25vd25Tb2xpZGl0eVR5cGVFcnJvcih7IHR5cGUgfSk7CiAgICB9CiAgICBpZiAobWF0Y2gubW9kaWZpZXIpIHsKICAgICAgaWYgKCFvcHRpb25zPy5tb2RpZmllcnM/Lmhhcz8uKG1hdGNoLm1vZGlmaWVyKSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE1vZGlmaWVyRXJyb3IoewogICAgICAgICAgcGFyYW0sCiAgICAgICAgICB0eXBlOiBvcHRpb25zPy50eXBlLAogICAgICAgICAgbW9kaWZpZXI6IG1hdGNoLm1vZGlmaWVyCiAgICAgICAgfSk7CiAgICAgIGlmIChmdW5jdGlvbk1vZGlmaWVycy5oYXMobWF0Y2gubW9kaWZpZXIpICYmICFpc1ZhbGlkRGF0YUxvY2F0aW9uKHR5cGUsICEhbWF0Y2guYXJyYXkpKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkRnVuY3Rpb25Nb2RpZmllckVycm9yKHsKICAgICAgICAgIHBhcmFtLAogICAgICAgICAgdHlwZTogb3B0aW9ucz8udHlwZSwKICAgICAgICAgIG1vZGlmaWVyOiBtYXRjaC5tb2RpZmllcgogICAgICAgIH0pOwogICAgfQogICAgY29uc3QgYWJpUGFyYW1ldGVyID0gewogICAgICB0eXBlOiBgJHt0eXBlfSR7bWF0Y2guYXJyYXkgPz8gIiJ9YCwKICAgICAgLi4ubmFtZSwKICAgICAgLi4uaW5kZXhlZCwKICAgICAgLi4uY29tcG9uZW50cwogICAgfTsKICAgIHBhcmFtZXRlckNhY2hlLnNldChwYXJhbWV0ZXJDYWNoZUtleSwgYWJpUGFyYW1ldGVyKTsKICAgIHJldHVybiBhYmlQYXJhbWV0ZXI7CiAgfQogIGZ1bmN0aW9uIHNwbGl0UGFyYW1ldGVycyhwYXJhbXMsIHJlc3VsdCA9IFtdLCBjdXJyZW50ID0gIiIsIGRlcHRoID0gMCkgewogICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLnRyaW0oKS5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGNoYXIgPSBwYXJhbXNbaV07CiAgICAgIGNvbnN0IHRhaWwgPSBwYXJhbXMuc2xpY2UoaSArIDEpOwogICAgICBzd2l0Y2ggKGNoYXIpIHsKICAgICAgICBjYXNlICIsIjoKICAgICAgICAgIHJldHVybiBkZXB0aCA9PT0gMCA/IHNwbGl0UGFyYW1ldGVycyh0YWlsLCBbLi4ucmVzdWx0LCBjdXJyZW50LnRyaW0oKV0pIDogc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGgpOwogICAgICAgIGNhc2UgIigiOgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoICsgMSk7CiAgICAgICAgY2FzZSAiKSI6CiAgICAgICAgICByZXR1cm4gc3BsaXRQYXJhbWV0ZXJzKHRhaWwsIHJlc3VsdCwgYCR7Y3VycmVudH0ke2NoYXJ9YCwgZGVwdGggLSAxKTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIHNwbGl0UGFyYW1ldGVycyh0YWlsLCByZXN1bHQsIGAke2N1cnJlbnR9JHtjaGFyfWAsIGRlcHRoKTsKICAgICAgfQogICAgfQogICAgaWYgKGN1cnJlbnQgPT09ICIiKQogICAgICByZXR1cm4gcmVzdWx0OwogICAgaWYgKGRlcHRoICE9PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFBhcmVudGhlc2lzRXJyb3IoeyBjdXJyZW50LCBkZXB0aCB9KTsKICAgIHJlc3VsdC5wdXNoKGN1cnJlbnQudHJpbSgpKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGlzU29saWRpdHlUeXBlKHR5cGUpIHsKICAgIHJldHVybiB0eXBlID09PSAiYWRkcmVzcyIgfHwgdHlwZSA9PT0gImJvb2wiIHx8IHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgdHlwZSA9PT0gInN0cmluZyIgfHwgYnl0ZXNSZWdleC50ZXN0KHR5cGUpIHx8IGludGVnZXJSZWdleC50ZXN0KHR5cGUpOwogIH0KICBmdW5jdGlvbiBpc1NvbGlkaXR5S2V5d29yZChuYW1lKSB7CiAgICByZXR1cm4gbmFtZSA9PT0gImFkZHJlc3MiIHx8IG5hbWUgPT09ICJib29sIiB8fCBuYW1lID09PSAiZnVuY3Rpb24iIHx8IG5hbWUgPT09ICJzdHJpbmciIHx8IG5hbWUgPT09ICJ0dXBsZSIgfHwgYnl0ZXNSZWdleC50ZXN0KG5hbWUpIHx8IGludGVnZXJSZWdleC50ZXN0KG5hbWUpIHx8IHByb3RlY3RlZEtleXdvcmRzUmVnZXgudGVzdChuYW1lKTsKICB9CiAgZnVuY3Rpb24gaXNWYWxpZERhdGFMb2NhdGlvbih0eXBlLCBpc0FycmF5KSB7CiAgICByZXR1cm4gaXNBcnJheSB8fCB0eXBlID09PSAiYnl0ZXMiIHx8IHR5cGUgPT09ICJzdHJpbmciIHx8IHR5cGUgPT09ICJ0dXBsZSI7CiAgfQogIHZhciBhYmlQYXJhbWV0ZXJXaXRob3V0VHVwbGVSZWdleCwgYWJpUGFyYW1ldGVyV2l0aFR1cGxlUmVnZXgsIGR5bmFtaWNJbnRlZ2VyUmVnZXgsIHByb3RlY3RlZEtleXdvcmRzUmVnZXg7CiAgdmFyIGluaXRfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS91dGlscy5qcyIoKSB7CiAgICAgIGluaXRfcmVnZXgoKTsKICAgICAgaW5pdF9hYmlJdGVtKCk7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlKCk7CiAgICAgIGluaXRfc3BsaXRQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfY2FjaGUoKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGFiaVBhcmFtZXRlcldpdGhvdXRUdXBsZVJlZ2V4ID0gL14oPzx0eXBlPlthLXpBLVokX11bYS16QS1aMC05JF9dKikoPzxhcnJheT4oPzpcW1xkKj9cXSkrPyk/KD86XHMoPzxtb2RpZmllcj5jYWxsZGF0YXxpbmRleGVkfG1lbW9yeXxzdG9yYWdlezF9KSk/KD86XHMoPzxuYW1lPlthLXpBLVokX11bYS16QS1aMC05JF9dKikpPyQvOwogICAgICBhYmlQYXJhbWV0ZXJXaXRoVHVwbGVSZWdleCA9IC9eXCgoPzx0eXBlPi4rPylcKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8oPzpccyg/PG1vZGlmaWVyPmNhbGxkYXRhfGluZGV4ZWR8bWVtb3J5fHN0b3JhZ2V7MX0pKT8oPzpccyg/PG5hbWU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSk/JC87CiAgICAgIGR5bmFtaWNJbnRlZ2VyUmVnZXggPSAvXnU/aW50JC87CiAgICAgIHByb3RlY3RlZEtleXdvcmRzUmVnZXggPSAvXig/OmFmdGVyfGFsaWFzfGFub255bW91c3xhcHBseXxhdXRvfGJ5dGV8Y2FsbGRhdGF8Y2FzZXxjYXRjaHxjb25zdGFudHxjb3B5b2Z8ZGVmYXVsdHxkZWZpbmVkfGVycm9yfGV2ZW50fGV4dGVybmFsfGZhbHNlfGZpbmFsfGZ1bmN0aW9ufGltbXV0YWJsZXxpbXBsZW1lbnRzfGlufGluZGV4ZWR8aW5saW5lfGludGVybmFsfGxldHxtYXBwaW5nfG1hdGNofG1lbW9yeXxtdXRhYmxlfG51bGx8b2Z8b3ZlcnJpZGV8cGFydGlhbHxwcml2YXRlfHByb21pc2V8cHVibGljfHB1cmV8cmVmZXJlbmNlfHJlbG9jYXRhYmxlfHJldHVybnxyZXR1cm5zfHNpemVvZnxzdGF0aWN8c3RvcmFnZXxzdHJ1Y3R8c3VwZXJ8c3VwcG9ydHN8c3dpdGNofHRoaXN8dHJ1ZXx0cnl8dHlwZWRlZnx0eXBlb2Z8dmFyfHZpZXd8dmlydHVhbCkkLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcnVudGltZS9zdHJ1Y3RzLmpzCiAgZnVuY3Rpb24gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpIHsKICAgIGNvbnN0IHNoYWxsb3dTdHJ1Y3RzID0ge307CiAgICBjb25zdCBzaWduYXR1cmVzTGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZXNMZW5ndGg7IGkrKykgewogICAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVzW2ldOwogICAgICBpZiAoIWlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgICAgY29udGludWU7CiAgICAgIGNvbnN0IG1hdGNoID0gZXhlY1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgICBpZiAoIW1hdGNoKQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkU2lnbmF0dXJlRXJyb3IoeyBzaWduYXR1cmUsIHR5cGU6ICJzdHJ1Y3QiIH0pOwogICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbWF0Y2gucHJvcGVydGllcy5zcGxpdCgiOyIpOwogICAgICBjb25zdCBjb21wb25lbnRzID0gW107CiAgICAgIGNvbnN0IHByb3BlcnRpZXNMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBwcm9wZXJ0aWVzTGVuZ3RoOyBrKyspIHsKICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnRpZXNba107CiAgICAgICAgY29uc3QgdHJpbW1lZCA9IHByb3BlcnR5LnRyaW0oKTsKICAgICAgICBpZiAoIXRyaW1tZWQpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBjb25zdCBhYmlQYXJhbWV0ZXIgPSBwYXJzZUFiaVBhcmFtZXRlcih0cmltbWVkLCB7CiAgICAgICAgICB0eXBlOiAic3RydWN0IgogICAgICAgIH0pOwogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICB9CiAgICAgIGlmICghY29tcG9uZW50cy5sZW5ndGgpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvcih7IHNpZ25hdHVyZSB9KTsKICAgICAgc2hhbGxvd1N0cnVjdHNbbWF0Y2gubmFtZV0gPSBjb21wb25lbnRzOwogICAgfQogICAgY29uc3QgcmVzb2x2ZWRTdHJ1Y3RzID0ge307CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoc2hhbGxvd1N0cnVjdHMpOwogICAgY29uc3QgZW50cmllc0xlbmd0aCA9IGVudHJpZXMubGVuZ3RoOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzTGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW25hbWUsIHBhcmFtZXRlcnNdID0gZW50cmllc1tpXTsKICAgICAgcmVzb2x2ZWRTdHJ1Y3RzW25hbWVdID0gcmVzb2x2ZVN0cnVjdHMocGFyYW1ldGVycywgc2hhbGxvd1N0cnVjdHMpOwogICAgfQogICAgcmV0dXJuIHJlc29sdmVkU3RydWN0czsKICB9CiAgZnVuY3Rpb24gcmVzb2x2ZVN0cnVjdHMoYWJpUGFyYW1ldGVycywgc3RydWN0cywgYW5jZXN0b3JzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKSkgewogICAgY29uc3QgY29tcG9uZW50cyA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gYWJpUGFyYW1ldGVycy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGFiaVBhcmFtZXRlciA9IGFiaVBhcmFtZXRlcnNbaV07CiAgICAgIGNvbnN0IGlzVHVwbGUgPSBpc1R1cGxlUmVnZXgudGVzdChhYmlQYXJhbWV0ZXIudHlwZSk7CiAgICAgIGlmIChpc1R1cGxlKQogICAgICAgIGNvbXBvbmVudHMucHVzaChhYmlQYXJhbWV0ZXIpOwogICAgICBlbHNlIHsKICAgICAgICBjb25zdCBtYXRjaCA9IGV4ZWNUeXBlZCh0eXBlV2l0aG91dFR1cGxlUmVnZXgsIGFiaVBhcmFtZXRlci50eXBlKTsKICAgICAgICBpZiAoIW1hdGNoPy50eXBlKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IoeyBhYmlQYXJhbWV0ZXIgfSk7CiAgICAgICAgY29uc3QgeyBhcnJheSwgdHlwZSB9ID0gbWF0Y2g7CiAgICAgICAgaWYgKHR5cGUgaW4gc3RydWN0cykgewogICAgICAgICAgaWYgKGFuY2VzdG9ycy5oYXModHlwZSkpCiAgICAgICAgICAgIHRocm93IG5ldyBDaXJjdWxhclJlZmVyZW5jZUVycm9yKHsgdHlwZSB9KTsKICAgICAgICAgIGNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgICAgIC4uLmFiaVBhcmFtZXRlciwKICAgICAgICAgICAgdHlwZTogYHR1cGxlJHthcnJheSA/PyAiIn1gLAogICAgICAgICAgICBjb21wb25lbnRzOiByZXNvbHZlU3RydWN0cyhzdHJ1Y3RzW3R5cGVdID8/IFtdLCBzdHJ1Y3RzLCAvKiBAX19QVVJFX18gKi8gbmV3IFNldChbLi4uYW5jZXN0b3JzLCB0eXBlXSkpCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzU29saWRpdHlUeXBlKHR5cGUpKQogICAgICAgICAgICBjb21wb25lbnRzLnB1c2goYWJpUGFyYW1ldGVyKTsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgdGhyb3cgbmV3IFVua25vd25UeXBlRXJyb3IoeyB0eXBlIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbXBvbmVudHM7CiAgfQogIHZhciB0eXBlV2l0aG91dFR1cGxlUmVnZXg7CiAgdmFyIGluaXRfc3RydWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9ydW50aW1lL3N0cnVjdHMuanMiKCkgewogICAgICBpbml0X3JlZ2V4KCk7CiAgICAgIGluaXRfYWJpSXRlbSgpOwogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZSgpOwogICAgICBpbml0X3N0cnVjdCgpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgICB0eXBlV2l0aG91dFR1cGxlUmVnZXggPSAvXig/PHR5cGU+W2EtekEtWiRfXVthLXpBLVowLTkkX10qKSg/PGFycmF5Pig/OlxbXGQqP1xdKSs/KT8kLzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMKICBmdW5jdGlvbiBwYXJzZUFiaShzaWduYXR1cmVzKSB7CiAgICBjb25zdCBzdHJ1Y3RzID0gcGFyc2VTdHJ1Y3RzKHNpZ25hdHVyZXMpOwogICAgY29uc3QgYWJpMiA9IFtdOwogICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlcy5sZW5ndGg7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHNpZ25hdHVyZXNbaV07CiAgICAgIGlmIChpc1N0cnVjdFNpZ25hdHVyZShzaWduYXR1cmUpKQogICAgICAgIGNvbnRpbnVlOwogICAgICBhYmkyLnB1c2gocGFyc2VTaWduYXR1cmUoc2lnbmF0dXJlLCBzdHJ1Y3RzKSk7CiAgICB9CiAgICByZXR1cm4gYWJpMjsKICB9CiAgdmFyIGluaXRfcGFyc2VBYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmkuanMiKCkgewogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2FiaXR5cGVAMS4wLjYvbm9kZV9tb2R1bGVzL2FiaXR5cGUvZGlzdC9lc20vaHVtYW4tcmVhZGFibGUvcGFyc2VBYmlJdGVtLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlJdGVtKHNpZ25hdHVyZSkgewogICAgbGV0IGFiaUl0ZW07CiAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gInN0cmluZyIpCiAgICAgIGFiaUl0ZW0gPSBwYXJzZVNpZ25hdHVyZShzaWduYXR1cmUpOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMoc2lnbmF0dXJlKTsKICAgICAgY29uc3QgbGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZV8gPSBzaWduYXR1cmVbaV07CiAgICAgICAgaWYgKGlzU3RydWN0U2lnbmF0dXJlKHNpZ25hdHVyZV8pKQogICAgICAgICAgY29udGludWU7CiAgICAgICAgYWJpSXRlbSA9IHBhcnNlU2lnbmF0dXJlKHNpZ25hdHVyZV8sIHN0cnVjdHMpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpSXRlbUVycm9yKHsgc2lnbmF0dXJlIH0pOwogICAgcmV0dXJuIGFiaUl0ZW07CiAgfQogIHZhciBpbml0X3BhcnNlQWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9zaWduYXR1cmVzKCk7CiAgICAgIGluaXRfc3RydWN0cygpOwogICAgICBpbml0X3V0aWxzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9hYml0eXBlQDEuMC42L25vZGVfbW9kdWxlcy9hYml0eXBlL2Rpc3QvZXNtL2h1bWFuLXJlYWRhYmxlL3BhcnNlQWJpUGFyYW1ldGVyLmpzCiAgZnVuY3Rpb24gcGFyc2VBYmlQYXJhbWV0ZXIyKHBhcmFtKSB7CiAgICBsZXQgYWJpUGFyYW1ldGVyOwogICAgaWYgKHR5cGVvZiBwYXJhbSA9PT0gInN0cmluZyIpCiAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHBhcmFtLCB7CiAgICAgICAgbW9kaWZpZXJzCiAgICAgIH0pOwogICAgZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW0pOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbS5sZW5ndGg7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBwYXJhbVtpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGFiaVBhcmFtZXRlciA9IHBhcnNlQWJpUGFyYW1ldGVyKHNpZ25hdHVyZSwgeyBtb2RpZmllcnMsIHN0cnVjdHMgfSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFiaVBhcmFtZXRlckVycm9yKHsgcGFyYW0gfSk7CiAgICByZXR1cm4gYWJpUGFyYW1ldGVyOwogIH0KICB2YXIgaW5pdF9wYXJzZUFiaVBhcmFtZXRlciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlci5qcyIoKSB7CiAgICAgIGluaXRfYWJpUGFyYW1ldGVyKCk7CiAgICAgIGluaXRfc2lnbmF0dXJlcygpOwogICAgICBpbml0X3N0cnVjdHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMKICBmdW5jdGlvbiBwYXJzZUFiaVBhcmFtZXRlcnMocGFyYW1zKSB7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJzID0gW107CiAgICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gInN0cmluZyIpIHsKICAgICAgY29uc3QgcGFyYW1ldGVycyA9IHNwbGl0UGFyYW1ldGVycyhwYXJhbXMpOwogICAgICBjb25zdCBsZW5ndGggPSBwYXJhbWV0ZXJzLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2ldLCB7IG1vZGlmaWVycyB9KSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNvbnN0IHN0cnVjdHMgPSBwYXJzZVN0cnVjdHMocGFyYW1zKTsKICAgICAgY29uc3QgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHBhcmFtc1tpXTsKICAgICAgICBpZiAoaXNTdHJ1Y3RTaWduYXR1cmUoc2lnbmF0dXJlKSkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IHBhcmFtZXRlcnMgPSBzcGxpdFBhcmFtZXRlcnMoc2lnbmF0dXJlKTsKICAgICAgICBjb25zdCBsZW5ndGgyID0gcGFyYW1ldGVycy5sZW5ndGg7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBsZW5ndGgyOyBrKyspIHsKICAgICAgICAgIGFiaVBhcmFtZXRlcnMucHVzaChwYXJzZUFiaVBhcmFtZXRlcihwYXJhbWV0ZXJzW2tdLCB7IG1vZGlmaWVycywgc3RydWN0cyB9KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAoYWJpUGFyYW1ldGVycy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWJpUGFyYW1ldGVyc0Vycm9yKHsgcGFyYW1zIH0pOwogICAgcmV0dXJuIGFiaVBhcmFtZXRlcnM7CiAgfQogIHZhciBpbml0X3BhcnNlQWJpUGFyYW1ldGVycyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9odW1hbi1yZWFkYWJsZS9wYXJzZUFiaVBhcmFtZXRlcnMuanMiKCkgewogICAgICBpbml0X2FiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3NpZ25hdHVyZXMoKTsKICAgICAgaW5pdF9zdHJ1Y3RzKCk7CiAgICAgIGluaXRfdXRpbHMoKTsKICAgICAgaW5pdF91dGlscygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzCiAgdmFyIGluaXRfZXhwb3J0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vYWJpdHlwZUAxLjAuNi9ub2RlX21vZHVsZXMvYWJpdHlwZS9kaXN0L2VzbS9leHBvcnRzL2luZGV4LmpzIigpIHsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtKCk7CiAgICAgIGluaXRfcGFyc2VBYmkoKTsKICAgICAgaW5pdF9wYXJzZUFiaUl0ZW0oKTsKICAgICAgaW5pdF9wYXJzZUFiaVBhcmFtZXRlcigpOwogICAgICBpbml0X3BhcnNlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2FiaUl0ZW0oKTsKICAgICAgaW5pdF9hYmlQYXJhbWV0ZXIoKTsKICAgICAgaW5pdF9zaWduYXR1cmUoKTsKICAgICAgaW5pdF9zcGxpdFBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9zdHJ1Y3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZSA9IGZhbHNlIH0gPSB7fSkgewogICAgaWYgKGFiaUl0ZW0udHlwZSAhPT0gImZ1bmN0aW9uIiAmJiBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIgJiYgYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IoYWJpSXRlbS50eXBlKTsKICAgIHJldHVybiBgJHthYmlJdGVtLm5hbWV9KCR7Zm9ybWF0QWJpUGFyYW1zKGFiaUl0ZW0uaW5wdXRzLCB7IGluY2x1ZGVOYW1lIH0pfSlgOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lID0gZmFsc2UgfSA9IHt9KSB7CiAgICBpZiAoIXBhcmFtcykKICAgICAgcmV0dXJuICIiOwogICAgcmV0dXJuIHBhcmFtcy5tYXAoKHBhcmFtKSA9PiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSkuam9pbihpbmNsdWRlTmFtZSA/ICIsICIgOiAiLCIpOwogIH0KICBmdW5jdGlvbiBmb3JtYXRBYmlQYXJhbShwYXJhbSwgeyBpbmNsdWRlTmFtZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ0dXBsZSIpKSB7CiAgICAgIHJldHVybiBgKCR7Zm9ybWF0QWJpUGFyYW1zKHBhcmFtLmNvbXBvbmVudHMsIHsgaW5jbHVkZU5hbWUgfSl9KSR7cGFyYW0udHlwZS5zbGljZSgidHVwbGUiLmxlbmd0aCl9YDsKICAgIH0KICAgIHJldHVybiBwYXJhbS50eXBlICsgKGluY2x1ZGVOYW1lICYmIHBhcmFtLm5hbWUgPyBgICR7cGFyYW0ubmFtZX1gIDogIiIpOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2Zvcm1hdEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0hleC5qcwogIGZ1bmN0aW9uIGlzSGV4KHZhbHVlLCB7IHN0cmljdCA9IHRydWUgfSA9IHt9KSB7CiAgICBpZiAoIXZhbHVlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0cmljdCA/IC9eMHhbMC05YS1mQS1GXSokLy50ZXN0KHZhbHVlKSA6IHZhbHVlLnN0YXJ0c1dpdGgoIjB4Iik7CiAgfQogIHZhciBpbml0X2lzSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL2lzSGV4LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvc2l6ZS5qcwogIGZ1bmN0aW9uIHNpemUodmFsdWUpIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIpOwogICAgcmV0dXJuIHZhbHVlLmxlbmd0aDsKICB9CiAgdmFyIGluaXRfc2l6ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zaXplLmpzIigpIHsKICAgICAgaW5pdF9pc0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3ZlcnNpb24uanMKICB2YXIgdmVyc2lvbjI7CiAgdmFyIGluaXRfdmVyc2lvbjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy92ZXJzaW9uLmpzIigpIHsKICAgICAgdmVyc2lvbjIgPSAiMi4yMS4zNSI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmFzZS5qcwogIGZ1bmN0aW9uIHNldEVycm9yQ29uZmlnKGNvbmZpZykgewogICAgZXJyb3JDb25maWcgPSBjb25maWc7CiAgfQogIGZ1bmN0aW9uIHdhbGsoZXJyLCBmbikgewogICAgaWYgKGZuPy4oZXJyKSkKICAgICAgcmV0dXJuIGVycjsKICAgIGlmIChlcnIgJiYgdHlwZW9mIGVyciA9PT0gIm9iamVjdCIgJiYgImNhdXNlIiBpbiBlcnIpCiAgICAgIHJldHVybiB3YWxrKGVyci5jYXVzZSwgZm4pOwogICAgcmV0dXJuIGZuID8gbnVsbCA6IGVycjsKICB9CiAgdmFyIGVycm9yQ29uZmlnLCBCYXNlRXJyb3IyOwogIHZhciBpbml0X2Jhc2UgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9iYXNlLmpzIigpIHsKICAgICAgaW5pdF92ZXJzaW9uMigpOwogICAgICBlcnJvckNvbmZpZyA9IHsKICAgICAgICBnZXREb2NzVXJsOiAoeyBkb2NzQmFzZVVybCwgZG9jc1BhdGg6IGRvY3NQYXRoOSA9ICIiLCBkb2NzU2x1ZyB9KSA9PiBkb2NzUGF0aDkgPyBgJHtkb2NzQmFzZVVybCA/PyAiaHR0cHM6Ly92aWVtLnNoIn0ke2RvY3NQYXRoOX0ke2RvY3NTbHVnID8gYCMke2RvY3NTbHVnfWAgOiAiIn1gIDogdm9pZCAwLAogICAgICAgIHZlcnNpb246IGB2aWVtQCR7dmVyc2lvbjJ9YAogICAgICB9OwogICAgICBCYXNlRXJyb3IyID0gY2xhc3MgX0Jhc2VFcnJvciBleHRlbmRzIEVycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaG9ydE1lc3NhZ2UsIGFyZ3MgPSB7fSkgewogICAgICAgICAgY29uc3QgZGV0YWlscyA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kZXRhaWxzOwogICAgICAgICAgICBpZiAoYXJncy5jYXVzZT8ubWVzc2FnZSkKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5tZXNzYWdlOwogICAgICAgICAgICByZXR1cm4gYXJncy5kZXRhaWxzOwogICAgICAgICAgfSkoKTsKICAgICAgICAgIGNvbnN0IGRvY3NQYXRoOSA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhcmdzLmNhdXNlIGluc3RhbmNlb2YgX0Jhc2VFcnJvcikKICAgICAgICAgICAgICByZXR1cm4gYXJncy5jYXVzZS5kb2NzUGF0aCB8fCBhcmdzLmRvY3NQYXRoOwogICAgICAgICAgICByZXR1cm4gYXJncy5kb2NzUGF0aDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBkb2NzVXJsID0gZXJyb3JDb25maWcuZ2V0RG9jc1VybD8uKHsgLi4uYXJncywgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KTsKICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBbCiAgICAgICAgICAgIHNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQuIiwKICAgICAgICAgICAgIiIsCiAgICAgICAgICAgIC4uLmFyZ3MubWV0YU1lc3NhZ2VzID8gWy4uLmFyZ3MubWV0YU1lc3NhZ2VzLCAiIl0gOiBbXSwKICAgICAgICAgICAgLi4uZG9jc1VybCA/IFtgRG9jczogJHtkb2NzVXJsfWBdIDogW10sCiAgICAgICAgICAgIC4uLmRldGFpbHMgPyBbYERldGFpbHM6ICR7ZGV0YWlsc31gXSA6IFtdLAogICAgICAgICAgICAuLi5lcnJvckNvbmZpZy52ZXJzaW9uID8gW2BWZXJzaW9uOiAke2Vycm9yQ29uZmlnLnZlcnNpb259YF0gOiBbXQogICAgICAgICAgXS5qb2luKCJcbiIpOwogICAgICAgICAgc3VwZXIobWVzc2FnZSwgYXJncy5jYXVzZSA/IHsgY2F1c2U6IGFyZ3MuY2F1c2UgfSA6IHZvaWQgMCk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkb2NzUGF0aCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm1ldGFNZXNzYWdlcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNob3J0TWVzc2FnZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInZlcnNpb24iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJuYW1lIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogIkJhc2VFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kZXRhaWxzID0gZGV0YWlsczsKICAgICAgICAgIHRoaXMuZG9jc1BhdGggPSBkb2NzUGF0aDk7CiAgICAgICAgICB0aGlzLm1ldGFNZXNzYWdlcyA9IGFyZ3MubWV0YU1lc3NhZ2VzOwogICAgICAgICAgdGhpcy5uYW1lID0gYXJncy5uYW1lID8/IHRoaXMubmFtZTsKICAgICAgICAgIHRoaXMuc2hvcnRNZXNzYWdlID0gc2hvcnRNZXNzYWdlOwogICAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjI7CiAgICAgICAgfQogICAgICAgIHdhbGsoZm4pIHsKICAgICAgICAgIHJldHVybiB3YWxrKHRoaXMsIGZuKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYWJpLmpzCiAgdmFyIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvciwgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLCBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciwgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yLCBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvciwgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yLCBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IsIEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvciwgQWJpRXJyb3JOb3RGb3VuZEVycm9yLCBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsIEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlFdmVudE5vdEZvdW5kRXJyb3IsIEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25PdXRwdXRzTm90Rm91bmRFcnJvciwgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yLCBBYmlJdGVtQW1iaWd1aXR5RXJyb3IsIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsIERlY29kZUxvZ0RhdGFNaXNtYXRjaCwgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gsIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciwgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yLCBJbnZhbGlkQXJyYXlFcnJvciwgSW52YWxpZERlZmluaXRpb25UeXBlRXJyb3IsIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZTsKICB2YXIgaW5pdF9hYmkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hYmkuanMiKCkgewogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICAiQSBjb25zdHJ1Y3RvciB3YXMgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgY29uc3RydWN0b3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJDb25zdHJ1Y3RvciBhcmd1bWVudHMgd2VyZSBwcm92aWRlZCAoYGFyZ3NgKSwgYnV0IGEgY29uc3RydWN0b3IgcGFyYW1ldGVycyAoYGlucHV0c2ApIHdlcmUgbm90IGZvdW5kIG9uIHRoZSBBQkkuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSwgYW5kIHRoYXQgdGhlIGBpbnB1dHNgIGF0dHJpYnV0ZSBvbiB0aGUgY29uc3RydWN0b3IgZXhpc3RzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyBpbnZhbGlkLmAsCiAgICAgICAgICAgICJTaXplIG11c3QgYmUgaW4gaW5jcmVtZW50cyBvZiAzMiBieXRlcyAoc2l6ZSAlIDMyID09PSAwKS4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYERhdGE6ICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWBdLAogICAgICAgICAgICBuYW1lOiAiQWJpRGVjb2RpbmdEYXRhU2l6ZUludmFsaWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZGF0YSwgcGFyYW1zLCBzaXplOiBzaXplMyB9KSB7CiAgICAgICAgICBzdXBlcihbYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIGdpdmVuIHBhcmFtZXRlcnMuYF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgUGFyYW1zOiAoJHtmb3JtYXRBYmlQYXJhbXMocGFyYW1zLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSlgLAogICAgICAgICAgICAgIGBEYXRhOiAgICR7ZGF0YX0gKCR7c2l6ZTN9IGJ5dGVzKWAKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJwYXJhbXMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKICAgICAgICAgIHRoaXMuc2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKCdDYW5ub3QgZGVjb2RlIHplcm8gZGF0YSAoIjB4Iikgd2l0aCBBQkkgcGFyYW1ldGVycy4nLCB7CiAgICAgICAgICAgIG5hbWU6ICJBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkTGVuZ3RoLCBnaXZlbkxlbmd0aCwgdHlwZSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBQkkgZW5jb2RpbmcgYXJyYXkgbGVuZ3RoIG1pc21hdGNoIGZvciB0eXBlICR7dHlwZX0uYCwKICAgICAgICAgICAgYEV4cGVjdGVkIGxlbmd0aDogJHtleHBlY3RlZExlbmd0aH1gLAogICAgICAgICAgICBgR2l2ZW4gbGVuZ3RoOiAke2dpdmVuTGVuZ3RofWAKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgb2YgYnl0ZXMgIiR7dmFsdWV9IiAoYnl0ZXMke3NpemUodmFsdWUpfSkgZG9lcyBub3QgbWF0Y2ggZXhwZWN0ZWQgc2l6ZSAoYnl0ZXMke2V4cGVjdGVkU2l6ZX0pLmAsIHsgbmFtZTogIkFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZXhwZWN0ZWRMZW5ndGgsIGdpdmVuTGVuZ3RoIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkFCSSBlbmNvZGluZyBwYXJhbXMvdmFsdWVzIGxlbmd0aCBtaXNtYXRjaC4iLAogICAgICAgICAgICBgRXhwZWN0ZWQgbGVuZ3RoIChwYXJhbXMpOiAke2V4cGVjdGVkTGVuZ3RofWAsCiAgICAgICAgICAgIGBHaXZlbiBsZW5ndGggKHZhbHVlcyk6ICR7Z2l2ZW5MZW5ndGh9YAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBBcmd1bWVudHMgKFxgYXJnc1xgKSB3ZXJlIHByb3ZpZGVkIHRvICIke2Vycm9yTmFtZX0iLCBidXQgIiR7ZXJyb3JOYW1lfSIgb24gdGhlIEFCSSBkb2VzIG5vdCBjb250YWluIGFueSBwYXJhbWV0ZXJzIChcYGlucHV0c1xgKS5gLAogICAgICAgICAgICAiQ2Fubm90IGVuY29kZSBlcnJvciByZXN1bHQgd2l0aG91dCBrbm93aW5nIHdoYXQgdGhlIHBhcmFtZXRlciB0eXBlcyBhcmUuIiwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgaW5wdXRzIGV4aXN0IG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGVycm9yTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXJyb3IgJHtlcnJvck5hbWUgPyBgIiR7ZXJyb3JOYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXJyb3JOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHNpZ25hdHVyZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYEVuY29kZWQgZXJyb3Igc2lnbmF0dXJlICIke3NpZ25hdHVyZX0iIG5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXJyb3IgZXhpc3RzIG9uIGl0LiIsCiAgICAgICAgICAgIGBZb3UgY2FuIGxvb2sgdXAgdGhlIGRlY29kZWQgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJzaWduYXR1cmUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGV4dHJhY3QgZXZlbnQgc2lnbmF0dXJlIGZyb20gZW1wdHkgdG9waWNzLiIsIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihzaWduYXR1cmUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFbmNvZGVkIGV2ZW50IHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBub3QgZm91bmQgb24gQUJJLmAsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGV2ZW50IGV4aXN0cyBvbiBpdC4iLAogICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBzaWduYXR1cmUgaGVyZTogaHR0cHM6Ly9vcGVuY2hhaW4ueHl6L3NpZ25hdHVyZXM/cXVlcnk9JHtzaWduYXR1cmV9LmAKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlFdmVudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRXZlbnQgJHtldmVudE5hbWUgPyBgIiR7ZXZlbnROYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZXZlbnQgZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRXZlbnROb3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRnVuY3Rpb24gJHtmdW5jdGlvbk5hbWUgPyBgIiR7ZnVuY3Rpb25OYW1lfSIgYCA6ICIifW5vdCBmb3VuZCBvbiBBQkkuYCwKICAgICAgICAgICAgIk1ha2Ugc3VyZSB5b3UgYXJlIHVzaW5nIHRoZSBjb3JyZWN0IEFCSSBhbmQgdGhhdCB0aGUgZnVuY3Rpb24gZXhpc3RzIG9uIGl0LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBuYW1lOiAiQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoOSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBGdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiBkb2VzIG5vdCBjb250YWluIGFueSBcYG91dHB1dHNcYCBvbiBBQkkuYCwKICAgICAgICAgICAgIkNhbm5vdCBkZWNvZGUgZnVuY3Rpb24gcmVzdWx0IHdpdGhvdXQga25vd2luZyB3aGF0IHRoZSBwYXJhbWV0ZXIgdHlwZXMgYXJlLiIsCiAgICAgICAgICAgICJNYWtlIHN1cmUgeW91IGFyZSB1c2luZyB0aGUgY29ycmVjdCBBQkkgYW5kIHRoYXQgdGhlIGZ1bmN0aW9uIGV4aXN0cyBvbiBpdC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDkgfSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgRW5jb2RlZCBmdW5jdGlvbiBzaWduYXR1cmUgIiR7c2lnbmF0dXJlfSIgbm90IGZvdW5kIG9uIEFCSS5gLAogICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBmdW5jdGlvbiBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgYFlvdSBjYW4gbG9vayB1cCB0aGUgc2lnbmF0dXJlIGhlcmU6IGh0dHBzOi8vb3BlbmNoYWluLnh5ei9zaWduYXR1cmVzP3F1ZXJ5PSR7c2lnbmF0dXJlfS5gCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbmFtZTogIkFiaUZ1bmN0aW9uU2lnbmF0dXJlTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQWJpSXRlbUFtYmlndWl0eUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih4LCB5KSB7CiAgICAgICAgICBzdXBlcigiRm91bmQgYW1iaWd1b3VzIHR5cGVzIGluIG92ZXJsb2FkZWQgQUJJIGl0ZW1zLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgYFxgJHt4LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHguYWJpSXRlbSl9XGAsIGFuZGAsCiAgICAgICAgICAgICAgYFxgJHt5LnR5cGV9XGAgaW4gXGAke2Zvcm1hdEFiaUl0ZW0yKHkuYWJpSXRlbSl9XGBgLAogICAgICAgICAgICAgICIiLAogICAgICAgICAgICAgICJUaGVzZSB0eXBlcyBlbmNvZGUgZGlmZmVyZW50bHkgYW5kIGNhbm5vdCBiZSBkaXN0aW5ndWlzaGVkIGF0IHJ1bnRpbWUuIiwKICAgICAgICAgICAgICAiUmVtb3ZlIG9uZSBvZiB0aGUgYW1iaWd1b3VzIGl0ZW1zIGluIHRoZSBBQkkuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQWJpSXRlbUFtYmlndWl0eUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBCeXRlc1NpemVNaXNtYXRjaEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGV4cGVjdGVkU2l6ZSwgZ2l2ZW5TaXplIH0pIHsKICAgICAgICAgIHN1cGVyKGBFeHBlY3RlZCBieXRlcyR7ZXhwZWN0ZWRTaXplfSwgZ290IGJ5dGVzJHtnaXZlblNpemV9LmAsIHsKICAgICAgICAgICAgbmFtZTogIkJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIERlY29kZUxvZ0RhdGFNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBkYXRhLCBwYXJhbXMsIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYERhdGEgc2l6ZSBvZiAke3NpemUzfSBieXRlcyBpcyB0b28gc21hbGwgZm9yIG5vbi1pbmRleGVkIGV2ZW50IHBhcmFtZXRlcnMuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBQYXJhbXM6ICgke2Zvcm1hdEFiaVBhcmFtcyhwYXJhbXMsIHsgaW5jbHVkZU5hbWU6IHRydWUgfSl9KWAsCiAgICAgICAgICAgICAgYERhdGE6ICAgJHtkYXRhfSAoJHtzaXplM30gYnl0ZXMpYAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiRGVjb2RlTG9nRGF0YU1pc21hdGNoIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJkYXRhIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAicGFyYW1zIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic2l6ZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaUl0ZW0gPSBhYmlJdGVtOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwogICAgICAgICAgdGhpcy5zaXplID0gc2l6ZTM7CiAgICAgICAgfQogICAgICB9OwogICAgICBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhYmlJdGVtLCBwYXJhbSB9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgIGBFeHBlY3RlZCBhIHRvcGljIGZvciBpbmRleGVkIGV2ZW50IHBhcmFtZXRlciR7cGFyYW0ubmFtZSA/IGAgIiR7cGFyYW0ubmFtZX0iYCA6ICIifSBvbiBldmVudCAiJHtmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pfSIuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IG5hbWU6ICJEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCIgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFiaUl0ZW0iLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5hYmlJdGVtID0gYWJpSXRlbTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGVuY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRW5jb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlY29kaW5nIHR5cGUuYCwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgdmFsaWQgQUJJIHR5cGUuIgogICAgICAgICAgXS5qb2luKCJcbiIpLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIG5hbWU6ICJJbnZhbGlkQWJpRGVjb2RpbmdUeXBlIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRBcnJheUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkgewogICAgICAgICAgc3VwZXIoW2BWYWx1ZSAiJHt2YWx1ZX0iIGlzIG5vdCBhIHZhbGlkIGFycmF5LmBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBcnJheUVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoWwogICAgICAgICAgICBgIiR7dHlwZX0iIGlzIG5vdCBhIHZhbGlkIGRlZmluaXRpb24gdHlwZS5gLAogICAgICAgICAgICAnVmFsaWQgdHlwZXM6ICJmdW5jdGlvbiIsICJldmVudCIsICJlcnJvciInCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsgbmFtZTogIkludmFsaWREZWZpbml0aW9uVHlwZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFVuc3VwcG9ydGVkUGFja2VkQWJpVHlwZSA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICAgICAgc3VwZXIoYFR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHBhY2tlZCBlbmNvZGluZy5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZGF0YS5qcwogIHZhciBTbGljZU9mZnNldE91dE9mQm91bmRzRXJyb3IsIFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3I7CiAgdmFyIGluaXRfZGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2RhdGEuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCwgcG9zaXRpb24sIHNpemU6IHNpemUzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTbGljZSAke3Bvc2l0aW9uID09PSAic3RhcnQiID8gInN0YXJ0aW5nIiA6ICJlbmRpbmcifSBhdCBvZmZzZXQgIiR7b2Zmc2V0fSIgaXMgb3V0LW9mLWJvdW5kcyAoc2l6ZTogJHtzaXplM30pLmAsIHsgbmFtZTogIlNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gc2l6ZSAoJHtzaXplM30pIGV4Y2VlZHMgcGFkZGluZyBzaXplICgke3RhcmdldFNpemV9KS5gLCB7IG5hbWU6ICJTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc2l6ZTogc2l6ZTMsIHRhcmdldFNpemUsIHR5cGUgfSkgewogICAgICAgICAgc3VwZXIoYCR7dHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX0ke3R5cGUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0gaXMgZXhwZWN0ZWQgdG8gYmUgJHt0YXJnZXRTaXplfSAke3R5cGV9IGxvbmcsIGJ1dCBpcyAke3NpemUzfSAke3R5cGV9IGxvbmcuYCwgeyBuYW1lOiAiSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvcGFkLmpzCiAgZnVuY3Rpb24gcGFkKGhleE9yQnl0ZXMsIHsgZGlyLCBzaXplOiBzaXplMyA9IDMyIH0gPSB7fSkgewogICAgaWYgKHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHBhZEhleChoZXhPckJ5dGVzLCB7IGRpciwgc2l6ZTogc2l6ZTMgfSk7CiAgICByZXR1cm4gcGFkQnl0ZXMoaGV4T3JCeXRlcywgeyBkaXIsIHNpemU6IHNpemUzIH0pOwogIH0KICBmdW5jdGlvbiBwYWRIZXgoaGV4XywgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBoZXhfOwogICAgY29uc3QgaGV4ID0gaGV4Xy5yZXBsYWNlKCIweCIsICIiKTsKICAgIGlmIChoZXgubGVuZ3RoID4gc2l6ZTMgKiAyKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBNYXRoLmNlaWwoaGV4Lmxlbmd0aCAvIDIpLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJoZXgiCiAgICAgIH0pOwogICAgcmV0dXJuIGAweCR7aGV4W2RpciA9PT0gInJpZ2h0IiA/ICJwYWRFbmQiIDogInBhZFN0YXJ0Il0oc2l6ZTMgKiAyLCAiMCIpfWA7CiAgfQogIGZ1bmN0aW9uIHBhZEJ5dGVzKGJ5dGVzMiwgeyBkaXIsIHNpemU6IHNpemUzID0gMzIgfSA9IHt9KSB7CiAgICBpZiAoc2l6ZTMgPT09IG51bGwpCiAgICAgIHJldHVybiBieXRlczI7CiAgICBpZiAoYnl0ZXMyLmxlbmd0aCA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZUV4Y2VlZHNQYWRkaW5nU2l6ZUVycm9yKHsKICAgICAgICBzaXplOiBieXRlczIubGVuZ3RoLAogICAgICAgIHRhcmdldFNpemU6IHNpemUzLAogICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgfSk7CiAgICBjb25zdCBwYWRkZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KHNpemUzKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTM7IGkrKykgewogICAgICBjb25zdCBwYWRFbmQgPSBkaXIgPT09ICJyaWdodCI7CiAgICAgIHBhZGRlZEJ5dGVzW3BhZEVuZCA/IGkgOiBzaXplMyAtIGkgLSAxXSA9IGJ5dGVzMltwYWRFbmQgPyBpIDogYnl0ZXMyLmxlbmd0aCAtIGkgLSAxXTsKICAgIH0KICAgIHJldHVybiBwYWRkZWRCeXRlczsKICB9CiAgdmFyIGluaXRfcGFkID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3BhZC5qcyIoKSB7CiAgICAgIGluaXRfZGF0YSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2VuY29kaW5nLmpzCiAgdmFyIEludGVnZXJPdXRPZlJhbmdlRXJyb3IsIEludmFsaWRCeXRlc0Jvb2xlYW5FcnJvciwgSW52YWxpZEhleEJvb2xlYW5FcnJvciwgSW52YWxpZEhleFZhbHVlRXJyb3IsIFNpemVPdmVyZmxvd0Vycm9yOwogIHZhciBpbml0X2VuY29kaW5nID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZW5jb2RpbmcuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW50ZWdlck91dE9mUmFuZ2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBtYXgsIG1pbiwgc2lnbmVkLCBzaXplOiBzaXplMywgdmFsdWUgfSkgewogICAgICAgICAgc3VwZXIoYE51bWJlciAiJHt2YWx1ZX0iIGlzIG5vdCBpbiBzYWZlICR7c2l6ZTMgPyBgJHtzaXplMyAqIDh9LWJpdCAke3NpZ25lZCA/ICJzaWduZWQiIDogInVuc2lnbmVkIn0gYCA6ICIifWludGVnZXIgcmFuZ2UgJHttYXggPyBgKCR7bWlufSB0byAke21heH0pYCA6IGAoYWJvdmUgJHttaW59KWB9YCwgeyBuYW1lOiAiSW50ZWdlck91dE9mUmFuZ2VFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGJ5dGVzMikgewogICAgICAgICAgc3VwZXIoYEJ5dGVzIHZhbHVlICIke2J5dGVzMn0iIGlzIG5vdCBhIHZhbGlkIGJvb2xlYW4uIFRoZSBieXRlcyBhcnJheSBtdXN0IGNvbnRhaW4gYSBzaW5nbGUgYnl0ZSBvZiBlaXRoZXIgYSAwIG9yIDEgdmFsdWUuYCwgewogICAgICAgICAgICBuYW1lOiAiSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcihoZXgpIHsKICAgICAgICAgIHN1cGVyKGBIZXggdmFsdWUgIiR7aGV4fSIgaXMgbm90IGEgdmFsaWQgYm9vbGVhbi4gVGhlIGhleCB2YWx1ZSBtdXN0IGJlICIweDAiIChmYWxzZSkgb3IgIjB4MSIgKHRydWUpLmAsIHsgbmFtZTogIkludmFsaWRIZXhCb29sZWFuRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZEhleFZhbHVlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7CiAgICAgICAgICBzdXBlcihgSGV4IHZhbHVlICIke3ZhbHVlfSIgaXMgYW4gb2RkIGxlbmd0aCAoJHt2YWx1ZS5sZW5ndGh9KS4gSXQgbXVzdCBiZSBhbiBldmVuIGxlbmd0aC5gLCB7IG5hbWU6ICJJbnZhbGlkSGV4VmFsdWVFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBTaXplT3ZlcmZsb3dFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBnaXZlblNpemUsIG1heFNpemUgfSkgewogICAgICAgICAgc3VwZXIoYFNpemUgY2Fubm90IGV4Y2VlZCAke21heFNpemV9IGJ5dGVzLiBHaXZlbiBzaXplOiAke2dpdmVuU2l6ZX0gYnl0ZXMuYCwgeyBuYW1lOiAiU2l6ZU92ZXJmbG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvdHJpbS5qcwogIGZ1bmN0aW9uIHRyaW0oaGV4T3JCeXRlcywgeyBkaXIgPSAibGVmdCIgfSA9IHt9KSB7CiAgICBsZXQgZGF0YSA9IHR5cGVvZiBoZXhPckJ5dGVzID09PSAic3RyaW5nIiA/IGhleE9yQnl0ZXMucmVwbGFjZSgiMHgiLCAiIikgOiBoZXhPckJ5dGVzOwogICAgbGV0IHNsaWNlTGVuZ3RoID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgaWYgKGRhdGFbZGlyID09PSAibGVmdCIgPyBpIDogZGF0YS5sZW5ndGggLSBpIC0gMV0udG9TdHJpbmcoKSA9PT0gIjAiKQogICAgICAgIHNsaWNlTGVuZ3RoKys7CiAgICAgIGVsc2UKICAgICAgICBicmVhazsKICAgIH0KICAgIGRhdGEgPSBkaXIgPT09ICJsZWZ0IiA/IGRhdGEuc2xpY2Uoc2xpY2VMZW5ndGgpIDogZGF0YS5zbGljZSgwLCBkYXRhLmxlbmd0aCAtIHNsaWNlTGVuZ3RoKTsKICAgIGlmICh0eXBlb2YgaGV4T3JCeXRlcyA9PT0gInN0cmluZyIpIHsKICAgICAgaWYgKGRhdGEubGVuZ3RoID09PSAxICYmIGRpciA9PT0gInJpZ2h0IikKICAgICAgICBkYXRhID0gYCR7ZGF0YX0wYDsKICAgICAgcmV0dXJuIGAweCR7ZGF0YS5sZW5ndGggJSAyID09PSAxID8gYDAke2RhdGF9YCA6IGRhdGF9YDsKICAgIH0KICAgIHJldHVybiBkYXRhOwogIH0KICB2YXIgaW5pdF90cmltID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3RyaW0uanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUhleC5qcwogIGZ1bmN0aW9uIGFzc2VydFNpemUoaGV4T3JCeXRlcywgeyBzaXplOiBzaXplMyB9KSB7CiAgICBpZiAoc2l6ZShoZXhPckJ5dGVzKSA+IHNpemUzKQogICAgICB0aHJvdyBuZXcgU2l6ZU92ZXJmbG93RXJyb3IoewogICAgICAgIGdpdmVuU2l6ZTogc2l6ZShoZXhPckJ5dGVzKSwKICAgICAgICBtYXhTaXplOiBzaXplMwogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gZnJvbUhleChoZXgsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBoZXhUb051bWJlcihoZXgsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gaGV4VG9TdHJpbmcoaGV4LCBvcHRzKTsKICAgIGlmICh0byA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gaGV4VG9Cb29sKGhleCwgb3B0cyk7CiAgICByZXR1cm4gaGV4VG9CeXRlcyhoZXgsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBoZXhUb0JpZ0ludChoZXgsIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQgfSA9IG9wdHM7CiAgICBpZiAob3B0cy5zaXplKQogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICBjb25zdCB2YWx1ZSA9IEJpZ0ludChoZXgpOwogICAgaWYgKCFzaWduZWQpCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIGNvbnN0IHNpemUzID0gKGhleC5sZW5ndGggLSAyKSAvIDI7CiAgICBjb25zdCBtYXggPSAoMW4gPDwgQmlnSW50KHNpemUzKSAqIDhuIC0gMW4pIC0gMW47CiAgICBpZiAodmFsdWUgPD0gbWF4KQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gdmFsdWUgLSBCaWdJbnQoYDB4JHsiZiIucGFkU3RhcnQoc2l6ZTMgKiAyLCAiZiIpfWApIC0gMW47CiAgfQogIGZ1bmN0aW9uIGhleFRvQm9vbChoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHRyaW0oaGV4KTsKICAgIH0KICAgIGlmICh0cmltKGhleCkgPT09ICIweDAwIikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKHRyaW0oaGV4KSA9PT0gIjB4MDEiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHRocm93IG5ldyBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yKGhleCk7CiAgfQogIGZ1bmN0aW9uIGhleFRvTnVtYmVyKGhleCwgb3B0cyA9IHt9KSB7CiAgICByZXR1cm4gTnVtYmVyKGhleFRvQmlnSW50KGhleCwgb3B0cykpOwogIH0KICBmdW5jdGlvbiBoZXhUb1N0cmluZyhoZXgsIG9wdHMgPSB7fSkgewogICAgbGV0IGJ5dGVzMiA9IGhleFRvQnl0ZXMoaGV4KTsKICAgIGlmIChvcHRzLnNpemUpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21IZXggPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21IZXguanMiKCkgewogICAgICBpbml0X2VuY29kaW5nKCk7CiAgICAgIGluaXRfc2l6ZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcwogIGZ1bmN0aW9uIHRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICJudW1iZXIiIHx8IHR5cGVvZiB2YWx1ZSA9PT0gImJpZ2ludCIpCiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgb3B0cyk7CiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gc3RyaW5nVG9IZXgodmFsdWUsIG9wdHMpOwogICAgfQogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvSGV4KHZhbHVlLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgZnVuY3Rpb24gYm9vbFRvSGV4KHZhbHVlLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IGhleCA9IGAweCR7TnVtYmVyKHZhbHVlKX1gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgfQogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb0hleCh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBsZXQgc3RyaW5nID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIHN0cmluZyArPSBoZXhlc1t2YWx1ZVtpXV07CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgke3N0cmluZ31gOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoaGV4LCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleCh2YWx1ZV8sIG9wdHMgPSB7fSkgewogICAgY29uc3QgeyBzaWduZWQsIHNpemU6IHNpemUzIH0gPSBvcHRzOwogICAgY29uc3QgdmFsdWUgPSBCaWdJbnQodmFsdWVfKTsKICAgIGxldCBtYXhWYWx1ZTsKICAgIGlmIChzaXplMykgewogICAgICBpZiAoc2lnbmVkKQogICAgICAgIG1heFZhbHVlID0gKDFuIDw8IEJpZ0ludChzaXplMykgKiA4biAtIDFuKSAtIDFuOwogICAgICBlbHNlCiAgICAgICAgbWF4VmFsdWUgPSAybiAqKiAoQmlnSW50KHNpemUzKSAqIDhuKSAtIDFuOwogICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWVfID09PSAibnVtYmVyIikgewogICAgICBtYXhWYWx1ZSA9IEJpZ0ludChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7CiAgICB9CiAgICBjb25zdCBtaW5WYWx1ZSA9IHR5cGVvZiBtYXhWYWx1ZSA9PT0gImJpZ2ludCIgJiYgc2lnbmVkID8gLW1heFZhbHVlIC0gMW4gOiAwOwogICAgaWYgKG1heFZhbHVlICYmIHZhbHVlID4gbWF4VmFsdWUgfHwgdmFsdWUgPCBtaW5WYWx1ZSkgewogICAgICBjb25zdCBzdWZmaXggPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/ICJuIiA6ICIiOwogICAgICB0aHJvdyBuZXcgSW50ZWdlck91dE9mUmFuZ2VFcnJvcih7CiAgICAgICAgbWF4OiBtYXhWYWx1ZSA/IGAke21heFZhbHVlfSR7c3VmZml4fWAgOiB2b2lkIDAsCiAgICAgICAgbWluOiBgJHttaW5WYWx1ZX0ke3N1ZmZpeH1gLAogICAgICAgIHNpZ25lZCwKICAgICAgICBzaXplOiBzaXplMywKICAgICAgICB2YWx1ZTogYCR7dmFsdWVffSR7c3VmZml4fWAKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBoZXggPSBgMHgkeyhzaWduZWQgJiYgdmFsdWUgPCAwID8gKDFuIDw8IEJpZ0ludChzaXplMyAqIDgpKSArIEJpZ0ludCh2YWx1ZSkgOiB2YWx1ZSkudG9TdHJpbmcoMTYpfWA7CiAgICBpZiAoc2l6ZTMpCiAgICAgIHJldHVybiBwYWQoaGV4LCB7IHNpemU6IHNpemUzIH0pOwogICAgcmV0dXJuIGhleDsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9IZXgodmFsdWVfLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IHZhbHVlID0gZW5jb2Rlci5lbmNvZGUodmFsdWVfKTsKICAgIHJldHVybiBieXRlc1RvSGV4KHZhbHVlLCBvcHRzKTsKICB9CiAgdmFyIGhleGVzLCBlbmNvZGVyOwogIHZhciBpbml0X3RvSGV4ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbmNvZGluZy90b0hleC5qcyIoKSB7CiAgICAgIGluaXRfZW5jb2RpbmcoKTsKICAgICAgaW5pdF9wYWQoKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGhleGVzID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoX3YsIGkpID0+IGkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIikpOwogICAgICBlbmNvZGVyID0gLyogQF9fUFVSRV9fICovIG5ldyBUZXh0RW5jb2RlcigpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvdG9CeXRlcy5qcwogIGZ1bmN0aW9uIHRvQnl0ZXModmFsdWUsIG9wdHMgPSB7fSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gIm51bWJlciIgfHwgdHlwZW9mIHZhbHVlID09PSAiYmlnaW50IikKICAgICAgcmV0dXJuIG51bWJlclRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gImJvb2xlYW4iKQogICAgICByZXR1cm4gYm9vbFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgaWYgKGlzSGV4KHZhbHVlKSkKICAgICAgcmV0dXJuIGhleFRvQnl0ZXModmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIHN0cmluZ1RvQnl0ZXModmFsdWUsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBib29sVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBuZXcgVWludDhBcnJheSgxKTsKICAgIGJ5dGVzMlswXSA9IE51bWJlcih2YWx1ZSk7CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSA9PT0gIm51bWJlciIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICByZXR1cm4gcGFkKGJ5dGVzMiwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICBmdW5jdGlvbiBjaGFyQ29kZVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLnplcm8gJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5uaW5lKQogICAgICByZXR1cm4gY2hhciAtIGNoYXJDb2RlTWFwLnplcm87CiAgICBpZiAoY2hhciA+PSBjaGFyQ29kZU1hcC5BICYmIGNoYXIgPD0gY2hhckNvZGVNYXAuRikKICAgICAgcmV0dXJuIGNoYXIgLSAoY2hhckNvZGVNYXAuQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGNoYXJDb2RlTWFwLmEgJiYgY2hhciA8PSBjaGFyQ29kZU1hcC5mKQogICAgICByZXR1cm4gY2hhciAtIChjaGFyQ29kZU1hcC5hIC0gMTApOwogICAgcmV0dXJuIHZvaWQgMDsKICB9CiAgZnVuY3Rpb24gaGV4VG9CeXRlcyhoZXhfLCBvcHRzID0ge30pIHsKICAgIGxldCBoZXggPSBoZXhfOwogICAgaWYgKG9wdHMuc2l6ZSkgewogICAgICBhc3NlcnRTaXplKGhleCwgeyBzaXplOiBvcHRzLnNpemUgfSk7CiAgICAgIGhleCA9IHBhZChoZXgsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICBsZXQgaGV4U3RyaW5nID0gaGV4LnNsaWNlKDIpOwogICAgaWYgKGhleFN0cmluZy5sZW5ndGggJSAyKQogICAgICBoZXhTdHJpbmcgPSBgMCR7aGV4U3RyaW5nfWA7CiAgICBjb25zdCBsZW5ndGggPSBoZXhTdHJpbmcubGVuZ3RoIC8gMjsKICAgIGNvbnN0IGJ5dGVzMiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICBmb3IgKGxldCBpbmRleDIgPSAwLCBqID0gMDsgaW5kZXgyIDwgbGVuZ3RoOyBpbmRleDIrKykgewogICAgICBjb25zdCBuaWJibGVMZWZ0ID0gY2hhckNvZGVUb0Jhc2UxNihoZXhTdHJpbmcuY2hhckNvZGVBdChqKyspKTsKICAgICAgY29uc3QgbmliYmxlUmlnaHQgPSBjaGFyQ29kZVRvQmFzZTE2KGhleFN0cmluZy5jaGFyQ29kZUF0KGorKykpOwogICAgICBpZiAobmliYmxlTGVmdCA9PT0gdm9pZCAwIHx8IG5pYmJsZVJpZ2h0ID09PSB2b2lkIDApIHsKICAgICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBieXRlIHNlcXVlbmNlICgiJHtoZXhTdHJpbmdbaiAtIDJdfSR7aGV4U3RyaW5nW2ogLSAxXX0iIGluICIke2hleFN0cmluZ30iKS5gKTsKICAgICAgfQogICAgICBieXRlczJbaW5kZXgyXSA9IG5pYmJsZUxlZnQgKiAxNiArIG5pYmJsZVJpZ2h0OwogICAgfQogICAgcmV0dXJuIGJ5dGVzMjsKICB9CiAgZnVuY3Rpb24gbnVtYmVyVG9CeXRlcyh2YWx1ZSwgb3B0cykgewogICAgY29uc3QgaGV4ID0gbnVtYmVyVG9IZXgodmFsdWUsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoaGV4KTsKICB9CiAgZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyh2YWx1ZSwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCBieXRlczIgPSBlbmNvZGVyMi5lbmNvZGUodmFsdWUpOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgPT09ICJudW1iZXIiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgcmV0dXJuIHBhZChieXRlczIsIHsgZGlyOiAicmlnaHQiLCBzaXplOiBvcHRzLnNpemUgfSk7CiAgICB9CiAgICByZXR1cm4gYnl0ZXMyOwogIH0KICB2YXIgZW5jb2RlcjIsIGNoYXJDb2RlTWFwOwogIHZhciBpbml0X3RvQnl0ZXMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvQnl0ZXMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X2Zyb21IZXgoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgICBlbmNvZGVyMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVGV4dEVuY29kZXIoKTsKICAgICAgY2hhckNvZGVNYXAgPSB7CiAgICAgICAgemVybzogNDgsCiAgICAgICAgbmluZTogNTcsCiAgICAgICAgQTogNjUsCiAgICAgICAgRjogNzAsCiAgICAgICAgYTogOTcsCiAgICAgICAgZjogMTAyCiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzCiAgZnVuY3Rpb24gbnVtYmVyKG4pIHsKICAgIGlmICghTnVtYmVyLmlzU2FmZUludGVnZXIobikgfHwgbiA8IDApCiAgICAgIHRocm93IG5ldyBFcnJvcihgcG9zaXRpdmUgaW50ZWdlciBleHBlY3RlZCwgbm90ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gaXNCeXRlcyhhKSB7CiAgICByZXR1cm4gYSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgfHwgYSAhPSBudWxsICYmIHR5cGVvZiBhID09PSAib2JqZWN0IiAmJiBhLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CiAgZnVuY3Rpb24gYnl0ZXMoYiwgLi4ubGVuZ3RocykgewogICAgaWYgKCFpc0J5dGVzKGIpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIlVpbnQ4QXJyYXkgZXhwZWN0ZWQiKTsKICAgIGlmIChsZW5ndGhzLmxlbmd0aCA+IDAgJiYgIWxlbmd0aHMuaW5jbHVkZXMoYi5sZW5ndGgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYFVpbnQ4QXJyYXkgZXhwZWN0ZWQgb2YgbGVuZ3RoICR7bGVuZ3Roc30sIG5vdCBvZiBsZW5ndGg9JHtiLmxlbmd0aH1gKTsKICB9CiAgZnVuY3Rpb24gaGFzaChoKSB7CiAgICBpZiAodHlwZW9mIGggIT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mIGguY3JlYXRlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggc2hvdWxkIGJlIHdyYXBwZWQgYnkgdXRpbHMud3JhcENvbnN0cnVjdG9yIik7CiAgICBudW1iZXIoaC5vdXRwdXRMZW4pOwogICAgbnVtYmVyKGguYmxvY2tMZW4pOwogIH0KICBmdW5jdGlvbiBleGlzdHMoaW5zdGFuY2UsIGNoZWNrRmluaXNoZWQgPSB0cnVlKSB7CiAgICBpZiAoaW5zdGFuY2UuZGVzdHJveWVkKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkhhc2ggaW5zdGFuY2UgaGFzIGJlZW4gZGVzdHJveWVkIik7CiAgICBpZiAoY2hlY2tGaW5pc2hlZCAmJiBpbnN0YW5jZS5maW5pc2hlZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJIYXNoI2RpZ2VzdCgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIik7CiAgfQogIGZ1bmN0aW9uIG91dHB1dChvdXQsIGluc3RhbmNlKSB7CiAgICBieXRlcyhvdXQpOwogICAgY29uc3QgbWluID0gaW5zdGFuY2Uub3V0cHV0TGVuOwogICAgaWYgKG91dC5sZW5ndGggPCBtaW4pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBkaWdlc3RJbnRvKCkgZXhwZWN0cyBvdXRwdXQgYnVmZmVyIG9mIGxlbmd0aCBhdCBsZWFzdCAke21pbn1gKTsKICAgIH0KICB9CiAgdmFyIGluaXRfYXNzZXJ0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fYXNzZXJ0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL191NjQuanMKICBmdW5jdGlvbiBmcm9tQmlnKG4sIGxlID0gZmFsc2UpIHsKICAgIGlmIChsZSkKICAgICAgcmV0dXJuIHsgaDogTnVtYmVyKG4gJiBVMzJfTUFTSzY0KSwgbDogTnVtYmVyKG4gPj4gXzMybiAmIFUzMl9NQVNLNjQpIH07CiAgICByZXR1cm4geyBoOiBOdW1iZXIobiA+PiBfMzJuICYgVTMyX01BU0s2NCkgfCAwLCBsOiBOdW1iZXIobiAmIFUzMl9NQVNLNjQpIHwgMCB9OwogIH0KICBmdW5jdGlvbiBzcGxpdChsc3QsIGxlID0gZmFsc2UpIHsKICAgIGxldCBBaCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGxldCBBbCA9IG5ldyBVaW50MzJBcnJheShsc3QubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbHN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgaCwgbCB9ID0gZnJvbUJpZyhsc3RbaV0sIGxlKTsKICAgICAgW0FoW2ldLCBBbFtpXV0gPSBbaCwgbF07CiAgICB9CiAgICByZXR1cm4gW0FoLCBBbF07CiAgfQogIHZhciBVMzJfTUFTSzY0LCBfMzJuLCByb3RsU0gsIHJvdGxTTCwgcm90bEJILCByb3RsQkw7CiAgdmFyIGluaXRfdTY0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fdTY0LmpzIigpIHsKICAgICAgVTMyX01BU0s2NCA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMiAqKiAzMiAtIDEpOwogICAgICBfMzJuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgzMik7CiAgICAgIHJvdGxTSCA9IChoLCBsLCBzKSA9PiBoIDw8IHMgfCBsID4+PiAzMiAtIHM7CiAgICAgIHJvdGxTTCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgfCBoID4+PiAzMiAtIHM7CiAgICAgIHJvdGxCSCA9IChoLCBsLCBzKSA9PiBsIDw8IHMgLSAzMiB8IGggPj4+IDY0IC0gczsKICAgICAgcm90bEJMID0gKGgsIGwsIHMpID0+IGggPDwgcyAtIDMyIHwgbCA+Pj4gNjQgLSBzOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vY3J5cHRvLmpzCiAgdmFyIGNyeXB0bzsKICB2YXIgaW5pdF9jcnlwdG8gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2NyeXB0by5qcyIoKSB7CiAgICAgIGNyeXB0byA9IHR5cGVvZiBnbG9iYWxUaGlzID09PSAib2JqZWN0IiAmJiAiY3J5cHRvIiBpbiBnbG9iYWxUaGlzID8gZ2xvYmFsVGhpcy5jcnlwdG8gOiB2b2lkIDA7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS91dGlscy5qcwogIGZ1bmN0aW9uIGJ5dGVTd2FwMzIoYXJyKSB7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBieXRlU3dhcChhcnJbaV0pOwogICAgfQogIH0KICBmdW5jdGlvbiB1dGY4VG9CeXRlcyhzdHIpIHsKICAgIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKGB1dGY4VG9CeXRlcyBleHBlY3RlZCBzdHJpbmcsIGdvdCAke3R5cGVvZiBzdHJ9YCk7CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHN0cikpOwogIH0KICBmdW5jdGlvbiB0b0J5dGVzMihkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICJzdHJpbmciKQogICAgICBkYXRhID0gdXRmOFRvQnl0ZXMoZGF0YSk7CiAgICBieXRlcyhkYXRhKTsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlcyguLi5hcnJheXMpIHsKICAgIGxldCBzdW0gPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgYnl0ZXMoYSk7CiAgICAgIHN1bSArPSBhLmxlbmd0aDsKICAgIH0KICAgIGNvbnN0IHJlcyA9IG5ldyBVaW50OEFycmF5KHN1bSk7CiAgICBmb3IgKGxldCBpID0gMCwgcGFkMiA9IDA7IGkgPCBhcnJheXMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgYSA9IGFycmF5c1tpXTsKICAgICAgcmVzLnNldChhLCBwYWQyKTsKICAgICAgcGFkMiArPSBhLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHdyYXBDb25zdHJ1Y3RvcihoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnKSA9PiBoYXNoQ29ucygpLnVwZGF0ZSh0b0J5dGVzMihtc2cpKS5kaWdlc3QoKTsKICAgIGNvbnN0IHRtcCA9IGhhc2hDb25zKCk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAoKSA9PiBoYXNoQ29ucygpOwogICAgcmV0dXJuIGhhc2hDOwogIH0KICBmdW5jdGlvbiB3cmFwWE9GQ29uc3RydWN0b3JXaXRoT3B0cyhoYXNoQ29ucykgewogICAgY29uc3QgaGFzaEMgPSAobXNnLCBvcHRzKSA9PiBoYXNoQ29ucyhvcHRzKS51cGRhdGUodG9CeXRlczIobXNnKSkuZGlnZXN0KCk7CiAgICBjb25zdCB0bXAgPSBoYXNoQ29ucyh7fSk7CiAgICBoYXNoQy5vdXRwdXRMZW4gPSB0bXAub3V0cHV0TGVuOwogICAgaGFzaEMuYmxvY2tMZW4gPSB0bXAuYmxvY2tMZW47CiAgICBoYXNoQy5jcmVhdGUgPSAob3B0cykgPT4gaGFzaENvbnMob3B0cyk7CiAgICByZXR1cm4gaGFzaEM7CiAgfQogIGZ1bmN0aW9uIHJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoID0gMzIpIHsKICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgcmV0dXJuIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoYnl0ZXNMZW5ndGgpKTsKICAgIH0KICAgIGlmIChjcnlwdG8gJiYgdHlwZW9mIGNyeXB0by5yYW5kb21CeXRlcyA9PT0gImZ1bmN0aW9uIikgewogICAgICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKGJ5dGVzTGVuZ3RoKTsKICAgIH0KICAgIHRocm93IG5ldyBFcnJvcigiY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtdXN0IGJlIGRlZmluZWQiKTsKICB9CiAgdmFyIHUzMiwgY3JlYXRlVmlldywgcm90ciwgcm90bCwgaXNMRSwgYnl0ZVN3YXAsIEhhc2gsIHRvU3RyOwogIHZhciBpbml0X3V0aWxzMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vdXRpbHMuanMiKCkgewogICAgICBpbml0X2NyeXB0bygpOwogICAgICBpbml0X2Fzc2VydCgpOwogICAgICB1MzIgPSAoYXJyKSA9PiBuZXcgVWludDMyQXJyYXkoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIE1hdGguZmxvb3IoYXJyLmJ5dGVMZW5ndGggLyA0KSk7CiAgICAgIGNyZWF0ZVZpZXcgPSAoYXJyKSA9PiBuZXcgRGF0YVZpZXcoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTsKICAgICAgcm90ciA9ICh3b3JkLCBzaGlmdCkgPT4gd29yZCA8PCAzMiAtIHNoaWZ0IHwgd29yZCA+Pj4gc2hpZnQ7CiAgICAgIHJvdGwgPSAod29yZCwgc2hpZnQpID0+IHdvcmQgPDwgc2hpZnQgfCB3b3JkID4+PiAzMiAtIHNoaWZ0ID4+PiAwOwogICAgICBpc0xFID0gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQzMkFycmF5KFsyODc0NTQwMjBdKS5idWZmZXIpWzBdID09PSA2ODsKICAgICAgYnl0ZVN3YXAgPSAod29yZCkgPT4gd29yZCA8PCAyNCAmIDQyNzgxOTAwODAgfCB3b3JkIDw8IDggJiAxNjcxMTY4MCB8IHdvcmQgPj4+IDggJiA2NTI4MCB8IHdvcmQgPj4+IDI0ICYgMjU1OwogICAgICBIYXNoID0gY2xhc3MgewogICAgICAgIC8vIFNhZmUgdmVyc2lvbiB0aGF0IGNsb25lcyBpbnRlcm5hbCBzdGF0ZQogICAgICAgIGNsb25lKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lSW50bygpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdG9TdHIgPSB7fS50b1N0cmluZzsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTMuanMKICBmdW5jdGlvbiBrZWNjYWtQKHMsIHJvdW5kcyA9IDI0KSB7CiAgICBjb25zdCBCID0gbmV3IFVpbnQzMkFycmF5KDUgKiAyKTsKICAgIGZvciAobGV0IHJvdW5kID0gMjQgLSByb3VuZHM7IHJvdW5kIDwgMjQ7IHJvdW5kKyspIHsKICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgIEJbeF0gPSBzW3hdIF4gc1t4ICsgMTBdIF4gc1t4ICsgMjBdIF4gc1t4ICsgMzBdIF4gc1t4ICsgNDBdOwogICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4ICs9IDIpIHsKICAgICAgICBjb25zdCBpZHgxID0gKHggKyA4KSAlIDEwOwogICAgICAgIGNvbnN0IGlkeDAgPSAoeCArIDIpICUgMTA7CiAgICAgICAgY29uc3QgQjAgPSBCW2lkeDBdOwogICAgICAgIGNvbnN0IEIxID0gQltpZHgwICsgMV07CiAgICAgICAgY29uc3QgVGggPSByb3RsSChCMCwgQjEsIDEpIF4gQltpZHgxXTsKICAgICAgICBjb25zdCBUbCA9IHJvdGxMKEIwLCBCMSwgMSkgXiBCW2lkeDEgKyAxXTsKICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IDUwOyB5ICs9IDEwKSB7CiAgICAgICAgICBzW3ggKyB5XSBePSBUaDsKICAgICAgICAgIHNbeCArIHkgKyAxXSBePSBUbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IGN1ckggPSBzWzJdOwogICAgICBsZXQgY3VyTCA9IHNbM107CiAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgMjQ7IHQrKykgewogICAgICAgIGNvbnN0IHNoaWZ0ID0gU0hBM19ST1RMW3RdOwogICAgICAgIGNvbnN0IFRoID0gcm90bEgoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFRsID0gcm90bEwoY3VySCwgY3VyTCwgc2hpZnQpOwogICAgICAgIGNvbnN0IFBJID0gU0hBM19QSVt0XTsKICAgICAgICBjdXJIID0gc1tQSV07CiAgICAgICAgY3VyTCA9IHNbUEkgKyAxXTsKICAgICAgICBzW1BJXSA9IFRoOwogICAgICAgIHNbUEkgKyAxXSA9IFRsOwogICAgICB9CiAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgNTA7IHkgKz0gMTApIHsKICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IDEwOyB4KyspCiAgICAgICAgICBCW3hdID0gc1t5ICsgeF07CiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCAxMDsgeCsrKQogICAgICAgICAgc1t5ICsgeF0gXj0gfkJbKHggKyAyKSAlIDEwXSAmIEJbKHggKyA0KSAlIDEwXTsKICAgICAgfQogICAgICBzWzBdIF49IFNIQTNfSU9UQV9IW3JvdW5kXTsKICAgICAgc1sxXSBePSBTSEEzX0lPVEFfTFtyb3VuZF07CiAgICB9CiAgICBCLmZpbGwoMCk7CiAgfQogIHZhciBTSEEzX1BJLCBTSEEzX1JPVEwsIF9TSEEzX0lPVEEsIF8wbiwgXzFuLCBfMm4sIF83biwgXzI1Nm4sIF8weDcxbiwgU0hBM19JT1RBX0gsIFNIQTNfSU9UQV9MLCByb3RsSCwgcm90bEwsIEtlY2NhaywgZ2VuLCBzaGEzXzIyNCwgc2hhM18yNTYsIHNoYTNfMzg0LCBzaGEzXzUxMiwga2VjY2FrXzIyNCwga2VjY2FrXzI1Niwga2VjY2FrXzM4NCwga2VjY2FrXzUxMiwgZ2VuU2hha2UsIHNoYWtlMTI4LCBzaGFrZTI1NjsKICB2YXIgaW5pdF9zaGEzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9zaGEzLmpzIigpIHsKICAgICAgaW5pdF9hc3NlcnQoKTsKICAgICAgaW5pdF91NjQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBM19QSSA9IFtdOwogICAgICBTSEEzX1JPVEwgPSBbXTsKICAgICAgX1NIQTNfSU9UQSA9IFtdOwogICAgICBfMG4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDApOwogICAgICBfMW4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDIpOwogICAgICBfN24gPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDcpOwogICAgICBfMjU2biA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMjU2KTsKICAgICAgXzB4NzFuID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgxMTMpOwogICAgICBmb3IgKGxldCByb3VuZCA9IDAsIFIgPSBfMW4sIHggPSAxLCB5ID0gMDsgcm91bmQgPCAyNDsgcm91bmQrKykgewogICAgICAgIFt4LCB5XSA9IFt5LCAoMiAqIHggKyAzICogeSkgJSA1XTsKICAgICAgICBTSEEzX1BJLnB1c2goMiAqICg1ICogeSArIHgpKTsKICAgICAgICBTSEEzX1JPVEwucHVzaCgocm91bmQgKyAxKSAqIChyb3VuZCArIDIpIC8gMiAlIDY0KTsKICAgICAgICBsZXQgdCA9IF8wbjsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDc7IGorKykgewogICAgICAgICAgUiA9IChSIDw8IF8xbiBeIChSID4+IF83bikgKiBfMHg3MW4pICUgXzI1Nm47CiAgICAgICAgICBpZiAoUiAmIF8ybikKICAgICAgICAgICAgdCBePSBfMW4gPDwgKF8xbiA8PCAvKiBAX19QVVJFX18gKi8gQmlnSW50KGopKSAtIF8xbjsKICAgICAgICB9CiAgICAgICAgX1NIQTNfSU9UQS5wdXNoKHQpOwogICAgICB9CiAgICAgIFtTSEEzX0lPVEFfSCwgU0hBM19JT1RBX0xdID0gLyogQF9fUFVSRV9fICovIHNwbGl0KF9TSEEzX0lPVEEsIHRydWUpOwogICAgICByb3RsSCA9IChoLCBsLCBzKSA9PiBzID4gMzIgPyByb3RsQkgoaCwgbCwgcykgOiByb3RsU0goaCwgbCwgcyk7CiAgICAgIHJvdGxMID0gKGgsIGwsIHMpID0+IHMgPiAzMiA/IHJvdGxCTChoLCBsLCBzKSA6IHJvdGxTTChoLCBsLCBzKTsKICAgICAgS2VjY2FrID0gY2xhc3MgX0tlY2NhayBleHRlbmRzIEhhc2ggewogICAgICAgIC8vIE5PVEU6IHdlIGFjY2VwdCBhcmd1bWVudHMgaW4gYnl0ZXMgaW5zdGVhZCBvZiBiaXRzIGhlcmUuCiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCBlbmFibGVYT0YgPSBmYWxzZSwgcm91bmRzID0gMjQpIHsKICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICB0aGlzLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0aGlzLnN1ZmZpeCA9IHN1ZmZpeDsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5lbmFibGVYT0YgPSBlbmFibGVYT0Y7CiAgICAgICAgICB0aGlzLnJvdW5kcyA9IHJvdW5kczsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMucG9zT3V0ID0gMDsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBudW1iZXIob3V0cHV0TGVuKTsKICAgICAgICAgIGlmICgwID49IHRoaXMuYmxvY2tMZW4gfHwgdGhpcy5ibG9ja0xlbiA+PSAyMDApCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiU2hhMyBzdXBwb3J0cyBvbmx5IGtlY2Nhay1mMTYwMCBmdW5jdGlvbiIpOwogICAgICAgICAgdGhpcy5zdGF0ZSA9IG5ldyBVaW50OEFycmF5KDIwMCk7CiAgICAgICAgICB0aGlzLnN0YXRlMzIgPSB1MzIodGhpcy5zdGF0ZSk7CiAgICAgICAgfQogICAgICAgIGtlY2NhaygpIHsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAga2VjY2FrUCh0aGlzLnN0YXRlMzIsIHRoaXMucm91bmRzKTsKICAgICAgICAgIGlmICghaXNMRSkKICAgICAgICAgICAgYnl0ZVN3YXAzMih0aGlzLnN0YXRlMzIpOwogICAgICAgICAgdGhpcy5wb3NPdXQgPSAwOwogICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgc3RhdGUgfSA9IHRoaXM7CiAgICAgICAgICBkYXRhID0gdG9CeXRlczIoZGF0YSk7CiAgICAgICAgICBjb25zdCBsZW4gPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDA7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGNvbnN0IHRha2UgPSBNYXRoLm1pbihibG9ja0xlbiAtIHRoaXMucG9zLCBsZW4gLSBwb3MpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRha2U7IGkrKykKICAgICAgICAgICAgICBzdGF0ZVt0aGlzLnBvcysrXSBePSBkYXRhW3BvcysrXTsKICAgICAgICAgICAgaWYgKHRoaXMucG9zID09PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGZpbmlzaCgpIHsKICAgICAgICAgIGlmICh0aGlzLmZpbmlzaGVkKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHsgc3RhdGUsIHN1ZmZpeCwgcG9zLCBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIHN0YXRlW3Bvc10gXj0gc3VmZml4OwogICAgICAgICAgaWYgKChzdWZmaXggJiAxMjgpICE9PSAwICYmIHBvcyA9PT0gYmxvY2tMZW4gLSAxKQogICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgc3RhdGVbYmxvY2tMZW4gLSAxXSBePSAxMjg7CiAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgIH0KICAgICAgICB3cml0ZUludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcywgZmFsc2UpOwogICAgICAgICAgYnl0ZXMob3V0KTsKICAgICAgICAgIHRoaXMuZmluaXNoKCk7CiAgICAgICAgICBjb25zdCBidWZmZXJPdXQgPSB0aGlzLnN0YXRlOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiB9ID0gdGhpczsKICAgICAgICAgIGZvciAobGV0IHBvcyA9IDAsIGxlbiA9IG91dC5sZW5ndGg7IHBvcyA8IGxlbjsgKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnBvc091dCA+PSBibG9ja0xlbikKICAgICAgICAgICAgICB0aGlzLmtlY2NhaygpOwogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvc091dCwgbGVuIC0gcG9zKTsKICAgICAgICAgICAgb3V0LnNldChidWZmZXJPdXQuc3ViYXJyYXkodGhpcy5wb3NPdXQsIHRoaXMucG9zT3V0ICsgdGFrZSksIHBvcyk7CiAgICAgICAgICAgIHRoaXMucG9zT3V0ICs9IHRha2U7CiAgICAgICAgICAgIHBvcyArPSB0YWtlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICB9CiAgICAgICAgeG9mSW50byhvdXQpIHsKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVYT0YpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiWE9GIGlzIG5vdCBwb3NzaWJsZSBmb3IgdGhpcyBpbnN0YW5jZSIpOwogICAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVJbnRvKG91dCk7CiAgICAgICAgfQogICAgICAgIHhvZihieXRlczIpIHsKICAgICAgICAgIG51bWJlcihieXRlczIpOwogICAgICAgICAgcmV0dXJuIHRoaXMueG9mSW50byhuZXcgVWludDhBcnJheShieXRlczIpKTsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIG91dHB1dChvdXQsIHRoaXMpOwogICAgICAgICAgaWYgKHRoaXMuZmluaXNoZWQpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiZGlnZXN0KCkgd2FzIGFscmVhZHkgY2FsbGVkIik7CiAgICAgICAgICB0aGlzLndyaXRlSW50byhvdXQpOwogICAgICAgICAgdGhpcy5kZXN0cm95KCk7CiAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5kaWdlc3RJbnRvKG5ldyBVaW50OEFycmF5KHRoaXMub3V0cHV0TGVuKSk7CiAgICAgICAgfQogICAgICAgIGRlc3Ryb3koKSB7CiAgICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7CiAgICAgICAgICB0aGlzLnN0YXRlLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIGNvbnN0IHsgYmxvY2tMZW4sIHN1ZmZpeCwgb3V0cHV0TGVuLCByb3VuZHMsIGVuYWJsZVhPRiB9ID0gdGhpczsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyBfS2VjY2FrKGJsb2NrTGVuLCBzdWZmaXgsIG91dHB1dExlbiwgZW5hYmxlWE9GLCByb3VuZHMpKTsKICAgICAgICAgIHRvLnN0YXRlMzIuc2V0KHRoaXMuc3RhdGUzMik7CiAgICAgICAgICB0by5wb3MgPSB0aGlzLnBvczsKICAgICAgICAgIHRvLnBvc091dCA9IHRoaXMucG9zT3V0OwogICAgICAgICAgdG8uZmluaXNoZWQgPSB0aGlzLmZpbmlzaGVkOwogICAgICAgICAgdG8ucm91bmRzID0gcm91bmRzOwogICAgICAgICAgdG8uc3VmZml4ID0gc3VmZml4OwogICAgICAgICAgdG8ub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdG8uZW5hYmxlWE9GID0gZW5hYmxlWE9GOwogICAgICAgICAgdG8uZGVzdHJveWVkID0gdGhpcy5kZXN0cm95ZWQ7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgICBnZW4gPSAoc3VmZml4LCBibG9ja0xlbiwgb3V0cHV0TGVuKSA9PiB3cmFwQ29uc3RydWN0b3IoKCkgPT4gbmV3IEtlY2NhayhibG9ja0xlbiwgc3VmZml4LCBvdXRwdXRMZW4pKTsKICAgICAgc2hhM18yMjQgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDE0NCwgMjI0IC8gOCk7CiAgICAgIHNoYTNfMjU2ID0gLyogQF9fUFVSRV9fICovIGdlbig2LCAxMzYsIDI1NiAvIDgpOwogICAgICBzaGEzXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oNiwgMTA0LCAzODQgLyA4KTsKICAgICAgc2hhM181MTIgPSAvKiBAX19QVVJFX18gKi8gZ2VuKDYsIDcyLCA1MTIgLyA4KTsKICAgICAga2VjY2FrXzIyNCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTQ0LCAyMjQgLyA4KTsKICAgICAga2VjY2FrXzI1NiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTM2LCAyNTYgLyA4KTsKICAgICAga2VjY2FrXzM4NCA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgMTA0LCAzODQgLyA4KTsKICAgICAga2VjY2FrXzUxMiA9IC8qIEBfX1BVUkVfXyAqLyBnZW4oMSwgNzIsIDUxMiAvIDgpOwogICAgICBnZW5TaGFrZSA9IChzdWZmaXgsIGJsb2NrTGVuLCBvdXRwdXRMZW4pID0+IHdyYXBYT0ZDb25zdHJ1Y3RvcldpdGhPcHRzKChvcHRzID0ge30pID0+IG5ldyBLZWNjYWsoYmxvY2tMZW4sIHN1ZmZpeCwgb3B0cy5ka0xlbiA9PT0gdm9pZCAwID8gb3V0cHV0TGVuIDogb3B0cy5ka0xlbiwgdHJ1ZSkpOwogICAgICBzaGFrZTEyOCA9IC8qIEBfX1BVUkVfXyAqLyBnZW5TaGFrZSgzMSwgMTY4LCAxMjggLyA4KTsKICAgICAgc2hha2UyNTYgPSAvKiBAX19QVVJFX18gKi8gZ2VuU2hha2UoMzEsIDEzNiwgMjU2IC8gOCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2tlY2NhazI1Ni5qcwogIGZ1bmN0aW9uIGtlY2NhazI1Nih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IGtlY2Nha18yNTYoaXNIZXgodmFsdWUsIHsgc3RyaWN0OiBmYWxzZSB9KSA/IHRvQnl0ZXModmFsdWUpIDogdmFsdWUpOwogICAgaWYgKHRvID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gYnl0ZXMyOwogICAgcmV0dXJuIHRvSGV4KGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2tlY2NhazI1NiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9rZWNjYWsyNTYuanMiKCkgewogICAgICBpbml0X3NoYTMoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF90b0hleCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzCiAgZnVuY3Rpb24gaGFzaFNpZ25hdHVyZShzaWcpIHsKICAgIHJldHVybiBoYXNoMihzaWcpOwogIH0KICB2YXIgaGFzaDI7CiAgdmFyIGluaXRfaGFzaFNpZ25hdHVyZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9oYXNoU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfa2VjY2FrMjU2KCk7CiAgICAgIGhhc2gyID0gKHZhbHVlKSA9PiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC9ub3JtYWxpemVTaWduYXR1cmUuanMKICBmdW5jdGlvbiBub3JtYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKSB7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGxldCBjdXJyZW50ID0gIiI7CiAgICBsZXQgbGV2ZWwgPSAwOwogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgbGV0IHZhbGlkID0gZmFsc2U7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZ25hdHVyZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGFyID0gc2lnbmF0dXJlW2ldOwogICAgICBpZiAoWyIoIiwgIikiLCAiLCJdLmluY2x1ZGVzKGNoYXIpKQogICAgICAgIGFjdGl2ZSA9IHRydWU7CiAgICAgIGlmIChjaGFyID09PSAiKCIpCiAgICAgICAgbGV2ZWwrKzsKICAgICAgaWYgKGNoYXIgPT09ICIpIikKICAgICAgICBsZXZlbC0tOwogICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKGxldmVsID09PSAwKSB7CiAgICAgICAgaWYgKGNoYXIgPT09ICIgIiAmJiBbImV2ZW50IiwgImZ1bmN0aW9uIiwgIiJdLmluY2x1ZGVzKHJlc3VsdCkpCiAgICAgICAgICByZXN1bHQgPSAiIjsKICAgICAgICBlbHNlIHsKICAgICAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICAgICAgaWYgKGNoYXIgPT09ICIpIikgewogICAgICAgICAgICB2YWxpZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoY2hhciA9PT0gIiAiKSB7CiAgICAgICAgaWYgKHNpZ25hdHVyZVtpIC0gMV0gIT09ICIsIiAmJiBjdXJyZW50ICE9PSAiLCIgJiYgY3VycmVudCAhPT0gIiwoIikgewogICAgICAgICAgY3VycmVudCA9ICIiOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIHJlc3VsdCArPSBjaGFyOwogICAgICBjdXJyZW50ICs9IGNoYXI7CiAgICB9CiAgICBpZiAoIXZhbGlkKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiVW5hYmxlIHRvIG5vcm1hbGl6ZSBzaWduYXR1cmUuIik7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgaW5pdF9ub3JtYWxpemVTaWduYXR1cmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvbm9ybWFsaXplU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzCiAgdmFyIHRvU2lnbmF0dXJlOwogIHZhciBpbml0X3RvU2lnbmF0dXJlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlLmpzIigpIHsKICAgICAgaW5pdF9leHBvcnRzKCk7CiAgICAgIGluaXRfbm9ybWFsaXplU2lnbmF0dXJlKCk7CiAgICAgIHRvU2lnbmF0dXJlID0gKGRlZikgPT4gewogICAgICAgIGNvbnN0IGRlZl8gPSAoKCkgPT4gewogICAgICAgICAgaWYgKHR5cGVvZiBkZWYgPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gZGVmOwogICAgICAgICAgcmV0dXJuIGZvcm1hdEFiaUl0ZW0oZGVmKTsKICAgICAgICB9KSgpOwogICAgICAgIHJldHVybiBub3JtYWxpemVTaWduYXR1cmUoZGVmXyk7CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcwogIGZ1bmN0aW9uIHRvU2lnbmF0dXJlSGFzaChmbikgewogICAgcmV0dXJuIGhhc2hTaWduYXR1cmUodG9TaWduYXR1cmUoZm4pKTsKICB9CiAgdmFyIGluaXRfdG9TaWduYXR1cmVIYXNoID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvU2lnbmF0dXJlSGFzaC5qcyIoKSB7CiAgICAgIGluaXRfaGFzaFNpZ25hdHVyZSgpOwogICAgICBpbml0X3RvU2lnbmF0dXJlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcwogIHZhciB0b0V2ZW50U2VsZWN0b3I7CiAgdmFyIGluaXRfdG9FdmVudFNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRXZlbnRTZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CiAgICAgIHRvRXZlbnRTZWxlY3RvciA9IHRvU2lnbmF0dXJlSGFzaDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9hZGRyZXNzLmpzCiAgdmFyIEludmFsaWRBZGRyZXNzRXJyb3I7CiAgdmFyIGluaXRfYWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FkZHJlc3MuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgSW52YWxpZEFkZHJlc3NFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBBZGRyZXNzICIke2FkZHJlc3N9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIi0gQWRkcmVzcyBtdXN0IGJlIGEgaGV4IHZhbHVlIG9mIDIwIGJ5dGVzICg0MCBoZXggY2hhcmFjdGVycykuIiwKICAgICAgICAgICAgICAiLSBBZGRyZXNzIG11c3QgbWF0Y2ggaXRzIGNoZWNrc3VtIGNvdW50ZXJwYXJ0LiIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRBZGRyZXNzRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9scnUuanMKICB2YXIgTHJ1TWFwOwogIHZhciBpbml0X2xydSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbHJ1LmpzIigpIHsKICAgICAgTHJ1TWFwID0gY2xhc3MgZXh0ZW5kcyBNYXAgewogICAgICAgIGNvbnN0cnVjdG9yKHNpemUzKSB7CiAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJtYXhTaXplIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMubWF4U2l6ZSA9IHNpemUzOwogICAgICAgIH0KICAgICAgICBnZXQoa2V5KSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHN1cGVyLmdldChrZXkpOwogICAgICAgICAgaWYgKHN1cGVyLmhhcyhrZXkpICYmIHZhbHVlICE9PSB2b2lkIDApIHsKICAgICAgICAgICAgdGhpcy5kZWxldGUoa2V5KTsKICAgICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgICBzZXQoa2V5LCB2YWx1ZSkgewogICAgICAgICAgc3VwZXIuc2V0KGtleSwgdmFsdWUpOwogICAgICAgICAgaWYgKHRoaXMubWF4U2l6ZSAmJiB0aGlzLnNpemUgPiB0aGlzLm1heFNpemUpIHsKICAgICAgICAgICAgY29uc3QgZmlyc3RLZXkgPSB0aGlzLmtleXMoKS5uZXh0KCkudmFsdWU7CiAgICAgICAgICAgIGlmIChmaXJzdEtleSkKICAgICAgICAgICAgICB0aGlzLmRlbGV0ZShmaXJzdEtleSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldEFkZHJlc3MuanMKICBmdW5jdGlvbiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzc18sIGNoYWluSWQpIHsKICAgIGlmIChjaGVja3N1bUFkZHJlc3NDYWNoZS5oYXMoYCR7YWRkcmVzc199LiR7Y2hhaW5JZH1gKSkKICAgICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzc0NhY2hlLmdldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWApOwogICAgY29uc3QgaGV4QWRkcmVzcyA9IGNoYWluSWQgPyBgJHtjaGFpbklkfSR7YWRkcmVzc18udG9Mb3dlckNhc2UoKX1gIDogYWRkcmVzc18uc3Vic3RyaW5nKDIpLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGhleEFkZHJlc3MpLCAiYnl0ZXMiKTsKICAgIGNvbnN0IGFkZHJlc3MgPSAoY2hhaW5JZCA/IGhleEFkZHJlc3Muc3Vic3RyaW5nKGAke2NoYWluSWR9MHhgLmxlbmd0aCkgOiBoZXhBZGRyZXNzKS5zcGxpdCgiIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQwOyBpICs9IDIpIHsKICAgICAgaWYgKGhhc2gzW2kgPj4gMV0gPj4gNCA+PSA4ICYmIGFkZHJlc3NbaV0pIHsKICAgICAgICBhZGRyZXNzW2ldID0gYWRkcmVzc1tpXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICAgIGlmICgoaGFzaDNbaSA+PiAxXSAmIDE1KSA+PSA4ICYmIGFkZHJlc3NbaSArIDFdKSB7CiAgICAgICAgYWRkcmVzc1tpICsgMV0gPSBhZGRyZXNzW2kgKyAxXS50b1VwcGVyQ2FzZSgpOwogICAgICB9CiAgICB9CiAgICBjb25zdCByZXN1bHQgPSBgMHgke2FkZHJlc3Muam9pbigiIil9YDsKICAgIGNoZWNrc3VtQWRkcmVzc0NhY2hlLnNldChgJHthZGRyZXNzX30uJHtjaGFpbklkfWAsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICBmdW5jdGlvbiBnZXRBZGRyZXNzKGFkZHJlc3MsIGNoYWluSWQpIHsKICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhhZGRyZXNzLCBjaGFpbklkKTsKICB9CiAgdmFyIGNoZWNrc3VtQWRkcmVzc0NhY2hlOwogIHZhciBpbml0X2dldEFkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvZ2V0QWRkcmVzcy5qcyIoKSB7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X3RvQnl0ZXMoKTsKICAgICAgaW5pdF9rZWNjYWsyNTYoKTsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9pc0FkZHJlc3MoKTsKICAgICAgY2hlY2tzdW1BZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzCiAgZnVuY3Rpb24gaXNBZGRyZXNzKGFkZHJlc3MsIG9wdGlvbnMpIHsKICAgIGNvbnN0IHsgc3RyaWN0ID0gdHJ1ZSB9ID0gb3B0aW9ucyA/PyB7fTsKICAgIGNvbnN0IGNhY2hlS2V5MiA9IGAke2FkZHJlc3N9LiR7c3RyaWN0fWA7CiAgICBpZiAoaXNBZGRyZXNzQ2FjaGUuaGFzKGNhY2hlS2V5MikpCiAgICAgIHJldHVybiBpc0FkZHJlc3NDYWNoZS5nZXQoY2FjaGVLZXkyKTsKICAgIGNvbnN0IHJlc3VsdCA9ICgoKSA9PiB7CiAgICAgIGlmICghYWRkcmVzc1JlZ2V4LnRlc3QoYWRkcmVzcykpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcy50b0xvd2VyQ2FzZSgpID09PSBhZGRyZXNzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHJldHVybiBjaGVja3N1bUFkZHJlc3MoYWRkcmVzcykgPT09IGFkZHJlc3M7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGlzQWRkcmVzc0NhY2hlLnNldChjYWNoZUtleTIsIHJlc3VsdCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KICB2YXIgYWRkcmVzc1JlZ2V4LCBpc0FkZHJlc3NDYWNoZTsKICB2YXIgaW5pdF9pc0FkZHJlc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FkZHJlc3MvaXNBZGRyZXNzLmpzIigpIHsKICAgICAgaW5pdF9scnUoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGFkZHJlc3NSZWdleCA9IC9eMHhbYS1mQS1GMC05XXs0MH0kLzsKICAgICAgaXNBZGRyZXNzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IExydU1hcCg4MTkyKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2RhdGEvY29uY2F0LmpzCiAgZnVuY3Rpb24gY29uY2F0KHZhbHVlcykgewogICAgaWYgKHR5cGVvZiB2YWx1ZXNbMF0gPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gY29uY2F0SGV4KHZhbHVlcyk7CiAgICByZXR1cm4gY29uY2F0Qnl0ZXMyKHZhbHVlcyk7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEJ5dGVzMih2YWx1ZXMpIHsKICAgIGxldCBsZW5ndGggPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIGxlbmd0aCArPSBhcnIubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChjb25zdCBhcnIgb2YgdmFsdWVzKSB7CiAgICAgIHJlc3VsdC5zZXQoYXJyLCBvZmZzZXQpOwogICAgICBvZmZzZXQgKz0gYXJyLmxlbmd0aDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGNvbmNhdEhleCh2YWx1ZXMpIHsKICAgIHJldHVybiBgMHgke3ZhbHVlcy5yZWR1Y2UoKGFjYywgeCkgPT4gYWNjICsgeC5yZXBsYWNlKCIweCIsICIiKSwgIiIpfWA7CiAgfQogIHZhciBpbml0X2NvbmNhdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9jb25jYXQuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9zbGljZS5qcwogIGZ1bmN0aW9uIHNsaWNlKHZhbHVlLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGlmIChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICByZXR1cm4gc2xpY2VIZXgodmFsdWUsIHN0YXJ0LCBlbmQsIHsKICAgICAgICBzdHJpY3QKICAgICAgfSk7CiAgICByZXR1cm4gc2xpY2VCeXRlcyh2YWx1ZSwgc3RhcnQsIGVuZCwgewogICAgICBzdHJpY3QKICAgIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZSwgc3RhcnQpIHsKICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICJudW1iZXIiICYmIHN0YXJ0ID4gMCAmJiBzdGFydCA+IHNpemUodmFsdWUpIC0gMSkKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBzdGFydCwKICAgICAgICBwb3NpdGlvbjogInN0YXJ0IiwKICAgICAgICBzaXplOiBzaXplKHZhbHVlKQogICAgICB9KTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKSB7CiAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAibnVtYmVyIiAmJiB0eXBlb2YgZW5kID09PSAibnVtYmVyIiAmJiBzaXplKHZhbHVlKSAhPT0gZW5kIC0gc3RhcnQpIHsKICAgICAgdGhyb3cgbmV3IFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcih7CiAgICAgICAgb2Zmc2V0OiBlbmQsCiAgICAgICAgcG9zaXRpb246ICJlbmQiLAogICAgICAgIHNpemU6IHNpemUodmFsdWUpCiAgICAgIH0pOwogICAgfQogIH0KICBmdW5jdGlvbiBzbGljZUJ5dGVzKHZhbHVlXywgc3RhcnQsIGVuZCwgeyBzdHJpY3QgfSA9IHt9KSB7CiAgICBhc3NlcnRTdGFydE9mZnNldCh2YWx1ZV8sIHN0YXJ0KTsKICAgIGNvbnN0IHZhbHVlID0gdmFsdWVfLnNsaWNlKHN0YXJ0LCBlbmQpOwogICAgaWYgKHN0cmljdCkKICAgICAgYXNzZXJ0RW5kT2Zmc2V0KHZhbHVlLCBzdGFydCwgZW5kKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgZnVuY3Rpb24gc2xpY2VIZXgodmFsdWVfLCBzdGFydCwgZW5kLCB7IHN0cmljdCB9ID0ge30pIHsKICAgIGFzc2VydFN0YXJ0T2Zmc2V0KHZhbHVlXywgc3RhcnQpOwogICAgY29uc3QgdmFsdWUgPSBgMHgke3ZhbHVlXy5yZXBsYWNlKCIweCIsICIiKS5zbGljZSgoc3RhcnQgPz8gMCkgKiAyLCAoZW5kID8/IHZhbHVlXy5sZW5ndGgpICogMil9YDsKICAgIGlmIChzdHJpY3QpCiAgICAgIGFzc2VydEVuZE9mZnNldCh2YWx1ZSwgc3RhcnQsIGVuZCk7CiAgICByZXR1cm4gdmFsdWU7CiAgfQogIHZhciBpbml0X3NsaWNlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9kYXRhL3NsaWNlLmpzIigpIHsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfaXNIZXgoKTsKICAgICAgaW5pdF9zaXplKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlQWJpUGFyYW1ldGVycy5qcwogIGZ1bmN0aW9uIGVuY29kZUFiaVBhcmFtZXRlcnMocGFyYW1zLCB2YWx1ZXMpIHsKICAgIGlmIChwYXJhbXMubGVuZ3RoICE9PSB2YWx1ZXMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogcGFyYW1zLmxlbmd0aCwKICAgICAgICBnaXZlbkxlbmd0aDogdmFsdWVzLmxlbmd0aAogICAgICB9KTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gcHJlcGFyZVBhcmFtcyh7CiAgICAgIHBhcmFtcywKICAgICAgdmFsdWVzCiAgICB9KTsKICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gIjB4IjsKICAgIHJldHVybiBkYXRhOwogIH0KICBmdW5jdGlvbiBwcmVwYXJlUGFyYW1zKHsgcGFyYW1zLCB2YWx1ZXMgfSkgewogICAgY29uc3QgcHJlcGFyZWRQYXJhbXMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZVBhcmFtKHsgcGFyYW06IHBhcmFtc1tpXSwgdmFsdWU6IHZhbHVlc1tpXSB9KSk7CiAgICB9CiAgICByZXR1cm4gcHJlcGFyZWRQYXJhbXM7CiAgfQogIGZ1bmN0aW9uIHByZXBhcmVQYXJhbSh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbTogeyAuLi5wYXJhbSwgdHlwZSB9IH0pOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIpIHsKICAgICAgcmV0dXJuIGVuY29kZVR1cGxlKHZhbHVlLCB7CiAgICAgICAgcGFyYW0KICAgICAgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIHJldHVybiBlbmNvZGVBZGRyZXNzKHZhbHVlKTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAiYm9vbCIpIHsKICAgICAgcmV0dXJuIGVuY29kZUJvb2wodmFsdWUpOwogICAgfQogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgidWludCIpIHx8IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50IikpIHsKICAgICAgY29uc3Qgc2lnbmVkID0gcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKTsKICAgICAgcmV0dXJuIGVuY29kZU51bWJlcih2YWx1ZSwgeyBzaWduZWQgfSk7CiAgICB9CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJieXRlcyIpKSB7CiAgICAgIHJldHVybiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikgewogICAgICByZXR1cm4gZW5jb2RlU3RyaW5nKHZhbHVlKTsKICAgIH0KICAgIHRocm93IG5ldyBJbnZhbGlkQWJpRW5jb2RpbmdUeXBlRXJyb3IocGFyYW0udHlwZSwgewogICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L2VuY29kZUFiaVBhcmFtZXRlcnMiCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSB7CiAgICBsZXQgc3RhdGljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKQogICAgICAgIHN0YXRpY1NpemUgKz0gMzI7CiAgICAgIGVsc2UKICAgICAgICBzdGF0aWNTaXplICs9IHNpemUoZW5jb2RlZCk7CiAgICB9CiAgICBjb25zdCBzdGF0aWNQYXJhbXMgPSBbXTsKICAgIGNvbnN0IGR5bmFtaWNQYXJhbXMgPSBbXTsKICAgIGxldCBkeW5hbWljU2l6ZSA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXBhcmVkUGFyYW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgZHluYW1pYywgZW5jb2RlZCB9ID0gcHJlcGFyZWRQYXJhbXNbaV07CiAgICAgIGlmIChkeW5hbWljKSB7CiAgICAgICAgc3RhdGljUGFyYW1zLnB1c2gobnVtYmVyVG9IZXgoc3RhdGljU2l6ZSArIGR5bmFtaWNTaXplLCB7IHNpemU6IDMyIH0pKTsKICAgICAgICBkeW5hbWljUGFyYW1zLnB1c2goZW5jb2RlZCk7CiAgICAgICAgZHluYW1pY1NpemUgKz0gc2l6ZShlbmNvZGVkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdGF0aWNQYXJhbXMucHVzaChlbmNvZGVkKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbmNhdChbLi4uc3RhdGljUGFyYW1zLCAuLi5keW5hbWljUGFyYW1zXSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFkZHJlc3ModmFsdWUpIHsKICAgIGlmICghaXNBZGRyZXNzKHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgIHJldHVybiB7IGR5bmFtaWM6IGZhbHNlLCBlbmNvZGVkOiBwYWRIZXgodmFsdWUudG9Mb3dlckNhc2UoKSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQXJyYXkodmFsdWUsIHsgbGVuZ3RoLCBwYXJhbSB9KSB7CiAgICBjb25zdCBkeW5hbWljID0gbGVuZ3RoID09PSBudWxsOwogICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBcnJheUVycm9yKHZhbHVlKTsKICAgIGlmICghZHluYW1pYyAmJiB2YWx1ZS5sZW5ndGggIT09IGxlbmd0aCkKICAgICAgdGhyb3cgbmV3IEFiaUVuY29kaW5nQXJyYXlMZW5ndGhNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZExlbmd0aDogbGVuZ3RoLAogICAgICAgIGdpdmVuTGVuZ3RoOiB2YWx1ZS5sZW5ndGgsCiAgICAgICAgdHlwZTogYCR7cGFyYW0udHlwZX1bJHtsZW5ndGh9XWAKICAgICAgfSk7CiAgICBsZXQgZHluYW1pY0NoaWxkID0gZmFsc2U7CiAgICBjb25zdCBwcmVwYXJlZFBhcmFtcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBwcmVwYXJlZFBhcmFtID0gcHJlcGFyZVBhcmFtKHsgcGFyYW0sIHZhbHVlOiB2YWx1ZVtpXSB9KTsKICAgICAgaWYgKHByZXBhcmVkUGFyYW0uZHluYW1pYykKICAgICAgICBkeW5hbWljQ2hpbGQgPSB0cnVlOwogICAgICBwcmVwYXJlZFBhcmFtcy5wdXNoKHByZXBhcmVkUGFyYW0pOwogICAgfQogICAgaWYgKGR5bmFtaWMgfHwgZHluYW1pY0NoaWxkKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBlbmNvZGVQYXJhbXMocHJlcGFyZWRQYXJhbXMpOwogICAgICBpZiAoZHluYW1pYykgewogICAgICAgIGNvbnN0IGxlbmd0aDIgPSBudW1iZXJUb0hleChwcmVwYXJlZFBhcmFtcy5sZW5ndGgsIHsgc2l6ZTogMzIgfSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgICBlbmNvZGVkOiBwcmVwYXJlZFBhcmFtcy5sZW5ndGggPiAwID8gY29uY2F0KFtsZW5ndGgyLCBkYXRhXSkgOiBsZW5ndGgyCiAgICAgICAgfTsKICAgICAgfQogICAgICBpZiAoZHluYW1pY0NoaWxkKQogICAgICAgIHJldHVybiB7IGR5bmFtaWM6IHRydWUsIGVuY29kZWQ6IGRhdGEgfTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBjb25jYXQocHJlcGFyZWRQYXJhbXMubWFwKCh7IGVuY29kZWQgfSkgPT4gZW5jb2RlZCkpCiAgICB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVCeXRlcyh2YWx1ZSwgeyBwYXJhbSB9KSB7CiAgICBjb25zdCBbLCBwYXJhbVNpemVdID0gcGFyYW0udHlwZS5zcGxpdCgiYnl0ZXMiKTsKICAgIGNvbnN0IGJ5dGVzU2l6ZSA9IHNpemUodmFsdWUpOwogICAgaWYgKCFwYXJhbVNpemUpIHsKICAgICAgbGV0IHZhbHVlXyA9IHZhbHVlOwogICAgICBpZiAoYnl0ZXNTaXplICUgMzIgIT09IDApCiAgICAgICAgdmFsdWVfID0gcGFkSGV4KHZhbHVlXywgewogICAgICAgICAgZGlyOiAicmlnaHQiLAogICAgICAgICAgc2l6ZTogTWF0aC5jZWlsKCh2YWx1ZS5sZW5ndGggLSAyKSAvIDIgLyAzMikgKiAzMgogICAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgICAgZW5jb2RlZDogY29uY2F0KFtwYWRIZXgobnVtYmVyVG9IZXgoYnl0ZXNTaXplLCB7IHNpemU6IDMyIH0pKSwgdmFsdWVfXSkKICAgICAgfTsKICAgIH0KICAgIGlmIChieXRlc1NpemUgIT09IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpKQogICAgICB0aHJvdyBuZXcgQWJpRW5jb2RpbmdCeXRlc1NpemVNaXNtYXRjaEVycm9yKHsKICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChwYXJhbVNpemUpLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIgfSkgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlQm9vbCh2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMihgSW52YWxpZCBib29sZWFuIHZhbHVlOiAiJHt2YWx1ZX0iICh0eXBlOiAke3R5cGVvZiB2YWx1ZX0pLiBFeHBlY3RlZDogXGB0cnVlXGAgb3IgXGBmYWxzZVxgLmApOwogICAgcmV0dXJuIHsgZHluYW1pYzogZmFsc2UsIGVuY29kZWQ6IHBhZEhleChib29sVG9IZXgodmFsdWUpKSB9OwogIH0KICBmdW5jdGlvbiBlbmNvZGVOdW1iZXIodmFsdWUsIHsgc2lnbmVkIH0pIHsKICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IGZhbHNlLAogICAgICBlbmNvZGVkOiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IDMyLAogICAgICAgIHNpZ25lZAogICAgICB9KQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlU3RyaW5nKHZhbHVlKSB7CiAgICBjb25zdCBoZXhWYWx1ZSA9IHN0cmluZ1RvSGV4KHZhbHVlKTsKICAgIGNvbnN0IHBhcnRzTGVuZ3RoID0gTWF0aC5jZWlsKHNpemUoaGV4VmFsdWUpIC8gMzIpOwogICAgY29uc3QgcGFydHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFydHNMZW5ndGg7IGkrKykgewogICAgICBwYXJ0cy5wdXNoKHBhZEhleChzbGljZShoZXhWYWx1ZSwgaSAqIDMyLCAoaSArIDEpICogMzIpLCB7CiAgICAgICAgZGlyOiAicmlnaHQiCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGR5bmFtaWM6IHRydWUsCiAgICAgIGVuY29kZWQ6IGNvbmNhdChbCiAgICAgICAgcGFkSGV4KG51bWJlclRvSGV4KHNpemUoaGV4VmFsdWUpLCB7IHNpemU6IDMyIH0pKSwKICAgICAgICAuLi5wYXJ0cwogICAgICBdKQogICAgfTsKICB9CiAgZnVuY3Rpb24gZW5jb2RlVHVwbGUodmFsdWUsIHsgcGFyYW0gfSkgewogICAgbGV0IGR5bmFtaWMgPSBmYWxzZTsKICAgIGNvbnN0IHByZXBhcmVkUGFyYW1zID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcGFyYW1fID0gcGFyYW0uY29tcG9uZW50c1tpXTsKICAgICAgY29uc3QgaW5kZXgyID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBpIDogcGFyYW1fLm5hbWU7CiAgICAgIGNvbnN0IHByZXBhcmVkUGFyYW0gPSBwcmVwYXJlUGFyYW0oewogICAgICAgIHBhcmFtOiBwYXJhbV8sCiAgICAgICAgdmFsdWU6IHZhbHVlW2luZGV4Ml0KICAgICAgfSk7CiAgICAgIHByZXBhcmVkUGFyYW1zLnB1c2gocHJlcGFyZWRQYXJhbSk7CiAgICAgIGlmIChwcmVwYXJlZFBhcmFtLmR5bmFtaWMpCiAgICAgICAgZHluYW1pYyA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gewogICAgICBkeW5hbWljLAogICAgICBlbmNvZGVkOiBkeW5hbWljID8gZW5jb2RlUGFyYW1zKHByZXBhcmVkUGFyYW1zKSA6IGNvbmNhdChwcmVwYXJlZFBhcmFtcy5tYXAoKHsgZW5jb2RlZCB9KSA9PiBlbmNvZGVkKSkKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldEFycmF5Q29tcG9uZW50cyh0eXBlKSB7CiAgICBjb25zdCBtYXRjaGVzID0gdHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pOwogICAgcmV0dXJuIG1hdGNoZXMgPyAoCiAgICAgIC8vIFJldHVybiBgbnVsbGAgaWYgdGhlIGFycmF5IGlzIGR5bmFtaWMuCiAgICAgIFttYXRjaGVzWzJdID8gTnVtYmVyKG1hdGNoZXNbMl0pIDogbnVsbCwgbWF0Y2hlc1sxXV0KICAgICkgOiB2b2lkIDA7CiAgfQogIHZhciBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X3BhZCgpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcwogIHZhciB0b0Z1bmN0aW9uU2VsZWN0b3I7CiAgdmFyIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3RvRnVuY3Rpb25TZWxlY3Rvci5qcyIoKSB7CiAgICAgIGluaXRfc2xpY2UoKTsKICAgICAgaW5pdF90b1NpZ25hdHVyZUhhc2goKTsKICAgICAgdG9GdW5jdGlvblNlbGVjdG9yID0gKGZuKSA9PiBzbGljZSh0b1NpZ25hdHVyZUhhc2goZm4pLCAwLCA0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9nZXRBYmlJdGVtLmpzCiAgZnVuY3Rpb24gZ2V0QWJpSXRlbShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncyA9IFtdLCBuYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaXNTZWxlY3RvciA9IGlzSGV4KG5hbWUsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgIGNvbnN0IGFiaUl0ZW1zID0gYWJpMi5maWx0ZXIoKGFiaUl0ZW0pID0+IHsKICAgICAgaWYgKGlzU2VsZWN0b3IpIHsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgICAgcmV0dXJuIHRvRnVuY3Rpb25TZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICBpZiAoYWJpSXRlbS50eXBlID09PSAiZXZlbnQiKQogICAgICAgICAgcmV0dXJuIHRvRXZlbnRTZWxlY3RvcihhYmlJdGVtKSA9PT0gbmFtZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuICJuYW1lIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0ubmFtZSA9PT0gbmFtZTsKICAgIH0pOwogICAgaWYgKGFiaUl0ZW1zLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGlmIChhYmlJdGVtcy5sZW5ndGggPT09IDEpCiAgICAgIHJldHVybiBhYmlJdGVtc1swXTsKICAgIGxldCBtYXRjaGVkQWJpSXRlbSA9IHZvaWQgMDsKICAgIGZvciAoY29uc3QgYWJpSXRlbSBvZiBhYmlJdGVtcykgewogICAgICBpZiAoISgiaW5wdXRzIiBpbiBhYmlJdGVtKSkKICAgICAgICBjb250aW51ZTsKICAgICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKSB7CiAgICAgICAgaWYgKCFhYmlJdGVtLmlucHV0cyB8fCBhYmlJdGVtLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgICAgICByZXR1cm4gYWJpSXRlbTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBpZiAoYWJpSXRlbS5pbnB1dHMubGVuZ3RoICE9PSBhcmdzLmxlbmd0aCkKICAgICAgICBjb250aW51ZTsKICAgICAgY29uc3QgbWF0Y2hlZCA9IGFyZ3MuZXZlcnkoKGFyZywgaW5kZXgyKSA9PiB7CiAgICAgICAgY29uc3QgYWJpUGFyYW1ldGVyID0gImlucHV0cyIgaW4gYWJpSXRlbSAmJiBhYmlJdGVtLmlucHV0c1tpbmRleDJdOwogICAgICAgIGlmICghYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcik7CiAgICAgIH0pOwogICAgICBpZiAobWF0Y2hlZCkgewogICAgICAgIGlmIChtYXRjaGVkQWJpSXRlbSAmJiAiaW5wdXRzIiBpbiBtYXRjaGVkQWJpSXRlbSAmJiBtYXRjaGVkQWJpSXRlbS5pbnB1dHMpIHsKICAgICAgICAgIGNvbnN0IGFtYmlndW91c1R5cGVzID0gZ2V0QW1iaWd1b3VzVHlwZXMoYWJpSXRlbS5pbnB1dHMsIG1hdGNoZWRBYmlJdGVtLmlucHV0cywgYXJncyk7CiAgICAgICAgICBpZiAoYW1iaWd1b3VzVHlwZXMpCiAgICAgICAgICAgIHRocm93IG5ldyBBYmlJdGVtQW1iaWd1aXR5RXJyb3IoewogICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgdHlwZTogYW1iaWd1b3VzVHlwZXNbMF0KICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgIGFiaUl0ZW06IG1hdGNoZWRBYmlJdGVtLAogICAgICAgICAgICAgIHR5cGU6IGFtYmlndW91c1R5cGVzWzFdCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBtYXRjaGVkQWJpSXRlbSA9IGFiaUl0ZW07CiAgICAgIH0KICAgIH0KICAgIGlmIChtYXRjaGVkQWJpSXRlbSkKICAgICAgcmV0dXJuIG1hdGNoZWRBYmlJdGVtOwogICAgcmV0dXJuIGFiaUl0ZW1zWzBdOwogIH0KICBmdW5jdGlvbiBpc0FyZ09mVHlwZShhcmcsIGFiaVBhcmFtZXRlcikgewogICAgY29uc3QgYXJnVHlwZSA9IHR5cGVvZiBhcmc7CiAgICBjb25zdCBhYmlQYXJhbWV0ZXJUeXBlID0gYWJpUGFyYW1ldGVyLnR5cGU7CiAgICBzd2l0Y2ggKGFiaVBhcmFtZXRlclR5cGUpIHsKICAgICAgY2FzZSAiYWRkcmVzcyI6CiAgICAgICAgcmV0dXJuIGlzQWRkcmVzcyhhcmcsIHsgc3RyaWN0OiBmYWxzZSB9KTsKICAgICAgY2FzZSAiYm9vbCI6CiAgICAgICAgcmV0dXJuIGFyZ1R5cGUgPT09ICJib29sZWFuIjsKICAgICAgY2FzZSAiZnVuY3Rpb24iOgogICAgICAgIHJldHVybiBhcmdUeXBlID09PSAic3RyaW5nIjsKICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyI7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBpZiAoYWJpUGFyYW1ldGVyVHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gYWJpUGFyYW1ldGVyKQogICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoYWJpUGFyYW1ldGVyLmNvbXBvbmVudHMpLmV2ZXJ5KChjb21wb25lbnQsIGluZGV4MikgPT4gewogICAgICAgICAgICByZXR1cm4gaXNBcmdPZlR5cGUoT2JqZWN0LnZhbHVlcyhhcmcpW2luZGV4Ml0sIGNvbXBvbmVudCk7CiAgICAgICAgICB9KTsKICAgICAgICBpZiAoL151P2ludCg4fDE2fDI0fDMyfDQwfDQ4fDU2fDY0fDcyfDgwfDg4fDk2fDEwNHwxMTJ8MTIwfDEyOHwxMzZ8MTQ0fDE1MnwxNjB8MTY4fDE3NnwxODR8MTkyfDIwMHwyMDh8MjE2fDIyNHwyMzJ8MjQwfDI0OHwyNTYpPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gIm51bWJlciIgfHwgYXJnVHlwZSA9PT0gImJpZ2ludCI7CiAgICAgICAgaWYgKC9eYnl0ZXMoWzEtOV18MVswLTldfDJbMC05XXwzWzAtMl0pPyQvLnRlc3QoYWJpUGFyYW1ldGVyVHlwZSkpCiAgICAgICAgICByZXR1cm4gYXJnVHlwZSA9PT0gInN0cmluZyIgfHwgYXJnIGluc3RhbmNlb2YgVWludDhBcnJheTsKICAgICAgICBpZiAoL1thLXpdK1sxLTldezAsM30oXFtbMC05XXswLH1cXSkrJC8udGVzdChhYmlQYXJhbWV0ZXJUeXBlKSkgewogICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXJnKSAmJiBhcmcuZXZlcnkoKHgpID0+IGlzQXJnT2ZUeXBlKHgsIHsKICAgICAgICAgICAgLi4uYWJpUGFyYW1ldGVyLAogICAgICAgICAgICAvLyBQb3Agb2ZmIGBbXWAgb3IgYFtNXWAgZnJvbSBlbmQgb2YgdHlwZQogICAgICAgICAgICB0eXBlOiBhYmlQYXJhbWV0ZXJUeXBlLnJlcGxhY2UoLyhcW1swLTldezAsfVxdKSQvLCAiIikKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlcnMsIHRhcmdldFBhcmFtZXRlcnMsIGFyZ3MpIHsKICAgIGZvciAoY29uc3QgcGFyYW1ldGVySW5kZXggaW4gc291cmNlUGFyYW1ldGVycykgewogICAgICBjb25zdCBzb3VyY2VQYXJhbWV0ZXIgPSBzb3VyY2VQYXJhbWV0ZXJzW3BhcmFtZXRlckluZGV4XTsKICAgICAgY29uc3QgdGFyZ2V0UGFyYW1ldGVyID0gdGFyZ2V0UGFyYW1ldGVyc1twYXJhbWV0ZXJJbmRleF07CiAgICAgIGlmIChzb3VyY2VQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiB0YXJnZXRQYXJhbWV0ZXIudHlwZSA9PT0gInR1cGxlIiAmJiAiY29tcG9uZW50cyIgaW4gc291cmNlUGFyYW1ldGVyICYmICJjb21wb25lbnRzIiBpbiB0YXJnZXRQYXJhbWV0ZXIpCiAgICAgICAgcmV0dXJuIGdldEFtYmlndW91c1R5cGVzKHNvdXJjZVBhcmFtZXRlci5jb21wb25lbnRzLCB0YXJnZXRQYXJhbWV0ZXIuY29tcG9uZW50cywgYXJnc1twYXJhbWV0ZXJJbmRleF0pOwogICAgICBjb25zdCB0eXBlcyA9IFtzb3VyY2VQYXJhbWV0ZXIudHlwZSwgdGFyZ2V0UGFyYW1ldGVyLnR5cGVdOwogICAgICBjb25zdCBhbWJpZ3VvdXMgPSAoKCkgPT4gewogICAgICAgIGlmICh0eXBlcy5pbmNsdWRlcygiYWRkcmVzcyIpICYmIHR5cGVzLmluY2x1ZGVzKCJieXRlczIwIikpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAodHlwZXMuaW5jbHVkZXMoImFkZHJlc3MiKSAmJiB0eXBlcy5pbmNsdWRlcygic3RyaW5nIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgaWYgKHR5cGVzLmluY2x1ZGVzKCJhZGRyZXNzIikgJiYgdHlwZXMuaW5jbHVkZXMoImJ5dGVzIikpCiAgICAgICAgICByZXR1cm4gaXNBZGRyZXNzKGFyZ3NbcGFyYW1ldGVySW5kZXhdLCB7IHN0cmljdDogZmFsc2UgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KSgpOwogICAgICBpZiAoYW1iaWd1b3VzKQogICAgICAgIHJldHVybiB0eXBlczsKICAgIH0KICAgIHJldHVybjsKICB9CiAgdmFyIGluaXRfZ2V0QWJpSXRlbSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2dldEFiaUl0ZW0uanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2lzSGV4KCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9wYXJzZUFjY291bnQuanMKICBmdW5jdGlvbiBwYXJzZUFjY291bnQoYWNjb3VudCkgewogICAgaWYgKHR5cGVvZiBhY2NvdW50ID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIHsgYWRkcmVzczogYWNjb3VudCwgdHlwZTogImpzb24tcnBjIiB9OwogICAgcmV0dXJuIGFjY291bnQ7CiAgfQogIHZhciBpbml0X3BhcnNlQWNjb3VudCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcGFyc2VBY2NvdW50LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhLmpzCiAgZnVuY3Rpb24gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7CiAgICAgICAgYWJpOiBhYmkyLAogICAgICAgIGFyZ3MsCiAgICAgICAgbmFtZTogZnVuY3Rpb25OYW1lCiAgICAgIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoMiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGgyIH0pOwogICAgcmV0dXJuIHsKICAgICAgYWJpOiBbYWJpSXRlbV0sCiAgICAgIGZ1bmN0aW9uTmFtZTogdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pKQogICAgfTsKICB9CiAgdmFyIGRvY3NQYXRoMjsKICB2YXIgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YS5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGRvY3NQYXRoMiA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVGdW5jdGlvbkRhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uRGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lIH0gPSAoKCkgPT4gewogICAgICBpZiAocGFyYW1ldGVycy5hYmkubGVuZ3RoID09PSAxICYmIHBhcmFtZXRlcnMuZnVuY3Rpb25OYW1lPy5zdGFydHNXaXRoKCIweCIpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzOwogICAgICByZXR1cm4gcHJlcGFyZUVuY29kZUZ1bmN0aW9uRGF0YShwYXJhbWV0ZXJzKTsKICAgIH0pKCk7CiAgICBjb25zdCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IGZ1bmN0aW9uTmFtZTsKICAgIGNvbnN0IGRhdGEgPSAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzID8gZW5jb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLmlucHV0cywgYXJncyA/PyBbXSkgOiB2b2lkIDA7CiAgICByZXR1cm4gY29uY2F0SGV4KFtzaWduYXR1cmUsIGRhdGEgPz8gIjB4Il0pOwogIH0KICB2YXIgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVGdW5jdGlvbkRhdGEuanMiKCkgewogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMKICB2YXIgcGFuaWNSZWFzb25zLCBzb2xpZGl0eUVycm9yLCBzb2xpZGl0eVBhbmljOwogIHZhciBpbml0X3NvbGlkaXR5ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvc29saWRpdHkuanMiKCkgewogICAgICBwYW5pY1JlYXNvbnMgPSB7CiAgICAgICAgMTogIkFuIGBhc3NlcnRgIGNvbmRpdGlvbiBmYWlsZWQuIiwKICAgICAgICAxNzogIkFyaXRobWV0aWMgb3BlcmF0aW9uIHJlc3VsdGVkIGluIHVuZGVyZmxvdyBvciBvdmVyZmxvdy4iLAogICAgICAgIDE4OiAiRGl2aXNpb24gb3IgbW9kdWxvIGJ5IHplcm8gKGUuZy4gYDUgLyAwYCBvciBgMjMgJSAwYCkuIiwKICAgICAgICAzMzogIkF0dGVtcHRlZCB0byBjb252ZXJ0IHRvIGFuIGludmFsaWQgdHlwZS4iLAogICAgICAgIDM0OiAiQXR0ZW1wdGVkIHRvIGFjY2VzcyBhIHN0b3JhZ2UgYnl0ZSBhcnJheSB0aGF0IGlzIGluY29ycmVjdGx5IGVuY29kZWQuIiwKICAgICAgICA0OTogIlBlcmZvcm1lZCBgLnBvcCgpYCBvbiBhbiBlbXB0eSBhcnJheSIsCiAgICAgICAgNTA6ICJBcnJheSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLiIsCiAgICAgICAgNjU6ICJBbGxvY2F0ZWQgdG9vIG11Y2ggbWVtb3J5IG9yIGNyZWF0ZWQgYW4gYXJyYXkgd2hpY2ggaXMgdG9vIGxhcmdlLiIsCiAgICAgICAgODE6ICJBdHRlbXB0ZWQgdG8gY2FsbCBhIHplcm8taW5pdGlhbGl6ZWQgdmFyaWFibGUgb2YgaW50ZXJuYWwgZnVuY3Rpb24gdHlwZS4iCiAgICAgIH07CiAgICAgIHNvbGlkaXR5RXJyb3IgPSB7CiAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICJtZXNzYWdlIiwKICAgICAgICAgICAgdHlwZTogInN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFcnJvciIsCiAgICAgICAgdHlwZTogImVycm9yIgogICAgICB9OwogICAgICBzb2xpZGl0eVBhbmljID0gewogICAgICAgIGlucHV0czogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAicmVhc29uIiwKICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBuYW1lOiAiUGFuaWMiLAogICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jdXJzb3IuanMKICB2YXIgTmVnYXRpdmVPZmZzZXRFcnJvciwgUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yLCBSZWN1cnNpdmVSZWFkTGltaXRFeGNlZWRlZEVycm9yOwogIHZhciBpbml0X2N1cnNvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBOZWdhdGl2ZU9mZnNldEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IG9mZnNldCB9KSB7CiAgICAgICAgICBzdXBlcihgT2Zmc2V0IFxgJHtvZmZzZXR9XGAgY2Fubm90IGJlIG5lZ2F0aXZlLmAsIHsKICAgICAgICAgICAgbmFtZTogIk5lZ2F0aXZlT2Zmc2V0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFBvc2l0aW9uT3V0T2ZCb3VuZHNFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBsZW5ndGgsIHBvc2l0aW9uIH0pIHsKICAgICAgICAgIHN1cGVyKGBQb3NpdGlvbiBcYCR7cG9zaXRpb259XGAgaXMgb3V0IG9mIGJvdW5kcyAoXGAwIDwgcG9zaXRpb24gPCAke2xlbmd0aH1cYCkuYCwgeyBuYW1lOiAiUG9zaXRpb25PdXRPZkJvdW5kc0Vycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY291bnQsIGxpbWl0IH0pIHsKICAgICAgICAgIHN1cGVyKGBSZWN1cnNpdmUgcmVhZCBsaW1pdCBvZiBcYCR7bGltaXR9XGAgZXhjZWVkZWQgKHJlY3Vyc2l2ZSByZWFkIGNvdW50OiBcYCR7Y291bnR9XGApLmAsIHsgbmFtZTogIlJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUN1cnNvcihieXRlczIsIHsgcmVjdXJzaXZlUmVhZExpbWl0ID0gODE5MiB9ID0ge30pIHsKICAgIGNvbnN0IGN1cnNvciA9IE9iamVjdC5jcmVhdGUoc3RhdGljQ3Vyc29yKTsKICAgIGN1cnNvci5ieXRlcyA9IGJ5dGVzMjsKICAgIGN1cnNvci5kYXRhVmlldyA9IG5ldyBEYXRhVmlldyhieXRlczIuYnVmZmVyLCBieXRlczIuYnl0ZU9mZnNldCwgYnl0ZXMyLmJ5dGVMZW5ndGgpOwogICAgY3Vyc29yLnBvc2l0aW9uUmVhZENvdW50ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGN1cnNvci5yZWN1cnNpdmVSZWFkTGltaXQgPSByZWN1cnNpdmVSZWFkTGltaXQ7CiAgICByZXR1cm4gY3Vyc29yOwogIH0KICB2YXIgc3RhdGljQ3Vyc29yOwogIHZhciBpbml0X2N1cnNvcjIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2N1cnNvci5qcyIoKSB7CiAgICAgIGluaXRfY3Vyc29yKCk7CiAgICAgIHN0YXRpY0N1cnNvciA9IHsKICAgICAgICBieXRlczogbmV3IFVpbnQ4QXJyYXkoKSwKICAgICAgICBkYXRhVmlldzogbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigwKSksCiAgICAgICAgcG9zaXRpb246IDAsCiAgICAgICAgcG9zaXRpb25SZWFkQ291bnQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksCiAgICAgICAgcmVjdXJzaXZlUmVhZENvdW50OiAwLAogICAgICAgIHJlY3Vyc2l2ZVJlYWRMaW1pdDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLAogICAgICAgIGFzc2VydFJlYWRMaW1pdCgpIHsKICAgICAgICAgIGlmICh0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCA+PSB0aGlzLnJlY3Vyc2l2ZVJlYWRMaW1pdCkKICAgICAgICAgICAgdGhyb3cgbmV3IFJlY3Vyc2l2ZVJlYWRMaW1pdEV4Y2VlZGVkRXJyb3IoewogICAgICAgICAgICAgIGNvdW50OiB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCArIDEsCiAgICAgICAgICAgICAgbGltaXQ6IHRoaXMucmVjdXJzaXZlUmVhZExpbWl0CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pIHsKICAgICAgICAgIGlmIChwb3NpdGlvbiA8IDAgfHwgcG9zaXRpb24gPiB0aGlzLmJ5dGVzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgIHRocm93IG5ldyBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IoewogICAgICAgICAgICAgIGxlbmd0aDogdGhpcy5ieXRlcy5sZW5ndGgsCiAgICAgICAgICAgICAgcG9zaXRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBkZWNyZW1lbnRQb3NpdGlvbihvZmZzZXQpIHsKICAgICAgICAgIGlmIChvZmZzZXQgPCAwKQogICAgICAgICAgICB0aHJvdyBuZXcgTmVnYXRpdmVPZmZzZXRFcnJvcih7IG9mZnNldCB9KTsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbiAtIG9mZnNldDsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24pOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgZ2V0UmVhZENvdW50KHBvc2l0aW9uKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvblJlYWRDb3VudC5nZXQocG9zaXRpb24gfHwgdGhpcy5wb3NpdGlvbikgfHwgMDsKICAgICAgICB9LAogICAgICAgIGluY3JlbWVudFBvc2l0aW9uKG9mZnNldCkgewogICAgICAgICAgaWYgKG9mZnNldCA8IDApCiAgICAgICAgICAgIHRocm93IG5ldyBOZWdhdGl2ZU9mZnNldEVycm9yKHsgb2Zmc2V0IH0pOwogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uICsgb2Zmc2V0OwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0Qnl0ZShwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzW3Bvc2l0aW9uXTsKICAgICAgICB9LAogICAgICAgIGluc3BlY3RCeXRlcyhsZW5ndGgsIHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyBsZW5ndGggLSAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLnN1YmFycmF5KHBvc2l0aW9uLCBwb3NpdGlvbiArIGxlbmd0aCk7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDgocG9zaXRpb25fKSB7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHBvc2l0aW9uXyA/PyB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICByZXR1cm4gdGhpcy5ieXRlc1twb3NpdGlvbl07CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDE2KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAxKTsKICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFWaWV3LmdldFVpbnQxNihwb3NpdGlvbik7CiAgICAgICAgfSwKICAgICAgICBpbnNwZWN0VWludDI0KHBvc2l0aW9uXykgewogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3NpdGlvbl8gPz8gdGhpcy5wb3NpdGlvbjsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24ocG9zaXRpb24gKyAyKTsKICAgICAgICAgIHJldHVybiAodGhpcy5kYXRhVmlldy5nZXRVaW50MTYocG9zaXRpb24pIDw8IDgpICsgdGhpcy5kYXRhVmlldy5nZXRVaW50OChwb3NpdGlvbiArIDIpOwogICAgICAgIH0sCiAgICAgICAgaW5zcGVjdFVpbnQzMihwb3NpdGlvbl8pIHsKICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zaXRpb25fID8/IHRoaXMucG9zaXRpb247CiAgICAgICAgICB0aGlzLmFzc2VydFBvc2l0aW9uKHBvc2l0aW9uICsgMyk7CiAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhVmlldy5nZXRVaW50MzIocG9zaXRpb24pOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGUoYnl0ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSBieXRlOwogICAgICAgICAgdGhpcy5wb3NpdGlvbisrOwogICAgICAgIH0sCiAgICAgICAgcHVzaEJ5dGVzKGJ5dGVzMikgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgYnl0ZXMyLmxlbmd0aCAtIDEpOwogICAgICAgICAgdGhpcy5ieXRlcy5zZXQoYnl0ZXMyLCB0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gYnl0ZXMyLmxlbmd0aDsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50OCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uKTsKICAgICAgICAgIHRoaXMuYnl0ZXNbdGhpcy5wb3NpdGlvbl0gPSB2YWx1ZTsKICAgICAgICAgIHRoaXMucG9zaXRpb24rKzsKICAgICAgICB9LAogICAgICAgIHB1c2hVaW50MTYodmFsdWUpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UG9zaXRpb24odGhpcy5wb3NpdGlvbiArIDEpOwogICAgICAgICAgdGhpcy5kYXRhVmlldy5zZXRVaW50MTYodGhpcy5wb3NpdGlvbiwgdmFsdWUpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAyOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQyNCh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMik7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQxNih0aGlzLnBvc2l0aW9uLCB2YWx1ZSA+PiA4KTsKICAgICAgICAgIHRoaXMuZGF0YVZpZXcuc2V0VWludDgodGhpcy5wb3NpdGlvbiArIDIsIHZhbHVlICYgfjQyOTQ5NjcwNDApOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAzOwogICAgICAgIH0sCiAgICAgICAgcHVzaFVpbnQzMih2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbih0aGlzLnBvc2l0aW9uICsgMyk7CiAgICAgICAgICB0aGlzLmRhdGFWaWV3LnNldFVpbnQzMih0aGlzLnBvc2l0aW9uLCB2YWx1ZSk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDQ7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZSgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RCeXRlKCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uKys7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkQnl0ZXMobGVuZ3RoLCBzaXplMykgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdEJ5dGVzKGxlbmd0aCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IHNpemUzID8/IGxlbmd0aDsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50OCgpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50OCgpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSAxOwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgcmVhZFVpbnQxNigpIHsKICAgICAgICAgIHRoaXMuYXNzZXJ0UmVhZExpbWl0KCk7CiAgICAgICAgICB0aGlzLl90b3VjaCgpOwogICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluc3BlY3RVaW50MTYoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb24gKz0gMjsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9LAogICAgICAgIHJlYWRVaW50MjQoKSB7CiAgICAgICAgICB0aGlzLmFzc2VydFJlYWRMaW1pdCgpOwogICAgICAgICAgdGhpcy5fdG91Y2goKTsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5pbnNwZWN0VWludDI0KCk7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uICs9IDM7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSwKICAgICAgICByZWFkVWludDMyKCkgewogICAgICAgICAgdGhpcy5hc3NlcnRSZWFkTGltaXQoKTsKICAgICAgICAgIHRoaXMuX3RvdWNoKCk7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuaW5zcGVjdFVpbnQzMigpOwogICAgICAgICAgdGhpcy5wb3NpdGlvbiArPSA0OwogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgZ2V0IHJlbWFpbmluZygpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMucG9zaXRpb247CiAgICAgICAgfSwKICAgICAgICBzZXRQb3NpdGlvbihwb3NpdGlvbikgewogICAgICAgICAgY29uc3Qgb2xkUG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uOwogICAgICAgICAgdGhpcy5hc3NlcnRQb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgICByZXR1cm4gKCkgPT4gdGhpcy5wb3NpdGlvbiA9IG9sZFBvc2l0aW9uOwogICAgICAgIH0sCiAgICAgICAgX3RvdWNoKCkgewogICAgICAgICAgaWYgKHRoaXMucmVjdXJzaXZlUmVhZExpbWl0ID09PSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIGNvbnN0IGNvdW50ID0gdGhpcy5nZXRSZWFkQ291bnQoKTsKICAgICAgICAgIHRoaXMucG9zaXRpb25SZWFkQ291bnQuc2V0KHRoaXMucG9zaXRpb24sIGNvdW50ICsgMSk7CiAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAgICB0aGlzLnJlY3Vyc2l2ZVJlYWRDb3VudCsrOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL2Zyb21CeXRlcy5qcwogIGZ1bmN0aW9uIGZyb21CeXRlcyhieXRlczIsIHRvT3JPcHRzKSB7CiAgICBjb25zdCBvcHRzID0gdHlwZW9mIHRvT3JPcHRzID09PSAic3RyaW5nIiA/IHsgdG86IHRvT3JPcHRzIH0gOiB0b09yT3B0czsKICAgIGNvbnN0IHRvID0gb3B0cy50bzsKICAgIGlmICh0byA9PT0gIm51bWJlciIpCiAgICAgIHJldHVybiBieXRlc1RvTnVtYmVyKGJ5dGVzMiwgb3B0cyk7CiAgICBpZiAodG8gPT09ICJiaWdpbnQiKQogICAgICByZXR1cm4gYnl0ZXNUb0JpZ0ludChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAiYm9vbGVhbiIpCiAgICAgIHJldHVybiBieXRlc1RvQm9vbChieXRlczIsIG9wdHMpOwogICAgaWYgKHRvID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGJ5dGVzVG9TdHJpbmcoYnl0ZXMyLCBvcHRzKTsKICAgIHJldHVybiBieXRlc1RvSGV4KGJ5dGVzMiwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9CaWdJbnQoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvQmlnSW50KGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9Cb29sKGJ5dGVzXywgb3B0cyA9IHt9KSB7CiAgICBsZXQgYnl0ZXMyID0gYnl0ZXNfOwogICAgaWYgKHR5cGVvZiBvcHRzLnNpemUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGFzc2VydFNpemUoYnl0ZXMyLCB7IHNpemU6IG9wdHMuc2l6ZSB9KTsKICAgICAgYnl0ZXMyID0gdHJpbShieXRlczIpOwogICAgfQogICAgaWYgKGJ5dGVzMi5sZW5ndGggPiAxIHx8IGJ5dGVzMlswXSA+IDEpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IoYnl0ZXMyKTsKICAgIHJldHVybiBCb29sZWFuKGJ5dGVzMlswXSk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9OdW1iZXIoYnl0ZXMyLCBvcHRzID0ge30pIHsKICAgIGlmICh0eXBlb2Ygb3B0cy5zaXplICE9PSAidW5kZWZpbmVkIikKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgY29uc3QgaGV4ID0gYnl0ZXNUb0hleChieXRlczIsIG9wdHMpOwogICAgcmV0dXJuIGhleFRvTnVtYmVyKGhleCwgb3B0cyk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9TdHJpbmcoYnl0ZXNfLCBvcHRzID0ge30pIHsKICAgIGxldCBieXRlczIgPSBieXRlc187CiAgICBpZiAodHlwZW9mIG9wdHMuc2l6ZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgYXNzZXJ0U2l6ZShieXRlczIsIHsgc2l6ZTogb3B0cy5zaXplIH0pOwogICAgICBieXRlczIgPSB0cmltKGJ5dGVzMiwgeyBkaXI6ICJyaWdodCIgfSk7CiAgICB9CiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJ5dGVzMik7CiAgfQogIHZhciBpbml0X2Zyb21CeXRlcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbUJ5dGVzLmpzIigpIHsKICAgICAgaW5pdF9lbmNvZGluZygpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tSGV4KCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzCiAgZnVuY3Rpb24gZGVjb2RlQWJpUGFyYW1ldGVycyhwYXJhbXMsIGRhdGEpIHsKICAgIGNvbnN0IGJ5dGVzMiA9IHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiA/IGhleFRvQnl0ZXMoZGF0YSkgOiBkYXRhOwogICAgY29uc3QgY3Vyc29yID0gY3JlYXRlQ3Vyc29yKGJ5dGVzMik7CiAgICBpZiAoc2l6ZShieXRlczIpID09PSAwICYmIHBhcmFtcy5sZW5ndGggPiAwKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBpZiAoc2l6ZShkYXRhKSAmJiBzaXplKGRhdGEpIDwgMzIpCiAgICAgIHRocm93IG5ldyBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvcih7CiAgICAgICAgZGF0YTogdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciID8gZGF0YSA6IGJ5dGVzVG9IZXgoZGF0YSksCiAgICAgICAgcGFyYW1zLAogICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgfSk7CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWVzID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7ICsraSkgewogICAgICBjb25zdCBwYXJhbSA9IHBhcmFtc1tpXTsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKGNvbnN1bWVkKTsKICAgICAgY29uc3QgW2RhdGEyLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgcGFyYW0sIHsKICAgICAgICBzdGF0aWNQb3NpdGlvbjogMAogICAgICB9KTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgICB2YWx1ZXMucHVzaChkYXRhMik7CiAgICB9CiAgICByZXR1cm4gdmFsdWVzOwogIH0KICBmdW5jdGlvbiBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KSB7CiAgICBjb25zdCBhcnJheUNvbXBvbmVudHMgPSBnZXRBcnJheUNvbXBvbmVudHMocGFyYW0udHlwZSk7CiAgICBpZiAoYXJyYXlDb21wb25lbnRzKSB7CiAgICAgIGNvbnN0IFtsZW5ndGgsIHR5cGVdID0gYXJyYXlDb21wb25lbnRzOwogICAgICByZXR1cm4gZGVjb2RlQXJyYXkoY3Vyc29yLCB7IC4uLnBhcmFtLCB0eXBlIH0sIHsgbGVuZ3RoLCBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIH0KICAgIGlmIChwYXJhbS50eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gZGVjb2RlVHVwbGUoY3Vyc29yLCBwYXJhbSwgeyBzdGF0aWNQb3NpdGlvbiB9KTsKICAgIGlmIChwYXJhbS50eXBlID09PSAiYWRkcmVzcyIpCiAgICAgIHJldHVybiBkZWNvZGVBZGRyZXNzKGN1cnNvcik7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gImJvb2wiKQogICAgICByZXR1cm4gZGVjb2RlQm9vbChjdXJzb3IpOwogICAgaWYgKHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiYnl0ZXMiKSkKICAgICAgcmV0dXJuIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICBpZiAocGFyYW0udHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgcGFyYW0udHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgcmV0dXJuIGRlY29kZU51bWJlcihjdXJzb3IsIHBhcmFtKTsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIikKICAgICAgcmV0dXJuIGRlY29kZVN0cmluZyhjdXJzb3IsIHsgc3RhdGljUG9zaXRpb24gfSk7CiAgICB0aHJvdyBuZXcgSW52YWxpZEFiaURlY29kaW5nVHlwZUVycm9yKHBhcmFtLnR5cGUsIHsKICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVBYmlQYXJhbWV0ZXJzIgogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGRlY29kZUFkZHJlc3MoY3Vyc29yKSB7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFtjaGVja3N1bUFkZHJlc3MoYnl0ZXNUb0hleChzbGljZUJ5dGVzKHZhbHVlLCAtMjApKSksIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlQXJyYXkoY3Vyc29yLCBwYXJhbSwgeyBsZW5ndGgsIHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGlmICghbGVuZ3RoKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3Qgc3RhcnRPZkRhdGEgPSBzdGFydCArIHNpemVPZkxlbmd0aDsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0KTsKICAgICAgY29uc3QgbGVuZ3RoMiA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZMZW5ndGgpKTsKICAgICAgY29uc3QgZHluYW1pY0NoaWxkID0gaGFzRHluYW1pY0NoaWxkKHBhcmFtKTsKICAgICAgbGV0IGNvbnN1bWVkMiA9IDA7CiAgICAgIGNvbnN0IHZhbHVlMiA9IFtdOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDI7ICsraSkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydE9mRGF0YSArIChkeW5hbWljQ2hpbGQgPyBpICogMzIgOiBjb25zdW1lZDIpKTsKICAgICAgICBjb25zdCBbZGF0YSwgY29uc3VtZWRfXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnRPZkRhdGEKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZDIgKz0gY29uc3VtZWRfOwogICAgICAgIHZhbHVlMi5wdXNoKGRhdGEpOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZTIsIDMyXTsKICAgIH0KICAgIGlmIChoYXNEeW5hbWljQ2hpbGQocGFyYW0pKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcyhzaXplT2ZPZmZzZXQpKTsKICAgICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgICAgY29uc3QgdmFsdWUyID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhcnQgKyBpICogMzIpOwogICAgICAgIGNvbnN0IFtkYXRhXSA9IGRlY29kZVBhcmFtZXRlcihjdXJzb3IsIHBhcmFtLCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICB2YWx1ZTIucHVzaChkYXRhKTsKICAgICAgfQogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbdmFsdWUyLCAzMl07CiAgICB9CiAgICBsZXQgY29uc3VtZWQgPSAwOwogICAgY29uc3QgdmFsdWUgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgY29uc3QgW2RhdGEsIGNvbnN1bWVkX10gPSBkZWNvZGVQYXJhbWV0ZXIoY3Vyc29yLCBwYXJhbSwgewogICAgICAgIHN0YXRpY1Bvc2l0aW9uOiBzdGF0aWNQb3NpdGlvbiArIGNvbnN1bWVkCiAgICAgIH0pOwogICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgIHZhbHVlLnB1c2goZGF0YSk7CiAgICB9CiAgICByZXR1cm4gW3ZhbHVlLCBjb25zdW1lZF07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJvb2woY3Vyc29yKSB7CiAgICByZXR1cm4gW2J5dGVzVG9Cb29sKGN1cnNvci5yZWFkQnl0ZXMoMzIpLCB7IHNpemU6IDMyIH0pLCAzMl07CiAgfQogIGZ1bmN0aW9uIGRlY29kZUJ5dGVzKGN1cnNvciwgcGFyYW0sIHsgc3RhdGljUG9zaXRpb24gfSkgewogICAgY29uc3QgW18sIHNpemUzXSA9IHBhcmFtLnR5cGUuc3BsaXQoImJ5dGVzIik7CiAgICBpZiAoIXNpemUzKSB7CiAgICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyBvZmZzZXQpOwogICAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgICAgaWYgKGxlbmd0aCA9PT0gMCkgewogICAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgICByZXR1cm4gWyIweCIsIDMyXTsKICAgICAgfQogICAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgpOwogICAgICBjdXJzb3Iuc2V0UG9zaXRpb24oc3RhdGljUG9zaXRpb24gKyAzMik7CiAgICAgIHJldHVybiBbYnl0ZXNUb0hleChkYXRhKSwgMzJdOwogICAgfQogICAgY29uc3QgdmFsdWUgPSBieXRlc1RvSGV4KGN1cnNvci5yZWFkQnl0ZXMoTnVtYmVyLnBhcnNlSW50KHNpemUzKSwgMzIpKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gZGVjb2RlTnVtYmVyKGN1cnNvciwgcGFyYW0pIHsKICAgIGNvbnN0IHNpZ25lZCA9IHBhcmFtLnR5cGUuc3RhcnRzV2l0aCgiaW50Iik7CiAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChwYXJhbS50eXBlLnNwbGl0KCJpbnQiKVsxXSB8fCAiMjU2Iik7CiAgICBjb25zdCB2YWx1ZSA9IGN1cnNvci5yZWFkQnl0ZXMoMzIpOwogICAgcmV0dXJuIFsKICAgICAgc2l6ZTMgPiA0OCA/IGJ5dGVzVG9CaWdJbnQodmFsdWUsIHsgc2lnbmVkIH0pIDogYnl0ZXNUb051bWJlcih2YWx1ZSwgeyBzaWduZWQgfSksCiAgICAgIDMyCiAgICBdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVUdXBsZShjdXJzb3IsIHBhcmFtLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IGhhc1VubmFtZWRDaGlsZCA9IHBhcmFtLmNvbXBvbmVudHMubGVuZ3RoID09PSAwIHx8IHBhcmFtLmNvbXBvbmVudHMuc29tZSgoeyBuYW1lIH0pID0+ICFuYW1lKTsKICAgIGNvbnN0IHZhbHVlID0gaGFzVW5uYW1lZENoaWxkID8gW10gOiB7fTsKICAgIGxldCBjb25zdW1lZCA9IDA7CiAgICBpZiAoaGFzRHluYW1pY0NoaWxkKHBhcmFtKSkgewogICAgICBjb25zdCBvZmZzZXQgPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoc2l6ZU9mT2Zmc2V0KSk7CiAgICAgIGNvbnN0IHN0YXJ0ID0gc3RhdGljUG9zaXRpb24gKyBvZmZzZXQ7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW0uY29tcG9uZW50cy5sZW5ndGg7ICsraSkgewogICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXJ0ICsgY29uc3VtZWQpOwogICAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgICBzdGF0aWNQb3NpdGlvbjogc3RhcnQKICAgICAgICB9KTsKICAgICAgICBjb25zdW1lZCArPSBjb25zdW1lZF87CiAgICAgICAgdmFsdWVbaGFzVW5uYW1lZENoaWxkID8gaSA6IGNvbXBvbmVudD8ubmFtZV0gPSBkYXRhOwogICAgICB9CiAgICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgICAgcmV0dXJuIFt2YWx1ZSwgMzJdOwogICAgfQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhbS5jb21wb25lbnRzLmxlbmd0aDsgKytpKSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IHBhcmFtLmNvbXBvbmVudHNbaV07CiAgICAgIGNvbnN0IFtkYXRhLCBjb25zdW1lZF9dID0gZGVjb2RlUGFyYW1ldGVyKGN1cnNvciwgY29tcG9uZW50LCB7CiAgICAgICAgc3RhdGljUG9zaXRpb24KICAgICAgfSk7CiAgICAgIHZhbHVlW2hhc1VubmFtZWRDaGlsZCA/IGkgOiBjb21wb25lbnQ/Lm5hbWVdID0gZGF0YTsKICAgICAgY29uc3VtZWQgKz0gY29uc3VtZWRfOwogICAgfQogICAgcmV0dXJuIFt2YWx1ZSwgY29uc3VtZWRdOwogIH0KICBmdW5jdGlvbiBkZWNvZGVTdHJpbmcoY3Vyc29yLCB7IHN0YXRpY1Bvc2l0aW9uIH0pIHsKICAgIGNvbnN0IG9mZnNldCA9IGJ5dGVzVG9OdW1iZXIoY3Vyc29yLnJlYWRCeXRlcygzMikpOwogICAgY29uc3Qgc3RhcnQgPSBzdGF0aWNQb3NpdGlvbiArIG9mZnNldDsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGFydCk7CiAgICBjb25zdCBsZW5ndGggPSBieXRlc1RvTnVtYmVyKGN1cnNvci5yZWFkQnl0ZXMoMzIpKTsKICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAgY3Vyc29yLnNldFBvc2l0aW9uKHN0YXRpY1Bvc2l0aW9uICsgMzIpOwogICAgICByZXR1cm4gWyIiLCAzMl07CiAgICB9CiAgICBjb25zdCBkYXRhID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgsIDMyKTsKICAgIGNvbnN0IHZhbHVlID0gYnl0ZXNUb1N0cmluZyh0cmltKGRhdGEpKTsKICAgIGN1cnNvci5zZXRQb3NpdGlvbihzdGF0aWNQb3NpdGlvbiArIDMyKTsKICAgIHJldHVybiBbdmFsdWUsIDMyXTsKICB9CiAgZnVuY3Rpb24gaGFzRHluYW1pY0NoaWxkKHBhcmFtKSB7CiAgICBjb25zdCB7IHR5cGUgfSA9IHBhcmFtOwogICAgaWYgKHR5cGUgPT09ICJzdHJpbmciKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAiYnl0ZXMiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlLmVuZHNXaXRoKCJbXSIpKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmICh0eXBlID09PSAidHVwbGUiKQogICAgICByZXR1cm4gcGFyYW0uY29tcG9uZW50cz8uc29tZShoYXNEeW5hbWljQ2hpbGQpOwogICAgY29uc3QgYXJyYXlDb21wb25lbnRzID0gZ2V0QXJyYXlDb21wb25lbnRzKHBhcmFtLnR5cGUpOwogICAgaWYgKGFycmF5Q29tcG9uZW50cyAmJiBoYXNEeW5hbWljQ2hpbGQoeyAuLi5wYXJhbSwgdHlwZTogYXJyYXlDb21wb25lbnRzWzFdIH0pKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgdmFyIHNpemVPZkxlbmd0aCwgc2l6ZU9mT2Zmc2V0OwogIHZhciBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVBYmlQYXJhbWV0ZXJzLmpzIigpIHsKICAgICAgaW5pdF9hYmkoKTsKICAgICAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgICAgIGluaXRfY3Vyc29yMigpOwogICAgICBpbml0X3NpemUoKTsKICAgICAgaW5pdF9zbGljZSgpOwogICAgICBpbml0X3RyaW0oKTsKICAgICAgaW5pdF9mcm9tQnl0ZXMoKTsKICAgICAgaW5pdF90b0J5dGVzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIHNpemVPZkxlbmd0aCA9IDMyOwogICAgICBzaXplT2ZPZmZzZXQgPSAzMjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVFcnJvclJlc3VsdC5qcwogIGZ1bmN0aW9uIGRlY29kZUVycm9yUmVzdWx0KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlID0gc2xpY2UoZGF0YSwgMCwgNCk7CiAgICBpZiAoc2lnbmF0dXJlID09PSAiMHgiKQogICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICBjb25zdCBhYmlfID0gWy4uLmFiaTIgfHwgW10sIHNvbGlkaXR5RXJyb3IsIHNvbGlkaXR5UGFuaWNdOwogICAgY29uc3QgYWJpSXRlbSA9IGFiaV8uZmluZCgoeCkgPT4geC50eXBlID09PSAiZXJyb3IiICYmIHNpZ25hdHVyZSA9PT0gdG9GdW5jdGlvblNlbGVjdG9yKGZvcm1hdEFiaUl0ZW0yKHgpKSk7CiAgICBpZiAoIWFiaUl0ZW0pCiAgICAgIHRocm93IG5ldyBBYmlFcnJvclNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVFcnJvclJlc3VsdCIKICAgICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmlJdGVtLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBhYmlJdGVtICYmIGFiaUl0ZW0uaW5wdXRzICYmIGFiaUl0ZW0uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0uaW5wdXRzLCBzbGljZShkYXRhLCA0KSkgOiB2b2lkIDAsCiAgICAgIGVycm9yTmFtZTogYWJpSXRlbS5uYW1lCiAgICB9OwogIH0KICB2YXIgaW5pdF9kZWNvZGVFcnJvclJlc3VsdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUVycm9yUmVzdWx0LmpzIigpIHsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X3NsaWNlKCk7CiAgICAgIGluaXRfdG9GdW5jdGlvblNlbGVjdG9yKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2Zvcm1hdEFiaUl0ZW0yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zdHJpbmdpZnkuanMKICB2YXIgc3RyaW5naWZ5OwogIHZhciBpbml0X3N0cmluZ2lmeSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc3RyaW5naWZ5LmpzIigpIHsKICAgICAgc3RyaW5naWZ5ID0gKHZhbHVlLCByZXBsYWNlciwgc3BhY2UpID0+IEpTT04uc3RyaW5naWZ5KHZhbHVlLCAoa2V5LCB2YWx1ZV8pID0+IHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSB0eXBlb2YgdmFsdWVfID09PSAiYmlnaW50IiA/IHZhbHVlXy50b1N0cmluZygpIDogdmFsdWVfOwogICAgICAgIHJldHVybiB0eXBlb2YgcmVwbGFjZXIgPT09ICJmdW5jdGlvbiIgPyByZXBsYWNlcihrZXksIHZhbHVlMikgOiB2YWx1ZTI7CiAgICAgIH0sIHNwYWNlKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMKICBmdW5jdGlvbiBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoeyBhYmlJdGVtLCBhcmdzLCBpbmNsdWRlRnVuY3Rpb25OYW1lID0gdHJ1ZSwgaW5jbHVkZU5hbWUgPSBmYWxzZSB9KSB7CiAgICBpZiAoISgibmFtZSIgaW4gYWJpSXRlbSkpCiAgICAgIHJldHVybjsKICAgIGlmICghKCJpbnB1dHMiIGluIGFiaUl0ZW0pKQogICAgICByZXR1cm47CiAgICBpZiAoIWFiaUl0ZW0uaW5wdXRzKQogICAgICByZXR1cm47CiAgICByZXR1cm4gYCR7aW5jbHVkZUZ1bmN0aW9uTmFtZSA/IGFiaUl0ZW0ubmFtZSA6ICIifSgke2FiaUl0ZW0uaW5wdXRzLm1hcCgoaW5wdXQsIGkpID0+IGAke2luY2x1ZGVOYW1lICYmIGlucHV0Lm5hbWUgPyBgJHtpbnB1dC5uYW1lfTogYCA6ICIifSR7dHlwZW9mIGFyZ3NbaV0gPT09ICJvYmplY3QiID8gc3RyaW5naWZ5KGFyZ3NbaV0pIDogYXJnc1tpXX1gKS5qb2luKCIsICIpfSlgOwogIH0KICB2YXIgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MuanMiKCkgewogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3VuaXQuanMKICB2YXIgZXRoZXJVbml0cywgZ3dlaVVuaXRzLCB3ZWlVbml0czsKICB2YXIgaW5pdF91bml0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvdW5pdC5qcyIoKSB7CiAgICAgIGV0aGVyVW5pdHMgPSB7CiAgICAgICAgZ3dlaTogOSwKICAgICAgICB3ZWk6IDE4CiAgICAgIH07CiAgICAgIGd3ZWlVbml0cyA9IHsKICAgICAgICBldGhlcjogLTksCiAgICAgICAgd2VpOiA5CiAgICAgIH07CiAgICAgIHdlaVVuaXRzID0gewogICAgICAgIGV0aGVyOiAtMTgsCiAgICAgICAgZ3dlaTogLTkKICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0VW5pdHMuanMKICBmdW5jdGlvbiBmb3JtYXRVbml0cyh2YWx1ZSwgZGVjaW1hbHMpIHsKICAgIGxldCBkaXNwbGF5ID0gdmFsdWUudG9TdHJpbmcoKTsKICAgIGNvbnN0IG5lZ2F0aXZlID0gZGlzcGxheS5zdGFydHNXaXRoKCItIik7CiAgICBpZiAobmVnYXRpdmUpCiAgICAgIGRpc3BsYXkgPSBkaXNwbGF5LnNsaWNlKDEpOwogICAgZGlzcGxheSA9IGRpc3BsYXkucGFkU3RhcnQoZGVjaW1hbHMsICIwIik7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uXSA9IFsKICAgICAgZGlzcGxheS5zbGljZSgwLCBkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKSwKICAgICAgZGlzcGxheS5zbGljZShkaXNwbGF5Lmxlbmd0aCAtIGRlY2ltYWxzKQogICAgXTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICByZXR1cm4gYCR7bmVnYXRpdmUgPyAiLSIgOiAiIn0ke2ludGVnZXIgfHwgIjAifSR7ZnJhY3Rpb24gPyBgLiR7ZnJhY3Rpb259YCA6ICIifWA7CiAgfQogIHZhciBpbml0X2Zvcm1hdFVuaXRzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdFVuaXRzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0RXRoZXIuanMKICBmdW5jdGlvbiBmb3JtYXRFdGhlcih3ZWksIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIGZvcm1hdFVuaXRzKHdlaSwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEV0aGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L2Zvcm1hdEV0aGVyLmpzIigpIHsKICAgICAgaW5pdF91bml0KCk7CiAgICAgIGluaXRfZm9ybWF0VW5pdHMoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcwogIGZ1bmN0aW9uIGZvcm1hdEd3ZWkod2VpLCB1bml0ID0gIndlaSIpIHsKICAgIHJldHVybiBmb3JtYXRVbml0cyh3ZWksIGd3ZWlVbml0c1t1bml0XSk7CiAgfQogIHZhciBpbml0X2Zvcm1hdEd3ZWkgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VuaXQvZm9ybWF0R3dlaS5qcyIoKSB7CiAgICAgIGluaXRfdW5pdCgpOwogICAgICBpbml0X2Zvcm1hdFVuaXRzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvc3RhdGVPdmVycmlkZS5qcwogIGZ1bmN0aW9uIHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZU1hcHBpbmcpIHsKICAgIHJldHVybiBzdGF0ZU1hcHBpbmcucmVkdWNlKChwcmV0dHksIHsgc2xvdCwgdmFsdWUgfSkgPT4gewogICAgICByZXR1cm4gYCR7cHJldHR5fSAgICAgICAgJHtzbG90fTogJHt2YWx1ZX0KYDsKICAgIH0sICIiKTsKICB9CiAgZnVuY3Rpb24gcHJldHR5U3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKSB7CiAgICByZXR1cm4gc3RhdGVPdmVycmlkZS5yZWR1Y2UoKHByZXR0eSwgeyBhZGRyZXNzLCAuLi5zdGF0ZSB9KSA9PiB7CiAgICAgIGxldCB2YWwgPSBgJHtwcmV0dHl9ICAgICR7YWRkcmVzc306CmA7CiAgICAgIGlmIChzdGF0ZS5ub25jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIG5vbmNlOiAke3N0YXRlLm5vbmNlfQpgOwogICAgICBpZiAoc3RhdGUuYmFsYW5jZSkKICAgICAgICB2YWwgKz0gYCAgICAgIGJhbGFuY2U6ICR7c3RhdGUuYmFsYW5jZX0KYDsKICAgICAgaWYgKHN0YXRlLmNvZGUpCiAgICAgICAgdmFsICs9IGAgICAgICBjb2RlOiAke3N0YXRlLmNvZGV9CmA7CiAgICAgIGlmIChzdGF0ZS5zdGF0ZSkgewogICAgICAgIHZhbCArPSAiICAgICAgc3RhdGU6XG4iOwogICAgICAgIHZhbCArPSBwcmV0dHlTdGF0ZU1hcHBpbmcoc3RhdGUuc3RhdGUpOwogICAgICB9CiAgICAgIGlmIChzdGF0ZS5zdGF0ZURpZmYpIHsKICAgICAgICB2YWwgKz0gIiAgICAgIHN0YXRlRGlmZjpcbiI7CiAgICAgICAgdmFsICs9IHByZXR0eVN0YXRlTWFwcGluZyhzdGF0ZS5zdGF0ZURpZmYpOwogICAgICB9CiAgICAgIHJldHVybiB2YWw7CiAgICB9LCAiICBTdGF0ZSBPdmVycmlkZTpcbiIpLnNsaWNlKDAsIC0xKTsKICB9CiAgdmFyIEFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IsIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3I7CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgQWNjb3VudFN0YXRlQ29uZmxpY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgICAgIHN1cGVyKGBTdGF0ZSBmb3IgYWNjb3VudCAiJHthZGRyZXNzfSIgaXMgc2V0IG11bHRpcGxlIHRpbWVzLmAsIHsKICAgICAgICAgICAgbmFtZTogIkFjY291bnRTdGF0ZUNvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoInN0YXRlIGFuZCBzdGF0ZURpZmYgYXJlIHNldCBvbiB0aGUgc2FtZSBhY2NvdW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIlN0YXRlQXNzaWdubWVudENvbmZsaWN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdHJhbnNhY3Rpb24uanMKICBmdW5jdGlvbiBwcmV0dHlQcmludChhcmdzKSB7CiAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMoYXJncykubWFwKChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgfHwgdmFsdWUgPT09IGZhbHNlKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gW2tleSwgdmFsdWVdOwogICAgfSkuZmlsdGVyKEJvb2xlYW4pOwogICAgY29uc3QgbWF4TGVuZ3RoID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2tleV0pID0+IE1hdGgubWF4KGFjYywga2V5Lmxlbmd0aCksIDApOwogICAgcmV0dXJuIGVudHJpZXMubWFwKChba2V5LCB2YWx1ZV0pID0+IGAgICR7YCR7a2V5fTpgLnBhZEVuZChtYXhMZW5ndGggKyAxKX0gICR7dmFsdWV9YCkuam9pbigiXG4iKTsKICB9CiAgdmFyIEZlZUNvbmZsaWN0RXJyb3IsIEludmFsaWRMZWdhY3lWRXJyb3IsIEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLCBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsIEludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yLCBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLCBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IsIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb24gPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc2FjdGlvbi5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBGZWVDb25mbGljdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgIkNhbm5vdCBzcGVjaWZ5IGJvdGggYSBgZ2FzUHJpY2VgIGFuZCBhIGBtYXhGZWVQZXJHYXNgL2BtYXhQcmlvcml0eUZlZVBlckdhc2AuIiwKICAgICAgICAgICAgIlVzZSBgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGZvciBFSVAtMTU1OSBjb21wYXRpYmxlIG5ldHdvcmtzLCBhbmQgYGdhc1ByaWNlYCBmb3Igb3RoZXJzLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBuYW1lOiAiRmVlQ29uZmxpY3RFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkTGVnYWN5VkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHYgfSkgewogICAgICAgICAgc3VwZXIoYEludmFsaWQgXGB2XGAgdmFsdWUgIiR7dn0iLiBFeHBlY3RlZCAyNyBvciAyOC5gLCB7CiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkTGVnYWN5VkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXphYmxlVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyB0cmFuc2FjdGlvbiB9KSB7CiAgICAgICAgICBzdXBlcigiQ2Fubm90IGluZmVyIGEgdHJhbnNhY3Rpb24gdHlwZSBmcm9tIHByb3ZpZGVkIHRyYW5zYWN0aW9uLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlByb3ZpZGVkIFRyYW5zYWN0aW9uOiIsCiAgICAgICAgICAgICAgInsiLAogICAgICAgICAgICAgIHByZXR0eVByaW50KHRyYW5zYWN0aW9uKSwKICAgICAgICAgICAgICAifSIsCiAgICAgICAgICAgICAgIiIsCiAgICAgICAgICAgICAgIlRvIGluZmVyIHRoZSB0eXBlLCBlaXRoZXIgcHJvdmlkZToiLAogICAgICAgICAgICAgICItIGEgYHR5cGVgIHRvIHRoZSBUcmFuc2FjdGlvbiwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC0xNTU5IFRyYW5zYWN0aW9uIHdpdGggYG1heEZlZVBlckdhc2AsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtMjkzMCBUcmFuc2FjdGlvbiB3aXRoIGBnYXNQcmljZWAgJiBgYWNjZXNzTGlzdGAsIG9yIiwKICAgICAgICAgICAgICAiLSBhbiBFSVAtNDg0NCBUcmFuc2FjdGlvbiB3aXRoIGBibG9ic2AsIGBibG9iVmVyc2lvbmVkSGFzaGVzYCwgYHNpZGVjYXJzYCwgb3IiLAogICAgICAgICAgICAgICItIGFuIEVJUC03NzAyIFRyYW5zYWN0aW9uIHdpdGggYGF1dGhvcml6YXRpb25MaXN0YCwgb3IiLAogICAgICAgICAgICAgICItIGEgTGVnYWN5IFRyYW5zYWN0aW9uIHdpdGggYGdhc1ByaWNlYCIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IHNlcmlhbGl6ZWRUeXBlIH0pIHsKICAgICAgICAgIHN1cGVyKGBTZXJpYWxpemVkIHRyYW5zYWN0aW9uIHR5cGUgIiR7c2VyaWFsaXplZFR5cGV9IiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICAgICAgbmFtZTogIkludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUeXBlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc2VyaWFsaXplZFR5cGUgPSBzZXJpYWxpemVkVHlwZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBhdHRyaWJ1dGVzLCBzZXJpYWxpemVkVHJhbnNhY3Rpb24sIHR5cGUgfSkgewogICAgICAgICAgY29uc3QgbWlzc2luZyA9IE9iamVjdC5lbnRyaWVzKGF0dHJpYnV0ZXMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB0eXBlb2YgdmFsdWUgPT09ICJ1bmRlZmluZWQiID8ga2V5IDogdm9pZCAwKS5maWx0ZXIoQm9vbGVhbik7CiAgICAgICAgICBzdXBlcihgSW52YWxpZCBzZXJpYWxpemVkIHRyYW5zYWN0aW9uIG9mIHR5cGUgIiR7dHlwZX0iIHdhcyBwcm92aWRlZC5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBTZXJpYWxpemVkIFRyYW5zYWN0aW9uOiAiJHtzZXJpYWxpemVkVHJhbnNhY3Rpb259ImAsCiAgICAgICAgICAgICAgbWlzc2luZy5sZW5ndGggPiAwID8gYE1pc3NpbmcgQXR0cmlidXRlczogJHttaXNzaW5nLmpvaW4oIiwgIil9YCA6ICIiCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlcmlhbGl6ZWRUcmFuc2FjdGlvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInR5cGUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBzZXJpYWxpemVkVHJhbnNhY3Rpb247CiAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgc3RvcmFnZUtleSB9KSB7CiAgICAgICAgICBzdXBlcihgU2l6ZSBmb3Igc3RvcmFnZSBrZXkgIiR7c3RvcmFnZUtleX0iIGlzIGludmFsaWQuIEV4cGVjdGVkIDMyIGJ5dGVzLiBHb3QgJHtNYXRoLmZsb29yKChzdG9yYWdlS2V5Lmxlbmd0aCAtIDIpIC8gMil9IGJ5dGVzLmAsIHsgbmFtZTogIkludmFsaWRTdG9yYWdlS2V5U2l6ZUVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGNoYWluLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlIH0pIHsKICAgICAgICAgIGNvbnN0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGNoYWluOiBjaGFpbiAmJiBgJHtjaGFpbj8ubmFtZX0gKGlkOiAke2NoYWluPy5pZH0pYCwKICAgICAgICAgICAgZnJvbTogYWNjb3VudD8uYWRkcmVzcywKICAgICAgICAgICAgdG8sCiAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgdmFsdWUgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEV0aGVyKHZhbHVlKX0gJHtjaGFpbj8ubmF0aXZlQ3VycmVuY3k/LnN5bWJvbCB8fCAiRVRIIn1gLAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBnYXMsCiAgICAgICAgICAgIGdhc1ByaWNlOiB0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmIGAke2Zvcm1hdEd3ZWkoZ2FzUHJpY2UpfSBnd2VpYCwKICAgICAgICAgICAgbWF4RmVlUGVyR2FzOiB0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heEZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgICAgIG5vbmNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgLi4uY2F1c2UubWV0YU1lc3NhZ2VzID8gWy4uLmNhdXNlLm1ldGFNZXNzYWdlcywgIiAiXSA6IFtdLAogICAgICAgICAgICAgICJSZXF1ZXN0IEFyZ3VtZW50czoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuY2F1c2UgPSBjYXVzZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgICAgICAgbGV0IGlkZW50aWZpZXIgPSAiVHJhbnNhY3Rpb24iOwogICAgICAgICAgaWYgKGJsb2NrVGFnICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIHRpbWUgIiR7YmxvY2tUYWd9IiBhdCBpbmRleCAiJHtpbmRleDJ9ImA7CiAgICAgICAgICBpZiAoYmxvY2tIYXNoICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIGhhc2ggIiR7YmxvY2tIYXNofSIgYXQgaW5kZXggIiR7aW5kZXgyfSJgOwogICAgICAgICAgaWYgKGJsb2NrTnVtYmVyICYmIGluZGV4MiAhPT0gdm9pZCAwKQogICAgICAgICAgICBpZGVudGlmaWVyID0gYFRyYW5zYWN0aW9uIGF0IGJsb2NrIG51bWJlciAiJHtibG9ja051bWJlcn0iIGF0IGluZGV4ICIke2luZGV4Mn0iYDsKICAgICAgICAgIGlmIChoYXNoMykKICAgICAgICAgICAgaWRlbnRpZmllciA9IGBUcmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9ImA7CiAgICAgICAgICBzdXBlcihgJHtpZGVudGlmaWVyfSBjb3VsZCBub3QgYmUgZm91bmQuYCwgewogICAgICAgICAgICBuYW1lOiAiVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzIH0pIHsKICAgICAgICAgIHN1cGVyKGBUcmFuc2FjdGlvbiByZWNlaXB0IHdpdGggaGFzaCAiJHtoYXNoM30iIGNvdWxkIG5vdCBiZSBmb3VuZC4gVGhlIFRyYW5zYWN0aW9uIG1heSBub3QgYmUgcHJvY2Vzc2VkIG9uIGEgYmxvY2sgeWV0LmAsIHsKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMgfSkgewogICAgICAgICAgc3VwZXIoYFRpbWVkIG91dCB3aGlsZSB3YWl0aW5nIGZvciB0cmFuc2FjdGlvbiB3aXRoIGhhc2ggIiR7aGFzaDN9IiB0byBiZSBjb25maXJtZWQuYCwgeyBuYW1lOiAiV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvciIgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzCiAgdmFyIGdldENvbnRyYWN0QWRkcmVzcywgZ2V0VXJsOwogIHZhciBpbml0X3V0aWxzMyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3V0aWxzLmpzIigpIHsKICAgICAgZ2V0Q29udHJhY3RBZGRyZXNzID0gKGFkZHJlc3MpID0+IGFkZHJlc3M7CiAgICAgIGdldFVybCA9ICh1cmwpID0+IHVybDsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jb250cmFjdC5qcwogIHZhciBDYWxsRXhlY3V0aW9uRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25FeGVjdXRpb25FcnJvciwgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsIENvbnRyYWN0RnVuY3Rpb25aZXJvRGF0YUVycm9yLCBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciwgUmF3Q29udHJhY3RFcnJvcjsKICB2YXIgaW5pdF9jb250cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NvbnRyYWN0LmpzIigpIHsKICAgICAgaW5pdF9wYXJzZUFjY291bnQoKTsKICAgICAgaW5pdF9zb2xpZGl0eSgpOwogICAgICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgICAgIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICAgICAgaW5pdF9mb3JtYXRBYmlJdGVtV2l0aEFyZ3MoKTsKICAgICAgaW5pdF9nZXRBYmlJdGVtKCk7CiAgICAgIGluaXRfZm9ybWF0RXRoZXIoKTsKICAgICAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBDYWxsRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFjY291bnQ6IGFjY291bnRfLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBjaGFpbiwgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSB9KSB7CiAgICAgICAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgICAgICAgbGV0IHByZXR0eUFyZ3MgPSBwcmV0dHlQcmludCh7CiAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgIHRvLAogICAgICAgICAgICB2YWx1ZTogdHlwZW9mIHZhbHVlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRFdGhlcih2YWx1ZSl9ICR7Y2hhaW4/Lm5hdGl2ZUN1cnJlbmN5Py5zeW1ib2wgfHwgIkVUSCJ9YCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgZ2FzLAogICAgICAgICAgICBnYXNQcmljZTogdHlwZW9mIGdhc1ByaWNlICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKGdhc1ByaWNlKX0gZ3dlaWAsCiAgICAgICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXM6IHR5cGVvZiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhQcmlvcml0eUZlZVBlckdhcyl9IGd3ZWlgLAogICAgICAgICAgICBub25jZQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoc3RhdGVPdmVycmlkZSkgewogICAgICAgICAgICBwcmV0dHlBcmdzICs9IGAKJHtwcmV0dHlTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpfWA7CiAgICAgICAgICB9CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIC4uLmNhdXNlLm1ldGFNZXNzYWdlcyA/IFsuLi5jYXVzZS5tZXRhTWVzc2FnZXMsICIgIl0gOiBbXSwKICAgICAgICAgICAgICAiUmF3IENhbGwgQXJndW1lbnRzOiIsCiAgICAgICAgICAgICAgcHJldHR5QXJncwogICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKSwKICAgICAgICAgICAgbmFtZTogIkNhbGxFeGVjdXRpb25FcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGFiaTogYWJpMiwgYXJncywgY29udHJhY3RBZGRyZXNzLCBkb2NzUGF0aDogZG9jc1BhdGg5LCBmdW5jdGlvbk5hbWUsIHNlbmRlciB9KSB7CiAgICAgICAgICBjb25zdCBhYmlJdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICAgICAgY29uc3QgZm9ybWF0dGVkQXJncyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtV2l0aEFyZ3MoewogICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICBhcmdzLAogICAgICAgICAgICBpbmNsdWRlRnVuY3Rpb25OYW1lOiBmYWxzZSwKICAgICAgICAgICAgaW5jbHVkZU5hbWU6IGZhbHNlCiAgICAgICAgICB9KSA6IHZvaWQgMDsKICAgICAgICAgIGNvbnN0IGZ1bmN0aW9uV2l0aFBhcmFtcyA9IGFiaUl0ZW0gPyBmb3JtYXRBYmlJdGVtMihhYmlJdGVtLCB7IGluY2x1ZGVOYW1lOiB0cnVlIH0pIDogdm9pZCAwOwogICAgICAgICAgY29uc3QgcHJldHR5QXJncyA9IHByZXR0eVByaW50KHsKICAgICAgICAgICAgYWRkcmVzczogY29udHJhY3RBZGRyZXNzICYmIGdldENvbnRyYWN0QWRkcmVzcyhjb250cmFjdEFkZHJlc3MpLAogICAgICAgICAgICBmdW5jdGlvbjogZnVuY3Rpb25XaXRoUGFyYW1zLAogICAgICAgICAgICBhcmdzOiBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgJiYgYCR7Wy4uLkFycmF5KGZ1bmN0aW9uTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAsCiAgICAgICAgICAgIHNlbmRlcgogICAgICAgICAgfSk7CiAgICAgICAgICBzdXBlcihjYXVzZS5zaG9ydE1lc3NhZ2UgfHwgYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZXhlY3V0aW5nIHRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9Ii5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAgICAgcHJldHR5QXJncyAmJiAiQ29udHJhY3QgQ2FsbDoiLAogICAgICAgICAgICAgIHByZXR0eUFyZ3MKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWJpIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImNhdXNlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29udHJhY3RBZGRyZXNzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZm9ybWF0dGVkQXJncyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImZ1bmN0aW9uTmFtZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNlbmRlciIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmFiaSA9IGFiaTI7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzOwogICAgICAgICAgdGhpcy5jYXVzZSA9IGNhdXNlOwogICAgICAgICAgdGhpcy5jb250cmFjdEFkZHJlc3MgPSBjb250cmFjdEFkZHJlc3M7CiAgICAgICAgICB0aGlzLmZ1bmN0aW9uTmFtZSA9IGZ1bmN0aW9uTmFtZTsKICAgICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYWJpOiBhYmkyLCBkYXRhLCBmdW5jdGlvbk5hbWUsIG1lc3NhZ2UgfSkgewogICAgICAgICAgbGV0IGNhdXNlOwogICAgICAgICAgbGV0IGRlY29kZWREYXRhID0gdm9pZCAwOwogICAgICAgICAgbGV0IG1ldGFNZXNzYWdlczsKICAgICAgICAgIGxldCByZWFzb247CiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhICE9PSAiMHgiKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZGVjb2RlZERhdGEgPSBkZWNvZGVFcnJvclJlc3VsdCh7IGFiaTogYWJpMiwgZGF0YSB9KTsKICAgICAgICAgICAgICBjb25zdCB7IGFiaUl0ZW0sIGVycm9yTmFtZSwgYXJnczogZXJyb3JBcmdzIH0gPSBkZWNvZGVkRGF0YTsKICAgICAgICAgICAgICBpZiAoZXJyb3JOYW1lID09PSAiRXJyb3IiKSB7CiAgICAgICAgICAgICAgICByZWFzb24gPSBlcnJvckFyZ3NbMF07CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvck5hbWUgPT09ICJQYW5pYyIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFtmaXJzdEFyZ10gPSBlcnJvckFyZ3M7CiAgICAgICAgICAgICAgICByZWFzb24gPSBwYW5pY1JlYXNvbnNbZmlyc3RBcmddOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zdCBlcnJvcldpdGhQYXJhbXMgPSBhYmlJdGVtID8gZm9ybWF0QWJpSXRlbTIoYWJpSXRlbSwgeyBpbmNsdWRlTmFtZTogdHJ1ZSB9KSA6IHZvaWQgMDsKICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEFyZ3MgPSBhYmlJdGVtICYmIGVycm9yQXJncyA/IGZvcm1hdEFiaUl0ZW1XaXRoQXJncyh7CiAgICAgICAgICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICAgICAgICAgIGFyZ3M6IGVycm9yQXJncywKICAgICAgICAgICAgICAgICAgaW5jbHVkZUZ1bmN0aW9uTmFtZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVOYW1lOiBmYWxzZQogICAgICAgICAgICAgICAgfSkgOiB2b2lkIDA7CiAgICAgICAgICAgICAgICBtZXRhTWVzc2FnZXMgPSBbCiAgICAgICAgICAgICAgICAgIGVycm9yV2l0aFBhcmFtcyA/IGBFcnJvcjogJHtlcnJvcldpdGhQYXJhbXN9YCA6ICIiLAogICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRBcmdzICYmIGZvcm1hdHRlZEFyZ3MgIT09ICIoKSIgPyBgICAgICAgICR7Wy4uLkFycmF5KGVycm9yTmFtZT8ubGVuZ3RoID8/IDApLmtleXMoKV0ubWFwKCgpID0+ICIgIikuam9pbigiIil9JHtmb3JtYXR0ZWRBcmdzfWAgOiAiIgogICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIGNhdXNlID0gZXJyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UpCiAgICAgICAgICAgIHJlYXNvbiA9IG1lc3NhZ2U7CiAgICAgICAgICBsZXQgc2lnbmF0dXJlOwogICAgICAgICAgaWYgKGNhdXNlIGluc3RhbmNlb2YgQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yKSB7CiAgICAgICAgICAgIHNpZ25hdHVyZSA9IGNhdXNlLnNpZ25hdHVyZTsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzID0gWwogICAgICAgICAgICAgIGBVbmFibGUgdG8gZGVjb2RlIHNpZ25hdHVyZSAiJHtzaWduYXR1cmV9IiBhcyBpdCB3YXMgbm90IGZvdW5kIG9uIHRoZSBwcm92aWRlZCBBQkkuYCwKICAgICAgICAgICAgICAiTWFrZSBzdXJlIHlvdSBhcmUgdXNpbmcgdGhlIGNvcnJlY3QgQUJJIGFuZCB0aGF0IHRoZSBlcnJvciBleGlzdHMgb24gaXQuIiwKICAgICAgICAgICAgICBgWW91IGNhbiBsb29rIHVwIHRoZSBkZWNvZGVkIHNpZ25hdHVyZSBoZXJlOiBodHRwczovL29wZW5jaGFpbi54eXovc2lnbmF0dXJlcz9xdWVyeT0ke3NpZ25hdHVyZX0uYAogICAgICAgICAgICBdOwogICAgICAgICAgfQogICAgICAgICAgc3VwZXIocmVhc29uICYmIHJlYXNvbiAhPT0gImV4ZWN1dGlvbiByZXZlcnRlZCIgfHwgc2lnbmF0dXJlID8gWwogICAgICAgICAgICBgVGhlIGNvbnRyYWN0IGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iIHJldmVydGVkIHdpdGggdGhlIGZvbGxvd2luZyAke3NpZ25hdHVyZSA/ICJzaWduYXR1cmUiIDogInJlYXNvbiJ9OmAsCiAgICAgICAgICAgIHJlYXNvbiB8fCBzaWduYXR1cmUKICAgICAgICAgIF0uam9pbigiXG4iKSA6IGBUaGUgY29udHJhY3QgZnVuY3Rpb24gIiR7ZnVuY3Rpb25OYW1lfSIgcmV2ZXJ0ZWQuYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzLAogICAgICAgICAgICBuYW1lOiAiQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInJlYXNvbiIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInNpZ25hdHVyZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBkZWNvZGVkRGF0YTsKICAgICAgICAgIHRoaXMucmVhc29uID0gcmVhc29uOwogICAgICAgICAgdGhpcy5zaWduYXR1cmUgPSBzaWduYXR1cmU7CiAgICAgICAgfQogICAgICB9OwogICAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBmdW5jdGlvbk5hbWUgfSkgewogICAgICAgICAgc3VwZXIoYFRoZSBjb250cmFjdCBmdW5jdGlvbiAiJHtmdW5jdGlvbk5hbWV9IiByZXR1cm5lZCBubyBkYXRhICgiMHgiKS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgICJUaGlzIGNvdWxkIGJlIGR1ZSB0byBhbnkgb2YgdGhlIGZvbGxvd2luZzoiLAogICAgICAgICAgICAgIGAgIC0gVGhlIGNvbnRyYWN0IGRvZXMgbm90IGhhdmUgdGhlIGZ1bmN0aW9uICIke2Z1bmN0aW9uTmFtZX0iLGAsCiAgICAgICAgICAgICAgIiAgLSBUaGUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhlIGNvbnRyYWN0IGZ1bmN0aW9uIG1heSBiZSBpbnZhbGlkLCBvciIsCiAgICAgICAgICAgICAgIiAgLSBUaGUgYWRkcmVzcyBpcyBub3QgYSBjb250cmFjdC4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgZmFjdG9yeSB9KSB7CiAgICAgICAgICBzdXBlcihgRGVwbG95bWVudCBmb3IgY291bnRlcmZhY3R1YWwgY29udHJhY3QgY2FsbCBmYWlsZWQke2ZhY3RvcnkgPyBgIGZvciBmYWN0b3J5ICIke2ZhY3Rvcnl9Ii5gIDogIiJ9YCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiUGxlYXNlIGVuc3VyZToiLAogICAgICAgICAgICAgICItIFRoZSBgZmFjdG9yeWAgaXMgYSB2YWxpZCBjb250cmFjdCBkZXBsb3ltZW50IGZhY3RvcnkgKGllLiBDcmVhdGUyIEZhY3RvcnksIEVSQy00MzM3IEZhY3RvcnksIGV0YykuIiwKICAgICAgICAgICAgICAiLSBUaGUgYGZhY3RvcnlEYXRhYCBpcyBhIHZhbGlkIGVuY29kZWQgZnVuY3Rpb24gY2FsbCBmb3IgY29udHJhY3QgZGVwbG95bWVudCBmdW5jdGlvbiBvbiB0aGUgZmFjdG9yeS4iCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgUmF3Q29udHJhY3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBkYXRhLCBtZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKG1lc3NhZ2UgfHwgIiIsIHsgbmFtZTogIlJhd0NvbnRyYWN0RXJyb3IiIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjb2RlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogMwogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRhdGEiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDAKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcwogIHZhciBIdHRwUmVxdWVzdEVycm9yLCBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IsIFJwY1JlcXVlc3RFcnJvciwgU29ja2V0Q2xvc2VkRXJyb3IsIFRpbWVvdXRFcnJvcjsKICB2YXIgaW5pdF9yZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvcmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfc3RyaW5naWZ5KCk7CiAgICAgIGluaXRfYmFzZSgpOwogICAgICBpbml0X3V0aWxzMygpOwogICAgICBIdHRwUmVxdWVzdEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGJvZHksIGNhdXNlLCBkZXRhaWxzLCBoZWFkZXJzLCBzdGF0dXMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiSFRUUCByZXF1ZXN0IGZhaWxlZC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBkZXRhaWxzLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBzdGF0dXMgJiYgYFN0YXR1czogJHtzdGF0dXN9YCwKICAgICAgICAgICAgICBgVVJMOiAke2dldFVybCh1cmwpfWAsCiAgICAgICAgICAgICAgYm9keSAmJiBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gCiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiSHR0cFJlcXVlc3RFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJib2R5IiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiaGVhZGVycyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInN0YXR1cyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgInVybCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmJvZHkgPSBib2R5OwogICAgICAgICAgdGhpcy5oZWFkZXJzID0gaGVhZGVyczsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICAgICAgdGhpcy51cmwgPSB1cmw7CiAgICAgICAgfQogICAgICB9OwogICAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgYm9keSwgY2F1c2UsIGRldGFpbHMsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiV2ViU29ja2V0IHJlcXVlc3QgZmFpbGVkLiIsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIGRldGFpbHMsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBVUkw6ICR7Z2V0VXJsKHVybCl9YCwKICAgICAgICAgICAgICBib2R5ICYmIGBSZXF1ZXN0IGJvZHk6ICR7c3RyaW5naWZ5KGJvZHkpfWAKICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbiksCiAgICAgICAgICAgIG5hbWU6ICJXZWJTb2NrZXRSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFJwY1JlcXVlc3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCBlcnJvciwgdXJsIH0pIHsKICAgICAgICAgIHN1cGVyKCJSUEMgUmVxdWVzdCBmYWlsZWQuIiwgewogICAgICAgICAgICBjYXVzZTogZXJyb3IsCiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UsCiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogW2BVUkw6ICR7Z2V0VXJsKHVybCl9YCwgYFJlcXVlc3QgYm9keTogJHtzdHJpbmdpZnkoYm9keSl9YF0sCiAgICAgICAgICAgIG5hbWU6ICJScGNSZXF1ZXN0RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNvZGUgPSBlcnJvci5jb2RlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgU29ja2V0Q2xvc2VkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgdXJsIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoIlRoZSBzb2NrZXQgaGFzIGJlZW4gY2xvc2VkLiIsIHsKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbdXJsICYmIGBVUkw6ICR7Z2V0VXJsKHVybCl9YF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgICAgICBuYW1lOiAiU29ja2V0Q2xvc2VkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIFRpbWVvdXRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBib2R5LCB1cmwgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSByZXF1ZXN0IHRvb2sgdG9vIGxvbmcgdG8gcmVzcG9uZC4iLCB7CiAgICAgICAgICAgIGRldGFpbHM6ICJUaGUgcmVxdWVzdCB0aW1lZCBvdXQuIiwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbYFVSTDogJHtnZXRVcmwodXJsKX1gLCBgUmVxdWVzdCBib2R5OiAke3N0cmluZ2lmeShib2R5KX1gXSwKICAgICAgICAgICAgbmFtZTogIlRpbWVvdXRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMKICB2YXIgdW5rbm93bkVycm9yQ29kZSwgUnBjRXJyb3IsIFByb3ZpZGVyUnBjRXJyb3IsIFBhcnNlUnBjRXJyb3IsIEludmFsaWRSZXF1ZXN0UnBjRXJyb3IsIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IsIEludmFsaWRQYXJhbXNScGNFcnJvciwgSW50ZXJuYWxScGNFcnJvciwgSW52YWxpZElucHV0UnBjRXJyb3IsIFJlc291cmNlTm90Rm91bmRScGNFcnJvciwgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLCBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yLCBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IsIEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLCBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IsIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsIENoYWluRGlzY29ubmVjdGVkRXJyb3IsIFN3aXRjaENoYWluRXJyb3IsIFVua25vd25ScGNFcnJvcjsKICB2YXIgaW5pdF9ycGMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9ycGMuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIHVua25vd25FcnJvckNvZGUgPSAtMTsKICAgICAgUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IGNvZGUsIGRvY3NQYXRoOiBkb2NzUGF0aDksIG1ldGFNZXNzYWdlcywgbmFtZSwgc2hvcnRNZXNzYWdlIH0pIHsKICAgICAgICAgIHN1cGVyKHNob3J0TWVzc2FnZSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBtZXRhTWVzc2FnZXMgfHwgY2F1c2U/Lm1ldGFNZXNzYWdlcywKICAgICAgICAgICAgbmFtZTogbmFtZSB8fCAiUnBjRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lIHx8IGNhdXNlLm5hbWU7CiAgICAgICAgICB0aGlzLmNvZGUgPSBjYXVzZSBpbnN0YW5jZW9mIFJwY1JlcXVlc3RFcnJvciA/IGNhdXNlLmNvZGUgOiBjb2RlID8/IHVua25vd25FcnJvckNvZGU7CiAgICAgICAgfQogICAgICB9OwogICAgICBQcm92aWRlclJwY0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIG9wdGlvbnMpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCBvcHRpb25zKTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiZGF0YSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRhdGEgPSBvcHRpb25zLmRhdGE7CiAgICAgICAgfQogICAgICB9OwogICAgICBQYXJzZVJwY0Vycm9yID0gY2xhc3MgX1BhcnNlUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9QYXJzZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJQYXJzZVJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSW52YWxpZCBKU09OIHdhcyByZWNlaXZlZCBieSB0aGUgc2VydmVyLiBBbiBlcnJvciBvY2N1cnJlZCBvbiB0aGUgc2VydmVyIHdoaWxlIHBhcnNpbmcgdGhlIEpTT04gdGV4dC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZVJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNzAwCiAgICAgIH0pOwogICAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRSZXF1ZXN0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkUmVxdWVzdFJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJJbnZhbGlkUmVxdWVzdFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiSlNPTiBpcyBub3QgYSB2YWxpZCByZXF1ZXN0IG9iamVjdC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyNjAwCiAgICAgIH0pOwogICAgICBNZXRob2ROb3RGb3VuZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UsIHsgbWV0aG9kIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX01ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIk1ldGhvZE5vdEZvdW5kUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgbWV0aG9kJHttZXRob2QgPyBgICIke21ldGhvZH0iYCA6ICIifSBkb2VzIG5vdCBleGlzdCAvIGlzIG5vdCBhdmFpbGFibGUuYAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWV0aG9kTm90Rm91bmRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMQogICAgICB9KTsKICAgICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yID0gY2xhc3MgX0ludmFsaWRQYXJhbXNScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludmFsaWRQYXJhbXNScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiBbCiAgICAgICAgICAgICAgIkludmFsaWQgcGFyYW1ldGVycyB3ZXJlIHByb3ZpZGVkIHRvIHRoZSBSUEMgbWV0aG9kLiIsCiAgICAgICAgICAgICAgIkRvdWJsZSBjaGVjayB5b3UgaGF2ZSBwcm92aWRlZCB0aGUgY29ycmVjdCBwYXJhbWV0ZXJzLiIKICAgICAgICAgICAgXS5qb2luKCJcbiIpCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZhbGlkUGFyYW1zUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzI2MDIKICAgICAgfSk7CiAgICAgIEludGVybmFsUnBjRXJyb3IgPSBjbGFzcyBfSW50ZXJuYWxScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0ludGVybmFsUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkludGVybmFsUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBpbnRlcm5hbCBlcnJvciB3YXMgcmVjZWl2ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZXJuYWxScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjYwMwogICAgICB9KTsKICAgICAgSW52YWxpZElucHV0UnBjRXJyb3IgPSBjbGFzcyBfSW52YWxpZElucHV0UnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9JbnZhbGlkSW5wdXRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiSW52YWxpZElucHV0UnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IFsKICAgICAgICAgICAgICAiTWlzc2luZyBvciBpbnZhbGlkIHBhcmFtZXRlcnMuIiwKICAgICAgICAgICAgICAiRG91YmxlIGNoZWNrIHlvdSBoYXZlIHByb3ZpZGVkIHRoZSBjb3JyZWN0IHBhcmFtZXRlcnMuIgogICAgICAgICAgICBdLmpvaW4oIlxuIikKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludmFsaWRJbnB1dFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyZTMKICAgICAgfSk7CiAgICAgIFJlc291cmNlTm90Rm91bmRScGNFcnJvciA9IGNsYXNzIF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9SZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlJlc291cmNlTm90Rm91bmRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlJlcXVlc3RlZCByZXNvdXJjZSBub3QgZm91bmQuIgogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgIm5hbWUiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiAiUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDAxCiAgICAgIH0pOwogICAgICBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IgPSBjbGFzcyBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJSZXF1ZXN0ZWQgcmVzb3VyY2Ugbm90IGF2YWlsYWJsZS4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDIKICAgICAgfSk7CiAgICAgIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciA9IGNsYXNzIF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IgZXh0ZW5kcyBScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9UcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRyYW5zYWN0aW9uIGNyZWF0aW9uIGZhaWxlZC4iCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAtMzIwMDMKICAgICAgfSk7CiAgICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yID0gY2xhc3MgX01ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlLCB7IG1ldGhvZCB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9NZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBNZXRob2Qke21ldGhvZCA/IGAgIiR7bWV0aG9kfSJgIDogIiJ9IGlzIG5vdCBpbXBsZW1lbnRlZC5gCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC0zMjAwNAogICAgICB9KTsKICAgICAgTGltaXRFeGNlZWRlZFJwY0Vycm9yID0gY2xhc3MgX0xpbWl0RXhjZWVkZWRScGNFcnJvciBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0xpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiTGltaXRFeGNlZWRlZFJwY0Vycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiUmVxdWVzdCBleGNlZWRzIGRlZmluZWQgbGltaXQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGltaXRFeGNlZWRlZFJwY0Vycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA1CiAgICAgIH0pOwogICAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yIGV4dGVuZHMgUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJWZXJzaW9uIG9mIEpTT04tUlBDIHByb3RvY29sIGlzIG5vdCBzdXBwb3J0ZWQuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogLTMyMDA2CiAgICAgIH0pOwogICAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IgPSBjbGFzcyBfVXNlclJlamVjdGVkUmVxdWVzdEVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9Vc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlVzZXIgcmVqZWN0ZWQgdGhlIHJlcXVlc3QuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogNDAwMQogICAgICB9KTsKICAgICAgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciA9IGNsYXNzIF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIGV4dGVuZHMgUHJvdmlkZXJScGNFcnJvciB7CiAgICAgICAgY29uc3RydWN0b3IoY2F1c2UpIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLCB7CiAgICAgICAgICAgIGNvZGU6IF9VbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yIiwKICAgICAgICAgICAgc2hvcnRNZXNzYWdlOiAiVGhlIHJlcXVlc3RlZCBtZXRob2QgYW5kL29yIGFjY291bnQgaGFzIG5vdCBiZWVuIGF1dGhvcml6ZWQgYnkgdGhlIHVzZXIuIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQxMDAKICAgICAgfSk7CiAgICAgIFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciA9IGNsYXNzIF9VbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSwgeyBtZXRob2QgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yLmNvZGUsCiAgICAgICAgICAgIG5hbWU6ICJVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6IGBUaGUgUHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgcmVxdWVzdGVkIG1ldGhvZCR7bWV0aG9kID8gYCAiICR7bWV0aG9kfSJgIDogIiJ9LmAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDQyMDAKICAgICAgfSk7CiAgICAgIFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IgPSBjbGFzcyBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciBleHRlbmRzIFByb3ZpZGVyUnBjRXJyb3IgewogICAgICAgIGNvbnN0cnVjdG9yKGNhdXNlKSB7CiAgICAgICAgICBzdXBlcihjYXVzZSwgewogICAgICAgICAgICBjb2RlOiBfUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvci5jb2RlLAogICAgICAgICAgICBuYW1lOiAiUHJvdmlkZXJEaXNjb25uZWN0ZWRFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIlRoZSBQcm92aWRlciBpcyBkaXNjb25uZWN0ZWQgZnJvbSBhbGwgY2hhaW5zLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAwCiAgICAgIH0pOwogICAgICBDaGFpbkRpc2Nvbm5lY3RlZEVycm9yID0gY2xhc3MgX0NoYWluRGlzY29ubmVjdGVkRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX0NoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIkNoYWluRGlzY29ubmVjdGVkRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJUaGUgUHJvdmlkZXIgaXMgbm90IGNvbm5lY3RlZCB0byB0aGUgcmVxdWVzdGVkIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENoYWluRGlzY29ubmVjdGVkRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAxCiAgICAgIH0pOwogICAgICBTd2l0Y2hDaGFpbkVycm9yID0gY2xhc3MgX1N3aXRjaENoYWluRXJyb3IgZXh0ZW5kcyBQcm92aWRlclJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgY29kZTogX1N3aXRjaENoYWluRXJyb3IuY29kZSwKICAgICAgICAgICAgbmFtZTogIlN3aXRjaENoYWluRXJyb3IiLAogICAgICAgICAgICBzaG9ydE1lc3NhZ2U6ICJBbiBlcnJvciBvY2N1cnJlZCB3aGVuIGF0dGVtcHRpbmcgdG8gc3dpdGNoIGNoYWluLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN3aXRjaENoYWluRXJyb3IsICJjb2RlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiA0OTAyCiAgICAgIH0pOwogICAgICBVbmtub3duUnBjRXJyb3IgPSBjbGFzcyBleHRlbmRzIFJwY0Vycm9yIHsKICAgICAgICBjb25zdHJ1Y3RvcihjYXVzZSkgewogICAgICAgICAgc3VwZXIoY2F1c2UsIHsKICAgICAgICAgICAgbmFtZTogIlVua25vd25ScGNFcnJvciIsCiAgICAgICAgICAgIHNob3J0TWVzc2FnZTogIkFuIHVua25vd24gUlBDIGVycm9yIG9jY3VycmVkLiIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL19tZC5qcwogIGZ1bmN0aW9uIHNldEJpZ1VpbnQ2NCh2aWV3LCBieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpIHsKICAgIGlmICh0eXBlb2Ygdmlldy5zZXRCaWdVaW50NjQgPT09ICJmdW5jdGlvbiIpCiAgICAgIHJldHVybiB2aWV3LnNldEJpZ1VpbnQ2NChieXRlT2Zmc2V0LCB2YWx1ZSwgaXNMRTIpOwogICAgY29uc3QgXzMybjIgPSBCaWdJbnQoMzIpOwogICAgY29uc3QgX3UzMl9tYXggPSBCaWdJbnQoNDI5NDk2NzI5NSk7CiAgICBjb25zdCB3aCA9IE51bWJlcih2YWx1ZSA+PiBfMzJuMiAmIF91MzJfbWF4KTsKICAgIGNvbnN0IHdsID0gTnVtYmVyKHZhbHVlICYgX3UzMl9tYXgpOwogICAgY29uc3QgaCA9IGlzTEUyID8gNCA6IDA7CiAgICBjb25zdCBsID0gaXNMRTIgPyAwIDogNDsKICAgIHZpZXcuc2V0VWludDMyKGJ5dGVPZmZzZXQgKyBoLCB3aCwgaXNMRTIpOwogICAgdmlldy5zZXRVaW50MzIoYnl0ZU9mZnNldCArIGwsIHdsLCBpc0xFMik7CiAgfQogIHZhciBDaGksIE1haiwgSGFzaE1EOwogIHZhciBpbml0X21kID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUraGFzaGVzQDEuNS4wL25vZGVfbW9kdWxlcy9Abm9ibGUvaGFzaGVzL2VzbS9fbWQuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBDaGkgPSAoYSwgYiwgYykgPT4gYSAmIGIgXiB+YSAmIGM7CiAgICAgIE1haiA9IChhLCBiLCBjKSA9PiBhICYgYiBeIGEgJiBjIF4gYiAmIGM7CiAgICAgIEhhc2hNRCA9IGNsYXNzIGV4dGVuZHMgSGFzaCB7CiAgICAgICAgY29uc3RydWN0b3IoYmxvY2tMZW4sIG91dHB1dExlbiwgcGFkT2Zmc2V0LCBpc0xFMikgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSBibG9ja0xlbjsKICAgICAgICAgIHRoaXMub3V0cHV0TGVuID0gb3V0cHV0TGVuOwogICAgICAgICAgdGhpcy5wYWRPZmZzZXQgPSBwYWRPZmZzZXQ7CiAgICAgICAgICB0aGlzLmlzTEUgPSBpc0xFMjsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubGVuZ3RoID0gMDsKICAgICAgICAgIHRoaXMucG9zID0gMDsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGJsb2NrTGVuKTsKICAgICAgICAgIHRoaXMudmlldyA9IGNyZWF0ZVZpZXcodGhpcy5idWZmZXIpOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoZGF0YSkgewogICAgICAgICAgZXhpc3RzKHRoaXMpOwogICAgICAgICAgY29uc3QgeyB2aWV3LCBidWZmZXI6IGJ1ZmZlcjIsIGJsb2NrTGVuIH0gPSB0aGlzOwogICAgICAgICAgZGF0YSA9IHRvQnl0ZXMyKGRhdGEpOwogICAgICAgICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7CiAgICAgICAgICBmb3IgKGxldCBwb3MgPSAwOyBwb3MgPCBsZW47ICkgewogICAgICAgICAgICBjb25zdCB0YWtlID0gTWF0aC5taW4oYmxvY2tMZW4gLSB0aGlzLnBvcywgbGVuIC0gcG9zKTsKICAgICAgICAgICAgaWYgKHRha2UgPT09IGJsb2NrTGVuKSB7CiAgICAgICAgICAgICAgY29uc3QgZGF0YVZpZXcgPSBjcmVhdGVWaWV3KGRhdGEpOwogICAgICAgICAgICAgIGZvciAoOyBibG9ja0xlbiA8PSBsZW4gLSBwb3M7IHBvcyArPSBibG9ja0xlbikKICAgICAgICAgICAgICAgIHRoaXMucHJvY2VzcyhkYXRhVmlldywgcG9zKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWZmZXIyLnNldChkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgdGFrZSksIHRoaXMucG9zKTsKICAgICAgICAgICAgdGhpcy5wb3MgKz0gdGFrZTsKICAgICAgICAgICAgcG9zICs9IHRha2U7CiAgICAgICAgICAgIGlmICh0aGlzLnBvcyA9PT0gYmxvY2tMZW4pIHsKICAgICAgICAgICAgICB0aGlzLnByb2Nlc3ModmlldywgMCk7CiAgICAgICAgICAgICAgdGhpcy5wb3MgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmxlbmd0aCArPSBkYXRhLmxlbmd0aDsKICAgICAgICAgIHRoaXMucm91bmRDbGVhbigpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdEludG8ob3V0KSB7CiAgICAgICAgICBleGlzdHModGhpcyk7CiAgICAgICAgICBvdXRwdXQob3V0LCB0aGlzKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlOwogICAgICAgICAgY29uc3QgeyBidWZmZXI6IGJ1ZmZlcjIsIHZpZXcsIGJsb2NrTGVuLCBpc0xFOiBpc0xFMiB9ID0gdGhpczsKICAgICAgICAgIGxldCB7IHBvcyB9ID0gdGhpczsKICAgICAgICAgIGJ1ZmZlcjJbcG9zKytdID0gMTI4OwogICAgICAgICAgdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zKS5maWxsKDApOwogICAgICAgICAgaWYgKHRoaXMucGFkT2Zmc2V0ID4gYmxvY2tMZW4gLSBwb3MpIHsKICAgICAgICAgICAgdGhpcy5wcm9jZXNzKHZpZXcsIDApOwogICAgICAgICAgICBwb3MgPSAwOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChsZXQgaSA9IHBvczsgaSA8IGJsb2NrTGVuOyBpKyspCiAgICAgICAgICAgIGJ1ZmZlcjJbaV0gPSAwOwogICAgICAgICAgc2V0QmlnVWludDY0KHZpZXcsIGJsb2NrTGVuIC0gOCwgQmlnSW50KHRoaXMubGVuZ3RoICogOCksIGlzTEUyKTsKICAgICAgICAgIHRoaXMucHJvY2Vzcyh2aWV3LCAwKTsKICAgICAgICAgIGNvbnN0IG92aWV3ID0gY3JlYXRlVmlldyhvdXQpOwogICAgICAgICAgY29uc3QgbGVuID0gdGhpcy5vdXRwdXRMZW47CiAgICAgICAgICBpZiAobGVuICUgNCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIHNob3VsZCBiZSBhbGlnbmVkIHRvIDMyYml0Iik7CiAgICAgICAgICBjb25zdCBvdXRMZW4gPSBsZW4gLyA0OwogICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLmdldCgpOwogICAgICAgICAgaWYgKG91dExlbiA+IHN0YXRlLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJfc2hhMjogb3V0cHV0TGVuIGJpZ2dlciB0aGFuIHN0YXRlIik7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG91dExlbjsgaSsrKQogICAgICAgICAgICBvdmlldy5zZXRVaW50MzIoNCAqIGksIHN0YXRlW2ldLCBpc0xFMik7CiAgICAgICAgfQogICAgICAgIGRpZ2VzdCgpIHsKICAgICAgICAgIGNvbnN0IHsgYnVmZmVyOiBidWZmZXIyLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8oYnVmZmVyMik7CiAgICAgICAgICBjb25zdCByZXMgPSBidWZmZXIyLnNsaWNlKDAsIG91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRlc3Ryb3koKTsKICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkpOwogICAgICAgICAgdG8uc2V0KC4uLnRoaXMuZ2V0KCkpOwogICAgICAgICAgY29uc3QgeyBibG9ja0xlbiwgYnVmZmVyOiBidWZmZXIyLCBsZW5ndGgsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIHBvcyB9ID0gdGhpczsKICAgICAgICAgIHRvLmxlbmd0aCA9IGxlbmd0aDsKICAgICAgICAgIHRvLnBvcyA9IHBvczsKICAgICAgICAgIHRvLmZpbmlzaGVkID0gZmluaXNoZWQ7CiAgICAgICAgICB0by5kZXN0cm95ZWQgPSBkZXN0cm95ZWQ7CiAgICAgICAgICBpZiAobGVuZ3RoICUgYmxvY2tMZW4pCiAgICAgICAgICAgIHRvLmJ1ZmZlci5zZXQoYnVmZmVyMik7CiAgICAgICAgICByZXR1cm4gdG87CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vc2hhMjU2LmpzCiAgdmFyIFNIQTI1Nl9LLCBTSEEyNTZfSVYsIFNIQTI1Nl9XLCBTSEEyNTYsIHNoYTI1NjsKICB2YXIgaW5pdF9zaGEyNTYgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3NoYTI1Ni5qcyIoKSB7CiAgICAgIGluaXRfbWQoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgU0hBMjU2X0sgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgICAgICAxMTE2MzUyNDA4LAogICAgICAgIDE4OTk0NDc0NDEsCiAgICAgICAgMzA0OTMyMzQ3MSwKICAgICAgICAzOTIxMDA5NTczLAogICAgICAgIDk2MTk4NzE2MywKICAgICAgICAxNTA4OTcwOTkzLAogICAgICAgIDI0NTM2MzU3NDgsCiAgICAgICAgMjg3MDc2MzIyMSwKICAgICAgICAzNjI0MzgxMDgwLAogICAgICAgIDMxMDU5ODQwMSwKICAgICAgICA2MDcyMjUyNzgsCiAgICAgICAgMTQyNjg4MTk4NywKICAgICAgICAxOTI1MDc4Mzg4LAogICAgICAgIDIxNjIwNzgyMDYsCiAgICAgICAgMjYxNDg4ODEwMywKICAgICAgICAzMjQ4MjIyNTgwLAogICAgICAgIDM4MzUzOTA0MDEsCiAgICAgICAgNDAyMjIyNDc3NCwKICAgICAgICAyNjQzNDcwNzgsCiAgICAgICAgNjA0ODA3NjI4LAogICAgICAgIDc3MDI1NTk4MywKICAgICAgICAxMjQ5MTUwMTIyLAogICAgICAgIDE1NTUwODE2OTIsCiAgICAgICAgMTk5NjA2NDk4NiwKICAgICAgICAyNTU0MjIwODgyLAogICAgICAgIDI4MjE4MzQzNDksCiAgICAgICAgMjk1Mjk5NjgwOCwKICAgICAgICAzMjEwMzEzNjcxLAogICAgICAgIDMzMzY1NzE4OTEsCiAgICAgICAgMzU4NDUyODcxMSwKICAgICAgICAxMTM5MjY5OTMsCiAgICAgICAgMzM4MjQxODk1LAogICAgICAgIDY2NjMwNzIwNSwKICAgICAgICA3NzM1Mjk5MTIsCiAgICAgICAgMTI5NDc1NzM3MiwKICAgICAgICAxMzk2MTgyMjkxLAogICAgICAgIDE2OTUxODM3MDAsCiAgICAgICAgMTk4NjY2MTA1MSwKICAgICAgICAyMTc3MDI2MzUwLAogICAgICAgIDI0NTY5NTYwMzcsCiAgICAgICAgMjczMDQ4NTkyMSwKICAgICAgICAyODIwMzAyNDExLAogICAgICAgIDMyNTk3MzA4MDAsCiAgICAgICAgMzM0NTc2NDc3MSwKICAgICAgICAzNTE2MDY1ODE3LAogICAgICAgIDM2MDAzNTI4MDQsCiAgICAgICAgNDA5NDU3MTkwOSwKICAgICAgICAyNzU0MjMzNDQsCiAgICAgICAgNDMwMjI3NzM0LAogICAgICAgIDUwNjk0ODYxNiwKICAgICAgICA2NTkwNjA1NTYsCiAgICAgICAgODgzOTk3ODc3LAogICAgICAgIDk1ODEzOTU3MSwKICAgICAgICAxMzIyODIyMjE4LAogICAgICAgIDE1MzcwMDIwNjMsCiAgICAgICAgMTc0Nzg3Mzc3OSwKICAgICAgICAxOTU1NTYyMjIyLAogICAgICAgIDIwMjQxMDQ4MTUsCiAgICAgICAgMjIyNzczMDQ1MiwKICAgICAgICAyMzYxODUyNDI0LAogICAgICAgIDI0Mjg0MzY0NzQsCiAgICAgICAgMjc1NjczNDE4NywKICAgICAgICAzMjA0MDMxNDc5LAogICAgICAgIDMzMjkzMjUyOTgKICAgICAgXSk7CiAgICAgIFNIQTI1Nl9JViA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgICAgIDE3NzkwMzM3MDMsCiAgICAgICAgMzE0NDEzNDI3NywKICAgICAgICAxMDEzOTA0MjQyLAogICAgICAgIDI3NzM0ODA3NjIsCiAgICAgICAgMTM1OTg5MzExOSwKICAgICAgICAyNjAwODIyOTI0LAogICAgICAgIDUyODczNDYzNSwKICAgICAgICAxNTQxNDU5MjI1CiAgICAgIF0pOwogICAgICBTSEEyNTZfVyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoNjQpOwogICAgICBTSEEyNTYgPSBjbGFzcyBleHRlbmRzIEhhc2hNRCB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcig2NCwgMzIsIDgsIGZhbHNlKTsKICAgICAgICAgIHRoaXMuQSA9IFNIQTI1Nl9JVlswXSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBTSEEyNTZfSVZbMV0gfCAwOwogICAgICAgICAgdGhpcy5DID0gU0hBMjU2X0lWWzJdIHwgMDsKICAgICAgICAgIHRoaXMuRCA9IFNIQTI1Nl9JVlszXSB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBTSEEyNTZfSVZbNF0gfCAwOwogICAgICAgICAgdGhpcy5GID0gU0hBMjU2X0lWWzVdIHwgMDsKICAgICAgICAgIHRoaXMuRyA9IFNIQTI1Nl9JVls2XSB8IDA7CiAgICAgICAgICB0aGlzLkggPSBTSEEyNTZfSVZbN10gfCAwOwogICAgICAgIH0KICAgICAgICBnZXQoKSB7CiAgICAgICAgICBjb25zdCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICByZXR1cm4gW0EsIEIsIEMsIEQsIEUsIEYsIEcsIEhdOwogICAgICAgIH0KICAgICAgICAvLyBwcmV0dGllci1pZ25vcmUKICAgICAgICBzZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCkgewogICAgICAgICAgdGhpcy5BID0gQSB8IDA7CiAgICAgICAgICB0aGlzLkIgPSBCIHwgMDsKICAgICAgICAgIHRoaXMuQyA9IEMgfCAwOwogICAgICAgICAgdGhpcy5EID0gRCB8IDA7CiAgICAgICAgICB0aGlzLkUgPSBFIHwgMDsKICAgICAgICAgIHRoaXMuRiA9IEYgfCAwOwogICAgICAgICAgdGhpcy5HID0gRyB8IDA7CiAgICAgICAgICB0aGlzLkggPSBIIHwgMDsKICAgICAgICB9CiAgICAgICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKywgb2Zmc2V0ICs9IDQpCiAgICAgICAgICAgIFNIQTI1Nl9XW2ldID0gdmlldy5nZXRVaW50MzIob2Zmc2V0LCBmYWxzZSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA2NDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IFcxNSA9IFNIQTI1Nl9XW2kgLSAxNV07CiAgICAgICAgICAgIGNvbnN0IFcyID0gU0hBMjU2X1dbaSAtIDJdOwogICAgICAgICAgICBjb25zdCBzMCA9IHJvdHIoVzE1LCA3KSBeIHJvdHIoVzE1LCAxOCkgXiBXMTUgPj4+IDM7CiAgICAgICAgICAgIGNvbnN0IHMxID0gcm90cihXMiwgMTcpIF4gcm90cihXMiwgMTkpIF4gVzIgPj4+IDEwOwogICAgICAgICAgICBTSEEyNTZfV1tpXSA9IHMxICsgU0hBMjU2X1dbaSAtIDddICsgczAgKyBTSEEyNTZfV1tpIC0gMTZdIHwgMDsKICAgICAgICAgIH0KICAgICAgICAgIGxldCB7IEEsIEIsIEMsIEQsIEUsIEYsIEcsIEggfSA9IHRoaXM7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY0OyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgc2lnbWExID0gcm90cihFLCA2KSBeIHJvdHIoRSwgMTEpIF4gcm90cihFLCAyNSk7CiAgICAgICAgICAgIGNvbnN0IFQxID0gSCArIHNpZ21hMSArIENoaShFLCBGLCBHKSArIFNIQTI1Nl9LW2ldICsgU0hBMjU2X1dbaV0gfCAwOwogICAgICAgICAgICBjb25zdCBzaWdtYTAgPSByb3RyKEEsIDIpIF4gcm90cihBLCAxMykgXiByb3RyKEEsIDIyKTsKICAgICAgICAgICAgY29uc3QgVDIgPSBzaWdtYTAgKyBNYWooQSwgQiwgQykgfCAwOwogICAgICAgICAgICBIID0gRzsKICAgICAgICAgICAgRyA9IEY7CiAgICAgICAgICAgIEYgPSBFOwogICAgICAgICAgICBFID0gRCArIFQxIHwgMDsKICAgICAgICAgICAgRCA9IEM7CiAgICAgICAgICAgIEMgPSBCOwogICAgICAgICAgICBCID0gQTsKICAgICAgICAgICAgQSA9IFQxICsgVDIgfCAwOwogICAgICAgICAgfQogICAgICAgICAgQSA9IEEgKyB0aGlzLkEgfCAwOwogICAgICAgICAgQiA9IEIgKyB0aGlzLkIgfCAwOwogICAgICAgICAgQyA9IEMgKyB0aGlzLkMgfCAwOwogICAgICAgICAgRCA9IEQgKyB0aGlzLkQgfCAwOwogICAgICAgICAgRSA9IEUgKyB0aGlzLkUgfCAwOwogICAgICAgICAgRiA9IEYgKyB0aGlzLkYgfCAwOwogICAgICAgICAgRyA9IEcgKyB0aGlzLkcgfCAwOwogICAgICAgICAgSCA9IEggKyB0aGlzLkggfCAwOwogICAgICAgICAgdGhpcy5zZXQoQSwgQiwgQywgRCwgRSwgRiwgRywgSCk7CiAgICAgICAgfQogICAgICAgIHJvdW5kQ2xlYW4oKSB7CiAgICAgICAgICBTSEEyNTZfVy5maWxsKDApOwogICAgICAgIH0KICAgICAgICBkZXN0cm95KCkgewogICAgICAgICAgdGhpcy5zZXQoMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCk7CiAgICAgICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgc2hhMjU2ID0gLyogQF9fUFVSRV9fICovIHdyYXBDb25zdHJ1Y3RvcigoKSA9PiBuZXcgU0hBMjU2KCkpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2hhc2hlc0AxLjUuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2hhc2hlcy9lc20vaG1hYy5qcwogIHZhciBITUFDLCBobWFjOwogIHZhciBpbml0X2htYWMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL2htYWMuanMiKCkgewogICAgICBpbml0X2Fzc2VydCgpOwogICAgICBpbml0X3V0aWxzMigpOwogICAgICBITUFDID0gY2xhc3MgZXh0ZW5kcyBIYXNoIHsKICAgICAgICBjb25zdHJ1Y3RvcihoYXNoMywgX2tleSkgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gZmFsc2U7CiAgICAgICAgICBoYXNoKGhhc2gzKTsKICAgICAgICAgIGNvbnN0IGtleSA9IHRvQnl0ZXMyKF9rZXkpOwogICAgICAgICAgdGhpcy5pSGFzaCA9IGhhc2gzLmNyZWF0ZSgpOwogICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmlIYXNoLnVwZGF0ZSAhPT0gImZ1bmN0aW9uIikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBpbnN0YW5jZSBvZiBjbGFzcyB3aGljaCBleHRlbmRzIHV0aWxzLkhhc2giKTsKICAgICAgICAgIHRoaXMuYmxvY2tMZW4gPSB0aGlzLmlIYXNoLmJsb2NrTGVuOwogICAgICAgICAgdGhpcy5vdXRwdXRMZW4gPSB0aGlzLmlIYXNoLm91dHB1dExlbjsKICAgICAgICAgIGNvbnN0IGJsb2NrTGVuID0gdGhpcy5ibG9ja0xlbjsKICAgICAgICAgIGNvbnN0IHBhZDIgPSBuZXcgVWludDhBcnJheShibG9ja0xlbik7CiAgICAgICAgICBwYWQyLnNldChrZXkubGVuZ3RoID4gYmxvY2tMZW4gPyBoYXNoMy5jcmVhdGUoKS51cGRhdGUoa2V5KS5kaWdlc3QoKSA6IGtleSk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZDIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHBhZDJbaV0gXj0gNTQ7CiAgICAgICAgICB0aGlzLmlIYXNoLnVwZGF0ZShwYWQyKTsKICAgICAgICAgIHRoaXMub0hhc2ggPSBoYXNoMy5jcmVhdGUoKTsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFkMi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcGFkMltpXSBePSA1NCBeIDkyOwogICAgICAgICAgdGhpcy5vSGFzaC51cGRhdGUocGFkMik7CiAgICAgICAgICBwYWQyLmZpbGwoMCk7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZShidWYpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIHRoaXMuaUhhc2gudXBkYXRlKGJ1Zik7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgZGlnZXN0SW50byhvdXQpIHsKICAgICAgICAgIGV4aXN0cyh0aGlzKTsKICAgICAgICAgIGJ5dGVzKG91dCwgdGhpcy5vdXRwdXRMZW4pOwogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLmlIYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMub0hhc2gudXBkYXRlKG91dCk7CiAgICAgICAgICB0aGlzLm9IYXNoLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHRoaXMuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgICBkaWdlc3QoKSB7CiAgICAgICAgICBjb25zdCBvdXQgPSBuZXcgVWludDhBcnJheSh0aGlzLm9IYXNoLm91dHB1dExlbik7CiAgICAgICAgICB0aGlzLmRpZ2VzdEludG8ob3V0KTsKICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgfQogICAgICAgIF9jbG9uZUludG8odG8pIHsKICAgICAgICAgIHRvIHx8ICh0byA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLCB7fSkpOwogICAgICAgICAgY29uc3QgeyBvSGFzaCwgaUhhc2gsIGZpbmlzaGVkLCBkZXN0cm95ZWQsIGJsb2NrTGVuLCBvdXRwdXRMZW4gfSA9IHRoaXM7CiAgICAgICAgICB0byA9IHRvOwogICAgICAgICAgdG8uZmluaXNoZWQgPSBmaW5pc2hlZDsKICAgICAgICAgIHRvLmRlc3Ryb3llZCA9IGRlc3Ryb3llZDsKICAgICAgICAgIHRvLmJsb2NrTGVuID0gYmxvY2tMZW47CiAgICAgICAgICB0by5vdXRwdXRMZW4gPSBvdXRwdXRMZW47CiAgICAgICAgICB0by5vSGFzaCA9IG9IYXNoLl9jbG9uZUludG8odG8ub0hhc2gpOwogICAgICAgICAgdG8uaUhhc2ggPSBpSGFzaC5fY2xvbmVJbnRvKHRvLmlIYXNoKTsKICAgICAgICAgIHJldHVybiB0bzsKICAgICAgICB9CiAgICAgICAgZGVzdHJveSgpIHsKICAgICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMub0hhc2guZGVzdHJveSgpOwogICAgICAgICAgdGhpcy5pSGFzaC5kZXN0cm95KCk7CiAgICAgICAgfQogICAgICB9OwogICAgICBobWFjID0gKGhhc2gzLCBrZXksIG1lc3NhZ2UpID0+IG5ldyBITUFDKGhhc2gzLCBrZXkpLnVwZGF0ZShtZXNzYWdlKS5kaWdlc3QoKTsKICAgICAgaG1hYy5jcmVhdGUgPSAoaGFzaDMsIGtleSkgPT4gbmV3IEhNQUMoaGFzaDMsIGtleSk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qcwogIHZhciB1dGlsc19leHBvcnRzID0ge307CiAgX19leHBvcnQodXRpbHNfZXhwb3J0cywgewogICAgYUluUmFuZ2U6ICgpID0+IGFJblJhbmdlLAogICAgYWJvb2w6ICgpID0+IGFib29sLAogICAgYWJ5dGVzOiAoKSA9PiBhYnl0ZXMsCiAgICBiaXRHZXQ6ICgpID0+IGJpdEdldCwKICAgIGJpdExlbjogKCkgPT4gYml0TGVuLAogICAgYml0TWFzazogKCkgPT4gYml0TWFzaywKICAgIGJpdFNldDogKCkgPT4gYml0U2V0LAogICAgYnl0ZXNUb0hleDogKCkgPT4gYnl0ZXNUb0hleDIsCiAgICBieXRlc1RvTnVtYmVyQkU6ICgpID0+IGJ5dGVzVG9OdW1iZXJCRSwKICAgIGJ5dGVzVG9OdW1iZXJMRTogKCkgPT4gYnl0ZXNUb051bWJlckxFLAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMywKICAgIGNyZWF0ZUhtYWNEcmJnOiAoKSA9PiBjcmVhdGVIbWFjRHJiZywKICAgIGVuc3VyZUJ5dGVzOiAoKSA9PiBlbnN1cmVCeXRlcywKICAgIGVxdWFsQnl0ZXM6ICgpID0+IGVxdWFsQnl0ZXMsCiAgICBoZXhUb0J5dGVzOiAoKSA9PiBoZXhUb0J5dGVzMiwKICAgIGhleFRvTnVtYmVyOiAoKSA9PiBoZXhUb051bWJlcjIsCiAgICBpblJhbmdlOiAoKSA9PiBpblJhbmdlLAogICAgaXNCeXRlczogKCkgPT4gaXNCeXRlczIsCiAgICBtZW1vaXplZDogKCkgPT4gbWVtb2l6ZWQsCiAgICBub3RJbXBsZW1lbnRlZDogKCkgPT4gbm90SW1wbGVtZW50ZWQsCiAgICBudW1iZXJUb0J5dGVzQkU6ICgpID0+IG51bWJlclRvQnl0ZXNCRSwKICAgIG51bWJlclRvQnl0ZXNMRTogKCkgPT4gbnVtYmVyVG9CeXRlc0xFLAogICAgbnVtYmVyVG9IZXhVbnBhZGRlZDogKCkgPT4gbnVtYmVyVG9IZXhVbnBhZGRlZCwKICAgIG51bWJlclRvVmFyQnl0ZXNCRTogKCkgPT4gbnVtYmVyVG9WYXJCeXRlc0JFLAogICAgdXRmOFRvQnl0ZXM6ICgpID0+IHV0ZjhUb0J5dGVzMiwKICAgIHZhbGlkYXRlT2JqZWN0OiAoKSA9PiB2YWxpZGF0ZU9iamVjdAogIH0pOwogIGZ1bmN0aW9uIGlzQnl0ZXMyKGEpIHsKICAgIHJldHVybiBhIGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBhICE9IG51bGwgJiYgdHlwZW9mIGEgPT09ICJvYmplY3QiICYmIGEuY29uc3RydWN0b3IubmFtZSA9PT0gIlVpbnQ4QXJyYXkiOwogIH0KICBmdW5jdGlvbiBhYnl0ZXMoaXRlbSkgewogICAgaWYgKCFpc0J5dGVzMihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJVaW50OEFycmF5IGV4cGVjdGVkIik7CiAgfQogIGZ1bmN0aW9uIGFib29sKHRpdGxlLCB2YWx1ZSkgewogICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gImJvb2xlYW4iKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IG11c3QgYmUgdmFsaWQgYm9vbGVhbiwgZ290ICIke3ZhbHVlfSIuYCk7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9IZXgyKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICBsZXQgaGV4ID0gIiI7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ5dGVzMi5sZW5ndGg7IGkrKykgewogICAgICBoZXggKz0gaGV4ZXMyW2J5dGVzMltpXV07CiAgICB9CiAgICByZXR1cm4gaGV4OwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0hleFVucGFkZGVkKG51bTIpIHsKICAgIGNvbnN0IGhleCA9IG51bTIudG9TdHJpbmcoMTYpOwogICAgcmV0dXJuIGhleC5sZW5ndGggJiAxID8gYDAke2hleH1gIDogaGV4OwogIH0KICBmdW5jdGlvbiBoZXhUb051bWJlcjIoaGV4KSB7CiAgICBpZiAodHlwZW9mIGhleCAhPT0gInN0cmluZyIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGV4IHN0cmluZyBleHBlY3RlZCwgZ290ICIgKyB0eXBlb2YgaGV4KTsKICAgIHJldHVybiBCaWdJbnQoaGV4ID09PSAiIiA/ICIwIiA6IGAweCR7aGV4fWApOwogIH0KICBmdW5jdGlvbiBhc2NpaVRvQmFzZTE2KGNoYXIpIHsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fMCAmJiBjaGFyIDw9IGFzY2lpcy5fOSkKICAgICAgcmV0dXJuIGNoYXIgLSBhc2NpaXMuXzA7CiAgICBpZiAoY2hhciA+PSBhc2NpaXMuX0EgJiYgY2hhciA8PSBhc2NpaXMuX0YpCiAgICAgIHJldHVybiBjaGFyIC0gKGFzY2lpcy5fQSAtIDEwKTsKICAgIGlmIChjaGFyID49IGFzY2lpcy5fYSAmJiBjaGFyIDw9IGFzY2lpcy5fZikKICAgICAgcmV0dXJuIGNoYXIgLSAoYXNjaWlzLl9hIC0gMTApOwogICAgcmV0dXJuOwogIH0KICBmdW5jdGlvbiBoZXhUb0J5dGVzMihoZXgpIHsKICAgIGlmICh0eXBlb2YgaGV4ICE9PSAic3RyaW5nIikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgIiArIHR5cGVvZiBoZXgpOwogICAgY29uc3QgaGwgPSBoZXgubGVuZ3RoOwogICAgY29uc3QgYWwgPSBobCAvIDI7CiAgICBpZiAoaGwgJSAyKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInBhZGRlZCBoZXggc3RyaW5nIGV4cGVjdGVkLCBnb3QgdW5wYWRkZWQgaGV4IG9mIGxlbmd0aCAiICsgaGwpOwogICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShhbCk7CiAgICBmb3IgKGxldCBhaSA9IDAsIGhpID0gMDsgYWkgPCBhbDsgYWkrKywgaGkgKz0gMikgewogICAgICBjb25zdCBuMSA9IGFzY2lpVG9CYXNlMTYoaGV4LmNoYXJDb2RlQXQoaGkpKTsKICAgICAgY29uc3QgbjIgPSBhc2NpaVRvQmFzZTE2KGhleC5jaGFyQ29kZUF0KGhpICsgMSkpOwogICAgICBpZiAobjEgPT09IHZvaWQgMCB8fCBuMiA9PT0gdm9pZCAwKSB7CiAgICAgICAgY29uc3QgY2hhciA9IGhleFtoaV0gKyBoZXhbaGkgKyAxXTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2hleCBzdHJpbmcgZXhwZWN0ZWQsIGdvdCBub24taGV4IGNoYXJhY3RlciAiJyArIGNoYXIgKyAnIiBhdCBpbmRleCAnICsgaGkpOwogICAgICB9CiAgICAgIGFycmF5W2FpXSA9IG4xICogMTYgKyBuMjsKICAgIH0KICAgIHJldHVybiBhcnJheTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckJFKGJ5dGVzMikgewogICAgcmV0dXJuIGhleFRvTnVtYmVyMihieXRlc1RvSGV4MihieXRlczIpKTsKICB9CiAgZnVuY3Rpb24gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgewogICAgYWJ5dGVzKGJ5dGVzMik7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIyKGJ5dGVzVG9IZXgyKFVpbnQ4QXJyYXkuZnJvbShieXRlczIpLnJldmVyc2UoKSkpOwogIH0KICBmdW5jdGlvbiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobi50b1N0cmluZygxNikucGFkU3RhcnQobGVuICogMiwgIjAiKSk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvQnl0ZXNMRShuLCBsZW4pIHsKICAgIHJldHVybiBudW1iZXJUb0J5dGVzQkUobiwgbGVuKS5yZXZlcnNlKCk7CiAgfQogIGZ1bmN0aW9uIG51bWJlclRvVmFyQnl0ZXNCRShuKSB7CiAgICByZXR1cm4gaGV4VG9CeXRlczIobnVtYmVyVG9IZXhVbnBhZGRlZChuKSk7CiAgfQogIGZ1bmN0aW9uIGVuc3VyZUJ5dGVzKHRpdGxlLCBoZXgsIGV4cGVjdGVkTGVuZ3RoKSB7CiAgICBsZXQgcmVzOwogICAgaWYgKHR5cGVvZiBoZXggPT09ICJzdHJpbmciKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcmVzID0gaGV4VG9CeXRlczIoaGV4KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSB2YWxpZCBoZXggc3RyaW5nLCBnb3QgIiR7aGV4fSIuIENhdXNlOiAke2V9YCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNCeXRlczIoaGV4KSkgewogICAgICByZXMgPSBVaW50OEFycmF5LmZyb20oaGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aXRsZX0gbXVzdCBiZSBoZXggc3RyaW5nIG9yIFVpbnQ4QXJyYXlgKTsKICAgIH0KICAgIGNvbnN0IGxlbiA9IHJlcy5sZW5ndGg7CiAgICBpZiAodHlwZW9mIGV4cGVjdGVkTGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW4gIT09IGV4cGVjdGVkTGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGl0bGV9IGV4cGVjdGVkICR7ZXhwZWN0ZWRMZW5ndGh9IGJ5dGVzLCBnb3QgJHtsZW59YCk7CiAgICByZXR1cm4gcmVzOwogIH0KICBmdW5jdGlvbiBjb25jYXRCeXRlczMoLi4uYXJyYXlzKSB7CiAgICBsZXQgc3VtID0gMDsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IGEgPSBhcnJheXNbaV07CiAgICAgIGFieXRlcyhhKTsKICAgICAgc3VtICs9IGEubGVuZ3RoOwogICAgfQogICAgY29uc3QgcmVzID0gbmV3IFVpbnQ4QXJyYXkoc3VtKTsKICAgIGZvciAobGV0IGkgPSAwLCBwYWQyID0gMDsgaSA8IGFycmF5cy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBhID0gYXJyYXlzW2ldOwogICAgICByZXMuc2V0KGEsIHBhZDIpOwogICAgICBwYWQyICs9IGEubGVuZ3RoOwogICAgfQogICAgcmV0dXJuIHJlczsKICB9CiAgZnVuY3Rpb24gZXF1YWxCeXRlcyhhLCBiKSB7CiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBsZXQgZGlmZiA9IDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspCiAgICAgIGRpZmYgfD0gYVtpXSBeIGJbaV07CiAgICByZXR1cm4gZGlmZiA9PT0gMDsKICB9CiAgZnVuY3Rpb24gdXRmOFRvQnl0ZXMyKHN0cikgewogICAgaWYgKHR5cGVvZiBzdHIgIT09ICJzdHJpbmciKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYHV0ZjhUb0J5dGVzIGV4cGVjdGVkIHN0cmluZywgZ290ICR7dHlwZW9mIHN0cn1gKTsKICAgIHJldHVybiBuZXcgVWludDhBcnJheShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc3RyKSk7CiAgfQogIGZ1bmN0aW9uIGluUmFuZ2UobiwgbWluLCBtYXgpIHsKICAgIHJldHVybiBpc1Bvc0JpZyhuKSAmJiBpc1Bvc0JpZyhtaW4pICYmIGlzUG9zQmlnKG1heCkgJiYgbWluIDw9IG4gJiYgbiA8IG1heDsKICB9CiAgZnVuY3Rpb24gYUluUmFuZ2UodGl0bGUsIG4sIG1pbiwgbWF4KSB7CiAgICBpZiAoIWluUmFuZ2UobiwgbWluLCBtYXgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkIHZhbGlkICR7dGl0bGV9OiAke21pbn0gPD0gbiA8ICR7bWF4fSwgZ290ICR7dHlwZW9mIG59ICR7bn1gKTsKICB9CiAgZnVuY3Rpb24gYml0TGVuKG4pIHsKICAgIGxldCBsZW47CiAgICBmb3IgKGxlbiA9IDA7IG4gPiBfMG4yOyBuID4+PSBfMW4yLCBsZW4gKz0gMSkKICAgICAgOwogICAgcmV0dXJuIGxlbjsKICB9CiAgZnVuY3Rpb24gYml0R2V0KG4sIHBvcykgewogICAgcmV0dXJuIG4gPj4gQmlnSW50KHBvcykgJiBfMW4yOwogIH0KICBmdW5jdGlvbiBiaXRTZXQobiwgcG9zLCB2YWx1ZSkgewogICAgcmV0dXJuIG4gfCAodmFsdWUgPyBfMW4yIDogXzBuMikgPDwgQmlnSW50KHBvcyk7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUhtYWNEcmJnKGhhc2hMZW4sIHFCeXRlTGVuLCBobWFjRm4pIHsKICAgIGlmICh0eXBlb2YgaGFzaExlbiAhPT0gIm51bWJlciIgfHwgaGFzaExlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaGFzaExlbiBtdXN0IGJlIGEgbnVtYmVyIik7CiAgICBpZiAodHlwZW9mIHFCeXRlTGVuICE9PSAibnVtYmVyIiB8fCBxQnl0ZUxlbiA8IDIpCiAgICAgIHRocm93IG5ldyBFcnJvcigicUJ5dGVMZW4gbXVzdCBiZSBhIG51bWJlciIpOwogICAgaWYgKHR5cGVvZiBobWFjRm4gIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigiaG1hY0ZuIG11c3QgYmUgYSBmdW5jdGlvbiIpOwogICAgbGV0IHYgPSB1OG4oaGFzaExlbik7CiAgICBsZXQgayA9IHU4bihoYXNoTGVuKTsKICAgIGxldCBpID0gMDsKICAgIGNvbnN0IHJlc2V0MiA9ICgpID0+IHsKICAgICAgdi5maWxsKDEpOwogICAgICBrLmZpbGwoMCk7CiAgICAgIGkgPSAwOwogICAgfTsKICAgIGNvbnN0IGggPSAoLi4uYikgPT4gaG1hY0ZuKGssIHYsIC4uLmIpOwogICAgY29uc3QgcmVzZWVkID0gKHNlZWQgPSB1OG4oKSkgPT4gewogICAgICBrID0gaCh1OGZyKFswXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgICBpZiAoc2VlZC5sZW5ndGggPT09IDApCiAgICAgICAgcmV0dXJuOwogICAgICBrID0gaCh1OGZyKFsxXSksIHNlZWQpOwogICAgICB2ID0gaCgpOwogICAgfTsKICAgIGNvbnN0IGdlbjIgPSAoKSA9PiB7CiAgICAgIGlmIChpKysgPj0gMWUzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiZHJiZzogdHJpZWQgMTAwMCB2YWx1ZXMiKTsKICAgICAgbGV0IGxlbiA9IDA7CiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICB3aGlsZSAobGVuIDwgcUJ5dGVMZW4pIHsKICAgICAgICB2ID0gaCgpOwogICAgICAgIGNvbnN0IHNsID0gdi5zbGljZSgpOwogICAgICAgIG91dC5wdXNoKHNsKTsKICAgICAgICBsZW4gKz0gdi5sZW5ndGg7CiAgICAgIH0KICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyguLi5vdXQpOwogICAgfTsKICAgIGNvbnN0IGdlblVudGlsID0gKHNlZWQsIHByZWQpID0+IHsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJlc2VlZChzZWVkKTsKICAgICAgbGV0IHJlcyA9IHZvaWQgMDsKICAgICAgd2hpbGUgKCEocmVzID0gcHJlZChnZW4yKCkpKSkKICAgICAgICByZXNlZWQoKTsKICAgICAgcmVzZXQyKCk7CiAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgcmV0dXJuIGdlblVudGlsOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdChvYmplY3QsIHZhbGlkYXRvcnMsIG9wdFZhbGlkYXRvcnMgPSB7fSkgewogICAgY29uc3QgY2hlY2tGaWVsZCA9IChmaWVsZE5hbWUsIHR5cGUsIGlzT3B0aW9uYWwpID0+IHsKICAgICAgY29uc3QgY2hlY2tWYWwgPSB2YWxpZGF0b3JGbnNbdHlwZV07CiAgICAgIGlmICh0eXBlb2YgY2hlY2tWYWwgIT09ICJmdW5jdGlvbiIpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbGlkYXRvciAiJHt0eXBlfSIsIGV4cGVjdGVkIGZ1bmN0aW9uYCk7CiAgICAgIGNvbnN0IHZhbCA9IG9iamVjdFtmaWVsZE5hbWVdOwogICAgICBpZiAoaXNPcHRpb25hbCAmJiB2YWwgPT09IHZvaWQgMCkKICAgICAgICByZXR1cm47CiAgICAgIGlmICghY2hlY2tWYWwodmFsLCBvYmplY3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHBhcmFtICR7U3RyaW5nKGZpZWxkTmFtZSl9PSR7dmFsfSAoJHt0eXBlb2YgdmFsfSksIGV4cGVjdGVkICR7dHlwZX1gKTsKICAgICAgfQogICAgfTsKICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgdHlwZV0gb2YgT2JqZWN0LmVudHJpZXModmFsaWRhdG9ycykpCiAgICAgIGNoZWNrRmllbGQoZmllbGROYW1lLCB0eXBlLCBmYWxzZSk7CiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIHR5cGVdIG9mIE9iamVjdC5lbnRyaWVzKG9wdFZhbGlkYXRvcnMpKQogICAgICBjaGVja0ZpZWxkKGZpZWxkTmFtZSwgdHlwZSwgdHJ1ZSk7CiAgICByZXR1cm4gb2JqZWN0OwogIH0KICBmdW5jdGlvbiBtZW1vaXplZChmbikgewogICAgY29uc3QgbWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CiAgICByZXR1cm4gKGFyZywgLi4uYXJncykgPT4gewogICAgICBjb25zdCB2YWwgPSBtYXAuZ2V0KGFyZyk7CiAgICAgIGlmICh2YWwgIT09IHZvaWQgMCkKICAgICAgICByZXR1cm4gdmFsOwogICAgICBjb25zdCBjb21wdXRlZCA9IGZuKGFyZywgLi4uYXJncyk7CiAgICAgIG1hcC5zZXQoYXJnLCBjb21wdXRlZCk7CiAgICAgIHJldHVybiBjb21wdXRlZDsKICAgIH07CiAgfQogIHZhciBfMG4yLCBfMW4yLCBfMm4yLCBoZXhlczIsIGFzY2lpcywgaXNQb3NCaWcsIGJpdE1hc2ssIHU4biwgdThmciwgdmFsaWRhdG9yRm5zLCBub3RJbXBsZW1lbnRlZDsKICB2YXIgaW5pdF91dGlsczQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3V0aWxzLmpzIigpIHsKICAgICAgXzBuMiA9IC8qIEBfX1BVUkVfXyAqLyBCaWdJbnQoMCk7CiAgICAgIF8xbjIgPSAvKiBAX19QVVJFX18gKi8gQmlnSW50KDEpOwogICAgICBfMm4yID0gLyogQF9fUFVSRV9fICovIEJpZ0ludCgyKTsKICAgICAgaGV4ZXMyID0gLyogQF9fUFVSRV9fICovIEFycmF5LmZyb20oeyBsZW5ndGg6IDI1NiB9LCAoXywgaSkgPT4gaS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKSk7CiAgICAgIGFzY2lpcyA9IHsgXzA6IDQ4LCBfOTogNTcsIF9BOiA2NSwgX0Y6IDcwLCBfYTogOTcsIF9mOiAxMDIgfTsKICAgICAgaXNQb3NCaWcgPSAobikgPT4gdHlwZW9mIG4gPT09ICJiaWdpbnQiICYmIF8wbjIgPD0gbjsKICAgICAgYml0TWFzayA9IChuKSA9PiAoXzJuMiA8PCBCaWdJbnQobiAtIDEpKSAtIF8xbjI7CiAgICAgIHU4biA9IChkYXRhKSA9PiBuZXcgVWludDhBcnJheShkYXRhKTsKICAgICAgdThmciA9IChhcnIpID0+IFVpbnQ4QXJyYXkuZnJvbShhcnIpOwogICAgICB2YWxpZGF0b3JGbnMgPSB7CiAgICAgICAgYmlnaW50OiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYmlnaW50IiwKICAgICAgICBmdW5jdGlvbjogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiwKICAgICAgICBib29sZWFuOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAiYm9vbGVhbiIsCiAgICAgICAgc3RyaW5nOiAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAic3RyaW5nIiwKICAgICAgICBzdHJpbmdPclVpbnQ4QXJyYXk6ICh2YWwpID0+IHR5cGVvZiB2YWwgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHZhbCksCiAgICAgICAgaXNTYWZlSW50ZWdlcjogKHZhbCkgPT4gTnVtYmVyLmlzU2FmZUludGVnZXIodmFsKSwKICAgICAgICBhcnJheTogKHZhbCkgPT4gQXJyYXkuaXNBcnJheSh2YWwpLAogICAgICAgIGZpZWxkOiAodmFsLCBvYmplY3QpID0+IG9iamVjdC5GcC5pc1ZhbGlkKHZhbCksCiAgICAgICAgaGFzaDogKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIiAmJiBOdW1iZXIuaXNTYWZlSW50ZWdlcih2YWwub3V0cHV0TGVuKQogICAgICB9OwogICAgICBub3RJbXBsZW1lbnRlZCA9ICgpID0+IHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpOwogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvbW9kdWxhci5qcwogIGZ1bmN0aW9uIG1vZChhLCBiKSB7CiAgICBjb25zdCByZXN1bHQgPSBhICUgYjsKICAgIHJldHVybiByZXN1bHQgPj0gXzBuMyA/IHJlc3VsdCA6IGIgKyByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIHBvdyhudW0yLCBwb3dlciwgbW9kdWxvKSB7CiAgICBpZiAobW9kdWxvIDw9IF8wbjMgfHwgcG93ZXIgPCBfMG4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIHBvd2VyL21vZHVsbyA+IDAiKTsKICAgIGlmIChtb2R1bG8gPT09IF8xbjMpCiAgICAgIHJldHVybiBfMG4zOwogICAgbGV0IHJlcyA9IF8xbjM7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcmVzID0gcmVzICogbnVtMiAlIG1vZHVsbzsKICAgICAgbnVtMiA9IG51bTIgKiBudW0yICUgbW9kdWxvOwogICAgICBwb3dlciA+Pj0gXzFuMzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIHBvdzIoeCwgcG93ZXIsIG1vZHVsbykgewogICAgbGV0IHJlcyA9IHg7CiAgICB3aGlsZSAocG93ZXItLSA+IF8wbjMpIHsKICAgICAgcmVzICo9IHJlczsKICAgICAgcmVzICU9IG1vZHVsbzsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQogIGZ1bmN0aW9uIGludmVydChudW1iZXIyLCBtb2R1bG8pIHsKICAgIGlmIChudW1iZXIyID09PSBfMG4zIHx8IG1vZHVsbyA8PSBfMG4zKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgaW52ZXJ0OiBleHBlY3RlZCBwb3NpdGl2ZSBpbnRlZ2VycywgZ290IG49JHtudW1iZXIyfSBtb2Q9JHttb2R1bG99YCk7CiAgICB9CiAgICBsZXQgYSA9IG1vZChudW1iZXIyLCBtb2R1bG8pOwogICAgbGV0IGIgPSBtb2R1bG87CiAgICBsZXQgeCA9IF8wbjMsIHkgPSBfMW4zLCB1ID0gXzFuMywgdiA9IF8wbjM7CiAgICB3aGlsZSAoYSAhPT0gXzBuMykgewogICAgICBjb25zdCBxID0gYiAvIGE7CiAgICAgIGNvbnN0IHIgPSBiICUgYTsKICAgICAgY29uc3QgbSA9IHggLSB1ICogcTsKICAgICAgY29uc3QgbiA9IHkgLSB2ICogcTsKICAgICAgYiA9IGEsIGEgPSByLCB4ID0gdSwgeSA9IHYsIHUgPSBtLCB2ID0gbjsKICAgIH0KICAgIGNvbnN0IGdjZCA9IGI7CiAgICBpZiAoZ2NkICE9PSBfMW4zKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImludmVydDogZG9lcyBub3QgZXhpc3QiKTsKICAgIHJldHVybiBtb2QoeCwgbW9kdWxvKTsKICB9CiAgZnVuY3Rpb24gdG9uZWxsaVNoYW5rcyhQKSB7CiAgICBjb25zdCBsZWdlbmRyZUMgPSAoUCAtIF8xbjMpIC8gXzJuMzsKICAgIGxldCBRLCBTLCBaOwogICAgZm9yIChRID0gUCAtIF8xbjMsIFMgPSAwOyBRICUgXzJuMyA9PT0gXzBuMzsgUSAvPSBfMm4zLCBTKyspCiAgICAgIDsKICAgIGZvciAoWiA9IF8ybjM7IFogPCBQICYmIHBvdyhaLCBsZWdlbmRyZUMsIFApICE9PSBQIC0gXzFuMzsgWisrKQogICAgICA7CiAgICBpZiAoUyA9PT0gMSkgewogICAgICBjb25zdCBwMWRpdjQgPSAoUCArIF8xbjMpIC8gXzRuOwogICAgICByZXR1cm4gZnVuY3Rpb24gdG9uZWxsaUZhc3QoRnAyLCBuKSB7CiAgICAgICAgY29uc3Qgcm9vdDIgPSBGcDIucG93KG4sIHAxZGl2NCk7CiAgICAgICAgaWYgKCFGcDIuZXFsKEZwMi5zcXIocm9vdDIpLCBuKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgICAgICByZXR1cm4gcm9vdDI7CiAgICAgIH07CiAgICB9CiAgICBjb25zdCBRMWRpdjIgPSAoUSArIF8xbjMpIC8gXzJuMzsKICAgIHJldHVybiBmdW5jdGlvbiB0b25lbGxpU2xvdyhGcDIsIG4pIHsKICAgICAgaWYgKEZwMi5wb3cobiwgbGVnZW5kcmVDKSA9PT0gRnAyLm5lZyhGcDIuT05FKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgIGxldCByID0gUzsKICAgICAgbGV0IGcgPSBGcDIucG93KEZwMi5tdWwoRnAyLk9ORSwgWiksIFEpOwogICAgICBsZXQgeCA9IEZwMi5wb3cobiwgUTFkaXYyKTsKICAgICAgbGV0IGIgPSBGcDIucG93KG4sIFEpOwogICAgICB3aGlsZSAoIUZwMi5lcWwoYiwgRnAyLk9ORSkpIHsKICAgICAgICBpZiAoRnAyLmVxbChiLCBGcDIuWkVSTykpCiAgICAgICAgICByZXR1cm4gRnAyLlpFUk87CiAgICAgICAgbGV0IG0gPSAxOwogICAgICAgIGZvciAobGV0IHQyID0gRnAyLnNxcihiKTsgbSA8IHI7IG0rKykgewogICAgICAgICAgaWYgKEZwMi5lcWwodDIsIEZwMi5PTkUpKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIHQyID0gRnAyLnNxcih0Mik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGdlID0gRnAyLnBvdyhnLCBfMW4zIDw8IEJpZ0ludChyIC0gbSAtIDEpKTsKICAgICAgICBnID0gRnAyLnNxcihnZSk7CiAgICAgICAgeCA9IEZwMi5tdWwoeCwgZ2UpOwogICAgICAgIGIgPSBGcDIubXVsKGIsIGcpOwogICAgICAgIHIgPSBtOwogICAgICB9CiAgICAgIHJldHVybiB4OwogICAgfTsKICB9CiAgZnVuY3Rpb24gRnBTcXJ0KFApIHsKICAgIGlmIChQICUgXzRuID09PSBfM24pIHsKICAgICAgY29uc3QgcDFkaXY0ID0gKFAgKyBfMW4zKSAvIF80bjsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNxcnQzbW9kNChGcDIsIG4pIHsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5wb3cobiwgcDFkaXY0KTsKICAgICAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihyb290MiksIG4pKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBzcXVhcmUgcm9vdCIpOwogICAgICAgIHJldHVybiByb290MjsKICAgICAgfTsKICAgIH0KICAgIGlmIChQICUgXzhuID09PSBfNW4pIHsKICAgICAgY29uc3QgYzEgPSAoUCAtIF81bikgLyBfOG47CiAgICAgIHJldHVybiBmdW5jdGlvbiBzcXJ0NW1vZDgoRnAyLCBuKSB7CiAgICAgICAgY29uc3QgbjIgPSBGcDIubXVsKG4sIF8ybjMpOwogICAgICAgIGNvbnN0IHYgPSBGcDIucG93KG4yLCBjMSk7CiAgICAgICAgY29uc3QgbnYgPSBGcDIubXVsKG4sIHYpOwogICAgICAgIGNvbnN0IGkgPSBGcDIubXVsKEZwMi5tdWwobnYsIF8ybjMpLCB2KTsKICAgICAgICBjb25zdCByb290MiA9IEZwMi5tdWwobnYsIEZwMi5zdWIoaSwgRnAyLk9ORSkpOwogICAgICAgIGlmICghRnAyLmVxbChGcDIuc3FyKHJvb3QyKSwgbikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIHNxdWFyZSByb290Iik7CiAgICAgICAgcmV0dXJuIHJvb3QyOwogICAgICB9OwogICAgfQogICAgaWYgKFAgJSBfMTZuID09PSBfOW4pIHsKICAgIH0KICAgIHJldHVybiB0b25lbGxpU2hhbmtzKFApOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7CiAgICBjb25zdCBpbml0aWFsID0gewogICAgICBPUkRFUjogImJpZ2ludCIsCiAgICAgIE1BU0s6ICJiaWdpbnQiLAogICAgICBCWVRFUzogImlzU2FmZUludGVnZXIiLAogICAgICBCSVRTOiAiaXNTYWZlSW50ZWdlciIKICAgIH07CiAgICBjb25zdCBvcHRzID0gRklFTERfRklFTERTLnJlZHVjZSgobWFwLCB2YWwpID0+IHsKICAgICAgbWFwW3ZhbF0gPSAiZnVuY3Rpb24iOwogICAgICByZXR1cm4gbWFwOwogICAgfSwgaW5pdGlhbCk7CiAgICByZXR1cm4gdmFsaWRhdGVPYmplY3QoZmllbGQsIG9wdHMpOwogIH0KICBmdW5jdGlvbiBGcFBvdyhmMiwgbnVtMiwgcG93ZXIpIHsKICAgIGlmIChwb3dlciA8IF8wbjMpCiAgICAgIHRocm93IG5ldyBFcnJvcigiRXhwZWN0ZWQgcG93ZXIgPiAwIik7CiAgICBpZiAocG93ZXIgPT09IF8wbjMpCiAgICAgIHJldHVybiBmMi5PTkU7CiAgICBpZiAocG93ZXIgPT09IF8xbjMpCiAgICAgIHJldHVybiBudW0yOwogICAgbGV0IHAgPSBmMi5PTkU7CiAgICBsZXQgZCA9IG51bTI7CiAgICB3aGlsZSAocG93ZXIgPiBfMG4zKSB7CiAgICAgIGlmIChwb3dlciAmIF8xbjMpCiAgICAgICAgcCA9IGYyLm11bChwLCBkKTsKICAgICAgZCA9IGYyLnNxcihkKTsKICAgICAgcG93ZXIgPj49IF8xbjM7CiAgICB9CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gRnBJbnZlcnRCYXRjaChmMiwgbnVtcykgewogICAgY29uc3QgdG1wID0gbmV3IEFycmF5KG51bXMubGVuZ3RoKTsKICAgIGNvbnN0IGxhc3RNdWx0aXBsaWVkID0gbnVtcy5yZWR1Y2UoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGFjYzsKICAgICAgcmV0dXJuIGYyLm11bChhY2MsIG51bTIpOwogICAgfSwgZjIuT05FKTsKICAgIGNvbnN0IGludmVydGVkID0gZjIuaW52KGxhc3RNdWx0aXBsaWVkKTsKICAgIG51bXMucmVkdWNlUmlnaHQoKGFjYywgbnVtMiwgaSkgPT4gewogICAgICBpZiAoZjIuaXMwKG51bTIpKQogICAgICAgIHJldHVybiBhY2M7CiAgICAgIHRtcFtpXSA9IGYyLm11bChhY2MsIHRtcFtpXSk7CiAgICAgIHJldHVybiBmMi5tdWwoYWNjLCBudW0yKTsKICAgIH0sIGludmVydGVkKTsKICAgIHJldHVybiB0bXA7CiAgfQogIGZ1bmN0aW9uIG5MZW5ndGgobiwgbkJpdExlbmd0aCkgewogICAgY29uc3QgX25CaXRMZW5ndGggPSBuQml0TGVuZ3RoICE9PSB2b2lkIDAgPyBuQml0TGVuZ3RoIDogbi50b1N0cmluZygyKS5sZW5ndGg7CiAgICBjb25zdCBuQnl0ZUxlbmd0aCA9IE1hdGguY2VpbChfbkJpdExlbmd0aCAvIDgpOwogICAgcmV0dXJuIHsgbkJpdExlbmd0aDogX25CaXRMZW5ndGgsIG5CeXRlTGVuZ3RoIH07CiAgfQogIGZ1bmN0aW9uIEZpZWxkKE9SREVSLCBiaXRMZW4yLCBpc0xFMiA9IGZhbHNlLCByZWRlZiA9IHt9KSB7CiAgICBpZiAoT1JERVIgPD0gXzBuMykKICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBGaWVsZCBPUkRFUiA+IDAsIGdvdCAke09SREVSfWApOwogICAgY29uc3QgeyBuQml0TGVuZ3RoOiBCSVRTLCBuQnl0ZUxlbmd0aDogQllURVMgfSA9IG5MZW5ndGgoT1JERVIsIGJpdExlbjIpOwogICAgaWYgKEJZVEVTID4gMjA0OCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGaWVsZCBsZW5ndGhzIG92ZXIgMjA0OCBieXRlcyBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgY29uc3Qgc3FydFAgPSBGcFNxcnQoT1JERVIpOwogICAgY29uc3QgZjIgPSBPYmplY3QuZnJlZXplKHsKICAgICAgT1JERVIsCiAgICAgIEJJVFMsCiAgICAgIEJZVEVTLAogICAgICBNQVNLOiBiaXRNYXNrKEJJVFMpLAogICAgICBaRVJPOiBfMG4zLAogICAgICBPTkU6IF8xbjMsCiAgICAgIGNyZWF0ZTogKG51bTIpID0+IG1vZChudW0yLCBPUkRFUiksCiAgICAgIGlzVmFsaWQ6IChudW0yKSA9PiB7CiAgICAgICAgaWYgKHR5cGVvZiBudW0yICE9PSAiYmlnaW50IikKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBmaWVsZCBlbGVtZW50OiBleHBlY3RlZCBiaWdpbnQsIGdvdCAke3R5cGVvZiBudW0yfWApOwogICAgICAgIHJldHVybiBfMG4zIDw9IG51bTIgJiYgbnVtMiA8IE9SREVSOwogICAgICB9LAogICAgICBpczA6IChudW0yKSA9PiBudW0yID09PSBfMG4zLAogICAgICBpc09kZDogKG51bTIpID0+IChudW0yICYgXzFuMykgPT09IF8xbjMsCiAgICAgIG5lZzogKG51bTIpID0+IG1vZCgtbnVtMiwgT1JERVIpLAogICAgICBlcWw6IChsaHMsIHJocykgPT4gbGhzID09PSByaHMsCiAgICAgIHNxcjogKG51bTIpID0+IG1vZChudW0yICogbnVtMiwgT1JERVIpLAogICAgICBhZGQ6IChsaHMsIHJocykgPT4gbW9kKGxocyArIHJocywgT1JERVIpLAogICAgICBzdWI6IChsaHMsIHJocykgPT4gbW9kKGxocyAtIHJocywgT1JERVIpLAogICAgICBtdWw6IChsaHMsIHJocykgPT4gbW9kKGxocyAqIHJocywgT1JERVIpLAogICAgICBwb3c6IChudW0yLCBwb3dlcikgPT4gRnBQb3coZjIsIG51bTIsIHBvd2VyKSwKICAgICAgZGl2OiAobGhzLCByaHMpID0+IG1vZChsaHMgKiBpbnZlcnQocmhzLCBPUkRFUiksIE9SREVSKSwKICAgICAgLy8gU2FtZSBhcyBhYm92ZSwgYnV0IGRvZXNuJ3Qgbm9ybWFsaXplCiAgICAgIHNxck46IChudW0yKSA9PiBudW0yICogbnVtMiwKICAgICAgYWRkTjogKGxocywgcmhzKSA9PiBsaHMgKyByaHMsCiAgICAgIHN1Yk46IChsaHMsIHJocykgPT4gbGhzIC0gcmhzLAogICAgICBtdWxOOiAobGhzLCByaHMpID0+IGxocyAqIHJocywKICAgICAgaW52OiAobnVtMikgPT4gaW52ZXJ0KG51bTIsIE9SREVSKSwKICAgICAgc3FydDogcmVkZWYuc3FydCB8fCAoKG4pID0+IHNxcnRQKGYyLCBuKSksCiAgICAgIGludmVydEJhdGNoOiAobHN0KSA9PiBGcEludmVydEJhdGNoKGYyLCBsc3QpLAogICAgICAvLyBUT0RPOiBkbyB3ZSByZWFsbHkgbmVlZCBjb25zdGFudCBjbW92PwogICAgICAvLyBXZSBkb24ndCBoYXZlIGNvbnN0LXRpbWUgYmlnaW50cyBhbnl3YXksIHNvIHByb2JhYmx5IHdpbGwgYmUgbm90IHZlcnkgdXNlZnVsCiAgICAgIGNtb3Y6IChhLCBiLCBjKSA9PiBjID8gYiA6IGEsCiAgICAgIHRvQnl0ZXM6IChudW0yKSA9PiBpc0xFMiA/IG51bWJlclRvQnl0ZXNMRShudW0yLCBCWVRFUykgOiBudW1iZXJUb0J5dGVzQkUobnVtMiwgQllURVMpLAogICAgICBmcm9tQnl0ZXM6IChieXRlczIpID0+IHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCAhPT0gQllURVMpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZwLmZyb21CeXRlczogZXhwZWN0ZWQgJHtCWVRFU30sIGdvdCAke2J5dGVzMi5sZW5ndGh9YCk7CiAgICAgICAgcmV0dXJuIGlzTEUyID8gYnl0ZXNUb051bWJlckxFKGJ5dGVzMikgOiBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZShmMik7CiAgfQogIGZ1bmN0aW9uIGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcikgewogICAgaWYgKHR5cGVvZiBmaWVsZE9yZGVyICE9PSAiYmlnaW50IikKICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaWVsZCBvcmRlciBtdXN0IGJlIGJpZ2ludCIpOwogICAgY29uc3QgYml0TGVuZ3RoID0gZmllbGRPcmRlci50b1N0cmluZygyKS5sZW5ndGg7CiAgICByZXR1cm4gTWF0aC5jZWlsKGJpdExlbmd0aCAvIDgpOwogIH0KICBmdW5jdGlvbiBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpIHsKICAgIGNvbnN0IGxlbmd0aCA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICByZXR1cm4gbGVuZ3RoICsgTWF0aC5jZWlsKGxlbmd0aCAvIDIpOwogIH0KICBmdW5jdGlvbiBtYXBIYXNoVG9GaWVsZChrZXksIGZpZWxkT3JkZXIsIGlzTEUyID0gZmFsc2UpIHsKICAgIGNvbnN0IGxlbiA9IGtleS5sZW5ndGg7CiAgICBjb25zdCBmaWVsZExlbiA9IGdldEZpZWxkQnl0ZXNMZW5ndGgoZmllbGRPcmRlcik7CiAgICBjb25zdCBtaW5MZW4gPSBnZXRNaW5IYXNoTGVuZ3RoKGZpZWxkT3JkZXIpOwogICAgaWYgKGxlbiA8IDE2IHx8IGxlbiA8IG1pbkxlbiB8fCBsZW4gPiAxMDI0KQogICAgICB0aHJvdyBuZXcgRXJyb3IoYGV4cGVjdGVkICR7bWluTGVufS0xMDI0IGJ5dGVzIG9mIGlucHV0LCBnb3QgJHtsZW59YCk7CiAgICBjb25zdCBudW0yID0gaXNMRTIgPyBieXRlc1RvTnVtYmVyQkUoa2V5KSA6IGJ5dGVzVG9OdW1iZXJMRShrZXkpOwogICAgY29uc3QgcmVkdWNlZCA9IG1vZChudW0yLCBmaWVsZE9yZGVyIC0gXzFuMykgKyBfMW4zOwogICAgcmV0dXJuIGlzTEUyID8gbnVtYmVyVG9CeXRlc0xFKHJlZHVjZWQsIGZpZWxkTGVuKSA6IG51bWJlclRvQnl0ZXNCRShyZWR1Y2VkLCBmaWVsZExlbik7CiAgfQogIHZhciBfMG4zLCBfMW4zLCBfMm4zLCBfM24sIF80biwgXzVuLCBfOG4sIF85biwgXzE2biwgRklFTERfRklFTERTOwogIHZhciBpbml0X21vZHVsYXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L21vZHVsYXIuanMiKCkgewogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBfMG4zID0gQmlnSW50KDApOwogICAgICBfMW4zID0gQmlnSW50KDEpOwogICAgICBfMm4zID0gQmlnSW50KDIpOwogICAgICBfM24gPSBCaWdJbnQoMyk7CiAgICAgIF80biA9IEJpZ0ludCg0KTsKICAgICAgXzVuID0gQmlnSW50KDUpOwogICAgICBfOG4gPSBCaWdJbnQoOCk7CiAgICAgIF85biA9IEJpZ0ludCg5KTsKICAgICAgXzE2biA9IEJpZ0ludCgxNik7CiAgICAgIEZJRUxEX0ZJRUxEUyA9IFsKICAgICAgICAiY3JlYXRlIiwKICAgICAgICAiaXNWYWxpZCIsCiAgICAgICAgImlzMCIsCiAgICAgICAgIm5lZyIsCiAgICAgICAgImludiIsCiAgICAgICAgInNxcnQiLAogICAgICAgICJzcXIiLAogICAgICAgICJlcWwiLAogICAgICAgICJhZGQiLAogICAgICAgICJzdWIiLAogICAgICAgICJtdWwiLAogICAgICAgICJwb3ciLAogICAgICAgICJkaXYiLAogICAgICAgICJhZGROIiwKICAgICAgICAic3ViTiIsCiAgICAgICAgIm11bE4iLAogICAgICAgICJzcXJOIgogICAgICBdOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvY3VydmUuanMKICBmdW5jdGlvbiB3TkFGKGMsIGJpdHMpIHsKICAgIGNvbnN0IGNvbnN0VGltZU5lZ2F0ZSA9IChjb25kaXRpb24sIGl0ZW0pID0+IHsKICAgICAgY29uc3QgbmVnID0gaXRlbS5uZWdhdGUoKTsKICAgICAgcmV0dXJuIGNvbmRpdGlvbiA/IG5lZyA6IGl0ZW07CiAgICB9OwogICAgY29uc3QgdmFsaWRhdGVXID0gKFcpID0+IHsKICAgICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihXKSB8fCBXIDw9IDAgfHwgVyA+IGJpdHMpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBXcm9uZyB3aW5kb3cgc2l6ZT0ke1d9LCBzaG91bGQgYmUgWzEuLiR7Yml0c31dYCk7CiAgICB9OwogICAgY29uc3Qgb3B0cyA9IChXKSA9PiB7CiAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgY29uc3Qgd2luZG93cyA9IE1hdGguY2VpbChiaXRzIC8gVykgKyAxOwogICAgICBjb25zdCB3aW5kb3dTaXplID0gMiAqKiAoVyAtIDEpOwogICAgICByZXR1cm4geyB3aW5kb3dzLCB3aW5kb3dTaXplIH07CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgY29uc3RUaW1lTmVnYXRlLAogICAgICAvLyBub24tY29uc3QgdGltZSBtdWx0aXBsaWNhdGlvbiBsYWRkZXIKICAgICAgdW5zYWZlTGFkZGVyKGVsbSwgbikgewogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBkID0gZWxtOwogICAgICAgIHdoaWxlIChuID4gXzBuNCkgewogICAgICAgICAgaWYgKG4gJiBfMW40KQogICAgICAgICAgICBwID0gcC5hZGQoZCk7CiAgICAgICAgICBkID0gZC5kb3VibGUoKTsKICAgICAgICAgIG4gPj49IF8xbjQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwOwogICAgICB9LAogICAgICAvKioKICAgICAgICogQ3JlYXRlcyBhIHdOQUYgcHJlY29tcHV0YXRpb24gd2luZG93LiBVc2VkIGZvciBjYWNoaW5nLgogICAgICAgKiBEZWZhdWx0IHdpbmRvdyBzaXplIGlzIHNldCBieSBgdXRpbHMucHJlY29tcHV0ZSgpYCBhbmQgaXMgZXF1YWwgdG8gOC4KICAgICAgICogTnVtYmVyIG9mIHByZWNvbXB1dGVkIHBvaW50cyBkZXBlbmRzIG9uIHRoZSBjdXJ2ZSBzaXplOgogICAgICAgKiAyXijwnZGK4oiSMSkgKiAoTWF0aC5jZWlsKPCdkZsgLyDwnZGKKSArIDEpLCB3aGVyZToKICAgICAgICogLSDwnZGKIGlzIHRoZSB3aW5kb3cgc2l6ZQogICAgICAgKiAtIPCdkZsgaXMgdGhlIGJpdGxlbmd0aCBvZiB0aGUgY3VydmUgb3JkZXIuCiAgICAgICAqIEZvciBhIDI1Ni1iaXQgY3VydmUgYW5kIHdpbmRvdyBzaXplIDgsIHRoZSBudW1iZXIgb2YgcHJlY29tcHV0ZWQgcG9pbnRzIGlzIDEyOCAqIDMzID0gNDIyNC4KICAgICAgICogQHJldHVybnMgcHJlY29tcHV0ZWQgcG9pbnQgdGFibGVzIGZsYXR0ZW5lZCB0byBhIHNpbmdsZSBhcnJheQogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZVdpbmRvdyhlbG0sIFcpIHsKICAgICAgICBjb25zdCB7IHdpbmRvd3MsIHdpbmRvd1NpemUgfSA9IG9wdHMoVyk7CiAgICAgICAgY29uc3QgcG9pbnRzID0gW107CiAgICAgICAgbGV0IHAgPSBlbG07CiAgICAgICAgbGV0IGJhc2UyID0gcDsKICAgICAgICBmb3IgKGxldCB3aW5kb3cyID0gMDsgd2luZG93MiA8IHdpbmRvd3M7IHdpbmRvdzIrKykgewogICAgICAgICAgYmFzZTIgPSBwOwogICAgICAgICAgcG9pbnRzLnB1c2goYmFzZTIpOwogICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB3aW5kb3dTaXplOyBpKyspIHsKICAgICAgICAgICAgYmFzZTIgPSBiYXNlMi5hZGQocCk7CiAgICAgICAgICAgIHBvaW50cy5wdXNoKGJhc2UyKTsKICAgICAgICAgIH0KICAgICAgICAgIHAgPSBiYXNlMi5kb3VibGUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBvaW50czsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIEltcGxlbWVudHMgZWMgbXVsdGlwbGljYXRpb24gdXNpbmcgcHJlY29tcHV0ZWQgdGFibGVzIGFuZCB3LWFyeSBub24tYWRqYWNlbnQgZm9ybS4KICAgICAgICogQHBhcmFtIFcgd2luZG93IHNpemUKICAgICAgICogQHBhcmFtIHByZWNvbXB1dGVzIHByZWNvbXB1dGVkIHRhYmxlcwogICAgICAgKiBAcGFyYW0gbiBzY2FsYXIgKHdlIGRvbid0IGNoZWNrIGhlcmUsIGJ1dCBzaG91bGQgYmUgbGVzcyB0aGFuIGN1cnZlIG9yZGVyKQogICAgICAgKiBAcmV0dXJucyByZWFsIGFuZCBmYWtlIChmb3IgY29uc3QtdGltZSkgcG9pbnRzCiAgICAgICAqLwogICAgICB3TkFGKFcsIHByZWNvbXB1dGVzLCBuKSB7CiAgICAgICAgY29uc3QgeyB3aW5kb3dzLCB3aW5kb3dTaXplIH0gPSBvcHRzKFcpOwogICAgICAgIGxldCBwID0gYy5aRVJPOwogICAgICAgIGxldCBmMiA9IGMuQkFTRTsKICAgICAgICBjb25zdCBtYXNrID0gQmlnSW50KDIgKiogVyAtIDEpOwogICAgICAgIGNvbnN0IG1heE51bWJlciA9IDIgKiogVzsKICAgICAgICBjb25zdCBzaGlmdEJ5ID0gQmlnSW50KFcpOwogICAgICAgIGZvciAobGV0IHdpbmRvdzIgPSAwOyB3aW5kb3cyIDwgd2luZG93czsgd2luZG93MisrKSB7CiAgICAgICAgICBjb25zdCBvZmZzZXQgPSB3aW5kb3cyICogd2luZG93U2l6ZTsKICAgICAgICAgIGxldCB3Yml0cyA9IE51bWJlcihuICYgbWFzayk7CiAgICAgICAgICBuID4+PSBzaGlmdEJ5OwogICAgICAgICAgaWYgKHdiaXRzID4gd2luZG93U2l6ZSkgewogICAgICAgICAgICB3Yml0cyAtPSBtYXhOdW1iZXI7CiAgICAgICAgICAgIG4gKz0gXzFuNDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IG9mZnNldDEgPSBvZmZzZXQ7CiAgICAgICAgICBjb25zdCBvZmZzZXQyID0gb2Zmc2V0ICsgTWF0aC5hYnMod2JpdHMpIC0gMTsKICAgICAgICAgIGNvbnN0IGNvbmQxID0gd2luZG93MiAlIDIgIT09IDA7CiAgICAgICAgICBjb25zdCBjb25kMiA9IHdiaXRzIDwgMDsKICAgICAgICAgIGlmICh3Yml0cyA9PT0gMCkgewogICAgICAgICAgICBmMiA9IGYyLmFkZChjb25zdFRpbWVOZWdhdGUoY29uZDEsIHByZWNvbXB1dGVzW29mZnNldDFdKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwID0gcC5hZGQoY29uc3RUaW1lTmVnYXRlKGNvbmQyLCBwcmVjb21wdXRlc1tvZmZzZXQyXSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4geyBwLCBmOiBmMiB9OwogICAgICB9LAogICAgICB3TkFGQ2FjaGVkKFAsIG4sIHRyYW5zZm9ybSkgewogICAgICAgIGNvbnN0IFcgPSBwb2ludFdpbmRvd1NpemVzLmdldChQKSB8fCAxOwogICAgICAgIGxldCBjb21wID0gcG9pbnRQcmVjb21wdXRlcy5nZXQoUCk7CiAgICAgICAgaWYgKCFjb21wKSB7CiAgICAgICAgICBjb21wID0gdGhpcy5wcmVjb21wdXRlV2luZG93KFAsIFcpOwogICAgICAgICAgaWYgKFcgIT09IDEpCiAgICAgICAgICAgIHBvaW50UHJlY29tcHV0ZXMuc2V0KFAsIHRyYW5zZm9ybShjb21wKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLndOQUYoVywgY29tcCwgbik7CiAgICAgIH0sCiAgICAgIC8vIFdlIGNhbGN1bGF0ZSBwcmVjb21wdXRlcyBmb3IgZWxsaXB0aWMgY3VydmUgcG9pbnQgbXVsdGlwbGljYXRpb24KICAgICAgLy8gdXNpbmcgd2luZG93ZWQgbWV0aG9kLiBUaGlzIHNwZWNpZmllcyB3aW5kb3cgc2l6ZSBhbmQKICAgICAgLy8gc3RvcmVzIHByZWNvbXB1dGVkIHZhbHVlcy4gVXN1YWxseSBvbmx5IGJhc2UgcG9pbnQgd291bGQgYmUgcHJlY29tcHV0ZWQuCiAgICAgIHNldFdpbmRvd1NpemUoUCwgVykgewogICAgICAgIHZhbGlkYXRlVyhXKTsKICAgICAgICBwb2ludFdpbmRvd1NpemVzLnNldChQLCBXKTsKICAgICAgICBwb2ludFByZWNvbXB1dGVzLmRlbGV0ZShQKTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gcGlwcGVuZ2VyKGMsIGZpZWxkLCBwb2ludHMsIHNjYWxhcnMpIHsKICAgIGlmICghQXJyYXkuaXNBcnJheShwb2ludHMpIHx8ICFBcnJheS5pc0FycmF5KHNjYWxhcnMpIHx8IHNjYWxhcnMubGVuZ3RoICE9PSBwb2ludHMubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgRXJyb3IoImFycmF5cyBvZiBwb2ludHMgYW5kIHNjYWxhcnMgbXVzdCBoYXZlIGVxdWFsIGxlbmd0aCIpOwogICAgc2NhbGFycy5mb3JFYWNoKChzLCBpKSA9PiB7CiAgICAgIGlmICghZmllbGQuaXNWYWxpZChzKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHNjYWxhciBhdCBpbmRleCAke2l9YCk7CiAgICB9KTsKICAgIHBvaW50cy5mb3JFYWNoKChwLCBpKSA9PiB7CiAgICAgIGlmICghKHAgaW5zdGFuY2VvZiBjKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHdyb25nIHBvaW50IGF0IGluZGV4ICR7aX1gKTsKICAgIH0pOwogICAgY29uc3Qgd2JpdHMgPSBiaXRMZW4oQmlnSW50KHBvaW50cy5sZW5ndGgpKTsKICAgIGNvbnN0IHdpbmRvd1NpemUgPSB3Yml0cyA+IDEyID8gd2JpdHMgLSAzIDogd2JpdHMgPiA0ID8gd2JpdHMgLSAyIDogd2JpdHMgPyAyIDogMTsKICAgIGNvbnN0IE1BU0sgPSAoMSA8PCB3aW5kb3dTaXplKSAtIDE7CiAgICBjb25zdCBidWNrZXRzID0gbmV3IEFycmF5KE1BU0sgKyAxKS5maWxsKGMuWkVSTyk7CiAgICBjb25zdCBsYXN0Qml0cyA9IE1hdGguZmxvb3IoKGZpZWxkLkJJVFMgLSAxKSAvIHdpbmRvd1NpemUpICogd2luZG93U2l6ZTsKICAgIGxldCBzdW0gPSBjLlpFUk87CiAgICBmb3IgKGxldCBpID0gbGFzdEJpdHM7IGkgPj0gMDsgaSAtPSB3aW5kb3dTaXplKSB7CiAgICAgIGJ1Y2tldHMuZmlsbChjLlpFUk8pOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNjYWxhcnMubGVuZ3RoOyBqKyspIHsKICAgICAgICBjb25zdCBzY2FsYXIgPSBzY2FsYXJzW2pdOwogICAgICAgIGNvbnN0IHdiaXRzMiA9IE51bWJlcihzY2FsYXIgPj4gQmlnSW50KGkpICYgQmlnSW50KE1BU0spKTsKICAgICAgICBidWNrZXRzW3diaXRzMl0gPSBidWNrZXRzW3diaXRzMl0uYWRkKHBvaW50c1tqXSk7CiAgICAgIH0KICAgICAgbGV0IHJlc0kgPSBjLlpFUk87CiAgICAgIGZvciAobGV0IGogPSBidWNrZXRzLmxlbmd0aCAtIDEsIHN1bUkgPSBjLlpFUk87IGogPiAwOyBqLS0pIHsKICAgICAgICBzdW1JID0gc3VtSS5hZGQoYnVja2V0c1tqXSk7CiAgICAgICAgcmVzSSA9IHJlc0kuYWRkKHN1bUkpOwogICAgICB9CiAgICAgIHN1bSA9IHN1bS5hZGQocmVzSSk7CiAgICAgIGlmIChpICE9PSAwKQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd2luZG93U2l6ZTsgaisrKQogICAgICAgICAgc3VtID0gc3VtLmRvdWJsZSgpOwogICAgfQogICAgcmV0dXJuIHN1bTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVCYXNpYyhjdXJ2ZSkgewogICAgdmFsaWRhdGVGaWVsZChjdXJ2ZS5GcCk7CiAgICB2YWxpZGF0ZU9iamVjdChjdXJ2ZSwgewogICAgICBuOiAiYmlnaW50IiwKICAgICAgaDogImJpZ2ludCIsCiAgICAgIEd4OiAiZmllbGQiLAogICAgICBHeTogImZpZWxkIgogICAgfSwgewogICAgICBuQml0TGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIG5CeXRlTGVuZ3RoOiAiaXNTYWZlSW50ZWdlciIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoewogICAgICAuLi5uTGVuZ3RoKGN1cnZlLm4sIGN1cnZlLm5CaXRMZW5ndGgpLAogICAgICAuLi5jdXJ2ZSwKICAgICAgLi4ueyBwOiBjdXJ2ZS5GcC5PUkRFUiB9CiAgICB9KTsKICB9CiAgdmFyIF8wbjQsIF8xbjQsIHBvaW50UHJlY29tcHV0ZXMsIHBvaW50V2luZG93U2l6ZXM7CiAgdmFyIGluaXRfY3VydmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzIigpIHsKICAgICAgaW5pdF9tb2R1bGFyKCk7CiAgICAgIGluaXRfdXRpbHM0KCk7CiAgICAgIF8wbjQgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjQgPSBCaWdJbnQoMSk7CiAgICAgIHBvaW50UHJlY29tcHV0ZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKICAgICAgcG9pbnRXaW5kb3dTaXplcyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3Qvd2VpZXJzdHJhc3MuanMKICBmdW5jdGlvbiB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cykgewogICAgaWYgKG9wdHMubG93UyAhPT0gdm9pZCAwKQogICAgICBhYm9vbCgibG93UyIsIG9wdHMubG93Uyk7CiAgICBpZiAob3B0cy5wcmVoYXNoICE9PSB2b2lkIDApCiAgICAgIGFib29sKCJwcmVoYXNoIiwgb3B0cy5wcmVoYXNoKTsKICB9CiAgZnVuY3Rpb24gdmFsaWRhdGVQb2ludE9wdHMoY3VydmUpIHsKICAgIGNvbnN0IG9wdHMgPSB2YWxpZGF0ZUJhc2ljKGN1cnZlKTsKICAgIHZhbGlkYXRlT2JqZWN0KG9wdHMsIHsKICAgICAgYTogImZpZWxkIiwKICAgICAgYjogImZpZWxkIgogICAgfSwgewogICAgICBhbGxvd2VkUHJpdmF0ZUtleUxlbmd0aHM6ICJhcnJheSIsCiAgICAgIHdyYXBQcml2YXRlS2V5OiAiYm9vbGVhbiIsCiAgICAgIGlzVG9yc2lvbkZyZWU6ICJmdW5jdGlvbiIsCiAgICAgIGNsZWFyQ29mYWN0b3I6ICJmdW5jdGlvbiIsCiAgICAgIGFsbG93SW5maW5pdHlQb2ludDogImJvb2xlYW4iLAogICAgICBmcm9tQnl0ZXM6ICJmdW5jdGlvbiIsCiAgICAgIHRvQnl0ZXM6ICJmdW5jdGlvbiIKICAgIH0pOwogICAgY29uc3QgeyBlbmRvLCBGcDogRnAyLCBhIH0gPSBvcHRzOwogICAgaWYgKGVuZG8pIHsKICAgICAgaWYgKCFGcDIuZXFsKGEsIEZwMi5aRVJPKSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiRW5kb21vcnBoaXNtIGNhbiBvbmx5IGJlIGRlZmluZWQgZm9yIEtvYmxpdHogY3VydmVzIHRoYXQgaGF2ZSBhPTAiKTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIGVuZG8gIT09ICJvYmplY3QiIHx8IHR5cGVvZiBlbmRvLmJldGEgIT09ICJiaWdpbnQiIHx8IHR5cGVvZiBlbmRvLnNwbGl0U2NhbGFyICE9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBlbmRvbW9ycGhpc20gd2l0aCBiZXRhOiBiaWdpbnQgYW5kIHNwbGl0U2NhbGFyOiBmdW5jdGlvbiIpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLm9wdHMgfSk7CiAgfQogIGZ1bmN0aW9uIHdlaWVyc3RyYXNzUG9pbnRzKG9wdHMpIHsKICAgIGNvbnN0IENVUlZFID0gdmFsaWRhdGVQb2ludE9wdHMob3B0cyk7CiAgICBjb25zdCB7IEZwOiBGcDIgfSA9IENVUlZFOwogICAgY29uc3QgRm4gPSBGaWVsZChDVVJWRS5uLCBDVVJWRS5uQml0TGVuZ3RoKTsKICAgIGNvbnN0IHRvQnl0ZXMzID0gQ1VSVkUudG9CeXRlcyB8fCAoKF9jLCBwb2ludCwgX2lzQ29tcHJlc3NlZCkgPT4gewogICAgICBjb25zdCBhID0gcG9pbnQudG9BZmZpbmUoKTsKICAgICAgcmV0dXJuIGNvbmNhdEJ5dGVzMyhVaW50OEFycmF5LmZyb20oWzRdKSwgRnAyLnRvQnl0ZXMoYS54KSwgRnAyLnRvQnl0ZXMoYS55KSk7CiAgICB9KTsKICAgIGNvbnN0IGZyb21CeXRlczIgPSBDVVJWRS5mcm9tQnl0ZXMgfHwgKChieXRlczIpID0+IHsKICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgY29uc3QgeCA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheSgwLCBGcDIuQllURVMpKTsKICAgICAgY29uc3QgeSA9IEZwMi5mcm9tQnl0ZXModGFpbC5zdWJhcnJheShGcDIuQllURVMsIDIgKiBGcDIuQllURVMpKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfSk7CiAgICBmdW5jdGlvbiB3ZWllcnN0cmFzc0VxdWF0aW9uKHgpIHsKICAgICAgY29uc3QgeyBhLCBiIH0gPSBDVVJWRTsKICAgICAgY29uc3QgeDIgPSBGcDIuc3FyKHgpOwogICAgICBjb25zdCB4MyA9IEZwMi5tdWwoeDIsIHgpOwogICAgICByZXR1cm4gRnAyLmFkZChGcDIuYWRkKHgzLCBGcDIubXVsKHgsIGEpKSwgYik7CiAgICB9CiAgICBpZiAoIUZwMi5lcWwoRnAyLnNxcihDVVJWRS5HeSksIHdlaWVyc3RyYXNzRXF1YXRpb24oQ1VSVkUuR3gpKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgZ2VuZXJhdG9yIHBvaW50OiBlcXVhdGlvbiBsZWZ0ICE9IHJpZ2h0Iik7CiAgICBmdW5jdGlvbiBpc1dpdGhpbkN1cnZlT3JkZXIobnVtMikgewogICAgICByZXR1cm4gaW5SYW5nZShudW0yLCBfMW41LCBDVVJWRS5uKTsKICAgIH0KICAgIGZ1bmN0aW9uIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIoa2V5KSB7CiAgICAgIGNvbnN0IHsgYWxsb3dlZFByaXZhdGVLZXlMZW5ndGhzOiBsZW5ndGhzLCBuQnl0ZUxlbmd0aCwgd3JhcFByaXZhdGVLZXksIG46IE4gfSA9IENVUlZFOwogICAgICBpZiAobGVuZ3RocyAmJiB0eXBlb2Yga2V5ICE9PSAiYmlnaW50IikgewogICAgICAgIGlmIChpc0J5dGVzMihrZXkpKQogICAgICAgICAga2V5ID0gYnl0ZXNUb0hleDIoa2V5KTsKICAgICAgICBpZiAodHlwZW9mIGtleSAhPT0gInN0cmluZyIgfHwgIWxlbmd0aHMuaW5jbHVkZXMoa2V5Lmxlbmd0aCkpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQga2V5Iik7CiAgICAgICAga2V5ID0ga2V5LnBhZFN0YXJ0KG5CeXRlTGVuZ3RoICogMiwgIjAiKTsKICAgICAgfQogICAgICBsZXQgbnVtMjsKICAgICAgdHJ5IHsKICAgICAgICBudW0yID0gdHlwZW9mIGtleSA9PT0gImJpZ2ludCIgPyBrZXkgOiBieXRlc1RvTnVtYmVyQkUoZW5zdXJlQnl0ZXMoInByaXZhdGUga2V5Iiwga2V5LCBuQnl0ZUxlbmd0aCkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRocm93IG5ldyBFcnJvcihgcHJpdmF0ZSBrZXkgbXVzdCBiZSAke25CeXRlTGVuZ3RofSBieXRlcywgaGV4IG9yIGJpZ2ludCwgbm90ICR7dHlwZW9mIGtleX1gKTsKICAgICAgfQogICAgICBpZiAod3JhcFByaXZhdGVLZXkpCiAgICAgICAgbnVtMiA9IG1vZChudW0yLCBOKTsKICAgICAgYUluUmFuZ2UoInByaXZhdGUga2V5IiwgbnVtMiwgXzFuNSwgTik7CiAgICAgIHJldHVybiBudW0yOwogICAgfQogICAgZnVuY3Rpb24gYXNzZXJ0UHJqUG9pbnQob3RoZXIpIHsKICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQb2ludDIpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiUHJvamVjdGl2ZVBvaW50IGV4cGVjdGVkIik7CiAgICB9CiAgICBjb25zdCB0b0FmZmluZU1lbW8gPSBtZW1vaXplZCgocCwgaXopID0+IHsKICAgICAgY29uc3QgeyBweDogeCwgcHk6IHksIHB6OiB6IH0gPSBwOwogICAgICBpZiAoRnAyLmVxbCh6LCBGcDIuT05FKSkKICAgICAgICByZXR1cm4geyB4LCB5IH07CiAgICAgIGNvbnN0IGlzMCA9IHAuaXMwKCk7CiAgICAgIGlmIChpeiA9PSBudWxsKQogICAgICAgIGl6ID0gaXMwID8gRnAyLk9ORSA6IEZwMi5pbnYoeik7CiAgICAgIGNvbnN0IGF4ID0gRnAyLm11bCh4LCBpeik7CiAgICAgIGNvbnN0IGF5ID0gRnAyLm11bCh5LCBpeik7CiAgICAgIGNvbnN0IHp6ID0gRnAyLm11bCh6LCBpeik7CiAgICAgIGlmIChpczApCiAgICAgICAgcmV0dXJuIHsgeDogRnAyLlpFUk8sIHk6IEZwMi5aRVJPIH07CiAgICAgIGlmICghRnAyLmVxbCh6eiwgRnAyLk9ORSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZaIHdhcyBpbnZhbGlkIik7CiAgICAgIHJldHVybiB7IHg6IGF4LCB5OiBheSB9OwogICAgfSk7CiAgICBjb25zdCBhc3NlcnRWYWxpZE1lbW8gPSBtZW1vaXplZCgocCkgPT4gewogICAgICBpZiAocC5pczAoKSkgewogICAgICAgIGlmIChDVVJWRS5hbGxvd0luZmluaXR5UG9pbnQgJiYgIUZwMi5pczAocC5weSkpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IFpFUk8iKTsKICAgICAgfQogICAgICBjb25zdCB7IHgsIHkgfSA9IHAudG9BZmZpbmUoKTsKICAgICAgaWYgKCFGcDIuaXNWYWxpZCh4KSB8fCAhRnAyLmlzVmFsaWQoeSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJiYWQgcG9pbnQ6IHggb3IgeSBub3QgRkUiKTsKICAgICAgY29uc3QgbGVmdCA9IEZwMi5zcXIoeSk7CiAgICAgIGNvbnN0IHJpZ2h0ID0gd2VpZXJzdHJhc3NFcXVhdGlvbih4KTsKICAgICAgaWYgKCFGcDIuZXFsKGxlZnQsIHJpZ2h0KSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImJhZCBwb2ludDogZXF1YXRpb24gbGVmdCAhPSByaWdodCIpOwogICAgICBpZiAoIXAuaXNUb3JzaW9uRnJlZSgpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigiYmFkIHBvaW50OiBub3QgaW4gcHJpbWUtb3JkZXIgc3ViZ3JvdXAiKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKICAgIGNsYXNzIFBvaW50MiB7CiAgICAgIGNvbnN0cnVjdG9yKHB4LCBweSwgcHopIHsKICAgICAgICB0aGlzLnB4ID0gcHg7CiAgICAgICAgdGhpcy5weSA9IHB5OwogICAgICAgIHRoaXMucHogPSBwejsKICAgICAgICBpZiAocHggPT0gbnVsbCB8fCAhRnAyLmlzVmFsaWQocHgpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJ4IHJlcXVpcmVkIik7CiAgICAgICAgaWYgKHB5ID09IG51bGwgfHwgIUZwMi5pc1ZhbGlkKHB5KSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigieSByZXF1aXJlZCIpOwogICAgICAgIGlmIChweiA9PSBudWxsIHx8ICFGcDIuaXNWYWxpZChweikpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInogcmVxdWlyZWQiKTsKICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMpOwogICAgICB9CiAgICAgIC8vIERvZXMgbm90IHZhbGlkYXRlIGlmIHRoZSBwb2ludCBpcyBvbi1jdXJ2ZS4KICAgICAgLy8gVXNlIGZyb21IZXggaW5zdGVhZCwgb3IgY2FsbCBhc3NlcnRWYWxpZGl0eSgpIGxhdGVyLgogICAgICBzdGF0aWMgZnJvbUFmZmluZShwKSB7CiAgICAgICAgY29uc3QgeyB4LCB5IH0gPSBwIHx8IHt9OwogICAgICAgIGlmICghcCB8fCAhRnAyLmlzVmFsaWQoeCkgfHwgIUZwMi5pc1ZhbGlkKHkpKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpbnZhbGlkIGFmZmluZSBwb2ludCIpOwogICAgICAgIGlmIChwIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJwcm9qZWN0aXZlIHBvaW50IG5vdCBhbGxvd2VkIik7CiAgICAgICAgY29uc3QgaXMwID0gKGkpID0+IEZwMi5lcWwoaSwgRnAyLlpFUk8pOwogICAgICAgIGlmIChpczAoeCkgJiYgaXMwKHkpKQogICAgICAgICAgcmV0dXJuIFBvaW50Mi5aRVJPOwogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHgsIHksIEZwMi5PTkUpOwogICAgICB9CiAgICAgIGdldCB4KCkgewogICAgICAgIHJldHVybiB0aGlzLnRvQWZmaW5lKCkueDsKICAgICAgfQogICAgICBnZXQgeSgpIHsKICAgICAgICByZXR1cm4gdGhpcy50b0FmZmluZSgpLnk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIFRha2VzIGEgYnVuY2ggb2YgUHJvamVjdGl2ZSBQb2ludHMgYnV0IGV4ZWN1dGVzIG9ubHkgb25lCiAgICAgICAqIGludmVyc2lvbiBvbiBhbGwgb2YgdGhlbS4gSW52ZXJzaW9uIGlzIHZlcnkgc2xvdyBvcGVyYXRpb24sCiAgICAgICAqIHNvIHRoaXMgaW1wcm92ZXMgcGVyZm9ybWFuY2UgbWFzc2l2ZWx5LgogICAgICAgKiBPcHRpbWl6YXRpb246IGNvbnZlcnRzIGEgbGlzdCBvZiBwcm9qZWN0aXZlIHBvaW50cyB0byBhIGxpc3Qgb2YgaWRlbnRpY2FsIHBvaW50cyB3aXRoIFo9MS4KICAgICAgICovCiAgICAgIHN0YXRpYyBub3JtYWxpemVaKHBvaW50cykgewogICAgICAgIGNvbnN0IHRvSW52ID0gRnAyLmludmVydEJhdGNoKHBvaW50cy5tYXAoKHApID0+IHAucHopKTsKICAgICAgICByZXR1cm4gcG9pbnRzLm1hcCgocCwgaSkgPT4gcC50b0FmZmluZSh0b0ludltpXSkpLm1hcChQb2ludDIuZnJvbUFmZmluZSk7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIENvbnZlcnRzIGhhc2ggc3RyaW5nIG9yIFVpbnQ4QXJyYXkgdG8gUG9pbnQuCiAgICAgICAqIEBwYXJhbSBoZXggc2hvcnQvbG9uZyBFQ0RTQSBoZXgKICAgICAgICovCiAgICAgIHN0YXRpYyBmcm9tSGV4KGhleCkgewogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShmcm9tQnl0ZXMyKGVuc3VyZUJ5dGVzKCJwb2ludEhleCIsIGhleCkpKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0KICAgICAgLy8gTXVsdGlwbGllcyBnZW5lcmF0b3IgcG9pbnQgYnkgcHJpdmF0ZUtleS4KICAgICAgc3RhdGljIGZyb21Qcml2YXRlS2V5KHByaXZhdGVLZXkpIHsKICAgICAgICByZXR1cm4gUG9pbnQyLkJBU0UubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlS2V5KSk7CiAgICAgIH0KICAgICAgLy8gTXVsdGlzY2FsYXIgTXVsdGlwbGljYXRpb24KICAgICAgc3RhdGljIG1zbShwb2ludHMsIHNjYWxhcnMpIHsKICAgICAgICByZXR1cm4gcGlwcGVuZ2VyKFBvaW50MiwgRm4sIHBvaW50cywgc2NhbGFycyk7CiAgICAgIH0KICAgICAgLy8gIlByaXZhdGUgbWV0aG9kIiwgZG9uJ3QgdXNlIGl0IGRpcmVjdGx5CiAgICAgIF9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpIHsKICAgICAgICB3bmFmLnNldFdpbmRvd1NpemUodGhpcywgd2luZG93U2l6ZSk7CiAgICAgIH0KICAgICAgLy8gQSBwb2ludCBvbiBjdXJ2ZSBpcyB2YWxpZCBpZiBpdCBjb25mb3JtcyB0byBlcXVhdGlvbi4KICAgICAgYXNzZXJ0VmFsaWRpdHkoKSB7CiAgICAgICAgYXNzZXJ0VmFsaWRNZW1vKHRoaXMpOwogICAgICB9CiAgICAgIGhhc0V2ZW5ZKCkgewogICAgICAgIGNvbnN0IHsgeSB9ID0gdGhpcy50b0FmZmluZSgpOwogICAgICAgIGlmIChGcDIuaXNPZGQpCiAgICAgICAgICByZXR1cm4gIUZwMi5pc09kZCh5KTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZpZWxkIGRvZXNuJ3Qgc3VwcG9ydCBpc09kZCIpOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb21wYXJlIG9uZSBwb2ludCB0byBhbm90aGVyLgogICAgICAgKi8KICAgICAgZXF1YWxzKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGNvbnN0IFUxID0gRnAyLmVxbChGcDIubXVsKFgxLCBaMiksIEZwMi5tdWwoWDIsIFoxKSk7CiAgICAgICAgY29uc3QgVTIgPSBGcDIuZXFsKEZwMi5tdWwoWTEsIFoyKSwgRnAyLm11bChZMiwgWjEpKTsKICAgICAgICByZXR1cm4gVTEgJiYgVTI7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIEZsaXBzIHBvaW50IHRvIG9uZSBjb3JyZXNwb25kaW5nIHRvICh4LCAteSkgaW4gQWZmaW5lIGNvb3JkaW5hdGVzLgogICAgICAgKi8KICAgICAgbmVnYXRlKCkgewogICAgICAgIHJldHVybiBuZXcgUG9pbnQyKHRoaXMucHgsIEZwMi5uZWcodGhpcy5weSksIHRoaXMucHopOwogICAgICB9CiAgICAgIC8vIFJlbmVzLUNvc3RlbGxvLUJhdGluYSBleGNlcHRpb24tZnJlZSBkb3VibGluZyBmb3JtdWxhLgogICAgICAvLyBUaGVyZSBpcyAzMCUgZmFzdGVyIEphY29iaWFuIGZvcm11bGEsIGJ1dCBpdCBpcyBub3QgY29tcGxldGUuCiAgICAgIC8vIGh0dHBzOi8vZXByaW50LmlhY3Iub3JnLzIwMTUvMTA2MCwgYWxnb3JpdGhtIDMKICAgICAgLy8gQ29zdDogOE0gKyAzUyArIDMqYSArIDIqYjMgKyAxNWFkZC4KICAgICAgZG91YmxlKCkgewogICAgICAgIGNvbnN0IHsgYSwgYiB9ID0gQ1VSVkU7CiAgICAgICAgY29uc3QgYjMyID0gRnAyLm11bChiLCBfM24yKTsKICAgICAgICBjb25zdCB7IHB4OiBYMSwgcHk6IFkxLCBwejogWjEgfSA9IHRoaXM7CiAgICAgICAgbGV0IFgzID0gRnAyLlpFUk8sIFkzID0gRnAyLlpFUk8sIFozID0gRnAyLlpFUk87CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDEpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkxKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMSk7CiAgICAgICAgbGV0IHQzID0gRnAyLm11bChYMSwgWTEpOwogICAgICAgIHQzID0gRnAyLmFkZCh0MywgdDMpOwogICAgICAgIFozID0gRnAyLm11bChYMSwgWjEpOwogICAgICAgIFozID0gRnAyLmFkZChaMywgWjMpOwogICAgICAgIFgzID0gRnAyLm11bChhLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKGIzMiwgdDIpOwogICAgICAgIFkzID0gRnAyLmFkZChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLnN1Yih0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLmFkZCh0MSwgWTMpOwogICAgICAgIFkzID0gRnAyLm11bChYMywgWTMpOwogICAgICAgIFgzID0gRnAyLm11bCh0MywgWDMpOwogICAgICAgIFozID0gRnAyLm11bChiMzIsIFozKTsKICAgICAgICB0MiA9IEZwMi5tdWwoYSwgdDIpOwogICAgICAgIHQzID0gRnAyLnN1Yih0MCwgdDIpOwogICAgICAgIHQzID0gRnAyLm11bChhLCB0Myk7CiAgICAgICAgdDMgPSBGcDIuYWRkKHQzLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKFozLCB0MCk7CiAgICAgICAgdDAgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQwLCB0Myk7CiAgICAgICAgWTMgPSBGcDIuYWRkKFkzLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKFkxLCBaMSk7CiAgICAgICAgdDIgPSBGcDIuYWRkKHQyLCB0Mik7CiAgICAgICAgdDAgPSBGcDIubXVsKHQyLCB0Myk7CiAgICAgICAgWDMgPSBGcDIuc3ViKFgzLCB0MCk7CiAgICAgICAgWjMgPSBGcDIubXVsKHQyLCB0MSk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKFozLCBaMyk7CiAgICAgICAgcmV0dXJuIG5ldyBQb2ludDIoWDMsIFkzLCBaMyk7CiAgICAgIH0KICAgICAgLy8gUmVuZXMtQ29zdGVsbG8tQmF0aW5hIGV4Y2VwdGlvbi1mcmVlIGFkZGl0aW9uIGZvcm11bGEuCiAgICAgIC8vIFRoZXJlIGlzIDMwJSBmYXN0ZXIgSmFjb2JpYW4gZm9ybXVsYSwgYnV0IGl0IGlzIG5vdCBjb21wbGV0ZS4KICAgICAgLy8gaHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAxNS8xMDYwLCBhbGdvcml0aG0gMQogICAgICAvLyBDb3N0OiAxMk0gKyAwUyArIDMqYSArIDMqYjMgKyAyM2FkZC4KICAgICAgYWRkKG90aGVyKSB7CiAgICAgICAgYXNzZXJ0UHJqUG9pbnQob3RoZXIpOwogICAgICAgIGNvbnN0IHsgcHg6IFgxLCBweTogWTEsIHB6OiBaMSB9ID0gdGhpczsKICAgICAgICBjb25zdCB7IHB4OiBYMiwgcHk6IFkyLCBwejogWjIgfSA9IG90aGVyOwogICAgICAgIGxldCBYMyA9IEZwMi5aRVJPLCBZMyA9IEZwMi5aRVJPLCBaMyA9IEZwMi5aRVJPOwogICAgICAgIGNvbnN0IGEgPSBDVVJWRS5hOwogICAgICAgIGNvbnN0IGIzMiA9IEZwMi5tdWwoQ1VSVkUuYiwgXzNuMik7CiAgICAgICAgbGV0IHQwID0gRnAyLm11bChYMSwgWDIpOwogICAgICAgIGxldCB0MSA9IEZwMi5tdWwoWTEsIFkyKTsKICAgICAgICBsZXQgdDIgPSBGcDIubXVsKFoxLCBaMik7CiAgICAgICAgbGV0IHQzID0gRnAyLmFkZChYMSwgWTEpOwogICAgICAgIGxldCB0NCA9IEZwMi5hZGQoWDIsIFkyKTsKICAgICAgICB0MyA9IEZwMi5tdWwodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQodDAsIHQxKTsKICAgICAgICB0MyA9IEZwMi5zdWIodDMsIHQ0KTsKICAgICAgICB0NCA9IEZwMi5hZGQoWDEsIFoxKTsKICAgICAgICBsZXQgdDUgPSBGcDIuYWRkKFgyLCBaMik7CiAgICAgICAgdDQgPSBGcDIubXVsKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKHQwLCB0Mik7CiAgICAgICAgdDQgPSBGcDIuc3ViKHQ0LCB0NSk7CiAgICAgICAgdDUgPSBGcDIuYWRkKFkxLCBaMSk7CiAgICAgICAgWDMgPSBGcDIuYWRkKFkyLCBaMik7CiAgICAgICAgdDUgPSBGcDIubXVsKHQ1LCBYMyk7CiAgICAgICAgWDMgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDUgPSBGcDIuc3ViKHQ1LCBYMyk7CiAgICAgICAgWjMgPSBGcDIubXVsKGEsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwoYjMyLCB0Mik7CiAgICAgICAgWjMgPSBGcDIuYWRkKFgzLCBaMyk7CiAgICAgICAgWDMgPSBGcDIuc3ViKHQxLCBaMyk7CiAgICAgICAgWjMgPSBGcDIuYWRkKHQxLCBaMyk7CiAgICAgICAgWTMgPSBGcDIubXVsKFgzLCBaMyk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQwLCB0MCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0MCk7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5tdWwoYjMyLCB0NCk7CiAgICAgICAgdDEgPSBGcDIuYWRkKHQxLCB0Mik7CiAgICAgICAgdDIgPSBGcDIuc3ViKHQwLCB0Mik7CiAgICAgICAgdDIgPSBGcDIubXVsKGEsIHQyKTsKICAgICAgICB0NCA9IEZwMi5hZGQodDQsIHQyKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDEsIHQ0KTsKICAgICAgICBZMyA9IEZwMi5hZGQoWTMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDUsIHQ0KTsKICAgICAgICBYMyA9IEZwMi5tdWwodDMsIFgzKTsKICAgICAgICBYMyA9IEZwMi5zdWIoWDMsIHQwKTsKICAgICAgICB0MCA9IEZwMi5tdWwodDMsIHQxKTsKICAgICAgICBaMyA9IEZwMi5tdWwodDUsIFozKTsKICAgICAgICBaMyA9IEZwMi5hZGQoWjMsIHQwKTsKICAgICAgICByZXR1cm4gbmV3IFBvaW50MihYMywgWTMsIFozKTsKICAgICAgfQogICAgICBzdWJ0cmFjdChvdGhlcikgewogICAgICAgIHJldHVybiB0aGlzLmFkZChvdGhlci5uZWdhdGUoKSk7CiAgICAgIH0KICAgICAgaXMwKCkgewogICAgICAgIHJldHVybiB0aGlzLmVxdWFscyhQb2ludDIuWkVSTyk7CiAgICAgIH0KICAgICAgd05BRihuKSB7CiAgICAgICAgcmV0dXJuIHduYWYud05BRkNhY2hlZCh0aGlzLCBuLCBQb2ludDIubm9ybWFsaXplWik7CiAgICAgIH0KICAgICAgLyoqCiAgICAgICAqIE5vbi1jb25zdGFudC10aW1lIG11bHRpcGxpY2F0aW9uLiBVc2VzIGRvdWJsZS1hbmQtYWRkIGFsZ29yaXRobS4KICAgICAgICogSXQncyBmYXN0ZXIsIGJ1dCBzaG91bGQgb25seSBiZSB1c2VkIHdoZW4geW91IGRvbid0IGNhcmUgYWJvdXQKICAgICAgICogYW4gZXhwb3NlZCBwcml2YXRlIGtleSBlLmcuIHNpZyB2ZXJpZmljYXRpb24sIHdoaWNoIHdvcmtzIG92ZXIgKnB1YmxpYyoga2V5cy4KICAgICAgICovCiAgICAgIG11bHRpcGx5VW5zYWZlKHNjKSB7CiAgICAgICAgYUluUmFuZ2UoInNjYWxhciIsIHNjLCBfMG41LCBDVVJWRS5uKTsKICAgICAgICBjb25zdCBJID0gUG9pbnQyLlpFUk87CiAgICAgICAgaWYgKHNjID09PSBfMG41KQogICAgICAgICAgcmV0dXJuIEk7CiAgICAgICAgaWYgKHNjID09PSBfMW41KQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgY29uc3QgeyBlbmRvIH0gPSBDVVJWRTsKICAgICAgICBpZiAoIWVuZG8pCiAgICAgICAgICByZXR1cm4gd25hZi51bnNhZmVMYWRkZXIodGhpcywgc2MpOwogICAgICAgIGxldCB7IGsxbmVnLCBrMSwgazJuZWcsIGsyIH0gPSBlbmRvLnNwbGl0U2NhbGFyKHNjKTsKICAgICAgICBsZXQgazFwID0gSTsKICAgICAgICBsZXQgazJwID0gSTsKICAgICAgICBsZXQgZCA9IHRoaXM7CiAgICAgICAgd2hpbGUgKGsxID4gXzBuNSB8fCBrMiA+IF8wbjUpIHsKICAgICAgICAgIGlmIChrMSAmIF8xbjUpCiAgICAgICAgICAgIGsxcCA9IGsxcC5hZGQoZCk7CiAgICAgICAgICBpZiAoazIgJiBfMW41KQogICAgICAgICAgICBrMnAgPSBrMnAuYWRkKGQpOwogICAgICAgICAgZCA9IGQuZG91YmxlKCk7CiAgICAgICAgICBrMSA+Pj0gXzFuNTsKICAgICAgICAgIGsyID4+PSBfMW41OwogICAgICAgIH0KICAgICAgICBpZiAoazFuZWcpCiAgICAgICAgICBrMXAgPSBrMXAubmVnYXRlKCk7CiAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgazJwID0gazJwLm5lZ2F0ZSgpOwogICAgICAgIGsycCA9IG5ldyBQb2ludDIoRnAyLm11bChrMnAucHgsIGVuZG8uYmV0YSksIGsycC5weSwgazJwLnB6KTsKICAgICAgICByZXR1cm4gazFwLmFkZChrMnApOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBDb25zdGFudCB0aW1lIG11bHRpcGxpY2F0aW9uLgogICAgICAgKiBVc2VzIHdOQUYgbWV0aG9kLiBXaW5kb3dlZCBtZXRob2QgbWF5IGJlIDEwJSBmYXN0ZXIsCiAgICAgICAqIGJ1dCB0YWtlcyAyeCBsb25nZXIgdG8gZ2VuZXJhdGUgYW5kIGNvbnN1bWVzIDJ4IG1lbW9yeS4KICAgICAgICogVXNlcyBwcmVjb21wdXRlcyB3aGVuIGF2YWlsYWJsZS4KICAgICAgICogVXNlcyBlbmRvbW9ycGhpc20gZm9yIEtvYmxpdHogY3VydmVzLgogICAgICAgKiBAcGFyYW0gc2NhbGFyIGJ5IHdoaWNoIHRoZSBwb2ludCB3b3VsZCBiZSBtdWx0aXBsaWVkCiAgICAgICAqIEByZXR1cm5zIE5ldyBwb2ludAogICAgICAgKi8KICAgICAgbXVsdGlwbHkoc2NhbGFyKSB7CiAgICAgICAgY29uc3QgeyBlbmRvLCBuOiBOIH0gPSBDVVJWRTsKICAgICAgICBhSW5SYW5nZSgic2NhbGFyIiwgc2NhbGFyLCBfMW41LCBOKTsKICAgICAgICBsZXQgcG9pbnQsIGZha2U7CiAgICAgICAgaWYgKGVuZG8pIHsKICAgICAgICAgIGNvbnN0IHsgazFuZWcsIGsxLCBrMm5lZywgazIgfSA9IGVuZG8uc3BsaXRTY2FsYXIoc2NhbGFyKTsKICAgICAgICAgIGxldCB7IHA6IGsxcCwgZjogZjFwIH0gPSB0aGlzLndOQUYoazEpOwogICAgICAgICAgbGV0IHsgcDogazJwLCBmOiBmMnAgfSA9IHRoaXMud05BRihrMik7CiAgICAgICAgICBrMXAgPSB3bmFmLmNvbnN0VGltZU5lZ2F0ZShrMW5lZywgazFwKTsKICAgICAgICAgIGsycCA9IHduYWYuY29uc3RUaW1lTmVnYXRlKGsybmVnLCBrMnApOwogICAgICAgICAgazJwID0gbmV3IFBvaW50MihGcDIubXVsKGsycC5weCwgZW5kby5iZXRhKSwgazJwLnB5LCBrMnAucHopOwogICAgICAgICAgcG9pbnQgPSBrMXAuYWRkKGsycCk7CiAgICAgICAgICBmYWtlID0gZjFwLmFkZChmMnApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCB7IHAsIGY6IGYyIH0gPSB0aGlzLndOQUYoc2NhbGFyKTsKICAgICAgICAgIHBvaW50ID0gcDsKICAgICAgICAgIGZha2UgPSBmMjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFBvaW50Mi5ub3JtYWxpemVaKFtwb2ludCwgZmFrZV0pWzBdOwogICAgICB9CiAgICAgIC8qKgogICAgICAgKiBFZmZpY2llbnRseSBjYWxjdWxhdGUgYGFQICsgYlFgLiBVbnNhZmUsIGNhbiBleHBvc2UgcHJpdmF0ZSBrZXksIGlmIHVzZWQgaW5jb3JyZWN0bHkuCiAgICAgICAqIE5vdCB1c2luZyBTdHJhdXNzLVNoYW1pciB0cmljazogcHJlY29tcHV0YXRpb24gdGFibGVzIGFyZSBmYXN0ZXIuCiAgICAgICAqIFRoZSB0cmljayBjb3VsZCBiZSB1c2VmdWwgaWYgYm90aCBQIGFuZCBRIGFyZSBub3QgRyAobm90IGluIG91ciBjYXNlKS4KICAgICAgICogQHJldHVybnMgbm9uLXplcm8gYWZmaW5lIHBvaW50CiAgICAgICAqLwogICAgICBtdWx0aXBseUFuZEFkZFVuc2FmZShRLCBhLCBiKSB7CiAgICAgICAgY29uc3QgRyA9IFBvaW50Mi5CQVNFOwogICAgICAgIGNvbnN0IG11bCA9IChQLCBhMikgPT4gYTIgPT09IF8wbjUgfHwgYTIgPT09IF8xbjUgfHwgIVAuZXF1YWxzKEcpID8gUC5tdWx0aXBseVVuc2FmZShhMikgOiBQLm11bHRpcGx5KGEyKTsKICAgICAgICBjb25zdCBzdW0gPSBtdWwodGhpcywgYSkuYWRkKG11bChRLCBiKSk7CiAgICAgICAgcmV0dXJuIHN1bS5pczAoKSA/IHZvaWQgMCA6IHN1bTsKICAgICAgfQogICAgICAvLyBDb252ZXJ0cyBQcm9qZWN0aXZlIHBvaW50IHRvIGFmZmluZSAoeCwgeSkgY29vcmRpbmF0ZXMuCiAgICAgIC8vIENhbiBhY2NlcHQgcHJlY29tcHV0ZWQgWl4tMSAtIGZvciBleGFtcGxlLCBmcm9tIGludmVydEJhdGNoLgogICAgICAvLyAoeCwgeSwgeikg4oiLICh4PXgveiwgeT15L3opCiAgICAgIHRvQWZmaW5lKGl6KSB7CiAgICAgICAgcmV0dXJuIHRvQWZmaW5lTWVtbyh0aGlzLCBpeik7CiAgICAgIH0KICAgICAgaXNUb3JzaW9uRnJlZSgpIHsKICAgICAgICBjb25zdCB7IGg6IGNvZmFjdG9yLCBpc1RvcnNpb25GcmVlIH0gPSBDVVJWRTsKICAgICAgICBpZiAoY29mYWN0b3IgPT09IF8xbjUpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoaXNUb3JzaW9uRnJlZSkKICAgICAgICAgIHJldHVybiBpc1RvcnNpb25GcmVlKFBvaW50MiwgdGhpcyk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJpc1RvcnNpb25GcmVlKCkgaGFzIG5vdCBiZWVuIGRlY2xhcmVkIGZvciB0aGUgZWxsaXB0aWMgY3VydmUiKTsKICAgICAgfQogICAgICBjbGVhckNvZmFjdG9yKCkgewogICAgICAgIGNvbnN0IHsgaDogY29mYWN0b3IsIGNsZWFyQ29mYWN0b3IgfSA9IENVUlZFOwogICAgICAgIGlmIChjb2ZhY3RvciA9PT0gXzFuNSkKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIGlmIChjbGVhckNvZmFjdG9yKQogICAgICAgICAgcmV0dXJuIGNsZWFyQ29mYWN0b3IoUG9pbnQyLCB0aGlzKTsKICAgICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVVuc2FmZShDVVJWRS5oKTsKICAgICAgfQogICAgICB0b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICB0aGlzLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMzKFBvaW50MiwgdGhpcywgaXNDb21wcmVzc2VkKTsKICAgICAgfQogICAgICB0b0hleChpc0NvbXByZXNzZWQgPSB0cnVlKSB7CiAgICAgICAgYWJvb2woImlzQ29tcHJlc3NlZCIsIGlzQ29tcHJlc3NlZCk7CiAgICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgyKHRoaXMudG9SYXdCeXRlcyhpc0NvbXByZXNzZWQpKTsKICAgICAgfQogICAgfQogICAgUG9pbnQyLkJBU0UgPSBuZXcgUG9pbnQyKENVUlZFLkd4LCBDVVJWRS5HeSwgRnAyLk9ORSk7CiAgICBQb2ludDIuWkVSTyA9IG5ldyBQb2ludDIoRnAyLlpFUk8sIEZwMi5PTkUsIEZwMi5aRVJPKTsKICAgIGNvbnN0IF9iaXRzID0gQ1VSVkUubkJpdExlbmd0aDsKICAgIGNvbnN0IHduYWYgPSB3TkFGKFBvaW50MiwgQ1VSVkUuZW5kbyA/IE1hdGguY2VpbChfYml0cyAvIDIpIDogX2JpdHMpOwogICAgcmV0dXJuIHsKICAgICAgQ1VSVkUsCiAgICAgIFByb2plY3RpdmVQb2ludDogUG9pbnQyLAogICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyLAogICAgICB3ZWllcnN0cmFzc0VxdWF0aW9uLAogICAgICBpc1dpdGhpbkN1cnZlT3JkZXIKICAgIH07CiAgfQogIGZ1bmN0aW9uIHZhbGlkYXRlT3B0cyhjdXJ2ZSkgewogICAgY29uc3Qgb3B0cyA9IHZhbGlkYXRlQmFzaWMoY3VydmUpOwogICAgdmFsaWRhdGVPYmplY3Qob3B0cywgewogICAgICBoYXNoOiAiaGFzaCIsCiAgICAgIGhtYWM6ICJmdW5jdGlvbiIsCiAgICAgIHJhbmRvbUJ5dGVzOiAiZnVuY3Rpb24iCiAgICB9LCB7CiAgICAgIGJpdHMyaW50OiAiZnVuY3Rpb24iLAogICAgICBiaXRzMmludF9tb2ROOiAiZnVuY3Rpb24iLAogICAgICBsb3dTOiAiYm9vbGVhbiIKICAgIH0pOwogICAgcmV0dXJuIE9iamVjdC5mcmVlemUoeyBsb3dTOiB0cnVlLCAuLi5vcHRzIH0pOwogIH0KICBmdW5jdGlvbiB3ZWllcnN0cmFzcyhjdXJ2ZURlZikgewogICAgY29uc3QgQ1VSVkUgPSB2YWxpZGF0ZU9wdHMoY3VydmVEZWYpOwogICAgY29uc3QgeyBGcDogRnAyLCBuOiBDVVJWRV9PUkRFUiB9ID0gQ1VSVkU7CiAgICBjb25zdCBjb21wcmVzc2VkTGVuID0gRnAyLkJZVEVTICsgMTsKICAgIGNvbnN0IHVuY29tcHJlc3NlZExlbiA9IDIgKiBGcDIuQllURVMgKyAxOwogICAgZnVuY3Rpb24gbW9kTjIoYSkgewogICAgICByZXR1cm4gbW9kKGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGZ1bmN0aW9uIGludk4oYSkgewogICAgICByZXR1cm4gaW52ZXJ0KGEsIENVUlZFX09SREVSKTsKICAgIH0KICAgIGNvbnN0IHsgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsIHdlaWVyc3RyYXNzRXF1YXRpb24sIGlzV2l0aGluQ3VydmVPcmRlciB9ID0gd2VpZXJzdHJhc3NQb2ludHMoewogICAgICAuLi5DVVJWRSwKICAgICAgdG9CeXRlcyhfYywgcG9pbnQsIGlzQ29tcHJlc3NlZCkgewogICAgICAgIGNvbnN0IGEgPSBwb2ludC50b0FmZmluZSgpOwogICAgICAgIGNvbnN0IHggPSBGcDIudG9CeXRlcyhhLngpOwogICAgICAgIGNvbnN0IGNhdCA9IGNvbmNhdEJ5dGVzMzsKICAgICAgICBhYm9vbCgiaXNDb21wcmVzc2VkIiwgaXNDb21wcmVzc2VkKTsKICAgICAgICBpZiAoaXNDb21wcmVzc2VkKSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbcG9pbnQuaGFzRXZlblkoKSA/IDIgOiAzXSksIHgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gY2F0KFVpbnQ4QXJyYXkuZnJvbShbNF0pLCB4LCBGcDIudG9CeXRlcyhhLnkpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyb21CeXRlcyhieXRlczIpIHsKICAgICAgICBjb25zdCBsZW4gPSBieXRlczIubGVuZ3RoOwogICAgICAgIGNvbnN0IGhlYWQgPSBieXRlczJbMF07CiAgICAgICAgY29uc3QgdGFpbCA9IGJ5dGVzMi5zdWJhcnJheSgxKTsKICAgICAgICBpZiAobGVuID09PSBjb21wcmVzc2VkTGVuICYmIChoZWFkID09PSAyIHx8IGhlYWQgPT09IDMpKSB7CiAgICAgICAgICBjb25zdCB4ID0gYnl0ZXNUb051bWJlckJFKHRhaWwpOwogICAgICAgICAgaWYgKCFpblJhbmdlKHgsIF8xbjUsIEZwMi5PUkRFUikpCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiUG9pbnQgaXMgbm90IG9uIGN1cnZlIik7CiAgICAgICAgICBjb25zdCB5MiA9IHdlaWVyc3RyYXNzRXF1YXRpb24oeCk7CiAgICAgICAgICBsZXQgeTsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHkgPSBGcDIuc3FydCh5Mik7CiAgICAgICAgICB9IGNhdGNoIChzcXJ0RXJyb3IpIHsKICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gc3FydEVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyAiOiAiICsgc3FydEVycm9yLm1lc3NhZ2UgOiAiIjsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb2ludCBpcyBub3Qgb24gY3VydmUiICsgc3VmZml4KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGlzWU9kZCA9ICh5ICYgXzFuNSkgPT09IF8xbjU7CiAgICAgICAgICBjb25zdCBpc0hlYWRPZGQgPSAoaGVhZCAmIDEpID09PSAxOwogICAgICAgICAgaWYgKGlzSGVhZE9kZCAhPT0gaXNZT2RkKQogICAgICAgICAgICB5ID0gRnAyLm5lZyh5KTsKICAgICAgICAgIHJldHVybiB7IHgsIHkgfTsKICAgICAgICB9IGVsc2UgaWYgKGxlbiA9PT0gdW5jb21wcmVzc2VkTGVuICYmIGhlYWQgPT09IDQpIHsKICAgICAgICAgIGNvbnN0IHggPSBGcDIuZnJvbUJ5dGVzKHRhaWwuc3ViYXJyYXkoMCwgRnAyLkJZVEVTKSk7CiAgICAgICAgICBjb25zdCB5ID0gRnAyLmZyb21CeXRlcyh0YWlsLnN1YmFycmF5KEZwMi5CWVRFUywgMiAqIEZwMi5CWVRFUykpOwogICAgICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBvaW50IG9mIGxlbmd0aCAke2xlbn0gd2FzIGludmFsaWQuIEV4cGVjdGVkICR7Y29tcHJlc3NlZExlbn0gY29tcHJlc3NlZCBieXRlcyBvciAke3VuY29tcHJlc3NlZExlbn0gdW5jb21wcmVzc2VkIGJ5dGVzYCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IG51bVRvTkJ5dGVTdHIgPSAobnVtMikgPT4gYnl0ZXNUb0hleDIobnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKSk7CiAgICBmdW5jdGlvbiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIobnVtYmVyMikgewogICAgICBjb25zdCBIQUxGID0gQ1VSVkVfT1JERVIgPj4gXzFuNTsKICAgICAgcmV0dXJuIG51bWJlcjIgPiBIQUxGOwogICAgfQogICAgZnVuY3Rpb24gbm9ybWFsaXplUyhzKSB7CiAgICAgIHJldHVybiBpc0JpZ2dlclRoYW5IYWxmT3JkZXIocykgPyBtb2ROMigtcykgOiBzOwogICAgfQogICAgY29uc3Qgc2xjTnVtID0gKGIsIGZyb20sIHRvKSA9PiBieXRlc1RvTnVtYmVyQkUoYi5zbGljZShmcm9tLCB0bykpOwogICAgY2xhc3MgU2lnbmF0dXJlIHsKICAgICAgY29uc3RydWN0b3IociwgcywgcmVjb3ZlcnkpIHsKICAgICAgICB0aGlzLnIgPSByOwogICAgICAgIHRoaXMucyA9IHM7CiAgICAgICAgdGhpcy5yZWNvdmVyeSA9IHJlY292ZXJ5OwogICAgICAgIHRoaXMuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgfQogICAgICAvLyBwYWlyIChieXRlcyBvZiByLCBieXRlcyBvZiBzKQogICAgICBzdGF0aWMgZnJvbUNvbXBhY3QoaGV4KSB7CiAgICAgICAgY29uc3QgbCA9IENVUlZFLm5CeXRlTGVuZ3RoOwogICAgICAgIGhleCA9IGVuc3VyZUJ5dGVzKCJjb21wYWN0U2lnbmF0dXJlIiwgaGV4LCBsICogMik7CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUoc2xjTnVtKGhleCwgMCwgbCksIHNsY051bShoZXgsIGwsIDIgKiBsKSk7CiAgICAgIH0KICAgICAgLy8gREVSIGVuY29kZWQgRUNEU0Egc2lnbmF0dXJlCiAgICAgIC8vIGh0dHBzOi8vYml0Y29pbi5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvNTc2NDQvd2hhdC1hcmUtdGhlLXBhcnRzLW9mLWEtYml0Y29pbi10cmFuc2FjdGlvbi1pbnB1dC1zY3JpcHQKICAgICAgc3RhdGljIGZyb21ERVIoaGV4KSB7CiAgICAgICAgY29uc3QgeyByLCBzIH0gPSBERVIudG9TaWcoZW5zdXJlQnl0ZXMoIkRFUiIsIGhleCkpOwogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHIsIHMpOwogICAgICB9CiAgICAgIGFzc2VydFZhbGlkaXR5KCkgewogICAgICAgIGFJblJhbmdlKCJyIiwgdGhpcy5yLCBfMW41LCBDVVJWRV9PUkRFUik7CiAgICAgICAgYUluUmFuZ2UoInMiLCB0aGlzLnMsIF8xbjUsIENVUlZFX09SREVSKTsKICAgICAgfQogICAgICBhZGRSZWNvdmVyeUJpdChyZWNvdmVyeSkgewogICAgICAgIHJldHVybiBuZXcgU2lnbmF0dXJlKHRoaXMuciwgdGhpcy5zLCByZWNvdmVyeSk7CiAgICAgIH0KICAgICAgcmVjb3ZlclB1YmxpY0tleShtc2dIYXNoKSB7CiAgICAgICAgY29uc3QgeyByLCBzLCByZWNvdmVyeTogcmVjIH0gPSB0aGlzOwogICAgICAgIGNvbnN0IGggPSBiaXRzMmludF9tb2ROKGVuc3VyZUJ5dGVzKCJtc2dIYXNoIiwgbXNnSGFzaCkpOwogICAgICAgIGlmIChyZWMgPT0gbnVsbCB8fCAhWzAsIDEsIDIsIDNdLmluY2x1ZGVzKHJlYykpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIGludmFsaWQiKTsKICAgICAgICBjb25zdCByYWRqID0gcmVjID09PSAyIHx8IHJlYyA9PT0gMyA/IHIgKyBDVVJWRS5uIDogcjsKICAgICAgICBpZiAocmFkaiA+PSBGcDIuT1JERVIpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInJlY292ZXJ5IGlkIDIgb3IgMyBpbnZhbGlkIik7CiAgICAgICAgY29uc3QgcHJlZml4ID0gKHJlYyAmIDEpID09PSAwID8gIjAyIiA6ICIwMyI7CiAgICAgICAgY29uc3QgUiA9IFBvaW50Mi5mcm9tSGV4KHByZWZpeCArIG51bVRvTkJ5dGVTdHIocmFkaikpOwogICAgICAgIGNvbnN0IGlyID0gaW52TihyYWRqKTsKICAgICAgICBjb25zdCB1MSA9IG1vZE4yKC1oICogaXIpOwogICAgICAgIGNvbnN0IHUyID0gbW9kTjIocyAqIGlyKTsKICAgICAgICBjb25zdCBRID0gUG9pbnQyLkJBU0UubXVsdGlwbHlBbmRBZGRVbnNhZmUoUiwgdTEsIHUyKTsKICAgICAgICBpZiAoIVEpCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInBvaW50IGF0IGluZmluaWZ5Iik7CiAgICAgICAgUS5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBROwogICAgICB9CiAgICAgIC8vIFNpZ25hdHVyZXMgc2hvdWxkIGJlIGxvdy1zLCB0byBwcmV2ZW50IG1hbGxlYWJpbGl0eS4KICAgICAgaGFzSGlnaFMoKSB7CiAgICAgICAgcmV0dXJuIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcih0aGlzLnMpOwogICAgICB9CiAgICAgIG5vcm1hbGl6ZVMoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaGFzSGlnaFMoKSA/IG5ldyBTaWduYXR1cmUodGhpcy5yLCBtb2ROMigtdGhpcy5zKSwgdGhpcy5yZWNvdmVyeSkgOiB0aGlzOwogICAgICB9CiAgICAgIC8vIERFUi1lbmNvZGVkCiAgICAgIHRvREVSUmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9ERVJIZXgoKSk7CiAgICAgIH0KICAgICAgdG9ERVJIZXgoKSB7CiAgICAgICAgcmV0dXJuIERFUi5oZXhGcm9tU2lnKHsgcjogdGhpcy5yLCBzOiB0aGlzLnMgfSk7CiAgICAgIH0KICAgICAgLy8gcGFkZGVkIGJ5dGVzIG9mIHIsIHRoZW4gcGFkZGVkIGJ5dGVzIG9mIHMKICAgICAgdG9Db21wYWN0UmF3Qnl0ZXMoKSB7CiAgICAgICAgcmV0dXJuIGhleFRvQnl0ZXMyKHRoaXMudG9Db21wYWN0SGV4KCkpOwogICAgICB9CiAgICAgIHRvQ29tcGFjdEhleCgpIHsKICAgICAgICByZXR1cm4gbnVtVG9OQnl0ZVN0cih0aGlzLnIpICsgbnVtVG9OQnl0ZVN0cih0aGlzLnMpOwogICAgICB9CiAgICB9CiAgICBjb25zdCB1dGlscyA9IHsKICAgICAgaXNWYWxpZFByaXZhdGVLZXkocHJpdmF0ZUtleSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5vcm1Qcml2YXRlS2V5VG9TY2FsYXIsCiAgICAgIC8qKgogICAgICAgKiBQcm9kdWNlcyBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgcHJpdmF0ZSBrZXkgZnJvbSByYW5kb20gb2Ygc2l6ZQogICAgICAgKiAoZ3JvdXBMZW4gKyBjZWlsKGdyb3VwTGVuIC8gMikpIHdpdGggbW9kdWxvIGJpYXMgYmVpbmcgbmVnbGlnaWJsZS4KICAgICAgICovCiAgICAgIHJhbmRvbVByaXZhdGVLZXk6ICgpID0+IHsKICAgICAgICBjb25zdCBsZW5ndGggPSBnZXRNaW5IYXNoTGVuZ3RoKENVUlZFLm4pOwogICAgICAgIHJldHVybiBtYXBIYXNoVG9GaWVsZChDVVJWRS5yYW5kb21CeXRlcyhsZW5ndGgpLCBDVVJWRS5uKTsKICAgICAgfSwKICAgICAgLyoqCiAgICAgICAqIENyZWF0ZXMgcHJlY29tcHV0ZSB0YWJsZSBmb3IgYW4gYXJiaXRyYXJ5IEVDIHBvaW50LiBNYWtlcyBwb2ludCAiY2FjaGVkIi4KICAgICAgICogQWxsb3dzIHRvIG1hc3NpdmVseSBzcGVlZC11cCBgcG9pbnQubXVsdGlwbHkoc2NhbGFyKWAuCiAgICAgICAqIEByZXR1cm5zIGNhY2hlZCBwb2ludAogICAgICAgKiBAZXhhbXBsZQogICAgICAgKiBjb25zdCBmYXN0ID0gdXRpbHMucHJlY29tcHV0ZSg4LCBQcm9qZWN0aXZlUG9pbnQuZnJvbUhleChzb21lb25lc1B1YktleSkpOwogICAgICAgKiBmYXN0Lm11bHRpcGx5KHByaXZLZXkpOyAvLyBtdWNoIGZhc3RlciBFQ0RIIG5vdwogICAgICAgKi8KICAgICAgcHJlY29tcHV0ZSh3aW5kb3dTaXplID0gOCwgcG9pbnQgPSBQb2ludDIuQkFTRSkgewogICAgICAgIHBvaW50Ll9zZXRXaW5kb3dTaXplKHdpbmRvd1NpemUpOwogICAgICAgIHBvaW50Lm11bHRpcGx5KEJpZ0ludCgzKSk7CiAgICAgICAgcmV0dXJuIHBvaW50OwogICAgICB9CiAgICB9OwogICAgZnVuY3Rpb24gZ2V0UHVibGljS2V5KHByaXZhdGVLZXksIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgcmV0dXJuIFBvaW50Mi5mcm9tUHJpdmF0ZUtleShwcml2YXRlS2V5KS50b1Jhd0J5dGVzKGlzQ29tcHJlc3NlZCk7CiAgICB9CiAgICBmdW5jdGlvbiBpc1Byb2JQdWIoaXRlbSkgewogICAgICBjb25zdCBhcnIgPSBpc0J5dGVzMihpdGVtKTsKICAgICAgY29uc3Qgc3RyID0gdHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciOwogICAgICBjb25zdCBsZW4gPSAoYXJyIHx8IHN0cikgJiYgaXRlbS5sZW5ndGg7CiAgICAgIGlmIChhcnIpCiAgICAgICAgcmV0dXJuIGxlbiA9PT0gY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IHVuY29tcHJlc3NlZExlbjsKICAgICAgaWYgKHN0cikKICAgICAgICByZXR1cm4gbGVuID09PSAyICogY29tcHJlc3NlZExlbiB8fCBsZW4gPT09IDIgKiB1bmNvbXByZXNzZWRMZW47CiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgUG9pbnQyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBmdW5jdGlvbiBnZXRTaGFyZWRTZWNyZXQocHJpdmF0ZUEsIHB1YmxpY0IsIGlzQ29tcHJlc3NlZCA9IHRydWUpIHsKICAgICAgaWYgKGlzUHJvYlB1Yihwcml2YXRlQSkpCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJmaXJzdCBhcmcgbXVzdCBiZSBwcml2YXRlIGtleSIpOwogICAgICBpZiAoIWlzUHJvYlB1YihwdWJsaWNCKSkKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNlY29uZCBhcmcgbXVzdCBiZSBwdWJsaWMga2V5Iik7CiAgICAgIGNvbnN0IGIgPSBQb2ludDIuZnJvbUhleChwdWJsaWNCKTsKICAgICAgcmV0dXJuIGIubXVsdGlwbHkobm9ybVByaXZhdGVLZXlUb1NjYWxhcihwcml2YXRlQSkpLnRvUmF3Qnl0ZXMoaXNDb21wcmVzc2VkKTsKICAgIH0KICAgIGNvbnN0IGJpdHMyaW50ID0gQ1VSVkUuYml0czJpbnQgfHwgZnVuY3Rpb24oYnl0ZXMyKSB7CiAgICAgIGNvbnN0IG51bTIgPSBieXRlc1RvTnVtYmVyQkUoYnl0ZXMyKTsKICAgICAgY29uc3QgZGVsdGEgPSBieXRlczIubGVuZ3RoICogOCAtIENVUlZFLm5CaXRMZW5ndGg7CiAgICAgIHJldHVybiBkZWx0YSA+IDAgPyBudW0yID4+IEJpZ0ludChkZWx0YSkgOiBudW0yOwogICAgfTsKICAgIGNvbnN0IGJpdHMyaW50X21vZE4gPSBDVVJWRS5iaXRzMmludF9tb2ROIHx8IGZ1bmN0aW9uKGJ5dGVzMikgewogICAgICByZXR1cm4gbW9kTjIoYml0czJpbnQoYnl0ZXMyKSk7CiAgICB9OwogICAgY29uc3QgT1JERVJfTUFTSyA9IGJpdE1hc2soQ1VSVkUubkJpdExlbmd0aCk7CiAgICBmdW5jdGlvbiBpbnQyb2N0ZXRzKG51bTIpIHsKICAgICAgYUluUmFuZ2UoYG51bSA8IDJeJHtDVVJWRS5uQml0TGVuZ3RofWAsIG51bTIsIF8wbjUsIE9SREVSX01BU0spOwogICAgICByZXR1cm4gbnVtYmVyVG9CeXRlc0JFKG51bTIsIENVUlZFLm5CeXRlTGVuZ3RoKTsKICAgIH0KICAgIGZ1bmN0aW9uIHByZXBTaWcobXNnSGFzaCwgcHJpdmF0ZUtleSwgb3B0cyA9IGRlZmF1bHRTaWdPcHRzKSB7CiAgICAgIGlmIChbInJlY292ZXJlZCIsICJjYW5vbmljYWwiXS5zb21lKChrKSA9PiBrIGluIG9wdHMpKQogICAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbigpIGxlZ2FjeSBvcHRpb25zIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgY29uc3QgeyBoYXNoOiBoYXNoMywgcmFuZG9tQnl0ZXM6IHJhbmRvbUJ5dGVzMiB9ID0gQ1VSVkU7CiAgICAgIGxldCB7IGxvd1MsIHByZWhhc2gsIGV4dHJhRW50cm9weTogZW50IH0gPSBvcHRzOwogICAgICBpZiAobG93UyA9PSBudWxsKQogICAgICAgIGxvd1MgPSB0cnVlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgdmFsaWRhdGVTaWdWZXJPcHRzKG9wdHMpOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoInByZWhhc2hlZCBtc2dIYXNoIiwgaGFzaDMobXNnSGFzaCkpOwogICAgICBjb25zdCBoMWludCA9IGJpdHMyaW50X21vZE4obXNnSGFzaCk7CiAgICAgIGNvbnN0IGQgPSBub3JtUHJpdmF0ZUtleVRvU2NhbGFyKHByaXZhdGVLZXkpOwogICAgICBjb25zdCBzZWVkQXJncyA9IFtpbnQyb2N0ZXRzKGQpLCBpbnQyb2N0ZXRzKGgxaW50KV07CiAgICAgIGlmIChlbnQgIT0gbnVsbCAmJiBlbnQgIT09IGZhbHNlKSB7CiAgICAgICAgY29uc3QgZSA9IGVudCA9PT0gdHJ1ZSA/IHJhbmRvbUJ5dGVzMihGcDIuQllURVMpIDogZW50OwogICAgICAgIHNlZWRBcmdzLnB1c2goZW5zdXJlQnl0ZXMoImV4dHJhRW50cm9weSIsIGUpKTsKICAgICAgfQogICAgICBjb25zdCBzZWVkID0gY29uY2F0Qnl0ZXMzKC4uLnNlZWRBcmdzKTsKICAgICAgY29uc3QgbSA9IGgxaW50OwogICAgICBmdW5jdGlvbiBrMnNpZyhrQnl0ZXMpIHsKICAgICAgICBjb25zdCBrID0gYml0czJpbnQoa0J5dGVzKTsKICAgICAgICBpZiAoIWlzV2l0aGluQ3VydmVPcmRlcihrKSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCBpayA9IGludk4oayk7CiAgICAgICAgY29uc3QgcSA9IFBvaW50Mi5CQVNFLm11bHRpcGx5KGspLnRvQWZmaW5lKCk7CiAgICAgICAgY29uc3QgciA9IG1vZE4yKHEueCk7CiAgICAgICAgaWYgKHIgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgY29uc3QgcyA9IG1vZE4yKGlrICogbW9kTjIobSArIHIgKiBkKSk7CiAgICAgICAgaWYgKHMgPT09IF8wbjUpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgbGV0IHJlY292ZXJ5ID0gKHEueCA9PT0gciA/IDAgOiAyKSB8IE51bWJlcihxLnkgJiBfMW41KTsKICAgICAgICBsZXQgbm9ybVMgPSBzOwogICAgICAgIGlmIChsb3dTICYmIGlzQmlnZ2VyVGhhbkhhbGZPcmRlcihzKSkgewogICAgICAgICAgbm9ybVMgPSBub3JtYWxpemVTKHMpOwogICAgICAgICAgcmVjb3ZlcnkgXj0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTaWduYXR1cmUociwgbm9ybVMsIHJlY292ZXJ5KTsKICAgICAgfQogICAgICByZXR1cm4geyBzZWVkLCBrMnNpZyB9OwogICAgfQogICAgY29uc3QgZGVmYXVsdFNpZ09wdHMgPSB7IGxvd1M6IENVUlZFLmxvd1MsIHByZWhhc2g6IGZhbHNlIH07CiAgICBjb25zdCBkZWZhdWx0VmVyT3B0cyA9IHsgbG93UzogQ1VSVkUubG93UywgcHJlaGFzaDogZmFsc2UgfTsKICAgIGZ1bmN0aW9uIHNpZ24yKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMgPSBkZWZhdWx0U2lnT3B0cykgewogICAgICBjb25zdCB7IHNlZWQsIGsyc2lnIH0gPSBwcmVwU2lnKG1zZ0hhc2gsIHByaXZLZXksIG9wdHMpOwogICAgICBjb25zdCBDID0gQ1VSVkU7CiAgICAgIGNvbnN0IGRyYmcgPSBjcmVhdGVIbWFjRHJiZyhDLmhhc2gub3V0cHV0TGVuLCBDLm5CeXRlTGVuZ3RoLCBDLmhtYWMpOwogICAgICByZXR1cm4gZHJiZyhzZWVkLCBrMnNpZyk7CiAgICB9CiAgICBQb2ludDIuQkFTRS5fc2V0V2luZG93U2l6ZSg4KTsKICAgIGZ1bmN0aW9uIHZlcmlmeShzaWduYXR1cmUsIG1zZ0hhc2gsIHB1YmxpY0tleSwgb3B0cyA9IGRlZmF1bHRWZXJPcHRzKSB7CiAgICAgIGNvbnN0IHNnID0gc2lnbmF0dXJlOwogICAgICBtc2dIYXNoID0gZW5zdXJlQnl0ZXMoIm1zZ0hhc2giLCBtc2dIYXNoKTsKICAgICAgcHVibGljS2V5ID0gZW5zdXJlQnl0ZXMoInB1YmxpY0tleSIsIHB1YmxpY0tleSk7CiAgICAgIGlmICgic3RyaWN0IiBpbiBvcHRzKQogICAgICAgIHRocm93IG5ldyBFcnJvcigib3B0aW9ucy5zdHJpY3Qgd2FzIHJlbmFtZWQgdG8gbG93UyIpOwogICAgICB2YWxpZGF0ZVNpZ1Zlck9wdHMob3B0cyk7CiAgICAgIGNvbnN0IHsgbG93UywgcHJlaGFzaCB9ID0gb3B0czsKICAgICAgbGV0IF9zaWcgPSB2b2lkIDA7CiAgICAgIGxldCBQOwogICAgICB0cnkgewogICAgICAgIGlmICh0eXBlb2Ygc2cgPT09ICJzdHJpbmciIHx8IGlzQnl0ZXMyKHNnKSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3NpZyA9IFNpZ25hdHVyZS5mcm9tREVSKHNnKTsKICAgICAgICAgIH0gY2F0Y2ggKGRlckVycm9yKSB7CiAgICAgICAgICAgIGlmICghKGRlckVycm9yIGluc3RhbmNlb2YgREVSLkVycikpCiAgICAgICAgICAgICAgdGhyb3cgZGVyRXJyb3I7CiAgICAgICAgICAgIF9zaWcgPSBTaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2cpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNnID09PSAib2JqZWN0IiAmJiB0eXBlb2Ygc2cuciA9PT0gImJpZ2ludCIgJiYgdHlwZW9mIHNnLnMgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgICBjb25zdCB7IHI6IHIyLCBzOiBzMiB9ID0gc2c7CiAgICAgICAgICBfc2lnID0gbmV3IFNpZ25hdHVyZShyMiwgczIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlBBUlNFIik7CiAgICAgICAgfQogICAgICAgIFAgPSBQb2ludDIuZnJvbUhleChwdWJsaWNLZXkpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGlmIChlcnJvci5tZXNzYWdlID09PSAiUEFSU0UiKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzaWduYXR1cmUgbXVzdCBiZSBTaWduYXR1cmUgaW5zdGFuY2UsIFVpbnQ4QXJyYXkgb3IgaGV4IHN0cmluZ2ApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAobG93UyAmJiBfc2lnLmhhc0hpZ2hTKCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAocHJlaGFzaCkKICAgICAgICBtc2dIYXNoID0gQ1VSVkUuaGFzaChtc2dIYXNoKTsKICAgICAgY29uc3QgeyByLCBzIH0gPSBfc2lnOwogICAgICBjb25zdCBoID0gYml0czJpbnRfbW9kTihtc2dIYXNoKTsKICAgICAgY29uc3QgaXMgPSBpbnZOKHMpOwogICAgICBjb25zdCB1MSA9IG1vZE4yKGggKiBpcyk7CiAgICAgIGNvbnN0IHUyID0gbW9kTjIociAqIGlzKTsKICAgICAgY29uc3QgUiA9IFBvaW50Mi5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFAsIHUxLCB1Mik/LnRvQWZmaW5lKCk7CiAgICAgIGlmICghUikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGNvbnN0IHYgPSBtb2ROMihSLngpOwogICAgICByZXR1cm4gdiA9PT0gcjsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIENVUlZFLAogICAgICBnZXRQdWJsaWNLZXksCiAgICAgIGdldFNoYXJlZFNlY3JldCwKICAgICAgc2lnbjogc2lnbjIsCiAgICAgIHZlcmlmeSwKICAgICAgUHJvamVjdGl2ZVBvaW50OiBQb2ludDIsCiAgICAgIFNpZ25hdHVyZSwKICAgICAgdXRpbHMKICAgIH07CiAgfQogIGZ1bmN0aW9uIFNXVUZwU3FydFJhdGlvKEZwMiwgWikgewogICAgY29uc3QgcSA9IEZwMi5PUkRFUjsKICAgIGxldCBsID0gXzBuNTsKICAgIGZvciAobGV0IG8gPSBxIC0gXzFuNTsgbyAlIF8ybjQgPT09IF8wbjU7IG8gLz0gXzJuNCkKICAgICAgbCArPSBfMW41OwogICAgY29uc3QgYzEgPSBsOwogICAgY29uc3QgXzJuX3Bvd19jMV8xID0gXzJuNCA8PCBjMSAtIF8xbjUgLSBfMW41OwogICAgY29uc3QgXzJuX3Bvd19jMSA9IF8ybl9wb3dfYzFfMSAqIF8ybjQ7CiAgICBjb25zdCBjMiA9IChxIC0gXzFuNSkgLyBfMm5fcG93X2MxOwogICAgY29uc3QgYzMgPSAoYzIgLSBfMW41KSAvIF8ybjQ7CiAgICBjb25zdCBjNCA9IF8ybl9wb3dfYzEgLSBfMW41OwogICAgY29uc3QgYzUgPSBfMm5fcG93X2MxXzE7CiAgICBjb25zdCBjNiA9IEZwMi5wb3coWiwgYzIpOwogICAgY29uc3QgYzcgPSBGcDIucG93KFosIChjMiArIF8xbjUpIC8gXzJuNCk7CiAgICBsZXQgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgbGV0IHR2MSA9IGM2OwogICAgICBsZXQgdHYyID0gRnAyLnBvdyh2LCBjNCk7CiAgICAgIGxldCB0djMgPSBGcDIuc3FyKHR2Mik7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCB2KTsKICAgICAgbGV0IHR2NSA9IEZwMi5tdWwodSwgdHYzKTsKICAgICAgdHY1ID0gRnAyLnBvdyh0djUsIGMzKTsKICAgICAgdHY1ID0gRnAyLm11bCh0djUsIHR2Mik7CiAgICAgIHR2MiA9IEZwMi5tdWwodHY1LCB2KTsKICAgICAgdHYzID0gRnAyLm11bCh0djUsIHUpOwogICAgICBsZXQgdHY0ID0gRnAyLm11bCh0djMsIHR2Mik7CiAgICAgIHR2NSA9IEZwMi5wb3codHY0LCBjNSk7CiAgICAgIGxldCBpc1FSID0gRnAyLmVxbCh0djUsIEZwMi5PTkUpOwogICAgICB0djIgPSBGcDIubXVsKHR2MywgYzcpOwogICAgICB0djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgdHYzID0gRnAyLmNtb3YodHYyLCB0djMsIGlzUVIpOwogICAgICB0djQgPSBGcDIuY21vdih0djUsIHR2NCwgaXNRUik7CiAgICAgIGZvciAobGV0IGkgPSBjMTsgaSA+IF8xbjU7IGktLSkgewogICAgICAgIGxldCB0djUyID0gaSAtIF8ybjQ7CiAgICAgICAgdHY1MiA9IF8ybjQgPDwgdHY1MiAtIF8xbjU7CiAgICAgICAgbGV0IHR2djUgPSBGcDIucG93KHR2NCwgdHY1Mik7CiAgICAgICAgY29uc3QgZTEgPSBGcDIuZXFsKHR2djUsIEZwMi5PTkUpOwogICAgICAgIHR2MiA9IEZwMi5tdWwodHYzLCB0djEpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djEpOwogICAgICAgIHR2djUgPSBGcDIubXVsKHR2NCwgdHYxKTsKICAgICAgICB0djMgPSBGcDIuY21vdih0djIsIHR2MywgZTEpOwogICAgICAgIHR2NCA9IEZwMi5jbW92KHR2djUsIHR2NCwgZTEpOwogICAgICB9CiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGlzUVIsIHZhbHVlOiB0djMgfTsKICAgIH07CiAgICBpZiAoRnAyLk9SREVSICUgXzRuMiA9PT0gXzNuMikgewogICAgICBjb25zdCBjMTIgPSAoRnAyLk9SREVSIC0gXzNuMikgLyBfNG4yOwogICAgICBjb25zdCBjMjIgPSBGcDIuc3FydChGcDIubmVnKFopKTsKICAgICAgc3FydFJhdGlvID0gKHUsIHYpID0+IHsKICAgICAgICBsZXQgdHYxID0gRnAyLnNxcih2KTsKICAgICAgICBjb25zdCB0djIgPSBGcDIubXVsKHUsIHYpOwogICAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCB0djIpOwogICAgICAgIGxldCB5MSA9IEZwMi5wb3codHYxLCBjMTIpOwogICAgICAgIHkxID0gRnAyLm11bCh5MSwgdHYyKTsKICAgICAgICBjb25zdCB5MiA9IEZwMi5tdWwoeTEsIGMyMik7CiAgICAgICAgY29uc3QgdHYzID0gRnAyLm11bChGcDIuc3FyKHkxKSwgdik7CiAgICAgICAgY29uc3QgaXNRUiA9IEZwMi5lcWwodHYzLCB1KTsKICAgICAgICBsZXQgeSA9IEZwMi5jbW92KHkyLCB5MSwgaXNRUik7CiAgICAgICAgcmV0dXJuIHsgaXNWYWxpZDogaXNRUiwgdmFsdWU6IHkgfTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBzcXJ0UmF0aW87CiAgfQogIGZ1bmN0aW9uIG1hcFRvQ3VydmVTaW1wbGVTV1UoRnAyLCBvcHRzKSB7CiAgICB2YWxpZGF0ZUZpZWxkKEZwMik7CiAgICBpZiAoIUZwMi5pc1ZhbGlkKG9wdHMuQSkgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuQikgfHwgIUZwMi5pc1ZhbGlkKG9wdHMuWikpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZVNpbXBsZVNXVTogaW52YWxpZCBvcHRzIik7CiAgICBjb25zdCBzcXJ0UmF0aW8gPSBTV1VGcFNxcnRSYXRpbyhGcDIsIG9wdHMuWik7CiAgICBpZiAoIUZwMi5pc09kZCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJGcC5pc09kZCBpcyBub3QgaW1wbGVtZW50ZWQhIik7CiAgICByZXR1cm4gKHUpID0+IHsKICAgICAgbGV0IHR2MSwgdHYyLCB0djMsIHR2NCwgdHY1LCB0djYsIHgsIHk7CiAgICAgIHR2MSA9IEZwMi5zcXIodSk7CiAgICAgIHR2MSA9IEZwMi5tdWwodHYxLCBvcHRzLlopOwogICAgICB0djIgPSBGcDIuc3FyKHR2MSk7CiAgICAgIHR2MiA9IEZwMi5hZGQodHYyLCB0djEpOwogICAgICB0djMgPSBGcDIuYWRkKHR2MiwgRnAyLk9ORSk7CiAgICAgIHR2MyA9IEZwMi5tdWwodHYzLCBvcHRzLkIpOwogICAgICB0djQgPSBGcDIuY21vdihvcHRzLlosIEZwMi5uZWcodHYyKSwgIUZwMi5lcWwodHYyLCBGcDIuWkVSTykpOwogICAgICB0djQgPSBGcDIubXVsKHR2NCwgb3B0cy5BKTsKICAgICAgdHYyID0gRnAyLnNxcih0djMpOwogICAgICB0djYgPSBGcDIuc3FyKHR2NCk7CiAgICAgIHR2NSA9IEZwMi5tdWwodHY2LCBvcHRzLkEpOwogICAgICB0djIgPSBGcDIuYWRkKHR2MiwgdHY1KTsKICAgICAgdHYyID0gRnAyLm11bCh0djIsIHR2Myk7CiAgICAgIHR2NiA9IEZwMi5tdWwodHY2LCB0djQpOwogICAgICB0djUgPSBGcDIubXVsKHR2Niwgb3B0cy5CKTsKICAgICAgdHYyID0gRnAyLmFkZCh0djIsIHR2NSk7CiAgICAgIHggPSBGcDIubXVsKHR2MSwgdHYzKTsKICAgICAgY29uc3QgeyBpc1ZhbGlkLCB2YWx1ZSB9ID0gc3FydFJhdGlvKHR2MiwgdHY2KTsKICAgICAgeSA9IEZwMi5tdWwodHYxLCB1KTsKICAgICAgeSA9IEZwMi5tdWwoeSwgdmFsdWUpOwogICAgICB4ID0gRnAyLmNtb3YoeCwgdHYzLCBpc1ZhbGlkKTsKICAgICAgeSA9IEZwMi5jbW92KHksIHZhbHVlLCBpc1ZhbGlkKTsKICAgICAgY29uc3QgZTEgPSBGcDIuaXNPZGQodSkgPT09IEZwMi5pc09kZCh5KTsKICAgICAgeSA9IEZwMi5jbW92KEZwMi5uZWcoeSksIHksIGUxKTsKICAgICAgeCA9IEZwMi5kaXYoeCwgdHY0KTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgdmFyIGIybiwgaDJiLCBERVIsIF8wbjUsIF8xbjUsIF8ybjQsIF8zbjIsIF80bjI7CiAgdmFyIGluaXRfd2VpZXJzdHJhc3MgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzIigpIHsKICAgICAgaW5pdF9jdXJ2ZSgpOwogICAgICBpbml0X21vZHVsYXIoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgaW5pdF91dGlsczQoKTsKICAgICAgKHsgYnl0ZXNUb051bWJlckJFOiBiMm4sIGhleFRvQnl0ZXM6IGgyYiB9ID0gdXRpbHNfZXhwb3J0cyk7CiAgICAgIERFUiA9IHsKICAgICAgICAvLyBhc24uMSBERVIgZW5jb2RpbmcgdXRpbHMKICAgICAgICBFcnI6IGNsYXNzIERFUkVyciBleHRlbmRzIEVycm9yIHsKICAgICAgICAgIGNvbnN0cnVjdG9yKG0gPSAiIikgewogICAgICAgICAgICBzdXBlcihtKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIEJhc2ljIGJ1aWxkaW5nIGJsb2NrIGlzIFRMViAoVGFnLUxlbmd0aC1WYWx1ZSkKICAgICAgICBfdGx2OiB7CiAgICAgICAgICBlbmNvZGU6ICh0YWcsIGRhdGEpID0+IHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgaWYgKHRhZyA8IDAgfHwgdGFnID4gMjU2KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZW5jb2RlOiB3cm9uZyB0YWciKTsKICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoICYgMSkKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogdW5wYWRkZWQgZGF0YSIpOwogICAgICAgICAgICBjb25zdCBkYXRhTGVuID0gZGF0YS5sZW5ndGggLyAyOwogICAgICAgICAgICBjb25zdCBsZW4gPSBudW1iZXJUb0hleFVucGFkZGVkKGRhdGFMZW4pOwogICAgICAgICAgICBpZiAobGVuLmxlbmd0aCAvIDIgJiAxMjgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5lbmNvZGU6IGxvbmcgZm9ybSBsZW5ndGggdG9vIGJpZyIpOwogICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBkYXRhTGVuID4gMTI3ID8gbnVtYmVyVG9IZXhVbnBhZGRlZChsZW4ubGVuZ3RoIC8gMiB8IDEyOCkgOiAiIjsKICAgICAgICAgICAgcmV0dXJuIGAke251bWJlclRvSGV4VW5wYWRkZWQodGFnKX0ke2xlbkxlbn0ke2xlbn0ke2RhdGF9YDsKICAgICAgICAgIH0sCiAgICAgICAgICAvLyB2IC0gdmFsdWUsIGwgLSBsZWZ0IGJ5dGVzICh1bnBhcnNlZCkKICAgICAgICAgIGRlY29kZSh0YWcsIGRhdGEpIHsKICAgICAgICAgICAgY29uc3QgeyBFcnI6IEUgfSA9IERFUjsKICAgICAgICAgICAgbGV0IHBvcyA9IDA7CiAgICAgICAgICAgIGlmICh0YWcgPCAwIHx8IHRhZyA+IDI1NikKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmVuY29kZTogd3JvbmcgdGFnIik7CiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA8IDIgfHwgZGF0YVtwb3MrK10gIT09IHRhZykKICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZTogd3JvbmcgdGx2Iik7CiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gZGF0YVtwb3MrK107CiAgICAgICAgICAgIGNvbnN0IGlzTG9uZyA9ICEhKGZpcnN0ICYgMTI4KTsKICAgICAgICAgICAgbGV0IGxlbmd0aCA9IDA7CiAgICAgICAgICAgIGlmICghaXNMb25nKQogICAgICAgICAgICAgIGxlbmd0aCA9IGZpcnN0OwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBsZW5MZW4gPSBmaXJzdCAmIDEyNzsKICAgICAgICAgICAgICBpZiAoIWxlbkxlbikKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBpbmRlZmluaXRlIGxlbmd0aCBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICAgICAgaWYgKGxlbkxlbiA+IDQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogYnl0ZSBsZW5ndGggaXMgdG9vIGJpZyIpOwogICAgICAgICAgICAgIGNvbnN0IGxlbmd0aEJ5dGVzID0gZGF0YS5zdWJhcnJheShwb3MsIHBvcyArIGxlbkxlbik7CiAgICAgICAgICAgICAgaWYgKGxlbmd0aEJ5dGVzLmxlbmd0aCAhPT0gbGVuTGVuKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IGxlbmd0aCBieXRlcyBub3QgY29tcGxldGUiKTsKICAgICAgICAgICAgICBpZiAobGVuZ3RoQnl0ZXNbMF0gPT09IDApCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRSgidGx2LmRlY29kZShsb25nKTogemVybyBsZWZ0bW9zdCBieXRlIik7CiAgICAgICAgICAgICAgZm9yIChjb25zdCBiIG9mIGxlbmd0aEJ5dGVzKQogICAgICAgICAgICAgICAgbGVuZ3RoID0gbGVuZ3RoIDw8IDggfCBiOwogICAgICAgICAgICAgIHBvcyArPSBsZW5MZW47CiAgICAgICAgICAgICAgaWYgKGxlbmd0aCA8IDEyOCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ0bHYuZGVjb2RlKGxvbmcpOiBub3QgbWluaW1hbCBlbmNvZGluZyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHYgPSBkYXRhLnN1YmFycmF5KHBvcywgcG9zICsgbGVuZ3RoKTsKICAgICAgICAgICAgaWYgKHYubGVuZ3RoICE9PSBsZW5ndGgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoInRsdi5kZWNvZGU6IHdyb25nIHZhbHVlIGxlbmd0aCIpOwogICAgICAgICAgICByZXR1cm4geyB2LCBsOiBkYXRhLnN1YmFycmF5KHBvcyArIGxlbmd0aCkgfTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIGh0dHBzOi8vY3J5cHRvLnN0YWNrZXhjaGFuZ2UuY29tL2EvNTc3MzQgTGVmdG1vc3QgYml0IG9mIGZpcnN0IGJ5dGUgaXMgJ25lZ2F0aXZlJyBmbGFnLAogICAgICAgIC8vIHNpbmNlIHdlIGFsd2F5cyB1c2UgcG9zaXRpdmUgaW50ZWdlcnMgaGVyZS4gSXQgbXVzdCBhbHdheXMgYmUgZW1wdHk6CiAgICAgICAgLy8gLSBhZGQgemVybyBieXRlIGlmIGV4aXN0cwogICAgICAgIC8vIC0gaWYgbmV4dCBieXRlIGRvZXNuJ3QgaGF2ZSBhIGZsYWcsIGxlYWRpbmcgemVybyBpcyBub3QgYWxsb3dlZCAobWluaW1hbCBlbmNvZGluZykKICAgICAgICBfaW50OiB7CiAgICAgICAgICBlbmNvZGUobnVtMikgewogICAgICAgICAgICBjb25zdCB7IEVycjogRSB9ID0gREVSOwogICAgICAgICAgICBpZiAobnVtMiA8IF8wbjUpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEUoImludGVnZXI6IG5lZ2F0aXZlIGludGVnZXJzIGFyZSBub3QgYWxsb3dlZCIpOwogICAgICAgICAgICBsZXQgaGV4ID0gbnVtYmVyVG9IZXhVbnBhZGRlZChudW0yKTsKICAgICAgICAgICAgaWYgKE51bWJlci5wYXJzZUludChoZXhbMF0sIDE2KSAmIDgpCiAgICAgICAgICAgICAgaGV4ID0gIjAwIiArIGhleDsKICAgICAgICAgICAgaWYgKGhleC5sZW5ndGggJiAxKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJ1bmV4cGVjdGVkIGFzc2VydGlvbiIpOwogICAgICAgICAgICByZXR1cm4gaGV4OwogICAgICAgICAgfSwKICAgICAgICAgIGRlY29kZShkYXRhKSB7CiAgICAgICAgICAgIGNvbnN0IHsgRXJyOiBFIH0gPSBERVI7CiAgICAgICAgICAgIGlmIChkYXRhWzBdICYgMTI4KQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiBuZWdhdGl2ZSIpOwogICAgICAgICAgICBpZiAoZGF0YVswXSA9PT0gMCAmJiAhKGRhdGFbMV0gJiAxMjgpKQogICAgICAgICAgICAgIHRocm93IG5ldyBFKCJJbnZhbGlkIHNpZ25hdHVyZSBpbnRlZ2VyOiB1bm5lY2Vzc2FyeSBsZWFkaW5nIHplcm8iKTsKICAgICAgICAgICAgcmV0dXJuIGIybihkYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvU2lnKGhleCkgewogICAgICAgICAgY29uc3QgeyBFcnI6IEUsIF9pbnQ6IGludCwgX3RsdjogdGx2IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBkYXRhID0gdHlwZW9mIGhleCA9PT0gInN0cmluZyIgPyBoMmIoaGV4KSA6IGhleDsKICAgICAgICAgIGFieXRlcyhkYXRhKTsKICAgICAgICAgIGNvbnN0IHsgdjogc2VxQnl0ZXMsIGw6IHNlcUxlZnRCeXRlcyB9ID0gdGx2LmRlY29kZSg0OCwgZGF0YSk7CiAgICAgICAgICBpZiAoc2VxTGVmdEJ5dGVzLmxlbmd0aCkKICAgICAgICAgICAgdGhyb3cgbmV3IEUoIkludmFsaWQgc2lnbmF0dXJlOiBsZWZ0IGJ5dGVzIGFmdGVyIHBhcnNpbmciKTsKICAgICAgICAgIGNvbnN0IHsgdjogckJ5dGVzLCBsOiByTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHNlcUJ5dGVzKTsKICAgICAgICAgIGNvbnN0IHsgdjogc0J5dGVzLCBsOiBzTGVmdEJ5dGVzIH0gPSB0bHYuZGVjb2RlKDIsIHJMZWZ0Qnl0ZXMpOwogICAgICAgICAgaWYgKHNMZWZ0Qnl0ZXMubGVuZ3RoKQogICAgICAgICAgICB0aHJvdyBuZXcgRSgiSW52YWxpZCBzaWduYXR1cmU6IGxlZnQgYnl0ZXMgYWZ0ZXIgcGFyc2luZyIpOwogICAgICAgICAgcmV0dXJuIHsgcjogaW50LmRlY29kZShyQnl0ZXMpLCBzOiBpbnQuZGVjb2RlKHNCeXRlcykgfTsKICAgICAgICB9LAogICAgICAgIGhleEZyb21TaWcoc2lnKSB7CiAgICAgICAgICBjb25zdCB7IF90bHY6IHRsdiwgX2ludDogaW50IH0gPSBERVI7CiAgICAgICAgICBjb25zdCBzZXEgPSBgJHt0bHYuZW5jb2RlKDIsIGludC5lbmNvZGUoc2lnLnIpKX0ke3Rsdi5lbmNvZGUoMiwgaW50LmVuY29kZShzaWcucykpfWA7CiAgICAgICAgICByZXR1cm4gdGx2LmVuY29kZSg0OCwgc2VxKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIF8wbjUgPSBCaWdJbnQoMCk7CiAgICAgIF8xbjUgPSBCaWdJbnQoMSk7CiAgICAgIF8ybjQgPSBCaWdJbnQoMik7CiAgICAgIF8zbjIgPSBCaWdJbnQoMyk7CiAgICAgIF80bjIgPSBCaWdJbnQoNCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby9Abm9ibGUrY3VydmVzQDEuNi4wL25vZGVfbW9kdWxlcy9Abm9ibGUvY3VydmVzL2VzbS9fc2hvcnR3X3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0SGFzaChoYXNoMykgewogICAgcmV0dXJuIHsKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIGhtYWM6IChrZXksIC4uLm1zZ3MpID0+IGhtYWMoaGFzaDMsIGtleSwgY29uY2F0Qnl0ZXMoLi4ubXNncykpLAogICAgICByYW5kb21CeXRlcwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlQ3VydmUoY3VydmVEZWYsIGRlZkhhc2gpIHsKICAgIGNvbnN0IGNyZWF0ZSA9IChoYXNoMykgPT4gd2VpZXJzdHJhc3MoeyAuLi5jdXJ2ZURlZiwgLi4uZ2V0SGFzaChoYXNoMykgfSk7CiAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7IC4uLmNyZWF0ZShkZWZIYXNoKSwgY3JlYXRlIH0pOwogIH0KICB2YXIgaW5pdF9zaG9ydHdfdXRpbHMgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanMiKCkgewogICAgICBpbml0X2htYWMoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF93ZWllcnN0cmFzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcwogIGZ1bmN0aW9uIGkyb3NwKHZhbHVlLCBsZW5ndGgpIHsKICAgIGFudW0odmFsdWUpOwogICAgYW51bShsZW5ndGgpOwogICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+PSAxIDw8IDggKiBsZW5ndGgpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBiYWQgSTJPU1AgY2FsbDogdmFsdWU9JHt2YWx1ZX0gbGVuZ3RoPSR7bGVuZ3RofWApOwogICAgfQogICAgY29uc3QgcmVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aCB9KS5maWxsKDApOwogICAgZm9yIChsZXQgaSA9IGxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgIHJlc1tpXSA9IHZhbHVlICYgMjU1OwogICAgICB2YWx1ZSA+Pj49IDg7CiAgICB9CiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkocmVzKTsKICB9CiAgZnVuY3Rpb24gc3RyeG9yKGEsIGIpIHsKICAgIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KGEubGVuZ3RoKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewogICAgICBhcnJbaV0gPSBhW2ldIF4gYltpXTsKICAgIH0KICAgIHJldHVybiBhcnI7CiAgfQogIGZ1bmN0aW9uIGFudW0oaXRlbSkgewogICAgaWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihpdGVtKSkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJudW1iZXIgZXhwZWN0ZWQiKTsKICB9CiAgZnVuY3Rpb24gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5JbkJ5dGVzLCBIKSB7CiAgICBhYnl0ZXMobXNnKTsKICAgIGFieXRlcyhEU1QpOwogICAgYW51bShsZW5JbkJ5dGVzKTsKICAgIGlmIChEU1QubGVuZ3RoID4gMjU1KQogICAgICBEU1QgPSBIKGNvbmNhdEJ5dGVzMyh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIiksIERTVCkpOwogICAgY29uc3QgeyBvdXRwdXRMZW46IGJfaW5fYnl0ZXMsIGJsb2NrTGVuOiByX2luX2J5dGVzIH0gPSBIOwogICAgY29uc3QgZWxsID0gTWF0aC5jZWlsKGxlbkluQnl0ZXMgLyBiX2luX2J5dGVzKTsKICAgIGlmIChsZW5JbkJ5dGVzID4gNjU1MzUgfHwgZWxsID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3htZDogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICBjb25zdCBEU1RfcHJpbWUgPSBjb25jYXRCeXRlczMoRFNULCBpMm9zcChEU1QubGVuZ3RoLCAxKSk7CiAgICBjb25zdCBaX3BhZCA9IGkyb3NwKDAsIHJfaW5fYnl0ZXMpOwogICAgY29uc3QgbF9pX2Jfc3RyID0gaTJvc3AobGVuSW5CeXRlcywgMik7CiAgICBjb25zdCBiID0gbmV3IEFycmF5KGVsbCk7CiAgICBjb25zdCBiXzAgPSBIKGNvbmNhdEJ5dGVzMyhaX3BhZCwgbXNnLCBsX2lfYl9zdHIsIGkyb3NwKDAsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGJbMF0gPSBIKGNvbmNhdEJ5dGVzMyhiXzAsIGkyb3NwKDEsIDEpLCBEU1RfcHJpbWUpKTsKICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGVsbDsgaSsrKSB7CiAgICAgIGNvbnN0IGFyZ3MgPSBbc3RyeG9yKGJfMCwgYltpIC0gMV0pLCBpMm9zcChpICsgMSwgMSksIERTVF9wcmltZV07CiAgICAgIGJbaV0gPSBIKGNvbmNhdEJ5dGVzMyguLi5hcmdzKSk7CiAgICB9CiAgICBjb25zdCBwc2V1ZG9fcmFuZG9tX2J5dGVzID0gY29uY2F0Qnl0ZXMzKC4uLmIpOwogICAgcmV0dXJuIHBzZXVkb19yYW5kb21fYnl0ZXMuc2xpY2UoMCwgbGVuSW5CeXRlcyk7CiAgfQogIGZ1bmN0aW9uIGV4cGFuZF9tZXNzYWdlX3hvZihtc2csIERTVCwgbGVuSW5CeXRlcywgaywgSCkgewogICAgYWJ5dGVzKG1zZyk7CiAgICBhYnl0ZXMoRFNUKTsKICAgIGFudW0obGVuSW5CeXRlcyk7CiAgICBpZiAoRFNULmxlbmd0aCA+IDI1NSkgewogICAgICBjb25zdCBka0xlbiA9IE1hdGguY2VpbCgyICogayAvIDgpOwogICAgICBEU1QgPSBILmNyZWF0ZSh7IGRrTGVuIH0pLnVwZGF0ZSh1dGY4VG9CeXRlczIoIkgyQy1PVkVSU0laRS1EU1QtIikpLnVwZGF0ZShEU1QpLmRpZ2VzdCgpOwogICAgfQogICAgaWYgKGxlbkluQnl0ZXMgPiA2NTUzNSB8fCBEU1QubGVuZ3RoID4gMjU1KQogICAgICB0aHJvdyBuZXcgRXJyb3IoImV4cGFuZF9tZXNzYWdlX3hvZjogaW52YWxpZCBsZW5JbkJ5dGVzIik7CiAgICByZXR1cm4gSC5jcmVhdGUoeyBka0xlbjogbGVuSW5CeXRlcyB9KS51cGRhdGUobXNnKS51cGRhdGUoaTJvc3AobGVuSW5CeXRlcywgMikpLnVwZGF0ZShEU1QpLnVwZGF0ZShpMm9zcChEU1QubGVuZ3RoLCAxKSkuZGlnZXN0KCk7CiAgfQogIGZ1bmN0aW9uIGhhc2hfdG9fZmllbGQobXNnLCBjb3VudCwgb3B0aW9ucykgewogICAgdmFsaWRhdGVPYmplY3Qob3B0aW9ucywgewogICAgICBEU1Q6ICJzdHJpbmdPclVpbnQ4QXJyYXkiLAogICAgICBwOiAiYmlnaW50IiwKICAgICAgbTogImlzU2FmZUludGVnZXIiLAogICAgICBrOiAiaXNTYWZlSW50ZWdlciIsCiAgICAgIGhhc2g6ICJoYXNoIgogICAgfSk7CiAgICBjb25zdCB7IHAsIGssIG0sIGhhc2g6IGhhc2gzLCBleHBhbmQsIERTVDogX0RTVCB9ID0gb3B0aW9uczsKICAgIGFieXRlcyhtc2cpOwogICAgYW51bShjb3VudCk7CiAgICBjb25zdCBEU1QgPSB0eXBlb2YgX0RTVCA9PT0gInN0cmluZyIgPyB1dGY4VG9CeXRlczIoX0RTVCkgOiBfRFNUOwogICAgY29uc3QgbG9nMnAgPSBwLnRvU3RyaW5nKDIpLmxlbmd0aDsKICAgIGNvbnN0IEwgPSBNYXRoLmNlaWwoKGxvZzJwICsgaykgLyA4KTsKICAgIGNvbnN0IGxlbl9pbl9ieXRlcyA9IGNvdW50ICogbSAqIEw7CiAgICBsZXQgcHJiOwogICAgaWYgKGV4cGFuZCA9PT0gInhtZCIpIHsKICAgICAgcHJiID0gZXhwYW5kX21lc3NhZ2VfeG1kKG1zZywgRFNULCBsZW5faW5fYnl0ZXMsIGhhc2gzKTsKICAgIH0gZWxzZSBpZiAoZXhwYW5kID09PSAieG9mIikgewogICAgICBwcmIgPSBleHBhbmRfbWVzc2FnZV94b2YobXNnLCBEU1QsIGxlbl9pbl9ieXRlcywgaywgaGFzaDMpOwogICAgfSBlbHNlIGlmIChleHBhbmQgPT09ICJfaW50ZXJuYWxfcGFzcyIpIHsKICAgICAgcHJiID0gbXNnOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdleHBhbmQgbXVzdCBiZSAieG1kIiBvciAieG9mIicpOwogICAgfQogICAgY29uc3QgdSA9IG5ldyBBcnJheShjb3VudCk7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgY29uc3QgZSA9IG5ldyBBcnJheShtKTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBtOyBqKyspIHsKICAgICAgICBjb25zdCBlbG1fb2Zmc2V0ID0gTCAqIChqICsgaSAqIG0pOwogICAgICAgIGNvbnN0IHR2ID0gcHJiLnN1YmFycmF5KGVsbV9vZmZzZXQsIGVsbV9vZmZzZXQgKyBMKTsKICAgICAgICBlW2pdID0gbW9kKG9zMmlwKHR2KSwgcCk7CiAgICAgIH0KICAgICAgdVtpXSA9IGU7CiAgICB9CiAgICByZXR1cm4gdTsKICB9CiAgZnVuY3Rpb24gaXNvZ2VueU1hcChmaWVsZCwgbWFwKSB7CiAgICBjb25zdCBDT0VGRiA9IG1hcC5tYXAoKGkpID0+IEFycmF5LmZyb20oaSkucmV2ZXJzZSgpKTsKICAgIHJldHVybiAoeCwgeSkgPT4gewogICAgICBjb25zdCBbeE51bSwgeERlbiwgeU51bSwgeURlbl0gPSBDT0VGRi5tYXAoKHZhbCkgPT4gdmFsLnJlZHVjZSgoYWNjLCBpKSA9PiBmaWVsZC5hZGQoZmllbGQubXVsKGFjYywgeCksIGkpKSk7CiAgICAgIHggPSBmaWVsZC5kaXYoeE51bSwgeERlbik7CiAgICAgIHkgPSBmaWVsZC5tdWwoeSwgZmllbGQuZGl2KHlOdW0sIHlEZW4pKTsKICAgICAgcmV0dXJuIHsgeCwgeSB9OwogICAgfTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlSGFzaGVyKFBvaW50MiwgbWFwVG9DdXJ2ZSwgZGVmKSB7CiAgICBpZiAodHlwZW9mIG1hcFRvQ3VydmUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZSgpIG11c3QgYmUgZGVmaW5lZCIpOwogICAgcmV0dXJuIHsKICAgICAgLy8gRW5jb2RlcyBieXRlIHN0cmluZyB0byBlbGxpcHRpYyBjdXJ2ZS4KICAgICAgLy8gaGFzaF90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBoYXNoVG9DdXJ2ZShtc2csIG9wdGlvbnMpIHsKICAgICAgICBjb25zdCB1ID0gaGFzaF90b19maWVsZChtc2csIDIsIHsgLi4uZGVmLCBEU1Q6IGRlZi5EU1QsIC4uLm9wdGlvbnMgfSk7CiAgICAgICAgY29uc3QgdTAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHVbMF0pKTsKICAgICAgICBjb25zdCB1MSA9IFBvaW50Mi5mcm9tQWZmaW5lKG1hcFRvQ3VydmUodVsxXSkpOwogICAgICAgIGNvbnN0IFAgPSB1MC5hZGQodTEpLmNsZWFyQ29mYWN0b3IoKTsKICAgICAgICBQLmFzc2VydFZhbGlkaXR5KCk7CiAgICAgICAgcmV0dXJuIFA7CiAgICAgIH0sCiAgICAgIC8vIEVuY29kZXMgYnl0ZSBzdHJpbmcgdG8gZWxsaXB0aWMgY3VydmUuCiAgICAgIC8vIGVuY29kZV90b19jdXJ2ZSBmcm9tIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM5MzgwI3NlY3Rpb24tMwogICAgICBlbmNvZGVUb0N1cnZlKG1zZywgb3B0aW9ucykgewogICAgICAgIGNvbnN0IHUgPSBoYXNoX3RvX2ZpZWxkKG1zZywgMSwgeyAuLi5kZWYsIERTVDogZGVmLmVuY29kZURTVCwgLi4ub3B0aW9ucyB9KTsKICAgICAgICBjb25zdCBQID0gUG9pbnQyLmZyb21BZmZpbmUobWFwVG9DdXJ2ZSh1WzBdKSkuY2xlYXJDb2ZhY3RvcigpOwogICAgICAgIFAuYXNzZXJ0VmFsaWRpdHkoKTsKICAgICAgICByZXR1cm4gUDsKICAgICAgfSwKICAgICAgLy8gU2FtZSBhcyBlbmNvZGVUb0N1cnZlLCBidXQgd2l0aG91dCBoYXNoCiAgICAgIG1hcFRvQ3VydmUoc2NhbGFycykgewogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzY2FsYXJzKSkKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigibWFwVG9DdXJ2ZTogZXhwZWN0ZWQgYXJyYXkgb2YgYmlnaW50cyIpOwogICAgICAgIGZvciAoY29uc3QgaSBvZiBzY2FsYXJzKQogICAgICAgICAgaWYgKHR5cGVvZiBpICE9PSAiYmlnaW50IikKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBtYXBUb0N1cnZlOiBleHBlY3RlZCBhcnJheSBvZiBiaWdpbnRzLCBnb3QgJHtpfSBpbiBhcnJheWApOwogICAgICAgIGNvbnN0IFAgPSBQb2ludDIuZnJvbUFmZmluZShtYXBUb0N1cnZlKHNjYWxhcnMpKS5jbGVhckNvZmFjdG9yKCk7CiAgICAgICAgUC5hc3NlcnRWYWxpZGl0eSgpOwogICAgICAgIHJldHVybiBQOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgb3MyaXA7CiAgdmFyIGluaXRfaGFzaF90b19jdXJ2ZSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vYWJzdHJhY3QvaGFzaC10by1jdXJ2ZS5qcyIoKSB7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBvczJpcCA9IGJ5dGVzVG9OdW1iZXJCRTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStjdXJ2ZXNAMS42LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9jdXJ2ZXMvZXNtL3NlY3AyNTZrMS5qcwogIHZhciBzZWNwMjU2azFfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KHNlY3AyNTZrMV9leHBvcnRzLCB7CiAgICBlbmNvZGVUb0N1cnZlOiAoKSA9PiBlbmNvZGVUb0N1cnZlLAogICAgaGFzaFRvQ3VydmU6ICgpID0+IGhhc2hUb0N1cnZlLAogICAgc2Nobm9ycjogKCkgPT4gc2Nobm9yciwKICAgIHNlY3AyNTZrMTogKCkgPT4gc2VjcDI1NmsxCiAgfSk7CiAgZnVuY3Rpb24gc3FydE1vZCh5KSB7CiAgICBjb25zdCBQID0gc2VjcDI1NmsxUDsKICAgIGNvbnN0IF8zbjMgPSBCaWdJbnQoMyksIF82biA9IEJpZ0ludCg2KSwgXzExbiA9IEJpZ0ludCgxMSksIF8yMm4gPSBCaWdJbnQoMjIpOwogICAgY29uc3QgXzIzbiA9IEJpZ0ludCgyMyksIF80NG4gPSBCaWdJbnQoNDQpLCBfODhuID0gQmlnSW50KDg4KTsKICAgIGNvbnN0IGIyID0geSAqIHkgKiB5ICUgUDsKICAgIGNvbnN0IGIzMiA9IGIyICogYjIgKiB5ICUgUDsKICAgIGNvbnN0IGI2ID0gcG93MihiMzIsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IGI5ID0gcG93MihiNiwgXzNuMywgUCkgKiBiMzIgJSBQOwogICAgY29uc3QgYjExID0gcG93MihiOSwgXzJuNSwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCBiMjIgPSBwb3cyKGIxMSwgXzExbiwgUCkgKiBiMTEgJSBQOwogICAgY29uc3QgYjQ0ID0gcG93MihiMjIsIF8yMm4sIFApICogYjIyICUgUDsKICAgIGNvbnN0IGI4OCA9IHBvdzIoYjQ0LCBfNDRuLCBQKSAqIGI0NCAlIFA7CiAgICBjb25zdCBiMTc2ID0gcG93MihiODgsIF84OG4sIFApICogYjg4ICUgUDsKICAgIGNvbnN0IGIyMjAgPSBwb3cyKGIxNzYsIF80NG4sIFApICogYjQ0ICUgUDsKICAgIGNvbnN0IGIyMjMgPSBwb3cyKGIyMjAsIF8zbjMsIFApICogYjMyICUgUDsKICAgIGNvbnN0IHQxID0gcG93MihiMjIzLCBfMjNuLCBQKSAqIGIyMiAlIFA7CiAgICBjb25zdCB0MiA9IHBvdzIodDEsIF82biwgUCkgKiBiMiAlIFA7CiAgICBjb25zdCByb290MiA9IHBvdzIodDIsIF8ybjUsIFApOwogICAgaWYgKCFGcC5lcWwoRnAuc3FyKHJvb3QyKSwgeSkpCiAgICAgIHRocm93IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgc3F1YXJlIHJvb3QiKTsKICAgIHJldHVybiByb290MjsKICB9CiAgZnVuY3Rpb24gdGFnZ2VkSGFzaCh0YWcsIC4uLm1lc3NhZ2VzKSB7CiAgICBsZXQgdGFnUCA9IFRBR0dFRF9IQVNIX1BSRUZJWEVTW3RhZ107CiAgICBpZiAodGFnUCA9PT0gdm9pZCAwKSB7CiAgICAgIGNvbnN0IHRhZ0ggPSBzaGEyNTYoVWludDhBcnJheS5mcm9tKHRhZywgKGMpID0+IGMuY2hhckNvZGVBdCgwKSkpOwogICAgICB0YWdQID0gY29uY2F0Qnl0ZXMzKHRhZ0gsIHRhZ0gpOwogICAgICBUQUdHRURfSEFTSF9QUkVGSVhFU1t0YWddID0gdGFnUDsKICAgIH0KICAgIHJldHVybiBzaGEyNTYoY29uY2F0Qnl0ZXMzKHRhZ1AsIC4uLm1lc3NhZ2VzKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdikgewogICAgbGV0IGRfID0gc2VjcDI1NmsxLnV0aWxzLm5vcm1Qcml2YXRlS2V5VG9TY2FsYXIocHJpdik7CiAgICBsZXQgcCA9IFBvaW50LmZyb21Qcml2YXRlS2V5KGRfKTsKICAgIGNvbnN0IHNjYWxhciA9IHAuaGFzRXZlblkoKSA/IGRfIDogbW9kTigtZF8pOwogICAgcmV0dXJuIHsgc2NhbGFyLCBieXRlczogcG9pbnRUb0J5dGVzKHApIH07CiAgfQogIGZ1bmN0aW9uIGxpZnRfeCh4KSB7CiAgICBhSW5SYW5nZSgieCIsIHgsIF8xbjYsIHNlY3AyNTZrMVApOwogICAgY29uc3QgeHggPSBtb2RQKHggKiB4KTsKICAgIGNvbnN0IGMgPSBtb2RQKHh4ICogeCArIEJpZ0ludCg3KSk7CiAgICBsZXQgeSA9IHNxcnRNb2QoYyk7CiAgICBpZiAoeSAlIF8ybjUgIT09IF8wbjYpCiAgICAgIHkgPSBtb2RQKC15KTsKICAgIGNvbnN0IHAgPSBuZXcgUG9pbnQoeCwgeSwgXzFuNik7CiAgICBwLmFzc2VydFZhbGlkaXR5KCk7CiAgICByZXR1cm4gcDsKICB9CiAgZnVuY3Rpb24gY2hhbGxlbmdlKC4uLmFyZ3MpIHsKICAgIHJldHVybiBtb2ROKG51bSh0YWdnZWRIYXNoKCJCSVAwMzQwL2NoYWxsZW5nZSIsIC4uLmFyZ3MpKSk7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJHZXRQdWJsaWNLZXkocHJpdmF0ZUtleSkgewogICAgcmV0dXJuIHNjaG5vcnJHZXRFeHRQdWJLZXkocHJpdmF0ZUtleSkuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIHNjaG5vcnJTaWduKG1lc3NhZ2UsIHByaXZhdGVLZXksIGF1eFJhbmQgPSByYW5kb21CeXRlcygzMikpIHsKICAgIGNvbnN0IG0gPSBlbnN1cmVCeXRlcygibWVzc2FnZSIsIG1lc3NhZ2UpOwogICAgY29uc3QgeyBieXRlczogcHgsIHNjYWxhcjogZCB9ID0gc2Nobm9yckdldEV4dFB1YktleShwcml2YXRlS2V5KTsKICAgIGNvbnN0IGEgPSBlbnN1cmVCeXRlcygiYXV4UmFuZCIsIGF1eFJhbmQsIDMyKTsKICAgIGNvbnN0IHQgPSBudW1UbzMyYihkIF4gbnVtKHRhZ2dlZEhhc2goIkJJUDAzNDAvYXV4IiwgYSkpKTsKICAgIGNvbnN0IHJhbmQgPSB0YWdnZWRIYXNoKCJCSVAwMzQwL25vbmNlIiwgdCwgcHgsIG0pOwogICAgY29uc3Qga18gPSBtb2ROKG51bShyYW5kKSk7CiAgICBpZiAoa18gPT09IF8wbjYpCiAgICAgIHRocm93IG5ldyBFcnJvcigic2lnbiBmYWlsZWQ6IGsgaXMgemVybyIpOwogICAgY29uc3QgeyBieXRlczogcngsIHNjYWxhcjogayB9ID0gc2Nobm9yckdldEV4dFB1YktleShrXyk7CiAgICBjb25zdCBlID0gY2hhbGxlbmdlKHJ4LCBweCwgbSk7CiAgICBjb25zdCBzaWcgPSBuZXcgVWludDhBcnJheSg2NCk7CiAgICBzaWcuc2V0KHJ4LCAwKTsKICAgIHNpZy5zZXQobnVtVG8zMmIobW9kTihrICsgZSAqIGQpKSwgMzIpOwogICAgaWYgKCFzY2hub3JyVmVyaWZ5KHNpZywgbSwgcHgpKQogICAgICB0aHJvdyBuZXcgRXJyb3IoInNpZ246IEludmFsaWQgc2lnbmF0dXJlIHByb2R1Y2VkIik7CiAgICByZXR1cm4gc2lnOwogIH0KICBmdW5jdGlvbiBzY2hub3JyVmVyaWZ5KHNpZ25hdHVyZSwgbWVzc2FnZSwgcHVibGljS2V5KSB7CiAgICBjb25zdCBzaWcgPSBlbnN1cmVCeXRlcygic2lnbmF0dXJlIiwgc2lnbmF0dXJlLCA2NCk7CiAgICBjb25zdCBtID0gZW5zdXJlQnl0ZXMoIm1lc3NhZ2UiLCBtZXNzYWdlKTsKICAgIGNvbnN0IHB1YiA9IGVuc3VyZUJ5dGVzKCJwdWJsaWNLZXkiLCBwdWJsaWNLZXksIDMyKTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFAgPSBsaWZ0X3gobnVtKHB1YikpOwogICAgICBjb25zdCByID0gbnVtKHNpZy5zdWJhcnJheSgwLCAzMikpOwogICAgICBpZiAoIWluUmFuZ2UociwgXzFuNiwgc2VjcDI1NmsxUCkpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBzID0gbnVtKHNpZy5zdWJhcnJheSgzMiwgNjQpKTsKICAgICAgaWYgKCFpblJhbmdlKHMsIF8xbjYsIHNlY3AyNTZrMU4pKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgY29uc3QgZSA9IGNoYWxsZW5nZShudW1UbzMyYihyKSwgcG9pbnRUb0J5dGVzKFApLCBtKTsKICAgICAgY29uc3QgUiA9IEdtdWxBZGQoUCwgcywgbW9kTigtZSkpOwogICAgICBpZiAoIVIgfHwgIVIuaGFzRXZlblkoKSB8fCBSLnRvQWZmaW5lKCkueCAhPT0gcikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KICB2YXIgc2VjcDI1NmsxUCwgc2VjcDI1NmsxTiwgXzFuNiwgXzJuNSwgZGl2TmVhcmVzdCwgRnAsIHNlY3AyNTZrMSwgXzBuNiwgVEFHR0VEX0hBU0hfUFJFRklYRVMsIHBvaW50VG9CeXRlcywgbnVtVG8zMmIsIG1vZFAsIG1vZE4sIFBvaW50LCBHbXVsQWRkLCBudW0sIHNjaG5vcnIsIGlzb01hcCwgbWFwU1dVLCBodGYsIGhhc2hUb0N1cnZlLCBlbmNvZGVUb0N1cnZlOwogIHZhciBpbml0X3NlY3AyNTZrMSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vQG5vYmxlK2N1cnZlc0AxLjYuMC9ub2RlX21vZHVsZXMvQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzIigpIHsKICAgICAgaW5pdF9zaGEyNTYoKTsKICAgICAgaW5pdF91dGlsczIoKTsKICAgICAgaW5pdF9zaG9ydHdfdXRpbHMoKTsKICAgICAgaW5pdF9oYXNoX3RvX2N1cnZlKCk7CiAgICAgIGluaXRfbW9kdWxhcigpOwogICAgICBpbml0X3V0aWxzNCgpOwogICAgICBpbml0X3dlaWVyc3RyYXNzKCk7CiAgICAgIHNlY3AyNTZrMVAgPSBCaWdJbnQoIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZmMyZiIpOwogICAgICBzZWNwMjU2azFOID0gQmlnSW50KCIweGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlYmFhZWRjZTZhZjQ4YTAzYmJmZDI1ZThjZDAzNjQxNDEiKTsKICAgICAgXzFuNiA9IEJpZ0ludCgxKTsKICAgICAgXzJuNSA9IEJpZ0ludCgyKTsKICAgICAgZGl2TmVhcmVzdCA9IChhLCBiKSA9PiAoYSArIGIgLyBfMm41KSAvIGI7CiAgICAgIEZwID0gRmllbGQoc2VjcDI1NmsxUCwgdm9pZCAwLCB2b2lkIDAsIHsgc3FydDogc3FydE1vZCB9KTsKICAgICAgc2VjcDI1NmsxID0gY3JlYXRlQ3VydmUoewogICAgICAgIGE6IEJpZ0ludCgwKSwKICAgICAgICAvLyBlcXVhdGlvbiBwYXJhbXM6IGEsIGIKICAgICAgICBiOiBCaWdJbnQoNyksCiAgICAgICAgLy8gU2VlbSB0byBiZSByaWdpZDogYml0Y29pbnRhbGsub3JnL2luZGV4LnBocD90b3BpYz0yODk3OTUubXNnMzE4Mzk3NSNtc2czMTgzOTc1CiAgICAgICAgRnAsCiAgICAgICAgLy8gRmllbGQncyBwcmltZTogMm4qKjI1Nm4gLSAybioqMzJuIC0gMm4qKjluIC0gMm4qKjhuIC0gMm4qKjduIC0gMm4qKjZuIC0gMm4qKjRuIC0gMW4KICAgICAgICBuOiBzZWNwMjU2azFOLAogICAgICAgIC8vIEN1cnZlIG9yZGVyLCB0b3RhbCBjb3VudCBvZiB2YWxpZCBwb2ludHMgaW4gdGhlIGZpZWxkCiAgICAgICAgLy8gQmFzZSBwb2ludCAoeCwgeSkgYWthIGdlbmVyYXRvciBwb2ludAogICAgICAgIEd4OiBCaWdJbnQoIjU1MDY2MjYzMDIyMjc3MzQzNjY5NTc4NzE4ODk1MTY4NTM0MzI2MjUwNjAzNDUzNzc3NTk0MTc1NTAwMTg3MzYwMzg5MTE2NzI5MjQwIiksCiAgICAgICAgR3k6IEJpZ0ludCgiMzI2NzA1MTAwMjA3NTg4MTY5NzgwODMwODUxMzA1MDcwNDMxODQ0NzEyNzMzODA2NTkyNDMyNzU5Mzg5MDQzMzU3NTczMzc0ODI0MjQiKSwKICAgICAgICBoOiBCaWdJbnQoMSksCiAgICAgICAgLy8gQ29mYWN0b3IKICAgICAgICBsb3dTOiB0cnVlLAogICAgICAgIC8vIEFsbG93IG9ubHkgbG93LVMgc2lnbmF0dXJlcyBieSBkZWZhdWx0IGluIHNpZ24oKSBhbmQgdmVyaWZ5KCkKICAgICAgICAvKioKICAgICAgICAgKiBzZWNwMjU2azEgYmVsb25ncyB0byBLb2JsaXR6IGN1cnZlczogaXQgaGFzIGVmZmljaWVudGx5IGNvbXB1dGFibGUgZW5kb21vcnBoaXNtLgogICAgICAgICAqIEVuZG9tb3JwaGlzbSB1c2VzIDJ4IGxlc3MgUkFNLCBzcGVlZHMgdXAgcHJlY29tcHV0YXRpb24gYnkgMnggYW5kIEVDREggLyBrZXkgcmVjb3ZlcnkgYnkgMjAlLgogICAgICAgICAqIEZvciBwcmVjb21wdXRlZCB3TkFGIGl0IHRyYWRlcyBvZmYgMS8yIGluaXQgdGltZSAmIDEvMyByYW0gZm9yIDIwJSBwZXJmIGhpdC4KICAgICAgICAgKiBFeHBsYW5hdGlvbjogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vcGF1bG1pbGxyL2ViNjcwODA2NzkzZTg0ZGY2MjhhN2M0MzRhODczMDY2CiAgICAgICAgICovCiAgICAgICAgZW5kbzogewogICAgICAgICAgYmV0YTogQmlnSW50KCIweDdhZTk2YTJiNjU3YzA3MTA2ZTY0NDc5ZWFjMzQzNGU5OWNmMDQ5NzUxMmY1ODk5NWMxMzk2YzI4NzE5NTAxZWUiKSwKICAgICAgICAgIHNwbGl0U2NhbGFyOiAoaykgPT4gewogICAgICAgICAgICBjb25zdCBuID0gc2VjcDI1NmsxTjsKICAgICAgICAgICAgY29uc3QgYTEgPSBCaWdJbnQoIjB4MzA4NmQyMjFhN2Q0NmJjZGU4NmM5MGU0OTI4NGViMTUiKTsKICAgICAgICAgICAgY29uc3QgYjEgPSAtXzFuNiAqIEJpZ0ludCgiMHhlNDQzN2VkNjAxMGU4ODI4NmY1NDdmYTkwYWJmZTRjMyIpOwogICAgICAgICAgICBjb25zdCBhMiA9IEJpZ0ludCgiMHgxMTRjYTUwZjdhOGUyZjNmNjU3YzExMDhkOWQ0NGNmZDgiKTsKICAgICAgICAgICAgY29uc3QgYjIgPSBhMTsKICAgICAgICAgICAgY29uc3QgUE9XXzJfMTI4ID0gQmlnSW50KCIweDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIpOwogICAgICAgICAgICBjb25zdCBjMSA9IGRpdk5lYXJlc3QoYjIgKiBrLCBuKTsKICAgICAgICAgICAgY29uc3QgYzIgPSBkaXZOZWFyZXN0KC1iMSAqIGssIG4pOwogICAgICAgICAgICBsZXQgazEgPSBtb2QoayAtIGMxICogYTEgLSBjMiAqIGEyLCBuKTsKICAgICAgICAgICAgbGV0IGsyID0gbW9kKC1jMSAqIGIxIC0gYzIgKiBiMiwgbik7CiAgICAgICAgICAgIGNvbnN0IGsxbmVnID0gazEgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGNvbnN0IGsybmVnID0gazIgPiBQT1dfMl8xMjg7CiAgICAgICAgICAgIGlmIChrMW5lZykKICAgICAgICAgICAgICBrMSA9IG4gLSBrMTsKICAgICAgICAgICAgaWYgKGsybmVnKQogICAgICAgICAgICAgIGsyID0gbiAtIGsyOwogICAgICAgICAgICBpZiAoazEgPiBQT1dfMl8xMjggfHwgazIgPiBQT1dfMl8xMjgpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInNwbGl0U2NhbGFyOiBFbmRvbW9ycGhpc20gZmFpbGVkLCBrPSIgKyBrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4geyBrMW5lZywgazEsIGsybmVnLCBrMiB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgc2hhMjU2KTsKICAgICAgXzBuNiA9IEJpZ0ludCgwKTsKICAgICAgVEFHR0VEX0hBU0hfUFJFRklYRVMgPSB7fTsKICAgICAgcG9pbnRUb0J5dGVzID0gKHBvaW50KSA9PiBwb2ludC50b1Jhd0J5dGVzKHRydWUpLnNsaWNlKDEpOwogICAgICBudW1UbzMyYiA9IChuKSA9PiBudW1iZXJUb0J5dGVzQkUobiwgMzIpOwogICAgICBtb2RQID0gKHgpID0+IG1vZCh4LCBzZWNwMjU2azFQKTsKICAgICAgbW9kTiA9ICh4KSA9PiBtb2QoeCwgc2VjcDI1NmsxTik7CiAgICAgIFBvaW50ID0gc2VjcDI1NmsxLlByb2plY3RpdmVQb2ludDsKICAgICAgR211bEFkZCA9IChRLCBhLCBiKSA9PiBQb2ludC5CQVNFLm11bHRpcGx5QW5kQWRkVW5zYWZlKFEsIGEsIGIpOwogICAgICBudW0gPSBieXRlc1RvTnVtYmVyQkU7CiAgICAgIHNjaG5vcnIgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+ICh7CiAgICAgICAgZ2V0UHVibGljS2V5OiBzY2hub3JyR2V0UHVibGljS2V5LAogICAgICAgIHNpZ246IHNjaG5vcnJTaWduLAogICAgICAgIHZlcmlmeTogc2Nobm9yclZlcmlmeSwKICAgICAgICB1dGlsczogewogICAgICAgICAgcmFuZG9tUHJpdmF0ZUtleTogc2VjcDI1NmsxLnV0aWxzLnJhbmRvbVByaXZhdGVLZXksCiAgICAgICAgICBsaWZ0X3gsCiAgICAgICAgICBwb2ludFRvQnl0ZXMsCiAgICAgICAgICBudW1iZXJUb0J5dGVzQkUsCiAgICAgICAgICBieXRlc1RvTnVtYmVyQkUsCiAgICAgICAgICB0YWdnZWRIYXNoLAogICAgICAgICAgbW9kCiAgICAgICAgfQogICAgICB9KSkoKTsKICAgICAgaXNvTWFwID0gLyogQF9fUFVSRV9fICovICgoKSA9PiBpc29nZW55TWFwKEZwLCBbCiAgICAgICAgLy8geE51bQogICAgICAgIFsKICAgICAgICAgICIweDhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhlMzhkYWFhYWE4YzciLAogICAgICAgICAgIjB4N2QzZDRjODBiYzMyMWQ1YjlmMzE1Y2VhN2ZkNDRjNWQ1OTVkMmZjMGJmNjNiOTJkZmZmMTA0NGYxN2M2NTgxIiwKICAgICAgICAgICIweDUzNGMzMjhkMjNmMjM0ZTZlMmE0MTNkZWNhMjVjYWVjZTQ1MDYxNDQwMzdjNDAzMTRlY2JkMGI1M2Q5ZGQyNjIiLAogICAgICAgICAgIjB4OGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGUzOGRhYWFhYTg4YyIKICAgICAgICBdLAogICAgICAgIC8vIHhEZW4KICAgICAgICBbCiAgICAgICAgICAiMHhkMzU3NzExOTNkOTQ5MThhOWNhMzRjY2JiN2I2NDBkZDg2Y2Q0MDk1NDJmODQ4N2Q5ZmU2Yjc0NTc4MWViNDliIiwKICAgICAgICAgICIweGVkYWRjNmY2NDM4M2RjMWRmN2M0YjJkNTFiNTQyMjU0MDZkMzZiNjQxZjVlNDFiYmM1MmE1NjYxMmE4YzZkMTQiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0sCiAgICAgICAgLy8geU51bQogICAgICAgIFsKICAgICAgICAgICIweDRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiZGExMmY2ODRiOGUzOGUyM2MiLAogICAgICAgICAgIjB4Yzc1ZTBjMzJkNWNiN2MwZmE5ZDBhNTRiMTJhMGE2ZDU2NDdhYjA0NmQ2ODZkYTZmZGZmYzkwZmMyMDFkNzFhMyIsCiAgICAgICAgICAiMHgyOWE2MTk0NjkxZjkxYTczNzE1MjA5ZWY2NTEyZTU3NjcyMjgzMGEyMDFiZTIwMThhNzY1ZTg1YTllY2VlOTMxIiwKICAgICAgICAgICIweDJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmNjg0YmRhMTJmMzhlMzhkODQiCiAgICAgICAgXSwKICAgICAgICAvLyB5RGVuCiAgICAgICAgWwogICAgICAgICAgIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVmZmZmZjkzYiIsCiAgICAgICAgICAiMHg3YTA2NTM0YmI4YmRiNDlmZDVlOWU2NjMyNzIyYzI5ODk0NjdjMWJmYzhlOGQ5NzhkZmI0MjVkMjY4NWMyNTczIiwKICAgICAgICAgICIweDY0ODRhYTcxNjU0NWNhMmNmM2E3MGMzZmE4ZmUzMzdlMGEzZDIxMTYyZjBkNjI5OWE3YmY4MTkyYmZkMmE3NmYiLAogICAgICAgICAgIjB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIKICAgICAgICAgIC8vIExBU1QgMQogICAgICAgIF0KICAgICAgXS5tYXAoKGkpID0+IGkubWFwKChqKSA9PiBCaWdJbnQoaikpKSkpKCk7CiAgICAgIG1hcFNXVSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gbWFwVG9DdXJ2ZVNpbXBsZVNXVShGcCwgewogICAgICAgIEE6IEJpZ0ludCgiMHgzZjg3MzFhYmRkNjYxYWRjYTA4YTU1NThmMGY1ZDI3MmU5NTNkMzYzY2I2ZjBlNWQ0MDU0NDdjMDFhNDQ0NTMzIiksCiAgICAgICAgQjogQmlnSW50KCIxNzcxIiksCiAgICAgICAgWjogRnAuY3JlYXRlKEJpZ0ludCgiLTExIikpCiAgICAgIH0pKSgpOwogICAgICBodGYgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGNyZWF0ZUhhc2hlcihzZWNwMjU2azEuUHJvamVjdGl2ZVBvaW50LCAoc2NhbGFycykgPT4gewogICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gbWFwU1dVKEZwLmNyZWF0ZShzY2FsYXJzWzBdKSk7CiAgICAgICAgcmV0dXJuIGlzb01hcCh4LCB5KTsKICAgICAgfSwgewogICAgICAgIERTVDogInNlY3AyNTZrMV9YTUQ6U0hBLTI1Nl9TU1dVX1JPXyIsCiAgICAgICAgZW5jb2RlRFNUOiAic2VjcDI1NmsxX1hNRDpTSEEtMjU2X1NTV1VfTlVfIiwKICAgICAgICBwOiBGcC5PUkRFUiwKICAgICAgICBtOiAxLAogICAgICAgIGs6IDEyOCwKICAgICAgICBleHBhbmQ6ICJ4bWQiLAogICAgICAgIGhhc2g6IHNoYTI1NgogICAgICB9KSkoKTsKICAgICAgaGFzaFRvQ3VydmUgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IGh0Zi5oYXNoVG9DdXJ2ZSkoKTsKICAgICAgZW5jb2RlVG9DdXJ2ZSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4gaHRmLmVuY29kZVRvQ3VydmUpKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcwogIHZhciBFeGVjdXRpb25SZXZlcnRlZEVycm9yLCBGZWVDYXBUb29IaWdoRXJyb3IsIEZlZUNhcFRvb0xvd0Vycm9yLCBOb25jZVRvb0hpZ2hFcnJvciwgTm9uY2VUb29Mb3dFcnJvciwgTm9uY2VNYXhWYWx1ZUVycm9yLCBJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLCBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yLCBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvciwgVGlwQWJvdmVGZWVDYXBFcnJvciwgVW5rbm93bk5vZGVFcnJvcjsKICB2YXIgaW5pdF9ub2RlID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvbm9kZS5qcyIoKSB7CiAgICAgIGluaXRfZm9ybWF0R3dlaSgpOwogICAgICBpbml0X2Jhc2UoKTsKICAgICAgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWVzc2FnZSB9ID0ge30pIHsKICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IG1lc3NhZ2U/LnJlcGxhY2UoImV4ZWN1dGlvbiByZXZlcnRlZDogIiwgIiIpPy5yZXBsYWNlKCJleGVjdXRpb24gcmV2ZXJ0ZWQiLCAiIik7CiAgICAgICAgICBzdXBlcihgRXhlY3V0aW9uIHJldmVydGVkICR7cmVhc29uID8gYHdpdGggcmVhc29uOiAke3JlYXNvbn1gIDogImZvciBhbiB1bmtub3duIHJlYXNvbiJ9LmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJFeGVjdXRpb25SZXZlcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciwgImNvZGUiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IDMKICAgICAgfSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGVjdXRpb25SZXZlcnRlZEVycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9leGVjdXRpb24gcmV2ZXJ0ZWQvCiAgICAgIH0pOwogICAgICBGZWVDYXBUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkgY2Fubm90IGJlIGhpZ2hlciB0aGFuIHRoZSBtYXhpbXVtIGFsbG93ZWQgdmFsdWUgKDJeMjU2LTEpLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29IaWdoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWVDYXBUb29IaWdoRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiAyXF4yNTYtMXxmZWUgY2FwIGhpZ2hlciB0aGFuIDJcXjI1Ni0xLwogICAgICB9KTsKICAgICAgRmVlQ2FwVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfWAgOiAiIn0gZ3dlaSkgY2Fubm90IGJlIGxvd2VyIHRoYW4gdGhlIGJsb2NrIGJhc2UgZmVlLmAsIHsKICAgICAgICAgICAgY2F1c2UsCiAgICAgICAgICAgIG5hbWU6ICJGZWVDYXBUb29Mb3dFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlZUNhcFRvb0xvd0Vycm9yLCAibm9kZU1lc3NhZ2UiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IC9tYXggZmVlIHBlciBnYXMgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfGZlZSBjYXAgbGVzcyB0aGFuIGJsb2NrIGJhc2UgZmVlfHRyYW5zYWN0aW9uIGlzIG91dGRhdGVkLwogICAgICB9KTsKICAgICAgTm9uY2VUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIG5vbmNlIH0gPSB7fSkgewogICAgICAgICAgc3VwZXIoYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBoaWdoZXIgdGhhbiB0aGUgbmV4dCBvbmUgZXhwZWN0ZWQuYCwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vSGlnaEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb25jZVRvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgdG9vIGhpZ2gvCiAgICAgIH0pOwogICAgICBOb25jZVRvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYE5vbmNlIHByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gJHtub25jZSA/IGAoJHtub25jZX0pIGAgOiAiIn1pcyBsb3dlciB0aGFuIHRoZSBjdXJyZW50IG5vbmNlIG9mIHRoZSBhY2NvdW50LmAsCiAgICAgICAgICAgICJUcnkgaW5jcmVhc2luZyB0aGUgbm9uY2Ugb3IgZmluZCB0aGUgbGF0ZXN0IG5vbmNlIHdpdGggYGdldFRyYW5zYWN0aW9uQ291bnRgLiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgeyBjYXVzZSwgbmFtZTogIk5vbmNlVG9vTG93RXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlVG9vTG93RXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL25vbmNlIHRvbyBsb3d8dHJhbnNhY3Rpb24gYWxyZWFkeSBpbXBvcnRlZHxhbHJlYWR5IGtub3duLwogICAgICB9KTsKICAgICAgTm9uY2VNYXhWYWx1ZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBub25jZSB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBOb25jZSBwcm92aWRlZCBmb3IgdGhlIHRyYW5zYWN0aW9uICR7bm9uY2UgPyBgKCR7bm9uY2V9KSBgIDogIiJ9ZXhjZWVkcyB0aGUgbWF4aW11bSBhbGxvd2VkIG5vbmNlLmAsIHsgY2F1c2UsIG5hbWU6ICJOb25jZU1heFZhbHVlRXJyb3IiIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vbmNlTWF4VmFsdWVFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvbm9uY2UgaGFzIG1heCB2YWx1ZS8KICAgICAgfSk7CiAgICAgIEluc3VmZmljaWVudEZ1bmRzRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJUaGUgdG90YWwgY29zdCAoZ2FzICogZ2FzIGZlZSArIHZhbHVlKSBvZiBleGVjdXRpbmcgdGhpcyB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBiYWxhbmNlIG9mIHRoZSBhY2NvdW50LiIKICAgICAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAgICAgIlRoaXMgZXJyb3IgY291bGQgYXJpc2Ugd2hlbiB0aGUgYWNjb3VudCBkb2VzIG5vdCBoYXZlIGVub3VnaCBmdW5kcyB0bzoiLAogICAgICAgICAgICAgICIgLSBwYXkgZm9yIHRoZSB0b3RhbCBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIHBheSBmb3IgdGhlIHZhbHVlIHRvIHNlbmQuIiwKICAgICAgICAgICAgICAiICIsCiAgICAgICAgICAgICAgIlRoZSBjb3N0IG9mIHRoZSB0cmFuc2FjdGlvbiBpcyBjYWxjdWxhdGVkIGFzIGBnYXMgKiBnYXMgZmVlICsgdmFsdWVgLCB3aGVyZToiLAogICAgICAgICAgICAgICIgLSBgZ2FzYCBpcyB0aGUgYW1vdW50IG9mIGdhcyBuZWVkZWQgZm9yIHRyYW5zYWN0aW9uIHRvIGV4ZWN1dGUsIiwKICAgICAgICAgICAgICAiIC0gYGdhcyBmZWVgIGlzIHRoZSBnYXMgZmVlLCIsCiAgICAgICAgICAgICAgIiAtIGB2YWx1ZWAgaXMgdGhlIGFtb3VudCBvZiBldGhlciB0byBzZW5kIHRvIHRoZSByZWNpcGllbnQuIgogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiSW5zdWZmaWNpZW50RnVuZHNFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluc3VmZmljaWVudEZ1bmRzRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL2luc3VmZmljaWVudCBmdW5kc3xleGNlZWRzIHRyYW5zYWN0aW9uIHNlbmRlciBhY2NvdW50IGJhbGFuY2UvCiAgICAgIH0pOwogICAgICBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UsIGdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgYW1vdW50IG9mIGdhcyAke2dhcyA/IGAoJHtnYXN9KSBgIDogIiJ9cHJvdmlkZWQgZm9yIHRoZSB0cmFuc2FjdGlvbiBleGNlZWRzIHRoZSBsaW1pdCBhbGxvd2VkIGZvciB0aGUgYmxvY2suYCwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIkludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludHJpbnNpY0dhc1Rvb0hpZ2hFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gaGlnaHxnYXMgbGltaXQgcmVhY2hlZC8KICAgICAgfSk7CiAgICAgIEludHJpbnNpY0dhc1Rvb0xvd0Vycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlLCBnYXMgfSA9IHt9KSB7CiAgICAgICAgICBzdXBlcihgVGhlIGFtb3VudCBvZiBnYXMgJHtnYXMgPyBgKCR7Z2FzfSkgYCA6ICIifXByb3ZpZGVkIGZvciB0aGUgdHJhbnNhY3Rpb24gaXMgdG9vIGxvdy5gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiSW50cmluc2ljR2FzVG9vTG93RXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRyaW5zaWNHYXNUb29Mb3dFcnJvciwgIm5vZGVNZXNzYWdlIiwgewogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIHZhbHVlOiAvaW50cmluc2ljIGdhcyB0b28gbG93LwogICAgICB9KTsKICAgICAgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2F1c2UgfSkgewogICAgICAgICAgc3VwZXIoIlRoZSB0cmFuc2FjdGlvbiB0eXBlIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgY2hhaW4uIiwgewogICAgICAgICAgICBjYXVzZSwKICAgICAgICAgICAgbmFtZTogIlRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL3RyYW5zYWN0aW9uIHR5cGUgbm90IHZhbGlkLwogICAgICB9KTsKICAgICAgVGlwQWJvdmVGZWVDYXBFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBjYXVzZSwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcyB9ID0ge30pIHsKICAgICAgICAgIHN1cGVyKFsKICAgICAgICAgICAgYFRoZSBwcm92aWRlZCB0aXAgKFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCR7bWF4UHJpb3JpdHlGZWVQZXJHYXMgPyBgID0gJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAgOiAiIn0pIGNhbm5vdCBiZSBoaWdoZXIgdGhhbiB0aGUgZmVlIGNhcCAoXGBtYXhGZWVQZXJHYXNcYCR7bWF4RmVlUGVyR2FzID8gYCA9ICR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCA6ICIifSkuYAogICAgICAgICAgXS5qb2luKCJcbiIpLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVGlwQWJvdmVGZWVDYXBFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpcEFib3ZlRmVlQ2FwRXJyb3IsICJub2RlTWVzc2FnZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogL21heCBwcmlvcml0eSBmZWUgcGVyIGdhcyBoaWdoZXIgdGhhbiBtYXggZmVlIHBlciBnYXN8dGlwIGhpZ2hlciB0aGFuIGZlZSBjYXAvCiAgICAgIH0pOwogICAgICBVbmtub3duTm9kZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNhdXNlIH0pIHsKICAgICAgICAgIHN1cGVyKGBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBleGVjdXRpbmc6ICR7Y2F1c2U/LnNob3J0TWVzc2FnZX1gLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBuYW1lOiAiVW5rbm93bk5vZGVFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMKICBmdW5jdGlvbiBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKGVyci5kZXRhaWxzIHx8ICIiKS50b0xvd2VyQ2FzZSgpOwogICAgY29uc3QgZXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvciA9IGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIgPyBlcnIud2FsaygoZSkgPT4gZT8uY29kZSA9PT0gRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvci5jb2RlKSA6IGVycjsKICAgIGlmIChleGVjdXRpb25SZXZlcnRlZEVycm9yIGluc3RhbmNlb2YgQmFzZUVycm9yMikKICAgICAgcmV0dXJuIG5ldyBFeGVjdXRpb25SZXZlcnRlZEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1lc3NhZ2U6IGV4ZWN1dGlvblJldmVydGVkRXJyb3IuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChFeGVjdXRpb25SZXZlcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgRXhlY3V0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtZXNzYWdlOiBlcnIuZGV0YWlscwogICAgICB9KTsKICAgIGlmIChGZWVDYXBUb29IaWdoRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoewogICAgICAgIGNhdXNlOiBlcnIsCiAgICAgICAgbWF4RmVlUGVyR2FzOiBhcmdzPy5tYXhGZWVQZXJHYXMKICAgICAgfSk7CiAgICBpZiAoRmVlQ2FwVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBGZWVDYXBUb29Mb3dFcnJvcih7CiAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICBtYXhGZWVQZXJHYXM6IGFyZ3M/Lm1heEZlZVBlckdhcwogICAgICB9KTsKICAgIGlmIChOb25jZVRvb0hpZ2hFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBOb25jZVRvb0xvd0Vycm9yKHsgY2F1c2U6IGVyciwgbm9uY2U6IGFyZ3M/Lm5vbmNlIH0pOwogICAgaWYgKE5vbmNlTWF4VmFsdWVFcnJvci5ub2RlTWVzc2FnZS50ZXN0KG1lc3NhZ2UpKQogICAgICByZXR1cm4gbmV3IE5vbmNlTWF4VmFsdWVFcnJvcih7IGNhdXNlOiBlcnIsIG5vbmNlOiBhcmdzPy5ub25jZSB9KTsKICAgIGlmIChJbnN1ZmZpY2llbnRGdW5kc0Vycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW5zdWZmaWNpZW50RnVuZHNFcnJvcih7IGNhdXNlOiBlcnIgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vSGlnaEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yKHsgY2F1c2U6IGVyciwgZ2FzOiBhcmdzPy5nYXMgfSk7CiAgICBpZiAoSW50cmluc2ljR2FzVG9vTG93RXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcih7IGNhdXNlOiBlcnIsIGdhczogYXJncz8uZ2FzIH0pOwogICAgaWYgKFRyYW5zYWN0aW9uVHlwZU5vdFN1cHBvcnRlZEVycm9yLm5vZGVNZXNzYWdlLnRlc3QobWVzc2FnZSkpCiAgICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IoeyBjYXVzZTogZXJyIH0pOwogICAgaWYgKFRpcEFib3ZlRmVlQ2FwRXJyb3Iubm9kZU1lc3NhZ2UudGVzdChtZXNzYWdlKSkKICAgICAgcmV0dXJuIG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIG1heEZlZVBlckdhczogYXJncz8ubWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiBhcmdzPy5tYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9KTsKICAgIHJldHVybiBuZXcgVW5rbm93bk5vZGVFcnJvcih7CiAgICAgIGNhdXNlOiBlcnIKICAgIH0pOwogIH0KICB2YXIgaW5pdF9nZXROb2RlRXJyb3IgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXROb2RlRXJyb3IuanMiKCkgewogICAgICBpbml0X2Jhc2UoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2V4dHJhY3QuanMKICBmdW5jdGlvbiBleHRyYWN0KHZhbHVlXywgeyBmb3JtYXQgfSkgewogICAgaWYgKCFmb3JtYXQpCiAgICAgIHJldHVybiB7fTsKICAgIGNvbnN0IHZhbHVlID0ge307CiAgICBmdW5jdGlvbiBleHRyYWN0Xyhmb3JtYXR0ZWQyKSB7CiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmb3JtYXR0ZWQyKTsKICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgIGlmIChrZXkgaW4gdmFsdWVfKQogICAgICAgICAgdmFsdWVba2V5XSA9IHZhbHVlX1trZXldOwogICAgICAgIGlmIChmb3JtYXR0ZWQyW2tleV0gJiYgdHlwZW9mIGZvcm1hdHRlZDJba2V5XSA9PT0gIm9iamVjdCIgJiYgIUFycmF5LmlzQXJyYXkoZm9ybWF0dGVkMltrZXldKSkKICAgICAgICAgIGV4dHJhY3RfKGZvcm1hdHRlZDJba2V5XSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdCh2YWx1ZV8gfHwge30pOwogICAgZXh0cmFjdF8oZm9ybWF0dGVkKTsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgdmFyIGluaXRfZXh0cmFjdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9leHRyYWN0LmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvZm9ybWF0dGVyLmpzCiAgZnVuY3Rpb24gZGVmaW5lRm9ybWF0dGVyKHR5cGUsIGZvcm1hdCkgewogICAgcmV0dXJuICh7IGV4Y2x1ZGUsIGZvcm1hdDogb3ZlcnJpZGVzIH0pID0+IHsKICAgICAgcmV0dXJuIHsKICAgICAgICBleGNsdWRlLAogICAgICAgIGZvcm1hdDogKGFyZ3MpID0+IHsKICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdChhcmdzKTsKICAgICAgICAgIGlmIChleGNsdWRlKSB7CiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGV4Y2x1ZGUpIHsKICAgICAgICAgICAgICBkZWxldGUgZm9ybWF0dGVkW2tleV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLmZvcm1hdHRlZCwKICAgICAgICAgICAgLi4ub3ZlcnJpZGVzKGFyZ3MpCiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgdHlwZQogICAgICB9OwogICAgfTsKICB9CiAgdmFyIGluaXRfZm9ybWF0dGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2Zvcm1hdHRlci5qcyIoKSB7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdChyZXF1ZXN0KSB7CiAgICBjb25zdCBycGNSZXF1ZXN0ID0ge307CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYXV0aG9yaXphdGlvbkxpc3QgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmF1dGhvcml6YXRpb25MaXN0ID0gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QocmVxdWVzdC5hdXRob3JpemF0aW9uTGlzdCk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuYWNjZXNzTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QuYWNjZXNzTGlzdCA9IHJlcXVlc3QuYWNjZXNzTGlzdDsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmJsb2JzICE9PSAidW5kZWZpbmVkIikgewogICAgICBpZiAodHlwZW9mIHJlcXVlc3QuYmxvYnNbMF0gIT09ICJzdHJpbmciKQogICAgICAgIHJwY1JlcXVlc3QuYmxvYnMgPSByZXF1ZXN0LmJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4KSk7CiAgICAgIGVsc2UKICAgICAgICBycGNSZXF1ZXN0LmJsb2JzID0gcmVxdWVzdC5ibG9iczsKICAgIH0KICAgIGlmICh0eXBlb2YgcmVxdWVzdC5kYXRhICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5kYXRhID0gcmVxdWVzdC5kYXRhOwogICAgaWYgKHR5cGVvZiByZXF1ZXN0LmZyb20gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LmZyb20gPSByZXF1ZXN0LmZyb207CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5nYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lmdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QuZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lmdhc1ByaWNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5nYXNQcmljZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJwY1JlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyA9IG51bWJlclRvSGV4KHJlcXVlc3QubWF4RmVlUGVyQmxvYkdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBudW1iZXJUb0hleChyZXF1ZXN0Lm1heEZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QubWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID0gbnVtYmVyVG9IZXgocmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3Qubm9uY2UgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0Lm5vbmNlID0gbnVtYmVyVG9IZXgocmVxdWVzdC5ub25jZSk7CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudG8gIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnRvID0gcmVxdWVzdC50bzsKICAgIGlmICh0eXBlb2YgcmVxdWVzdC50eXBlICE9PSAidW5kZWZpbmVkIikKICAgICAgcnBjUmVxdWVzdC50eXBlID0gcnBjVHJhbnNhY3Rpb25UeXBlW3JlcXVlc3QudHlwZV07CiAgICBpZiAodHlwZW9mIHJlcXVlc3QudmFsdWUgIT09ICJ1bmRlZmluZWQiKQogICAgICBycGNSZXF1ZXN0LnZhbHVlID0gbnVtYmVyVG9IZXgocmVxdWVzdC52YWx1ZSk7CiAgICByZXR1cm4gcnBjUmVxdWVzdDsKICB9CiAgZnVuY3Rpb24gZm9ybWF0QXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGFkZHJlc3M6IGF1dGhvcml6YXRpb24uY29udHJhY3RBZGRyZXNzLAogICAgICByOiBhdXRob3JpemF0aW9uLnIsCiAgICAgIHM6IGF1dGhvcml6YXRpb24ucywKICAgICAgY2hhaW5JZDogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IG51bWJlclRvSGV4KGF1dGhvcml6YXRpb24ubm9uY2UpLAogICAgICAuLi50eXBlb2YgYXV0aG9yaXphdGlvbi55UGFyaXR5ICE9PSAidW5kZWZpbmVkIiA/IHsgeVBhcml0eTogbnVtYmVyVG9IZXgoYXV0aG9yaXphdGlvbi55UGFyaXR5KSB9IDoge30sCiAgICAgIC4uLnR5cGVvZiBhdXRob3JpemF0aW9uLnYgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiBhdXRob3JpemF0aW9uLnlQYXJpdHkgPT09ICJ1bmRlZmluZWQiID8geyB2OiBudW1iZXJUb0hleChhdXRob3JpemF0aW9uLnYpIH0gOiB7fQogICAgfSkpOwogIH0KICB2YXIgcnBjVHJhbnNhY3Rpb25UeXBlLCBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3Q7CiAgdmFyIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0ID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3RyYW5zYWN0aW9uUmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9mb3JtYXR0ZXIoKTsKICAgICAgcnBjVHJhbnNhY3Rpb25UeXBlID0gewogICAgICAgIGxlZ2FjeTogIjB4MCIsCiAgICAgICAgZWlwMjkzMDogIjB4MSIsCiAgICAgICAgZWlwMTU1OTogIjB4MiIsCiAgICAgICAgZWlwNDg0NDogIjB4MyIsCiAgICAgICAgZWlwNzcwMjogIjB4NCIKICAgICAgfTsKICAgICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUZvcm1hdHRlcigidHJhbnNhY3Rpb25SZXF1ZXN0IiwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0KTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMKICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU1hcHBpbmcoc3RhdGVNYXBwaW5nKSB7CiAgICBpZiAoIXN0YXRlTWFwcGluZyB8fCBzdGF0ZU1hcHBpbmcubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgcmV0dXJuIHN0YXRlTWFwcGluZy5yZWR1Y2UoKGFjYywgeyBzbG90LCB2YWx1ZSB9KSA9PiB7CiAgICAgIGlmIChzbG90Lmxlbmd0aCAhPT0gNjYpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRCeXRlc0xlbmd0aEVycm9yKHsKICAgICAgICAgIHNpemU6IHNsb3QubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBpZiAodmFsdWUubGVuZ3RoICE9PSA2NikKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEJ5dGVzTGVuZ3RoRXJyb3IoewogICAgICAgICAgc2l6ZTogdmFsdWUubGVuZ3RoLAogICAgICAgICAgdGFyZ2V0U2l6ZTogNjYsCiAgICAgICAgICB0eXBlOiAiaGV4IgogICAgICAgIH0pOwogICAgICBhY2Nbc2xvdF0gPSB2YWx1ZTsKICAgICAgcmV0dXJuIGFjYzsKICAgIH0sIHt9KTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudFN0YXRlT3ZlcnJpZGUocGFyYW1ldGVycykgewogICAgY29uc3QgeyBiYWxhbmNlLCBub25jZSwgc3RhdGUsIHN0YXRlRGlmZiwgY29kZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlID0ge307CiAgICBpZiAoY29kZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5jb2RlID0gY29kZTsKICAgIGlmIChiYWxhbmNlICE9PSB2b2lkIDApCiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLmJhbGFuY2UgPSBudW1iZXJUb0hleChiYWxhbmNlKTsKICAgIGlmIChub25jZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5ub25jZSA9IG51bWJlclRvSGV4KG5vbmNlKTsKICAgIGlmIChzdGF0ZSAhPT0gdm9pZCAwKQogICAgICBycGNBY2NvdW50U3RhdGVPdmVycmlkZS5zdGF0ZSA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZSk7CiAgICBpZiAoc3RhdGVEaWZmICE9PSB2b2lkIDApIHsKICAgICAgaWYgKHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlKQogICAgICAgIHRocm93IG5ldyBTdGF0ZUFzc2lnbm1lbnRDb25mbGljdEVycm9yKCk7CiAgICAgIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlLnN0YXRlRGlmZiA9IHNlcmlhbGl6ZVN0YXRlTWFwcGluZyhzdGF0ZURpZmYpOwogICAgfQogICAgcmV0dXJuIHJwY0FjY291bnRTdGF0ZU92ZXJyaWRlOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHBhcmFtZXRlcnMpIHsKICAgIGlmICghcGFyYW1ldGVycykKICAgICAgcmV0dXJuIHZvaWQgMDsKICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSB7fTsKICAgIGZvciAoY29uc3QgeyBhZGRyZXNzLCAuLi5hY2NvdW50U3RhdGUgfSBvZiBwYXJhbWV0ZXJzKSB7CiAgICAgIGlmICghaXNBZGRyZXNzKGFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIGlmIChycGNTdGF0ZU92ZXJyaWRlW2FkZHJlc3NdKQogICAgICAgIHRocm93IG5ldyBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yKHsgYWRkcmVzcyB9KTsKICAgICAgcnBjU3RhdGVPdmVycmlkZVthZGRyZXNzXSA9IHNlcmlhbGl6ZUFjY291bnRTdGF0ZU92ZXJyaWRlKGFjY291bnRTdGF0ZSk7CiAgICB9CiAgICByZXR1cm4gcnBjU3RhdGVPdmVycmlkZTsKICB9CiAgdmFyIGluaXRfc3RhdGVPdmVycmlkZTIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3N0YXRlT3ZlcnJpZGUuanMiKCkgewogICAgICBpbml0X2FkZHJlc3MoKTsKICAgICAgaW5pdF9kYXRhKCk7CiAgICAgIGluaXRfc3RhdGVPdmVycmlkZSgpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgICBpbml0X3RvSGV4KCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvbnVtYmVyLmpzCiAgdmFyIG1heEludDgsIG1heEludDE2LCBtYXhJbnQyNCwgbWF4SW50MzIsIG1heEludDQwLCBtYXhJbnQ0OCwgbWF4SW50NTYsIG1heEludDY0LCBtYXhJbnQ3MiwgbWF4SW50ODAsIG1heEludDg4LCBtYXhJbnQ5NiwgbWF4SW50MTA0LCBtYXhJbnQxMTIsIG1heEludDEyMCwgbWF4SW50MTI4LCBtYXhJbnQxMzYsIG1heEludDE0NCwgbWF4SW50MTUyLCBtYXhJbnQxNjAsIG1heEludDE2OCwgbWF4SW50MTc2LCBtYXhJbnQxODQsIG1heEludDE5MiwgbWF4SW50MjAwLCBtYXhJbnQyMDgsIG1heEludDIxNiwgbWF4SW50MjI0LCBtYXhJbnQyMzIsIG1heEludDI0MCwgbWF4SW50MjQ4LCBtYXhJbnQyNTYsIG1pbkludDgsIG1pbkludDE2LCBtaW5JbnQyNCwgbWluSW50MzIsIG1pbkludDQwLCBtaW5JbnQ0OCwgbWluSW50NTYsIG1pbkludDY0LCBtaW5JbnQ3MiwgbWluSW50ODAsIG1pbkludDg4LCBtaW5JbnQ5NiwgbWluSW50MTA0LCBtaW5JbnQxMTIsIG1pbkludDEyMCwgbWluSW50MTI4LCBtaW5JbnQxMzYsIG1pbkludDE0NCwgbWluSW50MTUyLCBtaW5JbnQxNjAsIG1pbkludDE2OCwgbWluSW50MTc2LCBtaW5JbnQxODQsIG1pbkludDE5MiwgbWluSW50MjAwLCBtaW5JbnQyMDgsIG1pbkludDIxNiwgbWluSW50MjI0LCBtaW5JbnQyMzIsIG1pbkludDI0MCwgbWluSW50MjQ4LCBtaW5JbnQyNTYsIG1heFVpbnQ4LCBtYXhVaW50MTYsIG1heFVpbnQyNCwgbWF4VWludDMyLCBtYXhVaW50NDAsIG1heFVpbnQ0OCwgbWF4VWludDU2LCBtYXhVaW50NjQsIG1heFVpbnQ3MiwgbWF4VWludDgwLCBtYXhVaW50ODgsIG1heFVpbnQ5NiwgbWF4VWludDEwNCwgbWF4VWludDExMiwgbWF4VWludDEyMCwgbWF4VWludDEyOCwgbWF4VWludDEzNiwgbWF4VWludDE0NCwgbWF4VWludDE1MiwgbWF4VWludDE2MCwgbWF4VWludDE2OCwgbWF4VWludDE3NiwgbWF4VWludDE4NCwgbWF4VWludDE5MiwgbWF4VWludDIwMCwgbWF4VWludDIwOCwgbWF4VWludDIxNiwgbWF4VWludDIyNCwgbWF4VWludDIzMiwgbWF4VWludDI0MCwgbWF4VWludDI0OCwgbWF4VWludDI1NjsKICB2YXIgaW5pdF9udW1iZXIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9udW1iZXIuanMiKCkgewogICAgICBtYXhJbnQ4ID0gMm4gKiogKDhuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDE2ID0gMm4gKiogKDE2biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQyNCA9IDJuICoqICgyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MzIgPSAybiAqKiAoMzJuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDQwID0gMm4gKiogKDQwbiAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ0OCA9IDJuICoqICg0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50NTYgPSAybiAqKiAoNTZuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDY0ID0gMm4gKiogKDY0biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ3MiA9IDJuICoqICg3Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50ODAgPSAybiAqKiAoODBuIC0gMW4pIC0gMW47CiAgICAgIG1heEludDg4ID0gMm4gKiogKDg4biAtIDFuKSAtIDFuOwogICAgICBtYXhJbnQ5NiA9IDJuICoqICg5Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTA0ID0gMm4gKiogKDEwNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTEyID0gMm4gKiogKDExMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTIwID0gMm4gKiogKDEyMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTI4ID0gMm4gKiogKDEyOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTM2ID0gMm4gKiogKDEzNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTQ0ID0gMm4gKiogKDE0NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTUyID0gMm4gKiogKDE1Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTYwID0gMm4gKiogKDE2MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTY4ID0gMm4gKiogKDE2OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTc2ID0gMm4gKiogKDE3Nm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTg0ID0gMm4gKiogKDE4NG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MTkyID0gMm4gKiogKDE5Mm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjAwID0gMm4gKiogKDIwMG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjA4ID0gMm4gKiogKDIwOG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjE2ID0gMm4gKiogKDIxNm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjI0ID0gMm4gKiogKDIyNG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjMyID0gMm4gKiogKDIzMm4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQwID0gMm4gKiogKDI0MG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjQ4ID0gMm4gKiogKDI0OG4gLSAxbikgLSAxbjsKICAgICAgbWF4SW50MjU2ID0gMm4gKiogKDI1Nm4gLSAxbikgLSAxbjsKICAgICAgbWluSW50OCA9IC0oMm4gKiogKDhuIC0gMW4pKTsKICAgICAgbWluSW50MTYgPSAtKDJuICoqICgxNm4gLSAxbikpOwogICAgICBtaW5JbnQyNCA9IC0oMm4gKiogKDI0biAtIDFuKSk7CiAgICAgIG1pbkludDMyID0gLSgybiAqKiAoMzJuIC0gMW4pKTsKICAgICAgbWluSW50NDAgPSAtKDJuICoqICg0MG4gLSAxbikpOwogICAgICBtaW5JbnQ0OCA9IC0oMm4gKiogKDQ4biAtIDFuKSk7CiAgICAgIG1pbkludDU2ID0gLSgybiAqKiAoNTZuIC0gMW4pKTsKICAgICAgbWluSW50NjQgPSAtKDJuICoqICg2NG4gLSAxbikpOwogICAgICBtaW5JbnQ3MiA9IC0oMm4gKiogKDcybiAtIDFuKSk7CiAgICAgIG1pbkludDgwID0gLSgybiAqKiAoODBuIC0gMW4pKTsKICAgICAgbWluSW50ODggPSAtKDJuICoqICg4OG4gLSAxbikpOwogICAgICBtaW5JbnQ5NiA9IC0oMm4gKiogKDk2biAtIDFuKSk7CiAgICAgIG1pbkludDEwNCA9IC0oMm4gKiogKDEwNG4gLSAxbikpOwogICAgICBtaW5JbnQxMTIgPSAtKDJuICoqICgxMTJuIC0gMW4pKTsKICAgICAgbWluSW50MTIwID0gLSgybiAqKiAoMTIwbiAtIDFuKSk7CiAgICAgIG1pbkludDEyOCA9IC0oMm4gKiogKDEyOG4gLSAxbikpOwogICAgICBtaW5JbnQxMzYgPSAtKDJuICoqICgxMzZuIC0gMW4pKTsKICAgICAgbWluSW50MTQ0ID0gLSgybiAqKiAoMTQ0biAtIDFuKSk7CiAgICAgIG1pbkludDE1MiA9IC0oMm4gKiogKDE1Mm4gLSAxbikpOwogICAgICBtaW5JbnQxNjAgPSAtKDJuICoqICgxNjBuIC0gMW4pKTsKICAgICAgbWluSW50MTY4ID0gLSgybiAqKiAoMTY4biAtIDFuKSk7CiAgICAgIG1pbkludDE3NiA9IC0oMm4gKiogKDE3Nm4gLSAxbikpOwogICAgICBtaW5JbnQxODQgPSAtKDJuICoqICgxODRuIC0gMW4pKTsKICAgICAgbWluSW50MTkyID0gLSgybiAqKiAoMTkybiAtIDFuKSk7CiAgICAgIG1pbkludDIwMCA9IC0oMm4gKiogKDIwMG4gLSAxbikpOwogICAgICBtaW5JbnQyMDggPSAtKDJuICoqICgyMDhuIC0gMW4pKTsKICAgICAgbWluSW50MjE2ID0gLSgybiAqKiAoMjE2biAtIDFuKSk7CiAgICAgIG1pbkludDIyNCA9IC0oMm4gKiogKDIyNG4gLSAxbikpOwogICAgICBtaW5JbnQyMzIgPSAtKDJuICoqICgyMzJuIC0gMW4pKTsKICAgICAgbWluSW50MjQwID0gLSgybiAqKiAoMjQwbiAtIDFuKSk7CiAgICAgIG1pbkludDI0OCA9IC0oMm4gKiogKDI0OG4gLSAxbikpOwogICAgICBtaW5JbnQyNTYgPSAtKDJuICoqICgyNTZuIC0gMW4pKTsKICAgICAgbWF4VWludDggPSAybiAqKiA4biAtIDFuOwogICAgICBtYXhVaW50MTYgPSAybiAqKiAxNm4gLSAxbjsKICAgICAgbWF4VWludDI0ID0gMm4gKiogMjRuIC0gMW47CiAgICAgIG1heFVpbnQzMiA9IDJuICoqIDMybiAtIDFuOwogICAgICBtYXhVaW50NDAgPSAybiAqKiA0MG4gLSAxbjsKICAgICAgbWF4VWludDQ4ID0gMm4gKiogNDhuIC0gMW47CiAgICAgIG1heFVpbnQ1NiA9IDJuICoqIDU2biAtIDFuOwogICAgICBtYXhVaW50NjQgPSAybiAqKiA2NG4gLSAxbjsKICAgICAgbWF4VWludDcyID0gMm4gKiogNzJuIC0gMW47CiAgICAgIG1heFVpbnQ4MCA9IDJuICoqIDgwbiAtIDFuOwogICAgICBtYXhVaW50ODggPSAybiAqKiA4OG4gLSAxbjsKICAgICAgbWF4VWludDk2ID0gMm4gKiogOTZuIC0gMW47CiAgICAgIG1heFVpbnQxMDQgPSAybiAqKiAxMDRuIC0gMW47CiAgICAgIG1heFVpbnQxMTIgPSAybiAqKiAxMTJuIC0gMW47CiAgICAgIG1heFVpbnQxMjAgPSAybiAqKiAxMjBuIC0gMW47CiAgICAgIG1heFVpbnQxMjggPSAybiAqKiAxMjhuIC0gMW47CiAgICAgIG1heFVpbnQxMzYgPSAybiAqKiAxMzZuIC0gMW47CiAgICAgIG1heFVpbnQxNDQgPSAybiAqKiAxNDRuIC0gMW47CiAgICAgIG1heFVpbnQxNTIgPSAybiAqKiAxNTJuIC0gMW47CiAgICAgIG1heFVpbnQxNjAgPSAybiAqKiAxNjBuIC0gMW47CiAgICAgIG1heFVpbnQxNjggPSAybiAqKiAxNjhuIC0gMW47CiAgICAgIG1heFVpbnQxNzYgPSAybiAqKiAxNzZuIC0gMW47CiAgICAgIG1heFVpbnQxODQgPSAybiAqKiAxODRuIC0gMW47CiAgICAgIG1heFVpbnQxOTIgPSAybiAqKiAxOTJuIC0gMW47CiAgICAgIG1heFVpbnQyMDAgPSAybiAqKiAyMDBuIC0gMW47CiAgICAgIG1heFVpbnQyMDggPSAybiAqKiAyMDhuIC0gMW47CiAgICAgIG1heFVpbnQyMTYgPSAybiAqKiAyMTZuIC0gMW47CiAgICAgIG1heFVpbnQyMjQgPSAybiAqKiAyMjRuIC0gMW47CiAgICAgIG1heFVpbnQyMzIgPSAybiAqKiAyMzJuIC0gMW47CiAgICAgIG1heFVpbnQyNDAgPSAybiAqKiAyNDBuIC0gMW47CiAgICAgIG1heFVpbnQyNDggPSAybiAqKiAyNDhuIC0gMW47CiAgICAgIG1heFVpbnQyNTYgPSAybiAqKiAyNTZuIC0gMW47CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRSZXF1ZXN0LmpzCiAgZnVuY3Rpb24gYXNzZXJ0UmVxdWVzdChhcmdzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfLCBnYXNQcmljZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgdG8gfSA9IGFyZ3M7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogdm9pZCAwOwogICAgaWYgKGFjY291bnQgJiYgIWlzQWRkcmVzcyhhY2NvdW50LmFkZHJlc3MpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcyB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmICh0eXBlb2YgZ2FzUHJpY2UgIT09ICJ1bmRlZmluZWQiICYmICh0eXBlb2YgbWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiKSkKICAgICAgdGhyb3cgbmV3IEZlZUNvbmZsaWN0RXJyb3IoKTsKICAgIGlmIChtYXhGZWVQZXJHYXMgJiYgbWF4RmVlUGVyR2FzID4gbWF4VWludDI1NikKICAgICAgdGhyb3cgbmV3IEZlZUNhcFRvb0hpZ2hFcnJvcih7IG1heEZlZVBlckdhcyB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPiBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBUaXBBYm92ZUZlZUNhcEVycm9yKHsgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcyB9KTsKICB9CiAgdmFyIGluaXRfYXNzZXJ0UmVxdWVzdCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vYXNzZXJ0UmVxdWVzdC5qcyIoKSB7CiAgICAgIGluaXRfcGFyc2VBY2NvdW50KCk7CiAgICAgIGluaXRfbnVtYmVyKCk7CiAgICAgIGluaXRfYWRkcmVzcygpOwogICAgICBpbml0X25vZGUoKTsKICAgICAgaW5pdF90cmFuc2FjdGlvbigpOwogICAgICBpbml0X2lzQWRkcmVzcygpOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9pc0FkZHJlc3NFcXVhbC5qcwogIGZ1bmN0aW9uIGlzQWRkcmVzc0VxdWFsKGEsIGIpIHsKICAgIGlmICghaXNBZGRyZXNzKGEsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBhIH0pOwogICAgaWYgKCFpc0FkZHJlc3MoYiwgeyBzdHJpY3Q6IGZhbHNlIH0pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IGIgfSk7CiAgICByZXR1cm4gYS50b0xvd2VyQ2FzZSgpID09PSBiLnRvTG93ZXJDYXNlKCk7CiAgfQogIHZhciBpbml0X2lzQWRkcmVzc0VxdWFsID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2lzQWRkcmVzc0VxdWFsLmpzIigpIHsKICAgICAgaW5pdF9hZGRyZXNzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZGVjb2RlRnVuY3Rpb25SZXN1bHQuanMKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgZnVuY3Rpb25OYW1lLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGZ1bmN0aW9uTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZnVuY3Rpb25OYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uTm90Rm91bmRFcnJvcihmdW5jdGlvbk5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNCB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZnVuY3Rpb24iKQogICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgaWYgKCFhYmlJdGVtLm91dHB1dHMpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yKGFiaUl0ZW0ubmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg0IH0pOwogICAgY29uc3QgdmFsdWVzID0gZGVjb2RlQWJpUGFyYW1ldGVycyhhYmlJdGVtLm91dHB1dHMsIGRhdGEpOwogICAgaWYgKHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoID4gMSkKICAgICAgcmV0dXJuIHZhbHVlczsKICAgIGlmICh2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA9PT0gMSkKICAgICAgcmV0dXJuIHZhbHVlc1swXTsKICAgIHJldHVybiB2b2lkIDA7CiAgfQogIHZhciBkb2NzUGF0aDQ7CiAgdmFyIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvblJlc3VsdC5qcyIoKSB7CiAgICAgIGluaXRfYWJpKCk7CiAgICAgIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogICAgICBpbml0X2dldEFiaUl0ZW0oKTsKICAgICAgZG9jc1BhdGg0ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZUZ1bmN0aW9uUmVzdWx0IjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9hYmlzLmpzCiAgdmFyIG11bHRpY2FsbDNBYmksIHVuaXZlcnNhbFJlc29sdmVyRXJyb3JzLCB1bml2ZXJzYWxSZXNvbHZlclJlc29sdmVBYmksIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSwgdGV4dFJlc29sdmVyQWJpLCBhZGRyZXNzUmVzb2x2ZXJBYmksIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwgZXJjMjBBYmksIGVyYzIwQWJpX2J5dGVzMzIsIGVyYzcyMUFiaSwgZXJjNDYyNkFiaTsKICB2YXIgaW5pdF9hYmlzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWJpcy5qcyIoKSB7CiAgICAgIG11bHRpY2FsbDNBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJ0YXJnZXQiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJhbGxvd0ZhaWx1cmUiLAogICAgICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJjYWxsRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJjYWxscyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiYWdncmVnYXRlMyIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIG5hbWU6ICJyZXR1cm5EYXRhIiwKICAgICAgICAgICAgICB0eXBlOiAidHVwbGVbXSIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJFcnJvcnMgPSBbCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG5hbWU6ICJSZXNvbHZlck5vdEZvdW5kIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBuYW1lOiAiUmVzb2x2ZXJXaWxkY2FyZE5vdFN1cHBvcnRlZCIsCiAgICAgICAgICB0eXBlOiAiZXJyb3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyTm90Q29udHJhY3QiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmV0dXJuRGF0YSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIlJlc29sdmVyRXJyb3IiLAogICAgICAgICAgdHlwZTogImVycm9yIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb21wb25lbnRzOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJzdGF0dXMiLAogICAgICAgICAgICAgICAgICB0eXBlOiAidWludDE2IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbmFtZTogIm1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgbmFtZTogImVycm9ycyIsCiAgICAgICAgICAgICAgdHlwZTogInR1cGxlW10iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiSHR0cEVycm9yIiwKICAgICAgICAgIHR5cGU6ICJlcnJvciIKICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmVzb2x2ZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlcyIgfSwKICAgICAgICAgICAgeyBuYW1lOiAiZGF0YSIsIHR5cGU6ICJieXRlcyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJyZXNvbHZlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7IG5hbWU6ICJuYW1lIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJkYXRhIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJnYXRld2F5cyIsIHR5cGU6ICJzdHJpbmdbXSIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAiIiwgdHlwZTogImJ5dGVzIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJhZGRyZXNzIiwgdHlwZTogImFkZHJlc3MiIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFJlc29sdmVyUmV2ZXJzZUFiaSA9IFsKICAgICAgICAuLi51bml2ZXJzYWxSZXNvbHZlckVycm9ycywKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAicmV2ZXJzZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIsIG5hbWU6ICJyZXZlcnNlTmFtZSIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogInN0cmluZyIsIG5hbWU6ICJyZXNvbHZlZE5hbWUiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmVzb2x2ZWRBZGRyZXNzIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJldmVyc2VSZXNvbHZlciIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlciIgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogInJldmVyc2UiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgdHlwZTogImJ5dGVzIiwgbmFtZTogInJldmVyc2VOYW1lIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJzdHJpbmdbXSIsIG5hbWU6ICJnYXRld2F5cyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgeyB0eXBlOiAic3RyaW5nIiwgbmFtZTogInJlc29sdmVkTmFtZSIgfSwKICAgICAgICAgICAgeyB0eXBlOiAiYWRkcmVzcyIsIG5hbWU6ICJyZXNvbHZlZEFkZHJlc3MiIH0sCiAgICAgICAgICAgIHsgdHlwZTogImFkZHJlc3MiLCBuYW1lOiAicmV2ZXJzZVJlc29sdmVyIiB9LAogICAgICAgICAgICB7IHR5cGU6ICJhZGRyZXNzIiwgbmFtZTogInJlc29sdmVyIiB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICB0ZXh0UmVzb2x2ZXJBYmkgPSBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInRleHQiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICAgICAgeyBuYW1lOiAia2V5IiwgdHlwZTogInN0cmluZyIgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgIH0KICAgICAgXTsKICAgICAgYWRkcmVzc1Jlc29sdmVyQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJhZGRyIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIm5hbWUiLCB0eXBlOiAiYnl0ZXMzMiIgfV0sCiAgICAgICAgICBvdXRwdXRzOiBbeyBuYW1lOiAiIiwgdHlwZTogImFkZHJlc3MiIH1dCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAiYWRkciIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgICAgICB7IG5hbWU6ICJjb2luVHlwZSIsIHR5cGU6ICJ1aW50MjU2IiB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJieXRlcyIgfV0KICAgICAgICB9CiAgICAgIF07CiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiY29uc3RydWN0b3IiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfc2lnbmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJfaGFzaCIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzMzIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiX3NpZ25hdHVyZSIsCiAgICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiaXNWYWxpZFNpZyIKICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzIwQWJpID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic3ltYm9sIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXIiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICBdOwogICAgICBlcmMyMEFiaV9ieXRlczMyID0gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYWxsb3dhbmNlIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiYXBwcm92ZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJiYWxhbmNlT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhY2NvdW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImRlY2ltYWxzIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50OCIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJuYW1lIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgaW5wdXRzOiBbXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJieXRlczMyIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYnl0ZXMzMiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0b3RhbFN1cHBseSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2lwaWVudCIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAicmVjaXBpZW50IiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhbW91bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF07CiAgICAgIGVyYzcyMUFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZXZlbnQiLAogICAgICAgICAgbmFtZTogIkFwcHJvdmFsIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdHlwZTogImV2ZW50IiwKICAgICAgICAgIG5hbWU6ICJBcHByb3ZhbEZvckFsbCIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm9wZXJhdG9yIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhcHByb3ZlZCIsCiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRva2VuSWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImFwcHJvdmUiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAicGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAiZ2V0QXBwcm92ZWQiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogImlzQXBwcm92ZWRGb3JBbGwiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogImJvb2wiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAibmFtZSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogIm93bmVyT2YiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAic2FmZVRyYW5zZmVyRnJvbSIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJwYXlhYmxlIiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImZyb20iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNhZmVUcmFuc2ZlckZyb20iLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiaWQiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImRhdGEiLAogICAgICAgICAgICAgIHR5cGU6ICJieXRlcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInNldEFwcHJvdmFsRm9yQWxsIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3BlcmF0b3IiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFwcHJvdmVkIiwKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFtdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInN5bWJvbCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogW10sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAic3RyaW5nIgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImluZGV4IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iLAogICAgICAgICAgbmFtZTogInRva2VuQnlJbmRleCIsCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJpbmRleCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG9rZW5JZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG9rZW5VUkkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b2tlbklkIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJzdHJpbmciCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidG90YWxTdXBwbHkiLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIsCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInBheWFibGUiLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJyZWNpcGllbnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInRva2VJZCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBvdXRwdXRzOiBbXQogICAgICAgIH0KICAgICAgXTsKICAgICAgZXJjNDYyNkFiaSA9IFsKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJzcGVuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiQXBwcm92YWwiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiRGVwb3NpdCIsCiAgICAgICAgICB0eXBlOiAiZXZlbnQiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLAogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpbmRleGVkOiB0cnVlLAogICAgICAgICAgICAgIG5hbWU6ICJmcm9tIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInRvIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJ2YWx1ZSIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiVHJhbnNmZXIiLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgYW5vbnltb3VzOiBmYWxzZSwKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogdHJ1ZSwKICAgICAgICAgICAgICBuYW1lOiAic2VuZGVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IHRydWUsCiAgICAgICAgICAgICAgbmFtZTogIm93bmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGluZGV4ZWQ6IGZhbHNlLAogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaW5kZXhlZDogZmFsc2UsCiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiV2l0aGRyYXciLAogICAgICAgICAgdHlwZTogImV2ZW50IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNwZW5kZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImFsbG93YW5jZSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic3BlbmRlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJhcHByb3ZlIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogImFzc2V0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldFRva2VuQWRkcmVzcyIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFjY291bnQiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogImJhbGFuY2VPZiIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAic2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJjb252ZXJ0VG9Bc3NldHMiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAiY29udmVydFRvU2hhcmVzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJkZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJjYWxsZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heERlcG9zaXQiLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogIm1heEFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImNhbGxlciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAibWF4TWludCIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFJlZGVlbSIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAibWF4U2hhcmVzIiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAib3duZXIiLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogIm1heFdpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJtYXhBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJtaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdEZXBvc2l0IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdNaW50IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgbmFtZTogInByZXZpZXdSZWRlZW0iLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJ2aWV3IiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlucHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFzc2V0cyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicHJldmlld1dpdGhkcmF3IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJzaGFyZXMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAicmVkZWVtIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsQXNzZXRzIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0b3RhbE1hbmFnZWRBc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFtdLAogICAgICAgICAgbmFtZTogInRvdGFsU3VwcGx5IiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJ0byIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiYW1vdW50IiwKICAgICAgICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIG5hbWU6ICJ0cmFuc2ZlciIsCiAgICAgICAgICBvdXRwdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAiYm9vbCIKICAgICAgICAgICAgfQogICAgICAgICAgXSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogIm5vbnBheWFibGUiLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgaW5wdXRzOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAiZnJvbSIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAidG8iLAogICAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogImFtb3VudCIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAidHJhbnNmZXJGcm9tIiwKICAgICAgICAgIG91dHB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICJib29sIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAibm9ucGF5YWJsZSIsCiAgICAgICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJhc3NldHMiLAogICAgICAgICAgICAgIHR5cGU6ICJ1aW50MjU2IgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInJlY2VpdmVyIiwKICAgICAgICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIG5hbWU6ICJvd25lciIsCiAgICAgICAgICAgICAgdHlwZTogImFkZHJlc3MiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBuYW1lOiAid2l0aGRyYXciLAogICAgICAgICAgb3V0cHV0czogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogInNoYXJlcyIsCiAgICAgICAgICAgICAgdHlwZTogInVpbnQyNTYiCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBzdGF0ZU11dGFiaWxpdHk6ICJub25wYXlhYmxlIiwKICAgICAgICAgIHR5cGU6ICJmdW5jdGlvbiIKICAgICAgICB9CiAgICAgIF07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3QuanMKICB2YXIgYWdncmVnYXRlM1NpZ25hdHVyZTsKICB2YXIgaW5pdF9jb250cmFjdDIgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NvbnN0YW50cy9jb250cmFjdC5qcyIoKSB7CiAgICAgIGFnZ3JlZ2F0ZTNTaWduYXR1cmUgPSAiMHg4MmFkNTZjYiI7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvY29udHJhY3RzLmpzCiAgdmFyIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwgZGVwbG95bGVzc0NhbGxWaWFGYWN0b3J5Qnl0ZWNvZGUsIHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckJ5dGVDb2RlOwogIHZhciBpbml0X2NvbnRyYWN0cyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2NvbnRyYWN0cy5qcyIoKSB7CiAgICAgIGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDE4ZTM4MDM4MDYxMDE4ZTgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMTI0NTY1YjYwMDA4MDgzNTE2MDIwODUwMTYwMDBmNTkwNTA4MDNiNjEwMDQ4NTc2MDAwODBmZDViNjAwMDgwODM1MTYwMjA4NTAxNjAwMDg1NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDA2NzU3M2Q4MWZkNWIzZDgxZjM1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDgyNjAxZjgzMDExMjYxMDA5MjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMGFiNTc2MTAwYWI2MTAwNmI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTAwZDk1NzYxMDBkOTYxMDA2YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTAwZjE1NzYwMDA4MGZkNWI2MDAwNWI4MjgxMTAxNTYxMDExMDU3NjAyMDgxODYwMTgxMDE1MTgzODMwMTgyMDE1MjAxNjEwMGY0NTY1YjUwNjAwMDkxODEwMTYwMjAwMTkxOTA5MTUyOTM5MjUwNTA1MDU2NWI2MDAwODA2MDQwODM4NTAzMTIxNTYxMDEzNzU3NjAwMDgwZmQ1YjgyNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTRkNTc2MDAwODBmZDViNjEwMTU5ODU4Mjg2MDE2MTAwODE1NjViNjAyMDg1MDE1MTkwOTM1MDkwNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMTc3NTc2MDAwODBmZDViNjEwMTgzODU4Mjg2MDE2MTAwODE1NjViOTE1MDUwOTI1MDkyOTA1MDU2ZmUiOwogICAgICBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDJjMDM4MDM4MDYxMDJjMDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwMWU2NTY1YjgzNjAwMTYwMDE2MGEwMWIwMzE2M2I2MDAwMDM2MTAwZTQ1NzYwMDA4MDgzNjAwMTYwMDE2MGEwMWIwMzE2ODM2MDQwNTE2MTAwNWM5MTkwNjEwMjcwNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwOTk1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwOWU1NjViNjA2MDkxNTA1YjUwOTE1MDkxNTA4MTE1ODA2MTAwYjg1NzUwNjAwMTYwMDE2MGEwMWIwMzg2MTYzYjE1NWIxNTYxMDBlMTU3ODA2MDQwNTE2MzEwMWJiOThkNjBlMDFiODE1MjYwMDQwMTYxMDBkODkxOTA2MTAyOGM1NjViNjA0MDUxODA5MTAzOTBmZDViNTA1MDViNjAwMDgwODQ1MTYwMjA4NjAxNjAwMDg4NWFmMTYwNDA1MTNkNjAwMDgyM2U4MTYxMDEwMzU3M2Q4MWZkNWIzZDgxZjM1YjgwNTE2MDAxNjAwMTYwYTAxYjAzODExNjgxMTQ2MTAxMWU1NzYwMDA4MGZkNWI5MTkwNTA1NjViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwNDE2MDA0NTI2MDI0NjAwMGZkNWI2MDAwNWI4MzgxMTAxNTYxMDE1NDU3ODE4MTAxNTE4MzgyMDE1MjYwMjAwMTYxMDEzYzU2NWI1MDUwNjAwMDkxMDE1MjU2NWI2MDAwODI2MDFmODMwMTEyNjEwMTZlNTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTAxODc1NzYxMDE4NzYxMDEyMzU2NWI2MDQwNTE2MDFmODIwMTYwMWYxOTkwODExNjYwM2YwMTE2ODEwMTYwMDE2MDAxNjA0MDFiMDM4MTExODI4MjEwMTcxNTYxMDFiNTU3NjEwMWI1NjEwMTIzNTY1YjYwNDA1MjgxODE1MjgzODIwMTYwMjAwMTg1MTAxNTYxMDFjZDU3NjAwMDgwZmQ1YjYxMDFkZTgyNjAyMDgzMDE2MDIwODcwMTYxMDEzOTU2NWI5NDkzNTA1MDUwNTA1NjViNjAwMDgwNjAwMDgwNjA4MDg1ODcwMzEyMTU2MTAxZmM1NzYwMDA4MGZkNWI2MTAyMDU4NTYxMDEwNzU2NWI2MDIwODYwMTUxOTA5NDUwNjAwMTYwMDE2MDQwMWIwMzgxMTExNTYxMDIyMTU3NjAwMDgwZmQ1YjYxMDIyZDg3ODI4ODAxNjEwMTVkNTY1YjkzNTA1MDYxMDIzYzYwNDA4NjAxNjEwMTA3NTY1YjYwNjA4NjAxNTE5MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwMjU4NTc2MDAwODBmZDViNjEwMjY0ODc4Mjg4MDE2MTAxNWQ1NjViOTE1MDUwOTI5NTkxOTQ1MDkyNTA1NjViNjAwMDgyNTE2MTAyODI4MTg0NjAyMDg3MDE2MTAxMzk1NjViOTE5MDkxMDE5MjkxNTA1MDU2NWI2MDIwODE1MjYwMDA4MjUxODA2MDIwODQwMTUyNjEwMmFiODE2MDQwODUwMTYwMjA4NzAxNjEwMTM5NTY1YjYwMWYwMTYwMWYxOTE2OTE5MDkxMDE2MDQwMDE5MjkxNTA1MDU2ZmUiOwogICAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZSA9ICIweDYwODA2MDQwNTIzNDgwMTU2MTAwMTA1NzYwMDA4MGZkNWI1MDYwNDA1MTYxMDY5NDM4MDM4MDYxMDY5NDgzMzk4MTAxNjA0MDgxOTA1MjYxMDAyZjkxNjEwNTFlNTY1YjYwMDA2MTAwM2M4NDg0ODQ2MTAwNDg1NjViOTA1MDgwNjAwMDUyNjAwMTYwMWZmMzViNjAwMDdmNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjYxMDA3NDgzNjEwNDBjNTY1YjAzNjEwMWU3NTc2MDAwNjA2MDgwODQ4MDYwMjAwMTkwNTE4MTAxOTA2MTAwOTI5MTkwNjEwNTc3NTY1YjYwNDA1MTkyOTU1MDkwOTM1MDkxNTA2MDAwOTA2MDAxNjAwMTYwYTAxYjAzODUxNjkwNjEwMGI2OTA4NTkwNjEwNWRkNTY1YjYwMDA2MDQwNTE4MDgzMDM4MTYwMDA4NjVhZjE5MTUwNTAzZDgwNjAwMDgxMTQ2MTAwZjM1NzYwNDA1MTkxNTA2MDFmMTk2MDNmM2QwMTE2ODIwMTYwNDA1MjNkODI1MjNkNjAwMDYwMjA4NDAxM2U2MTAwZjg1NjViNjA2MDkxNTA1YjUwNTA5MDUwODc2MDAxNjAwMTYwYTAxYjAzMTYzYjYwMDAwMzYxMDE2MDU3ODA2MTAxNjA1NzYwNDA1MTYyNDYxYmNkNjBlNTFiODE1MjYwMjA2MDA0ODIwMTUyNjAxZTYwMjQ4MjAxNTI3ZjUzNjk2NzZlNjE3NDc1NzI2NTU2NjE2YzY5NjQ2MTc0NmY3MjNhMjA2NDY1NzA2YzZmNzk2ZDY1NmU3NDAwMDA2MDQ0ODIwMTUyNjA2NDAxNWI2MDQwNTE4MDkxMDM5MGZkNWI2MDQwNTE2MzBiMTM1ZDNmNjBlMTFiODA4MjUyOTA2MDAxNjAwMTYwYTAxYjAzOGExNjkwNjMxNjI2YmE3ZTkwNjEwMTkwOTA4YjkwODc5MDYwMDQwMTYxMDVmOTU2NWI2MDIwNjA0MDUxODA4MzAzODE4NjVhZmExNTgwMTU2MTAxYWQ1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNTA2MDQwNTEzZDYwMWYxOTYwMWY4MjAxMTY4MjAxODA2MDQwNTI1MDgxMDE5MDYxMDFkMTkxOTA2MTA2MzM1NjViNjAwMTYwMDE2MGUwMWIwMzE5MTYxNDk0NTA1MDUwNTA1MDYxMDQwNTU2NWI2MDAxNjAwMTYwYTAxYjAzODQxNjNiMTU2MTAyN2E1NzYwNDA1MTYzMGIxMzVkM2Y2MGUxMWI4MDgyNTI5MDYwMDE2MDAxNjBhMDFiMDM4NjE2OTA2MzE2MjZiYTdlOTA2MTAyMjc5MDg3OTA4NzkwNjAwNDAxNjEwNWY5NTY1YjYwMjA2MDQwNTE4MDgzMDM4MTg2NWFmYTE1ODAxNTYxMDI0NDU3M2Q2MDAwODAzZTNkNjAwMGZkNWI1MDUwNTA1MDYwNDA1MTNkNjAxZjE5NjAxZjgyMDExNjgyMDE4MDYwNDA1MjUwODEwMTkwNjEwMjY4OTE5MDYxMDYzMzU2NWI2MDAxNjAwMTYwZTAxYjAzMTkxNjE0OTA1MDYxMDQwNTU2NWI4MTUxNjA0MTE0NjEwMmRmNTc2MDQwNTE2MjQ2MWJjZDYwZTUxYjgxNTI2MDIwNjAwNDgyMDE1MjYwM2E2MDI0ODIwMTUyNjAwMDgwNTE2MDIwNjEwNjc0ODMzOTgxNTE5MTUyNjA0NDgyMDE1MjdmM2EyMDY5NmU3NjYxNmM2OTY0MjA3MzY5Njc2ZTYxNzQ3NTcyNjUyMDZjNjU2ZTY3NzQ2ODAwMDAwMDAwMDAwMDYwNjQ4MjAxNTI2MDg0MDE2MTAxNTc1NjViNjEwMmU3NjEwNDI1NTY1YjUwNjAyMDgyMDE1MTYwNDA4MDg0MDE1MTg0NTE4NTkzOTI2MDAwOTE4NTkxOTA4MTEwNjEwMzBjNTc2MTAzMGM2MTA2NWQ1NjViMDE2MDIwMDE1MTYwZjgxYzkwNTA2MDFiODExNDgwMTU5MDYxMDMyYjU3NTA4MDYwZmYxNjYwMWMxNDE1NWIxNTYxMDM4YzU3NjA0MDUxNjI0NjFiY2Q2MGU1MWI4MTUyNjAyMDYwMDQ4MjAxNTI2MDNiNjAyNDgyMDE1MjYwMDA4MDUxNjAyMDYxMDY3NDgzMzk4MTUxOTE1MjYwNDQ4MjAxNTI3ZjNhMjA2OTZlNzY2MTZjNjk2NDIwNzM2OTY3NmU2MTc0NzU3MjY1MjA3NjIwNzY2MTZjNzU2NTAwMDAwMDAwMDA2MDY0ODIwMTUyNjA4NDAxNjEwMTU3NTY1YjYwNDA4MDUxNjAwMDgxNTI2MDIwODEwMTgwODM1Mjg5OTA1MjYwZmY4MzE2OTE4MTAxOTE5MDkxNTI2MDYwODEwMTg0OTA1MjYwODA4MTAxODM5MDUyNjAwMTYwMDE2MGEwMWIwMzg5MTY5MDYwMDE5MDYwYTAwMTYwMjA2MDQwNTE2MDIwODEwMzkwODA4NDAzOTA4NTVhZmExNTgwMTU2MTAzZWE1NzNkNjAwMDgwM2UzZDYwMDBmZDViNTA1MDUwNjAyMDYwNDA1MTAzNTE2MDAxNjAwMTYwYTAxYjAzMTYxNDk0NTA1MDUwNTA1MDViOTM5MjUwNTA1MDU2NWI2MDAwNjAyMDgyNTExMDE1NjEwNDFkNTc2MDAwODBmZDViNTA4MDUxMDE1MTkwNTY1YjYwNDA1MTgwNjA2MDAxNjA0MDUyODA2MDAzOTA2MDIwODIwMjgwMzY4MzM3NTA5MTkyOTE1MDUwNTY1YjYwMDE2MDAxNjBhMDFiMDM4MTE2ODExNDYxMDQ1ODU3NjAwMDgwZmQ1YjUwNTY1YjYzNGU0ODdiNzE2MGUwMWI2MDAwNTI2MDQxNjAwNDUyNjAyNDYwMDBmZDViNjAwMDViODM4MTEwMTU2MTA0OGM1NzgxODEwMTUxODM4MjAxNTI2MDIwMDE2MTA0NzQ1NjViNTA1MDYwMDA5MTAxNTI1NjViNjAwMDgyNjAxZjgzMDExMjYxMDRhNjU3NjAwMDgwZmQ1YjgxNTE2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNGJmNTc2MTA0YmY2MTA0NWI1NjViNjA0MDUxNjAxZjgyMDE2MDFmMTk5MDgxMTY2MDNmMDExNjgxMDE2MDAxNjAwMTYwNDAxYjAzODExMTgyODIxMDE3MTU2MTA0ZWQ1NzYxMDRlZDYxMDQ1YjU2NWI2MDQwNTI4MTgxNTI4MzgyMDE2MDIwMDE4NTEwMTU2MTA1MDU1NzYwMDA4MGZkNWI2MTA1MTY4MjYwMjA4MzAxNjAyMDg3MDE2MTA0NzE1NjViOTQ5MzUwNTA1MDUwNTY1YjYwMDA4MDYwMDA2MDYwODQ4NjAzMTIxNTYxMDUzMzU3NjAwMDgwZmQ1YjgzNTE2MTA1M2U4MTYxMDQ0MzU2NWI2MDIwODUwMTUxNjA0MDg2MDE1MTkxOTQ1MDkyNTA2MDAxNjAwMTYwNDAxYjAzODExMTE1NjEwNTYxNTc2MDAwODBmZDViNjEwNTZkODY4Mjg3MDE2MTA0OTU1NjViOTE1MDUwOTI1MDkyNTA5MjU2NWI2MDAwODA2MDAwNjA2MDg0ODYwMzEyMTU2MTA1OGM1NzYwMDA4MGZkNWI4MzUxNjEwNTk3ODE2MTA0NDM1NjViNjAyMDg1MDE1MTkwOTM1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1YjM1NzYwMDA4MGZkNWI2MTA1YmY4NjgyODcwMTYxMDQ5NTU2NWI2MDQwODYwMTUxOTA5MzUwOTA1MDYwMDE2MDAxNjA0MDFiMDM4MTExMTU2MTA1NjE1NzYwMDA4MGZkNWI2MDAwODI1MTYxMDVlZjgxODQ2MDIwODcwMTYxMDQ3MTU2NWI5MTkwOTEwMTkyOTE1MDUwNTY1YjgyODE1MjYwNDA2MDIwODIwMTUyNjAwMDgyNTE4MDYwNDA4NDAxNTI2MTA2MWU4MTYwNjA4NTAxNjAyMDg3MDE2MTA0NzE1NjViNjAxZjAxNjAxZjE5MTY5MTkwOTEwMTYwNjAwMTkzOTI1MDUwNTA1NjViNjAwMDYwMjA4Mjg0MDMxMjE1NjEwNjQ1NTc2MDAwODBmZDViODE1MTYwMDE2MDAxNjBlMDFiMDMxOTgxMTY4MTE0NjEwNDA1NTc2MDAwODBmZDViNjM0ZTQ4N2I3MTYwZTAxYjYwMDA1MjYwMzI2MDA0NTI2MDI0NjAwMGZkZmU1MzY5Njc2ZTYxNzQ3NTcyNjU1NjYxNmM2OTY0NjE3NDZmNzIyMzcyNjU2MzZmNzY2NTcyNTM2OTY3NmU2NTcyIjsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jaGFpbi5qcwogIHZhciBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QsIENoYWluTWlzbWF0Y2hFcnJvciwgQ2hhaW5Ob3RGb3VuZEVycm9yLCBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvciwgSW52YWxpZENoYWluSWRFcnJvcjsKICB2YXIgaW5pdF9jaGFpbiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2NoYWluLmpzIigpIHsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBibG9ja051bWJlciwgY2hhaW4sIGNvbnRyYWN0IH0pIHsKICAgICAgICAgIHN1cGVyKGBDaGFpbiAiJHtjaGFpbi5uYW1lfSIgZG9lcyBub3Qgc3VwcG9ydCBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIuYCwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAiVGhpcyBjb3VsZCBiZSBkdWUgdG8gYW55IG9mIHRoZSBmb2xsb3dpbmc6IiwKICAgICAgICAgICAgICAuLi5ibG9ja051bWJlciAmJiBjb250cmFjdC5ibG9ja0NyZWF0ZWQgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkID4gYmxvY2tOdW1iZXIgPyBbCiAgICAgICAgICAgICAgICBgLSBUaGUgY29udHJhY3QgIiR7Y29udHJhY3QubmFtZX0iIHdhcyBub3QgZGVwbG95ZWQgdW50aWwgYmxvY2sgJHtjb250cmFjdC5ibG9ja0NyZWF0ZWR9IChjdXJyZW50IGJsb2NrICR7YmxvY2tOdW1iZXJ9KS5gCiAgICAgICAgICAgICAgXSA6IFsKICAgICAgICAgICAgICAgIGAtIFRoZSBjaGFpbiBkb2VzIG5vdCBoYXZlIHRoZSBjb250cmFjdCAiJHtjb250cmFjdC5uYW1lfSIgY29uZmlndXJlZC5gCiAgICAgICAgICAgICAgXQogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0IgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBDaGFpbk1pc21hdGNoRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2hhaW4sIGN1cnJlbnRDaGFpbklkIH0pIHsKICAgICAgICAgIHN1cGVyKGBUaGUgY3VycmVudCBjaGFpbiBvZiB0aGUgd2FsbGV0IChpZDogJHtjdXJyZW50Q2hhaW5JZH0pIGRvZXMgbm90IG1hdGNoIHRoZSB0YXJnZXQgY2hhaW4gZm9yIHRoZSB0cmFuc2FjdGlvbiAoaWQ6ICR7Y2hhaW4uaWR9IFx1MjAxMyAke2NoYWluLm5hbWV9KS5gLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBDdXJyZW50IENoYWluIElEOiAgJHtjdXJyZW50Q2hhaW5JZH1gLAogICAgICAgICAgICAgIGBFeHBlY3RlZCBDaGFpbiBJRDogJHtjaGFpbi5pZH0gXHUyMDEzICR7Y2hhaW4ubmFtZX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJDaGFpbk1pc21hdGNoRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIENoYWluTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICBzdXBlcihbCiAgICAgICAgICAgICJObyBjaGFpbiB3YXMgcHJvdmlkZWQgdG8gdGhlIHJlcXVlc3QuIiwKICAgICAgICAgICAgIlBsZWFzZSBwcm92aWRlIGEgY2hhaW4gd2l0aCB0aGUgYGNoYWluYCBhcmd1bWVudCBvbiB0aGUgQWN0aW9uLCBvciBieSBzdXBwbHlpbmcgYSBgY2hhaW5gIHRvIFdhbGxldENsaWVudC4iCiAgICAgICAgICBdLmpvaW4oIlxuIiksIHsKICAgICAgICAgICAgbmFtZTogIkNoYWluTm90Rm91bmRFcnJvciIKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoIk5vIGNoYWluIHdhcyBwcm92aWRlZCB0byB0aGUgQ2xpZW50LiIsIHsKICAgICAgICAgICAgbmFtZTogIkNsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBJbnZhbGlkQ2hhaW5JZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgICAgICBjb25zdHJ1Y3Rvcih7IGNoYWluSWQgfSkgewogICAgICAgICAgc3VwZXIodHlwZW9mIGNoYWluSWQgPT09ICJudW1iZXIiID8gYENoYWluIElEICIke2NoYWluSWR9IiBpcyBpbnZhbGlkLmAgOiAiQ2hhaW4gSUQgaXMgaW52YWxpZC4iLCB7IG5hbWU6ICJJbnZhbGlkQ2hhaW5JZEVycm9yIiB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRGVwbG95RGF0YS5qcwogIGZ1bmN0aW9uIGVuY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFhcmdzIHx8IGFyZ3MubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gYnl0ZWNvZGU7CiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGFiaTIuZmluZCgoeCkgPT4gInR5cGUiIGluIHggJiYgeC50eXBlID09PSAiY29uc3RydWN0b3IiKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3Rvck5vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgaWYgKCEoImlucHV0cyIgaW4gZGVzY3JpcHRpb24pKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoNSB9KTsKICAgIGlmICghZGVzY3JpcHRpb24uaW5wdXRzIHx8IGRlc2NyaXB0aW9uLmlucHV0cy5sZW5ndGggPT09IDApCiAgICAgIHRocm93IG5ldyBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IoeyBkb2NzUGF0aDogZG9jc1BhdGg1IH0pOwogICAgY29uc3QgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoZGVzY3JpcHRpb24uaW5wdXRzLCBhcmdzKTsKICAgIHJldHVybiBjb25jYXRIZXgoW2J5dGVjb2RlLCBkYXRhXSk7CiAgfQogIHZhciBkb2NzUGF0aDU7CiAgdmFyIGluaXRfZW5jb2RlRGVwbG95RGF0YSA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZURlcGxveURhdGEuanMiKCkgewogICAgICBpbml0X2FiaSgpOwogICAgICBpbml0X2NvbmNhdCgpOwogICAgICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICAgICAgZG9jc1BhdGg1ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZURlcGxveURhdGEiOwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMKICBmdW5jdGlvbiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7IGJsb2NrTnVtYmVyLCBjaGFpbiwgY29udHJhY3Q6IG5hbWUgfSkgewogICAgY29uc3QgY29udHJhY3QgPSBjaGFpbj8uY29udHJhY3RzPy5bbmFtZV07CiAgICBpZiAoIWNvbnRyYWN0KQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogeyBuYW1lIH0KICAgICAgfSk7CiAgICBpZiAoYmxvY2tOdW1iZXIgJiYgY29udHJhY3QuYmxvY2tDcmVhdGVkICYmIGNvbnRyYWN0LmJsb2NrQ3JlYXRlZCA+IGJsb2NrTnVtYmVyKQogICAgICB0aHJvdyBuZXcgQ2hhaW5Eb2VzTm90U3VwcG9ydENvbnRyYWN0KHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBjaGFpbiwKICAgICAgICBjb250cmFjdDogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogY29udHJhY3QuYmxvY2tDcmVhdGVkCiAgICAgICAgfQogICAgICB9KTsKICAgIHJldHVybiBjb250cmFjdC5hZGRyZXNzOwogIH0KICB2YXIgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MuanMiKCkgewogICAgICBpbml0X2NoYWluKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q2FsbEVycm9yLmpzCiAgZnVuY3Rpb24gZ2V0Q2FsbEVycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBDYWxsRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQogIHZhciBpbml0X2dldENhbGxFcnJvciA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZXJyb3JzL2dldENhbGxFcnJvci5qcyIoKSB7CiAgICAgIGluaXRfY29udHJhY3QoKTsKICAgICAgaW5pdF9ub2RlKCk7CiAgICAgIGluaXRfZ2V0Tm9kZUVycm9yKCk7CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMKICBmdW5jdGlvbiB3aXRoUmVzb2x2ZXJzKCkgewogICAgbGV0IHJlc29sdmUgPSAoKSA9PiB2b2lkIDA7CiAgICBsZXQgcmVqZWN0ID0gKCkgPT4gdm9pZCAwOwogICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlXywgcmVqZWN0XykgPT4gewogICAgICByZXNvbHZlID0gcmVzb2x2ZV87CiAgICAgIHJlamVjdCA9IHJlamVjdF87CiAgICB9KTsKICAgIHJldHVybiB7IHByb21pc2UsIHJlc29sdmUsIHJlamVjdCB9OwogIH0KICB2YXIgaW5pdF93aXRoUmVzb2x2ZXJzID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhSZXNvbHZlcnMuanMiKCkgewogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS9jcmVhdGVCYXRjaFNjaGVkdWxlci5qcwogIGZ1bmN0aW9uIGNyZWF0ZUJhdGNoU2NoZWR1bGVyKHsgZm4sIGlkLCBzaG91bGRTcGxpdEJhdGNoLCB3YWl0OiB3YWl0MiA9IDAsIHNvcnQgfSkgewogICAgY29uc3QgZXhlYyA9IGFzeW5jICgpID0+IHsKICAgICAgY29uc3Qgc2NoZWR1bGVyID0gZ2V0U2NoZWR1bGVyKCk7CiAgICAgIGZsdXNoKCk7CiAgICAgIGNvbnN0IGFyZ3MgPSBzY2hlZHVsZXIubWFwKCh7IGFyZ3M6IGFyZ3MyIH0pID0+IGFyZ3MyKTsKICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKQogICAgICAgIHJldHVybjsKICAgICAgZm4oYXJncykudGhlbigoZGF0YSkgPT4gewogICAgICAgIGlmIChzb3J0ICYmIEFycmF5LmlzQXJyYXkoZGF0YSkpCiAgICAgICAgICBkYXRhLnNvcnQoc29ydCk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVzb2x2ZSB9ID0gc2NoZWR1bGVyW2ldOwogICAgICAgICAgcmVzb2x2ZT8uKFtkYXRhW2ldLCBkYXRhXSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY2hlZHVsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHsgcmVqZWN0IH0gPSBzY2hlZHVsZXJbaV07CiAgICAgICAgICByZWplY3Q/LihlcnIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogICAgY29uc3QgZmx1c2ggPSAoKSA9PiBzY2hlZHVsZXJDYWNoZS5kZWxldGUoaWQpOwogICAgY29uc3QgZ2V0QmF0Y2hlZEFyZ3MgPSAoKSA9PiBnZXRTY2hlZHVsZXIoKS5tYXAoKHsgYXJncyB9KSA9PiBhcmdzKTsKICAgIGNvbnN0IGdldFNjaGVkdWxlciA9ICgpID0+IHNjaGVkdWxlckNhY2hlLmdldChpZCkgfHwgW107CiAgICBjb25zdCBzZXRTY2hlZHVsZXIgPSAoaXRlbSkgPT4gc2NoZWR1bGVyQ2FjaGUuc2V0KGlkLCBbLi4uZ2V0U2NoZWR1bGVyKCksIGl0ZW1dKTsKICAgIHJldHVybiB7CiAgICAgIGZsdXNoLAogICAgICBhc3luYyBzY2hlZHVsZShhcmdzKSB7CiAgICAgICAgY29uc3QgeyBwcm9taXNlLCByZXNvbHZlLCByZWplY3QgfSA9IHdpdGhSZXNvbHZlcnMoKTsKICAgICAgICBjb25zdCBzcGxpdDIgPSBzaG91bGRTcGxpdEJhdGNoPy4oWy4uLmdldEJhdGNoZWRBcmdzKCksIGFyZ3NdKTsKICAgICAgICBpZiAoc3BsaXQyKQogICAgICAgICAgZXhlYygpOwogICAgICAgIGNvbnN0IGhhc0FjdGl2ZVNjaGVkdWxlciA9IGdldFNjaGVkdWxlcigpLmxlbmd0aCA+IDA7CiAgICAgICAgaWYgKGhhc0FjdGl2ZVNjaGVkdWxlcikgewogICAgICAgICAgc2V0U2NoZWR1bGVyKHsgYXJncywgcmVzb2x2ZSwgcmVqZWN0IH0pOwogICAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgICAgfQogICAgICAgIHNldFNjaGVkdWxlcih7IGFyZ3MsIHJlc29sdmUsIHJlamVjdCB9KTsKICAgICAgICBzZXRUaW1lb3V0KGV4ZWMsIHdhaXQyKTsKICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgfQogICAgfTsKICB9CiAgdmFyIHNjaGVkdWxlckNhY2hlOwogIHZhciBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyID0gX19lc20oewogICAgIm5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL2NyZWF0ZUJhdGNoU2NoZWR1bGVyLmpzIigpIHsKICAgICAgaW5pdF93aXRoUmVzb2x2ZXJzKCk7CiAgICAgIHNjaGVkdWxlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzCiAgdmFyIE9mZmNoYWluTG9va3VwRXJyb3IsIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciwgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yOwogIHZhciBpbml0X2NjaXAgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9jY2lwLmpzIigpIHsKICAgICAgaW5pdF9zdHJpbmdpZnkoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfdXRpbHMzKCk7CiAgICAgIE9mZmNoYWluTG9va3VwRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgICAgIGNvbnN0cnVjdG9yKHsgY2FsbGJhY2tTZWxlY3RvciwgY2F1c2UsIGRhdGEsIGV4dHJhRGF0YSwgc2VuZGVyLCB1cmxzIH0pIHsKICAgICAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSB8fCAiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgZm9yIGFuIG9mZmNoYWluIHJlc3VsdC4iLCB7CiAgICAgICAgICAgIGNhdXNlLAogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgfHwgW10sCiAgICAgICAgICAgICAgY2F1c2UubWV0YU1lc3NhZ2VzPy5sZW5ndGggPyAiIiA6IFtdLAogICAgICAgICAgICAgICJPZmZjaGFpbiBHYXRld2F5IENhbGw6IiwKICAgICAgICAgICAgICB1cmxzICYmIFsKICAgICAgICAgICAgICAgICIgIEdhdGV3YXkgVVJMKHMpOiIsCiAgICAgICAgICAgICAgICAuLi51cmxzLm1hcCgodXJsKSA9PiBgICAgICR7Z2V0VXJsKHVybCl9YCkKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGAgIFNlbmRlcjogJHtzZW5kZXJ9YCwKICAgICAgICAgICAgICBgICBEYXRhOiAke2RhdGF9YCwKICAgICAgICAgICAgICBgICBDYWxsYmFjayBzZWxlY3RvcjogJHtjYWxsYmFja1NlbGVjdG9yfWAsCiAgICAgICAgICAgICAgYCAgRXh0cmEgZGF0YTogJHtleHRyYURhdGF9YAogICAgICAgICAgICBdLmZsYXQoKSwKICAgICAgICAgICAgbmFtZTogIk9mZmNoYWluTG9va3VwRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwUmVzcG9uc2VNYWxmb3JtZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyByZXN1bHQsIHVybCB9KSB7CiAgICAgICAgICBzdXBlcigiT2ZmY2hhaW4gZ2F0ZXdheSByZXNwb25zZSBpcyBtYWxmb3JtZWQuIFJlc3BvbnNlIGRhdGEgbXVzdCBiZSBhIGhleCB2YWx1ZS4iLCB7CiAgICAgICAgICAgIG1ldGFNZXNzYWdlczogWwogICAgICAgICAgICAgIGBHYXRld2F5IFVSTDogJHtnZXRVcmwodXJsKX1gLAogICAgICAgICAgICAgIGBSZXNwb25zZTogJHtzdHJpbmdpZnkocmVzdWx0KX1gCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cFJlc3BvbnNlTWFsZm9ybWVkRXJyb3IiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIE9mZmNoYWluTG9va3VwU2VuZGVyTWlzbWF0Y2hFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICAgICAgY29uc3RydWN0b3IoeyBzZW5kZXIsIHRvIH0pIHsKICAgICAgICAgIHN1cGVyKCJSZXZlcnRlZCBzZW5kZXIgYWRkcmVzcyBkb2VzIG5vdCBtYXRjaCB0YXJnZXQgY29udHJhY3QgYWRkcmVzcyAoYHRvYCkuIiwgewogICAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgICBgQ29udHJhY3QgYWRkcmVzczogJHt0b31gLAogICAgICAgICAgICAgIGBPZmZjaGFpbkxvb2t1cCBzZW5kZXIgYWRkcmVzczogJHtzZW5kZXJ9YAogICAgICAgICAgICBdLAogICAgICAgICAgICBuYW1lOiAiT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yIgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcwogIHZhciBjY2lwX2V4cG9ydHMgPSB7fTsKICBfX2V4cG9ydChjY2lwX2V4cG9ydHMsIHsKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlCiAgfSk7CiAgYXN5bmMgZnVuY3Rpb24gb2ZmY2hhaW5Mb29rdXAoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgdG8gfSkgewogICAgY29uc3QgeyBhcmdzIH0gPSBkZWNvZGVFcnJvclJlc3VsdCh7CiAgICAgIGRhdGEsCiAgICAgIGFiaTogW29mZmNoYWluTG9va3VwQWJpSXRlbV0KICAgIH0pOwogICAgY29uc3QgW3NlbmRlciwgdXJscywgY2FsbERhdGEsIGNhbGxiYWNrU2VsZWN0b3IsIGV4dHJhRGF0YV0gPSBhcmdzOwogICAgY29uc3QgeyBjY2lwUmVhZCB9ID0gY2xpZW50OwogICAgY29uc3QgY2NpcFJlcXVlc3RfID0gY2NpcFJlYWQgJiYgdHlwZW9mIGNjaXBSZWFkPy5yZXF1ZXN0ID09PSAiZnVuY3Rpb24iID8gY2NpcFJlYWQucmVxdWVzdCA6IGNjaXBSZXF1ZXN0OwogICAgdHJ5IHsKICAgICAgaWYgKCFpc0FkZHJlc3NFcXVhbCh0bywgc2VuZGVyKSkKICAgICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBTZW5kZXJNaXNtYXRjaEVycm9yKHsgc2VuZGVyLCB0byB9KTsKICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2NpcFJlcXVlc3RfKHsgZGF0YTogY2FsbERhdGEsIHNlbmRlciwgdXJscyB9KTsKICAgICAgY29uc3QgeyBkYXRhOiBkYXRhXyB9ID0gYXdhaXQgY2FsbChjbGllbnQsIHsKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZywKICAgICAgICBkYXRhOiBjb25jYXQoWwogICAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFtyZXN1bHQsIGV4dHJhRGF0YV0pCiAgICAgICAgXSksCiAgICAgICAgdG8KICAgICAgfSk7CiAgICAgIHJldHVybiBkYXRhXzsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICB0aHJvdyBuZXcgT2ZmY2hhaW5Mb29rdXBFcnJvcih7CiAgICAgICAgY2FsbGJhY2tTZWxlY3RvciwKICAgICAgICBjYXVzZTogZXJyLAogICAgICAgIGRhdGEsCiAgICAgICAgZXh0cmFEYXRhLAogICAgICAgIHNlbmRlciwKICAgICAgICB1cmxzCiAgICAgIH0pOwogICAgfQogIH0KICBhc3luYyBmdW5jdGlvbiBjY2lwUmVxdWVzdCh7IGRhdGEsIHNlbmRlciwgdXJscyB9KSB7CiAgICBsZXQgZXJyb3IgPSBuZXcgRXJyb3IoIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQuIik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVybHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgdXJsID0gdXJsc1tpXTsKICAgICAgY29uc3QgbWV0aG9kID0gdXJsLmluY2x1ZGVzKCJ7ZGF0YX0iKSA/ICJHRVQiIDogIlBPU1QiOwogICAgICBjb25zdCBib2R5ID0gbWV0aG9kID09PSAiUE9TVCIgPyB7IGRhdGEsIHNlbmRlciB9IDogdm9pZCAwOwogICAgICBjb25zdCBoZWFkZXJzID0gbWV0aG9kID09PSAiUE9TVCIgPyB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSA6IHt9OwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLnJlcGxhY2UoIntzZW5kZXJ9Iiwgc2VuZGVyKS5yZXBsYWNlKCJ7ZGF0YX0iLCBkYXRhKSwgewogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgbWV0aG9kCiAgICAgICAgfSk7CiAgICAgICAgbGV0IHJlc3VsdDsKICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpIHsKICAgICAgICAgIHJlc3VsdCA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpLmRhdGE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgZXJyb3IgPSBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgIGRldGFpbHM6IHJlc3VsdD8uZXJyb3IgPyBzdHJpbmdpZnkocmVzdWx0LmVycm9yKSA6IHJlc3BvbnNlLnN0YXR1c1RleHQsCiAgICAgICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlLmhlYWRlcnMsCiAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICghaXNIZXgocmVzdWx0KSkgewogICAgICAgICAgZXJyb3IgPSBuZXcgT2ZmY2hhaW5Mb29rdXBSZXNwb25zZU1hbGZvcm1lZEVycm9yKHsKICAgICAgICAgICAgcmVzdWx0LAogICAgICAgICAgICB1cmwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGVycm9yID0gbmV3IEh0dHBSZXF1ZXN0RXJyb3IoewogICAgICAgICAgYm9keSwKICAgICAgICAgIGRldGFpbHM6IGVyci5tZXNzYWdlLAogICAgICAgICAgdXJsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIHRocm93IGVycm9yOwogIH0KICB2YXIgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmUsIG9mZmNoYWluTG9va3VwQWJpSXRlbTsKICB2YXIgaW5pdF9jY2lwMiA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2NpcC5qcyIoKSB7CiAgICAgIGluaXRfY2FsbCgpOwogICAgICBpbml0X2NjaXAoKTsKICAgICAgaW5pdF9yZXF1ZXN0KCk7CiAgICAgIGluaXRfZGVjb2RlRXJyb3JSZXN1bHQoKTsKICAgICAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgICAgIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICAgICAgaW5pdF9jb25jYXQoKTsKICAgICAgaW5pdF9pc0hleCgpOwogICAgICBpbml0X3N0cmluZ2lmeSgpOwogICAgICBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZSA9ICIweDU1NmYxODMwIjsKICAgICAgb2ZmY2hhaW5Mb29rdXBBYmlJdGVtID0gewogICAgICAgIG5hbWU6ICJPZmZjaGFpbkxvb2t1cCIsCiAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICBpbnB1dHM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInNlbmRlciIsCiAgICAgICAgICAgIHR5cGU6ICJhZGRyZXNzIgogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInVybHMiLAogICAgICAgICAgICB0eXBlOiAic3RyaW5nW10iCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbERhdGEiLAogICAgICAgICAgICB0eXBlOiAiYnl0ZXMiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiY2FsbGJhY2tGdW5jdGlvbiIsCiAgICAgICAgICAgIHR5cGU6ICJieXRlczQiCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiZXh0cmFEYXRhIiwKICAgICAgICAgICAgdHlwZTogImJ5dGVzIgogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NhbGwuanMKICBhc3luYyBmdW5jdGlvbiBjYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBiYXRjaCA9IEJvb2xlYW4oY2xpZW50LmJhdGNoPy5tdWx0aWNhbGwpLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYWNjZXNzTGlzdCwgYmxvYnMsIGNvZGUsIGRhdGE6IGRhdGFfLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgc3RhdGVPdmVycmlkZSwgLi4ucmVzdCB9ID0gYXJnczsKICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50XyA/IHBhcnNlQWNjb3VudChhY2NvdW50XykgOiB2b2lkIDA7CiAgICBpZiAoY29kZSAmJiAoZmFjdG9yeSB8fCBmYWN0b3J5RGF0YSkpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJDYW5ub3QgcHJvdmlkZSBib3RoIGBjb2RlYCAmIGBmYWN0b3J5YC9gZmFjdG9yeURhdGFgIGFzIHBhcmFtZXRlcnMuIik7CiAgICBpZiAoY29kZSAmJiB0bykKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkNhbm5vdCBwcm92aWRlIGJvdGggYGNvZGVgICYgYHRvYCBhcyBwYXJhbWV0ZXJzLiIpOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSA9IGNvZGUgJiYgZGF0YV87CiAgICBjb25zdCBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnkgPSBmYWN0b3J5ICYmIGZhY3RvcnlEYXRhICYmIHRvICYmIGRhdGFfOwogICAgY29uc3QgZGVwbG95bGVzc0NhbGwgPSBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlIHx8IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeTsKICAgIGNvbnN0IGRhdGEgPSAoKCkgPT4gewogICAgICBpZiAoZGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlRGF0YSh7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgZGF0YTogZGF0YV8KICAgICAgICB9KTsKICAgICAgaWYgKGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeSkKICAgICAgICByZXR1cm4gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHsKICAgICAgICAgIGRhdGE6IGRhdGFfLAogICAgICAgICAgZmFjdG9yeSwKICAgICAgICAgIGZhY3RvcnlEYXRhLAogICAgICAgICAgdG8KICAgICAgICB9KTsKICAgICAgcmV0dXJuIGRhdGFfOwogICAgfSkoKTsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWc7CiAgICAgIGNvbnN0IHJwY1N0YXRlT3ZlcnJpZGUgPSBzZXJpYWxpemVTdGF0ZU92ZXJyaWRlKHN0YXRlT3ZlcnJpZGUpOwogICAgICBjb25zdCBjaGFpbkZvcm1hdCA9IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVycz8udHJhbnNhY3Rpb25SZXF1ZXN0Py5mb3JtYXQ7CiAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgICAgLy8gUGljayBvdXQgZXh0cmEgZGF0YSB0aGF0IG1pZ2h0IGV4aXN0IG9uIHRoZSBjaGFpbidzIHRyYW5zYWN0aW9uIHJlcXVlc3QgdHlwZS4KICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgYmxvYnMsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgbm9uY2UsCiAgICAgICAgdG86IGRlcGxveWxlc3NDYWxsID8gdm9pZCAwIDogdG8sCiAgICAgICAgdmFsdWUKICAgICAgfSk7CiAgICAgIGlmIChiYXRjaCAmJiBzaG91bGRQZXJmb3JtTXVsdGljYWxsKHsgcmVxdWVzdCB9KSAmJiAhcnBjU3RhdGVPdmVycmlkZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgc2NoZWR1bGVNdWx0aWNhbGwoY2xpZW50LCB7CiAgICAgICAgICAgIC4uLnJlcXVlc3QsCiAgICAgICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgICAgICBibG9ja1RhZwogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcikgJiYgIShlcnIgaW5zdGFuY2VvZiBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3QpKQogICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUgPyBbCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgYmxvY2ssCiAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgXSA6IFtyZXF1ZXN0LCBibG9ja10KICAgICAgfSk7CiAgICAgIGlmIChyZXNwb25zZSA9PT0gIjB4IikKICAgICAgICByZXR1cm4geyBkYXRhOiB2b2lkIDAgfTsKICAgICAgcmV0dXJuIHsgZGF0YTogcmVzcG9uc2UgfTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBjb25zdCBkYXRhMiA9IGdldFJldmVydEVycm9yRGF0YShlcnIpOwogICAgICBjb25zdCB7IG9mZmNoYWluTG9va3VwOiBvZmZjaGFpbkxvb2t1cDIsIG9mZmNoYWluTG9va3VwU2lnbmF0dXJlOiBvZmZjaGFpbkxvb2t1cFNpZ25hdHVyZTIgfSA9IGF3YWl0IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gKGluaXRfY2NpcDIoKSwgY2NpcF9leHBvcnRzKSk7CiAgICAgIGlmIChjbGllbnQuY2NpcFJlYWQgIT09IGZhbHNlICYmIGRhdGEyPy5zbGljZSgwLCAxMCkgPT09IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlMiAmJiB0bykKICAgICAgICByZXR1cm4geyBkYXRhOiBhd2FpdCBvZmZjaGFpbkxvb2t1cDIoY2xpZW50LCB7IGRhdGE6IGRhdGEyLCB0byB9KSB9OwogICAgICBpZiAoZGVwbG95bGVzc0NhbGwgJiYgZGF0YTI/LnNsaWNlKDAsIDEwKSA9PT0gIjB4MTAxYmI5OGQiKQogICAgICAgIHRocm93IG5ldyBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcih7IGZhY3RvcnkgfSk7CiAgICAgIHRocm93IGdldENhbGxFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2hvdWxkUGVyZm9ybU11bHRpY2FsbCh7IHJlcXVlc3QgfSkgewogICAgY29uc3QgeyBkYXRhLCB0bywgLi4ucmVxdWVzdF8gfSA9IHJlcXVlc3Q7CiAgICBpZiAoIWRhdGEpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChkYXRhLnN0YXJ0c1dpdGgoYWdncmVnYXRlM1NpZ25hdHVyZSkpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICghdG8pCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChPYmplY3QudmFsdWVzKHJlcXVlc3RfKS5maWx0ZXIoKHgpID0+IHR5cGVvZiB4ICE9PSAidW5kZWZpbmVkIikubGVuZ3RoID4gMCkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHNjaGVkdWxlTXVsdGljYWxsKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBiYXRjaFNpemUgPSAxMDI0LCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBjbGllbnQuYmF0Y2g/Lm11bHRpY2FsbCA9PT0gIm9iamVjdCIgPyBjbGllbnQuYmF0Y2gubXVsdGljYWxsIDoge307CiAgICBjb25zdCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCBkYXRhLCBtdWx0aWNhbGxBZGRyZXNzOiBtdWx0aWNhbGxBZGRyZXNzXywgdG8gfSA9IGFyZ3M7CiAgICBsZXQgbXVsdGljYWxsQWRkcmVzcyA9IG11bHRpY2FsbEFkZHJlc3NfOwogICAgaWYgKCFtdWx0aWNhbGxBZGRyZXNzKSB7CiAgICAgIGlmICghY2xpZW50LmNoYWluKQogICAgICAgIHRocm93IG5ldyBDbGllbnRDaGFpbk5vdENvbmZpZ3VyZWRFcnJvcigpOwogICAgICBtdWx0aWNhbGxBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJtdWx0aWNhbGwzIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7Y2xpZW50LnVpZH0uJHtibG9ja31gLAogICAgICB3YWl0OiB3YWl0MiwKICAgICAgc2hvdWxkU3BsaXRCYXRjaChhcmdzMikgewogICAgICAgIGNvbnN0IHNpemUzID0gYXJnczIucmVkdWNlKChzaXplNCwgeyBkYXRhOiBkYXRhMiB9KSA9PiBzaXplNCArIChkYXRhMi5sZW5ndGggLSAyKSwgMCk7CiAgICAgICAgcmV0dXJuIHNpemUzID4gYmF0Y2hTaXplICogMjsKICAgICAgfSwKICAgICAgZm46IGFzeW5jIChyZXF1ZXN0cykgPT4gewogICAgICAgIGNvbnN0IGNhbGxzID0gcmVxdWVzdHMubWFwKChyZXF1ZXN0KSA9PiAoewogICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgY2FsbERhdGE6IHJlcXVlc3QuZGF0YSwKICAgICAgICAgIHRhcmdldDogcmVxdWVzdC50bwogICAgICAgIH0pKTsKICAgICAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IG11bHRpY2FsbDNBYmksCiAgICAgICAgICBhcmdzOiBbY2FsbHNdLAogICAgICAgICAgZnVuY3Rpb25OYW1lOiAiYWdncmVnYXRlMyIKICAgICAgICB9KTsKICAgICAgICBjb25zdCBkYXRhMiA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9jYWxsIiwKICAgICAgICAgIHBhcmFtczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGF0YTogY2FsbGRhdGEsCiAgICAgICAgICAgICAgdG86IG11bHRpY2FsbEFkZHJlc3MKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYmxvY2sKICAgICAgICAgIF0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZGVjb2RlRnVuY3Rpb25SZXN1bHQoewogICAgICAgICAgYWJpOiBtdWx0aWNhbGwzQWJpLAogICAgICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImFnZ3JlZ2F0ZTMiLAogICAgICAgICAgZGF0YTogZGF0YTIgfHwgIjB4IgogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFt7IHJldHVybkRhdGEsIHN1Y2Nlc3MgfV0gPSBhd2FpdCBzY2hlZHVsZSh7IGRhdGEsIHRvIH0pOwogICAgaWYgKCFzdWNjZXNzKQogICAgICB0aHJvdyBuZXcgUmF3Q29udHJhY3RFcnJvcih7IGRhdGE6IHJldHVybkRhdGEgfSk7CiAgICBpZiAocmV0dXJuRGF0YSA9PT0gIjB4IikKICAgICAgcmV0dXJuIHsgZGF0YTogdm9pZCAwIH07CiAgICByZXR1cm4geyBkYXRhOiByZXR1cm5EYXRhIH07CiAgfQogIGZ1bmN0aW9uIHRvRGVwbG95bGVzc0NhbGxWaWFCeXRlY29kZURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYnl0ZXMsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgICAgYXJnczogW2NvZGUsIGRhdGFdCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gdG9EZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlEYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHRvIH0gPSBwYXJhbWV0ZXJzOwogICAgcmV0dXJuIGVuY29kZURlcGxveURhdGEoewogICAgICBhYmk6IHBhcnNlQWJpKFsiY29uc3RydWN0b3IoYWRkcmVzcywgYnl0ZXMsIGFkZHJlc3MsIGJ5dGVzKSJdKSwKICAgICAgYnl0ZWNvZGU6IGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlLAogICAgICBhcmdzOiBbdG8sIGRhdGEsIGZhY3RvcnksIGZhY3RvcnlEYXRhXQogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGdldFJldmVydEVycm9yRGF0YShlcnIpIHsKICAgIGlmICghKGVyciBpbnN0YW5jZW9mIEJhc2VFcnJvcjIpKQogICAgICByZXR1cm4gdm9pZCAwOwogICAgY29uc3QgZXJyb3IgPSBlcnIud2FsaygpOwogICAgcmV0dXJuIHR5cGVvZiBlcnJvcj8uZGF0YSA9PT0gIm9iamVjdCIgPyBlcnJvci5kYXRhPy5kYXRhIDogZXJyb3IuZGF0YTsKICB9CiAgdmFyIGluaXRfY2FsbCA9IF9fZXNtKHsKICAgICJub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY2FsbC5qcyIoKSB7CiAgICAgIGluaXRfZXhwb3J0cygpOwogICAgICBpbml0X3BhcnNlQWNjb3VudCgpOwogICAgICBpbml0X2FiaXMoKTsKICAgICAgaW5pdF9jb250cmFjdDIoKTsKICAgICAgaW5pdF9jb250cmFjdHMoKTsKICAgICAgaW5pdF9iYXNlKCk7CiAgICAgIGluaXRfY2hhaW4oKTsKICAgICAgaW5pdF9jb250cmFjdCgpOwogICAgICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgICAgIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogICAgICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogICAgICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgICAgIGluaXRfdG9IZXgoKTsKICAgICAgaW5pdF9nZXRDYWxsRXJyb3IoKTsKICAgICAgaW5pdF9leHRyYWN0KCk7CiAgICAgIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CiAgICAgIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKICAgICAgaW5pdF9zdGF0ZU92ZXJyaWRlMigpOwogICAgICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzCiAgZnVuY3Rpb24gZ2V0TmF0aXZlV2ViU29ja2V0KCkgewogICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gV2ViU29ja2V0OwogICAgaWYgKHR5cGVvZiBnbG9iYWwuV2ViU29ja2V0ICE9PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIGdsb2JhbC5XZWJTb2NrZXQ7CiAgICBpZiAodHlwZW9mIHdpbmRvdy5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gd2luZG93LldlYlNvY2tldDsKICAgIGlmICh0eXBlb2Ygc2VsZi5XZWJTb2NrZXQgIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gc2VsZi5XZWJTb2NrZXQ7CiAgICB0aHJvdyBuZXcgRXJyb3IoImBXZWJTb2NrZXRgIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudCIpOwogIH0KICB2YXIgaW5pdF91dGlsczUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL3V0aWxzLmpzIigpIHsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcwogIHZhciBuYXRpdmVfZXhwb3J0cyA9IHt9OwogIF9fZXhwb3J0KG5hdGl2ZV9leHBvcnRzLCB7CiAgICBXZWJTb2NrZXQ6ICgpID0+IFdlYlNvY2tldDIKICB9KTsKICB2YXIgV2ViU29ja2V0MjsKICB2YXIgaW5pdF9uYXRpdmUgPSBfX2VzbSh7CiAgICAibm9kZV9tb2R1bGVzLy5kZW5vL2lzb3dzQDEuMC42L25vZGVfbW9kdWxlcy9pc293cy9fZXNtL25hdGl2ZS5qcyIoKSB7CiAgICAgIGluaXRfdXRpbHM1KCk7CiAgICAgIFdlYlNvY2tldDIgPSBnZXROYXRpdmVXZWJTb2NrZXQoKTsKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgdmFyIGVzbV9leHBvcnRzID0ge307CiAgX19leHBvcnQoZXNtX2V4cG9ydHMsIHsKICAgIEFiaUNvbnN0cnVjdG9yTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yLAogICAgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlDb25zdHJ1Y3RvclBhcmFtc05vdEZvdW5kRXJyb3IsCiAgICBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ0RhdGFTaXplSW52YWxpZEVycm9yLAogICAgQWJpRGVjb2RpbmdEYXRhU2l6ZVRvb1NtYWxsRXJyb3I6ICgpID0+IEFiaURlY29kaW5nRGF0YVNpemVUb29TbWFsbEVycm9yLAogICAgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yOiAoKSA9PiBBYmlEZWNvZGluZ1plcm9EYXRhRXJyb3IsCiAgICBBYmlFbmNvZGluZ0FycmF5TGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdBcnJheUxlbmd0aE1pc21hdGNoRXJyb3IsCiAgICBBYmlFbmNvZGluZ0J5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEFiaUVuY29kaW5nQnl0ZXNTaXplTWlzbWF0Y2hFcnJvciwKICAgIEFiaUVuY29kaW5nTGVuZ3RoTWlzbWF0Y2hFcnJvcjogKCkgPT4gQWJpRW5jb2RpbmdMZW5ndGhNaXNtYXRjaEVycm9yLAogICAgQWJpRXJyb3JJbnB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFcnJvcklucHV0c05vdEZvdW5kRXJyb3IsCiAgICBBYmlFcnJvck5vdEZvdW5kRXJyb3I6ICgpID0+IEFiaUVycm9yTm90Rm91bmRFcnJvciwKICAgIEFiaUVycm9yU2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXJyb3JTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRXZlbnROb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlFdmVudE5vdEZvdW5kRXJyb3IsCiAgICBBYmlFdmVudFNpZ25hdHVyZUVtcHR5VG9waWNzRXJyb3I6ICgpID0+IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvciwKICAgIEFiaUV2ZW50U2lnbmF0dXJlTm90Rm91bmRFcnJvcjogKCkgPT4gQWJpRXZlbnRTaWduYXR1cmVOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvbk91dHB1dHNOb3RGb3VuZEVycm9yLAogICAgQWJpRnVuY3Rpb25TaWduYXR1cmVOb3RGb3VuZEVycm9yOiAoKSA9PiBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3IsCiAgICBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yOiAoKSA9PiBBY2NvdW50U3RhdGVDb25mbGljdEVycm9yLAogICAgQmFzZUVycm9yOiAoKSA9PiBCYXNlRXJyb3IyLAogICAgQmFzZUZlZVNjYWxhckVycm9yOiAoKSA9PiBCYXNlRmVlU2NhbGFyRXJyb3IsCiAgICBCbG9ja05vdEZvdW5kRXJyb3I6ICgpID0+IEJsb2NrTm90Rm91bmRFcnJvciwKICAgIEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3I6ICgpID0+IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IsCiAgICBDYWxsRXhlY3V0aW9uRXJyb3I6ICgpID0+IENhbGxFeGVjdXRpb25FcnJvciwKICAgIENoYWluRGlzY29ubmVjdGVkRXJyb3I6ICgpID0+IENoYWluRGlzY29ubmVjdGVkRXJyb3IsCiAgICBDaGFpbkRvZXNOb3RTdXBwb3J0Q29udHJhY3Q6ICgpID0+IENoYWluRG9lc05vdFN1cHBvcnRDb250cmFjdCwKICAgIENoYWluTWlzbWF0Y2hFcnJvcjogKCkgPT4gQ2hhaW5NaXNtYXRjaEVycm9yLAogICAgQ2hhaW5Ob3RGb3VuZEVycm9yOiAoKSA9PiBDaGFpbk5vdEZvdW5kRXJyb3IsCiAgICBDaXJjdWxhclJlZmVyZW5jZUVycm9yOiAoKSA9PiBDaXJjdWxhclJlZmVyZW5jZUVycm9yLAogICAgQ2xpZW50Q2hhaW5Ob3RDb25maWd1cmVkRXJyb3I6ICgpID0+IENsaWVudENoYWluTm90Q29uZmlndXJlZEVycm9yLAogICAgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBDb250cmFjdEZ1bmN0aW9uRXhlY3V0aW9uRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblJldmVydGVkRXJyb3IsCiAgICBDb250cmFjdEZ1bmN0aW9uWmVyb0RhdGFFcnJvcjogKCkgPT4gQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IsCiAgICBDb3VudGVyZmFjdHVhbERlcGxveW1lbnRGYWlsZWRFcnJvcjogKCkgPT4gQ291bnRlcmZhY3R1YWxEZXBsb3ltZW50RmFpbGVkRXJyb3IsCiAgICBEZWNvZGVMb2dEYXRhTWlzbWF0Y2g6ICgpID0+IERlY29kZUxvZ0RhdGFNaXNtYXRjaCwKICAgIERlY29kZUxvZ1RvcGljc01pc21hdGNoOiAoKSA9PiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCwKICAgIEVJUDExOTNQcm92aWRlclJwY0Vycm9yOiAoKSA9PiBQcm92aWRlclJwY0Vycm9yMiwKICAgIEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3I6ICgpID0+IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IsCiAgICBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3I6ICgpID0+IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvciwKICAgIEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3I6ICgpID0+IEVuc0F2YXRhclVuc3VwcG9ydGVkTmFtZXNwYWNlRXJyb3IsCiAgICBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3I6ICgpID0+IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvciwKICAgIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3I6ICgpID0+IEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IsCiAgICBFeGVjdXRpb25SZXZlcnRlZEVycm9yOiAoKSA9PiBFeGVjdXRpb25SZXZlcnRlZEVycm9yLAogICAgRmVlQ2FwVG9vSGlnaEVycm9yOiAoKSA9PiBGZWVDYXBUb29IaWdoRXJyb3IsCiAgICBGZWVDYXBUb29Mb3dFcnJvcjogKCkgPT4gRmVlQ2FwVG9vTG93RXJyb3IsCiAgICBGZWVDb25mbGljdEVycm9yOiAoKSA9PiBGZWVDb25mbGljdEVycm9yLAogICAgRmlsdGVyVHlwZU5vdFN1cHBvcnRlZEVycm9yOiAoKSA9PiBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBIdHRwUmVxdWVzdEVycm9yOiAoKSA9PiBIdHRwUmVxdWVzdEVycm9yLAogICAgSW5zdWZmaWNpZW50RnVuZHNFcnJvcjogKCkgPT4gSW5zdWZmaWNpZW50RnVuZHNFcnJvciwKICAgIEludGVnZXJPdXRPZlJhbmdlRXJyb3I6ICgpID0+IEludGVnZXJPdXRPZlJhbmdlRXJyb3IsCiAgICBJbnRlcm5hbFJwY0Vycm9yOiAoKSA9PiBJbnRlcm5hbFJwY0Vycm9yLAogICAgSW50cmluc2ljR2FzVG9vSGlnaEVycm9yOiAoKSA9PiBJbnRyaW5zaWNHYXNUb29IaWdoRXJyb3IsCiAgICBJbnRyaW5zaWNHYXNUb29Mb3dFcnJvcjogKCkgPT4gSW50cmluc2ljR2FzVG9vTG93RXJyb3IsCiAgICBJbnZhbGlkQWJpRGVjb2RpbmdUeXBlRXJyb3I6ICgpID0+IEludmFsaWRBYmlEZWNvZGluZ1R5cGVFcnJvciwKICAgIEludmFsaWRBYmlFbmNvZGluZ1R5cGVFcnJvcjogKCkgPT4gSW52YWxpZEFiaUVuY29kaW5nVHlwZUVycm9yLAogICAgSW52YWxpZEFiaUl0ZW1FcnJvcjogKCkgPT4gSW52YWxpZEFiaUl0ZW1FcnJvciwKICAgIEludmFsaWRBYmlQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvcjogKCkgPT4gSW52YWxpZEFiaVBhcmFtZXRlcnNFcnJvciwKICAgIEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3I6ICgpID0+IEludmFsaWRBYmlUeXBlUGFyYW1ldGVyRXJyb3IsCiAgICBJbnZhbGlkQWRkcmVzc0Vycm9yOiAoKSA9PiBJbnZhbGlkQWRkcmVzc0Vycm9yLAogICAgSW52YWxpZEFycmF5RXJyb3I6ICgpID0+IEludmFsaWRBcnJheUVycm9yLAogICAgSW52YWxpZEJ5dGVzQm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkQnl0ZXNCb29sZWFuRXJyb3IsCiAgICBJbnZhbGlkQ2hhaW5JZEVycm9yOiAoKSA9PiBJbnZhbGlkQ2hhaW5JZEVycm9yLAogICAgSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvcjogKCkgPT4gSW52YWxpZERlY2ltYWxOdW1iZXJFcnJvciwKICAgIEludmFsaWREZWZpbml0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkRGVmaW5pdGlvblR5cGVFcnJvciwKICAgIEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3I6ICgpID0+IEludmFsaWRGdW5jdGlvbk1vZGlmaWVyRXJyb3IsCiAgICBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yOiAoKSA9PiBJbnZhbGlkSGV4Qm9vbGVhbkVycm9yLAogICAgSW52YWxpZEhleFZhbHVlRXJyb3I6ICgpID0+IEludmFsaWRIZXhWYWx1ZUVycm9yLAogICAgSW52YWxpZElucHV0UnBjRXJyb3I6ICgpID0+IEludmFsaWRJbnB1dFJwY0Vycm9yLAogICAgSW52YWxpZExlZ2FjeVZFcnJvcjogKCkgPT4gSW52YWxpZExlZ2FjeVZFcnJvciwKICAgIEludmFsaWRNb2RpZmllckVycm9yOiAoKSA9PiBJbnZhbGlkTW9kaWZpZXJFcnJvciwKICAgIEludmFsaWRQYXJhbWV0ZXJFcnJvcjogKCkgPT4gSW52YWxpZFBhcmFtZXRlckVycm9yLAogICAgSW52YWxpZFBhcmFtc1JwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUGFyYW1zUnBjRXJyb3IsCiAgICBJbnZhbGlkUGFyZW50aGVzaXNFcnJvcjogKCkgPT4gSW52YWxpZFBhcmVudGhlc2lzRXJyb3IsCiAgICBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcjogKCkgPT4gSW52YWxpZFByaW1hcnlUeXBlRXJyb3IsCiAgICBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yOiAoKSA9PiBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yLAogICAgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3I6ICgpID0+IEludmFsaWRTZXJpYWxpemFibGVUcmFuc2FjdGlvbkVycm9yLAogICAgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IsCiAgICBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yOiAoKSA9PiBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZUVycm9yLAogICAgSW52YWxpZFNpZ25hdHVyZUVycm9yOiAoKSA9PiBJbnZhbGlkU2lnbmF0dXJlRXJyb3IsCiAgICBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcjogKCkgPT4gSW52YWxpZFN0b3JhZ2VLZXlTaXplRXJyb3IsCiAgICBJbnZhbGlkU3RydWN0U2lnbmF0dXJlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RTaWduYXR1cmVFcnJvciwKICAgIEludmFsaWRTdHJ1Y3RUeXBlRXJyb3I6ICgpID0+IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IsCiAgICBKc29uUnBjVmVyc2lvblVuc3VwcG9ydGVkRXJyb3I6ICgpID0+IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvciwKICAgIExpbWl0RXhjZWVkZWRScGNFcnJvcjogKCkgPT4gTGltaXRFeGNlZWRlZFJwY0Vycm9yLAogICAgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3I6ICgpID0+IE1heEZlZVBlckdhc1Rvb0xvd0Vycm9yLAogICAgTWV0aG9kTm90Rm91bmRScGNFcnJvcjogKCkgPT4gTWV0aG9kTm90Rm91bmRScGNFcnJvciwKICAgIE1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yOiAoKSA9PiBNZXRob2ROb3RTdXBwb3J0ZWRScGNFcnJvciwKICAgIE5vbmNlTWF4VmFsdWVFcnJvcjogKCkgPT4gTm9uY2VNYXhWYWx1ZUVycm9yLAogICAgTm9uY2VUb29IaWdoRXJyb3I6ICgpID0+IE5vbmNlVG9vSGlnaEVycm9yLAogICAgTm9uY2VUb29Mb3dFcnJvcjogKCkgPT4gTm9uY2VUb29Mb3dFcnJvciwKICAgIFBhcnNlUnBjRXJyb3I6ICgpID0+IFBhcnNlUnBjRXJyb3IsCiAgICBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yOiAoKSA9PiBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLAogICAgUHJvdmlkZXJScGNFcnJvcjogKCkgPT4gUHJvdmlkZXJScGNFcnJvciwKICAgIFJhd0NvbnRyYWN0RXJyb3I6ICgpID0+IFJhd0NvbnRyYWN0RXJyb3IsCiAgICBSZXNvdXJjZU5vdEZvdW5kUnBjRXJyb3I6ICgpID0+IFJlc291cmNlTm90Rm91bmRScGNFcnJvciwKICAgIFJlc291cmNlVW5hdmFpbGFibGVScGNFcnJvcjogKCkgPT4gUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yLAogICAgUnBjRXJyb3I6ICgpID0+IFJwY0Vycm9yLAogICAgUnBjUmVxdWVzdEVycm9yOiAoKSA9PiBScGNSZXF1ZXN0RXJyb3IsCiAgICBTaXplRXhjZWVkc1BhZGRpbmdTaXplRXJyb3I6ICgpID0+IFNpemVFeGNlZWRzUGFkZGluZ1NpemVFcnJvciwKICAgIFNpemVPdmVyZmxvd0Vycm9yOiAoKSA9PiBTaXplT3ZlcmZsb3dFcnJvciwKICAgIFNsaWNlT2Zmc2V0T3V0T2ZCb3VuZHNFcnJvcjogKCkgPT4gU2xpY2VPZmZzZXRPdXRPZkJvdW5kc0Vycm9yLAogICAgU29ja2V0Q2xvc2VkRXJyb3I6ICgpID0+IFNvY2tldENsb3NlZEVycm9yLAogICAgU29saWRpdHlQcm90ZWN0ZWRLZXl3b3JkRXJyb3I6ICgpID0+IFNvbGlkaXR5UHJvdGVjdGVkS2V5d29yZEVycm9yLAogICAgU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvcjogKCkgPT4gU3RhdGVBc3NpZ25tZW50Q29uZmxpY3RFcnJvciwKICAgIFN3aXRjaENoYWluRXJyb3I6ICgpID0+IFN3aXRjaENoYWluRXJyb3IsCiAgICBUaW1lb3V0RXJyb3I6ICgpID0+IFRpbWVvdXRFcnJvciwKICAgIFRpcEFib3ZlRmVlQ2FwRXJyb3I6ICgpID0+IFRpcEFib3ZlRmVlQ2FwRXJyb3IsCiAgICBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbkV4ZWN1dGlvbkVycm9yLAogICAgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvbk5vdEZvdW5kRXJyb3IsCiAgICBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yLAogICAgVHJhbnNhY3Rpb25SZWplY3RlZFJwY0Vycm9yOiAoKSA9PiBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IsCiAgICBUcmFuc2FjdGlvblR5cGVOb3RTdXBwb3J0ZWRFcnJvcjogKCkgPT4gVHJhbnNhY3Rpb25UeXBlTm90U3VwcG9ydGVkRXJyb3IsCiAgICBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yOiAoKSA9PiBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yLAogICAgVW5rbm93bk5vZGVFcnJvcjogKCkgPT4gVW5rbm93bk5vZGVFcnJvciwKICAgIFVua25vd25ScGNFcnJvcjogKCkgPT4gVW5rbm93blJwY0Vycm9yLAogICAgVW5rbm93blNpZ25hdHVyZUVycm9yOiAoKSA9PiBVbmtub3duU2lnbmF0dXJlRXJyb3IsCiAgICBVbmtub3duVHlwZUVycm9yOiAoKSA9PiBVbmtub3duVHlwZUVycm9yLAogICAgVW5zdXBwb3J0ZWRQYWNrZWRBYmlUeXBlOiAoKSA9PiBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUsCiAgICBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3I6ICgpID0+IFVuc3VwcG9ydGVkUHJvdmlkZXJNZXRob2RFcnJvciwKICAgIFVybFJlcXVpcmVkRXJyb3I6ICgpID0+IFVybFJlcXVpcmVkRXJyb3IsCiAgICBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3I6ICgpID0+IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvciwKICAgIFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3I6ICgpID0+IFdhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHRUaW1lb3V0RXJyb3IsCiAgICBXZWJTb2NrZXRSZXF1ZXN0RXJyb3I6ICgpID0+IFdlYlNvY2tldFJlcXVlc3RFcnJvciwKICAgIGFzc2VydEN1cnJlbnRDaGFpbjogKCkgPT4gYXNzZXJ0Q3VycmVudENoYWluLAogICAgYXNzZXJ0UmVxdWVzdDogKCkgPT4gYXNzZXJ0UmVxdWVzdCwKICAgIGFzc2VydFRyYW5zYWN0aW9uRUlQMTU1OTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5LAogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAyOTMwOiAoKSA9PiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAsCiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeTogKCkgPT4gYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3ksCiAgICBibG9ic1RvQ29tbWl0bWVudHM6ICgpID0+IGJsb2JzVG9Db21taXRtZW50cywKICAgIGJsb2JzVG9Qcm9vZnM6ICgpID0+IGJsb2JzVG9Qcm9vZnMsCiAgICBib29sVG9CeXRlczogKCkgPT4gYm9vbFRvQnl0ZXMsCiAgICBib29sVG9IZXg6ICgpID0+IGJvb2xUb0hleCwKICAgIGJ5dGVzVG9CaWdJbnQ6ICgpID0+IGJ5dGVzVG9CaWdJbnQsCiAgICBieXRlc1RvQm9vbDogKCkgPT4gYnl0ZXNUb0Jvb2wsCiAgICBieXRlc1RvSGV4OiAoKSA9PiBieXRlc1RvSGV4LAogICAgYnl0ZXNUb051bWJlcjogKCkgPT4gYnl0ZXNUb051bWJlciwKICAgIGJ5dGVzVG9SbHA6ICgpID0+IGJ5dGVzVG9SbHAsCiAgICBieXRlc1RvU3RyaW5nOiAoKSA9PiBieXRlc1RvU3RyaW5nLAogICAgY2NpcEZldGNoOiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNjaXBSZXF1ZXN0OiAoKSA9PiBjY2lwUmVxdWVzdCwKICAgIGNoZWNrc3VtQWRkcmVzczogKCkgPT4gY2hlY2tzdW1BZGRyZXNzLAogICAgY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaDogKCkgPT4gY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaCwKICAgIGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXM6ICgpID0+IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUsCiAgICBjb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmU6ICgpID0+IGNvbXBhY3RTaWduYXR1cmVUb1NpZ25hdHVyZSwKICAgIGNvbmNhdDogKCkgPT4gY29uY2F0LAogICAgY29uY2F0Qnl0ZXM6ICgpID0+IGNvbmNhdEJ5dGVzMiwKICAgIGNvbmNhdEhleDogKCkgPT4gY29uY2F0SGV4LAogICAgY3JlYXRlQ2xpZW50OiAoKSA9PiBjcmVhdGVDbGllbnQsCiAgICBjcmVhdGVOb25jZU1hbmFnZXI6ICgpID0+IGNyZWF0ZU5vbmNlTWFuYWdlciwKICAgIGNyZWF0ZVB1YmxpY0NsaWVudDogKCkgPT4gY3JlYXRlUHVibGljQ2xpZW50LAogICAgY3JlYXRlVGVzdENsaWVudDogKCkgPT4gY3JlYXRlVGVzdENsaWVudCwKICAgIGNyZWF0ZVRyYW5zcG9ydDogKCkgPT4gY3JlYXRlVHJhbnNwb3J0LAogICAgY3JlYXRlV2FsbGV0Q2xpZW50OiAoKSA9PiBjcmVhdGVXYWxsZXRDbGllbnQsCiAgICBjdXN0b206ICgpID0+IGN1c3RvbSwKICAgIGRlY29kZUFiaVBhcmFtZXRlcnM6ICgpID0+IGRlY29kZUFiaVBhcmFtZXRlcnMsCiAgICBkZWNvZGVEZXBsb3lEYXRhOiAoKSA9PiBkZWNvZGVEZXBsb3lEYXRhLAogICAgZGVjb2RlRXJyb3JSZXN1bHQ6ICgpID0+IGRlY29kZUVycm9yUmVzdWx0LAogICAgZGVjb2RlRXZlbnRMb2c6ICgpID0+IGRlY29kZUV2ZW50TG9nLAogICAgZGVjb2RlRnVuY3Rpb25EYXRhOiAoKSA9PiBkZWNvZGVGdW5jdGlvbkRhdGEsCiAgICBkZWNvZGVGdW5jdGlvblJlc3VsdDogKCkgPT4gZGVjb2RlRnVuY3Rpb25SZXN1bHQsCiAgICBkZWZpbmVCbG9jazogKCkgPT4gZGVmaW5lQmxvY2ssCiAgICBkZWZpbmVDaGFpbjogKCkgPT4gZGVmaW5lQ2hhaW4sCiAgICBkZWZpbmVLemc6ICgpID0+IGRlZmluZUt6ZywKICAgIGRlZmluZVRyYW5zYWN0aW9uOiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvbiwKICAgIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZGVmaW5lVHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBkZXBsb3lsZXNzQ2FsbFZpYUJ5dGVjb2RlQnl0ZWNvZGU6ICgpID0+IGRlcGxveWxlc3NDYWxsVmlhQnl0ZWNvZGVCeXRlY29kZSwKICAgIGRlcGxveWxlc3NDYWxsVmlhRmFjdG9yeUJ5dGVjb2RlOiAoKSA9PiBkZXBsb3lsZXNzQ2FsbFZpYUZhY3RvcnlCeXRlY29kZSwKICAgIGRvbWFpblNlcGFyYXRvcjogKCkgPT4gZG9tYWluU2VwYXJhdG9yLAogICAgZW5jb2RlQWJpUGFyYW1ldGVyczogKCkgPT4gZW5jb2RlQWJpUGFyYW1ldGVycywKICAgIGVuY29kZURlcGxveURhdGE6ICgpID0+IGVuY29kZURlcGxveURhdGEsCiAgICBlbmNvZGVFcnJvclJlc3VsdDogKCkgPT4gZW5jb2RlRXJyb3JSZXN1bHQsCiAgICBlbmNvZGVFdmVudFRvcGljczogKCkgPT4gZW5jb2RlRXZlbnRUb3BpY3MsCiAgICBlbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IGVuY29kZUZ1bmN0aW9uRGF0YSwKICAgIGVuY29kZUZ1bmN0aW9uUmVzdWx0OiAoKSA9PiBlbmNvZGVGdW5jdGlvblJlc3VsdCwKICAgIGVuY29kZVBhY2tlZDogKCkgPT4gZW5jb2RlUGFja2VkLAogICAgZXJjMjBBYmk6ICgpID0+IGVyYzIwQWJpLAogICAgZXJjMjBBYmlfYnl0ZXMzMjogKCkgPT4gZXJjMjBBYmlfYnl0ZXMzMiwKICAgIGVyYzQ2MjZBYmk6ICgpID0+IGVyYzQ2MjZBYmksCiAgICBlcmM3MjFBYmk6ICgpID0+IGVyYzcyMUFiaSwKICAgIGV0aGVyVW5pdHM6ICgpID0+IGV0aGVyVW5pdHMsCiAgICBleHRyYWN0Q2hhaW46ICgpID0+IGV4dHJhY3RDaGFpbiwKICAgIGZhbGxiYWNrOiAoKSA9PiBmYWxsYmFjaywKICAgIGZvcm1hdEJsb2NrOiAoKSA9PiBmb3JtYXRCbG9jaywKICAgIGZvcm1hdEV0aGVyOiAoKSA9PiBmb3JtYXRFdGhlciwKICAgIGZvcm1hdEd3ZWk6ICgpID0+IGZvcm1hdEd3ZWksCiAgICBmb3JtYXRMb2c6ICgpID0+IGZvcm1hdExvZywKICAgIGZvcm1hdFRyYW5zYWN0aW9uOiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvbiwKICAgIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDogKCkgPT4gZm9ybWF0VHJhbnNhY3Rpb25SZWNlaXB0LAogICAgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OiAoKSA9PiBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3QsCiAgICBmb3JtYXRVbml0czogKCkgPT4gZm9ybWF0VW5pdHMsCiAgICBmcm9tQmxvYnM6ICgpID0+IGZyb21CbG9icywKICAgIGZyb21CeXRlczogKCkgPT4gZnJvbUJ5dGVzLAogICAgZnJvbUhleDogKCkgPT4gZnJvbUhleCwKICAgIGZyb21SbHA6ICgpID0+IGZyb21SbHAsCiAgICBnZXRBYmlJdGVtOiAoKSA9PiBnZXRBYmlJdGVtLAogICAgZ2V0QWRkcmVzczogKCkgPT4gZ2V0QWRkcmVzcywKICAgIGdldENoYWluQ29udHJhY3RBZGRyZXNzOiAoKSA9PiBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcywKICAgIGdldENvbnRyYWN0OiAoKSA9PiBnZXRDb250cmFjdCwKICAgIGdldENvbnRyYWN0QWRkcmVzczogKCkgPT4gZ2V0Q29udHJhY3RBZGRyZXNzMiwKICAgIGdldENvbnRyYWN0RXJyb3I6ICgpID0+IGdldENvbnRyYWN0RXJyb3IsCiAgICBnZXRDcmVhdGUyQWRkcmVzczogKCkgPT4gZ2V0Q3JlYXRlMkFkZHJlc3MsCiAgICBnZXRDcmVhdGVBZGRyZXNzOiAoKSA9PiBnZXRDcmVhdGVBZGRyZXNzLAogICAgZ2V0RXZlbnRTZWxlY3RvcjogKCkgPT4gdG9FdmVudFNlbGVjdG9yLAogICAgZ2V0RXZlbnRTaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0RnVuY3Rpb25TZWxlY3RvcjogKCkgPT4gdG9GdW5jdGlvblNlbGVjdG9yLAogICAgZ2V0RnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0U2VyaWFsaXplZFRyYW5zYWN0aW9uVHlwZSwKICAgIGdldFRyYW5zYWN0aW9uVHlwZTogKCkgPT4gZ2V0VHJhbnNhY3Rpb25UeXBlLAogICAgZ2V0VHlwZXNGb3JFSVA3MTJEb21haW46ICgpID0+IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluLAogICAgZ3dlaVVuaXRzOiAoKSA9PiBnd2VpVW5pdHMsCiAgICBoYXNoRG9tYWluOiAoKSA9PiBoYXNoRG9tYWluLAogICAgaGFzaE1lc3NhZ2U6ICgpID0+IGhhc2hNZXNzYWdlLAogICAgaGFzaFR5cGVkRGF0YTogKCkgPT4gaGFzaFR5cGVkRGF0YSwKICAgIGhleFRvQmlnSW50OiAoKSA9PiBoZXhUb0JpZ0ludCwKICAgIGhleFRvQm9vbDogKCkgPT4gaGV4VG9Cb29sLAogICAgaGV4VG9CeXRlczogKCkgPT4gaGV4VG9CeXRlcywKICAgIGhleFRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gcGFyc2VDb21wYWN0U2lnbmF0dXJlLAogICAgaGV4VG9OdW1iZXI6ICgpID0+IGhleFRvTnVtYmVyLAogICAgaGV4VG9SbHA6ICgpID0+IGhleFRvUmxwLAogICAgaGV4VG9TaWduYXR1cmU6ICgpID0+IHBhcnNlU2lnbmF0dXJlMiwKICAgIGhleFRvU3RyaW5nOiAoKSA9PiBoZXhUb1N0cmluZywKICAgIGh0dHA6ICgpID0+IGh0dHAsCiAgICBpc0FkZHJlc3M6ICgpID0+IGlzQWRkcmVzcywKICAgIGlzQWRkcmVzc0VxdWFsOiAoKSA9PiBpc0FkZHJlc3NFcXVhbCwKICAgIGlzQnl0ZXM6ICgpID0+IGlzQnl0ZXMzLAogICAgaXNFcmM2NDkyU2lnbmF0dXJlOiAoKSA9PiBpc0VyYzY0OTJTaWduYXR1cmUsCiAgICBpc0hhc2g6ICgpID0+IGlzSGFzaCwKICAgIGlzSGV4OiAoKSA9PiBpc0hleCwKICAgIGtlY2NhazI1NjogKCkgPT4ga2VjY2FrMjU2LAogICAgbGFiZWxoYXNoOiAoKSA9PiBsYWJlbGhhc2gsCiAgICBtYXhJbnQxMDQ6ICgpID0+IG1heEludDEwNCwKICAgIG1heEludDExMjogKCkgPT4gbWF4SW50MTEyLAogICAgbWF4SW50MTIwOiAoKSA9PiBtYXhJbnQxMjAsCiAgICBtYXhJbnQxMjg6ICgpID0+IG1heEludDEyOCwKICAgIG1heEludDEzNjogKCkgPT4gbWF4SW50MTM2LAogICAgbWF4SW50MTQ0OiAoKSA9PiBtYXhJbnQxNDQsCiAgICBtYXhJbnQxNTI6ICgpID0+IG1heEludDE1MiwKICAgIG1heEludDE2OiAoKSA9PiBtYXhJbnQxNiwKICAgIG1heEludDE2MDogKCkgPT4gbWF4SW50MTYwLAogICAgbWF4SW50MTY4OiAoKSA9PiBtYXhJbnQxNjgsCiAgICBtYXhJbnQxNzY6ICgpID0+IG1heEludDE3NiwKICAgIG1heEludDE4NDogKCkgPT4gbWF4SW50MTg0LAogICAgbWF4SW50MTkyOiAoKSA9PiBtYXhJbnQxOTIsCiAgICBtYXhJbnQyMDA6ICgpID0+IG1heEludDIwMCwKICAgIG1heEludDIwODogKCkgPT4gbWF4SW50MjA4LAogICAgbWF4SW50MjE2OiAoKSA9PiBtYXhJbnQyMTYsCiAgICBtYXhJbnQyMjQ6ICgpID0+IG1heEludDIyNCwKICAgIG1heEludDIzMjogKCkgPT4gbWF4SW50MjMyLAogICAgbWF4SW50MjQ6ICgpID0+IG1heEludDI0LAogICAgbWF4SW50MjQwOiAoKSA9PiBtYXhJbnQyNDAsCiAgICBtYXhJbnQyNDg6ICgpID0+IG1heEludDI0OCwKICAgIG1heEludDI1NjogKCkgPT4gbWF4SW50MjU2LAogICAgbWF4SW50MzI6ICgpID0+IG1heEludDMyLAogICAgbWF4SW50NDA6ICgpID0+IG1heEludDQwLAogICAgbWF4SW50NDg6ICgpID0+IG1heEludDQ4LAogICAgbWF4SW50NTY6ICgpID0+IG1heEludDU2LAogICAgbWF4SW50NjQ6ICgpID0+IG1heEludDY0LAogICAgbWF4SW50NzI6ICgpID0+IG1heEludDcyLAogICAgbWF4SW50ODogKCkgPT4gbWF4SW50OCwKICAgIG1heEludDgwOiAoKSA9PiBtYXhJbnQ4MCwKICAgIG1heEludDg4OiAoKSA9PiBtYXhJbnQ4OCwKICAgIG1heEludDk2OiAoKSA9PiBtYXhJbnQ5NiwKICAgIG1heFVpbnQxMDQ6ICgpID0+IG1heFVpbnQxMDQsCiAgICBtYXhVaW50MTEyOiAoKSA9PiBtYXhVaW50MTEyLAogICAgbWF4VWludDEyMDogKCkgPT4gbWF4VWludDEyMCwKICAgIG1heFVpbnQxMjg6ICgpID0+IG1heFVpbnQxMjgsCiAgICBtYXhVaW50MTM2OiAoKSA9PiBtYXhVaW50MTM2LAogICAgbWF4VWludDE0NDogKCkgPT4gbWF4VWludDE0NCwKICAgIG1heFVpbnQxNTI6ICgpID0+IG1heFVpbnQxNTIsCiAgICBtYXhVaW50MTY6ICgpID0+IG1heFVpbnQxNiwKICAgIG1heFVpbnQxNjA6ICgpID0+IG1heFVpbnQxNjAsCiAgICBtYXhVaW50MTY4OiAoKSA9PiBtYXhVaW50MTY4LAogICAgbWF4VWludDE3NjogKCkgPT4gbWF4VWludDE3NiwKICAgIG1heFVpbnQxODQ6ICgpID0+IG1heFVpbnQxODQsCiAgICBtYXhVaW50MTkyOiAoKSA9PiBtYXhVaW50MTkyLAogICAgbWF4VWludDIwMDogKCkgPT4gbWF4VWludDIwMCwKICAgIG1heFVpbnQyMDg6ICgpID0+IG1heFVpbnQyMDgsCiAgICBtYXhVaW50MjE2OiAoKSA9PiBtYXhVaW50MjE2LAogICAgbWF4VWludDIyNDogKCkgPT4gbWF4VWludDIyNCwKICAgIG1heFVpbnQyMzI6ICgpID0+IG1heFVpbnQyMzIsCiAgICBtYXhVaW50MjQ6ICgpID0+IG1heFVpbnQyNCwKICAgIG1heFVpbnQyNDA6ICgpID0+IG1heFVpbnQyNDAsCiAgICBtYXhVaW50MjQ4OiAoKSA9PiBtYXhVaW50MjQ4LAogICAgbWF4VWludDI1NjogKCkgPT4gbWF4VWludDI1NiwKICAgIG1heFVpbnQzMjogKCkgPT4gbWF4VWludDMyLAogICAgbWF4VWludDQwOiAoKSA9PiBtYXhVaW50NDAsCiAgICBtYXhVaW50NDg6ICgpID0+IG1heFVpbnQ0OCwKICAgIG1heFVpbnQ1NjogKCkgPT4gbWF4VWludDU2LAogICAgbWF4VWludDY0OiAoKSA9PiBtYXhVaW50NjQsCiAgICBtYXhVaW50NzI6ICgpID0+IG1heFVpbnQ3MiwKICAgIG1heFVpbnQ4OiAoKSA9PiBtYXhVaW50OCwKICAgIG1heFVpbnQ4MDogKCkgPT4gbWF4VWludDgwLAogICAgbWF4VWludDg4OiAoKSA9PiBtYXhVaW50ODgsCiAgICBtYXhVaW50OTY6ICgpID0+IG1heFVpbnQ5NiwKICAgIG1pbkludDEwNDogKCkgPT4gbWluSW50MTA0LAogICAgbWluSW50MTEyOiAoKSA9PiBtaW5JbnQxMTIsCiAgICBtaW5JbnQxMjA6ICgpID0+IG1pbkludDEyMCwKICAgIG1pbkludDEyODogKCkgPT4gbWluSW50MTI4LAogICAgbWluSW50MTM2OiAoKSA9PiBtaW5JbnQxMzYsCiAgICBtaW5JbnQxNDQ6ICgpID0+IG1pbkludDE0NCwKICAgIG1pbkludDE1MjogKCkgPT4gbWluSW50MTUyLAogICAgbWluSW50MTY6ICgpID0+IG1pbkludDE2LAogICAgbWluSW50MTYwOiAoKSA9PiBtaW5JbnQxNjAsCiAgICBtaW5JbnQxNjg6ICgpID0+IG1pbkludDE2OCwKICAgIG1pbkludDE3NjogKCkgPT4gbWluSW50MTc2LAogICAgbWluSW50MTg0OiAoKSA9PiBtaW5JbnQxODQsCiAgICBtaW5JbnQxOTI6ICgpID0+IG1pbkludDE5MiwKICAgIG1pbkludDIwMDogKCkgPT4gbWluSW50MjAwLAogICAgbWluSW50MjA4OiAoKSA9PiBtaW5JbnQyMDgsCiAgICBtaW5JbnQyMTY6ICgpID0+IG1pbkludDIxNiwKICAgIG1pbkludDIyNDogKCkgPT4gbWluSW50MjI0LAogICAgbWluSW50MjMyOiAoKSA9PiBtaW5JbnQyMzIsCiAgICBtaW5JbnQyNDogKCkgPT4gbWluSW50MjQsCiAgICBtaW5JbnQyNDA6ICgpID0+IG1pbkludDI0MCwKICAgIG1pbkludDI0ODogKCkgPT4gbWluSW50MjQ4LAogICAgbWluSW50MjU2OiAoKSA9PiBtaW5JbnQyNTYsCiAgICBtaW5JbnQzMjogKCkgPT4gbWluSW50MzIsCiAgICBtaW5JbnQ0MDogKCkgPT4gbWluSW50NDAsCiAgICBtaW5JbnQ0ODogKCkgPT4gbWluSW50NDgsCiAgICBtaW5JbnQ1NjogKCkgPT4gbWluSW50NTYsCiAgICBtaW5JbnQ2NDogKCkgPT4gbWluSW50NjQsCiAgICBtaW5JbnQ3MjogKCkgPT4gbWluSW50NzIsCiAgICBtaW5JbnQ4OiAoKSA9PiBtaW5JbnQ4LAogICAgbWluSW50ODA6ICgpID0+IG1pbkludDgwLAogICAgbWluSW50ODg6ICgpID0+IG1pbkludDg4LAogICAgbWluSW50OTY6ICgpID0+IG1pbkludDk2LAogICAgbXVsdGljYWxsM0FiaTogKCkgPT4gbXVsdGljYWxsM0FiaSwKICAgIG5hbWVoYXNoOiAoKSA9PiBuYW1laGFzaCwKICAgIG5vbmNlTWFuYWdlcjogKCkgPT4gbm9uY2VNYW5hZ2VyLAogICAgbnVtYmVyVG9CeXRlczogKCkgPT4gbnVtYmVyVG9CeXRlcywKICAgIG51bWJlclRvSGV4OiAoKSA9PiBudW1iZXJUb0hleCwKICAgIG9mZmNoYWluTG9va3VwOiAoKSA9PiBvZmZjaGFpbkxvb2t1cCwKICAgIG9mZmNoYWluTG9va3VwQWJpSXRlbTogKCkgPT4gb2ZmY2hhaW5Mb29rdXBBYmlJdGVtLAogICAgb2ZmY2hhaW5Mb29rdXBTaWduYXR1cmU6ICgpID0+IG9mZmNoYWluTG9va3VwU2lnbmF0dXJlLAogICAgcGFkOiAoKSA9PiBwYWQsCiAgICBwYWRCeXRlczogKCkgPT4gcGFkQnl0ZXMsCiAgICBwYWRIZXg6ICgpID0+IHBhZEhleCwKICAgIHBhcnNlQWJpOiAoKSA9PiBwYXJzZUFiaSwKICAgIHBhcnNlQWJpSXRlbTogKCkgPT4gcGFyc2VBYmlJdGVtLAogICAgcGFyc2VBYmlQYXJhbWV0ZXI6ICgpID0+IHBhcnNlQWJpUGFyYW1ldGVyMiwKICAgIHBhcnNlQWJpUGFyYW1ldGVyczogKCkgPT4gcGFyc2VBYmlQYXJhbWV0ZXJzLAogICAgcGFyc2VDb21wYWN0U2lnbmF0dXJlOiAoKSA9PiBwYXJzZUNvbXBhY3RTaWduYXR1cmUsCiAgICBwYXJzZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHBhcnNlRXJjNjQ5MlNpZ25hdHVyZSwKICAgIHBhcnNlRXRoZXI6ICgpID0+IHBhcnNlRXRoZXIsCiAgICBwYXJzZUV2ZW50TG9nczogKCkgPT4gcGFyc2VFdmVudExvZ3MsCiAgICBwYXJzZUd3ZWk6ICgpID0+IHBhcnNlR3dlaSwKICAgIHBhcnNlU2lnbmF0dXJlOiAoKSA9PiBwYXJzZVNpZ25hdHVyZTIsCiAgICBwYXJzZVRyYW5zYWN0aW9uOiAoKSA9PiBwYXJzZVRyYW5zYWN0aW9uLAogICAgcGFyc2VVbml0czogKCkgPT4gcGFyc2VVbml0cywKICAgIHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGE6ICgpID0+IHByZXBhcmVFbmNvZGVGdW5jdGlvbkRhdGEsCiAgICBwcmVzaWduTWVzc2FnZVByZWZpeDogKCkgPT4gcHJlc2lnbk1lc3NhZ2VQcmVmaXgsCiAgICBwdWJsaWNBY3Rpb25zOiAoKSA9PiBwdWJsaWNBY3Rpb25zLAogICAgcmVjb3ZlckFkZHJlc3M6ICgpID0+IHJlY292ZXJBZGRyZXNzLAogICAgcmVjb3Zlck1lc3NhZ2VBZGRyZXNzOiAoKSA9PiByZWNvdmVyTWVzc2FnZUFkZHJlc3MsCiAgICByZWNvdmVyUHVibGljS2V5OiAoKSA9PiByZWNvdmVyUHVibGljS2V5LAogICAgcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzczogKCkgPT4gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcywKICAgIHJlY292ZXJUeXBlZERhdGFBZGRyZXNzOiAoKSA9PiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcywKICAgIHJpcGVtZDE2MDogKCkgPT4gcmlwZW1kMTYwMiwKICAgIHJwY1NjaGVtYTogKCkgPT4gcnBjU2NoZW1hLAogICAgcnBjVHJhbnNhY3Rpb25UeXBlOiAoKSA9PiBycGNUcmFuc2FjdGlvblR5cGUsCiAgICBzZXJpYWxpemVBY2Nlc3NMaXN0OiAoKSA9PiBzZXJpYWxpemVBY2Nlc3NMaXN0LAogICAgc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2VyaWFsaXplQ29tcGFjdFNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUsCiAgICBzZXJpYWxpemVTaWduYXR1cmU6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNlcmlhbGl6ZVRyYW5zYWN0aW9uOiAoKSA9PiBzZXJpYWxpemVUcmFuc2FjdGlvbiwKICAgIHNlcmlhbGl6ZVR5cGVkRGF0YTogKCkgPT4gc2VyaWFsaXplVHlwZWREYXRhLAogICAgc2V0RXJyb3JDb25maWc6ICgpID0+IHNldEVycm9yQ29uZmlnLAogICAgc2V0dXBLemc6ICgpID0+IHNldHVwS3pnLAogICAgc2hhMjU2OiAoKSA9PiBzaGEyNTYyLAogICAgc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlczogKCkgPT4gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcywKICAgIHNpZ25hdHVyZVRvQ29tcGFjdFNpZ25hdHVyZTogKCkgPT4gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlLAogICAgc2lnbmF0dXJlVG9IZXg6ICgpID0+IHNlcmlhbGl6ZVNpZ25hdHVyZSwKICAgIHNpemU6ICgpID0+IHNpemUsCiAgICBzbGljZTogKCkgPT4gc2xpY2UsCiAgICBzbGljZUJ5dGVzOiAoKSA9PiBzbGljZUJ5dGVzLAogICAgc2xpY2VIZXg6ICgpID0+IHNsaWNlSGV4LAogICAgc3RyaW5nVG9CeXRlczogKCkgPT4gc3RyaW5nVG9CeXRlcywKICAgIHN0cmluZ1RvSGV4OiAoKSA9PiBzdHJpbmdUb0hleCwKICAgIHN0cmluZ2lmeTogKCkgPT4gc3RyaW5naWZ5LAogICAgdGVzdEFjdGlvbnM6ICgpID0+IHRlc3RBY3Rpb25zLAogICAgdG9CbG9iU2lkZWNhcnM6ICgpID0+IHRvQmxvYlNpZGVjYXJzLAogICAgdG9CbG9iczogKCkgPT4gdG9CbG9icywKICAgIHRvQnl0ZXM6ICgpID0+IHRvQnl0ZXMsCiAgICB0b0V2ZW50SGFzaDogKCkgPT4gdG9TaWduYXR1cmVIYXNoLAogICAgdG9FdmVudFNlbGVjdG9yOiAoKSA9PiB0b0V2ZW50U2VsZWN0b3IsCiAgICB0b0V2ZW50U2lnbmF0dXJlOiAoKSA9PiB0b1NpZ25hdHVyZSwKICAgIHRvRnVuY3Rpb25IYXNoOiAoKSA9PiB0b1NpZ25hdHVyZUhhc2gsCiAgICB0b0Z1bmN0aW9uU2VsZWN0b3I6ICgpID0+IHRvRnVuY3Rpb25TZWxlY3RvciwKICAgIHRvRnVuY3Rpb25TaWduYXR1cmU6ICgpID0+IHRvU2lnbmF0dXJlLAogICAgdG9IZXg6ICgpID0+IHRvSGV4LAogICAgdG9QcmVmaXhlZE1lc3NhZ2U6ICgpID0+IHRvUHJlZml4ZWRNZXNzYWdlLAogICAgdG9SbHA6ICgpID0+IHRvUmxwLAogICAgdHJhbnNhY3Rpb25UeXBlOiAoKSA9PiB0cmFuc2FjdGlvblR5cGUsCiAgICB0cmltOiAoKSA9PiB0cmltLAogICAgdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpOiAoKSA9PiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JBYmksCiAgICB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZTogKCkgPT4gdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQnl0ZUNvZGUsCiAgICB2YWxpZGF0ZVR5cGVkRGF0YTogKCkgPT4gdmFsaWRhdGVUeXBlZERhdGEsCiAgICB2ZXJpZnlIYXNoOiAoKSA9PiB2ZXJpZnlIYXNoLAogICAgdmVyaWZ5TWVzc2FnZTogKCkgPT4gdmVyaWZ5TWVzc2FnZSwKICAgIHZlcmlmeVR5cGVkRGF0YTogKCkgPT4gdmVyaWZ5VHlwZWREYXRhLAogICAgd2FsbGV0QWN0aW9uczogKCkgPT4gd2FsbGV0QWN0aW9ucywKICAgIHdlYlNvY2tldDogKCkgPT4gd2ViU29ja2V0LAogICAgd2VpVW5pdHM6ICgpID0+IHdlaVVuaXRzLAogICAgd2l0aFJldHJ5OiAoKSA9PiB3aXRoUmV0cnksCiAgICB3aXRoVGltZW91dDogKCkgPT4gd2l0aFRpbWVvdXQsCiAgICB6ZXJvQWRkcmVzczogKCkgPT4gemVyb0FkZHJlc3MsCiAgICB6ZXJvSGFzaDogKCkgPT4gemVyb0hhc2gKICB9KTsKICBpbml0X2V4cG9ydHMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2dldEFjdGlvbi5qcwogIGZ1bmN0aW9uIGdldEFjdGlvbihjbGllbnQsIGFjdGlvbkZuLCBuYW1lKSB7CiAgICBjb25zdCBhY3Rpb25faW1wbGljaXQgPSBjbGllbnRbYWN0aW9uRm4ubmFtZV07CiAgICBpZiAodHlwZW9mIGFjdGlvbl9pbXBsaWNpdCA9PT0gImZ1bmN0aW9uIikKICAgICAgcmV0dXJuIGFjdGlvbl9pbXBsaWNpdDsKICAgIGNvbnN0IGFjdGlvbl9leHBsaWNpdCA9IGNsaWVudFtuYW1lXTsKICAgIGlmICh0eXBlb2YgYWN0aW9uX2V4cGxpY2l0ID09PSAiZnVuY3Rpb24iKQogICAgICByZXR1cm4gYWN0aW9uX2V4cGxpY2l0OwogICAgcmV0dXJuIChwYXJhbXMpID0+IGFjdGlvbkZuKGNsaWVudCwgcGFyYW1zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X2FiaSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2xvZy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IodHlwZSkgewogICAgICBzdXBlcihgRmlsdGVyIHR5cGUgIiR7dHlwZX0iIGlzIG5vdCBzdXBwb3J0ZWQuYCwgewogICAgICAgIG5hbWU6ICJGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlRXZlbnRUb3BpY3MuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIGluaXRfZ2V0QWJpSXRlbSgpOwogIHZhciBkb2NzUGF0aCA9ICIvZG9jcy9jb250cmFjdC9lbmNvZGVFdmVudFRvcGljcyI7CiAgZnVuY3Rpb24gZW5jb2RlRXZlbnRUb3BpY3MocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGV2ZW50TmFtZSwgYXJncyB9ID0gcGFyYW1ldGVyczsKICAgIGxldCBhYmlJdGVtID0gYWJpMlswXTsKICAgIGlmIChldmVudE5hbWUpIHsKICAgICAgY29uc3QgaXRlbSA9IGdldEFiaUl0ZW0oeyBhYmk6IGFiaTIsIG5hbWU6IGV2ZW50TmFtZSB9KTsKICAgICAgaWYgKCFpdGVtKQogICAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3IoZXZlbnROYW1lLCB7IGRvY3NQYXRoIH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudE5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoIH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9FdmVudFNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IHRvcGljcyA9IFtdOwogICAgaWYgKGFyZ3MgJiYgImlucHV0cyIgaW4gYWJpSXRlbSkgewogICAgICBjb25zdCBpbmRleGVkSW5wdXRzID0gYWJpSXRlbS5pbnB1dHM/LmZpbHRlcigocGFyYW0pID0+ICJpbmRleGVkIiBpbiBwYXJhbSAmJiBwYXJhbS5pbmRleGVkKTsKICAgICAgY29uc3QgYXJnc18gPSBBcnJheS5pc0FycmF5KGFyZ3MpID8gYXJncyA6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGluZGV4ZWRJbnB1dHM/Lm1hcCgoeCkgPT4gYXJnc1t4Lm5hbWVdKSA/PyBbXSA6IFtdOwogICAgICBpZiAoYXJnc18ubGVuZ3RoID4gMCkgewogICAgICAgIHRvcGljcyA9IGluZGV4ZWRJbnB1dHM/Lm1hcCgocGFyYW0sIGkpID0+IHsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NfW2ldKSkKICAgICAgICAgICAgcmV0dXJuIGFyZ3NfW2ldLm1hcCgoXywgaikgPT4gZW5jb2RlQXJnKHsgcGFyYW0sIHZhbHVlOiBhcmdzX1tpXVtqXSB9KSk7CiAgICAgICAgICByZXR1cm4gYXJnc19baV0gPyBlbmNvZGVBcmcoeyBwYXJhbSwgdmFsdWU6IGFyZ3NfW2ldIH0pIDogbnVsbDsKICAgICAgICB9KSA/PyBbXTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIFtzaWduYXR1cmUsIC4uLnRvcGljc107CiAgfQogIGZ1bmN0aW9uIGVuY29kZUFyZyh7IHBhcmFtLCB2YWx1ZSB9KSB7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInN0cmluZyIgfHwgcGFyYW0udHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGtlY2NhazI1Nih0b0J5dGVzKHZhbHVlKSk7CiAgICBpZiAocGFyYW0udHlwZSA9PT0gInR1cGxlIiB8fCBwYXJhbS50eXBlLm1hdGNoKC9eKC4qKVxbKFxkKyk/XF0kLykpCiAgICAgIHRocm93IG5ldyBGaWx0ZXJUeXBlTm90U3VwcG9ydGVkRXJyb3IocGFyYW0udHlwZSk7CiAgICByZXR1cm4gZW5jb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCBbdmFsdWVdKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZmlsdGVycy9jcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUuanMKICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7IG1ldGhvZCB9KSB7CiAgICBjb25zdCByZXF1ZXN0TWFwID0ge307CiAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siKQogICAgICBjbGllbnQudHJhbnNwb3J0Lm9uUmVzcG9uc2U/LigoeyBtZXRob2Q6IG1ldGhvZF8sIHJlc3BvbnNlOiBpZCwgc3RhdHVzLCB0cmFuc3BvcnQgfSkgPT4gewogICAgICAgIGlmIChzdGF0dXMgPT09ICJzdWNjZXNzIiAmJiBtZXRob2QgPT09IG1ldGhvZF8pCiAgICAgICAgICByZXF1ZXN0TWFwW2lkXSA9IHRyYW5zcG9ydC5yZXF1ZXN0OwogICAgICB9KTsKICAgIHJldHVybiAoaWQpID0+IHJlcXVlc3RNYXBbaWRdIHx8IGNsaWVudC5yZXF1ZXN0OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2NyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBhYmk6IGFiaTIsIGFyZ3MsIGV2ZW50TmFtZSwgZnJvbUJsb2NrLCBzdHJpY3QsIHRvQmxvY2sgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIgogICAgfSk7CiAgICBjb25zdCB0b3BpY3MgPSBldmVudE5hbWUgPyBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lCiAgICB9KSA6IHZvaWQgMDsKICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgdG9waWNzCiAgICAgICAgfQogICAgICBdCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lLAogICAgICBpZCwKICAgICAgcmVxdWVzdDogZ2V0UmVxdWVzdChpZCksCiAgICAgIHN0cmljdDogQm9vbGVhbihzdHJpY3QpLAogICAgICB0eXBlOiAiZXZlbnQiCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlQ29udHJhY3RHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0Q29udHJhY3RFcnJvci5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGluaXRfcnBjKCk7CiAgdmFyIEVYRUNVVElPTl9SRVZFUlRFRF9FUlJPUl9DT0RFID0gMzsKICBmdW5jdGlvbiBnZXRDb250cmFjdEVycm9yKGVyciwgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRvY3NQYXRoOiBkb2NzUGF0aDksIGZ1bmN0aW9uTmFtZSwgc2VuZGVyIH0pIHsKICAgIGNvbnN0IHsgY29kZSwgZGF0YSwgbWVzc2FnZSwgc2hvcnRNZXNzYWdlIH0gPSBlcnIgaW5zdGFuY2VvZiBSYXdDb250cmFjdEVycm9yID8gZXJyIDogZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMiA/IGVyci53YWxrKChlcnIyKSA9PiAiZGF0YSIgaW4gZXJyMikgfHwgZXJyLndhbGsoKSA6IHt9OwogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKQogICAgICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IoeyBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmIChbRVhFQ1VUSU9OX1JFVkVSVEVEX0VSUk9SX0NPREUsIEludGVybmFsUnBjRXJyb3IuY29kZV0uaW5jbHVkZXMoY29kZSkgJiYgKGRhdGEgfHwgbWVzc2FnZSB8fCBzaG9ydE1lc3NhZ2UpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcih7CiAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICBkYXRhOiB0eXBlb2YgZGF0YSA9PT0gIm9iamVjdCIgPyBkYXRhLmRhdGEgOiBkYXRhLAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgbWVzc2FnZTogc2hvcnRNZXNzYWdlID8/IG1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gZXJyOwogICAgfSkoKTsKICAgIHJldHVybiBuZXcgQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgY29udHJhY3RBZGRyZXNzOiBhZGRyZXNzLAogICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICBmdW5jdGlvbk5hbWUsCiAgICAgIHNlbmRlcgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZXN0aW1hdGVHYXMuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfYmFzZSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvcHVibGljS2V5VG9BZGRyZXNzLmpzCiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBmdW5jdGlvbiBwdWJsaWNLZXlUb0FkZHJlc3MocHVibGljS2V5KSB7CiAgICBjb25zdCBhZGRyZXNzID0ga2VjY2FrMjU2KGAweCR7cHVibGljS2V5LnN1YnN0cmluZyg0KX1gKS5zdWJzdHJpbmcoMjYpOwogICAgcmV0dXJuIGNoZWNrc3VtQWRkcmVzcyhgMHgke2FkZHJlc3N9YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3JlY292ZXJQdWJsaWNLZXkuanMKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJQdWJsaWNLZXkoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pIHsKICAgIGNvbnN0IGhhc2hIZXggPSBpc0hleChoYXNoMykgPyBoYXNoMyA6IHRvSGV4KGhhc2gzKTsKICAgIGNvbnN0IHsgc2VjcDI1NmsxOiBzZWNwMjU2azEyIH0gPSBhd2FpdCBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IChpbml0X3NlY3AyNTZrMSgpLCBzZWNwMjU2azFfZXhwb3J0cykpOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9ICgoKSA9PiB7CiAgICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlID09PSAib2JqZWN0IiAmJiAiciIgaW4gc2lnbmF0dXJlICYmICJzIiBpbiBzaWduYXR1cmUpIHsKICAgICAgICBjb25zdCB7IHIsIHMsIHYsIHlQYXJpdHkgfSA9IHNpZ25hdHVyZTsKICAgICAgICBjb25zdCB5UGFyaXR5T3JWMiA9IE51bWJlcih5UGFyaXR5ID8/IHYpOwogICAgICAgIGNvbnN0IHJlY292ZXJ5Qml0MiA9IHRvUmVjb3ZlcnlCaXQoeVBhcml0eU9yVjIpOwogICAgICAgIHJldHVybiBuZXcgc2VjcDI1NmsxMi5TaWduYXR1cmUoaGV4VG9CaWdJbnQociksIGhleFRvQmlnSW50KHMpKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdDIpOwogICAgICB9CiAgICAgIGNvbnN0IHNpZ25hdHVyZUhleCA9IGlzSGV4KHNpZ25hdHVyZSkgPyBzaWduYXR1cmUgOiB0b0hleChzaWduYXR1cmUpOwogICAgICBjb25zdCB5UGFyaXR5T3JWID0gaGV4VG9OdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgICAgY29uc3QgcmVjb3ZlcnlCaXQgPSB0b1JlY292ZXJ5Qml0KHlQYXJpdHlPclYpOwogICAgICByZXR1cm4gc2VjcDI1NmsxMi5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnN1YnN0cmluZygyLCAxMzApKS5hZGRSZWNvdmVyeUJpdChyZWNvdmVyeUJpdCk7CiAgICB9KSgpOwogICAgY29uc3QgcHVibGljS2V5ID0gc2lnbmF0dXJlXy5yZWNvdmVyUHVibGljS2V5KGhhc2hIZXguc3Vic3RyaW5nKDIpKS50b0hleChmYWxzZSk7CiAgICByZXR1cm4gYDB4JHtwdWJsaWNLZXl9YDsKICB9CiAgZnVuY3Rpb24gdG9SZWNvdmVyeUJpdCh5UGFyaXR5T3JWKSB7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMCB8fCB5UGFyaXR5T3JWID09PSAxKQogICAgICByZXR1cm4geVBhcml0eU9yVjsKICAgIGlmICh5UGFyaXR5T3JWID09PSAyNykKICAgICAgcmV0dXJuIDA7CiAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgIHJldHVybiAxOwogICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHlQYXJpdHlPclYgdmFsdWUiKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlckFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyQWRkcmVzcyh7IGhhc2g6IGhhc2gzLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHB1YmxpY0tleVRvQWRkcmVzcyhhd2FpdCByZWNvdmVyUHVibGljS2V5KHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2VuY29kaW5nL3RvUmxwLmpzCiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jdXJzb3IyKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUmxwKGJ5dGVzMiwgdG8gPSAiaGV4IikgewogICAgY29uc3QgZW5jb2RhYmxlID0gZ2V0RW5jb2RhYmxlKGJ5dGVzMik7CiAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkoZW5jb2RhYmxlLmxlbmd0aCkpOwogICAgZW5jb2RhYmxlLmVuY29kZShjdXJzb3IpOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKTsKICAgIHJldHVybiBjdXJzb3IuYnl0ZXM7CiAgfQogIGZ1bmN0aW9uIGJ5dGVzVG9SbHAoYnl0ZXMyLCB0byA9ICJieXRlcyIpIHsKICAgIHJldHVybiB0b1JscChieXRlczIsIHRvKTsKICB9CiAgZnVuY3Rpb24gaGV4VG9SbHAoaGV4LCB0byA9ICJoZXgiKSB7CiAgICByZXR1cm4gdG9SbHAoaGV4LCB0byk7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZShieXRlczIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGJ5dGVzMikpCiAgICAgIHJldHVybiBnZXRFbmNvZGFibGVMaXN0KGJ5dGVzMi5tYXAoKHgpID0+IGdldEVuY29kYWJsZSh4KSkpOwogICAgcmV0dXJuIGdldEVuY29kYWJsZUJ5dGVzKGJ5dGVzMik7CiAgfQogIGZ1bmN0aW9uIGdldEVuY29kYWJsZUxpc3QobGlzdCkgewogICAgY29uc3QgYm9keUxlbmd0aCA9IGxpc3QucmVkdWNlKChhY2MsIHgpID0+IGFjYyArIHgubGVuZ3RoLCAwKTsKICAgIGNvbnN0IHNpemVPZkJvZHlMZW5ndGggPSBnZXRTaXplT2ZMZW5ndGgoYm9keUxlbmd0aCk7CiAgICBjb25zdCBsZW5ndGggPSAoKCkgPT4gewogICAgICBpZiAoYm9keUxlbmd0aCA8PSA1NSkKICAgICAgICByZXR1cm4gMSArIGJvZHlMZW5ndGg7CiAgICAgIHJldHVybiAxICsgc2l6ZU9mQm9keUxlbmd0aCArIGJvZHlMZW5ndGg7CiAgICB9KSgpOwogICAgcmV0dXJuIHsKICAgICAgbGVuZ3RoLAogICAgICBlbmNvZGUoY3Vyc29yKSB7CiAgICAgICAgaWYgKGJvZHlMZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxOTIgKyBib2R5TGVuZ3RoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDE5MiArIDU1ICsgc2l6ZU9mQm9keUxlbmd0aCk7CiAgICAgICAgICBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMSkKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50OChib2R5TGVuZ3RoKTsKICAgICAgICAgIGVsc2UgaWYgKHNpemVPZkJvZHlMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJvZHlMZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQm9keUxlbmd0aCA9PT0gMykKICAgICAgICAgICAgY3Vyc29yLnB1c2hVaW50MjQoYm9keUxlbmd0aCk7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDMyKGJvZHlMZW5ndGgpOwogICAgICAgIH0KICAgICAgICBmb3IgKGNvbnN0IHsgZW5jb2RlOiBlbmNvZGUyIH0gb2YgbGlzdCkgewogICAgICAgICAgZW5jb2RlMihjdXJzb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gZ2V0RW5jb2RhYmxlQnl0ZXMoYnl0ZXNPckhleCkgewogICAgY29uc3QgYnl0ZXMyID0gdHlwZW9mIGJ5dGVzT3JIZXggPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhieXRlc09ySGV4KSA6IGJ5dGVzT3JIZXg7CiAgICBjb25zdCBzaXplT2ZCeXRlc0xlbmd0aCA9IGdldFNpemVPZkxlbmd0aChieXRlczIubGVuZ3RoKTsKICAgIGNvbnN0IGxlbmd0aCA9ICgoKSA9PiB7CiAgICAgIGlmIChieXRlczIubGVuZ3RoID09PSAxICYmIGJ5dGVzMlswXSA8IDEyOCkKICAgICAgICByZXR1cm4gMTsKICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpCiAgICAgICAgcmV0dXJuIDEgKyBieXRlczIubGVuZ3RoOwogICAgICByZXR1cm4gMSArIHNpemVPZkJ5dGVzTGVuZ3RoICsgYnl0ZXMyLmxlbmd0aDsKICAgIH0pKCk7CiAgICByZXR1cm4gewogICAgICBsZW5ndGgsCiAgICAgIGVuY29kZShjdXJzb3IpIHsKICAgICAgICBpZiAoYnl0ZXMyLmxlbmd0aCA9PT0gMSAmJiBieXRlczJbMF0gPCAxMjgpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgaWYgKGJ5dGVzMi5sZW5ndGggPD0gNTUpIHsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZSgxMjggKyBieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY3Vyc29yLnB1c2hCeXRlKDEyOCArIDU1ICsgc2l6ZU9mQnl0ZXNMZW5ndGgpOwogICAgICAgICAgaWYgKHNpemVPZkJ5dGVzTGVuZ3RoID09PSAxKQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQ4KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDIpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDE2KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZSBpZiAoc2l6ZU9mQnl0ZXNMZW5ndGggPT09IDMpCiAgICAgICAgICAgIGN1cnNvci5wdXNoVWludDI0KGJ5dGVzMi5sZW5ndGgpOwogICAgICAgICAgZWxzZQogICAgICAgICAgICBjdXJzb3IucHVzaFVpbnQzMihieXRlczIubGVuZ3RoKTsKICAgICAgICAgIGN1cnNvci5wdXNoQnl0ZXMoYnl0ZXMyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldFNpemVPZkxlbmd0aChsZW5ndGgpIHsKICAgIGlmIChsZW5ndGggPCAyICoqIDgpCiAgICAgIHJldHVybiAxOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMTYpCiAgICAgIHJldHVybiAyOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMjQpCiAgICAgIHJldHVybiAzOwogICAgaWYgKGxlbmd0aCA8IDIgKiogMzIpCiAgICAgIHJldHVybiA0OwogICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoIkxlbmd0aCBpcyB0b28gbGFyZ2UuIik7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvaGFzaEF1dGhvcml6YXRpb24uanMKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hBdXRob3JpemF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgdG8gfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBoYXNoMyA9IGtlY2NhazI1Nihjb25jYXRIZXgoWwogICAgICAiMHgwNSIsCiAgICAgIHRvUmxwKFsKICAgICAgICBjaGFpbklkID8gbnVtYmVyVG9IZXgoY2hhaW5JZCkgOiAiMHgiLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZSA/IG51bWJlclRvSGV4KG5vbmNlKSA6ICIweCIKICAgICAgXSkKICAgIF0pKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGhleFRvQnl0ZXMoaGFzaDMpOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2V4cGVyaW1lbnRhbC9laXA3NzAyL3V0aWxzL3JlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGF1dGhvcml6YXRpb24sIHNpZ25hdHVyZSB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiByZWNvdmVyQWRkcmVzcyh7CiAgICAgIGhhc2g6IGhhc2hBdXRob3JpemF0aW9uKGF1dGhvcml6YXRpb24pLAogICAgICBzaWduYXR1cmU6IHNpZ25hdHVyZSA/PyBhdXRob3JpemF0aW9uCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfZm9ybWF0RXRoZXIoKTsKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X3RyYW5zYWN0aW9uKCk7CiAgdmFyIEVzdGltYXRlR2FzRXhlY3V0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoY2F1c2UsIHsgYWNjb3VudCwgZG9jc1BhdGg6IGRvY3NQYXRoOSwgY2hhaW4sIGRhdGEsIGdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG5vbmNlLCB0bywgdmFsdWUgfSkgewogICAgICBjb25zdCBwcmV0dHlBcmdzID0gcHJldHR5UHJpbnQoewogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgdG8sCiAgICAgICAgdmFsdWU6IHR5cGVvZiB2YWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0RXRoZXIodmFsdWUpfSAke2NoYWluPy5uYXRpdmVDdXJyZW5jeT8uc3ltYm9sIHx8ICJFVEgifWAsCiAgICAgICAgZGF0YSwKICAgICAgICBnYXMsCiAgICAgICAgZ2FzUHJpY2U6IHR5cGVvZiBnYXNQcmljZSAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShnYXNQcmljZSl9IGd3ZWlgLAogICAgICAgIG1heEZlZVBlckdhczogdHlwZW9mIG1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgJiYgYCR7Zm9ybWF0R3dlaShtYXhGZWVQZXJHYXMpfSBnd2VpYCwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogdHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiBgJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaWAsCiAgICAgICAgbm9uY2UKICAgICAgfSk7CiAgICAgIHN1cGVyKGNhdXNlLnNob3J0TWVzc2FnZSwgewogICAgICAgIGNhdXNlLAogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAuLi5jYXVzZS5tZXRhTWVzc2FnZXMgPyBbLi4uY2F1c2UubWV0YU1lc3NhZ2VzLCAiICJdIDogW10sCiAgICAgICAgICAiRXN0aW1hdGUgR2FzIEFyZ3VtZW50czoiLAogICAgICAgICAgcHJldHR5QXJncwogICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLAogICAgICAgIG5hbWU6ICJFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yIgogICAgICB9KTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJjYXVzZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICB0aGlzLmNhdXNlID0gY2F1c2U7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vycm9ycy9nZXRFc3RpbWF0ZUdhc0Vycm9yLmpzCiAgaW5pdF9ub2RlKCk7CiAgaW5pdF9nZXROb2RlRXJyb3IoKTsKICBmdW5jdGlvbiBnZXRFc3RpbWF0ZUdhc0Vycm9yKGVyciwgeyBkb2NzUGF0aDogZG9jc1BhdGg5LCAuLi5hcmdzIH0pIHsKICAgIGNvbnN0IGNhdXNlID0gKCgpID0+IHsKICAgICAgY29uc3QgY2F1c2UyID0gZ2V0Tm9kZUVycm9yKGVyciwgYXJncyk7CiAgICAgIGlmIChjYXVzZTIgaW5zdGFuY2VvZiBVbmtub3duTm9kZUVycm9yKQogICAgICAgIHJldHVybiBlcnI7CiAgICAgIHJldHVybiBjYXVzZTI7CiAgICB9KSgpOwogICAgcmV0dXJuIG5ldyBFc3RpbWF0ZUdhc0V4ZWN1dGlvbkVycm9yKGNhdXNlLCB7CiAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgIC4uLmFyZ3MKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlR2FzLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUyKCk7CiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9wcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy9mZWUuanMKICBpbml0X2Zvcm1hdEd3ZWkoKTsKICBpbml0X2Jhc2UoKTsKICB2YXIgQmFzZUZlZVNjYWxhckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiYGJhc2VGZWVNdWx0aXBsaWVyYCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxLiIsIHsKICAgICAgICBuYW1lOiAiQmFzZUZlZVNjYWxhckVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQ2hhaW4gZG9lcyBub3Qgc3VwcG9ydCBFSVAtMTU1OSBmZWVzLiIsIHsKICAgICAgICBuYW1lOiAiRWlwMTU1OUZlZXNOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKICB2YXIgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhQcmlvcml0eUZlZVBlckdhcyB9KSB7CiAgICAgIHN1cGVyKGBcYG1heEZlZVBlckdhc1xgIGNhbm5vdCBiZSBsZXNzIHRoYW4gdGhlIFxgbWF4UHJpb3JpdHlGZWVQZXJHYXNcYCAoJHtmb3JtYXRHd2VpKG1heFByaW9yaXR5RmVlUGVyR2FzKX0gZ3dlaSkuYCwgeyBuYW1lOiAiTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvY2suanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQmxvY2tOb3RGb3VuZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgYmxvY2tIYXNoLCBibG9ja051bWJlciB9KSB7CiAgICAgIGxldCBpZGVudGlmaWVyID0gIkJsb2NrIjsKICAgICAgaWYgKGJsb2NrSGFzaCkKICAgICAgICBpZGVudGlmaWVyID0gYEJsb2NrIGF0IGhhc2ggIiR7YmxvY2tIYXNofSJgOwogICAgICBpZiAoYmxvY2tOdW1iZXIpCiAgICAgICAgaWRlbnRpZmllciA9IGBCbG9jayBhdCBudW1iZXIgIiR7YmxvY2tOdW1iZXJ9ImA7CiAgICAgIHN1cGVyKGAke2lkZW50aWZpZXJ9IGNvdWxkIG5vdCBiZSBmb3VuZC5gLCB7IG5hbWU6ICJCbG9ja05vdEZvdW5kRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9jay5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvYmxvY2suanMKICBpbml0X2Zvcm1hdHRlcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvbi5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZm9ybWF0dGVyKCk7CiAgdmFyIHRyYW5zYWN0aW9uVHlwZSA9IHsKICAgICIweDAiOiAibGVnYWN5IiwKICAgICIweDEiOiAiZWlwMjkzMCIsCiAgICAiMHgyIjogImVpcDE1NTkiLAogICAgIjB4MyI6ICJlaXA0ODQ0IiwKICAgICIweDQiOiAiZWlwNzcwMiIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbl8gPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICBibG9ja0hhc2g6IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA/IHRyYW5zYWN0aW9uLmJsb2NrSGFzaCA6IG51bGwsCiAgICAgIGJsb2NrTnVtYmVyOiB0cmFuc2FjdGlvbi5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvbi5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBjaGFpbklkOiB0cmFuc2FjdGlvbi5jaGFpbklkID8gaGV4VG9OdW1iZXIodHJhbnNhY3Rpb24uY2hhaW5JZCkgOiB2b2lkIDAsCiAgICAgIGdhczogdHJhbnNhY3Rpb24uZ2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLmdhcykgOiB2b2lkIDAsCiAgICAgIGdhc1ByaWNlOiB0cmFuc2FjdGlvbi5nYXNQcmljZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi5nYXNQcmljZSkgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckJsb2JHYXM6IHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPyBCaWdJbnQodHJhbnNhY3Rpb24ubWF4RmVlUGVyQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIG1heEZlZVBlckdhczogdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID8gQmlnSW50KHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzOiB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA/IEJpZ0ludCh0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcykgOiB2b2lkIDAsCiAgICAgIG5vbmNlOiB0cmFuc2FjdGlvbi5ub25jZSA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uLm5vbmNlKSA6IHZvaWQgMCwKICAgICAgdG86IHRyYW5zYWN0aW9uLnRvID8gdHJhbnNhY3Rpb24udG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvbi50cmFuc2FjdGlvbkluZGV4ID8gTnVtYmVyKHRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgdHlwZTogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uVHlwZVt0cmFuc2FjdGlvbi50eXBlXSA6IHZvaWQgMCwKICAgICAgdHlwZUhleDogdHJhbnNhY3Rpb24udHlwZSA/IHRyYW5zYWN0aW9uLnR5cGUgOiB2b2lkIDAsCiAgICAgIHZhbHVlOiB0cmFuc2FjdGlvbi52YWx1ZSA/IEJpZ0ludCh0cmFuc2FjdGlvbi52YWx1ZSkgOiB2b2lkIDAsCiAgICAgIHY6IHRyYW5zYWN0aW9uLnYgPyBCaWdJbnQodHJhbnNhY3Rpb24udikgOiB2b2lkIDAKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb24uYXV0aG9yaXphdGlvbkxpc3QpCiAgICAgIHRyYW5zYWN0aW9uXy5hdXRob3JpemF0aW9uTGlzdCA9IGZvcm1hdEF1dGhvcml6YXRpb25MaXN0Mih0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCk7CiAgICB0cmFuc2FjdGlvbl8ueVBhcml0eSA9ICgoKSA9PiB7CiAgICAgIGlmICh0cmFuc2FjdGlvbi55UGFyaXR5KQogICAgICAgIHJldHVybiBOdW1iZXIodHJhbnNhY3Rpb24ueVBhcml0eSk7CiAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb25fLnYgPT09ICJiaWdpbnQiKSB7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAwbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjduKQogICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID09PSAxbiB8fCB0cmFuc2FjdGlvbl8udiA9PT0gMjhuKQogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYgKHRyYW5zYWN0aW9uXy52ID49IDM1bikKICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbl8udiAlIDJuID09PSAwbiA/IDEgOiAwOwogICAgICB9CiAgICAgIHJldHVybiB2b2lkIDA7CiAgICB9KSgpOwogICAgaWYgKHRyYW5zYWN0aW9uXy50eXBlID09PSAibGVnYWN5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLmFjY2Vzc0xpc3Q7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ueVBhcml0eTsKICAgIH0KICAgIGlmICh0cmFuc2FjdGlvbl8udHlwZSA9PT0gImVpcDI5MzAiKSB7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4RmVlUGVyQmxvYkdhczsKICAgICAgZGVsZXRlIHRyYW5zYWN0aW9uXy5tYXhGZWVQZXJHYXM7CiAgICAgIGRlbGV0ZSB0cmFuc2FjdGlvbl8ubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICB9CiAgICBpZiAodHJhbnNhY3Rpb25fLnR5cGUgPT09ICJlaXAxNTU5IikgewogICAgICBkZWxldGUgdHJhbnNhY3Rpb25fLm1heEZlZVBlckJsb2JHYXM7CiAgICB9CiAgICByZXR1cm4gdHJhbnNhY3Rpb25fOwogIH0KICB2YXIgZGVmaW5lVHJhbnNhY3Rpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJ0cmFuc2FjdGlvbiIsIGZvcm1hdFRyYW5zYWN0aW9uKTsKICBmdW5jdGlvbiBmb3JtYXRBdXRob3JpemF0aW9uTGlzdDIoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIHJldHVybiBhdXRob3JpemF0aW9uTGlzdC5tYXAoKGF1dGhvcml6YXRpb24pID0+ICh7CiAgICAgIGNvbnRyYWN0QWRkcmVzczogYXV0aG9yaXphdGlvbi5hZGRyZXNzLAogICAgICBjaGFpbklkOiBOdW1iZXIoYXV0aG9yaXphdGlvbi5jaGFpbklkKSwKICAgICAgbm9uY2U6IE51bWJlcihhdXRob3JpemF0aW9uLm5vbmNlKSwKICAgICAgcjogYXV0aG9yaXphdGlvbi5yLAogICAgICBzOiBhdXRob3JpemF0aW9uLnMsCiAgICAgIHlQYXJpdHk6IE51bWJlcihhdXRob3JpemF0aW9uLnlQYXJpdHkpCiAgICB9KSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy9ibG9jay5qcwogIGZ1bmN0aW9uIGZvcm1hdEJsb2NrKGJsb2NrKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbnMgPSBibG9jay50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbiA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICByZXR1cm4gZm9ybWF0VHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pOwogICAgfSk7CiAgICByZXR1cm4gewogICAgICAuLi5ibG9jaywKICAgICAgYmFzZUZlZVBlckdhczogYmxvY2suYmFzZUZlZVBlckdhcyA/IEJpZ0ludChibG9jay5iYXNlRmVlUGVyR2FzKSA6IG51bGwsCiAgICAgIGJsb2JHYXNVc2VkOiBibG9jay5ibG9iR2FzVXNlZCA/IEJpZ0ludChibG9jay5ibG9iR2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGRpZmZpY3VsdHk6IGJsb2NrLmRpZmZpY3VsdHkgPyBCaWdJbnQoYmxvY2suZGlmZmljdWx0eSkgOiB2b2lkIDAsCiAgICAgIGV4Y2Vzc0Jsb2JHYXM6IGJsb2NrLmV4Y2Vzc0Jsb2JHYXMgPyBCaWdJbnQoYmxvY2suZXhjZXNzQmxvYkdhcykgOiB2b2lkIDAsCiAgICAgIGdhc0xpbWl0OiBibG9jay5nYXNMaW1pdCA/IEJpZ0ludChibG9jay5nYXNMaW1pdCkgOiB2b2lkIDAsCiAgICAgIGdhc1VzZWQ6IGJsb2NrLmdhc1VzZWQgPyBCaWdJbnQoYmxvY2suZ2FzVXNlZCkgOiB2b2lkIDAsCiAgICAgIGhhc2g6IGJsb2NrLmhhc2ggPyBibG9jay5oYXNoIDogbnVsbCwKICAgICAgbG9nc0Jsb29tOiBibG9jay5sb2dzQmxvb20gPyBibG9jay5sb2dzQmxvb20gOiBudWxsLAogICAgICBub25jZTogYmxvY2subm9uY2UgPyBibG9jay5ub25jZSA6IG51bGwsCiAgICAgIG51bWJlcjogYmxvY2subnVtYmVyID8gQmlnSW50KGJsb2NrLm51bWJlcikgOiBudWxsLAogICAgICBzaXplOiBibG9jay5zaXplID8gQmlnSW50KGJsb2NrLnNpemUpIDogdm9pZCAwLAogICAgICB0aW1lc3RhbXA6IGJsb2NrLnRpbWVzdGFtcCA/IEJpZ0ludChibG9jay50aW1lc3RhbXApIDogdm9pZCAwLAogICAgICB0cmFuc2FjdGlvbnMsCiAgICAgIHRvdGFsRGlmZmljdWx0eTogYmxvY2sudG90YWxEaWZmaWN1bHR5ID8gQmlnSW50KGJsb2NrLnRvdGFsRGlmZmljdWx0eSkgOiBudWxsCiAgICB9OwogIH0KICB2YXIgZGVmaW5lQmxvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lRm9ybWF0dGVyKCJibG9jayIsIGZvcm1hdEJsb2NrKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2soY2xpZW50LCB7IGJsb2NrSGFzaCwgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gPz8gImxhdGVzdCI7CiAgICBjb25zdCBpbmNsdWRlVHJhbnNhY3Rpb25zID0gaW5jbHVkZVRyYW5zYWN0aW9uc18gPz8gZmFsc2U7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgYmxvY2sgPSBudWxsOwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeUhhc2giLAogICAgICAgIHBhcmFtczogW2Jsb2NrSGFzaCwgaW5jbHVkZVRyYW5zYWN0aW9uc10KICAgICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICB9IGVsc2UgewogICAgICBibG9jayA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tCeU51bWJlciIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcsIGluY2x1ZGVUcmFuc2FjdGlvbnNdCiAgICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIH0KICAgIGlmICghYmxvY2spCiAgICAgIHRocm93IG5ldyBCbG9ja05vdEZvdW5kRXJyb3IoeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyIH0pOwogICAgY29uc3QgZm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy5ibG9jaz8uZm9ybWF0IHx8IGZvcm1hdEJsb2NrOwogICAgcmV0dXJuIGZvcm1hdChibG9jayk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0R2FzUHJpY2UuanMKICBhc3luYyBmdW5jdGlvbiBnZXRHYXNQcmljZShjbGllbnQpIHsKICAgIGNvbnN0IGdhc1ByaWNlID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2FzUHJpY2UiCiAgICB9KTsKICAgIHJldHVybiBCaWdJbnQoZ2FzUHJpY2UpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMuanMKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgcmV0dXJuIGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYmxvY2s6IGJsb2NrXywgY2hhaW4gPSBjbGllbnQuY2hhaW4sIHJlcXVlc3QgfSA9IGFyZ3MgfHwge307CiAgICB0cnkgewogICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhcyA9IGNoYWluPy5mZWVzPy5tYXhQcmlvcml0eUZlZVBlckdhcyA/PyBjaGFpbj8uZmVlcz8uZGVmYXVsdFByaW9yaXR5RmVlOwogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29uc3QgYmxvY2sgPSBibG9ja18gfHwgYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgICAgICBjb25zdCBtYXhQcmlvcml0eUZlZVBlckdhc18gPSBhd2FpdCBtYXhQcmlvcml0eUZlZVBlckdhcyh7CiAgICAgICAgICBibG9jaywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgICBpZiAobWF4UHJpb3JpdHlGZWVQZXJHYXNfID09PSBudWxsKQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7CiAgICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzXzsKICAgICAgfQogICAgICBpZiAodHlwZW9mIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gbWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIGNvbnN0IG1heFByaW9yaXR5RmVlUGVyR2FzSGV4ID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9tYXhQcmlvcml0eUZlZVBlckdhcyIKICAgICAgfSk7CiAgICAgIHJldHVybiBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhc0hleCk7CiAgICB9IGNhdGNoIHsKICAgICAgY29uc3QgW2Jsb2NrLCBnYXNQcmljZV0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgYmxvY2tfID8gUHJvbWlzZS5yZXNvbHZlKGJsb2NrXykgOiBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoe30pLAogICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEdhc1ByaWNlLCAiZ2V0R2FzUHJpY2UiKSh7fSkKICAgICAgXSk7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBnYXNQcmljZSAtIGJsb2NrLmJhc2VGZWVQZXJHYXM7CiAgICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyA8IDBuKQogICAgICAgIHJldHVybiAwbjsKICAgICAgcmV0dXJuIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2VzdGltYXRlRmVlc1Blckdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIGFyZ3MpIHsKICAgIHJldHVybiBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gaW50ZXJuYWxfZXN0aW1hdGVGZWVzUGVyR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBibG9jazogYmxvY2tfLCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgcmVxdWVzdCwgdHlwZSA9ICJlaXAxNTU5IiB9ID0gYXJncyB8fCB7fTsKICAgIGNvbnN0IGJhc2VGZWVNdWx0aXBsaWVyID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBjaGFpbj8uZmVlcz8uYmFzZUZlZU11bHRpcGxpZXIgPT09ICJmdW5jdGlvbiIpCiAgICAgICAgcmV0dXJuIGNoYWluLmZlZXMuYmFzZUZlZU11bHRpcGxpZXIoewogICAgICAgICAgYmxvY2s6IGJsb2NrXywKICAgICAgICAgIGNsaWVudCwKICAgICAgICAgIHJlcXVlc3QKICAgICAgICB9KTsKICAgICAgcmV0dXJuIGNoYWluPy5mZWVzPy5iYXNlRmVlTXVsdGlwbGllciA/PyAxLjI7CiAgICB9KSgpOwogICAgaWYgKGJhc2VGZWVNdWx0aXBsaWVyIDwgMSkKICAgICAgdGhyb3cgbmV3IEJhc2VGZWVTY2FsYXJFcnJvcigpOwogICAgY29uc3QgZGVjaW1hbHMgPSBiYXNlRmVlTXVsdGlwbGllci50b1N0cmluZygpLnNwbGl0KCIuIilbMV0/Lmxlbmd0aCA/PyAwOwogICAgY29uc3QgZGVub21pbmF0b3IgPSAxMCAqKiBkZWNpbWFsczsKICAgIGNvbnN0IG11bHRpcGx5ID0gKGJhc2UyKSA9PiBiYXNlMiAqIEJpZ0ludChNYXRoLmNlaWwoYmFzZUZlZU11bHRpcGxpZXIgKiBkZW5vbWluYXRvcikpIC8gQmlnSW50KGRlbm9taW5hdG9yKTsKICAgIGNvbnN0IGJsb2NrID0gYmxvY2tfID8gYmxvY2tfIDogYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHt9KTsKICAgIGlmICh0eXBlb2YgY2hhaW4/LmZlZXM/LmVzdGltYXRlRmVlc1BlckdhcyA9PT0gImZ1bmN0aW9uIikgewogICAgICBjb25zdCBmZWVzMiA9IGF3YWl0IGNoYWluLmZlZXMuZXN0aW1hdGVGZWVzUGVyR2FzKHsKICAgICAgICBibG9jazogYmxvY2tfLAogICAgICAgIGNsaWVudCwKICAgICAgICBtdWx0aXBseSwKICAgICAgICByZXF1ZXN0LAogICAgICAgIHR5cGUKICAgICAgfSk7CiAgICAgIGlmIChmZWVzMiAhPT0gbnVsbCkKICAgICAgICByZXR1cm4gZmVlczI7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgIGlmICh0eXBlb2YgYmxvY2suYmFzZUZlZVBlckdhcyAhPT0gImJpZ2ludCIpCiAgICAgICAgdGhyb3cgbmV3IEVpcDE1NTlGZWVzTm90U3VwcG9ydGVkRXJyb3IoKTsKICAgICAgY29uc3QgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPSB0eXBlb2YgcmVxdWVzdD8ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPT09ICJiaWdpbnQiID8gcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA6IGF3YWl0IGludGVybmFsX2VzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgYmxvY2ssCiAgICAgICAgY2hhaW4sCiAgICAgICAgcmVxdWVzdAogICAgICB9KTsKICAgICAgY29uc3QgYmFzZUZlZVBlckdhcyA9IG11bHRpcGx5KGJsb2NrLmJhc2VGZWVQZXJHYXMpOwogICAgICBjb25zdCBtYXhGZWVQZXJHYXMgPSByZXF1ZXN0Py5tYXhGZWVQZXJHYXMgPz8gYmFzZUZlZVBlckdhcyArIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICByZXR1cm4gewogICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfQogICAgY29uc3QgZ2FzUHJpY2UgPSByZXF1ZXN0Py5nYXNQcmljZSA/PyBtdWx0aXBseShhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRHYXNQcmljZSwgImdldEdhc1ByaWNlIikoe30pKTsKICAgIHJldHVybiB7CiAgICAgIGdhc1ByaWNlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25Db3VudChjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tUYWcgPSAibGF0ZXN0IiwgYmxvY2tOdW1iZXIgfSkgewogICAgY29uc3QgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkNvdW50IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVyKSB9KTsKICAgIHJldHVybiBoZXhUb051bWJlcihjb3VudCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9ibG9ic1RvQ29tbWl0bWVudHMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb0NvbW1pdG1lbnRzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsga3pnIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdG8gPSBwYXJhbWV0ZXJzLnRvID8/ICh0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgYmxvYnMgPSB0eXBlb2YgcGFyYW1ldGVycy5ibG9ic1swXSA9PT0gInN0cmluZyIgPyBwYXJhbWV0ZXJzLmJsb2JzLm1hcCgoeCkgPT4gaGV4VG9CeXRlcyh4KSkgOiBwYXJhbWV0ZXJzLmJsb2JzOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykKICAgICAgY29tbWl0bWVudHMucHVzaChVaW50OEFycmF5LmZyb20oa3pnLmJsb2JUb0t6Z0NvbW1pdG1lbnQoYmxvYikpKTsKICAgIHJldHVybiB0byA9PT0gImJ5dGVzIiA/IGNvbW1pdG1lbnRzIDogY29tbWl0bWVudHMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2Jsb2JzVG9Qcm9vZnMuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gYmxvYnNUb1Byb29mcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGt6ZyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGNvbW1pdG1lbnRzID0gdHlwZW9mIHBhcmFtZXRlcnMuY29tbWl0bWVudHNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5jb21taXRtZW50cy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5jb21taXRtZW50czsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9icy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBibG9iID0gYmxvYnNbaV07CiAgICAgIGNvbnN0IGNvbW1pdG1lbnQgPSBjb21taXRtZW50c1tpXTsKICAgICAgcHJvb2ZzLnB1c2goVWludDhBcnJheS5mcm9tKGt6Zy5jb21wdXRlQmxvYkt6Z1Byb29mKGJsb2IsIGNvbW1pdG1lbnQpKSk7CiAgICB9CiAgICByZXR1cm4gdG8gPT09ICJieXRlcyIgPyBwcm9vZnMgOiBwcm9vZnMubWFwKCh4KSA9PiBieXRlc1RvSGV4KHgpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ibG9iL2NvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2guanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3NoYTI1Ni5qcwogIGluaXRfc2hhMjU2KCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBzaGEyNTYyKHZhbHVlLCB0b18pIHsKICAgIGNvbnN0IHRvID0gdG9fIHx8ICJoZXgiOwogICAgY29uc3QgYnl0ZXMyID0gc2hhMjU2KGlzSGV4KHZhbHVlLCB7IHN0cmljdDogZmFsc2UgfSkgPyB0b0J5dGVzKHZhbHVlKSA6IHZhbHVlKTsKICAgIGlmICh0byA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIGJ5dGVzMjsKICAgIHJldHVybiB0b0hleChieXRlczIpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvY29tbWl0bWVudFRvVmVyc2lvbmVkSGFzaC5qcwogIGZ1bmN0aW9uIGNvbW1pdG1lbnRUb1ZlcnNpb25lZEhhc2gocGFyYW1ldGVycykgewogICAgY29uc3QgeyBjb21taXRtZW50LCB2ZXJzaW9uOiB2ZXJzaW9uMyA9IDEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0byA9IHBhcmFtZXRlcnMudG8gPz8gKHR5cGVvZiBjb21taXRtZW50ID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCB2ZXJzaW9uZWRIYXNoID0gc2hhMjU2Mihjb21taXRtZW50LCAiYnl0ZXMiKTsKICAgIHZlcnNpb25lZEhhc2guc2V0KFt2ZXJzaW9uM10sIDApOwogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gdmVyc2lvbmVkSGFzaCA6IGJ5dGVzVG9IZXgodmVyc2lvbmVkSGFzaCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9jb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gY29tbWl0bWVudHNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGNvbW1pdG1lbnRzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIGNvbW1pdG1lbnRzWzBdID09PSAic3RyaW5nIiA/ICJoZXgiIDogImJ5dGVzIik7CiAgICBjb25zdCBoYXNoZXMgPSBbXTsKICAgIGZvciAoY29uc3QgY29tbWl0bWVudCBvZiBjb21taXRtZW50cykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2Jsb2IuanMKICB2YXIgYmxvYnNQZXJUcmFuc2FjdGlvbiA9IDY7CiAgdmFyIGJ5dGVzUGVyRmllbGRFbGVtZW50ID0gMzI7CiAgdmFyIGZpZWxkRWxlbWVudHNQZXJCbG9iID0gNDA5NjsKICB2YXIgYnl0ZXNQZXJCbG9iID0gYnl0ZXNQZXJGaWVsZEVsZW1lbnQgKiBmaWVsZEVsZW1lbnRzUGVyQmxvYjsKICB2YXIgbWF4Qnl0ZXNQZXJUcmFuc2FjdGlvbiA9IGJ5dGVzUGVyQmxvYiAqIGJsb2JzUGVyVHJhbnNhY3Rpb24gLSAvLyB0ZXJtaW5hdG9yIGJ5dGUgKDB4ODApLgogIDEgLSAvLyB6ZXJvIGJ5dGUgKDB4MDApIGFwcGVuZGVkIHRvIGVhY2ggZmllbGQgZWxlbWVudC4KICAxICogZmllbGRFbGVtZW50c1BlckJsb2IgKiBibG9ic1BlclRyYW5zYWN0aW9uOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL2t6Zy5qcwogIHZhciB2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6ZyA9IDE7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvYmxvYi5qcwogIGluaXRfYmFzZSgpOwogIHZhciBCbG9iU2l6ZVRvb0xhcmdlRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBtYXhTaXplLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKCJCbG9iIHNpemUgaXMgdG9vIGxhcmdlLiIsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFtgTWF4OiAke21heFNpemV9IGJ5dGVzYCwgYEdpdmVuOiAke3NpemUzfSBieXRlc2BdLAogICAgICAgIG5hbWU6ICJCbG9iU2l6ZVRvb0xhcmdlRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEVtcHR5QmxvYkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigiQmxvYiBkYXRhIG11c3Qgbm90IGJlIGVtcHR5LiIsIHsgbmFtZTogIkVtcHR5QmxvYkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkVmVyc2lvbmVkSGFzaFNpemVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGhhc2g6IGhhc2gzLCBzaXplOiBzaXplMyB9KSB7CiAgICAgIHN1cGVyKGBWZXJzaW9uZWQgaGFzaCAiJHtoYXNoM30iIHNpemUgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIkV4cGVjdGVkOiAzMiIsIGBSZWNlaXZlZDogJHtzaXplM31gXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFZlcnNpb25lZEhhc2hTaXplRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEludmFsaWRWZXJzaW9uZWRIYXNoVmVyc2lvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgaGFzaDogaGFzaDMsIHZlcnNpb246IHZlcnNpb24zIH0pIHsKICAgICAgc3VwZXIoYFZlcnNpb25lZCBoYXNoICIke2hhc2gzfSIgdmVyc2lvbiBpcyBpbnZhbGlkLmAsIHsKICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgIGBFeHBlY3RlZDogJHt2ZXJzaW9uZWRIYXNoVmVyc2lvbkt6Z31gLAogICAgICAgICAgYFJlY2VpdmVkOiAke3ZlcnNpb24zfWAKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJJbnZhbGlkVmVyc2lvbmVkSGFzaFZlcnNpb25FcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Jsb2IvdG9CbG9icy5qcwogIGluaXRfY3Vyc29yMigpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiB0b0Jsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuZGF0YSA9PT0gInN0cmluZyIgPyAiaGV4IiA6ICJieXRlcyIpOwogICAgY29uc3QgZGF0YSA9IHR5cGVvZiBwYXJhbWV0ZXJzLmRhdGEgPT09ICJzdHJpbmciID8gaGV4VG9CeXRlcyhwYXJhbWV0ZXJzLmRhdGEpIDogcGFyYW1ldGVycy5kYXRhOwogICAgY29uc3Qgc2l6ZV8gPSBzaXplKGRhdGEpOwogICAgaWYgKCFzaXplXykKICAgICAgdGhyb3cgbmV3IEVtcHR5QmxvYkVycm9yKCk7CiAgICBpZiAoc2l6ZV8gPiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uKQogICAgICB0aHJvdyBuZXcgQmxvYlNpemVUb29MYXJnZUVycm9yKHsKICAgICAgICBtYXhTaXplOiBtYXhCeXRlc1BlclRyYW5zYWN0aW9uLAogICAgICAgIHNpemU6IHNpemVfCiAgICAgIH0pOwogICAgY29uc3QgYmxvYnMgPSBbXTsKICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgbGV0IHBvc2l0aW9uID0gMDsKICAgIHdoaWxlIChhY3RpdmUpIHsKICAgICAgY29uc3QgYmxvYiA9IGNyZWF0ZUN1cnNvcihuZXcgVWludDhBcnJheShieXRlc1BlckJsb2IpKTsKICAgICAgbGV0IHNpemUzID0gMDsKICAgICAgd2hpbGUgKHNpemUzIDwgZmllbGRFbGVtZW50c1BlckJsb2IpIHsKICAgICAgICBjb25zdCBieXRlczIgPSBkYXRhLnNsaWNlKHBvc2l0aW9uLCBwb3NpdGlvbiArIChieXRlc1BlckZpZWxkRWxlbWVudCAtIDEpKTsKICAgICAgICBibG9iLnB1c2hCeXRlKDApOwogICAgICAgIGJsb2IucHVzaEJ5dGVzKGJ5dGVzMik7CiAgICAgICAgaWYgKGJ5dGVzMi5sZW5ndGggPCAzMSkgewogICAgICAgICAgYmxvYi5wdXNoQnl0ZSgxMjgpOwogICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgc2l6ZTMrKzsKICAgICAgICBwb3NpdGlvbiArPSAzMTsKICAgICAgfQogICAgICBibG9icy5wdXNoKGJsb2IpOwogICAgfQogICAgcmV0dXJuIHRvID09PSAiYnl0ZXMiID8gYmxvYnMubWFwKCh4KSA9PiB4LmJ5dGVzKSA6IGJsb2JzLm1hcCgoeCkgPT4gYnl0ZXNUb0hleCh4LmJ5dGVzKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi90b0Jsb2JTaWRlY2Fycy5qcwogIGZ1bmN0aW9uIHRvQmxvYlNpZGVjYXJzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZGF0YSwga3pnLCB0byB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGJsb2JzID0gcGFyYW1ldGVycy5ibG9icyA/PyB0b0Jsb2JzKHsgZGF0YSwgdG8gfSk7CiAgICBjb25zdCBjb21taXRtZW50cyA9IHBhcmFtZXRlcnMuY29tbWl0bWVudHMgPz8gYmxvYnNUb0NvbW1pdG1lbnRzKHsgYmxvYnMsIGt6ZywgdG8gfSk7CiAgICBjb25zdCBwcm9vZnMgPSBwYXJhbWV0ZXJzLnByb29mcyA/PyBibG9ic1RvUHJvb2ZzKHsgYmxvYnMsIGNvbW1pdG1lbnRzLCBremcsIHRvIH0pOwogICAgY29uc3Qgc2lkZWNhcnMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvYnMubGVuZ3RoOyBpKyspCiAgICAgIHNpZGVjYXJzLnB1c2goewogICAgICAgIGJsb2I6IGJsb2JzW2ldLAogICAgICAgIGNvbW1pdG1lbnQ6IGNvbW1pdG1lbnRzW2ldLAogICAgICAgIHByb29mOiBwcm9vZnNbaV0KICAgICAgfSk7CiAgICByZXR1cm4gc2lkZWNhcnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vZ2V0VHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uVHlwZSh0cmFuc2FjdGlvbikgewogICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbi50eXBlOwogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hdXRob3JpemF0aW9uTGlzdCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLmJsb2JzICE9PSAidW5kZWZpbmVkIiB8fCB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYlZlcnNpb25lZEhhc2hlcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiB0cmFuc2FjdGlvbi5zaWRlY2FycyAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiAiZWlwNDg0NCI7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyAhPT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikgewogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgfQogICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5nYXNQcmljZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgaWYgKHR5cGVvZiB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gImVpcDI5MzAiOwogICAgICByZXR1cm4gImxlZ2FjeSI7CiAgICB9CiAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6YWJsZVRyYW5zYWN0aW9uRXJyb3IoeyB0cmFuc2FjdGlvbiB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDaGFpbklkLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZChjbGllbnQpIHsKICAgIGNvbnN0IGNoYWluSWRIZXggPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9jaGFpbklkIgogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gaGV4VG9OdW1iZXIoY2hhaW5JZEhleCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdC5qcwogIHZhciBkZWZhdWx0UGFyYW1ldGVycyA9IFsKICAgICJibG9iVmVyc2lvbmVkSGFzaGVzIiwKICAgICJjaGFpbklkIiwKICAgICJmZWVzIiwKICAgICJnYXMiLAogICAgIm5vbmNlIiwKICAgICJ0eXBlIgogIF07CiAgYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpIHsKICAgIGNvbnN0IHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgYmxvYnMsIGNoYWluLCBnYXMsIGt6Zywgbm9uY2UsIG5vbmNlTWFuYWdlcjogbm9uY2VNYW5hZ2VyMiwgcGFyYW1ldGVycyA9IGRlZmF1bHRQYXJhbWV0ZXJzLCB0eXBlIH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IGFjY291bnRfOwogICAgY29uc3QgcmVxdWVzdCA9IHsgLi4uYXJncywgLi4uYWNjb3VudCA/IHsgZnJvbTogYWNjb3VudD8uYWRkcmVzcyB9IDoge30gfTsKICAgIGxldCBibG9jazsKICAgIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrMigpIHsKICAgICAgaWYgKGJsb2NrKQogICAgICAgIHJldHVybiBibG9jazsKICAgICAgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoeyBibG9ja1RhZzogImxhdGVzdCIgfSk7CiAgICAgIHJldHVybiBibG9jazsKICAgIH0KICAgIGxldCBjaGFpbklkOwogICAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhaW5JZDIoKSB7CiAgICAgIGlmIChjaGFpbklkKQogICAgICAgIHJldHVybiBjaGFpbklkOwogICAgICBpZiAoY2hhaW4pCiAgICAgICAgcmV0dXJuIGNoYWluLmlkOwogICAgICBpZiAodHlwZW9mIGFyZ3MuY2hhaW5JZCAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIGFyZ3MuY2hhaW5JZDsKICAgICAgY29uc3QgY2hhaW5JZF8gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRDaGFpbklkLCAiZ2V0Q2hhaW5JZCIpKHt9KTsKICAgICAgY2hhaW5JZCA9IGNoYWluSWRfOwogICAgICByZXR1cm4gY2hhaW5JZDsKICAgIH0KICAgIGlmICgocGFyYW1ldGVycy5pbmNsdWRlcygiYmxvYlZlcnNpb25lZEhhc2hlcyIpIHx8IHBhcmFtZXRlcnMuaW5jbHVkZXMoInNpZGVjYXJzIikpICYmIGJsb2JzICYmIGt6ZykgewogICAgICBjb25zdCBjb21taXRtZW50cyA9IGJsb2JzVG9Db21taXRtZW50cyh7IGJsb2JzLCBremcgfSk7CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJibG9iVmVyc2lvbmVkSGFzaGVzIikpIHsKICAgICAgICBjb25zdCB2ZXJzaW9uZWRIYXNoZXMgPSBjb21taXRtZW50c1RvVmVyc2lvbmVkSGFzaGVzKHsKICAgICAgICAgIGNvbW1pdG1lbnRzLAogICAgICAgICAgdG86ICJoZXgiCiAgICAgICAgfSk7CiAgICAgICAgcmVxdWVzdC5ibG9iVmVyc2lvbmVkSGFzaGVzID0gdmVyc2lvbmVkSGFzaGVzOwogICAgICB9CiAgICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJzaWRlY2FycyIpKSB7CiAgICAgICAgY29uc3QgcHJvb2ZzID0gYmxvYnNUb1Byb29mcyh7IGJsb2JzLCBjb21taXRtZW50cywga3pnIH0pOwogICAgICAgIGNvbnN0IHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoewogICAgICAgICAgYmxvYnMsCiAgICAgICAgICBjb21taXRtZW50cywKICAgICAgICAgIHByb29mcywKICAgICAgICAgIHRvOiAiaGV4IgogICAgICAgIH0pOwogICAgICAgIHJlcXVlc3Quc2lkZWNhcnMgPSBzaWRlY2FyczsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImNoYWluSWQiKSkKICAgICAgcmVxdWVzdC5jaGFpbklkID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgIGlmIChwYXJhbWV0ZXJzLmluY2x1ZGVzKCJub25jZSIpICYmIHR5cGVvZiBub25jZSA9PT0gInVuZGVmaW5lZCIgJiYgYWNjb3VudCkgewogICAgICBpZiAobm9uY2VNYW5hZ2VyMikgewogICAgICAgIGNvbnN0IGNoYWluSWQyID0gYXdhaXQgZ2V0Q2hhaW5JZDIoKTsKICAgICAgICByZXF1ZXN0Lm5vbmNlID0gYXdhaXQgbm9uY2VNYW5hZ2VyMi5jb25zdW1lKHsKICAgICAgICAgIGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywKICAgICAgICAgIGNoYWluSWQ6IGNoYWluSWQyLAogICAgICAgICAgY2xpZW50CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVxdWVzdC5ub25jZSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uQ291bnQsICJnZXRUcmFuc2FjdGlvbkNvdW50IikoewogICAgICAgICAgYWRkcmVzczogYWNjb3VudC5hZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBpZiAoKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSB8fCBwYXJhbWV0ZXJzLmluY2x1ZGVzKCJ0eXBlIikpICYmIHR5cGVvZiB0eXBlID09PSAidW5kZWZpbmVkIikgewogICAgICB0cnkgewogICAgICAgIHJlcXVlc3QudHlwZSA9IGdldFRyYW5zYWN0aW9uVHlwZShyZXF1ZXN0KTsKICAgICAgfSBjYXRjaCB7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgcmVxdWVzdC50eXBlID0gdHlwZW9mIGJsb2NrMj8uYmFzZUZlZVBlckdhcyA9PT0gImJpZ2ludCIgPyAiZWlwMTU1OSIgOiAibGVnYWN5IjsKICAgICAgfQogICAgfQogICAgaWYgKHBhcmFtZXRlcnMuaW5jbHVkZXMoImZlZXMiKSkgewogICAgICBpZiAocmVxdWVzdC50eXBlICE9PSAibGVnYWN5IiAmJiByZXF1ZXN0LnR5cGUgIT09ICJlaXAyOTMwIikgewogICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiByZXF1ZXN0Lm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgICBjb25zdCB7IG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSA9IGF3YWl0IGludGVybmFsX2VzdGltYXRlRmVlc1BlckdhcyhjbGllbnQsIHsKICAgICAgICAgICAgYmxvY2s6IGJsb2NrMiwKICAgICAgICAgICAgY2hhaW4sCiAgICAgICAgICAgIHJlcXVlc3QKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzID09PSAidW5kZWZpbmVkIiAmJiBhcmdzLm1heEZlZVBlckdhcyAmJiBhcmdzLm1heEZlZVBlckdhcyA8IG1heFByaW9yaXR5RmVlUGVyR2FzKQogICAgICAgICAgICB0aHJvdyBuZXcgTWF4RmVlUGVyR2FzVG9vTG93RXJyb3IoewogICAgICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgcmVxdWVzdC5tYXhQcmlvcml0eUZlZVBlckdhcyA9IG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICAgICAgcmVxdWVzdC5tYXhGZWVQZXJHYXMgPSBtYXhGZWVQZXJHYXM7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgYXJncy5tYXhGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiIHx8IHR5cGVvZiBhcmdzLm1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIikKICAgICAgICAgIHRocm93IG5ldyBFaXAxNTU5RmVlc05vdFN1cHBvcnRlZEVycm9yKCk7CiAgICAgICAgY29uc3QgYmxvY2syID0gYXdhaXQgZ2V0QmxvY2syKCk7CiAgICAgICAgY29uc3QgeyBnYXNQcmljZTogZ2FzUHJpY2VfIH0gPSBhd2FpdCBpbnRlcm5hbF9lc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCB7CiAgICAgICAgICBibG9jazogYmxvY2syLAogICAgICAgICAgY2hhaW4sCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgdHlwZTogImxlZ2FjeSIKICAgICAgICB9KTsKICAgICAgICByZXF1ZXN0Lmdhc1ByaWNlID0gZ2FzUHJpY2VfOwogICAgICB9CiAgICB9CiAgICBpZiAocGFyYW1ldGVycy5pbmNsdWRlcygiZ2FzIikgJiYgdHlwZW9mIGdhcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJlcXVlc3QuZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICAuLi5yZXF1ZXN0LAogICAgICAgIGFjY291bnQ6IGFjY291bnQgPyB7IGFkZHJlc3M6IGFjY291bnQuYWRkcmVzcywgdHlwZTogImpzb24tcnBjIiB9IDogYWNjb3VudAogICAgICB9KTsKICAgIGFzc2VydFJlcXVlc3QocmVxdWVzdCk7CiAgICBkZWxldGUgcmVxdWVzdC5wYXJhbWV0ZXJzOwogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmFsYW5jZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0IiB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEJhbGFuY2UiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYWxhbmNlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUdhcy5qcwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlR2FzKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50IH0gPSBhcmdzOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IHZvaWQgMDsKICAgIHRyeSB7CiAgICAgIGxldCBlc3RpbWF0ZUdhc19ycGMgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBibG9jazogYmxvY2syLCByZXF1ZXN0OiByZXF1ZXN0MiwgcnBjU3RhdGVPdmVycmlkZTogcnBjU3RhdGVPdmVycmlkZTIgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgIG1ldGhvZDogImV0aF9lc3RpbWF0ZUdhcyIsCiAgICAgICAgICBwYXJhbXM6IHJwY1N0YXRlT3ZlcnJpZGUyID8gW3JlcXVlc3QyLCBibG9jazIgPz8gImxhdGVzdCIsIHJwY1N0YXRlT3ZlcnJpZGUyXSA6IGJsb2NrMiA/IFtyZXF1ZXN0MiwgYmxvY2syXSA6IFtyZXF1ZXN0Ml0KICAgICAgICB9KTsKICAgICAgfTsKICAgICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBhdXRob3JpemF0aW9uTGlzdCwgYmxvYnMsIGJsb2JWZXJzaW9uZWRIYXNoZXMsIGJsb2NrTnVtYmVyLCBibG9ja1RhZywgZGF0YSwgZ2FzLCBnYXNQcmljZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbm9uY2UsIHZhbHVlLCBzdGF0ZU92ZXJyaWRlLCAuLi5yZXN0IH0gPSBhd2FpdCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0KGNsaWVudCwgewogICAgICAgIC4uLmFyZ3MsCiAgICAgICAgcGFyYW1ldGVyczogKAogICAgICAgICAgLy8gU29tZSBSUEMgUHJvdmlkZXJzIGRvIG5vdCBjb21wdXRlIHZlcnNpb25lZCBoYXNoZXMgZnJvbSBibG9icy4gV2Ugd2lsbCBuZWVkCiAgICAgICAgICAvLyB0byBjb21wdXRlIHRoZW0uCiAgICAgICAgICBhY2NvdW50Py50eXBlID09PSAibG9jYWwiID8gdm9pZCAwIDogWyJibG9iVmVyc2lvbmVkSGFzaGVzIl0KICAgICAgICApCiAgICAgIH0pOwogICAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgICBjb25zdCBibG9jayA9IGJsb2NrTnVtYmVySGV4IHx8IGJsb2NrVGFnOwogICAgICBjb25zdCBycGNTdGF0ZU92ZXJyaWRlID0gc2VyaWFsaXplU3RhdGVPdmVycmlkZShzdGF0ZU92ZXJyaWRlKTsKICAgICAgY29uc3QgdG8gPSBhd2FpdCAoYXN5bmMgKCkgPT4gewogICAgICAgIGlmIChyZXN0LnRvKQogICAgICAgICAgcmV0dXJuIHJlc3QudG87CiAgICAgICAgaWYgKGF1dGhvcml6YXRpb25MaXN0ICYmIGF1dGhvcml6YXRpb25MaXN0Lmxlbmd0aCA+IDApCiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVjb3ZlckF1dGhvcml6YXRpb25BZGRyZXNzKHsKICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYXV0aG9yaXphdGlvbkxpc3RbMF0KICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImB0b2AgaXMgcmVxdWlyZWQuIENvdWxkIG5vdCBpbmZlciBmcm9tIGBhdXRob3JpemF0aW9uTGlzdGAiKTsKICAgICAgICAgIH0pOwogICAgICAgIHJldHVybiB2b2lkIDA7CiAgICAgIH0pKCk7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGNoYWluRm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdDsKICAgICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAvLyBQaWNrIG91dCBleHRyYSBkYXRhIHRoYXQgbWlnaHQgZXhpc3Qgb24gdGhlIGNoYWluJ3MgdHJhbnNhY3Rpb24gcmVxdWVzdCB0eXBlLgogICAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICBibG9icywKICAgICAgICBibG9iVmVyc2lvbmVkSGFzaGVzLAogICAgICAgIGRhdGEsCiAgICAgICAgZ2FzLAogICAgICAgIGdhc1ByaWNlLAogICAgICAgIG1heEZlZVBlckJsb2JHYXMsCiAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgIG5vbmNlLAogICAgICAgIHRvLAogICAgICAgIHZhbHVlCiAgICAgIH0pOwogICAgICBsZXQgZXN0aW1hdGUgPSBCaWdJbnQoYXdhaXQgZXN0aW1hdGVHYXNfcnBjKHsgYmxvY2ssIHJlcXVlc3QsIHJwY1N0YXRlT3ZlcnJpZGUgfSkpOwogICAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgICBjb25zdCB2YWx1ZTIgPSBhd2FpdCBnZXRCYWxhbmNlKGNsaWVudCwgeyBhZGRyZXNzOiByZXF1ZXN0LmZyb20gfSk7CiAgICAgICAgY29uc3QgZXN0aW1hdGVzID0gYXdhaXQgUHJvbWlzZS5hbGwoYXV0aG9yaXphdGlvbkxpc3QubWFwKGFzeW5jIChhdXRob3JpemF0aW9uKSA9PiB7CiAgICAgICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcyB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgICAgIGNvbnN0IGVzdGltYXRlMiA9IGF3YWl0IGVzdGltYXRlR2FzX3JwYyh7CiAgICAgICAgICAgIGJsb2NrLAogICAgICAgICAgICByZXF1ZXN0OiB7CiAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3Q6IHZvaWQgMCwKICAgICAgICAgICAgICBkYXRhLAogICAgICAgICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgICAgICAgdG86IGNvbnRyYWN0QWRkcmVzcywKICAgICAgICAgICAgICB2YWx1ZTogbnVtYmVyVG9IZXgodmFsdWUyKQogICAgICAgICAgICB9LAogICAgICAgICAgICBycGNTdGF0ZU92ZXJyaWRlCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiAxMDAwMDBuKTsKICAgICAgICAgIHJldHVybiAybiAqIEJpZ0ludChlc3RpbWF0ZTIpOwogICAgICAgIH0pKTsKICAgICAgICBlc3RpbWF0ZSArPSBlc3RpbWF0ZXMucmVkdWNlKChhY2MsIGN1cnIpID0+IGFjYyArIGN1cnIsIDBuKTsKICAgICAgfQogICAgICByZXR1cm4gZXN0aW1hdGU7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgdGhyb3cgZ2V0RXN0aW1hdGVHYXNFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9lc3RpbWF0ZUNvbnRyYWN0R2FzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZXN0aW1hdGVDb250cmFjdEdhcyhjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgY29uc3QgZ2FzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZXN0aW1hdGVHYXMsICJlc3RpbWF0ZUdhcyIpKHsKICAgICAgICBkYXRhLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLnJlcXVlc3QKICAgICAgfSk7CiAgICAgIHJldHVybiBnYXM7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBjb25zdCBhY2NvdW50ID0gcmVxdWVzdC5hY2NvdW50ID8gcGFyc2VBY2NvdW50KHJlcXVlc3QuYWNjb3VudCkgOiB2b2lkIDA7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvZXN0aW1hdGVDb250cmFjdEdhcyIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGluaXRfZ2V0QWJpSXRlbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL3BhcnNlRXZlbnRMb2dzLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2RlY29kZUV2ZW50TG9nLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X3NpemUoKTsKICBpbml0X3RvRXZlbnRTZWxlY3RvcigpOwogIGluaXRfY3Vyc29yKCk7CiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9mb3JtYXRBYmlJdGVtMigpOwogIHZhciBkb2NzUGF0aDMgPSAiL2RvY3MvY29udHJhY3QvZGVjb2RlRXZlbnRMb2ciOwogIGZ1bmN0aW9uIGRlY29kZUV2ZW50TG9nKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBkYXRhLCBzdHJpY3Q6IHN0cmljdF8sIHRvcGljcyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gdHJ1ZTsKICAgIGNvbnN0IFtzaWduYXR1cmUsIC4uLmFyZ1RvcGljc10gPSB0b3BpY3M7CiAgICBpZiAoIXNpZ25hdHVyZSkKICAgICAgdGhyb3cgbmV3IEFiaUV2ZW50U2lnbmF0dXJlRW1wdHlUb3BpY3NFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCBhYmlJdGVtID0gKCgpID0+IHsKICAgICAgaWYgKGFiaTIubGVuZ3RoID09PSAxKQogICAgICAgIHJldHVybiBhYmkyWzBdOwogICAgICByZXR1cm4gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgc2lnbmF0dXJlID09PSB0b0V2ZW50U2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIH0pKCk7CiAgICBpZiAoIShhYmlJdGVtICYmICJuYW1lIiBpbiBhYmlJdGVtKSB8fCBhYmlJdGVtLnR5cGUgIT09ICJldmVudCIpCiAgICAgIHRocm93IG5ldyBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDMgfSk7CiAgICBjb25zdCB7IG5hbWUsIGlucHV0cyB9ID0gYWJpSXRlbTsKICAgIGNvbnN0IGlzVW5uYW1lZCA9IGlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgIGxldCBhcmdzID0gaXNVbm5hbWVkID8gW10gOiB7fTsKICAgIGNvbnN0IGluZGV4ZWRJbnB1dHMgPSBpbnB1dHMuZmlsdGVyKCh4KSA9PiAiaW5kZXhlZCIgaW4geCAmJiB4LmluZGV4ZWQpOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRleGVkSW5wdXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHBhcmFtID0gaW5kZXhlZElucHV0c1tpXTsKICAgICAgY29uc3QgdG9waWMgPSBhcmdUb3BpY3NbaV07CiAgICAgIGlmICghdG9waWMpCiAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ1RvcGljc01pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBwYXJhbQogICAgICAgIH0pOwogICAgICBhcmdzW2lzVW5uYW1lZCA/IGkgOiBwYXJhbS5uYW1lIHx8IGldID0gZGVjb2RlVG9waWMoeyBwYXJhbSwgdmFsdWU6IHRvcGljIH0pOwogICAgfQogICAgY29uc3Qgbm9uSW5kZXhlZElucHV0cyA9IGlucHV0cy5maWx0ZXIoKHgpID0+ICEoImluZGV4ZWQiIGluIHggJiYgeC5pbmRleGVkKSk7CiAgICBpZiAobm9uSW5kZXhlZElucHV0cy5sZW5ndGggPiAwKSB7CiAgICAgIGlmIChkYXRhICYmIGRhdGEgIT09ICIweCIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgZGVjb2RlZERhdGEgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKG5vbkluZGV4ZWRJbnB1dHMsIGRhdGEpOwogICAgICAgICAgaWYgKGRlY29kZWREYXRhKSB7CiAgICAgICAgICAgIGlmIChpc1VubmFtZWQpCiAgICAgICAgICAgICAgYXJncyA9IFsuLi5hcmdzLCAuLi5kZWNvZGVkRGF0YV07CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9uSW5kZXhlZElucHV0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYXJnc1tub25JbmRleGVkSW5wdXRzW2ldLm5hbWVdID0gZGVjb2RlZERhdGFbaV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KSB7CiAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlEZWNvZGluZ0RhdGFTaXplVG9vU21hbGxFcnJvciB8fCBlcnIgaW5zdGFuY2VvZiBQb3NpdGlvbk91dE9mQm91bmRzRXJyb3IpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IERlY29kZUxvZ0RhdGFNaXNtYXRjaCh7CiAgICAgICAgICAgICAgICBhYmlJdGVtLAogICAgICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgICAgIHBhcmFtczogbm9uSW5kZXhlZElucHV0cywKICAgICAgICAgICAgICAgIHNpemU6IHNpemUoZGF0YSkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdHJpY3QpIHsKICAgICAgICB0aHJvdyBuZXcgRGVjb2RlTG9nRGF0YU1pc21hdGNoKHsKICAgICAgICAgIGFiaUl0ZW0sCiAgICAgICAgICBkYXRhOiAiMHgiLAogICAgICAgICAgcGFyYW1zOiBub25JbmRleGVkSW5wdXRzLAogICAgICAgICAgc2l6ZTogMAogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICBldmVudE5hbWU6IG5hbWUsCiAgICAgIGFyZ3M6IE9iamVjdC52YWx1ZXMoYXJncykubGVuZ3RoID4gMCA/IGFyZ3MgOiB2b2lkIDAKICAgIH07CiAgfQogIGZ1bmN0aW9uIGRlY29kZVRvcGljKHsgcGFyYW0sIHZhbHVlIH0pIHsKICAgIGlmIChwYXJhbS50eXBlID09PSAic3RyaW5nIiB8fCBwYXJhbS50eXBlID09PSAiYnl0ZXMiIHx8IHBhcmFtLnR5cGUgPT09ICJ0dXBsZSIgfHwgcGFyYW0udHlwZS5tYXRjaCgvXiguKilcWyhcZCspP1xdJC8pKQogICAgICByZXR1cm4gdmFsdWU7CiAgICBjb25zdCBkZWNvZGVkQXJnID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbcGFyYW1dLCB2YWx1ZSkgfHwgW107CiAgICByZXR1cm4gZGVjb2RlZEFyZ1swXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvcGFyc2VFdmVudExvZ3MuanMKICBmdW5jdGlvbiBwYXJzZUV2ZW50TG9ncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgYXJncywgbG9ncywgc3RyaWN0ID0gdHJ1ZSB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50TmFtZSA9ICgoKSA9PiB7CiAgICAgIGlmICghcGFyYW1ldGVycy5ldmVudE5hbWUpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1ldGVycy5ldmVudE5hbWUpKQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLmV2ZW50TmFtZTsKICAgICAgcmV0dXJuIFtwYXJhbWV0ZXJzLmV2ZW50TmFtZV07CiAgICB9KSgpOwogICAgcmV0dXJuIGxvZ3MubWFwKChsb2cpID0+IHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBhYmlJdGVtID0gYWJpMi5maW5kKChhYmlJdGVtMikgPT4gYWJpSXRlbTIudHlwZSA9PT0gImV2ZW50IiAmJiBsb2cudG9waWNzWzBdID09PSB0b0V2ZW50U2VsZWN0b3IoYWJpSXRlbTIpKTsKICAgICAgICBpZiAoIWFiaUl0ZW0pCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBjb25zdCBldmVudCA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgIC4uLmxvZywKICAgICAgICAgIGFiaTogW2FiaUl0ZW1dLAogICAgICAgICAgc3RyaWN0CiAgICAgICAgfSk7CiAgICAgICAgaWYgKGV2ZW50TmFtZSAmJiAhZXZlbnROYW1lLmluY2x1ZGVzKGV2ZW50LmV2ZW50TmFtZSkpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoIWluY2x1ZGVzQXJncyh7CiAgICAgICAgICBhcmdzOiBldmVudC5hcmdzLAogICAgICAgICAgaW5wdXRzOiBhYmlJdGVtLmlucHV0cywKICAgICAgICAgIG1hdGNoQXJnczogYXJncwogICAgICAgIH0pKQogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHsgLi4uZXZlbnQsIC4uLmxvZyB9OwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBsZXQgZXZlbnROYW1lMjsKICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBYmlFdmVudFNpZ25hdHVyZU5vdEZvdW5kRXJyb3IpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nRGF0YU1pc21hdGNoIHx8IGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ1RvcGljc01pc21hdGNoKSB7CiAgICAgICAgICBpZiAoc3RyaWN0KQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIGV2ZW50TmFtZTIgPSBlcnIuYWJpSXRlbS5uYW1lOwogICAgICAgICAgaXNVbm5hbWVkID0gZXJyLmFiaUl0ZW0uaW5wdXRzPy5zb21lKCh4KSA9PiAhKCJuYW1lIiBpbiB4ICYmIHgubmFtZSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4geyAuLi5sb2csIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sIGV2ZW50TmFtZTogZXZlbnROYW1lMiB9OwogICAgICB9CiAgICB9KS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGluY2x1ZGVzQXJncyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFyZ3MsIGlucHV0cywgbWF0Y2hBcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKCFtYXRjaEFyZ3MpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKCFhcmdzKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBmdW5jdGlvbiBpc0VxdWFsKGlucHV0LCB2YWx1ZSwgYXJnKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09ICJhZGRyZXNzIikKICAgICAgICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbCh2YWx1ZSwgYXJnKTsKICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gInN0cmluZyIgfHwgaW5wdXQudHlwZSA9PT0gImJ5dGVzIikKICAgICAgICAgIHJldHVybiBrZWNjYWsyNTYodG9CeXRlcyh2YWx1ZSkpID09PSBhcmc7CiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBhcmc7CiAgICAgIH0gY2F0Y2ggewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogICAgaWYgKEFycmF5LmlzQXJyYXkoYXJncykgJiYgQXJyYXkuaXNBcnJheShtYXRjaEFyZ3MpKSB7CiAgICAgIHJldHVybiBtYXRjaEFyZ3MuZXZlcnkoKHZhbHVlLCBpbmRleDIpID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzW2luZGV4Ml07CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2luZGV4Ml0pKTsKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZW9mIGFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KGFyZ3MpICYmIHR5cGVvZiBtYXRjaEFyZ3MgPT09ICJvYmplY3QiICYmICFBcnJheS5pc0FycmF5KG1hdGNoQXJncykpCiAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhtYXRjaEFyZ3MpLmV2ZXJ5KChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCkKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzLmZpbmQoKGlucHV0MikgPT4gaW5wdXQyLm5hbWUgPT09IGtleSk7CiAgICAgICAgaWYgKCFpbnB1dCkKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBjb25zdCB2YWx1ZV8gPSBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTsKICAgICAgICByZXR1cm4gdmFsdWVfLnNvbWUoKHZhbHVlMikgPT4gaXNFcXVhbChpbnB1dCwgdmFsdWUyLCBhcmdzW2tleV0pKTsKICAgICAgfSk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0TG9ncy5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Zvcm1hdHRlcnMvbG9nLmpzCiAgZnVuY3Rpb24gZm9ybWF0TG9nKGxvZywgeyBhcmdzLCBldmVudE5hbWUgfSA9IHt9KSB7CiAgICByZXR1cm4gewogICAgICAuLi5sb2csCiAgICAgIGJsb2NrSGFzaDogbG9nLmJsb2NrSGFzaCA/IGxvZy5ibG9ja0hhc2ggOiBudWxsLAogICAgICBibG9ja051bWJlcjogbG9nLmJsb2NrTnVtYmVyID8gQmlnSW50KGxvZy5ibG9ja051bWJlcikgOiBudWxsLAogICAgICBsb2dJbmRleDogbG9nLmxvZ0luZGV4ID8gTnVtYmVyKGxvZy5sb2dJbmRleCkgOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkhhc2g6IGxvZy50cmFuc2FjdGlvbkhhc2ggPyBsb2cudHJhbnNhY3Rpb25IYXNoIDogbnVsbCwKICAgICAgdHJhbnNhY3Rpb25JbmRleDogbG9nLnRyYW5zYWN0aW9uSW5kZXggPyBOdW1iZXIobG9nLnRyYW5zYWN0aW9uSW5kZXgpIDogbnVsbCwKICAgICAgLi4uZXZlbnROYW1lID8geyBhcmdzLCBldmVudE5hbWUgfSA6IHt9CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldExvZ3MuanMKICBhc3luYyBmdW5jdGlvbiBnZXRMb2dzKGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja0hhc2gsIGZyb21CbG9jaywgdG9CbG9jaywgZXZlbnQsIGV2ZW50czogZXZlbnRzXywgYXJncywgc3RyaWN0OiBzdHJpY3RfIH0gPSB7fSkgewogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IGV2ZW50cyA9IGV2ZW50c18gPz8gKGV2ZW50ID8gW2V2ZW50XSA6IHZvaWQgMCk7CiAgICBsZXQgdG9waWNzID0gW107CiAgICBpZiAoZXZlbnRzKSB7CiAgICAgIGNvbnN0IGVuY29kZWQgPSBldmVudHMuZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgIGFyZ3M6IGV2ZW50c18gPyB2b2lkIDAgOiBhcmdzCiAgICAgIH0pKTsKICAgICAgdG9waWNzID0gW2VuY29kZWRdOwogICAgICBpZiAoZXZlbnQpCiAgICAgICAgdG9waWNzID0gdG9waWNzWzBdOwogICAgfQogICAgbGV0IGxvZ3M7CiAgICBpZiAoYmxvY2tIYXNoKSB7CiAgICAgIGxvZ3MgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldExvZ3MiLAogICAgICAgIHBhcmFtczogW3sgYWRkcmVzcywgdG9waWNzLCBibG9ja0hhc2ggfV0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBsb2dzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRMb2dzIiwKICAgICAgICBwYXJhbXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgdG9waWNzLAogICAgICAgICAgICBmcm9tQmxvY2s6IHR5cGVvZiBmcm9tQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgoZnJvbUJsb2NrKSA6IGZyb21CbG9jaywKICAgICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrCiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWV2ZW50cykKICAgICAgcmV0dXJuIGZvcm1hdHRlZExvZ3M7CiAgICByZXR1cm4gcGFyc2VFdmVudExvZ3MoewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgbG9nczogZm9ybWF0dGVkTG9ncywKICAgICAgc3RyaWN0CiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb250cmFjdEV2ZW50cy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJsb2NrSGFzaCwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIHRvQmxvY2ssIHN0cmljdCB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGV2ZW50ID0gZXZlbnROYW1lID8gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgbmFtZTogZXZlbnROYW1lIH0pIDogdm9pZCAwOwogICAgY29uc3QgZXZlbnRzID0gIWV2ZW50ID8gYWJpMi5maWx0ZXIoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IikgOiB2b2lkIDA7CiAgICByZXR1cm4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0TG9ncywgImdldExvZ3MiKSh7CiAgICAgIGFkZHJlc3MsCiAgICAgIGFyZ3MsCiAgICAgIGJsb2NrSGFzaCwKICAgICAgZXZlbnQsCiAgICAgIGV2ZW50cywKICAgICAgZnJvbUJsb2NrLAogICAgICB0b0Jsb2NrLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3JlYWRDb250cmFjdC5qcwogIGluaXRfZGVjb2RlRnVuY3Rpb25SZXN1bHQoKTsKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwogIGluaXRfY2FsbCgpOwogIGFzeW5jIGZ1bmN0aW9uIHJlYWRDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjYWxsZGF0YSA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgIGFiaTogYWJpMiwKICAgICAgYXJncywKICAgICAgZnVuY3Rpb25OYW1lCiAgICB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgLi4ucmVzdCwKICAgICAgICBkYXRhOiBjYWxsZGF0YSwKICAgICAgICB0bzogYWRkcmVzcwogICAgICB9KTsKICAgICAgcmV0dXJuIGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9yZWFkQ29udHJhY3QiLAogICAgICAgIGZ1bmN0aW9uTmFtZQogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9zaW11bGF0ZUNvbnRyYWN0LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2NhbGwoKTsKICBhc3luYyBmdW5jdGlvbiBzaW11bGF0ZUNvbnRyYWN0KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGRhdGFTdWZmaXgsIGZ1bmN0aW9uTmFtZSwgLi4uY2FsbFJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBhY2NvdW50ID0gY2FsbFJlcXVlc3QuYWNjb3VudCA/IHBhcnNlQWNjb3VudChjYWxsUmVxdWVzdC5hY2NvdW50KSA6IGNsaWVudC5hY2NvdW50OwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgY2FsbCwgImNhbGwiKSh7CiAgICAgICAgYmF0Y2g6IGZhbHNlLAogICAgICAgIGRhdGE6IGAke2NhbGxkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIC4uLmNhbGxSZXF1ZXN0LAogICAgICAgIGFjY291bnQKICAgICAgfSk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYXJncywKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YSB8fCAiMHgiCiAgICAgIH0pOwogICAgICBjb25zdCBtaW5pbWl6ZWRBYmkgPSBhYmkyLmZpbHRlcigoYWJpSXRlbSkgPT4gIm5hbWUiIGluIGFiaUl0ZW0gJiYgYWJpSXRlbS5uYW1lID09PSBwYXJhbWV0ZXJzLmZ1bmN0aW9uTmFtZSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgcmVzdWx0LAogICAgICAgIHJlcXVlc3Q6IHsKICAgICAgICAgIGFiaTogbWluaW1pemVkQWJpLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkYXRhU3VmZml4LAogICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgLi4uY2FsbFJlcXVlc3QsCiAgICAgICAgICBhY2NvdW50CiAgICAgICAgfQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdGhyb3cgZ2V0Q29udHJhY3RFcnJvcihlcnJvciwgewogICAgICAgIGFiaTogYWJpMiwKICAgICAgICBhZGRyZXNzLAogICAgICAgIGFyZ3MsCiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9zaW11bGF0ZUNvbnRyYWN0IiwKICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgc2VuZGVyOiBhY2NvdW50Py5hZGRyZXNzCiAgICAgIH0pOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhdGNoQ29udHJhY3RFdmVudC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9ycGMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL29ic2VydmUuanMKICB2YXIgbGlzdGVuZXJzQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjbGVhbnVwQ2FjaGUgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpOwogIHZhciBjYWxsYmFja0NvdW50ID0gMDsKICBmdW5jdGlvbiBvYnNlcnZlKG9ic2VydmVySWQsIGNhbGxiYWNrcywgZm4pIHsKICAgIGNvbnN0IGNhbGxiYWNrSWQgPSArK2NhbGxiYWNrQ291bnQ7CiAgICBjb25zdCBnZXRMaXN0ZW5lcnMgPSAoKSA9PiBsaXN0ZW5lcnNDYWNoZS5nZXQob2JzZXJ2ZXJJZCkgfHwgW107CiAgICBjb25zdCB1bnN1YnNjcmliZSA9ICgpID0+IHsKICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICBsaXN0ZW5lcnNDYWNoZS5zZXQob2JzZXJ2ZXJJZCwgbGlzdGVuZXJzMi5maWx0ZXIoKGNiKSA9PiBjYi5pZCAhPT0gY2FsbGJhY2tJZCkpOwogICAgfTsKICAgIGNvbnN0IHVud2F0Y2ggPSAoKSA9PiB7CiAgICAgIGNvbnN0IGNsZWFudXAyID0gY2xlYW51cENhY2hlLmdldChvYnNlcnZlcklkKTsKICAgICAgaWYgKGdldExpc3RlbmVycygpLmxlbmd0aCA9PT0gMSAmJiBjbGVhbnVwMikKICAgICAgICBjbGVhbnVwMigpOwogICAgICB1bnN1YnNjcmliZSgpOwogICAgfTsKICAgIGNvbnN0IGxpc3RlbmVycyA9IGdldExpc3RlbmVycygpOwogICAgbGlzdGVuZXJzQ2FjaGUuc2V0KG9ic2VydmVySWQsIFsKICAgICAgLi4ubGlzdGVuZXJzLAogICAgICB7IGlkOiBjYWxsYmFja0lkLCBmbnM6IGNhbGxiYWNrcyB9CiAgICBdKTsKICAgIGlmIChsaXN0ZW5lcnMgJiYgbGlzdGVuZXJzLmxlbmd0aCA+IDApCiAgICAgIHJldHVybiB1bndhdGNoOwogICAgY29uc3QgZW1pdCA9IHt9OwogICAgZm9yIChjb25zdCBrZXkgaW4gY2FsbGJhY2tzKSB7CiAgICAgIGVtaXRba2V5XSA9ICguLi5hcmdzKSA9PiB7CiAgICAgICAgY29uc3QgbGlzdGVuZXJzMiA9IGdldExpc3RlbmVycygpOwogICAgICAgIGlmIChsaXN0ZW5lcnMyLmxlbmd0aCA9PT0gMCkKICAgICAgICAgIHJldHVybjsKICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVyczIpCiAgICAgICAgICBsaXN0ZW5lci5mbnNba2V5XT8uKC4uLmFyZ3MpOwogICAgICB9OwogICAgfQogICAgY29uc3QgY2xlYW51cCA9IGZuKGVtaXQpOwogICAgaWYgKHR5cGVvZiBjbGVhbnVwID09PSAiZnVuY3Rpb24iKQogICAgICBjbGVhbnVwQ2FjaGUuc2V0KG9ic2VydmVySWQsIGNsZWFudXApOwogICAgcmV0dXJuIHVud2F0Y2g7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvd2FpdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHdhaXQodGltZSkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXMpID0+IHNldFRpbWVvdXQocmVzLCB0aW1lKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcG9sbC5qcwogIGZ1bmN0aW9uIHBvbGwoZm4sIHsgZW1pdE9uQmVnaW4sIGluaXRpYWxXYWl0VGltZSwgaW50ZXJ2YWwgfSkgewogICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICBjb25zdCB1bndhdGNoID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICBjb25zdCB3YXRjaCA9IGFzeW5jICgpID0+IHsKICAgICAgbGV0IGRhdGEgPSB2b2lkIDA7CiAgICAgIGlmIChlbWl0T25CZWdpbikKICAgICAgICBkYXRhID0gYXdhaXQgZm4oeyB1bnBvbGw6IHVud2F0Y2ggfSk7CiAgICAgIGNvbnN0IGluaXRpYWxXYWl0ID0gYXdhaXQgaW5pdGlhbFdhaXRUaW1lPy4oZGF0YSkgPz8gaW50ZXJ2YWw7CiAgICAgIGF3YWl0IHdhaXQoaW5pdGlhbFdhaXQpOwogICAgICBjb25zdCBwb2xsMiA9IGFzeW5jICgpID0+IHsKICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgIHJldHVybjsKICAgICAgICBhd2FpdCBmbih7IHVucG9sbDogdW53YXRjaCB9KTsKICAgICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgICBwb2xsMigpOwogICAgICB9OwogICAgICBwb2xsMigpOwogICAgfTsKICAgIHdhdGNoKCk7CiAgICByZXR1cm4gdW53YXRjaDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaENvbnRyYWN0RXZlbnQuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoQ2FjaGUuanMKICB2YXIgcHJvbWlzZUNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICB2YXIgcmVzcG9uc2VDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgZnVuY3Rpb24gZ2V0Q2FjaGUoY2FjaGVLZXkyKSB7CiAgICBjb25zdCBidWlsZENhY2hlID0gKGNhY2hlS2V5MywgY2FjaGUpID0+ICh7CiAgICAgIGNsZWFyOiAoKSA9PiBjYWNoZS5kZWxldGUoY2FjaGVLZXkzKSwKICAgICAgZ2V0OiAoKSA9PiBjYWNoZS5nZXQoY2FjaGVLZXkzKSwKICAgICAgc2V0OiAoZGF0YSkgPT4gY2FjaGUuc2V0KGNhY2hlS2V5MywgZGF0YSkKICAgIH0pOwogICAgY29uc3QgcHJvbWlzZSA9IGJ1aWxkQ2FjaGUoY2FjaGVLZXkyLCBwcm9taXNlQ2FjaGUpOwogICAgY29uc3QgcmVzcG9uc2UgPSBidWlsZENhY2hlKGNhY2hlS2V5MiwgcmVzcG9uc2VDYWNoZSk7CiAgICByZXR1cm4gewogICAgICBjbGVhcjogKCkgPT4gewogICAgICAgIHByb21pc2UuY2xlYXIoKTsKICAgICAgICByZXNwb25zZS5jbGVhcigpOwogICAgICB9LAogICAgICBwcm9taXNlLAogICAgICByZXNwb25zZQogICAgfTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gd2l0aENhY2hlKGZuLCB7IGNhY2hlS2V5OiBjYWNoZUtleTIsIGNhY2hlVGltZSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB9KSB7CiAgICBjb25zdCBjYWNoZSA9IGdldENhY2hlKGNhY2hlS2V5Mik7CiAgICBjb25zdCByZXNwb25zZSA9IGNhY2hlLnJlc3BvbnNlLmdldCgpOwogICAgaWYgKHJlc3BvbnNlICYmIGNhY2hlVGltZSA+IDApIHsKICAgICAgY29uc3QgYWdlID0gKC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSByZXNwb25zZS5jcmVhdGVkLmdldFRpbWUoKTsKICAgICAgaWYgKGFnZSA8IGNhY2hlVGltZSkKICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgIH0KICAgIGxldCBwcm9taXNlID0gY2FjaGUucHJvbWlzZS5nZXQoKTsKICAgIGlmICghcHJvbWlzZSkgewogICAgICBwcm9taXNlID0gZm4oKTsKICAgICAgY2FjaGUucHJvbWlzZS5zZXQocHJvbWlzZSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBkYXRhID0gYXdhaXQgcHJvbWlzZTsKICAgICAgY2FjaGUucmVzcG9uc2Uuc2V0KHsgY3JlYXRlZDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIGRhdGEgfSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSBmaW5hbGx5IHsKICAgICAgY2FjaGUucHJvbWlzZS5jbGVhcigpOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEJsb2NrTnVtYmVyLmpzCiAgdmFyIGNhY2hlS2V5ID0gKGlkKSA9PiBgYmxvY2tOdW1iZXIuJHtpZH1gOwogIGFzeW5jIGZ1bmN0aW9uIGdldEJsb2NrTnVtYmVyKGNsaWVudCwgeyBjYWNoZVRpbWUgPSBjbGllbnQuY2FjaGVUaW1lIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBhd2FpdCB3aXRoQ2FjaGUoKCkgPT4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfYmxvY2tOdW1iZXIiCiAgICB9KSwgeyBjYWNoZUtleTogY2FjaGVLZXkoY2xpZW50LnVpZCksIGNhY2hlVGltZSB9KTsKICAgIHJldHVybiBCaWdJbnQoYmxvY2tOdW1iZXJIZXgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZpbHRlckNoYW5nZXMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRGaWx0ZXJDaGFuZ2VzKF9jbGllbnQsIHsgZmlsdGVyIH0pIHsKICAgIGNvbnN0IHN0cmljdCA9ICJzdHJpY3QiIGluIGZpbHRlciAmJiBmaWx0ZXIuc3RyaWN0OwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckNoYW5nZXMiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGlmICh0eXBlb2YgbG9nc1swXSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBsb2dzOwogICAgY29uc3QgZm9ybWF0dGVkTG9ncyA9IGxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKTsKICAgIGlmICghKCJhYmkiIGluIGZpbHRlcikgfHwgIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3VuaW5zdGFsbEZpbHRlci5qcwogIGFzeW5jIGZ1bmN0aW9uIHVuaW5zdGFsbEZpbHRlcihfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICByZXR1cm4gZmlsdGVyLnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfdW5pbnN0YWxsRmlsdGVyIiwKICAgICAgcGFyYW1zOiBbZmlsdGVyLmlkXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hDb250cmFjdEV2ZW50LmpzCiAgZnVuY3Rpb24gd2F0Y2hDb250cmFjdEV2ZW50KGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGFyZ3MsIGJhdGNoID0gdHJ1ZSwgZXZlbnROYW1lLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGVuYWJsZVBvbGxpbmcgPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHBvbGxfICE9PSAidW5kZWZpbmVkIikKICAgICAgICByZXR1cm4gcG9sbF87CiAgICAgIGlmICh0eXBlb2YgZnJvbUJsb2NrID09PSAiYmlnaW50IikKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAiZmFsbGJhY2siICYmIGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0c1swXS5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0pKCk7CiAgICBjb25zdCBwb2xsQ29udHJhY3RFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQ29udHJhY3RFdmVudCIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGJhdGNoLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZXZlbnROYW1lLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBzdHJpY3QsCiAgICAgICAgZnJvbUJsb2NrCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uTG9ncywgb25FcnJvciB9LCAoZW1pdCkgPT4gewogICAgICAgIGxldCBwcmV2aW91c0Jsb2NrTnVtYmVyOwogICAgICAgIGlmIChmcm9tQmxvY2sgIT09IHZvaWQgMCkKICAgICAgICAgIHByZXZpb3VzQmxvY2tOdW1iZXIgPSBmcm9tQmxvY2sgLSAxbjsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGxldCBpbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmaWx0ZXIgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyLCAiY3JlYXRlQ29udHJhY3RFdmVudEZpbHRlciIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciA8IGJsb2NrTnVtYmVyKSB7CiAgICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICAgIGZyb21CbG9jazogcHJldmlvdXNCbG9ja051bWJlciArIDFuLAogICAgICAgICAgICAgICAgICB0b0Jsb2NrOiBibG9ja051bWJlciwKICAgICAgICAgICAgICAgICAgc3RyaWN0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUNvbnRyYWN0RXZlbnQgPSAoKSA9PiB7CiAgICAgIGNvbnN0IHN0cmljdCA9IHN0cmljdF8gPz8gZmFsc2U7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaENvbnRyYWN0RXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50TmFtZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgc3RyaWN0CiAgICAgIF0pOwogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgOwogICAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSAoKCkgPT4gewogICAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHMuZmluZCgodHJhbnNwb3J0MykgPT4gdHJhbnNwb3J0My5jb25maWcudHlwZSA9PT0gIndlYlNvY2tldCIpOwogICAgICAgICAgICAgICAgaWYgKCF0cmFuc3BvcnQyKQogICAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc3BvcnQyLnZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgY29uc3QgdG9waWNzID0gZXZlbnROYW1lID8gZW5jb2RlRXZlbnRUb3BpY3MoewogICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgYXJncwogICAgICAgICAgICB9KSA6IFtdOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJsb2dzIiwgeyBhZGRyZXNzLCB0b3BpY3MgfV0sCiAgICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBjb25zdCBsb2cgPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZXZlbnROYW1lOiBldmVudE5hbWUyLCBhcmdzOiBhcmdzMiB9ID0gZGVjb2RlRXZlbnRMb2coewogICAgICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgICB0b3BpY3M6IGxvZy50b3BpY3MsCiAgICAgICAgICAgICAgICAgICAgc3RyaWN0OiBzdHJpY3RfCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRMb2cobG9nLCB7CiAgICAgICAgICAgICAgICAgICAgYXJnczogYXJnczIsCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TmFtZTI7CiAgICAgICAgICAgICAgICAgIGxldCBpc1VubmFtZWQ7CiAgICAgICAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dEYXRhTWlzbWF0Y2ggfHwgZXJyIGluc3RhbmNlb2YgRGVjb2RlTG9nVG9waWNzTWlzbWF0Y2gpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBldmVudE5hbWUyID0gZXJyLmFiaUl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgICAgICBpc1VubmFtZWQgPSBlcnIuYWJpSXRlbS5pbnB1dHM/LnNvbWUoKHgpID0+ICEoIm5hbWUiIGluIHggJiYgeC5uYW1lKSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgewogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGlzVW5uYW1lZCA/IFtdIDoge30sCiAgICAgICAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudE5hbWUyCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBlbWl0Lm9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7CiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSkoKTsKICAgICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgICAgfSk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQ29udHJhY3RFdmVudCgpIDogc3Vic2NyaWJlQ29udHJhY3RFdmVudCgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2FjY291bnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgQWNjb3VudE5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5IH0gPSB7fSkgewogICAgICBzdXBlcihbCiAgICAgICAgIkNvdWxkIG5vdCBmaW5kIGFuIEFjY291bnQgdG8gZXhlY3V0ZSB3aXRoIHRoaXMgQWN0aW9uLiIsCiAgICAgICAgIlBsZWFzZSBwcm92aWRlIGFuIEFjY291bnQgd2l0aCB0aGUgYGFjY291bnRgIGFyZ3VtZW50IG9uIHRoZSBBY3Rpb24sIG9yIGJ5IHN1cHBseWluZyBhbiBgYWNjb3VudGAgdG8gdGhlIENsaWVudC4iCiAgICAgIF0uam9pbigiXG4iKSwgewogICAgICAgIGRvY3NQYXRoOiBkb2NzUGF0aDksCiAgICAgICAgZG9jc1NsdWc6ICJhY2NvdW50IiwKICAgICAgICBuYW1lOiAiQWNjb3VudE5vdEZvdW5kRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CiAgdmFyIEFjY291bnRUeXBlTm90U3VwcG9ydGVkRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBkb2NzUGF0aDogZG9jc1BhdGg5LCBtZXRhTWVzc2FnZXMsIHR5cGUgfSkgewogICAgICBzdXBlcihgQWNjb3VudCB0eXBlICIke3R5cGV9IiBpcyBub3Qgc3VwcG9ydGVkLmAsIHsKICAgICAgICBkb2NzUGF0aDogZG9jc1BhdGg5LAogICAgICAgIG1ldGFNZXNzYWdlcywKICAgICAgICBuYW1lOiAiQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dyaXRlQ29udHJhY3QuanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X2Jhc2UoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2Fzc2VydEN1cnJlbnRDaGFpbi5qcwogIGluaXRfY2hhaW4oKTsKICBmdW5jdGlvbiBhc3NlcnRDdXJyZW50Q2hhaW4oeyBjaGFpbiwgY3VycmVudENoYWluSWQgfSkgewogICAgaWYgKCFjaGFpbikKICAgICAgdGhyb3cgbmV3IENoYWluTm90Rm91bmRFcnJvcigpOwogICAgaWYgKGN1cnJlbnRDaGFpbklkICE9PSBjaGFpbi5pZCkKICAgICAgdGhyb3cgbmV3IENoYWluTWlzbWF0Y2hFcnJvcih7IGNoYWluLCBjdXJyZW50Q2hhaW5JZCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lcnJvcnMvZ2V0VHJhbnNhY3Rpb25FcnJvci5qcwogIGluaXRfbm9kZSgpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2dldE5vZGVFcnJvcigpOwogIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDksIC4uLmFyZ3MgfSkgewogICAgY29uc3QgY2F1c2UgPSAoKCkgPT4gewogICAgICBjb25zdCBjYXVzZTIgPSBnZXROb2RlRXJyb3IoZXJyLCBhcmdzKTsKICAgICAgaWYgKGNhdXNlMiBpbnN0YW5jZW9mIFVua25vd25Ob2RlRXJyb3IpCiAgICAgICAgcmV0dXJuIGVycjsKICAgICAgcmV0dXJuIGNhdXNlMjsKICAgIH0pKCk7CiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uRXhlY3V0aW9uRXJyb3IoY2F1c2UsIHsKICAgICAgZG9jc1BhdGg6IGRvY3NQYXRoOSwKICAgICAgLi4uYXJncwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFRyYW5zYWN0aW9uLmpzCiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2xydSgpOwogIGluaXRfYXNzZXJ0UmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2VuZFJhd1RyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2VuZFJhd1RyYW5zYWN0aW9uKGNsaWVudCwgeyBzZXJpYWxpemVkVHJhbnNhY3Rpb24gfSkgewogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NlbmRSYXdUcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbl0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zZW5kVHJhbnNhY3Rpb24uanMKICB2YXIgc3VwcG9ydHNXYWxsZXROYW1lc3BhY2UgPSBuZXcgTHJ1TWFwKDEyOCk7CiAgYXN5bmMgZnVuY3Rpb24gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBjaGFpbiA9IGNsaWVudC5jaGFpbiwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIGJsb2JzLCBkYXRhLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJCbG9iR2FzLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdmFsdWUsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudF8gPyBwYXJzZUFjY291bnQoYWNjb3VudF8pIDogbnVsbDsKICAgIHRyeSB7CiAgICAgIGFzc2VydFJlcXVlc3QocGFyYW1ldGVycyk7CiAgICAgIGNvbnN0IHRvID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgICBpZiAocGFyYW1ldGVycy50bykKICAgICAgICAgIHJldHVybiBwYXJhbWV0ZXJzLnRvOwogICAgICAgIGlmIChhdXRob3JpemF0aW9uTGlzdCAmJiBhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggPiAwKQogICAgICAgICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBdXRob3JpemF0aW9uQWRkcmVzcyh7CiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGF1dGhvcml6YXRpb25MaXN0WzBdCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgdG9gIGlzIHJlcXVpcmVkLiBDb3VsZCBub3QgaW5mZXIgZnJvbSBgYXV0aG9yaXphdGlvbkxpc3RgLiIpOwogICAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgfSkoKTsKICAgICAgaWYgKGFjY291bnQ/LnR5cGUgPT09ICJqc29uLXJwYyIgfHwgYWNjb3VudCA9PT0gbnVsbCkgewogICAgICAgIGxldCBjaGFpbklkOwogICAgICAgIGlmIChjaGFpbiAhPT0gbnVsbCkgewogICAgICAgICAgY2hhaW5JZCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldENoYWluSWQsICJnZXRDaGFpbklkIikoe30pOwogICAgICAgICAgYXNzZXJ0Q3VycmVudENoYWluKHsKICAgICAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgICAgIGNoYWluCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgICAgIGNvbnN0IGZvcm1hdCA9IGNoYWluRm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVxdWVzdDsKICAgICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgICAgICAuLi5leHRyYWN0KHJlc3QsIHsgZm9ybWF0OiBjaGFpbkZvcm1hdCB9KSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICBhdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAgIGJsb2JzLAogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBmcm9tOiBhY2NvdW50Py5hZGRyZXNzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgZ2FzUHJpY2UsCiAgICAgICAgICBtYXhGZWVQZXJCbG9iR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUKICAgICAgICB9KTsKICAgICAgICBjb25zdCBtZXRob2QgPSBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5nZXQoY2xpZW50LnVpZCkgPyAid2FsbGV0X3NlbmRUcmFuc2FjdGlvbiIgOiAiZXRoX3NlbmRUcmFuc2FjdGlvbiI7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgcGFyYW1zOiBbcmVxdWVzdF0KICAgICAgICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIkludmFsaWRJbnB1dFJwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiSW52YWxpZFBhcmFtc1JwY0Vycm9yIiB8fCBlcnJvci5uYW1lID09PSAiTWV0aG9kTm90Rm91bmRScGNFcnJvciIgfHwgZXJyb3IubmFtZSA9PT0gIk1ldGhvZE5vdFN1cHBvcnRlZFJwY0Vycm9yIikKICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBtZXRob2Q6ICJ3YWxsZXRfc2VuZFRyYW5zYWN0aW9uIiwKICAgICAgICAgICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgICAgICAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSkudGhlbigoaGFzaDMpID0+IHsKICAgICAgICAgICAgICBzdXBwb3J0c1dhbGxldE5hbWVzcGFjZS5zZXQoY2xpZW50LnVpZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmV0dXJuIGhhc2gzOwogICAgICAgICAgICB9KTsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gImxvY2FsIikgewogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0LCAicHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdCIpKHsKICAgICAgICAgIGFjY291bnQsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgYXV0aG9yaXphdGlvbkxpc3QsCiAgICAgICAgICBibG9icywKICAgICAgICAgIGNoYWluLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGdhcywKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgbWF4RmVlUGVyQmxvYkdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBub25jZU1hbmFnZXI6IGFjY291bnQubm9uY2VNYW5hZ2VyLAogICAgICAgICAgcGFyYW1ldGVyczogWy4uLmRlZmF1bHRQYXJhbWV0ZXJzLCAic2lkZWNhcnMiXSwKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgLi4ucmVzdCwKICAgICAgICAgIHRvCiAgICAgICAgfSk7CiAgICAgICAgY29uc3Qgc2VyaWFsaXplciA9IGNoYWluPy5zZXJpYWxpemVycz8udHJhbnNhY3Rpb247CiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gYXdhaXQgYWNjb3VudC5zaWduVHJhbnNhY3Rpb24ocmVxdWVzdCwgewogICAgICAgICAgc2VyaWFsaXplcgogICAgICAgIH0pOwogICAgICAgIHJldHVybiBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBzZW5kUmF3VHJhbnNhY3Rpb24sICJzZW5kUmF3VHJhbnNhY3Rpb24iKSh7CiAgICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoYWNjb3VudD8udHlwZSA9PT0gInNtYXJ0IikKICAgICAgICB0aHJvdyBuZXcgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcih7CiAgICAgICAgICBtZXRhTWVzc2FnZXM6IFsKICAgICAgICAgICAgIkNvbnNpZGVyIHVzaW5nIHRoZSBgc2VuZFVzZXJPcGVyYXRpb25gIEFjdGlvbiBpbnN0ZWFkLiIKICAgICAgICAgIF0sCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvYnVuZGxlci9zZW5kVXNlck9wZXJhdGlvbiIsCiAgICAgICAgICB0eXBlOiAic21hcnQiCiAgICAgICAgfSk7CiAgICAgIHRocm93IG5ldyBBY2NvdW50VHlwZU5vdFN1cHBvcnRlZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2FjdGlvbnMvd2FsbGV0L3NlbmRUcmFuc2FjdGlvbiIsCiAgICAgICAgdHlwZTogYWNjb3VudD8udHlwZQogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQWNjb3VudFR5cGVOb3RTdXBwb3J0ZWRFcnJvcikKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIHRocm93IGdldFRyYW5zYWN0aW9uRXJyb3IoZXJyLCB7CiAgICAgICAgLi4ucGFyYW1ldGVycywKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBwYXJhbWV0ZXJzLmNoYWluIHx8IHZvaWQgMAogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC93cml0ZUNvbnRyYWN0LmpzCiAgYXN5bmMgZnVuY3Rpb24gd3JpdGVDb250cmFjdChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhY2NvdW50OiBhY2NvdW50XyA9IGNsaWVudC5hY2NvdW50LCBhZGRyZXNzLCBhcmdzLCBkYXRhU3VmZml4LCBmdW5jdGlvbk5hbWUsIC4uLnJlcXVlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAodHlwZW9mIGFjY291bnRfID09PSAidW5kZWZpbmVkIikKICAgICAgdGhyb3cgbmV3IEFjY291bnROb3RGb3VuZEVycm9yKHsKICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L3dyaXRlQ29udHJhY3QiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRfID8gcGFyc2VBY2NvdW50KGFjY291bnRfKSA6IG51bGw7CiAgICBjb25zdCBkYXRhID0gZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgYWJpOiBhYmkyLAogICAgICBhcmdzLAogICAgICBmdW5jdGlvbk5hbWUKICAgIH0pOwogICAgdHJ5IHsKICAgICAgcmV0dXJuIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHNlbmRUcmFuc2FjdGlvbiwgInNlbmRUcmFuc2FjdGlvbiIpKHsKICAgICAgICBkYXRhOiBgJHtkYXRhfSR7ZGF0YVN1ZmZpeCA/IGRhdGFTdWZmaXgucmVwbGFjZSgiMHgiLCAiIikgOiAiIn1gLAogICAgICAgIHRvOiBhZGRyZXNzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgLi4ucmVxdWVzdAogICAgICB9KTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIHRocm93IGdldENvbnRyYWN0RXJyb3IoZXJyb3IsIHsKICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBhcmdzLAogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3Qvd3JpdGVDb250cmFjdCIsCiAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgIHNlbmRlcjogYWNjb3VudD8uYWRkcmVzcwogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2dldENvbnRyYWN0LmpzCiAgZnVuY3Rpb24gZ2V0Q29udHJhY3QoeyBhYmk6IGFiaTIsIGFkZHJlc3MsIGNsaWVudDogY2xpZW50XyB9KSB7CiAgICBjb25zdCBjbGllbnQgPSBjbGllbnRfOwogICAgY29uc3QgW3B1YmxpY0NsaWVudCwgd2FsbGV0Q2xpZW50XSA9ICgoKSA9PiB7CiAgICAgIGlmICghY2xpZW50KQogICAgICAgIHJldHVybiBbdm9pZCAwLCB2b2lkIDBdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50ICYmICJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW2NsaWVudC5wdWJsaWMsIGNsaWVudC53YWxsZXRdOwogICAgICBpZiAoInB1YmxpYyIgaW4gY2xpZW50KQogICAgICAgIHJldHVybiBbY2xpZW50LnB1YmxpYywgdm9pZCAwXTsKICAgICAgaWYgKCJ3YWxsZXQiIGluIGNsaWVudCkKICAgICAgICByZXR1cm4gW3ZvaWQgMCwgY2xpZW50LndhbGxldF07CiAgICAgIHJldHVybiBbY2xpZW50LCBjbGllbnRdOwogICAgfSkoKTsKICAgIGNvbnN0IGhhc1B1YmxpY0NsaWVudCA9IHB1YmxpY0NsaWVudCAhPT0gdm9pZCAwICYmIHB1YmxpY0NsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGhhc1dhbGxldENsaWVudCA9IHdhbGxldENsaWVudCAhPT0gdm9pZCAwICYmIHdhbGxldENsaWVudCAhPT0gbnVsbDsKICAgIGNvbnN0IGNvbnRyYWN0ID0ge307CiAgICBsZXQgaGFzUmVhZEZ1bmN0aW9uID0gZmFsc2U7CiAgICBsZXQgaGFzV3JpdGVGdW5jdGlvbiA9IGZhbHNlOwogICAgbGV0IGhhc0V2ZW50ID0gZmFsc2U7CiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgYWJpMikgewogICAgICBpZiAoaXRlbS50eXBlID09PSAiZnVuY3Rpb24iKQogICAgICAgIGlmIChpdGVtLnN0YXRlTXV0YWJpbGl0eSA9PT0gInZpZXciIHx8IGl0ZW0uc3RhdGVNdXRhYmlsaXR5ID09PSAicHVyZSIpCiAgICAgICAgICBoYXNSZWFkRnVuY3Rpb24gPSB0cnVlOwogICAgICAgIGVsc2UKICAgICAgICAgIGhhc1dyaXRlRnVuY3Rpb24gPSB0cnVlOwogICAgICBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICJldmVudCIpCiAgICAgICAgaGFzRXZlbnQgPSB0cnVlOwogICAgICBpZiAoaGFzUmVhZEZ1bmN0aW9uICYmIGhhc1dyaXRlRnVuY3Rpb24gJiYgaGFzRXZlbnQpCiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBpZiAoaGFzUHVibGljQ2xpZW50KSB7CiAgICAgIGlmIChoYXNSZWFkRnVuY3Rpb24pCiAgICAgICAgY29udHJhY3QucmVhZCA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0IikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGZ1bmN0aW9uTmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LnNpbXVsYXRlID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCBzaW11bGF0ZUNvbnRyYWN0LCAic2ltdWxhdGVDb250cmFjdCIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBmdW5jdGlvbk5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICBpZiAoaGFzRXZlbnQpIHsKICAgICAgICBjb250cmFjdC5jcmVhdGVFdmVudEZpbHRlciA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGV2ZW50TmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCBhYmlFdmVudCA9IGFiaTIuZmluZCgoeCkgPT4geC50eXBlID09PSAiZXZlbnQiICYmIHgubmFtZSA9PT0gZXZlbnROYW1lKTsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEV2ZW50UGFyYW1ldGVycyhwYXJhbWV0ZXJzLCBhYmlFdmVudCk7CiAgICAgICAgICAgICAgcmV0dXJuIGdldEFjdGlvbihwdWJsaWNDbGllbnQsIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXIsICJjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyIikoewogICAgICAgICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgIGV2ZW50TmFtZSwKICAgICAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgY29udHJhY3QuZ2V0RXZlbnRzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZXZlbnROYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IGFiaUV2ZW50ID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJldmVudCIgJiYgeC5uYW1lID09PSBldmVudE5hbWUpOwogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RXZlbnRQYXJhbWV0ZXJzKHBhcmFtZXRlcnMsIGFiaUV2ZW50KTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHB1YmxpY0NsaWVudCwgZ2V0Q29udHJhY3RFdmVudHMsICJnZXRDb250cmFjdEV2ZW50cyIpKHsKICAgICAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgICAgICBldmVudE5hbWUsCiAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGNvbnRyYWN0LndhdGNoRXZlbnQgPSBuZXcgUHJveHkoe30sIHsKICAgICAgICAgIGdldChfLCBldmVudE5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuICguLi5wYXJhbWV0ZXJzKSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgYWJpRXZlbnQgPSBhYmkyLmZpbmQoKHgpID0+IHgudHlwZSA9PT0gImV2ZW50IiAmJiB4Lm5hbWUgPT09IGV2ZW50TmFtZSk7CiAgICAgICAgICAgICAgY29uc3QgeyBhcmdzLCBvcHRpb25zIH0gPSBnZXRFdmVudFBhcmFtZXRlcnMocGFyYW1ldGVycywgYWJpRXZlbnQpOwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24ocHVibGljQ2xpZW50LCB3YXRjaENvbnRyYWN0RXZlbnQsICJ3YXRjaENvbnRyYWN0RXZlbnQiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZXZlbnROYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgaWYgKGhhc1dhbGxldENsaWVudCkgewogICAgICBpZiAoaGFzV3JpdGVGdW5jdGlvbikKICAgICAgICBjb250cmFjdC53cml0ZSA9IG5ldyBQcm94eSh7fSwgewogICAgICAgICAgZ2V0KF8sIGZ1bmN0aW9uTmFtZSkgewogICAgICAgICAgICByZXR1cm4gKC4uLnBhcmFtZXRlcnMpID0+IHsKICAgICAgICAgICAgICBjb25zdCB7IGFyZ3MsIG9wdGlvbnMgfSA9IGdldEZ1bmN0aW9uUGFyYW1ldGVycyhwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0QWN0aW9uKHdhbGxldENsaWVudCwgd3JpdGVDb250cmFjdCwgIndyaXRlQ29udHJhY3QiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGlmIChoYXNQdWJsaWNDbGllbnQgfHwgaGFzV2FsbGV0Q2xpZW50KSB7CiAgICAgIGlmIChoYXNXcml0ZUZ1bmN0aW9uKQogICAgICAgIGNvbnRyYWN0LmVzdGltYXRlR2FzID0gbmV3IFByb3h5KHt9LCB7CiAgICAgICAgICBnZXQoXywgZnVuY3Rpb25OYW1lKSB7CiAgICAgICAgICAgIHJldHVybiAoLi4ucGFyYW1ldGVycykgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsgYXJncywgb3B0aW9ucyB9ID0gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpOwogICAgICAgICAgICAgIGNvbnN0IGNsaWVudDIgPSBwdWJsaWNDbGllbnQgPz8gd2FsbGV0Q2xpZW50OwogICAgICAgICAgICAgIHJldHVybiBnZXRBY3Rpb24oY2xpZW50MiwgZXN0aW1hdGVDb250cmFjdEdhcywgImVzdGltYXRlQ29udHJhY3RHYXMiKSh7CiAgICAgICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsCiAgICAgICAgICAgICAgICBhY2NvdW50OiBvcHRpb25zLmFjY291bnQgPz8gd2FsbGV0Q2xpZW50LmFjY291bnQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KICAgIGNvbnRyYWN0LmFkZHJlc3MgPSBhZGRyZXNzOwogICAgY29udHJhY3QuYWJpID0gYWJpMjsKICAgIHJldHVybiBjb250cmFjdDsKICB9CiAgZnVuY3Rpb24gZ2V0RnVuY3Rpb25QYXJhbWV0ZXJzKHZhbHVlcykgewogICAgY29uc3QgaGFzQXJncyA9IHZhbHVlcy5sZW5ndGggJiYgQXJyYXkuaXNBcnJheSh2YWx1ZXNbMF0pOwogICAgY29uc3QgYXJncyA9IGhhc0FyZ3MgPyB2YWx1ZXNbMF0gOiBbXTsKICAgIGNvbnN0IG9wdGlvbnMgPSAoaGFzQXJncyA/IHZhbHVlc1sxXSA6IHZhbHVlc1swXSkgPz8ge307CiAgICByZXR1cm4geyBhcmdzLCBvcHRpb25zIH07CiAgfQogIGZ1bmN0aW9uIGdldEV2ZW50UGFyYW1ldGVycyh2YWx1ZXMsIGFiaUV2ZW50KSB7CiAgICBsZXQgaGFzQXJncyA9IGZhbHNlOwogICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzWzBdKSkKICAgICAgaGFzQXJncyA9IHRydWU7CiAgICBlbHNlIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxKSB7CiAgICAgIGhhc0FyZ3MgPSBhYmlFdmVudC5pbnB1dHMuc29tZSgoeCkgPT4geC5pbmRleGVkKTsKICAgIH0gZWxzZSBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMikgewogICAgICBoYXNBcmdzID0gdHJ1ZTsKICAgIH0KICAgIGNvbnN0IGFyZ3MgPSBoYXNBcmdzID8gdmFsdWVzWzBdIDogdm9pZCAwOwogICAgY29uc3Qgb3B0aW9ucyA9IChoYXNBcmdzID8gdmFsdWVzWzFdIDogdmFsdWVzWzBdKSA/PyB7fTsKICAgIHJldHVybiB7IGFyZ3MsIG9wdGlvbnMgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvZWlwNzEyLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBhZGRyZXNzIH0pIHsKICAgICAgc3VwZXIoYE5vIEVJUC03MTIgZG9tYWluIGZvdW5kIG9uIGNvbnRyYWN0ICIke2FkZHJlc3N9Ii5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiRW5zdXJlIHRoYXQ6IiwKICAgICAgICAgIGAtIFRoZSBjb250cmFjdCBpcyBkZXBsb3llZCBhdCB0aGUgYWRkcmVzcyAiJHthZGRyZXNzfSIuYCwKICAgICAgICAgICItIGBlaXA3MTJEb21haW4oKWAgZnVuY3Rpb24gZXhpc3RzIG9uIHRoZSBjb250cmFjdC4iLAogICAgICAgICAgIi0gYGVpcDcxMkRvbWFpbigpYCBmdW5jdGlvbiBtYXRjaGVzIHNpZ25hdHVyZSB0byBFUkMtNTI2NyBzcGVjaWZpY2F0aW9uLiIKICAgICAgICBdLAogICAgICAgIG5hbWU6ICJFaXA3MTJEb21haW5Ob3RGb3VuZEVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RWlwNzEyRG9tYWluKGNsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBmYWN0b3J5LCBmYWN0b3J5RGF0YSB9ID0gcGFyYW1ldGVyczsKICAgIHRyeSB7CiAgICAgIGNvbnN0IFtmaWVsZHMsIG5hbWUsIHZlcnNpb24zLCBjaGFpbklkLCB2ZXJpZnlpbmdDb250cmFjdCwgc2FsdCwgZXh0ZW5zaW9uc10gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgICAgYWJpLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgZnVuY3Rpb25OYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgICBmYWN0b3J5LAogICAgICAgIGZhY3RvcnlEYXRhCiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGRvbWFpbjogewogICAgICAgICAgbmFtZSwKICAgICAgICAgIHZlcnNpb246IHZlcnNpb24zLAogICAgICAgICAgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpLAogICAgICAgICAgdmVyaWZ5aW5nQ29udHJhY3QsCiAgICAgICAgICBzYWx0CiAgICAgICAgfSwKICAgICAgICBleHRlbnNpb25zLAogICAgICAgIGZpZWxkcwogICAgICB9OwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zdCBlcnJvciA9IGU7CiAgICAgIGlmIChlcnJvci5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvbkV4ZWN1dGlvbkVycm9yIiAmJiBlcnJvci5jYXVzZS5uYW1lID09PSAiQ29udHJhY3RGdW5jdGlvblplcm9EYXRhRXJyb3IiKSB7CiAgICAgICAgdGhyb3cgbmV3IEVpcDcxMkRvbWFpbk5vdEZvdW5kRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICB9CiAgICAgIHRocm93IGVycm9yOwogICAgfQogIH0KICB2YXIgYWJpID0gWwogICAgewogICAgICBpbnB1dHM6IFtdLAogICAgICBuYW1lOiAiZWlwNzEyRG9tYWluIiwKICAgICAgb3V0cHV0czogWwogICAgICAgIHsgbmFtZTogImZpZWxkcyIsIHR5cGU6ICJieXRlczEiIH0sCiAgICAgICAgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAidmVyc2lvbiIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgeyBuYW1lOiAiY2hhaW5JZCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgIHsgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwgdHlwZTogImFkZHJlc3MiIH0sCiAgICAgICAgeyBuYW1lOiAic2FsdCIsIHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIHsgbmFtZTogImV4dGVuc2lvbnMiLCB0eXBlOiAidWludDI1NltdIiB9CiAgICAgIF0sCiAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICB0eXBlOiAiZnVuY3Rpb24iCiAgICB9CiAgXTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L2FkZENoYWluLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGFkZENoYWluKGNsaWVudCwgeyBjaGFpbiB9KSB7CiAgICBjb25zdCB7IGlkLCBuYW1lLCBuYXRpdmVDdXJyZW5jeSwgcnBjVXJscywgYmxvY2tFeHBsb3JlcnMgfSA9IGNoYWluOwogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfYWRkRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKSwKICAgICAgICAgIGNoYWluTmFtZTogbmFtZSwKICAgICAgICAgIG5hdGl2ZUN1cnJlbmN5LAogICAgICAgICAgcnBjVXJsczogcnBjVXJscy5kZWZhdWx0Lmh0dHAsCiAgICAgICAgICBibG9ja0V4cGxvcmVyVXJsczogYmxvY2tFeHBsb3JlcnMgPyBPYmplY3QudmFsdWVzKGJsb2NrRXhwbG9yZXJzKS5tYXAoKHsgdXJsIH0pID0+IHVybCkgOiB2b2lkIDAKICAgICAgICB9CiAgICAgIF0KICAgIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3VpZC5qcwogIHZhciBzaXplMiA9IDI1NjsKICB2YXIgaW5kZXggPSBzaXplMjsKICB2YXIgYnVmZmVyOwogIGZ1bmN0aW9uIHVpZChsZW5ndGggPSAxMSkgewogICAgaWYgKCFidWZmZXIgfHwgaW5kZXggKyBsZW5ndGggPiBzaXplMiAqIDIpIHsKICAgICAgYnVmZmVyID0gIiI7CiAgICAgIGluZGV4ID0gMDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplMjsgaSsrKSB7CiAgICAgICAgYnVmZmVyICs9ICgyNTYgKyBNYXRoLnJhbmRvbSgpICogMjU2IHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGJ1ZmZlci5zdWJzdHJpbmcoaW5kZXgsIGluZGV4KysgKyBsZW5ndGgpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlQ2xpZW50LmpzCiAgZnVuY3Rpb24gY3JlYXRlQ2xpZW50KHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGNhY2hlVGltZSA9IHBhcmFtZXRlcnMucG9sbGluZ0ludGVydmFsID8/IDRlMywgY2NpcFJlYWQsIGtleSA9ICJiYXNlIiwgbmFtZSA9ICJCYXNlIENsaWVudCIsIHBvbGxpbmdJbnRlcnZhbCA9IDRlMywgdHlwZSA9ICJiYXNlIiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNoYWluID0gcGFyYW1ldGVycy5jaGFpbjsKICAgIGNvbnN0IGFjY291bnQgPSBwYXJhbWV0ZXJzLmFjY291bnQgPyBwYXJzZUFjY291bnQocGFyYW1ldGVycy5hY2NvdW50KSA6IHZvaWQgMDsKICAgIGNvbnN0IHsgY29uZmlnLCByZXF1ZXN0LCB2YWx1ZSB9ID0gcGFyYW1ldGVycy50cmFuc3BvcnQoewogICAgICBjaGFpbiwKICAgICAgcG9sbGluZ0ludGVydmFsCiAgICB9KTsKICAgIGNvbnN0IHRyYW5zcG9ydCA9IHsgLi4uY29uZmlnLCAuLi52YWx1ZSB9OwogICAgY29uc3QgY2xpZW50ID0gewogICAgICBhY2NvdW50LAogICAgICBiYXRjaCwKICAgICAgY2FjaGVUaW1lLAogICAgICBjY2lwUmVhZCwKICAgICAgY2hhaW4sCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgcG9sbGluZ0ludGVydmFsLAogICAgICByZXF1ZXN0LAogICAgICB0cmFuc3BvcnQsCiAgICAgIHR5cGUsCiAgICAgIHVpZDogdWlkKCkKICAgIH07CiAgICBmdW5jdGlvbiBleHRlbmQoYmFzZTIpIHsKICAgICAgcmV0dXJuIChleHRlbmRGbikgPT4gewogICAgICAgIGNvbnN0IGV4dGVuZGVkID0gZXh0ZW5kRm4oYmFzZTIpOwogICAgICAgIGZvciAoY29uc3Qga2V5MiBpbiBjbGllbnQpCiAgICAgICAgICBkZWxldGUgZXh0ZW5kZWRba2V5Ml07CiAgICAgICAgY29uc3QgY29tYmluZWQgPSB7IC4uLmJhc2UyLCAuLi5leHRlbmRlZCB9OwogICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNvbWJpbmVkLCB7IGV4dGVuZDogZXh0ZW5kKGNvbWJpbmVkKSB9KTsKICAgICAgfTsKICAgIH0KICAgIHJldHVybiBPYmplY3QuYXNzaWduKGNsaWVudCwgeyBleHRlbmQ6IGV4dGVuZChjbGllbnQpIH0pOwogIH0KICBmdW5jdGlvbiBycGNTY2hlbWEoKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9idWlsZFJlcXVlc3QuanMKICBpbml0X2Jhc2UoKTsKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X3JwYygpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcHJvbWlzZS93aXRoRGVkdXBlLmpzCiAgaW5pdF9scnUoKTsKICB2YXIgcHJvbWlzZUNhY2hlMiA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTHJ1TWFwKDgxOTIpOwogIGZ1bmN0aW9uIHdpdGhEZWR1cGUoZm4sIHsgZW5hYmxlZCA9IHRydWUsIGlkIH0pIHsKICAgIGlmICghZW5hYmxlZCB8fCAhaWQpCiAgICAgIHJldHVybiBmbigpOwogICAgaWYgKHByb21pc2VDYWNoZTIuZ2V0KGlkKSkKICAgICAgcmV0dXJuIHByb21pc2VDYWNoZTIuZ2V0KGlkKTsKICAgIGNvbnN0IHByb21pc2UgPSBmbigpLmZpbmFsbHkoKCkgPT4gcHJvbWlzZUNhY2hlMi5kZWxldGUoaWQpKTsKICAgIHByb21pc2VDYWNoZTIuc2V0KGlkLCBwcm9taXNlKTsKICAgIHJldHVybiBwcm9taXNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Byb21pc2Uvd2l0aFJldHJ5LmpzCiAgZnVuY3Rpb24gd2l0aFJldHJ5KGZuLCB7IGRlbGF5OiBkZWxheV8gPSAxMDAsIHJldHJ5Q291bnQgPSAyLCBzaG91bGRSZXRyeTogc2hvdWxkUmV0cnkyID0gKCkgPT4gdHJ1ZSB9ID0ge30pIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGNvbnN0IGF0dGVtcHRSZXRyeSA9IGFzeW5jICh7IGNvdW50ID0gMCB9ID0ge30pID0+IHsKICAgICAgICBjb25zdCByZXRyeSA9IGFzeW5jICh7IGVycm9yIH0pID0+IHsKICAgICAgICAgIGNvbnN0IGRlbGF5ID0gdHlwZW9mIGRlbGF5XyA9PT0gImZ1bmN0aW9uIiA/IGRlbGF5Xyh7IGNvdW50LCBlcnJvciB9KSA6IGRlbGF5XzsKICAgICAgICAgIGlmIChkZWxheSkKICAgICAgICAgICAgYXdhaXQgd2FpdChkZWxheSk7CiAgICAgICAgICBhdHRlbXB0UmV0cnkoeyBjb3VudDogY291bnQgKyAxIH0pOwogICAgICAgIH07CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmbigpOwogICAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGlmIChjb3VudCA8IHJldHJ5Q291bnQgJiYgYXdhaXQgc2hvdWxkUmV0cnkyKHsgY291bnQsIGVycm9yOiBlcnIgfSkpCiAgICAgICAgICAgIHJldHVybiByZXRyeSh7IGVycm9yOiBlcnIgfSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIGF0dGVtcHRSZXRyeSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYnVpbGRSZXF1ZXN0LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBmdW5jdGlvbiBidWlsZFJlcXVlc3QocmVxdWVzdCwgb3B0aW9ucyA9IHt9KSB7CiAgICByZXR1cm4gYXN5bmMgKGFyZ3MsIG92ZXJyaWRlT3B0aW9ucyA9IHt9KSA9PiB7CiAgICAgIGNvbnN0IHsgZGVkdXBlID0gZmFsc2UsIHJldHJ5RGVsYXkgPSAxNTAsIHJldHJ5Q291bnQgPSAzLCB1aWQ6IHVpZDIgfSA9IHsKICAgICAgICAuLi5vcHRpb25zLAogICAgICAgIC4uLm92ZXJyaWRlT3B0aW9ucwogICAgICB9OwogICAgICBjb25zdCByZXF1ZXN0SWQgPSBkZWR1cGUgPyBrZWNjYWsyNTYoc3RyaW5nVG9IZXgoYCR7dWlkMn0uJHtzdHJpbmdpZnkoYXJncyl9YCkpIDogdm9pZCAwOwogICAgICByZXR1cm4gd2l0aERlZHVwZSgoKSA9PiB3aXRoUmV0cnkoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gYXdhaXQgcmVxdWVzdChhcmdzKTsKICAgICAgICB9IGNhdGNoIChlcnJfKSB7CiAgICAgICAgICBjb25zdCBlcnIgPSBlcnJfOwogICAgICAgICAgc3dpdGNoIChlcnIuY29kZSkgewogICAgICAgICAgICAvLyAtMzI3MDAKICAgICAgICAgICAgY2FzZSBQYXJzZVJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNlUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyNjAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFJlcXVlc3RScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUmVxdWVzdFJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjYwMQogICAgICAgICAgICBjYXNlIE1ldGhvZE5vdEZvdW5kUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90Rm91bmRScGNFcnJvcihlcnIsIHsgbWV0aG9kOiBhcmdzLm1ldGhvZCB9KTsKICAgICAgICAgICAgLy8gLTMyNjAyCiAgICAgICAgICAgIGNhc2UgSW52YWxpZFBhcmFtc1JwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXJhbXNScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzI2MDMKICAgICAgICAgICAgY2FzZSBJbnRlcm5hbFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAwCiAgICAgICAgICAgIGNhc2UgSW52YWxpZElucHV0UnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZElucHV0UnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDAxCiAgICAgICAgICAgIGNhc2UgUmVzb3VyY2VOb3RGb3VuZFJwY0Vycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFJlc291cmNlTm90Rm91bmRScGNFcnJvcihlcnIpOwogICAgICAgICAgICAvLyAtMzIwMDIKICAgICAgICAgICAgY2FzZSBSZXNvdXJjZVVuYXZhaWxhYmxlUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVzb3VyY2VVbmF2YWlsYWJsZVJwY0Vycm9yKGVycik7CiAgICAgICAgICAgIC8vIC0zMjAwMwogICAgICAgICAgICBjYXNlIFRyYW5zYWN0aW9uUmVqZWN0ZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA0CiAgICAgICAgICAgIGNhc2UgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0aG9kTm90U3VwcG9ydGVkUnBjRXJyb3IoZXJyLCB7CiAgICAgICAgICAgICAgICBtZXRob2Q6IGFyZ3MubWV0aG9kCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIC0zMjAwNQogICAgICAgICAgICBjYXNlIExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBMaW1pdEV4Y2VlZGVkUnBjRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gLTMyMDA2CiAgICAgICAgICAgIGNhc2UgSnNvblJwY1ZlcnNpb25VbnN1cHBvcnRlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25ScGNWZXJzaW9uVW5zdXBwb3J0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MDAxCiAgICAgICAgICAgIGNhc2UgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJSZWplY3RlZFJlcXVlc3RFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0MTAwCiAgICAgICAgICAgIGNhc2UgVW5hdXRob3JpemVkUHJvdmlkZXJFcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBVbmF1dGhvcml6ZWRQcm92aWRlckVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQyMDAKICAgICAgICAgICAgY2FzZSBVbnN1cHBvcnRlZFByb3ZpZGVyTWV0aG9kRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRQcm92aWRlck1ldGhvZEVycm9yKGVycik7CiAgICAgICAgICAgIC8vIDQ5MDAKICAgICAgICAgICAgY2FzZSBQcm92aWRlckRpc2Nvbm5lY3RlZEVycm9yLmNvZGU6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFByb3ZpZGVyRGlzY29ubmVjdGVkRXJyb3IoZXJyKTsKICAgICAgICAgICAgLy8gNDkwMQogICAgICAgICAgICBjYXNlIENoYWluRGlzY29ubmVjdGVkRXJyb3IuY29kZToKICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2hhaW5EaXNjb25uZWN0ZWRFcnJvcihlcnIpOwogICAgICAgICAgICAvLyA0OTAyCiAgICAgICAgICAgIGNhc2UgU3dpdGNoQ2hhaW5FcnJvci5jb2RlOgogICAgICAgICAgICAgIHRocm93IG5ldyBTd2l0Y2hDaGFpbkVycm9yKGVycik7CiAgICAgICAgICAgIC8vIENBSVAtMjU6IFVzZXIgUmVqZWN0ZWQgRXJyb3IKICAgICAgICAgICAgLy8gaHR0cHM6Ly9kb2NzLndhbGxldGNvbm5lY3QuY29tLzIuMC9zcGVjcy9jbGllbnRzL3NpZ24vZXJyb3ItY29kZXMjcmVqZWN0ZWQtY2FpcC0yNQogICAgICAgICAgICBjYXNlIDVlMzoKICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlclJlamVjdGVkUmVxdWVzdEVycm9yKGVycik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgaWYgKGVycl8gaW5zdGFuY2VvZiBCYXNlRXJyb3IyKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyXzsKICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5rbm93blJwY0Vycm9yKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgZGVsYXk6ICh7IGNvdW50LCBlcnJvciB9KSA9PiB7CiAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yKSB7CiAgICAgICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBlcnJvcj8uaGVhZGVycz8uZ2V0KCJSZXRyeS1BZnRlciIpOwogICAgICAgICAgICBpZiAocmV0cnlBZnRlcj8ubWF0Y2goL1xkLykpCiAgICAgICAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUludChyZXRyeUFmdGVyKSAqIDFlMzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB+figxIDw8IGNvdW50KSAqIHJldHJ5RGVsYXk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHNob3VsZFJldHJ5OiAoeyBlcnJvciB9KSA9PiBzaG91bGRSZXRyeShlcnJvcikKICAgICAgfSksIHsgZW5hYmxlZDogZGVkdXBlLCBpZDogcmVxdWVzdElkIH0pOwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkUmV0cnkoZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSAtMSkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLmNvZGUgPT09IExpbWl0RXhjZWVkZWRScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3IuY29kZSA9PT0gSW50ZXJuYWxScGNFcnJvci5jb2RlKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBIdHRwUmVxdWVzdEVycm9yICYmIGVycm9yLnN0YXR1cykgewogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwOCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNDEzKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MjkpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwMCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PT0gNTAyKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA1MDMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDUwNCkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2NyZWF0ZVRyYW5zcG9ydC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zcG9ydCh7IGtleSwgbmFtZSwgcmVxdWVzdCwgcmV0cnlDb3VudCA9IDMsIHJldHJ5RGVsYXkgPSAxNTAsIHRpbWVvdXQsIHR5cGUgfSwgdmFsdWUpIHsKICAgIGNvbnN0IHVpZDIgPSB1aWQoKTsKICAgIHJldHVybiB7CiAgICAgIGNvbmZpZzogewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIHJlcXVlc3QsCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZQogICAgICB9LAogICAgICByZXF1ZXN0OiBidWlsZFJlcXVlc3QocmVxdWVzdCwgeyByZXRyeUNvdW50LCByZXRyeURlbGF5LCB1aWQ6IHVpZDIgfSksCiAgICAgIHZhbHVlCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvdHJhbnNwb3J0cy9jdXN0b20uanMKICBmdW5jdGlvbiBjdXN0b20ocHJvdmlkZXIsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtleSA9ICJjdXN0b20iLCBuYW1lID0gIkN1c3RvbSBQcm92aWRlciIsIHJldHJ5RGVsYXkgfSA9IGNvbmZpZzsKICAgIHJldHVybiAoeyByZXRyeUNvdW50OiBkZWZhdWx0UmV0cnlDb3VudCB9KSA9PiBjcmVhdGVUcmFuc3BvcnQoewogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHJlcXVlc3Q6IHByb3ZpZGVyLnJlcXVlc3QuYmluZChwcm92aWRlciksCiAgICAgIHJldHJ5Q291bnQ6IGNvbmZpZy5yZXRyeUNvdW50ID8/IGRlZmF1bHRSZXRyeUNvdW50LAogICAgICByZXRyeURlbGF5LAogICAgICB0eXBlOiAiY3VzdG9tIgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2ZhbGxiYWNrLmpzCiAgaW5pdF9ycGMoKTsKICBmdW5jdGlvbiBmYWxsYmFjayh0cmFuc3BvcnRzXywgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsga2V5ID0gImZhbGxiYWNrIiwgbmFtZSA9ICJGYWxsYmFjayIsIHJhbmsgPSBmYWxzZSwgcmV0cnlDb3VudCwgcmV0cnlEZWxheSB9ID0gY29uZmlnOwogICAgcmV0dXJuICh7IGNoYWluLCBwb2xsaW5nSW50ZXJ2YWwgPSA0ZTMsIHRpbWVvdXQsIC4uLnJlc3QgfSkgPT4gewogICAgICBsZXQgdHJhbnNwb3J0cyA9IHRyYW5zcG9ydHNfOwogICAgICBsZXQgb25SZXNwb25zZSA9ICgpID0+IHsKICAgICAgfTsKICAgICAgY29uc3QgdHJhbnNwb3J0ID0gY3JlYXRlVHJhbnNwb3J0KHsKICAgICAgICBrZXksCiAgICAgICAgbmFtZSwKICAgICAgICBhc3luYyByZXF1ZXN0KHsgbWV0aG9kLCBwYXJhbXMgfSkgewogICAgICAgICAgY29uc3QgZmV0Y2gyID0gYXN5bmMgKGkgPSAwKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydDIgPSB0cmFuc3BvcnRzW2ldKHsKICAgICAgICAgICAgICAuLi5yZXN0LAogICAgICAgICAgICAgIGNoYWluLAogICAgICAgICAgICAgIHJldHJ5Q291bnQ6IDAsCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRyYW5zcG9ydDIucmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2QsCiAgICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBvblJlc3BvbnNlKHsKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHJlc3BvbnNlLAogICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQyLAogICAgICAgICAgICAgICAgc3RhdHVzOiAic3VjY2VzcyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIG9uUmVzcG9uc2UoewogICAgICAgICAgICAgICAgZXJyb3I6IGVyciwKICAgICAgICAgICAgICAgIG1ldGhvZCwKICAgICAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0MiwKICAgICAgICAgICAgICAgIHN0YXR1czogImVycm9yIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlmIChzaG91bGRUaHJvdyhlcnIpKQogICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgIGlmIChpID09PSB0cmFuc3BvcnRzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgcmV0dXJuIGZldGNoMihpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICByZXR1cm4gZmV0Y2gyKCk7CiAgICAgICAgfSwKICAgICAgICByZXRyeUNvdW50LAogICAgICAgIHJldHJ5RGVsYXksCiAgICAgICAgdHlwZTogImZhbGxiYWNrIgogICAgICB9LCB7CiAgICAgICAgb25SZXNwb25zZTogKGZuKSA9PiBvblJlc3BvbnNlID0gZm4sCiAgICAgICAgdHJhbnNwb3J0czogdHJhbnNwb3J0cy5tYXAoKGZuKSA9PiBmbih7IGNoYWluLCByZXRyeUNvdW50OiAwIH0pKQogICAgICB9KTsKICAgICAgaWYgKHJhbmspIHsKICAgICAgICBjb25zdCByYW5rT3B0aW9ucyA9IHR5cGVvZiByYW5rID09PSAib2JqZWN0IiA/IHJhbmsgOiB7fTsKICAgICAgICByYW5rVHJhbnNwb3J0cyh7CiAgICAgICAgICBjaGFpbiwKICAgICAgICAgIGludGVydmFsOiByYW5rT3B0aW9ucy5pbnRlcnZhbCA/PyBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgICBvblRyYW5zcG9ydHM6ICh0cmFuc3BvcnRzXzIpID0+IHRyYW5zcG9ydHMgPSB0cmFuc3BvcnRzXzIsCiAgICAgICAgICBzYW1wbGVDb3VudDogcmFua09wdGlvbnMuc2FtcGxlQ291bnQsCiAgICAgICAgICB0aW1lb3V0OiByYW5rT3B0aW9ucy50aW1lb3V0LAogICAgICAgICAgdHJhbnNwb3J0cywKICAgICAgICAgIHdlaWdodHM6IHJhbmtPcHRpb25zLndlaWdodHMKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gdHJhbnNwb3J0OwogICAgfTsKICB9CiAgZnVuY3Rpb24gc2hvdWxkVGhyb3coZXJyb3IpIHsKICAgIGlmICgiY29kZSIgaW4gZXJyb3IgJiYgdHlwZW9mIGVycm9yLmNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgIGlmIChlcnJvci5jb2RlID09PSBUcmFuc2FjdGlvblJlamVjdGVkUnBjRXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSBVc2VyUmVqZWN0ZWRSZXF1ZXN0RXJyb3IuY29kZSB8fCBlcnJvci5jb2RlID09PSA1ZTMpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGZ1bmN0aW9uIHJhbmtUcmFuc3BvcnRzKHsgY2hhaW4sIGludGVydmFsID0gNGUzLCBvblRyYW5zcG9ydHMsIHNhbXBsZUNvdW50ID0gMTAsIHRpbWVvdXQgPSAxZTMsIHRyYW5zcG9ydHMsIHdlaWdodHMgPSB7fSB9KSB7CiAgICBjb25zdCB7IHN0YWJpbGl0eTogc3RhYmlsaXR5V2VpZ2h0ID0gMC43LCBsYXRlbmN5OiBsYXRlbmN5V2VpZ2h0ID0gMC4zIH0gPSB3ZWlnaHRzOwogICAgY29uc3Qgc2FtcGxlcyA9IFtdOwogICAgY29uc3QgcmFua1RyYW5zcG9ydHNfID0gYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBzYW1wbGUgPSBhd2FpdCBQcm9taXNlLmFsbCh0cmFuc3BvcnRzLm1hcChhc3luYyAodHJhbnNwb3J0KSA9PiB7CiAgICAgICAgY29uc3QgdHJhbnNwb3J0XyA9IHRyYW5zcG9ydCh7IGNoYWluLCByZXRyeUNvdW50OiAwLCB0aW1lb3V0IH0pOwogICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTsKICAgICAgICBsZXQgZW5kOwogICAgICAgIGxldCBzdWNjZXNzOwogICAgICAgIHRyeSB7CiAgICAgICAgICBhd2FpdCB0cmFuc3BvcnRfLnJlcXVlc3QoeyBtZXRob2Q6ICJuZXRfbGlzdGVuaW5nIiB9KTsKICAgICAgICAgIHN1Y2Nlc3MgPSAxOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgc3VjY2VzcyA9IDA7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGVuZCA9IERhdGUubm93KCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxhdGVuY3kgPSBlbmQgLSBzdGFydDsKICAgICAgICByZXR1cm4geyBsYXRlbmN5LCBzdWNjZXNzIH07CiAgICAgIH0pKTsKICAgICAgc2FtcGxlcy5wdXNoKHNhbXBsZSk7CiAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA+IHNhbXBsZUNvdW50KQogICAgICAgIHNhbXBsZXMuc2hpZnQoKTsKICAgICAgY29uc3QgbWF4TGF0ZW5jeSA9IE1hdGgubWF4KC4uLnNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBNYXRoLm1heCguLi5zYW1wbGUyLm1hcCgoeyBsYXRlbmN5IH0pID0+IGxhdGVuY3kpKSkpOwogICAgICBjb25zdCBzY29yZXMgPSB0cmFuc3BvcnRzLm1hcCgoXywgaSkgPT4gewogICAgICAgIGNvbnN0IGxhdGVuY2llcyA9IHNhbXBsZXMubWFwKChzYW1wbGUyKSA9PiBzYW1wbGUyW2ldLmxhdGVuY3kpOwogICAgICAgIGNvbnN0IG1lYW5MYXRlbmN5ID0gbGF0ZW5jaWVzLnJlZHVjZSgoYWNjLCBsYXRlbmN5KSA9PiBhY2MgKyBsYXRlbmN5LCAwKSAvIGxhdGVuY2llcy5sZW5ndGg7CiAgICAgICAgY29uc3QgbGF0ZW5jeVNjb3JlID0gMSAtIG1lYW5MYXRlbmN5IC8gbWF4TGF0ZW5jeTsKICAgICAgICBjb25zdCBzdWNjZXNzZXMgPSBzYW1wbGVzLm1hcCgoc2FtcGxlMikgPT4gc2FtcGxlMltpXS5zdWNjZXNzKTsKICAgICAgICBjb25zdCBzdGFiaWxpdHlTY29yZSA9IHN1Y2Nlc3Nlcy5yZWR1Y2UoKGFjYywgc3VjY2VzcykgPT4gYWNjICsgc3VjY2VzcywgMCkgLyBzdWNjZXNzZXMubGVuZ3RoOwogICAgICAgIGlmIChzdGFiaWxpdHlTY29yZSA9PT0gMCkKICAgICAgICAgIHJldHVybiBbMCwgaV07CiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgIGxhdGVuY3lXZWlnaHQgKiBsYXRlbmN5U2NvcmUgKyBzdGFiaWxpdHlXZWlnaHQgKiBzdGFiaWxpdHlTY29yZSwKICAgICAgICAgIGkKICAgICAgICBdOwogICAgICB9KS5zb3J0KChhLCBiKSA9PiBiWzBdIC0gYVswXSk7CiAgICAgIG9uVHJhbnNwb3J0cyhzY29yZXMubWFwKChbLCBpXSkgPT4gdHJhbnNwb3J0c1tpXSkpOwogICAgICBhd2FpdCB3YWl0KGludGVydmFsKTsKICAgICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgICB9OwogICAgcmFua1RyYW5zcG9ydHNfKCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2Vycm9ycy90cmFuc3BvcnQuanMKICBpbml0X2Jhc2UoKTsKICB2YXIgVXJsUmVxdWlyZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoIk5vIFVSTCB3YXMgcHJvdmlkZWQgdG8gdGhlIFRyYW5zcG9ydC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBSUEMgVVJMIHRvIHRoZSBUcmFuc3BvcnQuIiwgewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY2xpZW50cy9pbnRybyIsCiAgICAgICAgbmFtZTogIlVybFJlcXVpcmVkRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL3RyYW5zcG9ydHMvaHR0cC5qcwogIGluaXRfY3JlYXRlQmF0Y2hTY2hlZHVsZXIoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9odHRwLmpzCiAgaW5pdF9yZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9wcm9taXNlL3dpdGhUaW1lb3V0LmpzCiAgZnVuY3Rpb24gd2l0aFRpbWVvdXQoZm4sIHsgZXJyb3JJbnN0YW5jZSA9IG5ldyBFcnJvcigidGltZWQgb3V0IiksIHRpbWVvdXQsIHNpZ25hbCB9KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICA7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgbGV0IHRpbWVvdXRJZDsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTsKICAgICAgICAgIGlmICh0aW1lb3V0ID4gMCkgewogICAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoc2lnbmFsKSB7CiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmFib3J0KCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlamVjdChlcnJvckluc3RhbmNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHRpbWVvdXQpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShhd2FpdCBmbih7IHNpZ25hbDogY29udHJvbGxlcj8uc2lnbmFsIHx8IG51bGwgfSkpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVycj8ubmFtZSA9PT0gIkFib3J0RXJyb3IiKQogICAgICAgICAgICByZWplY3QoZXJyb3JJbnN0YW5jZSk7CiAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2h0dHAuanMKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvcnBjL2lkLmpzCiAgZnVuY3Rpb24gY3JlYXRlSWRTdG9yZSgpIHsKICAgIHJldHVybiB7CiAgICAgIGN1cnJlbnQ6IDAsCiAgICAgIHRha2UoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudCsrOwogICAgICB9LAogICAgICByZXNldCgpIHsKICAgICAgICB0aGlzLmN1cnJlbnQgPSAwOwogICAgICB9CiAgICB9OwogIH0KICB2YXIgaWRDYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBjcmVhdGVJZFN0b3JlKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvaHR0cC5qcwogIGZ1bmN0aW9uIGdldEh0dHBScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIHJlcXVlc3QocGFyYW1zKSB7CiAgICAgICAgY29uc3QgeyBib2R5LCBvblJlcXVlc3QgPSBvcHRpb25zLm9uUmVxdWVzdCwgb25SZXNwb25zZSA9IG9wdGlvbnMub25SZXNwb25zZSwgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCA/PyAxZTQgfSA9IHBhcmFtczsKICAgICAgICBjb25zdCBmZXRjaE9wdGlvbnMgPSB7CiAgICAgICAgICAuLi5vcHRpb25zLmZldGNoT3B0aW9ucyA/PyB7fSwKICAgICAgICAgIC4uLnBhcmFtcy5mZXRjaE9wdGlvbnMgPz8ge30KICAgICAgICB9OwogICAgICAgIGNvbnN0IHsgaGVhZGVycywgbWV0aG9kLCBzaWduYWw6IHNpZ25hbF8gfSA9IGZldGNoT3B0aW9uczsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3aXRoVGltZW91dChhc3luYyAoeyBzaWduYWwgfSkgPT4gewogICAgICAgICAgICBjb25zdCBpbml0ID0gewogICAgICAgICAgICAgIC4uLmZldGNoT3B0aW9ucywKICAgICAgICAgICAgICBib2R5OiBBcnJheS5pc0FycmF5KGJvZHkpID8gc3RyaW5naWZ5KGJvZHkubWFwKChib2R5MikgPT4gKHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkyLmlkID8/IGlkQ2FjaGUudGFrZSgpLAogICAgICAgICAgICAgICAgLi4uYm9keTIKICAgICAgICAgICAgICB9KSkpIDogc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGpzb25ycGM6ICIyLjAiLAogICAgICAgICAgICAgICAgaWQ6IGJvZHkuaWQgPz8gaWRDYWNoZS50YWtlKCksCiAgICAgICAgICAgICAgICAuLi5ib2R5CiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIC4uLmhlYWRlcnMKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kIHx8ICJQT1NUIiwKICAgICAgICAgICAgICBzaWduYWw6IHNpZ25hbF8gfHwgKHRpbWVvdXQgPiAwID8gc2lnbmFsIDogbnVsbCkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KHVybCwgaW5pdCk7CiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBhd2FpdCBvblJlcXVlc3Q/LihyZXF1ZXN0LCBpbml0KSA/PyB7IC4uLmluaXQsIHVybCB9OwogICAgICAgICAgICBjb25zdCByZXNwb25zZTIgPSBhd2FpdCBmZXRjaChhcmdzLnVybCA/PyB1cmwsIGFyZ3MpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UyOwogICAgICAgICAgfSwgewogICAgICAgICAgICBlcnJvckluc3RhbmNlOiBuZXcgVGltZW91dEVycm9yKHsgYm9keSwgdXJsIH0pLAogICAgICAgICAgICB0aW1lb3V0LAogICAgICAgICAgICBzaWduYWw6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKG9uUmVzcG9uc2UpCiAgICAgICAgICAgIGF3YWl0IG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgICBpZiAocmVzcG9uc2UuaGVhZGVycy5nZXQoIkNvbnRlbnQtVHlwZSIpPy5zdGFydHNXaXRoKCJhcHBsaWNhdGlvbi9qc29uIikpCiAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhIHx8ICJ7fSIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spCiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgZGF0YSA9IHsgZXJyb3I6IGRhdGEgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgewogICAgICAgICAgICB0aHJvdyBuZXcgSHR0cFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBkZXRhaWxzOiBzdHJpbmdpZnkoZGF0YS5lcnJvcikgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCwKICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLAogICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLAogICAgICAgICAgICAgIHVybAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEh0dHBSZXF1ZXN0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBUaW1lb3V0RXJyb3IpCiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgIHRocm93IG5ldyBIdHRwUmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgY2F1c2U6IGVyciwKICAgICAgICAgICAgdXJsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL2h0dHAuanMKICBmdW5jdGlvbiBodHRwKHVybCwgY29uZmlnID0ge30pIHsKICAgIGNvbnN0IHsgYmF0Y2gsIGZldGNoT3B0aW9ucywga2V5ID0gImh0dHAiLCBuYW1lID0gIkhUVFAgSlNPTi1SUEMiLCBvbkZldGNoUmVxdWVzdCwgb25GZXRjaFJlc3BvbnNlLCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHsgYmF0Y2hTaXplID0gMWUzLCB3YWl0OiB3YWl0MiA9IDAgfSA9IHR5cGVvZiBiYXRjaCA9PT0gIm9iamVjdCIgPyBiYXRjaCA6IHt9OwogICAgICBjb25zdCByZXRyeUNvdW50ID0gY29uZmlnLnJldHJ5Q291bnQgPz8gcmV0cnlDb3VudF87CiAgICAgIGNvbnN0IHRpbWVvdXQgPSB0aW1lb3V0XyA/PyBjb25maWcudGltZW91dCA/PyAxZTQ7CiAgICAgIGNvbnN0IHVybF8gPSB1cmwgfHwgY2hhaW4/LnJwY1VybHMuZGVmYXVsdC5odHRwWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgY29uc3QgcnBjQ2xpZW50ID0gZ2V0SHR0cFJwY0NsaWVudCh1cmxfLCB7CiAgICAgICAgZmV0Y2hPcHRpb25zLAogICAgICAgIG9uUmVxdWVzdDogb25GZXRjaFJlcXVlc3QsCiAgICAgICAgb25SZXNwb25zZTogb25GZXRjaFJlc3BvbnNlLAogICAgICAgIHRpbWVvdXQKICAgICAgfSk7CiAgICAgIHJldHVybiBjcmVhdGVUcmFuc3BvcnQoewogICAgICAgIGtleSwKICAgICAgICBuYW1lLAogICAgICAgIGFzeW5jIHJlcXVlc3QoeyBtZXRob2QsIHBhcmFtcyB9KSB7CiAgICAgICAgICBjb25zdCBib2R5ID0geyBtZXRob2QsIHBhcmFtcyB9OwogICAgICAgICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICAgICAgICBpZDogdXJsXywKICAgICAgICAgICAgd2FpdDogd2FpdDIsCiAgICAgICAgICAgIHNob3VsZFNwbGl0QmF0Y2gocmVxdWVzdHMpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdHMubGVuZ3RoID4gYmF0Y2hTaXplOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmbjogKGJvZHkyKSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgICAgYm9keTogYm9keTIKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHNvcnQ6IChhLCBiKSA9PiBhLmlkIC0gYi5pZAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCBmbiA9IGFzeW5jIChib2R5MikgPT4gYmF0Y2ggPyBzY2hlZHVsZShib2R5MikgOiBbCiAgICAgICAgICAgIGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0KHsKICAgICAgICAgICAgICBib2R5OiBib2R5MgogICAgICAgICAgICB9KQogICAgICAgICAgXTsKICAgICAgICAgIGNvbnN0IFt7IGVycm9yLCByZXN1bHQgfV0gPSBhd2FpdCBmbihib2R5KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogImh0dHAiCiAgICAgIH0sIHsKICAgICAgICBmZXRjaE9wdGlvbnMsCiAgICAgICAgdXJsOiB1cmxfCiAgICAgIH0pOwogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGluaXRfdHJpbSgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9lcnJvcnMuanMKICBpbml0X3NvbGlkaXR5KCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jb250cmFjdCgpOwogIGZ1bmN0aW9uIGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCBjYWxsVHlwZSkgewogICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQmFzZUVycm9yMikpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGNhdXNlID0gZXJyLndhbGsoKGUpID0+IGUgaW5zdGFuY2VvZiBDb250cmFjdEZ1bmN0aW9uUmV2ZXJ0ZWRFcnJvcik7CiAgICBpZiAoIShjYXVzZSBpbnN0YW5jZW9mIENvbnRyYWN0RnVuY3Rpb25SZXZlcnRlZEVycm9yKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyTm90Rm91bmQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJSZXNvbHZlcldpbGRjYXJkTm90U3VwcG9ydGVkIikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2F1c2UuZGF0YT8uZXJyb3JOYW1lID09PSAiUmVzb2x2ZXJOb3RDb250cmFjdCIpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKGNhdXNlLmRhdGE/LmVycm9yTmFtZSA9PT0gIlJlc29sdmVyRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5kYXRhPy5lcnJvck5hbWUgPT09ICJIdHRwRXJyb3IiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIGlmIChjYXVzZS5yZWFzb24/LmluY2x1ZGVzKCJXaWxkY2FyZCBvbiBub24tZXh0ZW5kZWQgcmVzb2x2ZXJzIGlzIG5vdCBzdXBwb3J0ZWQiKSkKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAoY2FsbFR5cGUgPT09ICJyZXZlcnNlIiAmJiBjYXVzZS5yZWFzb24gPT09IHBhbmljUmVhc29uc1s1MF0pCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvZW5jb2RlZExhYmVsVG9MYWJlbGhhc2guanMKICBpbml0X2lzSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHsKICAgIGlmIChsYWJlbC5sZW5ndGggIT09IDY2KQogICAgICByZXR1cm4gbnVsbDsKICAgIGlmIChsYWJlbC5pbmRleE9mKCJbIikgIT09IDApCiAgICAgIHJldHVybiBudWxsOwogICAgaWYgKGxhYmVsLmluZGV4T2YoIl0iKSAhPT0gNjUpCiAgICAgIHJldHVybiBudWxsOwogICAgY29uc3QgaGFzaDMgPSBgMHgke2xhYmVsLnNsaWNlKDEsIDY1KX1gOwogICAgaWYgKCFpc0hleChoYXNoMykpCiAgICAgIHJldHVybiBudWxsOwogICAgcmV0dXJuIGhhc2gzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9uYW1laGFzaC5qcwogIGZ1bmN0aW9uIG5hbWVoYXNoKG5hbWUpIHsKICAgIGxldCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbmFtZSkKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICAgIGNvbnN0IGxhYmVscyA9IG5hbWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSBsYWJlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpIC09IDEpIHsKICAgICAgY29uc3QgaGFzaEZyb21FbmNvZGVkTGFiZWwgPSBlbmNvZGVkTGFiZWxUb0xhYmVsaGFzaChsYWJlbHNbaV0pOwogICAgICBjb25zdCBoYXNoZWQgPSBoYXNoRnJvbUVuY29kZWRMYWJlbCA/IHRvQnl0ZXMoaGFzaEZyb21FbmNvZGVkTGFiZWwpIDoga2VjY2FrMjU2KHN0cmluZ1RvQnl0ZXMobGFiZWxzW2ldKSwgImJ5dGVzIik7CiAgICAgIHJlc3VsdCA9IGtlY2NhazI1Nihjb25jYXQoW3Jlc3VsdCwgaGFzaGVkXSksICJieXRlcyIpOwogICAgfQogICAgcmV0dXJuIGJ5dGVzVG9IZXgocmVzdWx0KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvcGFja2V0VG9CeXRlcy5qcwogIGluaXRfdG9CeXRlcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2VuY29kZUxhYmVsaGFzaC5qcwogIGZ1bmN0aW9uIGVuY29kZUxhYmVsaGFzaChoYXNoMykgewogICAgcmV0dXJuIGBbJHtoYXNoMy5zbGljZSgyKX1dYDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9lbnMvbGFiZWxoYXNoLmpzCiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgZnVuY3Rpb24gbGFiZWxoYXNoKGxhYmVsKSB7CiAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheSgzMikuZmlsbCgwKTsKICAgIGlmICghbGFiZWwpCiAgICAgIHJldHVybiBieXRlc1RvSGV4KHJlc3VsdCk7CiAgICByZXR1cm4gZW5jb2RlZExhYmVsVG9MYWJlbGhhc2gobGFiZWwpIHx8IGtlY2NhazI1NihzdHJpbmdUb0J5dGVzKGxhYmVsKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL3BhY2tldFRvQnl0ZXMuanMKICBmdW5jdGlvbiBwYWNrZXRUb0J5dGVzKHBhY2tldCkgewogICAgY29uc3QgdmFsdWUgPSBwYWNrZXQucmVwbGFjZSgvXlwufFwuJC9nbSwgIiIpOwogICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDEpOwogICAgY29uc3QgYnl0ZXMyID0gbmV3IFVpbnQ4QXJyYXkoc3RyaW5nVG9CeXRlcyh2YWx1ZSkuYnl0ZUxlbmd0aCArIDIpOwogICAgbGV0IG9mZnNldCA9IDA7CiAgICBjb25zdCBsaXN0ID0gdmFsdWUuc3BsaXQoIi4iKTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewogICAgICBsZXQgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMobGlzdFtpXSk7CiAgICAgIGlmIChlbmNvZGVkLmJ5dGVMZW5ndGggPiAyNTUpCiAgICAgICAgZW5jb2RlZCA9IHN0cmluZ1RvQnl0ZXMoZW5jb2RlTGFiZWxoYXNoKGxhYmVsaGFzaChsaXN0W2ldKSkpOwogICAgICBieXRlczJbb2Zmc2V0XSA9IGVuY29kZWQubGVuZ3RoOwogICAgICBieXRlczIuc2V0KGVuY29kZWQsIG9mZnNldCArIDEpOwogICAgICBvZmZzZXQgKz0gZW5jb2RlZC5sZW5ndGggKyAxOwogICAgfQogICAgaWYgKGJ5dGVzMi5ieXRlTGVuZ3RoICE9PSBvZmZzZXQgKyAxKQogICAgICByZXR1cm4gYnl0ZXMyLnNsaWNlKDAsIG9mZnNldCArIDEpOwogICAgcmV0dXJuIGJ5dGVzMjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNBZGRyZXNzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBjb2luVHlwZSwgbmFtZSwgZ2F0ZXdheVVybHMsIHN0cmljdCwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICB0cnkgewogICAgICBjb25zdCBmdW5jdGlvbkRhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoewogICAgICAgIGFiaTogYWRkcmVzc1Jlc29sdmVyQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogImFkZHIiLAogICAgICAgIC4uLmNvaW5UeXBlICE9IG51bGwgPyB7IGFyZ3M6IFtuYW1laGFzaChuYW1lKSwgQmlnSW50KGNvaW5UeXBlKV0gfSA6IHsgYXJnczogW25hbWVoYXNoKG5hbWUpXSB9CiAgICAgIH0pOwogICAgICBjb25zdCByZWFkQ29udHJhY3RQYXJhbWV0ZXJzID0gewogICAgICAgIGFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcywKICAgICAgICBhYmk6IHVuaXZlcnNhbFJlc29sdmVyUmVzb2x2ZUFiaSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJyZXNvbHZlIiwKICAgICAgICBhcmdzOiBbdG9IZXgocGFja2V0VG9CeXRlcyhuYW1lKSksIGZ1bmN0aW9uRGF0YV0sCiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgYmxvY2tUYWcKICAgICAgfTsKICAgICAgY29uc3QgcmVhZENvbnRyYWN0QWN0aW9uID0gZ2V0QWN0aW9uKGNsaWVudCwgcmVhZENvbnRyYWN0LCAicmVhZENvbnRyYWN0Iik7CiAgICAgIGNvbnN0IHJlcyA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKHJlc1swXSA9PT0gIjB4IikKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgY29uc3QgYWRkcmVzcyA9IGRlY29kZUZ1bmN0aW9uUmVzdWx0KHsKICAgICAgICBhYmk6IGFkZHJlc3NSZXNvbHZlckFiaSwKICAgICAgICBhcmdzOiBjb2luVHlwZSAhPSBudWxsID8gW25hbWVoYXNoKG5hbWUpLCBCaWdJbnQoY29pblR5cGUpXSA6IHZvaWQgMCwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJhZGRyIiwKICAgICAgICBkYXRhOiByZXNbMF0KICAgICAgfSk7CiAgICAgIGlmIChhZGRyZXNzID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBpZiAodHJpbShhZGRyZXNzKSA9PT0gIjB4MDAiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICByZXR1cm4gYWRkcmVzczsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBpZiAoc3RyaWN0KQogICAgICAgIHRocm93IGVycjsKICAgICAgaWYgKGlzTnVsbFVuaXZlcnNhbFJlc29sdmVyRXJyb3IoZXJyLCAicmVzb2x2ZSIpKQogICAgICAgIHJldHVybiBudWxsOwogICAgICB0aHJvdyBlcnI7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL2Vucy5qcwogIGluaXRfYmFzZSgpOwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEgfSkgewogICAgICBzdXBlcigiVW5hYmxlIHRvIGV4dHJhY3QgaW1hZ2UgZnJvbSBtZXRhZGF0YS4gVGhlIG1ldGFkYXRhIG1heSBiZSBtYWxmb3JtZWQgb3IgaW52YWxpZC4iLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbCiAgICAgICAgICAiLSBNZXRhZGF0YSBtdXN0IGJlIGEgSlNPTiBvYmplY3Qgd2l0aCBhdCBsZWFzdCBhbiBgaW1hZ2VgLCBgaW1hZ2VfdXJsYCBvciBgaW1hZ2VfZGF0YWAgcHJvcGVydHkuIiwKICAgICAgICAgICIiLAogICAgICAgICAgYFByb3ZpZGVkIGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9YAogICAgICAgIF0sCiAgICAgICAgbmFtZTogIkVuc0F2YXRhckludmFsaWRNZXRhZGF0YUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyByZWFzb24gfSkgewogICAgICBzdXBlcihgRU5TIE5GVCBhdmF0YXIgVVJJIGlzIGludmFsaWQuICR7cmVhc29ufWAsIHsKICAgICAgICBuYW1lOiAiRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yIgogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyB1cmkgfSkgewogICAgICBzdXBlcihgVW5hYmxlIHRvIHJlc29sdmUgRU5TIGF2YXRhciBVUkkgIiR7dXJpfSIuIFRoZSBVUkkgbWF5IGJlIG1hbGZvcm1lZCwgaW52YWxpZCwgb3IgZG9lcyBub3QgcmVzcG9uZCB3aXRoIGEgdmFsaWQgaW1hZ2UuYCwgeyBuYW1lOiAiRW5zQXZhdGFyVXJpUmVzb2x1dGlvbkVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgbmFtZXNwYWNlIH0pIHsKICAgICAgc3VwZXIoYEVOUyBORlQgYXZhdGFyIG5hbWVzcGFjZSAiJHtuYW1lc3BhY2V9IiBpcyBub3Qgc3VwcG9ydGVkLiBNdXN0IGJlICJlcmM3MjEiIG9yICJlcmMxMTU1Ii5gLCB7IG5hbWU6ICJFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yIiB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5zL2F2YXRhci91dGlscy5qcwogIHZhciBuZXR3b3JrUmVnZXggPSAvKD88cHJvdG9jb2w+aHR0cHM/OlwvXC9bXlwvXSp8aXBmczpcL3xpcG5zOlwvfGFyOlwvKT8oPzxyb290PlwvKT8oPzxzdWJwYXRoPmlwZnNcL3xpcG5zXC8pPyg/PHRhcmdldD5bXHdcLS5dKykoPzxzdWJ0YXJnZXQ+XC8uKik/LzsKICB2YXIgaXBmc0hhc2hSZWdleCA9IC9eKFFtWzEtOUEtSEotTlAtWmEta20tel17NDQsfXxiW0EtWmEtejItN117NTgsfXxCW0EtWjItN117NTgsfXx6WzEtOUEtSEotTlAtWmEta20tel17NDgsfXxGWzAtOUEtRl17NTAsfSkoXC8oPzx0YXJnZXQ+W1x3XC0uXSspKT8oPzxzdWJ0YXJnZXQ+XC8uKik/JC87CiAgdmFyIGJhc2U2NFJlZ2V4ID0gL15kYXRhOihbYS16QS1aXC0vK10qKTtiYXNlNjQsKFteIl0uKikvOwogIHZhciBkYXRhVVJJUmVnZXggPSAvXmRhdGE6KFthLXpBLVpcLS8rXSopPyg7W2EtekEtWjAtOV0uKj8pPygsKS87CiAgYXN5bmMgZnVuY3Rpb24gaXNJbWFnZVVyaSh1cmkpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVyaSwgeyBtZXRob2Q6ICJIRUFEIiB9KTsKICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVzLmhlYWRlcnMuZ2V0KCJjb250ZW50LXR5cGUiKTsKICAgICAgICByZXR1cm4gY29udGVudFR5cGU/LnN0YXJ0c1dpdGgoImltYWdlLyIpOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICJvYmplY3QiICYmIHR5cGVvZiBlcnJvci5yZXNwb25zZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFnbG9iYWxUaGlzLmhhc093blByb3BlcnR5KCJJbWFnZSIpKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfTsKICAgICAgICBpbWcub25lcnJvciA9ICgpID0+IHsKICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgIH07CiAgICAgICAgaW1nLnNyYyA9IHVyaTsKICAgICAgfSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGdldEdhdGV3YXkoY3VzdG9tMiwgZGVmYXVsdEdhdGV3YXkpIHsKICAgIGlmICghY3VzdG9tMikKICAgICAgcmV0dXJuIGRlZmF1bHRHYXRld2F5OwogICAgaWYgKGN1c3RvbTIuZW5kc1dpdGgoIi8iKSkKICAgICAgcmV0dXJuIGN1c3RvbTIuc2xpY2UoMCwgLTEpOwogICAgcmV0dXJuIGN1c3RvbTI7CiAgfQogIGZ1bmN0aW9uIHJlc29sdmVBdmF0YXJVcmkoeyB1cmksIGdhdGV3YXlVcmxzIH0pIHsKICAgIGNvbnN0IGlzRW5jb2RlZCA9IGJhc2U2NFJlZ2V4LnRlc3QodXJpKTsKICAgIGlmIChpc0VuY29kZWQpCiAgICAgIHJldHVybiB7IHVyaSwgaXNPbkNoYWluOiB0cnVlLCBpc0VuY29kZWQgfTsKICAgIGNvbnN0IGlwZnNHYXRld2F5ID0gZ2V0R2F0ZXdheShnYXRld2F5VXJscz8uaXBmcywgImh0dHBzOi8vaXBmcy5pbyIpOwogICAgY29uc3QgYXJ3ZWF2ZUdhdGV3YXkgPSBnZXRHYXRld2F5KGdhdGV3YXlVcmxzPy5hcndlYXZlLCAiaHR0cHM6Ly9hcndlYXZlLm5ldCIpOwogICAgY29uc3QgbmV0d29ya1JlZ2V4TWF0Y2ggPSB1cmkubWF0Y2gobmV0d29ya1JlZ2V4KTsKICAgIGNvbnN0IHsgcHJvdG9jb2wsIHN1YnBhdGgsIHRhcmdldCwgc3VidGFyZ2V0ID0gIiIgfSA9IG5ldHdvcmtSZWdleE1hdGNoPy5ncm91cHMgfHwge307CiAgICBjb25zdCBpc0lQTlMgPSBwcm90b2NvbCA9PT0gImlwbnM6LyIgfHwgc3VicGF0aCA9PT0gImlwbnMvIjsKICAgIGNvbnN0IGlzSVBGUyA9IHByb3RvY29sID09PSAiaXBmczovIiB8fCBzdWJwYXRoID09PSAiaXBmcy8iIHx8IGlwZnNIYXNoUmVnZXgudGVzdCh1cmkpOwogICAgaWYgKHVyaS5zdGFydHNXaXRoKCJodHRwIikgJiYgIWlzSVBOUyAmJiAhaXNJUEZTKSB7CiAgICAgIGxldCByZXBsYWNlZFVyaSA9IHVyaTsKICAgICAgaWYgKGdhdGV3YXlVcmxzPy5hcndlYXZlKQogICAgICAgIHJlcGxhY2VkVXJpID0gdXJpLnJlcGxhY2UoL2h0dHBzOlwvXC9hcndlYXZlLm5ldC9nLCBnYXRld2F5VXJscz8uYXJ3ZWF2ZSk7CiAgICAgIHJldHVybiB7IHVyaTogcmVwbGFjZWRVcmksIGlzT25DaGFpbjogZmFsc2UsIGlzRW5jb2RlZDogZmFsc2UgfTsKICAgIH0KICAgIGlmICgoaXNJUE5TIHx8IGlzSVBGUykgJiYgdGFyZ2V0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBgJHtpcGZzR2F0ZXdheX0vJHtpc0lQTlMgPyAiaXBucyIgOiAiaXBmcyJ9LyR7dGFyZ2V0fSR7c3VidGFyZ2V0fWAsCiAgICAgICAgaXNPbkNoYWluOiBmYWxzZSwKICAgICAgICBpc0VuY29kZWQ6IGZhbHNlCiAgICAgIH07CiAgICB9CiAgICBpZiAocHJvdG9jb2wgPT09ICJhcjovIiAmJiB0YXJnZXQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB1cmk6IGAke2Fyd2VhdmVHYXRld2F5fS8ke3RhcmdldH0ke3N1YnRhcmdldCB8fCAiIn1gLAogICAgICAgIGlzT25DaGFpbjogZmFsc2UsCiAgICAgICAgaXNFbmNvZGVkOiBmYWxzZQogICAgICB9OwogICAgfQogICAgbGV0IHBhcnNlZFVyaSA9IHVyaS5yZXBsYWNlKGRhdGFVUklSZWdleCwgIiIpOwogICAgaWYgKHBhcnNlZFVyaS5zdGFydHNXaXRoKCI8c3ZnIikpIHsKICAgICAgcGFyc2VkVXJpID0gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJHtidG9hKHBhcnNlZFVyaSl9YDsKICAgIH0KICAgIGlmIChwYXJzZWRVcmkuc3RhcnRzV2l0aCgiZGF0YToiKSB8fCBwYXJzZWRVcmkuc3RhcnRzV2l0aCgieyIpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXJpOiBwYXJzZWRVcmksCiAgICAgICAgaXNPbkNoYWluOiB0cnVlLAogICAgICAgIGlzRW5jb2RlZDogZmFsc2UKICAgICAgfTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgfQogIGZ1bmN0aW9uIGdldEpzb25JbWFnZShkYXRhKSB7CiAgICBpZiAodHlwZW9mIGRhdGEgIT09ICJvYmplY3QiIHx8ICEoImltYWdlIiBpbiBkYXRhKSAmJiAhKCJpbWFnZV91cmwiIGluIGRhdGEpICYmICEoImltYWdlX2RhdGEiIGluIGRhdGEpKSB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTWV0YWRhdGFFcnJvcih7IGRhdGEgfSk7CiAgICB9CiAgICByZXR1cm4gZGF0YS5pbWFnZSB8fCBkYXRhLmltYWdlX3VybCB8fCBkYXRhLmltYWdlX2RhdGE7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE1ldGFkYXRhQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICB0cnkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmkpLnRoZW4oKHJlczIpID0+IHJlczIuanNvbigpKTsKICAgICAgY29uc3QgaW1hZ2UgPSBhd2FpdCBwYXJzZUF2YXRhclVyaSh7CiAgICAgICAgZ2F0ZXdheVVybHMsCiAgICAgICAgdXJpOiBnZXRKc29uSW1hZ2UocmVzKQogICAgICB9KTsKICAgICAgcmV0dXJuIGltYWdlOwogICAgfSBjYXRjaCB7CiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJVcmlSZXNvbHV0aW9uRXJyb3IoeyB1cmkgfSk7CiAgICB9CiAgfQogIGFzeW5jIGZ1bmN0aW9uIHBhcnNlQXZhdGFyVXJpKHsgZ2F0ZXdheVVybHMsIHVyaSB9KSB7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWRVUkksIGlzT25DaGFpbiB9ID0gcmVzb2x2ZUF2YXRhclVyaSh7IHVyaSwgZ2F0ZXdheVVybHMgfSk7CiAgICBpZiAoaXNPbkNoYWluKQogICAgICByZXR1cm4gcmVzb2x2ZWRVUkk7CiAgICBjb25zdCBpc0ltYWdlID0gYXdhaXQgaXNJbWFnZVVyaShyZXNvbHZlZFVSSSk7CiAgICBpZiAoaXNJbWFnZSkKICAgICAgcmV0dXJuIHJlc29sdmVkVVJJOwogICAgdGhyb3cgbmV3IEVuc0F2YXRhclVyaVJlc29sdXRpb25FcnJvcih7IHVyaSB9KTsKICB9CiAgZnVuY3Rpb24gcGFyc2VOZnRVcmkodXJpXykgewogICAgbGV0IHVyaSA9IHVyaV87CiAgICBpZiAodXJpLnN0YXJ0c1dpdGgoImRpZDpuZnQ6IikpIHsKICAgICAgdXJpID0gdXJpLnJlcGxhY2UoImRpZDpuZnQ6IiwgIiIpLnJlcGxhY2UoL18vZywgIi8iKTsKICAgIH0KICAgIGNvbnN0IFtyZWZlcmVuY2UsIGFzc2V0X25hbWVzcGFjZSwgdG9rZW5JRF0gPSB1cmkuc3BsaXQoIi8iKTsKICAgIGNvbnN0IFtlaXBfbmFtZXNwYWNlLCBjaGFpbklEXSA9IHJlZmVyZW5jZS5zcGxpdCgiOiIpOwogICAgY29uc3QgW2VyY19uYW1lc3BhY2UsIGNvbnRyYWN0QWRkcmVzc10gPSBhc3NldF9uYW1lc3BhY2Uuc3BsaXQoIjoiKTsKICAgIGlmICghZWlwX25hbWVzcGFjZSB8fCBlaXBfbmFtZXNwYWNlLnRvTG93ZXJDYXNlKCkgIT09ICJlaXAxNTUiKQogICAgICB0aHJvdyBuZXcgRW5zQXZhdGFySW52YWxpZE5mdFVyaUVycm9yKHsgcmVhc29uOiAiT25seSBFSVAtMTU1IHN1cHBvcnRlZCIgfSk7CiAgICBpZiAoIWNoYWluSUQpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJDaGFpbiBJRCBub3QgZm91bmQiIH0pOwogICAgaWYgKCFjb250cmFjdEFkZHJlc3MpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoewogICAgICAgIHJlYXNvbjogIkNvbnRyYWN0IGFkZHJlc3Mgbm90IGZvdW5kIgogICAgICB9KTsKICAgIGlmICghdG9rZW5JRCkKICAgICAgdGhyb3cgbmV3IEVuc0F2YXRhckludmFsaWROZnRVcmlFcnJvcih7IHJlYXNvbjogIlRva2VuIElEIG5vdCBmb3VuZCIgfSk7CiAgICBpZiAoIWVyY19uYW1lc3BhY2UpCiAgICAgIHRocm93IG5ldyBFbnNBdmF0YXJJbnZhbGlkTmZ0VXJpRXJyb3IoeyByZWFzb246ICJFUkMgbmFtZXNwYWNlIG5vdCBmb3VuZCIgfSk7CiAgICByZXR1cm4gewogICAgICBjaGFpbklEOiBOdW1iZXIucGFyc2VJbnQoY2hhaW5JRCksCiAgICAgIG5hbWVzcGFjZTogZXJjX25hbWVzcGFjZS50b0xvd2VyQ2FzZSgpLAogICAgICBjb250cmFjdEFkZHJlc3MsCiAgICAgIHRva2VuSUQKICAgIH07CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSkgewogICAgaWYgKG5mdC5uYW1lc3BhY2UgPT09ICJlcmM3MjEiKSB7CiAgICAgIHJldHVybiByZWFkQ29udHJhY3QoY2xpZW50LCB7CiAgICAgICAgYWRkcmVzczogbmZ0LmNvbnRyYWN0QWRkcmVzcywKICAgICAgICBhYmk6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogInRva2VuVVJJIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogInRva2VuSWQiLCB0eXBlOiAidWludDI1NiIgfV0sCiAgICAgICAgICAgIG91dHB1dHM6IFt7IG5hbWU6ICIiLCB0eXBlOiAic3RyaW5nIiB9XQogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidG9rZW5VUkkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIGlmIChuZnQubmFtZXNwYWNlID09PSAiZXJjMTE1NSIpIHsKICAgICAgcmV0dXJuIHJlYWRDb250cmFjdChjbGllbnQsIHsKICAgICAgICBhZGRyZXNzOiBuZnQuY29udHJhY3RBZGRyZXNzLAogICAgICAgIGFiaTogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAidXJpIiwKICAgICAgICAgICAgdHlwZTogImZ1bmN0aW9uIiwKICAgICAgICAgICAgc3RhdGVNdXRhYmlsaXR5OiAidmlldyIsCiAgICAgICAgICAgIGlucHV0czogW3sgbmFtZTogIl9pZCIsIHR5cGU6ICJ1aW50MjU2IiB9XSwKICAgICAgICAgICAgb3V0cHV0czogW3sgbmFtZTogIiIsIHR5cGU6ICJzdHJpbmciIH1dCiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICBmdW5jdGlvbk5hbWU6ICJ1cmkiLAogICAgICAgIGFyZ3M6IFtCaWdJbnQobmZ0LnRva2VuSUQpXQogICAgICB9KTsKICAgIH0KICAgIHRocm93IG5ldyBFbnNBdmF0YXJVbnN1cHBvcnRlZE5hbWVzcGFjZUVycm9yKHsgbmFtZXNwYWNlOiBuZnQubmFtZXNwYWNlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2Vucy9hdmF0YXIvcGFyc2VBdmF0YXJSZWNvcmQuanMKICBhc3luYyBmdW5jdGlvbiBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KSB7CiAgICBpZiAoL2VpcDE1NTovaS50ZXN0KHJlY29yZCkpCiAgICAgIHJldHVybiBwYXJzZU5mdEF2YXRhclVyaShjbGllbnQsIHsgZ2F0ZXdheVVybHMsIHJlY29yZCB9KTsKICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogcmVjb3JkLCBnYXRld2F5VXJscyB9KTsKICB9CiAgYXN5bmMgZnVuY3Rpb24gcGFyc2VOZnRBdmF0YXJVcmkoY2xpZW50LCB7IGdhdGV3YXlVcmxzLCByZWNvcmQgfSkgewogICAgY29uc3QgbmZ0ID0gcGFyc2VOZnRVcmkocmVjb3JkKTsKICAgIGNvbnN0IG5mdFVyaSA9IGF3YWl0IGdldE5mdFRva2VuVXJpKGNsaWVudCwgeyBuZnQgfSk7CiAgICBjb25zdCB7IHVyaTogcmVzb2x2ZWROZnRVcmksIGlzT25DaGFpbiwgaXNFbmNvZGVkIH0gPSByZXNvbHZlQXZhdGFyVXJpKHsgdXJpOiBuZnRVcmksIGdhdGV3YXlVcmxzIH0pOwogICAgaWYgKGlzT25DaGFpbiAmJiAocmVzb2x2ZWROZnRVcmkuaW5jbHVkZXMoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIikgfHwgcmVzb2x2ZWROZnRVcmkuc3RhcnRzV2l0aCgieyIpKSkgewogICAgICBjb25zdCBlbmNvZGVkSnNvbiA9IGlzRW5jb2RlZCA/ICgKICAgICAgICAvLyBpZiBpdCBpcyBlbmNvZGVkLCBkZWNvZGUgaXQKICAgICAgICBhdG9iKHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIiwgIiIpKQogICAgICApIDogKAogICAgICAgIC8vIGlmIGl0IGlzbid0IGVuY29kZWQgYXNzdW1lIGl0IGlzIGEgSlNPTiBzdHJpbmcsIGJ1dCBpdCBjb3VsZCBiZSBhbnl0aGluZyAoaXQgd2lsbCBlcnJvciBpZiBpdCBpcykKICAgICAgICByZXNvbHZlZE5mdFVyaQogICAgICApOwogICAgICBjb25zdCBkZWNvZGVkID0gSlNPTi5wYXJzZShlbmNvZGVkSnNvbik7CiAgICAgIHJldHVybiBwYXJzZUF2YXRhclVyaSh7IHVyaTogZ2V0SnNvbkltYWdlKGRlY29kZWQpLCBnYXRld2F5VXJscyB9KTsKICAgIH0KICAgIGxldCB1cmlUb2tlbklkID0gbmZ0LnRva2VuSUQ7CiAgICBpZiAobmZ0Lm5hbWVzcGFjZSA9PT0gImVyYzExNTUiKQogICAgICB1cmlUb2tlbklkID0gdXJpVG9rZW5JZC5yZXBsYWNlKCIweCIsICIiKS5wYWRTdGFydCg2NCwgIjAiKTsKICAgIHJldHVybiBnZXRNZXRhZGF0YUF2YXRhclVyaSh7CiAgICAgIGdhdGV3YXlVcmxzLAogICAgICB1cmk6IHJlc29sdmVkTmZ0VXJpLnJlcGxhY2UoLyg/OjB4KT97aWR9LywgdXJpVG9rZW5JZCkKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc1RleHQuanMKICBpbml0X2FiaXMoKTsKICBpbml0X2RlY29kZUZ1bmN0aW9uUmVzdWx0KCk7CiAgaW5pdF9lbmNvZGVGdW5jdGlvbkRhdGEoKTsKICBpbml0X2dldENoYWluQ29udHJhY3RBZGRyZXNzKCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc1RleHQoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwga2V5LCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXNvbHZlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJlc29sdmUiLAogICAgICAgIGFyZ3M6IFsKICAgICAgICAgIHRvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpLAogICAgICAgICAgZW5jb2RlRnVuY3Rpb25EYXRhKHsKICAgICAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgICAgIGZ1bmN0aW9uTmFtZTogInRleHQiLAogICAgICAgICAgICBhcmdzOiBbbmFtZWhhc2gobmFtZSksIGtleV0KICAgICAgICAgIH0pCiAgICAgICAgXSwKICAgICAgICBibG9ja051bWJlciwKICAgICAgICBibG9ja1RhZwogICAgICB9OwogICAgICBjb25zdCByZWFkQ29udHJhY3RBY3Rpb24gPSBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKTsKICAgICAgY29uc3QgcmVzID0gZ2F0ZXdheVVybHMgPyBhd2FpdCByZWFkQ29udHJhY3RBY3Rpb24oewogICAgICAgIC4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMsCiAgICAgICAgYXJnczogWy4uLnJlYWRDb250cmFjdFBhcmFtZXRlcnMuYXJncywgZ2F0ZXdheVVybHNdCiAgICAgIH0pIDogYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHJlYWRDb250cmFjdFBhcmFtZXRlcnMpOwogICAgICBpZiAocmVzWzBdID09PSAiMHgiKQogICAgICAgIHJldHVybiBudWxsOwogICAgICBjb25zdCByZWNvcmQgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgYWJpOiB0ZXh0UmVzb2x2ZXJBYmksCiAgICAgICAgZnVuY3Rpb25OYW1lOiAidGV4dCIsCiAgICAgICAgZGF0YTogcmVzWzBdCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVjb3JkID09PSAiIiA/IG51bGwgOiByZWNvcmQ7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgaWYgKHN0cmljdCkKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIGlmIChpc051bGxVbml2ZXJzYWxSZXNvbHZlckVycm9yKGVyciwgInJlc29sdmUiKSkKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgdGhyb3cgZXJyOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvZW5zL2dldEVuc0F2YXRhci5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEVuc0F2YXRhcihjbGllbnQsIHsgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBhc3NldEdhdGV3YXlVcmxzLCBuYW1lLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgfSkgewogICAgY29uc3QgcmVjb3JkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RW5zVGV4dCwgImdldEVuc1RleHQiKSh7CiAgICAgIGJsb2NrTnVtYmVyLAogICAgICBibG9ja1RhZywKICAgICAga2V5OiAiYXZhdGFyIiwKICAgICAgbmFtZSwKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBnYXRld2F5VXJscywKICAgICAgc3RyaWN0CiAgICB9KTsKICAgIGlmICghcmVjb3JkKQogICAgICByZXR1cm4gbnVsbDsKICAgIHRyeSB7CiAgICAgIHJldHVybiBhd2FpdCBwYXJzZUF2YXRhclJlY29yZChjbGllbnQsIHsKICAgICAgICByZWNvcmQsCiAgICAgICAgZ2F0ZXdheVVybHM6IGFzc2V0R2F0ZXdheVVybHMKICAgICAgfSk7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9lbnMvZ2V0RW5zTmFtZS5qcwogIGluaXRfYWJpcygpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zTmFtZShjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnLCBnYXRld2F5VXJscywgc3RyaWN0LCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3M6IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc18gfSkgewogICAgbGV0IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyA9IHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzc187CiAgICBpZiAoIXVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcykgewogICAgICBpZiAoIWNsaWVudC5jaGFpbikKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNsaWVudCBjaGFpbiBub3QgY29uZmlndXJlZC4gdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzIGlzIHJlcXVpcmVkLiIpOwogICAgICB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogImVuc1VuaXZlcnNhbFJlc29sdmVyIgogICAgICB9KTsKICAgIH0KICAgIGNvbnN0IHJldmVyc2VOb2RlID0gYCR7YWRkcmVzcy50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZygyKX0uYWRkci5yZXZlcnNlYDsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdFBhcmFtZXRlcnMgPSB7CiAgICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICAgIGFiaTogdW5pdmVyc2FsUmVzb2x2ZXJSZXZlcnNlQWJpLAogICAgICAgIGZ1bmN0aW9uTmFtZTogInJldmVyc2UiLAogICAgICAgIGFyZ3M6IFt0b0hleChwYWNrZXRUb0J5dGVzKHJldmVyc2VOb2RlKSldLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnCiAgICAgIH07CiAgICAgIGNvbnN0IHJlYWRDb250cmFjdEFjdGlvbiA9IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpOwogICAgICBjb25zdCBbbmFtZSwgcmVzb2x2ZWRBZGRyZXNzXSA9IGdhdGV3YXlVcmxzID8gYXdhaXQgcmVhZENvbnRyYWN0QWN0aW9uKHsKICAgICAgICAuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLAogICAgICAgIGFyZ3M6IFsuLi5yZWFkQ29udHJhY3RQYXJhbWV0ZXJzLmFyZ3MsIGdhdGV3YXlVcmxzXQogICAgICB9KSA6IGF3YWl0IHJlYWRDb250cmFjdEFjdGlvbihyZWFkQ29udHJhY3RQYXJhbWV0ZXJzKTsKICAgICAgaWYgKGFkZHJlc3MudG9Mb3dlckNhc2UoKSAhPT0gcmVzb2x2ZWRBZGRyZXNzLnRvTG93ZXJDYXNlKCkpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHJldHVybiBuYW1lOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIGlmIChzdHJpY3QpCiAgICAgICAgdGhyb3cgZXJyOwogICAgICBpZiAoaXNOdWxsVW5pdmVyc2FsUmVzb2x2ZXJFcnJvcihlcnIsICJyZXZlcnNlIikpCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIHRocm93IGVycjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL2Vucy9nZXRFbnNSZXNvbHZlci5qcwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0RW5zUmVzb2x2ZXIoY2xpZW50LCB7IGJsb2NrTnVtYmVyLCBibG9ja1RhZywgbmFtZSwgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzOiB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfIH0pIHsKICAgIGxldCB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MgPSB1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3NfOwogICAgaWYgKCF1bml2ZXJzYWxSZXNvbHZlckFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIHVuaXZlcnNhbFJlc29sdmVyQWRkcmVzcyBpcyByZXF1aXJlZC4iKTsKICAgICAgdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzID0gZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoewogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGNoYWluOiBjbGllbnQuY2hhaW4sCiAgICAgICAgY29udHJhY3Q6ICJlbnNVbml2ZXJzYWxSZXNvbHZlciIKICAgICAgfSk7CiAgICB9CiAgICBjb25zdCBbcmVzb2x2ZXJBZGRyZXNzXSA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHJlYWRDb250cmFjdCwgInJlYWRDb250cmFjdCIpKHsKICAgICAgYWRkcmVzczogdW5pdmVyc2FsUmVzb2x2ZXJBZGRyZXNzLAogICAgICBhYmk6IFsKICAgICAgICB7CiAgICAgICAgICBpbnB1dHM6IFt7IHR5cGU6ICJieXRlcyIgfV0sCiAgICAgICAgICBuYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgICAgIG91dHB1dHM6IFt7IHR5cGU6ICJhZGRyZXNzIiB9LCB7IHR5cGU6ICJieXRlczMyIiB9XSwKICAgICAgICAgIHN0YXRlTXV0YWJpbGl0eTogInZpZXciLAogICAgICAgICAgdHlwZTogImZ1bmN0aW9uIgogICAgICAgIH0KICAgICAgXSwKICAgICAgZnVuY3Rpb25OYW1lOiAiZmluZFJlc29sdmVyIiwKICAgICAgYXJnczogW3RvSGV4KHBhY2tldFRvQnl0ZXMobmFtZSkpXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnCiAgICB9KTsKICAgIHJldHVybiByZXNvbHZlckFkZHJlc3M7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy9kZWNvcmF0b3JzL3B1YmxpYy5qcwogIGluaXRfY2FsbCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlQmxvY2tGaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVCbG9ja0ZpbHRlcihjbGllbnQpIHsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgY29uc3QgaWQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9uZXdCbG9ja0ZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAiYmxvY2siIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvY3JlYXRlRXZlbnRGaWx0ZXIuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCB7IGFkZHJlc3MsIGFyZ3MsIGV2ZW50LCBldmVudHM6IGV2ZW50c18sIGZyb21CbG9jaywgc3RyaWN0LCB0b0Jsb2NrIH0gPSB7fSkgewogICAgY29uc3QgZXZlbnRzID0gZXZlbnRzXyA/PyAoZXZlbnQgPyBbZXZlbnRdIDogdm9pZCAwKTsKICAgIGNvbnN0IGdldFJlcXVlc3QgPSBjcmVhdGVGaWx0ZXJSZXF1ZXN0U2NvcGUoY2xpZW50LCB7CiAgICAgIG1ldGhvZDogImV0aF9uZXdGaWx0ZXIiCiAgICB9KTsKICAgIGxldCB0b3BpY3MgPSBbXTsKICAgIGlmIChldmVudHMpIHsKICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50cy5mbGF0TWFwKChldmVudDIpID0+IGVuY29kZUV2ZW50VG9waWNzKHsKICAgICAgICBhYmk6IFtldmVudDJdLAogICAgICAgIGV2ZW50TmFtZTogZXZlbnQyLm5hbWUsCiAgICAgICAgYXJncwogICAgICB9KSk7CiAgICAgIHRvcGljcyA9IFtlbmNvZGVkXTsKICAgICAgaWYgKGV2ZW50KQogICAgICAgIHRvcGljcyA9IHRvcGljc1swXTsKICAgIH0KICAgIGNvbnN0IGlkID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfbmV3RmlsdGVyIiwKICAgICAgcGFyYW1zOiBbCiAgICAgICAgewogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGZyb21CbG9jazogdHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIgPyBudW1iZXJUb0hleChmcm9tQmxvY2spIDogZnJvbUJsb2NrLAogICAgICAgICAgdG9CbG9jazogdHlwZW9mIHRvQmxvY2sgPT09ICJiaWdpbnQiID8gbnVtYmVyVG9IZXgodG9CbG9jaykgOiB0b0Jsb2NrLAogICAgICAgICAgLi4udG9waWNzLmxlbmd0aCA/IHsgdG9waWNzIH0gOiB7fQogICAgICAgIH0KICAgICAgXQogICAgfSk7CiAgICByZXR1cm4gewogICAgICBhYmk6IGV2ZW50cywKICAgICAgYXJncywKICAgICAgZXZlbnROYW1lOiBldmVudCA/IGV2ZW50Lm5hbWUgOiB2b2lkIDAsCiAgICAgIGZyb21CbG9jaywKICAgICAgaWQsCiAgICAgIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLAogICAgICBzdHJpY3Q6IEJvb2xlYW4oc3RyaWN0KSwKICAgICAgdG9CbG9jaywKICAgICAgdHlwZTogImV2ZW50IgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9jcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIuanMKICBhc3luYyBmdW5jdGlvbiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSB7CiAgICBjb25zdCBnZXRSZXF1ZXN0ID0gY3JlYXRlRmlsdGVyUmVxdWVzdFNjb3BlKGNsaWVudCwgewogICAgICBtZXRob2Q6ICJldGhfbmV3UGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyIgogICAgfSk7CiAgICBjb25zdCBpZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX25ld1BlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIKICAgIH0pOwogICAgcmV0dXJuIHsgaWQsIHJlcXVlc3Q6IGdldFJlcXVlc3QoaWQpLCB0eXBlOiAidHJhbnNhY3Rpb24iIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0QmxvYkJhc2VGZWUuanMKICBhc3luYyBmdW5jdGlvbiBnZXRCbG9iQmFzZUZlZShjbGllbnQpIHsKICAgIGNvbnN0IGJhc2VGZWUgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9ibG9iQmFzZUZlZSIKICAgIH0pOwogICAgcmV0dXJuIEJpZ0ludChiYXNlRmVlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRCbG9ja1RyYW5zYWN0aW9uQ291bnQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgeyBibG9ja0hhc2gsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0gPSB7fSkgewogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgbGV0IGNvdW50OwogICAgaWYgKGJsb2NrSGFzaCkgewogICAgICBjb3VudCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldGhfZ2V0QmxvY2tUcmFuc2FjdGlvbkNvdW50QnlIYXNoIiwKICAgICAgICBwYXJhbXM6IFtibG9ja0hhc2hdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIHsKICAgICAgY291bnQgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldEJsb2NrVHJhbnNhY3Rpb25Db3VudEJ5TnVtYmVyIiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgcmV0dXJuIGhleFRvTnVtYmVyKGNvdW50KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRDb2RlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldENvZGUoY2xpZW50LCB7IGFkZHJlc3MsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiIH0pIHsKICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgIT09IHZvaWQgMCA/IG51bWJlclRvSGV4KGJsb2NrTnVtYmVyKSA6IHZvaWQgMDsKICAgIGNvbnN0IGhleCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldENvZGUiLAogICAgICBwYXJhbXM6IFthZGRyZXNzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0sIHsgZGVkdXBlOiBCb29sZWFuKGJsb2NrTnVtYmVySGV4KSB9KTsKICAgIGlmIChoZXggPT09ICIweCIpCiAgICAgIHJldHVybiB2b2lkIDA7CiAgICByZXR1cm4gaGV4OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldEZlZUhpc3RvcnkuanMKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL2ZlZUhpc3RvcnkuanMKICBmdW5jdGlvbiBmb3JtYXRGZWVIaXN0b3J5KGZlZUhpc3RvcnkpIHsKICAgIHJldHVybiB7CiAgICAgIGJhc2VGZWVQZXJHYXM6IGZlZUhpc3RvcnkuYmFzZUZlZVBlckdhcy5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSwKICAgICAgZ2FzVXNlZFJhdGlvOiBmZWVIaXN0b3J5Lmdhc1VzZWRSYXRpbywKICAgICAgb2xkZXN0QmxvY2s6IEJpZ0ludChmZWVIaXN0b3J5Lm9sZGVzdEJsb2NrKSwKICAgICAgcmV3YXJkOiBmZWVIaXN0b3J5LnJld2FyZD8ubWFwKChyZXdhcmQpID0+IHJld2FyZC5tYXAoKHZhbHVlKSA9PiBCaWdJbnQodmFsdWUpKSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0RmVlSGlzdG9yeS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEZlZUhpc3RvcnkoY2xpZW50LCB7IGJsb2NrQ291bnQsIGJsb2NrTnVtYmVyLCBibG9ja1RhZyA9ICJsYXRlc3QiLCByZXdhcmRQZXJjZW50aWxlcyB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgZmVlSGlzdG9yeSA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2ZlZUhpc3RvcnkiLAogICAgICBwYXJhbXM6IFsKICAgICAgICBudW1iZXJUb0hleChibG9ja0NvdW50KSwKICAgICAgICBibG9ja051bWJlckhleCB8fCBibG9ja1RhZywKICAgICAgICByZXdhcmRQZXJjZW50aWxlcwogICAgICBdCiAgICB9LCB7IGRlZHVwZTogQm9vbGVhbihibG9ja051bWJlckhleCkgfSk7CiAgICByZXR1cm4gZm9ybWF0RmVlSGlzdG9yeShmZWVIaXN0b3J5KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRGaWx0ZXJMb2dzLmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsdGVyTG9ncyhfY2xpZW50LCB7IGZpbHRlciB9KSB7CiAgICBjb25zdCBzdHJpY3QgPSBmaWx0ZXIuc3RyaWN0ID8/IGZhbHNlOwogICAgY29uc3QgbG9ncyA9IGF3YWl0IGZpbHRlci5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldEZpbHRlckxvZ3MiLAogICAgICBwYXJhbXM6IFtmaWx0ZXIuaWRdCiAgICB9KTsKICAgIGNvbnN0IGZvcm1hdHRlZExvZ3MgPSBsb2dzLm1hcCgobG9nKSA9PiBmb3JtYXRMb2cobG9nKSk7CiAgICBpZiAoIWZpbHRlci5hYmkpCiAgICAgIHJldHVybiBmb3JtYXR0ZWRMb2dzOwogICAgcmV0dXJuIHBhcnNlRXZlbnRMb2dzKHsKICAgICAgYWJpOiBmaWx0ZXIuYWJpLAogICAgICBsb2dzOiBmb3JtYXR0ZWRMb2dzLAogICAgICBzdHJpY3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFByb29mLmpzCiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvY2hhaW4vZGVmaW5lQ2hhaW4uanMKICBmdW5jdGlvbiBkZWZpbmVDaGFpbihjaGFpbikgewogICAgcmV0dXJuIHsKICAgICAgZm9ybWF0dGVyczogdm9pZCAwLAogICAgICBmZWVzOiB2b2lkIDAsCiAgICAgIHNlcmlhbGl6ZXJzOiB2b2lkIDAsCiAgICAgIC4uLmNoYWluCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2NoYWluL2V4dHJhY3RDaGFpbi5qcwogIGZ1bmN0aW9uIGV4dHJhY3RDaGFpbih7IGNoYWlucywgaWQgfSkgewogICAgcmV0dXJuIGNoYWlucy5maW5kKChjaGFpbikgPT4gY2hhaW4uaWQgPT09IGlkKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9yZWdleC5qcwogIHZhciBhcnJheVJlZ2V4ID0gL14oLiopXFsoWzAtOV0qKVxdJC87CiAgdmFyIGJ5dGVzUmVnZXgyID0gL15ieXRlcyhbMS05XXwxWzAtOV18MlswLTldfDNbMC0yXSk/JC87CiAgdmFyIGludGVnZXJSZWdleDIgPSAvXih1P2ludCkoOHwxNnwyNHwzMnw0MHw0OHw1Nnw2NHw3Mnw4MHw4OHw5NnwxMDR8MTEyfDEyMHwxMjh8MTM2fDE0NHwxNTJ8MTYwfDE2OHwxNzZ8MTg0fDE5MnwyMDB8MjA4fDIxNnwyMjR8MjMyfDI0MHwyNDh8MjU2KT8kLzsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy9zb2NrZXQuanMKICBpbml0X3JlcXVlc3QoKTsKICBpbml0X2NyZWF0ZUJhdGNoU2NoZWR1bGVyKCk7CiAgdmFyIHNvY2tldENsaWVudENhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRTb2NrZXRScGNDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBnZXRTb2NrZXQ6IGdldFNvY2tldDIsIGtlZXBBbGl2ZSA9IHRydWUsIGtleSA9ICJzb2NrZXQiLCByZWNvbm5lY3QgPSB0cnVlLCB1cmwgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB7IGludGVydmFsOiBrZWVwQWxpdmVJbnRlcnZhbCA9IDNlNCB9ID0gdHlwZW9mIGtlZXBBbGl2ZSA9PT0gIm9iamVjdCIgPyBrZWVwQWxpdmUgOiB7fTsKICAgIGNvbnN0IHsgYXR0ZW1wdHMgPSA1LCBkZWxheSA9IDJlMyB9ID0gdHlwZW9mIHJlY29ubmVjdCA9PT0gIm9iamVjdCIgPyByZWNvbm5lY3QgOiB7fTsKICAgIGxldCBzb2NrZXRDbGllbnQgPSBzb2NrZXRDbGllbnRDYWNoZS5nZXQoYCR7a2V5fToke3VybH1gKTsKICAgIGlmIChzb2NrZXRDbGllbnQpCiAgICAgIHJldHVybiBzb2NrZXRDbGllbnQ7CiAgICBsZXQgcmVjb25uZWN0Q291bnQgPSAwOwogICAgY29uc3QgeyBzY2hlZHVsZSB9ID0gY3JlYXRlQmF0Y2hTY2hlZHVsZXIoewogICAgICBpZDogYCR7a2V5fToke3VybH1gLAogICAgICBmbjogYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHJlcXVlc3RzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgICAgICBsZXQgZXJyb3I7CiAgICAgICAgbGV0IHNvY2tldDsKICAgICAgICBsZXQga2VlcEFsaXZlVGltZXI7CiAgICAgICAgYXN5bmMgZnVuY3Rpb24gc2V0dXAoKSB7CiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRTb2NrZXQyKHsKICAgICAgICAgICAgb25DbG9zZSgpIHsKICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlcXVlc3Qgb2YgcmVxdWVzdHMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uRXJyb3I/LihuZXcgU29ja2V0Q2xvc2VkRXJyb3IoeyB1cmwgfSkpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybCB9KSk7CiAgICAgICAgICAgICAgcmVxdWVzdHMuY2xlYXIoKTsKICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLmNsZWFyKCk7CiAgICAgICAgICAgICAgaWYgKHJlY29ubmVjdCAmJiByZWNvbm5lY3RDb3VudCA8IGF0dGVtcHRzKQogICAgICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgIHJlY29ubmVjdENvdW50Kys7CiAgICAgICAgICAgICAgICAgIGF3YWl0IHNldHVwKCkuY2F0Y2goY29uc29sZS5lcnJvcik7CiAgICAgICAgICAgICAgICB9LCBkZWxheSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRXJyb3IoZXJyb3JfKSB7CiAgICAgICAgICAgICAgZXJyb3IgPSBlcnJvcl87CiAgICAgICAgICAgICAgZm9yIChjb25zdCByZXF1ZXN0IG9mIHJlcXVlc3RzLnZhbHVlcygpKQogICAgICAgICAgICAgICAgcmVxdWVzdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaXB0aW9uIG9mIHN1YnNjcmlwdGlvbnMudmFsdWVzKCkpCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ub25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXF1ZXN0cy5jbGVhcigpOwogICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuY2xlYXIoKTsKICAgICAgICAgICAgICBpZiAocmVjb25uZWN0ICYmIHJlY29ubmVjdENvdW50IDwgYXR0ZW1wdHMpCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgcmVjb25uZWN0Q291bnQrKzsKICAgICAgICAgICAgICAgICAgYXdhaXQgc2V0dXAoKS5jYXRjaChjb25zb2xlLmVycm9yKTsKICAgICAgICAgICAgICAgIH0sIGRlbGF5KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25PcGVuKCkgewogICAgICAgICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgICAgICAgIHJlY29ubmVjdENvdW50ID0gMDsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25SZXNwb25zZShkYXRhKSB7CiAgICAgICAgICAgICAgY29uc3QgaXNTdWJzY3JpcHRpb24gPSBkYXRhLm1ldGhvZCA9PT0gImV0aF9zdWJzY3JpcHRpb24iOwogICAgICAgICAgICAgIGNvbnN0IGlkID0gaXNTdWJzY3JpcHRpb24gPyBkYXRhLnBhcmFtcy5zdWJzY3JpcHRpb24gOiBkYXRhLmlkOwogICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gaXNTdWJzY3JpcHRpb24gPyBzdWJzY3JpcHRpb25zIDogcmVxdWVzdHM7CiAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBjYWNoZS5nZXQoaWQpOwogICAgICAgICAgICAgIGlmIChjYWxsYmFjaykKICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9uUmVzcG9uc2UoZGF0YSk7CiAgICAgICAgICAgICAgaWYgKCFpc1N1YnNjcmlwdGlvbikKICAgICAgICAgICAgICAgIGNhY2hlLmRlbGV0ZShpZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgc29ja2V0ID0gcmVzdWx0OwogICAgICAgICAgaWYgKGtlZXBBbGl2ZSkgewogICAgICAgICAgICBpZiAoa2VlcEFsaXZlVGltZXIpCiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChrZWVwQWxpdmVUaW1lcik7CiAgICAgICAgICAgIGtlZXBBbGl2ZVRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gc29ja2V0LnBpbmc/LigpLCBrZWVwQWxpdmVJbnRlcnZhbCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgICBhd2FpdCBzZXR1cCgpOwogICAgICAgIGVycm9yID0gdm9pZCAwOwogICAgICAgIHNvY2tldENsaWVudCA9IHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBrZWVwQWxpdmVUaW1lciAmJiBjbGVhckludGVydmFsKGtlZXBBbGl2ZVRpbWVyKTsKICAgICAgICAgICAgc29ja2V0LmNsb3NlKCk7CiAgICAgICAgICAgIHNvY2tldENsaWVudENhY2hlLmRlbGV0ZShgJHtrZXl9OiR7dXJsfWApOwogICAgICAgICAgfSwKICAgICAgICAgIGdldCBzb2NrZXQoKSB7CiAgICAgICAgICAgIHJldHVybiBzb2NrZXQ7CiAgICAgICAgICB9LAogICAgICAgICAgcmVxdWVzdCh7IGJvZHksIG9uRXJyb3IsIG9uUmVzcG9uc2UgfSkgewogICAgICAgICAgICBpZiAoZXJyb3IgJiYgb25FcnJvcikKICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTsKICAgICAgICAgICAgY29uc3QgaWQgPSBib2R5LmlkID8/IGlkQ2FjaGUudGFrZSgpOwogICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuaWQgPT09ICJudW1iZXIiICYmIGlkICE9PSByZXNwb25zZS5pZCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBpZiAoYm9keS5tZXRob2QgPT09ICJldGhfc3Vic2NyaWJlIiAmJiB0eXBlb2YgcmVzcG9uc2UucmVzdWx0ID09PSAic3RyaW5nIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuc2V0KHJlc3BvbnNlLnJlc3VsdCwgewogICAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgb25FcnJvcgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgaWYgKGJvZHkubWV0aG9kID09PSAiZXRoX3Vuc3Vic2NyaWJlIikKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZGVsZXRlKGJvZHkucGFyYW1zPy5bMF0pOwogICAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZXF1ZXN0cy5zZXQoaWQsIHsgb25SZXNwb25zZTogY2FsbGJhY2ssIG9uRXJyb3IgfSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgc29ja2V0LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBqc29ucnBjOiAiMi4wIiwKICAgICAgICAgICAgICAgICAgaWQsCiAgICAgICAgICAgICAgICAgIC4uLmJvZHkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IyKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0QXN5bmMoeyBib2R5LCB0aW1lb3V0ID0gMWU0IH0pIHsKICAgICAgICAgICAgcmV0dXJuIHdpdGhUaW1lb3V0KCgpID0+IG5ldyBQcm9taXNlKChvblJlc3BvbnNlLCBvbkVycm9yKSA9PiB0aGlzLnJlcXVlc3QoewogICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgb25FcnJvciwKICAgICAgICAgICAgICBvblJlc3BvbnNlCiAgICAgICAgICAgIH0pKSwgewogICAgICAgICAgICAgIGVycm9ySW5zdGFuY2U6IG5ldyBUaW1lb3V0RXJyb3IoeyBib2R5LCB1cmwgfSksCiAgICAgICAgICAgICAgdGltZW91dAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0cywKICAgICAgICAgIHN1YnNjcmlwdGlvbnMsCiAgICAgICAgICB1cmwKICAgICAgICB9OwogICAgICAgIHNvY2tldENsaWVudENhY2hlLnNldChgJHtrZXl9OiR7dXJsfWAsIHNvY2tldENsaWVudCk7CiAgICAgICAgcmV0dXJuIFtzb2NrZXRDbGllbnRdOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IFtfLCBbc29ja2V0Q2xpZW50X11dID0gYXdhaXQgc2NoZWR1bGUoKTsKICAgIHJldHVybiBzb2NrZXRDbGllbnRfOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3JwYy93ZWJTb2NrZXQuanMKICBhc3luYyBmdW5jdGlvbiBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsLCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IHsga2VlcEFsaXZlLCByZWNvbm5lY3QgfSA9IG9wdGlvbnM7CiAgICByZXR1cm4gZ2V0U29ja2V0UnBjQ2xpZW50KHsKICAgICAgYXN5bmMgZ2V0U29ja2V0KHsgb25DbG9zZSwgb25FcnJvciwgb25PcGVuLCBvblJlc3BvbnNlIH0pIHsKICAgICAgICBjb25zdCBXZWJTb2NrZXQzID0gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiAoaW5pdF9uYXRpdmUoKSwgbmF0aXZlX2V4cG9ydHMpKS50aGVuKChtb2R1bGUpID0+IG1vZHVsZS5XZWJTb2NrZXQpOwogICAgICAgIGNvbnN0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQzKHVybCk7CiAgICAgICAgZnVuY3Rpb24gb25DbG9zZV8oKSB7CiAgICAgICAgICBvbkNsb3NlKCk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIG9uTWVzc2FnZSk7CiAgICAgICAgICBzb2NrZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZXJyb3IiLCBvbkVycm9yKTsKICAgICAgICAgIHNvY2tldC5yZW1vdmVFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gb25NZXNzYWdlKHsgZGF0YSB9KSB7CiAgICAgICAgICBvblJlc3BvbnNlKEpTT04ucGFyc2UoZGF0YSkpOwogICAgICAgIH0KICAgICAgICBzb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcigiY2xvc2UiLCBvbkNsb3NlXyk7CiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBvbk1lc3NhZ2UpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJlcnJvciIsIG9uRXJyb3IpOwogICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCJvcGVuIiwgb25PcGVuKTsKICAgICAgICBpZiAoc29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldDMuQ09OTkVDVElORykgewogICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICBpZiAoIXNvY2tldCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHNvY2tldC5vbm9wZW4gPSByZXNvbHZlOwogICAgICAgICAgICBzb2NrZXQub25lcnJvciA9IHJlamVjdDsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCB7IGNsb3NlOiBjbG9zZV8gfSA9IHNvY2tldDsKICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihzb2NrZXQsIHsKICAgICAgICAgIGNsb3NlKCkgewogICAgICAgICAgICBjbG9zZV8uYmluZChzb2NrZXQpKCk7CiAgICAgICAgICAgIG9uQ2xvc2UoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBwaW5nKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgV2ViU29ja2V0UmVxdWVzdEVycm9yKHsKICAgICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgICBjYXVzZTogbmV3IFNvY2tldENsb3NlZEVycm9yKHsgdXJsOiBzb2NrZXQudXJsIH0pCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjb25zdCBib2R5ID0gewogICAgICAgICAgICAgICAganNvbnJwYzogIjIuMCIsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICJuZXRfdmVyc2lvbiIsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShib2R5KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICByZXF1ZXN0KHsgYm9keSB9KSB7CiAgICAgICAgICAgIGlmIChzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NFRCB8fCBzb2NrZXQucmVhZHlTdGF0ZSA9PT0gc29ja2V0LkNMT1NJTkcpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IFdlYlNvY2tldFJlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgICBib2R5LAogICAgICAgICAgICAgICAgdXJsOiBzb2NrZXQudXJsLAogICAgICAgICAgICAgICAgY2F1c2U6IG5ldyBTb2NrZXRDbG9zZWRFcnJvcih7IHVybDogc29ja2V0LnVybCB9KQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoYm9keSkpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBrZWVwQWxpdmUsCiAgICAgIHJlY29ubmVjdCwKICAgICAgdXJsCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9ycGMvY29tcGF0LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0U29ja2V0KHVybCkgewogICAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybCk7CiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihjbGllbnQuc29ja2V0LCB7CiAgICAgIHJlcXVlc3RzOiBjbGllbnQucmVxdWVzdHMsCiAgICAgIHN1YnNjcmlwdGlvbnM6IGNsaWVudC5zdWJzY3JpcHRpb25zCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90eXBlZERhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfYWRkcmVzcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXJyb3JzL3R5cGVkRGF0YS5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICAgIHN1cGVyKGBJbnZhbGlkIHByaW1hcnkgdHlwZSBcYCR7cHJpbWFyeVR5cGV9XGAgbXVzdCBiZSBvbmUgb2YgXGAke0pTT04uc3RyaW5naWZ5KE9iamVjdC5rZXlzKHR5cGVzKSl9XGAuYCwgewogICAgICAgIGRvY3NQYXRoOiAiL2FwaS9nbG9zc2FyeS9FcnJvcnMjdHlwZWRkYXRhaW52YWxpZHByaW1hcnl0eXBlZXJyb3IiLAogICAgICAgIG1ldGFNZXNzYWdlczogWyJDaGVjayB0aGF0IHRoZSBwcmltYXJ5IHR5cGUgaXMgYSBrZXkgaW4gYHR5cGVzYC4iXQogICAgICB9KTsKICAgIH0KICB9OwogIHZhciBJbnZhbGlkU3RydWN0VHlwZUVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdHlwZSB9KSB7CiAgICAgIHN1cGVyKGBTdHJ1Y3QgdHlwZSAiJHt0eXBlfSIgaXMgaW52YWxpZC5gLCB7CiAgICAgICAgbWV0YU1lc3NhZ2VzOiBbIlN0cnVjdCB0eXBlIG11c3Qgbm90IGJlIGEgU29saWRpdHkgdHlwZS4iXSwKICAgICAgICBuYW1lOiAiSW52YWxpZFN0cnVjdFR5cGVFcnJvciIKICAgICAgfSk7CiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hUeXBlZERhdGEuanMKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X2tlY2NhazI1NigpOwogIGZ1bmN0aW9uIGhhc2hUeXBlZERhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBkb21haW4gPSB7fSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCB0eXBlcyA9IHsKICAgICAgRUlQNzEyRG9tYWluOiBnZXRUeXBlc0ZvckVJUDcxMkRvbWFpbih7IGRvbWFpbiB9KSwKICAgICAgLi4ucGFyYW1ldGVycy50eXBlcwogICAgfTsKICAgIHZhbGlkYXRlVHlwZWREYXRhKHsKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlLAogICAgICBwcmltYXJ5VHlwZSwKICAgICAgdHlwZXMKICAgIH0pOwogICAgY29uc3QgcGFydHMgPSBbIjB4MTkwMSJdOwogICAgaWYgKGRvbWFpbikKICAgICAgcGFydHMucHVzaChoYXNoRG9tYWluKHsKICAgICAgICBkb21haW4sCiAgICAgICAgdHlwZXMKICAgICAgfSkpOwogICAgaWYgKHByaW1hcnlUeXBlICE9PSAiRUlQNzEyRG9tYWluIikKICAgICAgcGFydHMucHVzaChoYXNoU3RydWN0KHsKICAgICAgICBkYXRhOiBtZXNzYWdlLAogICAgICAgIHByaW1hcnlUeXBlLAogICAgICAgIHR5cGVzCiAgICAgIH0pKTsKICAgIHJldHVybiBrZWNjYWsyNTYoY29uY2F0KHBhcnRzKSk7CiAgfQogIGZ1bmN0aW9uIGhhc2hEb21haW4oeyBkb21haW4sIHR5cGVzIH0pIHsKICAgIHJldHVybiBoYXNoU3RydWN0KHsKICAgICAgZGF0YTogZG9tYWluLAogICAgICBwcmltYXJ5VHlwZTogIkVJUDcxMkRvbWFpbiIsCiAgICAgIHR5cGVzCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gaGFzaFN0cnVjdCh7IGRhdGEsIHByaW1hcnlUeXBlLCB0eXBlcyB9KSB7CiAgICBjb25zdCBlbmNvZGVkID0gZW5jb2RlRGF0YSh7CiAgICAgIGRhdGEsCiAgICAgIHByaW1hcnlUeXBlLAogICAgICB0eXBlcwogICAgfSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWQpOwogIH0KICBmdW5jdGlvbiBlbmNvZGVEYXRhKHsgZGF0YSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pIHsKICAgIGNvbnN0IGVuY29kZWRUeXBlcyA9IFt7IHR5cGU6ICJieXRlczMyIiB9XTsKICAgIGNvbnN0IGVuY29kZWRWYWx1ZXMgPSBbaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSldOwogICAgZm9yIChjb25zdCBmaWVsZCBvZiB0eXBlc1twcmltYXJ5VHlwZV0pIHsKICAgICAgY29uc3QgW3R5cGUsIHZhbHVlXSA9IGVuY29kZUZpZWxkKHsKICAgICAgICB0eXBlcywKICAgICAgICBuYW1lOiBmaWVsZC5uYW1lLAogICAgICAgIHR5cGU6IGZpZWxkLnR5cGUsCiAgICAgICAgdmFsdWU6IGRhdGFbZmllbGQubmFtZV0KICAgICAgfSk7CiAgICAgIGVuY29kZWRUeXBlcy5wdXNoKHR5cGUpOwogICAgICBlbmNvZGVkVmFsdWVzLnB1c2godmFsdWUpOwogICAgfQogICAgcmV0dXJuIGVuY29kZUFiaVBhcmFtZXRlcnMoZW5jb2RlZFR5cGVzLCBlbmNvZGVkVmFsdWVzKTsKICB9CiAgZnVuY3Rpb24gaGFzaFR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgY29uc3QgZW5jb2RlZEhhc2hUeXBlID0gdG9IZXgoZW5jb2RlVHlwZSh7IHByaW1hcnlUeXBlLCB0eXBlcyB9KSk7CiAgICByZXR1cm4ga2VjY2FrMjU2KGVuY29kZWRIYXNoVHlwZSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZVR5cGUoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSkgewogICAgbGV0IHJlc3VsdCA9ICIiOwogICAgY29uc3QgdW5zb3J0ZWREZXBzID0gZmluZFR5cGVEZXBlbmRlbmNpZXMoeyBwcmltYXJ5VHlwZSwgdHlwZXMgfSk7CiAgICB1bnNvcnRlZERlcHMuZGVsZXRlKHByaW1hcnlUeXBlKTsKICAgIGNvbnN0IGRlcHMgPSBbcHJpbWFyeVR5cGUsIC4uLkFycmF5LmZyb20odW5zb3J0ZWREZXBzKS5zb3J0KCldOwogICAgZm9yIChjb25zdCB0eXBlIG9mIGRlcHMpIHsKICAgICAgcmVzdWx0ICs9IGAke3R5cGV9KCR7dHlwZXNbdHlwZV0ubWFwKCh7IG5hbWUsIHR5cGU6IHQgfSkgPT4gYCR7dH0gJHtuYW1lfWApLmpvaW4oIiwiKX0pYDsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IHByaW1hcnlUeXBlXywgdHlwZXMgfSwgcmVzdWx0cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCkpIHsKICAgIGNvbnN0IG1hdGNoID0gcHJpbWFyeVR5cGVfLm1hdGNoKC9eXHcqL3UpOwogICAgY29uc3QgcHJpbWFyeVR5cGUgPSBtYXRjaD8uWzBdOwogICAgaWYgKHJlc3VsdHMuaGFzKHByaW1hcnlUeXBlKSB8fCB0eXBlc1twcmltYXJ5VHlwZV0gPT09IHZvaWQgMCkgewogICAgICByZXR1cm4gcmVzdWx0czsKICAgIH0KICAgIHJlc3VsdHMuYWRkKHByaW1hcnlUeXBlKTsKICAgIGZvciAoY29uc3QgZmllbGQgb2YgdHlwZXNbcHJpbWFyeVR5cGVdKSB7CiAgICAgIGZpbmRUeXBlRGVwZW5kZW5jaWVzKHsgcHJpbWFyeVR5cGU6IGZpZWxkLnR5cGUsIHR5cGVzIH0sIHJlc3VsdHMpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQogIGZ1bmN0aW9uIGVuY29kZUZpZWxkKHsgdHlwZXMsIG5hbWUsIHR5cGUsIHZhbHVlIH0pIHsKICAgIGlmICh0eXBlc1t0eXBlXSAhPT0gdm9pZCAwKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgeyB0eXBlOiAiYnl0ZXMzMiIgfSwKICAgICAgICBrZWNjYWsyNTYoZW5jb2RlRGF0YSh7IGRhdGE6IHZhbHVlLCBwcmltYXJ5VHlwZTogdHlwZSwgdHlwZXMgfSkpCiAgICAgIF07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikgewogICAgICBjb25zdCBwcmVwZW5kID0gdmFsdWUubGVuZ3RoICUgMiA/ICIwIiA6ICIiOwogICAgICB2YWx1ZSA9IGAweCR7cHJlcGVuZCArIHZhbHVlLnNsaWNlKDIpfWA7CiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHZhbHVlKV07CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBbeyB0eXBlOiAiYnl0ZXMzMiIgfSwga2VjY2FrMjU2KHRvSGV4KHZhbHVlKSldOwogICAgaWYgKHR5cGUubGFzdEluZGV4T2YoIl0iKSA9PT0gdHlwZS5sZW5ndGggLSAxKSB7CiAgICAgIGNvbnN0IHBhcnNlZFR5cGUgPSB0eXBlLnNsaWNlKDAsIHR5cGUubGFzdEluZGV4T2YoIlsiKSk7CiAgICAgIGNvbnN0IHR5cGVWYWx1ZVBhaXJzID0gdmFsdWUubWFwKChpdGVtKSA9PiBlbmNvZGVGaWVsZCh7CiAgICAgICAgbmFtZSwKICAgICAgICB0eXBlOiBwYXJzZWRUeXBlLAogICAgICAgIHR5cGVzLAogICAgICAgIHZhbHVlOiBpdGVtCiAgICAgIH0pKTsKICAgICAgcmV0dXJuIFsKICAgICAgICB7IHR5cGU6ICJieXRlczMyIiB9LAogICAgICAgIGtlY2NhazI1NihlbmNvZGVBYmlQYXJhbWV0ZXJzKHR5cGVWYWx1ZVBhaXJzLm1hcCgoW3RdKSA9PiB0KSwgdHlwZVZhbHVlUGFpcnMubWFwKChbLCB2XSkgPT4gdikpKQogICAgICBdOwogICAgfQogICAgcmV0dXJuIFt7IHR5cGUgfSwgdmFsdWVdOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3R5cGVkRGF0YS5qcwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplVHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgZG9tYWluOiBkb21haW5fLCBtZXNzYWdlOiBtZXNzYWdlXywgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgbm9ybWFsaXplRGF0YSA9IChzdHJ1Y3QsIGRhdGFfKSA9PiB7CiAgICAgIGNvbnN0IGRhdGEgPSB7IC4uLmRhdGFfIH07CiAgICAgIGZvciAoY29uc3QgcGFyYW0gb2Ygc3RydWN0KSB7CiAgICAgICAgY29uc3QgeyBuYW1lLCB0eXBlIH0gPSBwYXJhbTsKICAgICAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKQogICAgICAgICAgZGF0YVtuYW1lXSA9IGRhdGFbbmFtZV0udG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgICByZXR1cm4gZGF0YTsKICAgIH07CiAgICBjb25zdCBkb21haW4gPSAoKCkgPT4gewogICAgICBpZiAoIXR5cGVzLkVJUDcxMkRvbWFpbikKICAgICAgICByZXR1cm4ge307CiAgICAgIGlmICghZG9tYWluXykKICAgICAgICByZXR1cm4ge307CiAgICAgIHJldHVybiBub3JtYWxpemVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluXyk7CiAgICB9KSgpOwogICAgY29uc3QgbWVzc2FnZSA9ICgoKSA9PiB7CiAgICAgIGlmIChwcmltYXJ5VHlwZSA9PT0gIkVJUDcxMkRvbWFpbiIpCiAgICAgICAgcmV0dXJuIHZvaWQgMDsKICAgICAgcmV0dXJuIG5vcm1hbGl6ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlXyk7CiAgICB9KSgpOwogICAgcmV0dXJuIHN0cmluZ2lmeSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVR5cGVkRGF0YShwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdmFsaWRhdGVEYXRhID0gKHN0cnVjdCwgZGF0YSkgPT4gewogICAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHN0cnVjdCkgewogICAgICAgIGNvbnN0IHsgbmFtZSwgdHlwZSB9ID0gcGFyYW07CiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW25hbWVdOwogICAgICAgIGNvbnN0IGludGVnZXJNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICAgICAgaWYgKGludGVnZXJNYXRjaCAmJiAodHlwZW9mIHZhbHVlID09PSAibnVtYmVyIiB8fCB0eXBlb2YgdmFsdWUgPT09ICJiaWdpbnQiKSkgewogICAgICAgICAgY29uc3QgW190eXBlLCBiYXNlMiwgc2l6ZV9dID0gaW50ZWdlck1hdGNoOwogICAgICAgICAgbnVtYmVyVG9IZXgodmFsdWUsIHsKICAgICAgICAgICAgc2lnbmVkOiBiYXNlMiA9PT0gImludCIsCiAgICAgICAgICAgIHNpemU6IE51bWJlci5wYXJzZUludChzaXplXykgLyA4CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGUgPT09ICJhZGRyZXNzIiAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFpc0FkZHJlc3ModmFsdWUpKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB2YWx1ZSB9KTsKICAgICAgICBjb25zdCBieXRlc01hdGNoID0gdHlwZS5tYXRjaChieXRlc1JlZ2V4Mik7CiAgICAgICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgICAgIGNvbnN0IFtfdHlwZSwgc2l6ZV9dID0gYnl0ZXNNYXRjaDsKICAgICAgICAgIGlmIChzaXplXyAmJiBzaXplKHZhbHVlKSAhPT0gTnVtYmVyLnBhcnNlSW50KHNpemVfKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEJ5dGVzU2l6ZU1pc21hdGNoRXJyb3IoewogICAgICAgICAgICAgIGV4cGVjdGVkU2l6ZTogTnVtYmVyLnBhcnNlSW50KHNpemVfKSwKICAgICAgICAgICAgICBnaXZlblNpemU6IHNpemUodmFsdWUpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCBzdHJ1Y3QyID0gdHlwZXNbdHlwZV07CiAgICAgICAgaWYgKHN0cnVjdDIpIHsKICAgICAgICAgIHZhbGlkYXRlUmVmZXJlbmNlKHR5cGUpOwogICAgICAgICAgdmFsaWRhdGVEYXRhKHN0cnVjdDIsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICBpZiAodHlwZXMuRUlQNzEyRG9tYWluICYmIGRvbWFpbikKICAgICAgdmFsaWRhdGVEYXRhKHR5cGVzLkVJUDcxMkRvbWFpbiwgZG9tYWluKTsKICAgIGlmIChwcmltYXJ5VHlwZSAhPT0gIkVJUDcxMkRvbWFpbiIpIHsKICAgICAgaWYgKHR5cGVzW3ByaW1hcnlUeXBlXSkKICAgICAgICB2YWxpZGF0ZURhdGEodHlwZXNbcHJpbWFyeVR5cGVdLCBtZXNzYWdlKTsKICAgICAgZWxzZQogICAgICAgIHRocm93IG5ldyBJbnZhbGlkUHJpbWFyeVR5cGVFcnJvcih7IHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0VHlwZXNGb3JFSVA3MTJEb21haW4oeyBkb21haW4gfSkgewogICAgcmV0dXJuIFsKICAgICAgdHlwZW9mIGRvbWFpbj8ubmFtZSA9PT0gInN0cmluZyIgJiYgeyBuYW1lOiAibmFtZSIsIHR5cGU6ICJzdHJpbmciIH0sCiAgICAgIGRvbWFpbj8udmVyc2lvbiAmJiB7IG5hbWU6ICJ2ZXJzaW9uIiwgdHlwZTogInN0cmluZyIgfSwKICAgICAgdHlwZW9mIGRvbWFpbj8uY2hhaW5JZCA9PT0gIm51bWJlciIgJiYgewogICAgICAgIG5hbWU6ICJjaGFpbklkIiwKICAgICAgICB0eXBlOiAidWludDI1NiIKICAgICAgfSwKICAgICAgZG9tYWluPy52ZXJpZnlpbmdDb250cmFjdCAmJiB7CiAgICAgICAgbmFtZTogInZlcmlmeWluZ0NvbnRyYWN0IiwKICAgICAgICB0eXBlOiAiYWRkcmVzcyIKICAgICAgfSwKICAgICAgZG9tYWluPy5zYWx0ICYmIHsgbmFtZTogInNhbHQiLCB0eXBlOiAiYnl0ZXMzMiIgfQogICAgXS5maWx0ZXIoQm9vbGVhbik7CiAgfQogIGZ1bmN0aW9uIGRvbWFpblNlcGFyYXRvcih7IGRvbWFpbiB9KSB7CiAgICByZXR1cm4gaGFzaERvbWFpbih7CiAgICAgIGRvbWFpbiwKICAgICAgdHlwZXM6IHsKICAgICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pCiAgICAgIH0KICAgIH0pOwogIH0KICBmdW5jdGlvbiB2YWxpZGF0ZVJlZmVyZW5jZSh0eXBlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiIHx8IHR5cGUgPT09ICJib29sIiB8fCB0eXBlID09PSAic3RyaW5nIiB8fCB0eXBlLnN0YXJ0c1dpdGgoImJ5dGVzIikgfHwgdHlwZS5zdGFydHNXaXRoKCJ1aW50IikgfHwgdHlwZS5zdGFydHNXaXRoKCJpbnQiKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTdHJ1Y3RUeXBlRXJyb3IoeyB0eXBlIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVGdW5jdGlvbkRhdGEuanMKICBpbml0X2FiaSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZGVjb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBmdW5jdGlvbiBkZWNvZGVGdW5jdGlvbkRhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGRhdGEgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzbGljZShkYXRhLCAwLCA0KTsKICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gYWJpMi5maW5kKCh4KSA9PiB4LnR5cGUgPT09ICJmdW5jdGlvbiIgJiYgc2lnbmF0dXJlID09PSB0b0Z1bmN0aW9uU2VsZWN0b3IoZm9ybWF0QWJpSXRlbTIoeCkpKTsKICAgIGlmICghZGVzY3JpcHRpb24pCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvblNpZ25hdHVyZU5vdEZvdW5kRXJyb3Ioc2lnbmF0dXJlLCB7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9jb250cmFjdC9kZWNvZGVGdW5jdGlvbkRhdGEiCiAgICAgIH0pOwogICAgcmV0dXJuIHsKICAgICAgZnVuY3Rpb25OYW1lOiBkZXNjcmlwdGlvbi5uYW1lLAogICAgICBhcmdzOiAiaW5wdXRzIiBpbiBkZXNjcmlwdGlvbiAmJiBkZXNjcmlwdGlvbi5pbnB1dHMgJiYgZGVzY3JpcHRpb24uaW5wdXRzLmxlbmd0aCA+IDAgPyBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgc2xpY2UoZGF0YSwgNCkpIDogdm9pZCAwCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9lbmNvZGVFcnJvclJlc3VsdC5qcwogIGluaXRfYWJpKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvRnVuY3Rpb25TZWxlY3RvcigpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZm9ybWF0QWJpSXRlbTIoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg2ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUVycm9yUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVFcnJvclJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZXJyb3JOYW1lLCBhcmdzIH0gPSBwYXJhbWV0ZXJzOwogICAgbGV0IGFiaUl0ZW0gPSBhYmkyWzBdOwogICAgaWYgKGVycm9yTmFtZSkgewogICAgICBjb25zdCBpdGVtID0gZ2V0QWJpSXRlbSh7IGFiaTogYWJpMiwgYXJncywgbmFtZTogZXJyb3JOYW1lIH0pOwogICAgICBpZiAoIWl0ZW0pCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9yTm90Rm91bmRFcnJvcihlcnJvck5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgYWJpSXRlbSA9IGl0ZW07CiAgICB9CiAgICBpZiAoYWJpSXRlbS50eXBlICE9PSAiZXJyb3IiKQogICAgICB0aHJvdyBuZXcgQWJpRXJyb3JOb3RGb3VuZEVycm9yKHZvaWQgMCwgeyBkb2NzUGF0aDogZG9jc1BhdGg2IH0pOwogICAgY29uc3QgZGVmaW5pdGlvbiA9IGZvcm1hdEFiaUl0ZW0yKGFiaUl0ZW0pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdG9GdW5jdGlvblNlbGVjdG9yKGRlZmluaXRpb24pOwogICAgbGV0IGRhdGEgPSAiMHgiOwogICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGggPiAwKSB7CiAgICAgIGlmICghYWJpSXRlbS5pbnB1dHMpCiAgICAgICAgdGhyb3cgbmV3IEFiaUVycm9ySW5wdXRzTm90Rm91bmRFcnJvcihhYmlJdGVtLm5hbWUsIHsgZG9jc1BhdGg6IGRvY3NQYXRoNiB9KTsKICAgICAgZGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoYWJpSXRlbS5pbnB1dHMsIGFyZ3MpOwogICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbc2lnbmF0dXJlLCBkYXRhXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaW5kZXguanMKICBpbml0X2VuY29kZUZ1bmN0aW9uRGF0YSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWJpL2VuY29kZUZ1bmN0aW9uUmVzdWx0LmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2VuY29kZUFiaVBhcmFtZXRlcnMoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKICB2YXIgZG9jc1BhdGg3ID0gIi9kb2NzL2NvbnRyYWN0L2VuY29kZUZ1bmN0aW9uUmVzdWx0IjsKICBmdW5jdGlvbiBlbmNvZGVGdW5jdGlvblJlc3VsdChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFiaTogYWJpMiwgZnVuY3Rpb25OYW1lLCByZXN1bHQgfSA9IHBhcmFtZXRlcnM7CiAgICBsZXQgYWJpSXRlbSA9IGFiaTJbMF07CiAgICBpZiAoZnVuY3Rpb25OYW1lKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSBnZXRBYmlJdGVtKHsgYWJpOiBhYmkyLCBuYW1lOiBmdW5jdGlvbk5hbWUgfSk7CiAgICAgIGlmICghaXRlbSkKICAgICAgICB0aHJvdyBuZXcgQWJpRnVuY3Rpb25Ob3RGb3VuZEVycm9yKGZ1bmN0aW9uTmFtZSwgeyBkb2NzUGF0aDogZG9jc1BhdGg3IH0pOwogICAgICBhYmlJdGVtID0gaXRlbTsKICAgIH0KICAgIGlmIChhYmlJdGVtLnR5cGUgIT09ICJmdW5jdGlvbiIpCiAgICAgIHRocm93IG5ldyBBYmlGdW5jdGlvbk5vdEZvdW5kRXJyb3Iodm9pZCAwLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBpZiAoIWFiaUl0ZW0ub3V0cHV0cykKICAgICAgdGhyb3cgbmV3IEFiaUZ1bmN0aW9uT3V0cHV0c05vdEZvdW5kRXJyb3IoYWJpSXRlbS5uYW1lLCB7IGRvY3NQYXRoOiBkb2NzUGF0aDcgfSk7CiAgICBsZXQgdmFsdWVzID0gQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0IDogW3Jlc3VsdF07CiAgICBpZiAoYWJpSXRlbS5vdXRwdXRzLmxlbmd0aCA9PT0gMCAmJiAhdmFsdWVzWzBdKQogICAgICB2YWx1ZXMgPSBbXTsKICAgIHJldHVybiBlbmNvZGVBYmlQYXJhbWV0ZXJzKGFiaUl0ZW0ub3V0cHV0cywgdmFsdWVzKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hYmkvZW5jb2RlUGFja2VkLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9wYWQoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZW5jb2RlUGFja2VkKHR5cGVzLCB2YWx1ZXMpIHsKICAgIGlmICh0eXBlcy5sZW5ndGggIT09IHZhbHVlcy5sZW5ndGgpCiAgICAgIHRocm93IG5ldyBBYmlFbmNvZGluZ0xlbmd0aE1pc21hdGNoRXJyb3IoewogICAgICAgIGV4cGVjdGVkTGVuZ3RoOiB0eXBlcy5sZW5ndGgsCiAgICAgICAgZ2l2ZW5MZW5ndGg6IHZhbHVlcy5sZW5ndGgKICAgICAgfSk7CiAgICBjb25zdCBkYXRhID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHR5cGUgPSB0eXBlc1tpXTsKICAgICAgY29uc3QgdmFsdWUgPSB2YWx1ZXNbaV07CiAgICAgIGRhdGEucHVzaChlbmNvZGUodHlwZSwgdmFsdWUpKTsKICAgIH0KICAgIHJldHVybiBjb25jYXRIZXgoZGF0YSk7CiAgfQogIGZ1bmN0aW9uIGVuY29kZSh0eXBlLCB2YWx1ZSwgaXNBcnJheSA9IGZhbHNlKSB7CiAgICBpZiAodHlwZSA9PT0gImFkZHJlc3MiKSB7CiAgICAgIGNvbnN0IGFkZHJlc3MgPSB2YWx1ZTsKICAgICAgaWYgKCFpc0FkZHJlc3MoYWRkcmVzcykpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICByZXR1cm4gcGFkKGFkZHJlc3MudG9Mb3dlckNhc2UoKSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwKICAgICAgfSk7CiAgICB9CiAgICBpZiAodHlwZSA9PT0gInN0cmluZyIpCiAgICAgIHJldHVybiBzdHJpbmdUb0hleCh2YWx1ZSk7CiAgICBpZiAodHlwZSA9PT0gImJ5dGVzIikKICAgICAgcmV0dXJuIHZhbHVlOwogICAgaWYgKHR5cGUgPT09ICJib29sIikKICAgICAgcmV0dXJuIHBhZChib29sVG9IZXgodmFsdWUpLCB7IHNpemU6IGlzQXJyYXkgPyAzMiA6IDEgfSk7CiAgICBjb25zdCBpbnRNYXRjaCA9IHR5cGUubWF0Y2goaW50ZWdlclJlZ2V4Mik7CiAgICBpZiAoaW50TWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBiYXNlVHlwZSwgYml0cyA9ICIyNTYiXSA9IGludE1hdGNoOwogICAgICBjb25zdCBzaXplMyA9IE51bWJlci5wYXJzZUludChiaXRzKSAvIDg7CiAgICAgIHJldHVybiBudW1iZXJUb0hleCh2YWx1ZSwgewogICAgICAgIHNpemU6IGlzQXJyYXkgPyAzMiA6IHNpemUzLAogICAgICAgIHNpZ25lZDogYmFzZVR5cGUgPT09ICJpbnQiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYnl0ZXNNYXRjaCA9IHR5cGUubWF0Y2goYnl0ZXNSZWdleDIpOwogICAgaWYgKGJ5dGVzTWF0Y2gpIHsKICAgICAgY29uc3QgW190eXBlLCBzaXplM10gPSBieXRlc01hdGNoOwogICAgICBpZiAoTnVtYmVyLnBhcnNlSW50KHNpemUzKSAhPT0gKHZhbHVlLmxlbmd0aCAtIDIpIC8gMikKICAgICAgICB0aHJvdyBuZXcgQnl0ZXNTaXplTWlzbWF0Y2hFcnJvcih7CiAgICAgICAgICBleHBlY3RlZFNpemU6IE51bWJlci5wYXJzZUludChzaXplMyksCiAgICAgICAgICBnaXZlblNpemU6ICh2YWx1ZS5sZW5ndGggLSAyKSAvIDIKICAgICAgICB9KTsKICAgICAgcmV0dXJuIHBhZCh2YWx1ZSwgeyBkaXI6ICJyaWdodCIsIHNpemU6IGlzQXJyYXkgPyAzMiA6IG51bGwgfSk7CiAgICB9CiAgICBjb25zdCBhcnJheU1hdGNoID0gdHlwZS5tYXRjaChhcnJheVJlZ2V4KTsKICAgIGlmIChhcnJheU1hdGNoICYmIEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGNvbnN0IFtfdHlwZSwgY2hpbGRUeXBlXSA9IGFycmF5TWF0Y2g7CiAgICAgIGNvbnN0IGRhdGEgPSBbXTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykgewogICAgICAgIGRhdGEucHVzaChlbmNvZGUoY2hpbGRUeXBlLCB2YWx1ZVtpXSwgdHJ1ZSkpOwogICAgICB9CiAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkKICAgICAgICByZXR1cm4gIjB4IjsKICAgICAgcmV0dXJuIGNvbmNhdEhleChkYXRhKTsKICAgIH0KICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZFBhY2tlZEFiaVR5cGUodHlwZSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYWRkcmVzcy9nZXRDb250cmFjdEFkZHJlc3MuanMKICBpbml0X2NvbmNhdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZGF0YS9pc0J5dGVzLmpzCiAgZnVuY3Rpb24gaXNCeXRlczModmFsdWUpIHsKICAgIGlmICghdmFsdWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJvYmplY3QiKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoISgiQllURVNfUEVSX0VMRU1FTlQiIGluIHZhbHVlKSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHZhbHVlLkJZVEVTX1BFUl9FTEVNRU5UID09PSAxICYmIHZhbHVlLmNvbnN0cnVjdG9yLm5hbWUgPT09ICJVaW50OEFycmF5IjsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9hZGRyZXNzL2dldENvbnRyYWN0QWRkcmVzcy5qcwogIGluaXRfcGFkKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfa2VjY2FrMjU2KCk7CiAgaW5pdF9nZXRBZGRyZXNzKCk7CiAgZnVuY3Rpb24gZ2V0Q29udHJhY3RBZGRyZXNzMihvcHRzKSB7CiAgICBpZiAob3B0cy5vcGNvZGUgPT09ICJDUkVBVEUyIikKICAgICAgcmV0dXJuIGdldENyZWF0ZTJBZGRyZXNzKG9wdHMpOwogICAgcmV0dXJuIGdldENyZWF0ZUFkZHJlc3Mob3B0cyk7CiAgfQogIGZ1bmN0aW9uIGdldENyZWF0ZUFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGxldCBub25jZSA9IHRvQnl0ZXMob3B0cy5ub25jZSk7CiAgICBpZiAobm9uY2VbMF0gPT09IDApCiAgICAgIG5vbmNlID0gbmV3IFVpbnQ4QXJyYXkoW10pOwogICAgcmV0dXJuIGdldEFkZHJlc3MoYDB4JHtrZWNjYWsyNTYodG9SbHAoW2Zyb20sIG5vbmNlXSwgImJ5dGVzIikpLnNsaWNlKDI2KX1gKTsKICB9CiAgZnVuY3Rpb24gZ2V0Q3JlYXRlMkFkZHJlc3Mob3B0cykgewogICAgY29uc3QgZnJvbSA9IHRvQnl0ZXMoZ2V0QWRkcmVzcyhvcHRzLmZyb20pKTsKICAgIGNvbnN0IHNhbHQgPSBwYWQoaXNCeXRlczMob3B0cy5zYWx0KSA/IG9wdHMuc2FsdCA6IHRvQnl0ZXMob3B0cy5zYWx0KSwgewogICAgICBzaXplOiAzMgogICAgfSk7CiAgICBjb25zdCBieXRlY29kZUhhc2ggPSAoKCkgPT4gewogICAgICBpZiAoImJ5dGVjb2RlSGFzaCIgaW4gb3B0cykgewogICAgICAgIGlmIChpc0J5dGVzMyhvcHRzLmJ5dGVjb2RlSGFzaCkpCiAgICAgICAgICByZXR1cm4gb3B0cy5ieXRlY29kZUhhc2g7CiAgICAgICAgcmV0dXJuIHRvQnl0ZXMob3B0cy5ieXRlY29kZUhhc2gpOwogICAgICB9CiAgICAgIHJldHVybiBrZWNjYWsyNTYob3B0cy5ieXRlY29kZSwgImJ5dGVzIik7CiAgICB9KSgpOwogICAgcmV0dXJuIGdldEFkZHJlc3Moc2xpY2Uoa2VjY2FrMjU2KGNvbmNhdChbdG9CeXRlcygiMHhmZiIpLCBmcm9tLCBzYWx0LCBieXRlY29kZUhhc2hdKSksIDEyKSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZm9ybWF0dGVycy90cmFuc2FjdGlvblJlY2VpcHQuanMKICBpbml0X2Zyb21IZXgoKTsKICBpbml0X2Zvcm1hdHRlcigpOwogIHZhciByZWNlaXB0U3RhdHVzZXMgPSB7CiAgICAiMHgwIjogInJldmVydGVkIiwKICAgICIweDEiOiAic3VjY2VzcyIKICB9OwogIGZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCh0cmFuc2FjdGlvblJlY2VpcHQpIHsKICAgIGNvbnN0IHJlY2VpcHQgPSB7CiAgICAgIC4uLnRyYW5zYWN0aW9uUmVjZWlwdCwKICAgICAgYmxvY2tOdW1iZXI6IHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9ja051bWJlciA/IEJpZ0ludCh0cmFuc2FjdGlvblJlY2VpcHQuYmxvY2tOdW1iZXIpIDogbnVsbCwKICAgICAgY29udHJhY3RBZGRyZXNzOiB0cmFuc2FjdGlvblJlY2VpcHQuY29udHJhY3RBZGRyZXNzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmNvbnRyYWN0QWRkcmVzcyA6IG51bGwsCiAgICAgIGN1bXVsYXRpdmVHYXNVc2VkOiB0cmFuc2FjdGlvblJlY2VpcHQuY3VtdWxhdGl2ZUdhc1VzZWQgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmN1bXVsYXRpdmVHYXNVc2VkKSA6IG51bGwsCiAgICAgIGVmZmVjdGl2ZUdhc1ByaWNlOiB0cmFuc2FjdGlvblJlY2VpcHQuZWZmZWN0aXZlR2FzUHJpY2UgPyBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmVmZmVjdGl2ZUdhc1ByaWNlKSA6IG51bGwsCiAgICAgIGdhc1VzZWQ6IHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkID8gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5nYXNVc2VkKSA6IG51bGwsCiAgICAgIGxvZ3M6IHRyYW5zYWN0aW9uUmVjZWlwdC5sb2dzID8gdHJhbnNhY3Rpb25SZWNlaXB0LmxvZ3MubWFwKChsb2cpID0+IGZvcm1hdExvZyhsb2cpKSA6IG51bGwsCiAgICAgIHRvOiB0cmFuc2FjdGlvblJlY2VpcHQudG8gPyB0cmFuc2FjdGlvblJlY2VpcHQudG8gOiBudWxsLAogICAgICB0cmFuc2FjdGlvbkluZGV4OiB0cmFuc2FjdGlvblJlY2VpcHQudHJhbnNhY3Rpb25JbmRleCA/IGhleFRvTnVtYmVyKHRyYW5zYWN0aW9uUmVjZWlwdC50cmFuc2FjdGlvbkluZGV4KSA6IG51bGwsCiAgICAgIHN0YXR1czogdHJhbnNhY3Rpb25SZWNlaXB0LnN0YXR1cyA/IHJlY2VpcHRTdGF0dXNlc1t0cmFuc2FjdGlvblJlY2VpcHQuc3RhdHVzXSA6IG51bGwsCiAgICAgIHR5cGU6IHRyYW5zYWN0aW9uUmVjZWlwdC50eXBlID8gdHJhbnNhY3Rpb25UeXBlW3RyYW5zYWN0aW9uUmVjZWlwdC50eXBlXSB8fCB0cmFuc2FjdGlvblJlY2VpcHQudHlwZSA6IG51bGwKICAgIH07CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSkKICAgICAgcmVjZWlwdC5ibG9iR2FzUHJpY2UgPSBCaWdJbnQodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNQcmljZSk7CiAgICBpZiAodHJhbnNhY3Rpb25SZWNlaXB0LmJsb2JHYXNVc2VkKQogICAgICByZWNlaXB0LmJsb2JHYXNVc2VkID0gQmlnSW50KHRyYW5zYWN0aW9uUmVjZWlwdC5ibG9iR2FzVXNlZCk7CiAgICByZXR1cm4gcmVjZWlwdDsKICB9CiAgdmFyIGRlZmluZVRyYW5zYWN0aW9uUmVjZWlwdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVGb3JtYXR0ZXIoInRyYW5zYWN0aW9uUmVjZWlwdCIsIGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9pbmRleC5qcwogIGluaXRfZnJvbUhleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvZW5jb2RpbmcvZnJvbVJscC5qcwogIGluaXRfYmFzZSgpOwogIGluaXRfZW5jb2RpbmcoKTsKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbVJscCh2YWx1ZSwgdG8gPSAiaGV4IikgewogICAgY29uc3QgYnl0ZXMyID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMyAmJiB2YWx1ZS5sZW5ndGggJSAyICE9PSAwKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRIZXhWYWx1ZUVycm9yKHZhbHVlKTsKICAgICAgICByZXR1cm4gaGV4VG9CeXRlcyh2YWx1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSkoKTsKICAgIGNvbnN0IGN1cnNvciA9IGNyZWF0ZUN1cnNvcihieXRlczIsIHsKICAgICAgcmVjdXJzaXZlUmVhZExpbWl0OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkKICAgIH0pOwogICAgY29uc3QgcmVzdWx0ID0gZnJvbVJscEN1cnNvcihjdXJzb3IsIHRvKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfQogIGZ1bmN0aW9uIGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0byA9ICJoZXgiKSB7CiAgICBpZiAoY3Vyc29yLmJ5dGVzLmxlbmd0aCA9PT0gMCkKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoY3Vyc29yLmJ5dGVzKSA6IGN1cnNvci5ieXRlczsKICAgIGNvbnN0IHByZWZpeCA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgaWYgKHByZWZpeCA8IDEyOCkKICAgICAgY3Vyc29yLmRlY3JlbWVudFBvc2l0aW9uKDEpOwogICAgaWYgKHByZWZpeCA8IDE5MikgewogICAgICBjb25zdCBsZW5ndGgyID0gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgMTI4KTsKICAgICAgY29uc3QgYnl0ZXMyID0gY3Vyc29yLnJlYWRCeXRlcyhsZW5ndGgyKTsKICAgICAgcmV0dXJuIHRvID09PSAiaGV4IiA/IGJ5dGVzVG9IZXgoYnl0ZXMyKSA6IGJ5dGVzMjsKICAgIH0KICAgIGNvbnN0IGxlbmd0aCA9IHJlYWRMZW5ndGgoY3Vyc29yLCBwcmVmaXgsIDE5Mik7CiAgICByZXR1cm4gcmVhZExpc3QoY3Vyc29yLCBsZW5ndGgsIHRvKTsKICB9CiAgZnVuY3Rpb24gcmVhZExlbmd0aChjdXJzb3IsIHByZWZpeCwgb2Zmc2V0KSB7CiAgICBpZiAob2Zmc2V0ID09PSAxMjggJiYgcHJlZml4IDwgMTI4KQogICAgICByZXR1cm4gMTsKICAgIGlmIChwcmVmaXggPD0gb2Zmc2V0ICsgNTUpCiAgICAgIHJldHVybiBwcmVmaXggLSBvZmZzZXQ7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDEpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQ4KCk7CiAgICBpZiAocHJlZml4ID09PSBvZmZzZXQgKyA1NSArIDIpCiAgICAgIHJldHVybiBjdXJzb3IucmVhZFVpbnQxNigpOwogICAgaWYgKHByZWZpeCA9PT0gb2Zmc2V0ICsgNTUgKyAzKQogICAgICByZXR1cm4gY3Vyc29yLnJlYWRVaW50MjQoKTsKICAgIGlmIChwcmVmaXggPT09IG9mZnNldCArIDU1ICsgNCkKICAgICAgcmV0dXJuIGN1cnNvci5yZWFkVWludDMyKCk7CiAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiSW52YWxpZCBSTFAgcHJlZml4Iik7CiAgfQogIGZ1bmN0aW9uIHJlYWRMaXN0KGN1cnNvciwgbGVuZ3RoLCB0bykgewogICAgY29uc3QgcG9zaXRpb24gPSBjdXJzb3IucG9zaXRpb247CiAgICBjb25zdCB2YWx1ZSA9IFtdOwogICAgd2hpbGUgKGN1cnNvci5wb3NpdGlvbiAtIHBvc2l0aW9uIDwgbGVuZ3RoKQogICAgICB2YWx1ZS5wdXNoKGZyb21SbHBDdXJzb3IoY3Vyc29yLCB0bykpOwogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudFNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9GdW5jdGlvblNpZ25hdHVyZS5qcwogIGluaXRfdG9TaWduYXR1cmUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2hhc2gvdG9FdmVudEhhc2guanMKICBpbml0X3RvU2lnbmF0dXJlSGFzaCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvaGFzaC90b0Z1bmN0aW9uSGFzaC5qcwogIGluaXRfdG9TaWduYXR1cmVIYXNoKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL2lzSGFzaC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3NpemUoKTsKICBmdW5jdGlvbiBpc0hhc2goaGFzaDMpIHsKICAgIHJldHVybiBpc0hleChoYXNoMykgJiYgc2l6ZShoYXNoMykgPT09IDMyOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL0Bub2JsZStoYXNoZXNAMS41LjAvbm9kZV9tb2R1bGVzL0Bub2JsZS9oYXNoZXMvZXNtL3JpcGVtZDE2MC5qcwogIGluaXRfbWQoKTsKICBpbml0X3V0aWxzMigpOwogIHZhciBSaG8gPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkoWzcsIDQsIDEzLCAxLCAxMCwgNiwgMTUsIDMsIDEyLCAwLCA5LCA1LCAyLCAxNCwgMTEsIDhdKTsKICB2YXIgSWQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5KDE2KS5maWxsKDApLm1hcCgoXywgaSkgPT4gaSkpOwogIHZhciBQaSA9IC8qIEBfX1BVUkVfXyAqLyBJZC5tYXAoKGkpID0+ICg5ICogaSArIDUpICUgMTYpOwogIHZhciBpZHhMID0gW0lkXTsKICB2YXIgaWR4UiA9IFtQaV07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCA0OyBpKyspCiAgICBmb3IgKGxldCBqIG9mIFtpZHhMLCBpZHhSXSkKICAgICAgai5wdXNoKGpbaV0ubWFwKChrKSA9PiBSaG9ba10pKTsKICB2YXIgc2hpZnRzID0gLyogQF9fUFVSRV9fICovIFsKICAgIFsxMSwgMTQsIDE1LCAxMiwgNSwgOCwgNywgOSwgMTEsIDEzLCAxNCwgMTUsIDYsIDcsIDksIDhdLAogICAgWzEyLCAxMywgMTEsIDE1LCA2LCA5LCA5LCA3LCAxMiwgMTUsIDExLCAxMywgNywgOCwgNywgN10sCiAgICBbMTMsIDE1LCAxNCwgMTEsIDcsIDcsIDYsIDgsIDEzLCAxNCwgMTMsIDEyLCA1LCA1LCA2LCA5XSwKICAgIFsxNCwgMTEsIDEyLCAxNCwgOCwgNiwgNSwgNSwgMTUsIDEyLCAxNSwgMTQsIDksIDksIDgsIDZdLAogICAgWzE1LCAxMiwgMTMsIDEzLCA5LCA1LCA4LCA2LCAxNCwgMTEsIDEyLCAxMSwgOCwgNiwgNSwgNV0KICBdLm1hcCgoaSkgPT4gbmV3IFVpbnQ4QXJyYXkoaSkpOwogIHZhciBzaGlmdHNMID0gLyogQF9fUFVSRV9fICovIGlkeEwubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBzaGlmdHNSID0gLyogQF9fUFVSRV9fICovIGlkeFIubWFwKChpZHgsIGkpID0+IGlkeC5tYXAoKGopID0+IHNoaWZ0c1tpXVtqXSkpOwogIHZhciBLbCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgVWludDMyQXJyYXkoWwogICAgMCwKICAgIDE1MTg1MDAyNDksCiAgICAxODU5Nzc1MzkzLAogICAgMjQwMDk1OTcwOCwKICAgIDI4NDA4NTM4MzgKICBdKTsKICB2YXIgS3IgPSAvKiBAX19QVVJFX18gKi8gbmV3IFVpbnQzMkFycmF5KFsKICAgIDEzNTI4Mjk5MjYsCiAgICAxNTQ4NjAzNjg0LAogICAgMTgzNjA3MjY5MSwKICAgIDIwNTM5OTQyMTcsCiAgICAwCiAgXSk7CiAgZnVuY3Rpb24gZihncm91cCwgeCwgeSwgeikgewogICAgaWYgKGdyb3VwID09PSAwKQogICAgICByZXR1cm4geCBeIHkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDEpCiAgICAgIHJldHVybiB4ICYgeSB8IH54ICYgejsKICAgIGVsc2UgaWYgKGdyb3VwID09PSAyKQogICAgICByZXR1cm4gKHggfCB+eSkgXiB6OwogICAgZWxzZSBpZiAoZ3JvdXAgPT09IDMpCiAgICAgIHJldHVybiB4ICYgeiB8IHkgJiB+ejsKICAgIGVsc2UKICAgICAgcmV0dXJuIHggXiAoeSB8IH56KTsKICB9CiAgdmFyIFJfQlVGID0gLyogQF9fUFVSRV9fICovIG5ldyBVaW50MzJBcnJheSgxNik7CiAgdmFyIFJJUEVNRDE2MCA9IGNsYXNzIGV4dGVuZHMgSGFzaE1EIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcig2NCwgMjAsIDgsIHRydWUpOwogICAgICB0aGlzLmgwID0gMTczMjU4NDE5MyB8IDA7CiAgICAgIHRoaXMuaDEgPSA0MDIzMjMzNDE3IHwgMDsKICAgICAgdGhpcy5oMiA9IDI1NjIzODMxMDIgfCAwOwogICAgICB0aGlzLmgzID0gMjcxNzMzODc4IHwgMDsKICAgICAgdGhpcy5oNCA9IDMyODUzNzc1MjAgfCAwOwogICAgfQogICAgZ2V0KCkgewogICAgICBjb25zdCB7IGgwLCBoMSwgaDIsIGgzLCBoNCB9ID0gdGhpczsKICAgICAgcmV0dXJuIFtoMCwgaDEsIGgyLCBoMywgaDRdOwogICAgfQogICAgc2V0KGgwLCBoMSwgaDIsIGgzLCBoNCkgewogICAgICB0aGlzLmgwID0gaDAgfCAwOwogICAgICB0aGlzLmgxID0gaDEgfCAwOwogICAgICB0aGlzLmgyID0gaDIgfCAwOwogICAgICB0aGlzLmgzID0gaDMgfCAwOwogICAgICB0aGlzLmg0ID0gaDQgfCAwOwogICAgfQogICAgcHJvY2Vzcyh2aWV3LCBvZmZzZXQpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrLCBvZmZzZXQgKz0gNCkKICAgICAgICBSX0JVRltpXSA9IHZpZXcuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7CiAgICAgIGxldCBhbCA9IHRoaXMuaDAgfCAwLCBhciA9IGFsLCBibCA9IHRoaXMuaDEgfCAwLCBiciA9IGJsLCBjbCA9IHRoaXMuaDIgfCAwLCBjciA9IGNsLCBkbCA9IHRoaXMuaDMgfCAwLCBkciA9IGRsLCBlbCA9IHRoaXMuaDQgfCAwLCBlciA9IGVsOwogICAgICBmb3IgKGxldCBncm91cCA9IDA7IGdyb3VwIDwgNTsgZ3JvdXArKykgewogICAgICAgIGNvbnN0IHJHcm91cCA9IDQgLSBncm91cDsKICAgICAgICBjb25zdCBoYmwgPSBLbFtncm91cF0sIGhiciA9IEtyW2dyb3VwXTsKICAgICAgICBjb25zdCBybCA9IGlkeExbZ3JvdXBdLCByciA9IGlkeFJbZ3JvdXBdOwogICAgICAgIGNvbnN0IHNsID0gc2hpZnRzTFtncm91cF0sIHNyID0gc2hpZnRzUltncm91cF07CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB0bCA9IHJvdGwoYWwgKyBmKGdyb3VwLCBibCwgY2wsIGRsKSArIFJfQlVGW3JsW2ldXSArIGhibCwgc2xbaV0pICsgZWwgfCAwOwogICAgICAgICAgYWwgPSBlbCwgZWwgPSBkbCwgZGwgPSByb3RsKGNsLCAxMCkgfCAwLCBjbCA9IGJsLCBibCA9IHRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHsKICAgICAgICAgIGNvbnN0IHRyID0gcm90bChhciArIGYockdyb3VwLCBiciwgY3IsIGRyKSArIFJfQlVGW3JyW2ldXSArIGhiciwgc3JbaV0pICsgZXIgfCAwOwogICAgICAgICAgYXIgPSBlciwgZXIgPSBkciwgZHIgPSByb3RsKGNyLCAxMCkgfCAwLCBjciA9IGJyLCBiciA9IHRyOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNldCh0aGlzLmgxICsgY2wgKyBkciB8IDAsIHRoaXMuaDIgKyBkbCArIGVyIHwgMCwgdGhpcy5oMyArIGVsICsgYXIgfCAwLCB0aGlzLmg0ICsgYWwgKyBiciB8IDAsIHRoaXMuaDAgKyBibCArIGNyIHwgMCk7CiAgICB9CiAgICByb3VuZENsZWFuKCkgewogICAgICBSX0JVRi5maWxsKDApOwogICAgfQogICAgZGVzdHJveSgpIHsKICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlOwogICAgICB0aGlzLmJ1ZmZlci5maWxsKDApOwogICAgICB0aGlzLnNldCgwLCAwLCAwLCAwLCAwKTsKICAgIH0KICB9OwogIHZhciByaXBlbWQxNjAgPSAvKiBAX19QVVJFX18gKi8gd3JhcENvbnN0cnVjdG9yKCgpID0+IG5ldyBSSVBFTUQxNjAoKSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9oYXNoL3JpcGVtZDE2MC5qcwogIGluaXRfaXNIZXgoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcmlwZW1kMTYwMih2YWx1ZSwgdG9fKSB7CiAgICBjb25zdCB0byA9IHRvXyB8fCAiaGV4IjsKICAgIGNvbnN0IGJ5dGVzMiA9IHJpcGVtZDE2MChpc0hleCh2YWx1ZSwgeyBzdHJpY3Q6IGZhbHNlIH0pID8gdG9CeXRlcyh2YWx1ZSkgOiB2YWx1ZSk7CiAgICBpZiAodG8gPT09ICJieXRlcyIpCiAgICAgIHJldHVybiBieXRlczI7CiAgICByZXR1cm4gdG9IZXgoYnl0ZXMyKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvaGFzaE1lc3NhZ2UuanMKICBpbml0X2tlY2NhazI1NigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY29uc3RhbnRzL3N0cmluZ3MuanMKICB2YXIgcHJlc2lnbk1lc3NhZ2VQcmVmaXggPSAiGUV0aGVyZXVtIFNpZ25lZCBNZXNzYWdlOlxuIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS90b1ByZWZpeGVkTWVzc2FnZS5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2VfKSB7CiAgICBjb25zdCBtZXNzYWdlID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXyA9PT0gInN0cmluZyIpCiAgICAgICAgcmV0dXJuIHN0cmluZ1RvSGV4KG1lc3NhZ2VfKTsKICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlXy5yYXcgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBtZXNzYWdlXy5yYXc7CiAgICAgIHJldHVybiBieXRlc1RvSGV4KG1lc3NhZ2VfLnJhdyk7CiAgICB9KSgpOwogICAgY29uc3QgcHJlZml4ID0gc3RyaW5nVG9IZXgoYCR7cHJlc2lnbk1lc3NhZ2VQcmVmaXh9JHtzaXplKG1lc3NhZ2UpfWApOwogICAgcmV0dXJuIGNvbmNhdChbcHJlZml4LCBtZXNzYWdlXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL2hhc2hNZXNzYWdlLmpzCiAgZnVuY3Rpb24gaGFzaE1lc3NhZ2UobWVzc2FnZSwgdG9fKSB7CiAgICByZXR1cm4ga2VjY2FrMjU2KHRvUHJlZml4ZWRNZXNzYWdlKG1lc3NhZ2UpLCB0b18pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9yZWNvdmVyTWVzc2FnZUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkgewogICAgcmV0dXJuIHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaE1lc3NhZ2UobWVzc2FnZSksIHNpZ25hdHVyZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclR5cGVkRGF0YUFkZHJlc3MuanMKICBhc3luYyBmdW5jdGlvbiByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHNpZ25hdHVyZSwgdHlwZXMgfSA9IHBhcmFtZXRlcnM7CiAgICByZXR1cm4gcmVjb3ZlckFkZHJlc3MoewogICAgICBoYXNoOiBoYXNoVHlwZWREYXRhKHsKICAgICAgICBkb21haW4sCiAgICAgICAgbWVzc2FnZSwKICAgICAgICBwcmltYXJ5VHlwZSwKICAgICAgICB0eXBlcwogICAgICB9KSwKICAgICAgc2lnbmF0dXJlCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5SGFzaC5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlIYXNoKHsgYWRkcmVzcywgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSB7CiAgICByZXR1cm4gaXNBZGRyZXNzRXF1YWwoZ2V0QWRkcmVzcyhhZGRyZXNzKSwgYXdhaXQgcmVjb3ZlckFkZHJlc3MoeyBoYXNoOiBoYXNoMywgc2lnbmF0dXJlIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvdmVyaWZ5TWVzc2FnZS5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBhc3luYyBmdW5jdGlvbiB2ZXJpZnlNZXNzYWdlKHsgYWRkcmVzcywgbWVzc2FnZSwgc2lnbmF0dXJlIH0pIHsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyTWVzc2FnZUFkZHJlc3MoeyBtZXNzYWdlLCBzaWduYXR1cmUgfSkpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS92ZXJpZnlUeXBlZERhdGEuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZG9tYWluLCBtZXNzYWdlLCBwcmltYXJ5VHlwZSwgc2lnbmF0dXJlLCB0eXBlcyB9ID0gcGFyYW1ldGVyczsKICAgIHJldHVybiBpc0FkZHJlc3NFcXVhbChnZXRBZGRyZXNzKGFkZHJlc3MpLCBhd2FpdCByZWNvdmVyVHlwZWREYXRhQWRkcmVzcyh7CiAgICAgIGRvbWFpbiwKICAgICAgbWVzc2FnZSwKICAgICAgcHJpbWFyeVR5cGUsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgdHlwZXMKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcGFyc2VFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9kZWNvZGVBYmlQYXJhbWV0ZXJzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYnl0ZXMuanMKICB2YXIgZXJjNjQ5Mk1hZ2ljQnl0ZXMgPSAiMHg2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyNjQ5MjY0OTI2NDkyIjsKICB2YXIgemVyb0hhc2ggPSAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIjsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9pc0VyYzY0OTJTaWduYXR1cmUuanMKICBpbml0X3NsaWNlKCk7CiAgZnVuY3Rpb24gaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgcmV0dXJuIHNsaWNlSGV4KHNpZ25hdHVyZSwgLTMyKSA9PT0gZXJjNjQ5Mk1hZ2ljQnl0ZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlRXJjNjQ5MlNpZ25hdHVyZS5qcwogIGZ1bmN0aW9uIHBhcnNlRXJjNjQ5MlNpZ25hdHVyZShzaWduYXR1cmUpIHsKICAgIGlmICghaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZSkpCiAgICAgIHJldHVybiB7IHNpZ25hdHVyZSB9OwogICAgY29uc3QgW2FkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZV9dID0gZGVjb2RlQWJpUGFyYW1ldGVycyhbeyB0eXBlOiAiYWRkcmVzcyIgfSwgeyB0eXBlOiAiYnl0ZXMiIH0sIHsgdHlwZTogImJ5dGVzIiB9XSwgc2lnbmF0dXJlKTsKICAgIHJldHVybiB7IGFkZHJlc3MsIGRhdGEsIHNpZ25hdHVyZTogc2lnbmF0dXJlXyB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlLmpzCiAgaW5pdF9lbmNvZGVBYmlQYXJhbWV0ZXJzKCk7CiAgaW5pdF9jb25jYXQoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBmdW5jdGlvbiBzZXJpYWxpemVFcmM2NDkyU2lnbmF0dXJlKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZGF0YSwgc2lnbmF0dXJlLCB0byA9ICJoZXgiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3Qgc2lnbmF0dXJlXyA9IGNvbmNhdEhleChbCiAgICAgIGVuY29kZUFiaVBhcmFtZXRlcnMoW3sgdHlwZTogImFkZHJlc3MiIH0sIHsgdHlwZTogImJ5dGVzIiB9LCB7IHR5cGU6ICJieXRlcyIgfV0sIFthZGRyZXNzLCBkYXRhLCBzaWduYXR1cmVdKSwKICAgICAgZXJjNjQ5Mk1hZ2ljQnl0ZXMKICAgIF0pOwogICAgaWYgKHRvID09PSAiaGV4IikKICAgICAgcmV0dXJuIHNpZ25hdHVyZV87CiAgICByZXR1cm4gaGV4VG9CeXRlcyhzaWduYXR1cmVfKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9nZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X2Zyb21IZXgoKTsKICBmdW5jdGlvbiBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3Qgc2VyaWFsaXplZFR5cGUgPSBzbGljZUhleChzZXJpYWxpemVkVHJhbnNhY3Rpb24sIDAsIDEpOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwNCIpCiAgICAgIHJldHVybiAiZWlwNzcwMiI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgPT09ICIweDAzIikKICAgICAgcmV0dXJuICJlaXA0ODQ0IjsKICAgIGlmIChzZXJpYWxpemVkVHlwZSA9PT0gIjB4MDIiKQogICAgICByZXR1cm4gImVpcDE1NTkiOwogICAgaWYgKHNlcmlhbGl6ZWRUeXBlID09PSAiMHgwMSIpCiAgICAgIHJldHVybiAiZWlwMjkzMCI7CiAgICBpZiAoc2VyaWFsaXplZFR5cGUgIT09ICIweCIgJiYgaGV4VG9OdW1iZXIoc2VyaWFsaXplZFR5cGUpID49IDE5MikKICAgICAgcmV0dXJuICJsZWdhY3kiOwogICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlRXJyb3IoeyBzZXJpYWxpemVkVHlwZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9hc3NlcnRUcmFuc2FjdGlvbi5qcwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jaGFpbigpOwogIGluaXRfbm9kZSgpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9zaXplKCk7CiAgaW5pdF9zbGljZSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIGFzc2VydFRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBhdXRob3JpemF0aW9uTGlzdCB9ID0gdHJhbnNhY3Rpb247CiAgICBpZiAoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgICAgZm9yIChjb25zdCBhdXRob3JpemF0aW9uIG9mIGF1dGhvcml6YXRpb25MaXN0KSB7CiAgICAgICAgY29uc3QgeyBjb250cmFjdEFkZHJlc3MsIGNoYWluSWQgfSA9IGF1dGhvcml6YXRpb247CiAgICAgICAgaWYgKCFpc0FkZHJlc3MoY29udHJhY3RBZGRyZXNzKSkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogY29udHJhY3RBZGRyZXNzIH0pOwogICAgICAgIGlmIChjaGFpbklkIDwgMCkKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgICAgfQogICAgfQogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGJsb2JWZXJzaW9uZWRIYXNoZXMgfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgaWYgKGJsb2JWZXJzaW9uZWRIYXNoZXMubGVuZ3RoID09PSAwKQogICAgICAgIHRocm93IG5ldyBFbXB0eUJsb2JFcnJvcigpOwogICAgICBmb3IgKGNvbnN0IGhhc2gzIG9mIGJsb2JWZXJzaW9uZWRIYXNoZXMpIHsKICAgICAgICBjb25zdCBzaXplXyA9IHNpemUoaGFzaDMpOwogICAgICAgIGNvbnN0IHZlcnNpb24zID0gaGV4VG9OdW1iZXIoc2xpY2UoaGFzaDMsIDAsIDEpKTsKICAgICAgICBpZiAoc2l6ZV8gIT09IDMyKQogICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRWZXJzaW9uZWRIYXNoU2l6ZUVycm9yKHsgaGFzaDogaGFzaDMsIHNpemU6IHNpemVfIH0pOwogICAgICAgIGlmICh2ZXJzaW9uMyAhPT0gdmVyc2lvbmVkSGFzaFZlcnNpb25LemcpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFZlcnNpb25lZEhhc2hWZXJzaW9uRXJyb3IoewogICAgICAgICAgICBoYXNoOiBoYXNoMywKICAgICAgICAgICAgdmVyc2lvbjogdmVyc2lvbjMKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKGNoYWluSWQgPD0gMCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRDaGFpbklkRXJyb3IoeyBjaGFpbklkIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKG1heEZlZVBlckdhcyAmJiBtYXhGZWVQZXJHYXMgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzIH0pOwogICAgaWYgKG1heFByaW9yaXR5RmVlUGVyR2FzICYmIG1heEZlZVBlckdhcyAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyA+IG1heEZlZVBlckdhcykKICAgICAgdGhyb3cgbmV3IFRpcEFib3ZlRmVlQ2FwRXJyb3IoeyBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIHRvIH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIEVJUC0yOTMwIFRyYW5zYWN0aW9uIGF0dHJpYnV0ZS4iKTsKICAgIGlmIChnYXNQcmljZSAmJiBnYXNQcmljZSA+IG1heFVpbnQyNTYpCiAgICAgIHRocm93IG5ldyBGZWVDYXBUb29IaWdoRXJyb3IoeyBtYXhGZWVQZXJHYXM6IGdhc1ByaWNlIH0pOwogIH0KICBmdW5jdGlvbiBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBjaGFpbklkLCBtYXhQcmlvcml0eUZlZVBlckdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgdG8gfSA9IHRyYW5zYWN0aW9uOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKHR5cGVvZiBjaGFpbklkICE9PSAidW5kZWZpbmVkIiAmJiBjaGFpbklkIDw9IDApCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQ2hhaW5JZEVycm9yKHsgY2hhaW5JZCB9KTsKICAgIGlmIChtYXhQcmlvcml0eUZlZVBlckdhcyB8fCBtYXhGZWVQZXJHYXMpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgbWF4RmVlUGVyR2FzYC9gbWF4UHJpb3JpdHlGZWVQZXJHYXNgIGlzIG5vdCBhIHZhbGlkIExlZ2FjeSBUcmFuc2FjdGlvbiBhdHRyaWJ1dGUuIik7CiAgICBpZiAoZ2FzUHJpY2UgJiYgZ2FzUHJpY2UgPiBtYXhVaW50MjU2KQogICAgICB0aHJvdyBuZXcgRmVlQ2FwVG9vSGlnaEVycm9yKHsgbWF4RmVlUGVyR2FzOiBnYXNQcmljZSB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9wYXJzZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfaXNBZGRyZXNzKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfcGFkKCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF9mcm9tSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VUcmFuc2FjdGlvbihzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRTZXJpYWxpemVkVHJhbnNhY3Rpb25UeXBlKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDE1NTkiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDE1NTkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXA0ODQ0IikKICAgICAgcmV0dXJuIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBpZiAodHlwZSA9PT0gImVpcDc3MDIiKQogICAgICByZXR1cm4gcGFyc2VUcmFuc2FjdGlvbkVJUDc3MDIoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBwYXJzZVRyYW5zYWN0aW9uTGVnYWN5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA3NzAyKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgYXV0aG9yaXphdGlvbkxpc3QsIHYsIHIsIHNdID0gdHJhbnNhY3Rpb25BcnJheTsKICAgIGlmICh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCAhPT0gMTAgJiYgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggIT09IDEzKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcywKICAgICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIGF1dGhvcml6YXRpb25MaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNzcwMiIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA3NzAyIgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckdhcykgJiYgbWF4RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJHYXMpOwogICAgaWYgKGlzSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSAmJiBtYXhQcmlvcml0eUZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4UHJpb3JpdHlGZWVQZXJHYXMgPSBoZXhUb0JpZ0ludChtYXhQcmlvcml0eUZlZVBlckdhcyk7CiAgICBpZiAoYWNjZXNzTGlzdC5sZW5ndGggIT09IDAgJiYgYWNjZXNzTGlzdCAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uYWNjZXNzTGlzdCA9IHBhcnNlQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGlmIChhdXRob3JpemF0aW9uTGlzdC5sZW5ndGggIT09IDAgJiYgYXV0aG9yaXphdGlvbkxpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmF1dGhvcml6YXRpb25MaXN0ID0gcGFyc2VBdXRob3JpemF0aW9uTGlzdChhdXRob3JpemF0aW9uTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEzID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVA0ODQ0KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25PcldyYXBwZXJBcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgaGFzTmV0d29ya1dyYXBwZXIgPSB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5Lmxlbmd0aCA9PT0gNDsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSBoYXNOZXR3b3JrV3JhcHBlciA/IHRyYW5zYWN0aW9uT3JXcmFwcGVyQXJyYXlbMF0gOiB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5OwogICAgY29uc3Qgd3JhcHBlckFycmF5ID0gaGFzTmV0d29ya1dyYXBwZXIgPyB0cmFuc2FjdGlvbk9yV3JhcHBlckFycmF5LnNsaWNlKDEpIDogW107CiAgICBjb25zdCBbY2hhaW5JZCwgbm9uY2UsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBtYXhGZWVQZXJHYXMsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCBtYXhGZWVQZXJCbG9iR2FzLCBibG9iVmVyc2lvbmVkSGFzaGVzLCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBjb25zdCBbYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdID0gd3JhcHBlckFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExIHx8IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxNCkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkU2VyaWFsaXplZFRyYW5zYWN0aW9uRXJyb3IoewogICAgICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgICAgIGNoYWluSWQsCiAgICAgICAgICBub25jZSwKICAgICAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICAgICAgbWF4RmVlUGVyR2FzLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICBhY2Nlc3NMaXN0LAogICAgICAgICAgLi4udHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPiA5ID8gewogICAgICAgICAgICB2LAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAiZWlwNDg0NCIKICAgICAgfSk7CiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IHsKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcywKICAgICAgY2hhaW5JZDogaGV4VG9OdW1iZXIoY2hhaW5JZCksCiAgICAgIHR5cGU6ICJlaXA0ODQ0IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KG1heEZlZVBlckJsb2JHYXMpICYmIG1heEZlZVBlckJsb2JHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckJsb2JHYXMgPSBoZXhUb0JpZ0ludChtYXhGZWVQZXJCbG9iR2FzKTsKICAgIGlmIChpc0hleChtYXhGZWVQZXJHYXMpICYmIG1heEZlZVBlckdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4RmVlUGVyR2FzKTsKICAgIGlmIChpc0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgJiYgbWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heFByaW9yaXR5RmVlUGVyR2FzID0gaGV4VG9CaWdJbnQobWF4UHJpb3JpdHlGZWVQZXJHYXMpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBpZiAoYmxvYnMgJiYgY29tbWl0bWVudHMgJiYgcHJvb2ZzKQogICAgICB0cmFuc2FjdGlvbi5zaWRlY2FycyA9IHRvQmxvYlNpZGVjYXJzKHsKICAgICAgICBibG9icywKICAgICAgICBjb21taXRtZW50cywKICAgICAgICBwcm9vZnMKICAgICAgfSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDE0ID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25FSVAxNTU5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgY29uc3QgdHJhbnNhY3Rpb25BcnJheSA9IHRvVHJhbnNhY3Rpb25BcnJheShzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgY29uc3QgW2NoYWluSWQsIG5vbmNlLCBtYXhQcmlvcml0eUZlZVBlckdhcywgbWF4RmVlUGVyR2FzLCBnYXMsIHRvLCB2YWx1ZSwgZGF0YSwgYWNjZXNzTGlzdCwgdiwgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDEyKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRTZXJpYWxpemVkVHJhbnNhY3Rpb25FcnJvcih7CiAgICAgICAgYXR0cmlidXRlczogewogICAgICAgICAgY2hhaW5JZCwKICAgICAgICAgIG5vbmNlLAogICAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgICBnYXMsCiAgICAgICAgICB0bywKICAgICAgICAgIHZhbHVlLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGFjY2Vzc0xpc3QsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDkgPyB7CiAgICAgICAgICAgIHYsCiAgICAgICAgICAgIHIsCiAgICAgICAgICAgIHMKICAgICAgICAgIH0gOiB7fQogICAgICAgIH0sCiAgICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uLAogICAgICAgIHR5cGU6ICJlaXAxNTU5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICBjaGFpbklkOiBoZXhUb051bWJlcihjaGFpbklkKSwKICAgICAgdHlwZTogImVpcDE1NTkiCiAgICB9OwogICAgaWYgKGlzSGV4KHRvKSAmJiB0byAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udG8gPSB0bzsKICAgIGlmIChpc0hleChnYXMpICYmIGdhcyAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzID0gaGV4VG9CaWdJbnQoZ2FzKTsKICAgIGlmIChpc0hleChkYXRhKSAmJiBkYXRhICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5kYXRhID0gZGF0YTsKICAgIGlmIChpc0hleChub25jZSkgJiYgbm9uY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm5vbmNlID0gaGV4VG9OdW1iZXIobm9uY2UpOwogICAgaWYgKGlzSGV4KHZhbHVlKSAmJiB2YWx1ZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24udmFsdWUgPSBoZXhUb0JpZ0ludCh2YWx1ZSk7CiAgICBpZiAoaXNIZXgobWF4RmVlUGVyR2FzKSAmJiBtYXhGZWVQZXJHYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heEZlZVBlckdhcyk7CiAgICBpZiAoaXNIZXgobWF4UHJpb3JpdHlGZWVQZXJHYXMpICYmIG1heFByaW9yaXR5RmVlUGVyR2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyA9IGhleFRvQmlnSW50KG1heFByaW9yaXR5RmVlUGVyR2FzKTsKICAgIGlmIChhY2Nlc3NMaXN0Lmxlbmd0aCAhPT0gMCAmJiBhY2Nlc3NMaXN0ICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5hY2Nlc3NMaXN0ID0gcGFyc2VBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID09PSAxMiA/IHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIDogdm9pZCAwOwogICAgcmV0dXJuIHsgLi4uc2lnbmF0dXJlLCAuLi50cmFuc2FjdGlvbiB9OwogIH0KICBmdW5jdGlvbiBwYXJzZVRyYW5zYWN0aW9uRUlQMjkzMChzZXJpYWxpemVkVHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHRyYW5zYWN0aW9uQXJyYXkgPSB0b1RyYW5zYWN0aW9uQXJyYXkoc2VyaWFsaXplZFRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IFtjaGFpbklkLCBub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBhY2Nlc3NMaXN0LCB2LCByLCBzXSA9IHRyYW5zYWN0aW9uQXJyYXk7CiAgICBpZiAoISh0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gOCB8fCB0cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA9PT0gMTEpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBjaGFpbklkLAogICAgICAgICAgbm9uY2UsCiAgICAgICAgICBnYXNQcmljZSwKICAgICAgICAgIGdhcywKICAgICAgICAgIHRvLAogICAgICAgICAgdmFsdWUsCiAgICAgICAgICBkYXRhLAogICAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICAgIC4uLnRyYW5zYWN0aW9uQXJyYXkubGVuZ3RoID4gOCA/IHsKICAgICAgICAgICAgdiwKICAgICAgICAgICAgciwKICAgICAgICAgICAgcwogICAgICAgICAgfSA6IHt9CiAgICAgICAgfSwKICAgICAgICBzZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdHlwZTogImVpcDI5MzAiCiAgICAgIH0pOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7CiAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICB0eXBlOiAiZWlwMjkzMCIKICAgIH07CiAgICBpZiAoaXNIZXgodG8pICYmIHRvICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi50byA9IHRvOwogICAgaWYgKGlzSGV4KGdhcykgJiYgZ2FzICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5nYXMgPSBoZXhUb0JpZ0ludChnYXMpOwogICAgaWYgKGlzSGV4KGRhdGEpICYmIGRhdGEgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmRhdGEgPSBkYXRhOwogICAgaWYgKGlzSGV4KG5vbmNlKSAmJiBub25jZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24ubm9uY2UgPSBoZXhUb051bWJlcihub25jZSk7CiAgICBpZiAoaXNIZXgodmFsdWUpICYmIHZhbHVlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi52YWx1ZSA9IGhleFRvQmlnSW50KHZhbHVlKTsKICAgIGlmIChpc0hleChnYXNQcmljZSkgJiYgZ2FzUHJpY2UgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhc1ByaWNlID0gaGV4VG9CaWdJbnQoZ2FzUHJpY2UpOwogICAgaWYgKGFjY2Vzc0xpc3QubGVuZ3RoICE9PSAwICYmIGFjY2Vzc0xpc3QgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmFjY2Vzc0xpc3QgPSBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2lnbmF0dXJlID0gdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDExID8gcGFyc2VFSVAxNTVTaWduYXR1cmUodHJhbnNhY3Rpb25BcnJheSkgOiB2b2lkIDA7CiAgICByZXR1cm4geyAuLi5zaWduYXR1cmUsIC4uLnRyYW5zYWN0aW9uIH07CiAgfQogIGZ1bmN0aW9uIHBhcnNlVHJhbnNhY3Rpb25MZWdhY3koc2VyaWFsaXplZFRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB0cmFuc2FjdGlvbkFycmF5ID0gZnJvbVJscChzZXJpYWxpemVkVHJhbnNhY3Rpb24sICJoZXgiKTsKICAgIGNvbnN0IFtub25jZSwgZ2FzUHJpY2UsIGdhcywgdG8sIHZhbHVlLCBkYXRhLCBjaGFpbklkT3JWXywgciwgc10gPSB0cmFuc2FjdGlvbkFycmF5OwogICAgaWYgKCEodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYgfHwgdHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDkpKQogICAgICB0aHJvdyBuZXcgSW52YWxpZFNlcmlhbGl6ZWRUcmFuc2FjdGlvbkVycm9yKHsKICAgICAgICBhdHRyaWJ1dGVzOiB7CiAgICAgICAgICBub25jZSwKICAgICAgICAgIGdhc1ByaWNlLAogICAgICAgICAgZ2FzLAogICAgICAgICAgdG8sCiAgICAgICAgICB2YWx1ZSwKICAgICAgICAgIGRhdGEsCiAgICAgICAgICAuLi50cmFuc2FjdGlvbkFycmF5Lmxlbmd0aCA+IDYgPyB7CiAgICAgICAgICAgIHY6IGNoYWluSWRPclZfLAogICAgICAgICAgICByLAogICAgICAgICAgICBzCiAgICAgICAgICB9IDoge30KICAgICAgICB9LAogICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0eXBlOiAibGVnYWN5IgogICAgICB9KTsKICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gewogICAgICB0eXBlOiAibGVnYWN5IgogICAgfTsKICAgIGlmIChpc0hleCh0bykgJiYgdG8gIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnRvID0gdG87CiAgICBpZiAoaXNIZXgoZ2FzKSAmJiBnYXMgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLmdhcyA9IGhleFRvQmlnSW50KGdhcyk7CiAgICBpZiAoaXNIZXgoZGF0YSkgJiYgZGF0YSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZGF0YSA9IGRhdGE7CiAgICBpZiAoaXNIZXgobm9uY2UpICYmIG5vbmNlICE9PSAiMHgiKQogICAgICB0cmFuc2FjdGlvbi5ub25jZSA9IGhleFRvTnVtYmVyKG5vbmNlKTsKICAgIGlmIChpc0hleCh2YWx1ZSkgJiYgdmFsdWUgIT09ICIweCIpCiAgICAgIHRyYW5zYWN0aW9uLnZhbHVlID0gaGV4VG9CaWdJbnQodmFsdWUpOwogICAgaWYgKGlzSGV4KGdhc1ByaWNlKSAmJiBnYXNQcmljZSAhPT0gIjB4IikKICAgICAgdHJhbnNhY3Rpb24uZ2FzUHJpY2UgPSBoZXhUb0JpZ0ludChnYXNQcmljZSk7CiAgICBhc3NlcnRUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbik7CiAgICBpZiAodHJhbnNhY3Rpb25BcnJheS5sZW5ndGggPT09IDYpCiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IGNoYWluSWRPclYgPSBpc0hleChjaGFpbklkT3JWXykgJiYgY2hhaW5JZE9yVl8gIT09ICIweCIgPyBoZXhUb0JpZ0ludChjaGFpbklkT3JWXykgOiAwbjsKICAgIGlmIChzID09PSAiMHgiICYmIHIgPT09ICIweCIpIHsKICAgICAgaWYgKGNoYWluSWRPclYgPiAwKQogICAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBOdW1iZXIoY2hhaW5JZE9yVik7CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0KICAgIGNvbnN0IHYgPSBjaGFpbklkT3JWOwogICAgY29uc3QgY2hhaW5JZCA9IE51bWJlcigodiAtIDM1bikgLyAybik7CiAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgIHRyYW5zYWN0aW9uLmNoYWluSWQgPSBjaGFpbklkOwogICAgZWxzZSBpZiAodiAhPT0gMjduICYmIHYgIT09IDI4bikKICAgICAgdGhyb3cgbmV3IEludmFsaWRMZWdhY3lWRXJyb3IoeyB2IH0pOwogICAgdHJhbnNhY3Rpb24udiA9IHY7CiAgICB0cmFuc2FjdGlvbi5zID0gczsKICAgIHRyYW5zYWN0aW9uLnIgPSByOwogICAgdHJhbnNhY3Rpb24ueVBhcml0eSA9IHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICB9CiAgZnVuY3Rpb24gdG9UcmFuc2FjdGlvbkFycmF5KHNlcmlhbGl6ZWRUcmFuc2FjdGlvbikgewogICAgcmV0dXJuIGZyb21SbHAoYDB4JHtzZXJpYWxpemVkVHJhbnNhY3Rpb24uc2xpY2UoNCl9YCwgImhleCIpOwogIH0KICBmdW5jdGlvbiBwYXJzZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdF8pIHsKICAgIGNvbnN0IGFjY2Vzc0xpc3QgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWNjZXNzTGlzdF8ubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgW2FkZHJlc3MsIHN0b3JhZ2VLZXlzXSA9IGFjY2Vzc0xpc3RfW2ldOwogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpCiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzIH0pOwogICAgICBhY2Nlc3NMaXN0LnB1c2goewogICAgICAgIGFkZHJlc3MsCiAgICAgICAgc3RvcmFnZUtleXM6IHN0b3JhZ2VLZXlzLm1hcCgoa2V5KSA9PiBpc0hhc2goa2V5KSA/IGtleSA6IHRyaW0oa2V5KSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYWNjZXNzTGlzdDsKICB9CiAgZnVuY3Rpb24gcGFyc2VBdXRob3JpemF0aW9uTGlzdChzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGNvbnN0IGF1dGhvcml6YXRpb25MaXN0ID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdC5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBbY2hhaW5JZCwgY29udHJhY3RBZGRyZXNzLCBub25jZSwgeVBhcml0eSwgciwgc10gPSBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3RbaV07CiAgICAgIGF1dGhvcml6YXRpb25MaXN0LnB1c2goewogICAgICAgIGNoYWluSWQ6IGhleFRvTnVtYmVyKGNoYWluSWQpLAogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBub25jZTogaGV4VG9OdW1iZXIobm9uY2UpLAogICAgICAgIC4uLnBhcnNlRUlQMTU1U2lnbmF0dXJlKFt5UGFyaXR5LCByLCBzXSkKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gYXV0aG9yaXphdGlvbkxpc3Q7CiAgfQogIGZ1bmN0aW9uIHBhcnNlRUlQMTU1U2lnbmF0dXJlKHRyYW5zYWN0aW9uQXJyYXkpIHsKICAgIGNvbnN0IHNpZ25hdHVyZSA9IHRyYW5zYWN0aW9uQXJyYXkuc2xpY2UoLTMpOwogICAgY29uc3QgdiA9IHNpZ25hdHVyZVswXSA9PT0gIjB4IiB8fCBoZXhUb0JpZ0ludChzaWduYXR1cmVbMF0pID09PSAwbiA/IDI3biA6IDI4bjsKICAgIHJldHVybiB7CiAgICAgIHI6IHBhZEhleChzaWduYXR1cmVbMV0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHM6IHBhZEhleChzaWduYXR1cmVbMl0sIHsgc2l6ZTogMzIgfSksCiAgICAgIHYsCiAgICAgIHlQYXJpdHk6IHYgPT09IDI3biA/IDAgOiAxCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3RyYW5zYWN0aW9uL3NlcmlhbGl6ZVRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90cmltKCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vZXhwZXJpbWVudGFsL2VpcDc3MDIvdXRpbHMvc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QuanMKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpIHsKICAgIGlmICghYXV0aG9yaXphdGlvbkxpc3QgfHwgYXV0aG9yaXphdGlvbkxpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3QgPSBbXTsKICAgIGZvciAoY29uc3QgYXV0aG9yaXphdGlvbiBvZiBhdXRob3JpemF0aW9uTGlzdCkgewogICAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UsIC4uLnNpZ25hdHVyZSB9ID0gYXV0aG9yaXphdGlvbjsKICAgICAgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0LnB1c2goWwogICAgICAgIGNoYWluSWQgPyB0b0hleChjaGFpbklkKSA6ICIweCIsCiAgICAgICAgY29udHJhY3RBZGRyZXNzLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh7fSwgc2lnbmF0dXJlKQogICAgICBdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQXV0aG9yaXphdGlvbkxpc3Q7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdHJhbnNhY3Rpb24vc2VyaWFsaXplQWNjZXNzTGlzdC5qcwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUFjY2Vzc0xpc3QoYWNjZXNzTGlzdCkgewogICAgaWYgKCFhY2Nlc3NMaXN0IHx8IGFjY2Vzc0xpc3QubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gW107CiAgICBjb25zdCBzZXJpYWxpemVkQWNjZXNzTGlzdCA9IFtdOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2Nlc3NMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWRkcmVzcywgc3RvcmFnZUtleXMgfSA9IGFjY2Vzc0xpc3RbaV07CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3RvcmFnZUtleXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBpZiAoc3RvcmFnZUtleXNbal0ubGVuZ3RoIC0gMiAhPT0gNjQpIHsKICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RvcmFnZUtleVNpemVFcnJvcih7IHN0b3JhZ2VLZXk6IHN0b3JhZ2VLZXlzW2pdIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWlzQWRkcmVzcyhhZGRyZXNzLCB7IHN0cmljdDogZmFsc2UgfSkpIHsKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3MgfSk7CiAgICAgIH0KICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QucHVzaChbYWRkcmVzcywgc3RvcmFnZUtleXNdKTsKICAgIH0KICAgIHJldHVybiBzZXJpYWxpemVkQWNjZXNzTGlzdDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy90cmFuc2FjdGlvbi9zZXJpYWxpemVUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHR5cGUgPSBnZXRUcmFuc2FjdGlvblR5cGUodHJhbnNhY3Rpb24pOwogICAgaWYgKHR5cGUgPT09ICJlaXAxNTU5IikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQMTU1OSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIGlmICh0eXBlID09PSAiZWlwMjkzMCIpCiAgICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgICBpZiAodHlwZSA9PT0gImVpcDQ4NDQiKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA0ODQ0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpOwogICAgaWYgKHR5cGUgPT09ICJlaXA3NzAyIikKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNzcwMih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbkxlZ2FjeSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3NzAyKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgYXV0aG9yaXphdGlvbkxpc3QsIGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDc3MDIodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZEF1dGhvcml6YXRpb25MaXN0ID0gc2VyaWFsaXplQXV0aG9yaXphdGlvbkxpc3QoYXV0aG9yaXphdGlvbkxpc3QpOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDA0IiwKICAgICAgdG9SbHAoWwogICAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgbWF4RmVlUGVyR2FzID8gdG9IZXgobWF4RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgICAgdG8gPz8gIjB4IiwKICAgICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgICAgZGF0YSA/PyAiMHgiLAogICAgICAgIHNlcmlhbGl6ZWRBY2Nlc3NMaXN0LAogICAgICAgIHNlcmlhbGl6ZWRBdXRob3JpemF0aW9uTGlzdCwKICAgICAgICAuLi50b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKQogICAgICBdKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNDg0NCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBjb25zdCB7IGNoYWluSWQsIGdhcywgbm9uY2UsIHRvLCB2YWx1ZSwgbWF4RmVlUGVyQmxvYkdhcywgbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhcywgYWNjZXNzTGlzdCwgZGF0YSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDQ4NDQodHJhbnNhY3Rpb24pOwogICAgbGV0IGJsb2JWZXJzaW9uZWRIYXNoZXMgPSB0cmFuc2FjdGlvbi5ibG9iVmVyc2lvbmVkSGFzaGVzOwogICAgbGV0IHNpZGVjYXJzID0gdHJhbnNhY3Rpb24uc2lkZWNhcnM7CiAgICBpZiAodHJhbnNhY3Rpb24uYmxvYnMgJiYgKHR5cGVvZiBibG9iVmVyc2lvbmVkSGFzaGVzID09PSAidW5kZWZpbmVkIiB8fCB0eXBlb2Ygc2lkZWNhcnMgPT09ICJ1bmRlZmluZWQiKSkgewogICAgICBjb25zdCBibG9iczIgPSB0eXBlb2YgdHJhbnNhY3Rpb24uYmxvYnNbMF0gPT09ICJzdHJpbmciID8gdHJhbnNhY3Rpb24uYmxvYnMgOiB0cmFuc2FjdGlvbi5ibG9icy5tYXAoKHgpID0+IGJ5dGVzVG9IZXgoeCkpOwogICAgICBjb25zdCBremcgPSB0cmFuc2FjdGlvbi5remc7CiAgICAgIGNvbnN0IGNvbW1pdG1lbnRzMiA9IGJsb2JzVG9Db21taXRtZW50cyh7CiAgICAgICAgYmxvYnM6IGJsb2JzMiwKICAgICAgICBremcKICAgICAgfSk7CiAgICAgIGlmICh0eXBlb2YgYmxvYlZlcnNpb25lZEhhc2hlcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA9IGNvbW1pdG1lbnRzVG9WZXJzaW9uZWRIYXNoZXMoewogICAgICAgICAgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMgogICAgICAgIH0pOwogICAgICBpZiAodHlwZW9mIHNpZGVjYXJzID09PSAidW5kZWZpbmVkIikgewogICAgICAgIGNvbnN0IHByb29mczIgPSBibG9ic1RvUHJvb2ZzKHsgYmxvYnM6IGJsb2JzMiwgY29tbWl0bWVudHM6IGNvbW1pdG1lbnRzMiwga3pnIH0pOwogICAgICAgIHNpZGVjYXJzID0gdG9CbG9iU2lkZWNhcnMoeyBibG9iczogYmxvYnMyLCBjb21taXRtZW50czogY29tbWl0bWVudHMyLCBwcm9vZnM6IHByb29mczIgfSk7CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgbWF4RmVlUGVyQmxvYkdhcyA/IHRvSGV4KG1heEZlZVBlckJsb2JHYXMpIDogIjB4IiwKICAgICAgYmxvYlZlcnNpb25lZEhhc2hlcyA/PyBbXSwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICBjb25zdCBibG9icyA9IFtdOwogICAgY29uc3QgY29tbWl0bWVudHMgPSBbXTsKICAgIGNvbnN0IHByb29mcyA9IFtdOwogICAgaWYgKHNpZGVjYXJzKQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZGVjYXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgeyBibG9iLCBjb21taXRtZW50LCBwcm9vZiB9ID0gc2lkZWNhcnNbaV07CiAgICAgICAgYmxvYnMucHVzaChibG9iKTsKICAgICAgICBjb21taXRtZW50cy5wdXNoKGNvbW1pdG1lbnQpOwogICAgICAgIHByb29mcy5wdXNoKHByb29mKTsKICAgICAgfQogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAzIiwKICAgICAgc2lkZWNhcnMgPyAoCiAgICAgICAgLy8gSWYgc2lkZWNhcnMgYXJlIGVuYWJsZWQsIGVudmVsb3BlIHR1cm5zIGludG8gYSAid3JhcHBlciI6CiAgICAgICAgdG9SbHAoW3NlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgYmxvYnMsIGNvbW1pdG1lbnRzLCBwcm9vZnNdKQogICAgICApIDogKAogICAgICAgIC8vIElmIHNpZGVjYXJzIGFyZSBkaXNhYmxlZCwgc3RhbmRhcmQgZW52ZWxvcGUgaXMgdXNlZDoKICAgICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICAgICkKICAgIF0pOwogIH0KICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkVJUDE1NTkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGFjY2Vzc0xpc3QsIGRhdGEgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25FSVAxNTU5KHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRBY2Nlc3NMaXN0ID0gc2VyaWFsaXplQWNjZXNzTGlzdChhY2Nlc3NMaXN0KTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVkQWNjZXNzTGlzdCwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4MDIiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVAyOTMwKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgZ2FzLCBkYXRhLCBub25jZSwgdG8sIHZhbHVlLCBhY2Nlc3NMaXN0LCBnYXNQcmljZSB9ID0gdHJhbnNhY3Rpb247CiAgICBhc3NlcnRUcmFuc2FjdGlvbkVJUDI5MzAodHJhbnNhY3Rpb24pOwogICAgY29uc3Qgc2VyaWFsaXplZEFjY2Vzc0xpc3QgPSBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpOwogICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IiwKICAgICAgc2VyaWFsaXplZEFjY2Vzc0xpc3QsCiAgICAgIC4uLnRvWVBhcml0eVNpZ25hdHVyZUFycmF5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDAxIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uTGVnYWN5KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGNvbnN0IHsgY2hhaW5JZCA9IDAsIGdhcywgZGF0YSwgbm9uY2UsIHRvLCB2YWx1ZSwgZ2FzUHJpY2UgfSA9IHRyYW5zYWN0aW9uOwogICAgYXNzZXJ0VHJhbnNhY3Rpb25MZWdhY3kodHJhbnNhY3Rpb24pOwogICAgbGV0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBnYXNQcmljZSA/IHRvSGV4KGdhc1ByaWNlKSA6ICIweCIsCiAgICAgIGdhcyA/IHRvSGV4KGdhcykgOiAiMHgiLAogICAgICB0byA/PyAiMHgiLAogICAgICB2YWx1ZSA/IHRvSGV4KHZhbHVlKSA6ICIweCIsCiAgICAgIGRhdGEgPz8gIjB4IgogICAgXTsKICAgIGlmIChzaWduYXR1cmUpIHsKICAgICAgY29uc3QgdiA9ICgoKSA9PiB7CiAgICAgICAgaWYgKHNpZ25hdHVyZS52ID49IDM1bikgewogICAgICAgICAgY29uc3QgaW5mZXJyZWRDaGFpbklkID0gKHNpZ25hdHVyZS52IC0gMzVuKSAvIDJuOwogICAgICAgICAgaWYgKGluZmVycmVkQ2hhaW5JZCA+IDApCiAgICAgICAgICAgIHJldHVybiBzaWduYXR1cmUudjsKICAgICAgICAgIHJldHVybiAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDM1biA/IDBuIDogMW4pOwogICAgICAgIH0KICAgICAgICBpZiAoY2hhaW5JZCA+IDApCiAgICAgICAgICByZXR1cm4gQmlnSW50KGNoYWluSWQgKiAyKSArIEJpZ0ludCgzNW4gKyBzaWduYXR1cmUudiAtIDI3bik7CiAgICAgICAgY29uc3QgdjIgPSAyN24gKyAoc2lnbmF0dXJlLnYgPT09IDI3biA/IDBuIDogMW4pOwogICAgICAgIGlmIChzaWduYXR1cmUudiAhPT0gdjIpCiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZExlZ2FjeVZFcnJvcih7IHY6IHNpZ25hdHVyZS52IH0pOwogICAgICAgIHJldHVybiB2MjsKICAgICAgfSkoKTsKICAgICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgICBjb25zdCBzID0gdHJpbShzaWduYXR1cmUucyk7CiAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgICAuLi5zZXJpYWxpemVkVHJhbnNhY3Rpb24sCiAgICAgICAgdG9IZXgodiksCiAgICAgICAgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsCiAgICAgICAgcyA9PT0gIjB4MDAiID8gIjB4IiA6IHMKICAgICAgXTsKICAgIH0gZWxzZSBpZiAoY2hhaW5JZCA+IDApIHsKICAgICAgc2VyaWFsaXplZFRyYW5zYWN0aW9uID0gWwogICAgICAgIC4uLnNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwKICAgICAgICB0b0hleChjaGFpbklkKSwKICAgICAgICAiMHgiLAogICAgICAgICIweCIKICAgICAgXTsKICAgIH0KICAgIHJldHVybiB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogIH0KICBmdW5jdGlvbiB0b1lQYXJpdHlTaWduYXR1cmVBcnJheSh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlXykgewogICAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbmF0dXJlXyA/PyB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHsgdiwgeVBhcml0eSB9ID0gc2lnbmF0dXJlOwogICAgaWYgKHR5cGVvZiBzaWduYXR1cmUuciA9PT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICh0eXBlb2Ygc2lnbmF0dXJlLnMgPT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gW107CiAgICBpZiAodHlwZW9mIHYgPT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiB5UGFyaXR5ID09PSAidW5kZWZpbmVkIikKICAgICAgcmV0dXJuIFtdOwogICAgY29uc3QgciA9IHRyaW0oc2lnbmF0dXJlLnIpOwogICAgY29uc3QgcyA9IHRyaW0oc2lnbmF0dXJlLnMpOwogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIHlQYXJpdHkgPT09ICJudW1iZXIiKQogICAgICAgIHJldHVybiB5UGFyaXR5ID8gdG9IZXgoMSkgOiAiMHgiOwogICAgICBpZiAodiA9PT0gMG4pCiAgICAgICAgcmV0dXJuICIweCI7CiAgICAgIGlmICh2ID09PSAxbikKICAgICAgICByZXR1cm4gdG9IZXgoMSk7CiAgICAgIHJldHVybiB2ID09PSAyN24gPyAiMHgiIDogdG9IZXgoMSk7CiAgICB9KSgpOwogICAgcmV0dXJuIFt5UGFyaXR5XywgciA9PT0gIjB4MDAiID8gIjB4IiA6IHIsIHMgPT09ICIweDAwIiA/ICIweCIgOiBzXTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9lcnJvcnMvdW5pdC5qcwogIGluaXRfYmFzZSgpOwogIHZhciBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKHsgdmFsdWUgfSkgewogICAgICBzdXBlcihgTnVtYmVyIFxgJHt2YWx1ZX1cYCBpcyBub3QgYSB2YWxpZCBkZWNpbWFsIG51bWJlci5gLCB7CiAgICAgICAgbmFtZTogIkludmFsaWREZWNpbWFsTnVtYmVyRXJyb3IiCiAgICAgIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy91bml0L3BhcnNlVW5pdHMuanMKICBmdW5jdGlvbiBwYXJzZVVuaXRzKHZhbHVlLCBkZWNpbWFscykgewogICAgaWYgKCEvXigtPykoWzAtOV0qKVwuPyhbMC05XSopJC8udGVzdCh2YWx1ZSkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkRGVjaW1hbE51bWJlckVycm9yKHsgdmFsdWUgfSk7CiAgICBsZXQgW2ludGVnZXIsIGZyYWN0aW9uID0gIjAiXSA9IHZhbHVlLnNwbGl0KCIuIik7CiAgICBjb25zdCBuZWdhdGl2ZSA9IGludGVnZXIuc3RhcnRzV2l0aCgiLSIpOwogICAgaWYgKG5lZ2F0aXZlKQogICAgICBpbnRlZ2VyID0gaW50ZWdlci5zbGljZSgxKTsKICAgIGZyYWN0aW9uID0gZnJhY3Rpb24ucmVwbGFjZSgvKDArKSQvLCAiIik7CiAgICBpZiAoZGVjaW1hbHMgPT09IDApIHsKICAgICAgaWYgKE1hdGgucm91bmQoTnVtYmVyKGAuJHtmcmFjdGlvbn1gKSkgPT09IDEpCiAgICAgICAgaW50ZWdlciA9IGAke0JpZ0ludChpbnRlZ2VyKSArIDFufWA7CiAgICAgIGZyYWN0aW9uID0gIiI7CiAgICB9IGVsc2UgaWYgKGZyYWN0aW9uLmxlbmd0aCA+IGRlY2ltYWxzKSB7CiAgICAgIGNvbnN0IFtsZWZ0LCB1bml0LCByaWdodF0gPSBbCiAgICAgICAgZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMgLSAxKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscyAtIDEsIGRlY2ltYWxzKSwKICAgICAgICBmcmFjdGlvbi5zbGljZShkZWNpbWFscykKICAgICAgXTsKICAgICAgY29uc3Qgcm91bmRlZCA9IE1hdGgucm91bmQoTnVtYmVyKGAke3VuaXR9LiR7cmlnaHR9YCkpOwogICAgICBpZiAocm91bmRlZCA+IDkpCiAgICAgICAgZnJhY3Rpb24gPSBgJHtCaWdJbnQobGVmdCkgKyBCaWdJbnQoMSl9MGAucGFkU3RhcnQobGVmdC5sZW5ndGggKyAxLCAiMCIpOwogICAgICBlbHNlCiAgICAgICAgZnJhY3Rpb24gPSBgJHtsZWZ0fSR7cm91bmRlZH1gOwogICAgICBpZiAoZnJhY3Rpb24ubGVuZ3RoID4gZGVjaW1hbHMpIHsKICAgICAgICBmcmFjdGlvbiA9IGZyYWN0aW9uLnNsaWNlKDEpOwogICAgICAgIGludGVnZXIgPSBgJHtCaWdJbnQoaW50ZWdlcikgKyAxbn1gOwogICAgICB9CiAgICAgIGZyYWN0aW9uID0gZnJhY3Rpb24uc2xpY2UoMCwgZGVjaW1hbHMpOwogICAgfSBlbHNlIHsKICAgICAgZnJhY3Rpb24gPSBmcmFjdGlvbi5wYWRFbmQoZGVjaW1hbHMsICIwIik7CiAgICB9CiAgICByZXR1cm4gQmlnSW50KGAke25lZ2F0aXZlID8gIi0iIDogIiJ9JHtpbnRlZ2VyfSR7ZnJhY3Rpb259YCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUV0aGVyLmpzCiAgaW5pdF91bml0KCk7CiAgZnVuY3Rpb24gcGFyc2VFdGhlcihldGhlciwgdW5pdCA9ICJ3ZWkiKSB7CiAgICByZXR1cm4gcGFyc2VVbml0cyhldGhlciwgZXRoZXJVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvdW5pdC9wYXJzZUd3ZWkuanMKICBpbml0X3VuaXQoKTsKICBmdW5jdGlvbiBwYXJzZUd3ZWkoZXRoZXIsIHVuaXQgPSAid2VpIikgewogICAgcmV0dXJuIHBhcnNlVW5pdHMoZXRoZXIsIGd3ZWlVbml0c1t1bml0XSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvbm9uY2VNYW5hZ2VyLmpzCiAgaW5pdF9scnUoKTsKICBmdW5jdGlvbiBjcmVhdGVOb25jZU1hbmFnZXIocGFyYW1ldGVycykgewogICAgY29uc3QgeyBzb3VyY2UgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBkZWx0YU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgICBjb25zdCBub25jZU1hcCA9IG5ldyBMcnVNYXAoODE5Mik7CiAgICBjb25zdCBwcm9taXNlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGNvbnN0IGdldEtleSA9ICh7IGFkZHJlc3MsIGNoYWluSWQgfSkgPT4gYCR7YWRkcmVzc30uJHtjaGFpbklkfWA7CiAgICByZXR1cm4gewogICAgICBhc3luYyBjb25zdW1lKHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLmdldCh7IGFkZHJlc3MsIGNoYWluSWQsIGNsaWVudCB9KTsKICAgICAgICB0aGlzLmluY3JlbWVudCh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBwcm9taXNlOwogICAgICAgIGF3YWl0IHNvdXJjZS5zZXQoeyBhZGRyZXNzLCBjaGFpbklkIH0sIG5vbmNlKTsKICAgICAgICBub25jZU1hcC5zZXQoa2V5LCBub25jZSk7CiAgICAgICAgcmV0dXJuIG5vbmNlOwogICAgICB9LAogICAgICBhc3luYyBpbmNyZW1lbnQoeyBhZGRyZXNzLCBjaGFpbklkIH0pIHsKICAgICAgICBjb25zdCBrZXkgPSBnZXRLZXkoeyBhZGRyZXNzLCBjaGFpbklkIH0pOwogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICBkZWx0YU1hcC5zZXQoa2V5LCBkZWx0YSArIDEpOwogICAgICB9LAogICAgICBhc3luYyBnZXQoeyBhZGRyZXNzLCBjaGFpbklkLCBjbGllbnQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgbGV0IHByb21pc2UgPSBwcm9taXNlTWFwLmdldChrZXkpOwogICAgICAgIGlmICghcHJvbWlzZSkgewogICAgICAgICAgcHJvbWlzZSA9IChhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3Qgbm9uY2UgPSBhd2FpdCBzb3VyY2UuZ2V0KHsgYWRkcmVzcywgY2hhaW5JZCwgY2xpZW50IH0pOwogICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzTm9uY2UgPSBub25jZU1hcC5nZXQoa2V5KSA/PyAwOwogICAgICAgICAgICAgIGlmIChwcmV2aW91c05vbmNlID4gMCAmJiBub25jZSA8PSBwcmV2aW91c05vbmNlKQogICAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzTm9uY2UgKyAxOwogICAgICAgICAgICAgIG5vbmNlTWFwLmRlbGV0ZShrZXkpOwogICAgICAgICAgICAgIHJldHVybiBub25jZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICB0aGlzLnJlc2V0KHsgYWRkcmVzcywgY2hhaW5JZCB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkoKTsKICAgICAgICAgIHByb21pc2VNYXAuc2V0KGtleSwgcHJvbWlzZSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRlbHRhID0gZGVsdGFNYXAuZ2V0KGtleSkgPz8gMDsKICAgICAgICByZXR1cm4gZGVsdGEgKyBhd2FpdCBwcm9taXNlOwogICAgICB9LAogICAgICByZXNldCh7IGFkZHJlc3MsIGNoYWluSWQgfSkgewogICAgICAgIGNvbnN0IGtleSA9IGdldEtleSh7IGFkZHJlc3MsIGNoYWluSWQgfSk7CiAgICAgICAgZGVsdGFNYXAuZGVsZXRlKGtleSk7CiAgICAgICAgcHJvbWlzZU1hcC5kZWxldGUoa2V5KTsKICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24ganNvblJwYygpIHsKICAgIHJldHVybiB7CiAgICAgIGFzeW5jIGdldChwYXJhbWV0ZXJzKSB7CiAgICAgICAgY29uc3QgeyBhZGRyZXNzLCBjbGllbnQgfSA9IHBhcmFtZXRlcnM7CiAgICAgICAgcmV0dXJuIGdldFRyYW5zYWN0aW9uQ291bnQoY2xpZW50LCB7CiAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgYmxvY2tUYWc6ICJwZW5kaW5nIgogICAgICAgIH0pOwogICAgICB9LAogICAgICBzZXQoKSB7CiAgICAgIH0KICAgIH07CiAgfQogIHZhciBub25jZU1hbmFnZXIgPSAvKiBAX19QVVJFX18gKi8gY3JlYXRlTm9uY2VNYW5hZ2VyKHsKICAgIHNvdXJjZToganNvblJwYygpCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9mb3JtYXR0ZXJzL3Byb29mLmpzCiAgZnVuY3Rpb24gZm9ybWF0U3RvcmFnZVByb29mKHN0b3JhZ2VQcm9vZikgewogICAgcmV0dXJuIHN0b3JhZ2VQcm9vZi5tYXAoKHByb29mKSA9PiAoewogICAgICAuLi5wcm9vZiwKICAgICAgdmFsdWU6IEJpZ0ludChwcm9vZi52YWx1ZSkKICAgIH0pKTsKICB9CiAgZnVuY3Rpb24gZm9ybWF0UHJvb2YocHJvb2YpIHsKICAgIHJldHVybiB7CiAgICAgIC4uLnByb29mLAogICAgICBiYWxhbmNlOiBwcm9vZi5iYWxhbmNlID8gQmlnSW50KHByb29mLmJhbGFuY2UpIDogdm9pZCAwLAogICAgICBub25jZTogcHJvb2Yubm9uY2UgPyBoZXhUb051bWJlcihwcm9vZi5ub25jZSkgOiB2b2lkIDAsCiAgICAgIHN0b3JhZ2VQcm9vZjogcHJvb2Yuc3RvcmFnZVByb29mID8gZm9ybWF0U3RvcmFnZVByb29mKHByb29mLnN0b3JhZ2VQcm9vZikgOiB2b2lkIDAKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0UHJvb2YuanMKICBhc3luYyBmdW5jdGlvbiBnZXRQcm9vZihjbGllbnQsIHsgYWRkcmVzcywgYmxvY2tOdW1iZXIsIGJsb2NrVGFnOiBibG9ja1RhZ18sIHN0b3JhZ2VLZXlzIH0pIHsKICAgIGNvbnN0IGJsb2NrVGFnID0gYmxvY2tUYWdfID8/ICJsYXRlc3QiOwogICAgY29uc3QgYmxvY2tOdW1iZXJIZXggPSBibG9ja051bWJlciAhPT0gdm9pZCAwID8gbnVtYmVyVG9IZXgoYmxvY2tOdW1iZXIpIDogdm9pZCAwOwogICAgY29uc3QgcHJvb2YgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nZXRQcm9vZiIsCiAgICAgIHBhcmFtczogW2FkZHJlc3MsIHN0b3JhZ2VLZXlzLCBibG9ja051bWJlckhleCB8fCBibG9ja1RhZ10KICAgIH0pOwogICAgcmV0dXJuIGZvcm1hdFByb29mKHByb29mKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gZ2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBibG9ja051bWJlciwgYmxvY2tUYWcgPSAibGF0ZXN0Iiwgc2xvdCB9KSB7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBjb25zdCBkYXRhID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfZ2V0U3RvcmFnZUF0IiwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgc2xvdCwgYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWddCiAgICB9KTsKICAgIHJldHVybiBkYXRhOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL2dldFRyYW5zYWN0aW9uLmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbihjbGllbnQsIHsgYmxvY2tIYXNoLCBibG9ja051bWJlciwgYmxvY2tUYWc6IGJsb2NrVGFnXywgaGFzaDogaGFzaDMsIGluZGV4OiBpbmRleDIgfSkgewogICAgY29uc3QgYmxvY2tUYWcgPSBibG9ja1RhZ18gfHwgImxhdGVzdCI7CiAgICBjb25zdCBibG9ja051bWJlckhleCA9IGJsb2NrTnVtYmVyICE9PSB2b2lkIDAgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICBsZXQgdHJhbnNhY3Rpb24gPSBudWxsOwogICAgaWYgKGhhc2gzKSB7CiAgICAgIHRyYW5zYWN0aW9uID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV0aF9nZXRUcmFuc2FjdGlvbkJ5SGFzaCIsCiAgICAgICAgcGFyYW1zOiBbaGFzaDNdCiAgICAgIH0sIHsgZGVkdXBlOiB0cnVlIH0pOwogICAgfSBlbHNlIGlmIChibG9ja0hhc2gpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja0hhc2hBbmRJbmRleCIsCiAgICAgICAgcGFyYW1zOiBbYmxvY2tIYXNoLCBudW1iZXJUb0hleChpbmRleDIpXQogICAgICB9LCB7IGRlZHVwZTogdHJ1ZSB9KTsKICAgIH0gZWxzZSBpZiAoYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWcpIHsKICAgICAgdHJhbnNhY3Rpb24gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uQnlCbG9ja051bWJlckFuZEluZGV4IiwKICAgICAgICBwYXJhbXM6IFtibG9ja051bWJlckhleCB8fCBibG9ja1RhZywgbnVtYmVyVG9IZXgoaW5kZXgyKV0KICAgICAgfSwgeyBkZWR1cGU6IEJvb2xlYW4oYmxvY2tOdW1iZXJIZXgpIH0pOwogICAgfQogICAgaWYgKCF0cmFuc2FjdGlvbikKICAgICAgdGhyb3cgbmV3IFRyYW5zYWN0aW9uTm90Rm91bmRFcnJvcih7CiAgICAgICAgYmxvY2tIYXNoLAogICAgICAgIGJsb2NrTnVtYmVyLAogICAgICAgIGJsb2NrVGFnLAogICAgICAgIGhhc2g6IGhhc2gzLAogICAgICAgIGluZGV4OiBpbmRleDIKICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uPy5mb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb247CiAgICByZXR1cm4gZm9ybWF0KHRyYW5zYWN0aW9uKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy9nZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMuanMKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbkNvbmZpcm1hdGlvbnMoY2xpZW50LCB7IGhhc2g6IGhhc2gzLCB0cmFuc2FjdGlvblJlY2VpcHQgfSkgewogICAgY29uc3QgW2Jsb2NrTnVtYmVyLCB0cmFuc2FjdGlvbl0gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSksCiAgICAgIGhhc2gzID8gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb24sICJnZXRUcmFuc2FjdGlvbiIpKHsgaGFzaDogaGFzaDMgfSkgOiB2b2lkIDAKICAgIF0pOwogICAgY29uc3QgdHJhbnNhY3Rpb25CbG9ja051bWJlciA9IHRyYW5zYWN0aW9uUmVjZWlwdD8uYmxvY2tOdW1iZXIgfHwgdHJhbnNhY3Rpb24/LmJsb2NrTnVtYmVyOwogICAgaWYgKCF0cmFuc2FjdGlvbkJsb2NrTnVtYmVyKQogICAgICByZXR1cm4gMG47CiAgICByZXR1cm4gYmxvY2tOdW1iZXIgLSB0cmFuc2FjdGlvbkJsb2NrTnVtYmVyICsgMW47CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LmpzCiAgaW5pdF90cmFuc2FjdGlvbigpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIHsgaGFzaDogaGFzaDMgfSkgewogICAgY29uc3QgcmVjZWlwdCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX2dldFRyYW5zYWN0aW9uUmVjZWlwdCIsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICBpZiAoIXJlY2VpcHQpCiAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvblJlY2VpcHROb3RGb3VuZEVycm9yKHsgaGFzaDogaGFzaDMgfSk7CiAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVjZWlwdD8uZm9ybWF0IHx8IGZvcm1hdFRyYW5zYWN0aW9uUmVjZWlwdDsKICAgIHJldHVybiBmb3JtYXQocmVjZWlwdCk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvbXVsdGljYWxsLmpzCiAgaW5pdF9hYmlzKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9nZXRDaGFpbkNvbnRyYWN0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIG11bHRpY2FsbChjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWxsb3dGYWlsdXJlID0gdHJ1ZSwgYmF0Y2hTaXplOiBiYXRjaFNpemVfLCBibG9ja051bWJlciwgYmxvY2tUYWcsIG11bHRpY2FsbEFkZHJlc3M6IG11bHRpY2FsbEFkZHJlc3NfLCBzdGF0ZU92ZXJyaWRlIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY29udHJhY3RzMiA9IHBhcmFtZXRlcnMuY29udHJhY3RzOwogICAgY29uc3QgYmF0Y2hTaXplID0gYmF0Y2hTaXplXyA/PyAodHlwZW9mIGNsaWVudC5iYXRjaD8ubXVsdGljYWxsID09PSAib2JqZWN0IiAmJiBjbGllbnQuYmF0Y2gubXVsdGljYWxsLmJhdGNoU2l6ZSB8fCAxMDI0KTsKICAgIGxldCBtdWx0aWNhbGxBZGRyZXNzID0gbXVsdGljYWxsQWRkcmVzc187CiAgICBpZiAoIW11bHRpY2FsbEFkZHJlc3MpIHsKICAgICAgaWYgKCFjbGllbnQuY2hhaW4pCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJjbGllbnQgY2hhaW4gbm90IGNvbmZpZ3VyZWQuIG11bHRpY2FsbEFkZHJlc3MgaXMgcmVxdWlyZWQuIik7CiAgICAgIG11bHRpY2FsbEFkZHJlc3MgPSBnZXRDaGFpbkNvbnRyYWN0QWRkcmVzcyh7CiAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbiwKICAgICAgICBjb250cmFjdDogIm11bHRpY2FsbDMiCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgY2h1bmtlZENhbGxzID0gW1tdXTsKICAgIGxldCBjdXJyZW50Q2h1bmsgPSAwOwogICAgbGV0IGN1cnJlbnRDaHVua1NpemUgPSAwOwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250cmFjdHMyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHsgYWJpOiBhYmkyLCBhZGRyZXNzLCBhcmdzLCBmdW5jdGlvbk5hbWUgfSA9IGNvbnRyYWN0czJbaV07CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgY2FsbERhdGEgPSBlbmNvZGVGdW5jdGlvbkRhdGEoeyBhYmk6IGFiaTIsIGFyZ3MsIGZ1bmN0aW9uTmFtZSB9KTsKICAgICAgICBjdXJyZW50Q2h1bmtTaXplICs9IChjYWxsRGF0YS5sZW5ndGggLSAyKSAvIDI7CiAgICAgICAgaWYgKAogICAgICAgICAgLy8gQ2hlY2sgaWYgYmF0Y2hpbmcgaXMgZW5hYmxlZC4KICAgICAgICAgIGJhdGNoU2l6ZSA+IDAgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgc2l6ZSBvZiB0aGUgYmF0Y2ggZXhjZWVkcyB0aGUgc2l6ZSBsaW1pdC4KICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPiBiYXRjaFNpemUgJiYgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgY2h1bmsgaXMgbm90IGFscmVhZHkgZW1wdHkuCiAgICAgICAgICBjaHVua2VkQ2FsbHNbY3VycmVudENodW5rXS5sZW5ndGggPiAwCiAgICAgICAgKSB7CiAgICAgICAgICBjdXJyZW50Q2h1bmsrKzsKICAgICAgICAgIGN1cnJlbnRDaHVua1NpemUgPSAoY2FsbERhdGEubGVuZ3RoIC0gMikgLyAyOwogICAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbXTsKICAgICAgICB9CiAgICAgICAgY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10gPSBbCiAgICAgICAgICAuLi5jaHVua2VkQ2FsbHNbY3VycmVudENodW5rXSwKICAgICAgICAgIHsKICAgICAgICAgICAgYWxsb3dGYWlsdXJlOiB0cnVlLAogICAgICAgICAgICBjYWxsRGF0YSwKICAgICAgICAgICAgdGFyZ2V0OiBhZGRyZXNzCiAgICAgICAgICB9CiAgICAgICAgXTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgYWJpOiBhYmkyLAogICAgICAgICAgYWRkcmVzcywKICAgICAgICAgIGFyZ3MsCiAgICAgICAgICBkb2NzUGF0aDogIi9kb2NzL2NvbnRyYWN0L211bHRpY2FsbCIsCiAgICAgICAgICBmdW5jdGlvbk5hbWUKICAgICAgICB9KTsKICAgICAgICBpZiAoIWFsbG93RmFpbHVyZSkKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIGNodW5rZWRDYWxsc1tjdXJyZW50Q2h1bmtdID0gWwogICAgICAgICAgLi4uY2h1bmtlZENhbGxzW2N1cnJlbnRDaHVua10sCiAgICAgICAgICB7CiAgICAgICAgICAgIGFsbG93RmFpbHVyZTogdHJ1ZSwKICAgICAgICAgICAgY2FsbERhdGE6ICIweCIsCiAgICAgICAgICAgIHRhcmdldDogYWRkcmVzcwogICAgICAgICAgfQogICAgICAgIF07CiAgICAgIH0KICAgIH0KICAgIGNvbnN0IGFnZ3JlZ2F0ZTNSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGNodW5rZWRDYWxscy5tYXAoKGNhbGxzKSA9PiBnZXRBY3Rpb24oY2xpZW50LCByZWFkQ29udHJhY3QsICJyZWFkQ29udHJhY3QiKSh7CiAgICAgIGFiaTogbXVsdGljYWxsM0FiaSwKICAgICAgYWRkcmVzczogbXVsdGljYWxsQWRkcmVzcywKICAgICAgYXJnczogW2NhbGxzXSwKICAgICAgYmxvY2tOdW1iZXIsCiAgICAgIGJsb2NrVGFnLAogICAgICBmdW5jdGlvbk5hbWU6ICJhZ2dyZWdhdGUzIiwKICAgICAgc3RhdGVPdmVycmlkZQogICAgfSkpKTsKICAgIGNvbnN0IHJlc3VsdHMgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWdncmVnYXRlM1Jlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgcmVzdWx0ID0gYWdncmVnYXRlM1Jlc3VsdHNbaV07CiAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAicmVqZWN0ZWQiKSB7CiAgICAgICAgaWYgKCFhbGxvd0ZhaWx1cmUpCiAgICAgICAgICB0aHJvdyByZXN1bHQucmVhc29uOwogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY2h1bmtlZENhbGxzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2goewogICAgICAgICAgICBzdGF0dXM6ICJmYWlsdXJlIiwKICAgICAgICAgICAgZXJyb3I6IHJlc3VsdC5yZWFzb24sCiAgICAgICAgICAgIHJlc3VsdDogdm9pZCAwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgICAgY29uc3QgYWdncmVnYXRlM1Jlc3VsdCA9IHJlc3VsdC52YWx1ZTsKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBhZ2dyZWdhdGUzUmVzdWx0Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgY29uc3QgeyByZXR1cm5EYXRhLCBzdWNjZXNzIH0gPSBhZ2dyZWdhdGUzUmVzdWx0W2pdOwogICAgICAgIGNvbnN0IHsgY2FsbERhdGEgfSA9IGNodW5rZWRDYWxsc1tpXVtqXTsKICAgICAgICBjb25zdCB7IGFiaTogYWJpMiwgYWRkcmVzcywgZnVuY3Rpb25OYW1lLCBhcmdzIH0gPSBjb250cmFjdHMyW3Jlc3VsdHMubGVuZ3RoXTsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGNhbGxEYXRhID09PSAiMHgiKQogICAgICAgICAgICB0aHJvdyBuZXcgQWJpRGVjb2RpbmdaZXJvRGF0YUVycm9yKCk7CiAgICAgICAgICBpZiAoIXN1Y2Nlc3MpCiAgICAgICAgICAgIHRocm93IG5ldyBSYXdDb250cmFjdEVycm9yKHsgZGF0YTogcmV0dXJuRGF0YSB9KTsKICAgICAgICAgIGNvbnN0IHJlc3VsdDIgPSBkZWNvZGVGdW5jdGlvblJlc3VsdCh7CiAgICAgICAgICAgIGFiaTogYWJpMiwKICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgZGF0YTogcmV0dXJuRGF0YSwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHJlc3VsdHMucHVzaChhbGxvd0ZhaWx1cmUgPyB7IHJlc3VsdDogcmVzdWx0Miwgc3RhdHVzOiAic3VjY2VzcyIgfSA6IHJlc3VsdDIpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBnZXRDb250cmFjdEVycm9yKGVyciwgewogICAgICAgICAgICBhYmk6IGFiaTIsCiAgICAgICAgICAgIGFkZHJlc3MsCiAgICAgICAgICAgIGFyZ3MsCiAgICAgICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvY29udHJhY3QvbXVsdGljYWxsIiwKICAgICAgICAgICAgZnVuY3Rpb25OYW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICghYWxsb3dGYWlsdXJlKQogICAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICAgIHJlc3VsdHMucHVzaCh7IGVycm9yLCByZXN1bHQ6IHZvaWQgMCwgc3RhdHVzOiAiZmFpbHVyZSIgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IGNvbnRyYWN0czIubGVuZ3RoKQogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigibXVsdGljYWxsIHJlc3VsdHMgbWlzbWF0Y2giKTsKICAgIHJldHVybiByZXN1bHRzOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3ZlcmlmeUhhc2guanMKICBpbml0X2FiaXMoKTsKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfY29udHJhY3QoKTsKICBpbml0X2VuY29kZURlcGxveURhdGEoKTsKICBpbml0X2dldEFkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzc0VxdWFsKCk7CiAgaW5pdF9pc0hleCgpOwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zZXJpYWxpemVTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25hdHVyZSh7IHIsIHMsIHRvID0gImhleCIsIHYsIHlQYXJpdHkgfSkgewogICAgY29uc3QgeVBhcml0eV8gPSAoKCkgPT4gewogICAgICBpZiAoeVBhcml0eSA9PT0gMCB8fCB5UGFyaXR5ID09PSAxKQogICAgICAgIHJldHVybiB5UGFyaXR5OwogICAgICBpZiAodiAmJiAodiA9PT0gMjduIHx8IHYgPT09IDI4biB8fCB2ID49IDM1bikpCiAgICAgICAgcmV0dXJuIHYgJSAybiA9PT0gMG4gPyAxIDogMDsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGB2YCBvciBgeVBhcml0eWAgdmFsdWUiKTsKICAgIH0pKCk7CiAgICBjb25zdCBzaWduYXR1cmUgPSBgMHgke25ldyBzZWNwMjU2azEuU2lnbmF0dXJlKGhleFRvQmlnSW50KHIpLCBoZXhUb0JpZ0ludChzKSkudG9Db21wYWN0SGV4KCl9JHt5UGFyaXR5XyA9PT0gMCA/ICIxYiIgOiAiMWMifWA7CiAgICBpZiAodG8gPT09ICJoZXgiKQogICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgcmV0dXJuIGhleFRvQnl0ZXMoc2lnbmF0dXJlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlIYXNoLmpzCiAgaW5pdF9jYWxsKCk7CiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5SGFzaDIoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBoYXNoOiBoYXNoMywgc2lnbmF0dXJlLCB1bml2ZXJzYWxTaWduYXR1cmVWZXJpZmllckFkZHJlc3MgPSBjbGllbnQuY2hhaW4/LmNvbnRyYWN0cz8udW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI/LmFkZHJlc3MsIC4uLnJlc3QgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmVIZXggPSAoKCkgPT4gewogICAgICBpZiAoaXNIZXgoc2lnbmF0dXJlKSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgICBpZiAodHlwZW9mIHNpZ25hdHVyZSA9PT0gIm9iamVjdCIgJiYgInIiIGluIHNpZ25hdHVyZSAmJiAicyIgaW4gc2lnbmF0dXJlKQogICAgICAgIHJldHVybiBzZXJpYWxpemVTaWduYXR1cmUoc2lnbmF0dXJlKTsKICAgICAgcmV0dXJuIGJ5dGVzVG9IZXgoc2lnbmF0dXJlKTsKICAgIH0pKCk7CiAgICBjb25zdCB3cmFwcGVkU2lnbmF0dXJlID0gYXdhaXQgKGFzeW5jICgpID0+IHsKICAgICAgaWYgKCFmYWN0b3J5ICYmICFmYWN0b3J5RGF0YSkKICAgICAgICByZXR1cm4gc2lnbmF0dXJlSGV4OwogICAgICBpZiAoaXNFcmM2NDkyU2lnbmF0dXJlKHNpZ25hdHVyZUhleCkpCiAgICAgICAgcmV0dXJuIHNpZ25hdHVyZUhleDsKICAgICAgcmV0dXJuIHNlcmlhbGl6ZUVyYzY0OTJTaWduYXR1cmUoewogICAgICAgIGFkZHJlc3M6IGZhY3RvcnksCiAgICAgICAgZGF0YTogZmFjdG9yeURhdGEsCiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVIZXgKICAgICAgfSk7CiAgICB9KSgpOwogICAgdHJ5IHsKICAgICAgY29uc3QgYXJncyA9IHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyQWRkcmVzcyA/IHsKICAgICAgICB0bzogdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXJBZGRyZXNzLAogICAgICAgIGRhdGE6IGVuY29kZUZ1bmN0aW9uRGF0YSh7CiAgICAgICAgICBhYmk6IHVuaXZlcnNhbFNpZ25hdHVyZVZhbGlkYXRvckFiaSwKICAgICAgICAgIGZ1bmN0aW9uTmFtZTogImlzVmFsaWRTaWciLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfSA6IHsKICAgICAgICBkYXRhOiBlbmNvZGVEZXBsb3lEYXRhKHsKICAgICAgICAgIGFiaTogdW5pdmVyc2FsU2lnbmF0dXJlVmFsaWRhdG9yQWJpLAogICAgICAgICAgYXJnczogW2FkZHJlc3MsIGhhc2gzLCB3cmFwcGVkU2lnbmF0dXJlXSwKICAgICAgICAgIGJ5dGVjb2RlOiB1bml2ZXJzYWxTaWduYXR1cmVWYWxpZGF0b3JCeXRlQ29kZQogICAgICAgIH0pLAogICAgICAgIC4uLnJlc3QKICAgICAgfTsKICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBjYWxsLCAiY2FsbCIpKGFyZ3MpOwogICAgICByZXR1cm4gaGV4VG9Cb29sKGRhdGEgPz8gIjB4MCIpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB2ZXJpZmllZCA9IGlzQWRkcmVzc0VxdWFsKGdldEFkZHJlc3MoYWRkcmVzcyksIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsgaGFzaDogaGFzaDMsIHNpZ25hdHVyZSB9KSk7CiAgICAgICAgaWYgKHZlcmlmaWVkKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggewogICAgICB9CiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIENhbGxFeGVjdXRpb25FcnJvcikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy92ZXJpZnlNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCB7IGFkZHJlc3MsIG1lc3NhZ2UsIGZhY3RvcnksIGZhY3RvcnlEYXRhLCBzaWduYXR1cmUsIC4uLmNhbGxSZXF1ZXN0IH0pIHsKICAgIGNvbnN0IGhhc2gzID0gaGFzaE1lc3NhZ2UobWVzc2FnZSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvdmVyaWZ5VHlwZWREYXRhLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VHlwZWREYXRhMihjbGllbnQsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHsgYWRkcmVzcywgZmFjdG9yeSwgZmFjdG9yeURhdGEsIHNpZ25hdHVyZSwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4sIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgaGFzaDMgPSBoYXNoVHlwZWREYXRhKHsgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzLCBkb21haW4gfSk7CiAgICByZXR1cm4gdmVyaWZ5SGFzaDIoY2xpZW50LCB7CiAgICAgIGFkZHJlc3MsCiAgICAgIGZhY3RvcnksCiAgICAgIGZhY3RvcnlEYXRhLAogICAgICBoYXNoOiBoYXNoMywKICAgICAgc2lnbmF0dXJlLAogICAgICAuLi5jYWxsUmVxdWVzdAogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdC5qcwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X3dpdGhSZXNvbHZlcnMoKTsKICBpbml0X3N0cmluZ2lmeSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja051bWJlci5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfc3RyaW5naWZ5KCk7CiAgZnVuY3Rpb24gd2F0Y2hCbG9ja051bWJlcihjbGllbnQsIHsgZW1pdE9uQmVnaW4gPSBmYWxzZSwgZW1pdE1pc3NlZCA9IGZhbHNlLCBvbkJsb2NrTnVtYmVyLCBvbkVycm9yLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGxldCBwcmV2QmxvY2tOdW1iZXI7CiAgICBjb25zdCBwb2xsQmxvY2tOdW1iZXIgPSAoKSA9PiB7CiAgICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWwogICAgICAgICJ3YXRjaEJsb2NrTnVtYmVyIiwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGVtaXRPbkJlZ2luLAogICAgICAgIGVtaXRNaXNzZWQsCiAgICAgICAgcG9sbGluZ0ludGVydmFsCiAgICAgIF0pOwogICAgICByZXR1cm4gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uQmxvY2tOdW1iZXIsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7IGNhY2hlVGltZTogMCB9KTsKICAgICAgICAgIGlmIChwcmV2QmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgaWYgKGJsb2NrTnVtYmVyID09PSBwcmV2QmxvY2tOdW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2tOdW1iZXIgLSBwcmV2QmxvY2tOdW1iZXIgPiAxICYmIGVtaXRNaXNzZWQpIHsKICAgICAgICAgICAgICBmb3IgKGxldCBpID0gcHJldkJsb2NrTnVtYmVyICsgMW47IGkgPCBibG9ja051bWJlcjsgaSsrKSB7CiAgICAgICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoaSwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXByZXZCbG9ja051bWJlciB8fCBibG9ja051bWJlciA+IHByZXZCbG9ja051bWJlcikgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2tOdW1iZXIoYmxvY2tOdW1iZXIsIHByZXZCbG9ja051bWJlcik7CiAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja051bWJlciA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoQmxvY2tOdW1iZXIiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgZW1pdE9uQmVnaW4sCiAgICAgICAgZW1pdE1pc3NlZAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrTnVtYmVyLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IGFjdGl2ZSA9IHRydWU7CiAgICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIikgewogICAgICAgICAgICAgICAgY29uc3QgdHJhbnNwb3J0MiA9IGNsaWVudC50cmFuc3BvcnQudHJhbnNwb3J0cy5maW5kKCh0cmFuc3BvcnQzKSA9PiB0cmFuc3BvcnQzLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0Iik7CiAgICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zcG9ydDIudmFsdWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBjbGllbnQudHJhbnNwb3J0OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICAgIHBhcmFtczogWyJuZXdIZWFkcyJdLAogICAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBoZXhUb0JpZ0ludChkYXRhLnJlc3VsdD8ubnVtYmVyKTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9ja051bWJlcihibG9ja051bWJlciwgcHJldkJsb2NrTnVtYmVyKTsKICAgICAgICAgICAgICAgIHByZXZCbG9ja051bWJlciA9IGJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyb3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmVfOwogICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBlbmFibGVQb2xsaW5nID8gcG9sbEJsb2NrTnVtYmVyKCkgOiBzdWJzY3JpYmVCbG9ja051bWJlcigpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvcHVibGljL3dhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHQuanMKICBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0KGNsaWVudCwgewogICAgY29uZmlybWF0aW9ucyA9IDEsCiAgICBoYXNoOiBoYXNoMywKICAgIG9uUmVwbGFjZWQsCiAgICBwb2xsaW5nSW50ZXJ2YWwgPSBjbGllbnQucG9sbGluZ0ludGVydmFsLAogICAgcmV0cnlDb3VudCA9IDYsCiAgICByZXRyeURlbGF5ID0gKHsgY291bnQgfSkgPT4gfn4oMSA8PCBjb3VudCkgKiAyMDAsCiAgICAvLyBleHBvbmVudGlhbCBiYWNrb2ZmCiAgICB0aW1lb3V0ID0gMThlNAogIH0pIHsKICAgIGNvbnN0IG9ic2VydmVySWQgPSBzdHJpbmdpZnkoWyJ3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0IiwgY2xpZW50LnVpZCwgaGFzaDNdKTsKICAgIGxldCB0cmFuc2FjdGlvbjsKICAgIGxldCByZXBsYWNlZFRyYW5zYWN0aW9uOwogICAgbGV0IHJlY2VpcHQ7CiAgICBsZXQgcmV0cnlpbmcgPSBmYWxzZTsKICAgIGNvbnN0IHsgcHJvbWlzZSwgcmVzb2x2ZSwgcmVqZWN0IH0gPSB3aXRoUmVzb2x2ZXJzKCk7CiAgICBjb25zdCB0aW1lciA9IHRpbWVvdXQgPyBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgV2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdFRpbWVvdXRFcnJvcih7IGhhc2g6IGhhc2gzIH0pKSwgdGltZW91dCkgOiB2b2lkIDA7CiAgICBjb25zdCBfdW5vYnNlcnZlID0gb2JzZXJ2ZShvYnNlcnZlcklkLCB7IG9uUmVwbGFjZWQsIHJlc29sdmUsIHJlamVjdCB9LCAoZW1pdCkgPT4gewogICAgICBjb25zdCBfdW53YXRjaCA9IGdldEFjdGlvbihjbGllbnQsIHdhdGNoQmxvY2tOdW1iZXIsICJ3YXRjaEJsb2NrTnVtYmVyIikoewogICAgICAgIGVtaXRNaXNzZWQ6IHRydWUsCiAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgcG9sbDogdHJ1ZSwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwsCiAgICAgICAgYXN5bmMgb25CbG9ja051bWJlcihibG9ja051bWJlcl8pIHsKICAgICAgICAgIGNvbnN0IGRvbmUgPSAoZm4pID0+IHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgICAgICAgICAgX3Vud2F0Y2goKTsKICAgICAgICAgICAgZm4oKTsKICAgICAgICAgICAgX3Vub2JzZXJ2ZSgpOwogICAgICAgICAgfTsKICAgICAgICAgIGxldCBibG9ja051bWJlciA9IGJsb2NrTnVtYmVyXzsKICAgICAgICAgIGlmIChyZXRyeWluZykKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlY2VpcHQpIHsKICAgICAgICAgICAgICBpZiAoY29uZmlybWF0aW9ucyA+IDEgJiYgKCFyZWNlaXB0LmJsb2NrTnVtYmVyIHx8IGJsb2NrTnVtYmVyIC0gcmVjZWlwdC5ibG9ja051bWJlciArIDFuIDwgY29uZmlybWF0aW9ucykpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgZG9uZSgoKSA9PiBlbWl0LnJlc29sdmUocmVjZWlwdCkpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgIGF3YWl0IHdpdGhSZXRyeShhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uLCAiZ2V0VHJhbnNhY3Rpb24iKSh7IGhhc2g6IGhhc2gzIH0pOwogICAgICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyKQogICAgICAgICAgICAgICAgICBibG9ja051bWJlciA9IHRyYW5zYWN0aW9uLmJsb2NrTnVtYmVyOwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgcmV0cnlDb3VudAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHJldHJ5aW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVjZWlwdCA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldFRyYW5zYWN0aW9uUmVjZWlwdCwgImdldFRyYW5zYWN0aW9uUmVjZWlwdCIpKHsgaGFzaDogaGFzaDMgfSk7CiAgICAgICAgICAgIGlmIChjb25maXJtYXRpb25zID4gMSAmJiAoIXJlY2VpcHQuYmxvY2tOdW1iZXIgfHwgYmxvY2tOdW1iZXIgLSByZWNlaXB0LmJsb2NrTnVtYmVyICsgMW4gPCBjb25maXJtYXRpb25zKSkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZXNvbHZlKHJlY2VpcHQpKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVHJhbnNhY3Rpb25Ob3RGb3VuZEVycm9yIHx8IGVyciBpbnN0YW5jZW9mIFRyYW5zYWN0aW9uUmVjZWlwdE5vdEZvdW5kRXJyb3IpIHsKICAgICAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgICByZXRyeWluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCB3aXRoUmV0cnkoKCkgPT4gZ2V0QWN0aW9uKGNsaWVudCwgZ2V0QmxvY2ssICJnZXRCbG9jayIpKHsKICAgICAgICAgICAgICAgICAgYmxvY2tOdW1iZXIsCiAgICAgICAgICAgICAgICAgIGluY2x1ZGVUcmFuc2FjdGlvbnM6IHRydWUKICAgICAgICAgICAgICAgIH0pLCB7CiAgICAgICAgICAgICAgICAgIGRlbGF5OiByZXRyeURlbGF5LAogICAgICAgICAgICAgICAgICByZXRyeUNvdW50LAogICAgICAgICAgICAgICAgICBzaG91bGRSZXRyeTogKHsgZXJyb3IgfSkgPT4gZXJyb3IgaW5zdGFuY2VvZiBCbG9ja05vdEZvdW5kRXJyb3IKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0cnlpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50VHJhbnNhY3Rpb24gPSBibG9jay50cmFuc2FjdGlvbnMuZmluZCgoeyBmcm9tLCBub25jZSB9KSA9PiBmcm9tID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLmZyb20gJiYgbm9uY2UgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24ubm9uY2UpOwogICAgICAgICAgICAgICAgaWYgKCFyZXBsYWNlbWVudFRyYW5zYWN0aW9uKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICByZWNlaXB0ID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0VHJhbnNhY3Rpb25SZWNlaXB0LCAiZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IikoewogICAgICAgICAgICAgICAgICBoYXNoOiByZXBsYWNlbWVudFRyYW5zYWN0aW9uLmhhc2gKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1hdGlvbnMgPiAxICYmICghcmVjZWlwdC5ibG9ja051bWJlciB8fCBibG9ja051bWJlciAtIHJlY2VpcHQuYmxvY2tOdW1iZXIgKyAxbiA8IGNvbmZpcm1hdGlvbnMpKQogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBsZXQgcmVhc29uID0gInJlcGxhY2VkIjsKICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvID09PSByZXBsYWNlZFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IHJlcGxhY2VkVHJhbnNhY3Rpb24udmFsdWUpIHsKICAgICAgICAgICAgICAgICAgcmVhc29uID0gInJlcHJpY2VkIjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVwbGFjZW1lbnRUcmFuc2FjdGlvbi5mcm9tID09PSByZXBsYWNlbWVudFRyYW5zYWN0aW9uLnRvICYmIHJlcGxhY2VtZW50VHJhbnNhY3Rpb24udmFsdWUgPT09IDBuKSB7CiAgICAgICAgICAgICAgICAgIHJlYXNvbiA9ICJjYW5jZWxsZWQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9uZSgoKSA9PiB7CiAgICAgICAgICAgICAgICAgIGVtaXQub25SZXBsYWNlZD8uKHsKICAgICAgICAgICAgICAgICAgICByZWFzb24sCiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZWRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbjogcmVwbGFjZW1lbnRUcmFuc2FjdGlvbiwKICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IHJlY2VpcHQKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGVtaXQucmVzb2x2ZShyZWNlaXB0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycl8pIHsKICAgICAgICAgICAgICAgIGRvbmUoKCkgPT4gZW1pdC5yZWplY3QoZXJyXykpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBkb25lKCgpID0+IGVtaXQucmVqZWN0KGVycikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIHByb21pc2U7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9wdWJsaWMvd2F0Y2hCbG9ja3MuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoQmxvY2tzKGNsaWVudCwgeyBibG9ja1RhZyA9ICJsYXRlc3QiLCBlbWl0TWlzc2VkID0gZmFsc2UsIGVtaXRPbkJlZ2luID0gZmFsc2UsIG9uQmxvY2ssIG9uRXJyb3IsIGluY2x1ZGVUcmFuc2FjdGlvbnM6IGluY2x1ZGVUcmFuc2FjdGlvbnNfLCBwb2xsOiBwb2xsXywgcG9sbGluZ0ludGVydmFsID0gY2xpZW50LnBvbGxpbmdJbnRlcnZhbCB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAoY2xpZW50LnRyYW5zcG9ydC50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIgJiYgY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzWzBdLmNvbmZpZy50eXBlID09PSAid2ViU29ja2V0IikKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSkoKTsKICAgIGNvbnN0IGluY2x1ZGVUcmFuc2FjdGlvbnMgPSBpbmNsdWRlVHJhbnNhY3Rpb25zXyA/PyBmYWxzZTsKICAgIGxldCBwcmV2QmxvY2s7CiAgICBjb25zdCBwb2xsQmxvY2tzID0gKCkgPT4gewogICAgICBjb25zdCBvYnNlcnZlcklkID0gc3RyaW5naWZ5KFsKICAgICAgICAid2F0Y2hCbG9ja3MiLAogICAgICAgIGNsaWVudC51aWQsCiAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgZW1pdE1pc3NlZCwKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zLAogICAgICAgIHBvbGxpbmdJbnRlcnZhbAogICAgICBdKTsKICAgICAgcmV0dXJuIG9ic2VydmUob2JzZXJ2ZXJJZCwgeyBvbkJsb2NrLCBvbkVycm9yIH0sIChlbWl0KSA9PiBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgYmxvY2sgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRCbG9jaywgImdldEJsb2NrIikoewogICAgICAgICAgICBibG9ja1RhZywKICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYmxvY2subnVtYmVyICYmIHByZXZCbG9jaz8ubnVtYmVyKSB7CiAgICAgICAgICAgIGlmIChibG9jay5udW1iZXIgPT09IHByZXZCbG9jay5udW1iZXIpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmxvY2subnVtYmVyIC0gcHJldkJsb2NrLm51bWJlciA+IDEgJiYgZW1pdE1pc3NlZCkgewogICAgICAgICAgICAgIGZvciAobGV0IGkgPSBwcmV2QmxvY2s/Lm51bWJlciArIDFuOyBpIDwgYmxvY2subnVtYmVyOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrMiA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgICAgIGJsb2NrTnVtYmVyOiBpLAogICAgICAgICAgICAgICAgICBpbmNsdWRlVHJhbnNhY3Rpb25zCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGVtaXQub25CbG9jayhibG9jazIsIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIC8vIElmIG5vIHByZXZpb3VzIGJsb2NrIGV4aXN0cywgZW1pdC4KICAgICAgICAgICAgIXByZXZCbG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBibG9jayB0YWcgaXMgInBlbmRpbmciIHdpdGggbm8gYmxvY2sgbnVtYmVyLCBlbWl0LgogICAgICAgICAgICBibG9ja1RhZyA9PT0gInBlbmRpbmciICYmICFibG9jaz8ubnVtYmVyIHx8IC8vIElmIHRoZSBuZXh0IGJsb2NrIG51bWJlciBpcyBncmVhdGVyIHRoYW4gdGhlIHByZXZpb3VzIGJsb2NrIG51bWJlciwgZW1pdC4KICAgICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byBlbWl0IGJsb2NrcyBpbiB0aGUgcGFzdC4KICAgICAgICAgICAgYmxvY2subnVtYmVyICYmIGJsb2NrLm51bWJlciA+IHByZXZCbG9jay5udW1iZXIKICAgICAgICAgICkgewogICAgICAgICAgICBlbWl0Lm9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgIHByZXZCbG9jayA9IGJsb2NrOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgZW1pdC5vbkVycm9yPy4oZXJyKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBlbWl0T25CZWdpbiwKICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgIH0pKTsKICAgIH07CiAgICBjb25zdCBzdWJzY3JpYmVCbG9ja3MgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgZW1pdEZldGNoZWQgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGVtaXRPbkJlZ2luKSB7CiAgICAgICAgICAgIGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrLCAiZ2V0QmxvY2siKSh7CiAgICAgICAgICAgICAgYmxvY2tUYWcsCiAgICAgICAgICAgICAgaW5jbHVkZVRyYW5zYWN0aW9ucwogICAgICAgICAgICB9KS50aGVuKChibG9jaykgPT4gewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGlmICghZW1pdEZldGNoZWQpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgb25CbG9jayhibG9jaywgdm9pZCAwKTsKICAgICAgICAgICAgICBlbWl0RmV0Y2hlZCA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibmV3SGVhZHMiXSwKICAgICAgICAgICAgb25EYXRhKGRhdGEpIHsKICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LmJsb2NrPy5mb3JtYXQgfHwgZm9ybWF0QmxvY2s7CiAgICAgICAgICAgICAgY29uc3QgYmxvY2sgPSBmb3JtYXQoZGF0YS5yZXN1bHQpOwogICAgICAgICAgICAgIG9uQmxvY2soYmxvY2ssIHByZXZCbG9jayk7CiAgICAgICAgICAgICAgZW1pdEZldGNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBwcmV2QmxvY2sgPSBibG9jazsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsQmxvY2tzKCkgOiBzdWJzY3JpYmVCbG9ja3MoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaEV2ZW50LmpzCiAgaW5pdF9zdHJpbmdpZnkoKTsKICBpbml0X2FiaSgpOwogIGluaXRfcnBjKCk7CiAgZnVuY3Rpb24gd2F0Y2hFdmVudChjbGllbnQsIHsgYWRkcmVzcywgYXJncywgYmF0Y2ggPSB0cnVlLCBldmVudCwgZXZlbnRzLCBmcm9tQmxvY2ssIG9uRXJyb3IsIG9uTG9ncywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwsIHN0cmljdDogc3RyaWN0XyB9KSB7CiAgICBjb25zdCBlbmFibGVQb2xsaW5nID0gKCgpID0+IHsKICAgICAgaWYgKHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHBvbGxfOwogICAgICBpZiAodHlwZW9mIGZyb21CbG9jayA9PT0gImJpZ2ludCIpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgaWYgKGNsaWVudC50cmFuc3BvcnQudHlwZSA9PT0gImZhbGxiYWNrIiAmJiBjbGllbnQudHJhbnNwb3J0LnRyYW5zcG9ydHNbMF0uY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9KSgpOwogICAgY29uc3Qgc3RyaWN0ID0gc3RyaWN0XyA/PyBmYWxzZTsKICAgIGNvbnN0IHBvbGxFdmVudCA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoRXZlbnQiLAogICAgICAgIGFkZHJlc3MsCiAgICAgICAgYXJncywKICAgICAgICBiYXRjaCwKICAgICAgICBjbGllbnQudWlkLAogICAgICAgIGV2ZW50LAogICAgICAgIHBvbGxpbmdJbnRlcnZhbCwKICAgICAgICBmcm9tQmxvY2sKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25Mb2dzLCBvbkVycm9yIH0sIChlbWl0KSA9PiB7CiAgICAgICAgbGV0IHByZXZpb3VzQmxvY2tOdW1iZXI7CiAgICAgICAgaWYgKGZyb21CbG9jayAhPT0gdm9pZCAwKQogICAgICAgICAgcHJldmlvdXNCbG9ja051bWJlciA9IGZyb21CbG9jayAtIDFuOwogICAgICAgIGxldCBmaWx0ZXI7CiAgICAgICAgbGV0IGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgY29uc3QgdW53YXRjaCA9IHBvbGwoYXN5bmMgKCkgPT4gewogICAgICAgICAgaWYgKCFpbml0aWFsaXplZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZUV2ZW50RmlsdGVyLCAiY3JlYXRlRXZlbnRGaWx0ZXIiKSh7CiAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgIGV2ZW50LAogICAgICAgICAgICAgICAgZXZlbnRzLAogICAgICAgICAgICAgICAgc3RyaWN0LAogICAgICAgICAgICAgICAgZnJvbUJsb2NrCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGV0IGxvZ3M7CiAgICAgICAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICAgICAgICBsb2dzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGdldEJsb2NrTnVtYmVyLCAiZ2V0QmxvY2tOdW1iZXIiKSh7fSk7CiAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQmxvY2tOdW1iZXIgJiYgcHJldmlvdXNCbG9ja051bWJlciAhPT0gYmxvY2tOdW1iZXIpIHsKICAgICAgICAgICAgICAgIGxvZ3MgPSBhd2FpdCBnZXRBY3Rpb24oY2xpZW50LCBnZXRMb2dzLCAiZ2V0TG9ncyIpKHsKICAgICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgICAgZXZlbnQsCiAgICAgICAgICAgICAgICAgIGV2ZW50cywKICAgICAgICAgICAgICAgICAgZnJvbUJsb2NrOiBwcmV2aW91c0Jsb2NrTnVtYmVyICsgMW4sCiAgICAgICAgICAgICAgICAgIHRvQmxvY2s6IGJsb2NrTnVtYmVyCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9ncyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcmV2aW91c0Jsb2NrTnVtYmVyID0gYmxvY2tOdW1iZXI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvZ3MubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKGJhdGNoKQogICAgICAgICAgICAgIGVtaXQub25Mb2dzKGxvZ3MpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBsb2cgb2YgbG9ncykKICAgICAgICAgICAgICAgIGVtaXQub25Mb2dzKFtsb2ddKTsKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBpZiAoZmlsdGVyICYmIGVyciBpbnN0YW5jZW9mIEludmFsaWRJbnB1dFJwY0Vycm9yKQogICAgICAgICAgICAgIGluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZUV2ZW50ID0gKCkgPT4gewogICAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgICAgbGV0IHVuc3Vic2NyaWJlID0gKCkgPT4gYWN0aXZlID0gZmFsc2U7CiAgICAgIChhc3luYyAoKSA9PiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydCA9ICgoKSA9PiB7CiAgICAgICAgICAgIGlmIChjbGllbnQudHJhbnNwb3J0LnR5cGUgPT09ICJmYWxsYmFjayIpIHsKICAgICAgICAgICAgICBjb25zdCB0cmFuc3BvcnQyID0gY2xpZW50LnRyYW5zcG9ydC50cmFuc3BvcnRzLmZpbmQoKHRyYW5zcG9ydDMpID0+IHRyYW5zcG9ydDMuY29uZmlnLnR5cGUgPT09ICJ3ZWJTb2NrZXQiKTsKICAgICAgICAgICAgICBpZiAoIXRyYW5zcG9ydDIpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwb3J0Mi52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY2xpZW50LnRyYW5zcG9ydDsKICAgICAgICAgIH0pKCk7CiAgICAgICAgICBjb25zdCBldmVudHNfID0gZXZlbnRzID8/IChldmVudCA/IFtldmVudF0gOiB2b2lkIDApOwogICAgICAgICAgbGV0IHRvcGljcyA9IFtdOwogICAgICAgICAgaWYgKGV2ZW50c18pIHsKICAgICAgICAgICAgY29uc3QgZW5jb2RlZCA9IGV2ZW50c18uZmxhdE1hcCgoZXZlbnQyKSA9PiBlbmNvZGVFdmVudFRvcGljcyh7CiAgICAgICAgICAgICAgYWJpOiBbZXZlbnQyXSwKICAgICAgICAgICAgICBldmVudE5hbWU6IGV2ZW50Mi5uYW1lLAogICAgICAgICAgICAgIGFyZ3MKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB0b3BpY3MgPSBbZW5jb2RlZF07CiAgICAgICAgICAgIGlmIChldmVudCkKICAgICAgICAgICAgICB0b3BpY3MgPSB0b3BpY3NbMF07CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB7IHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZV8gfSA9IGF3YWl0IHRyYW5zcG9ydC5zdWJzY3JpYmUoewogICAgICAgICAgICBwYXJhbXM6IFsibG9ncyIsIHsgYWRkcmVzcywgdG9waWNzIH1dLAogICAgICAgICAgICBvbkRhdGEoZGF0YSkgewogICAgICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIGNvbnN0IGxvZyA9IGRhdGEucmVzdWx0OwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCB7IGV2ZW50TmFtZSwgYXJnczogYXJnczIgfSA9IGRlY29kZUV2ZW50TG9nKHsKICAgICAgICAgICAgICAgICAgYWJpOiBldmVudHNfID8/IFtdLAogICAgICAgICAgICAgICAgICBkYXRhOiBsb2cuZGF0YSwKICAgICAgICAgICAgICAgICAgdG9waWNzOiBsb2cudG9waWNzLAogICAgICAgICAgICAgICAgICBzdHJpY3QKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0TG9nKGxvZywgeyBhcmdzOiBhcmdzMiwgZXZlbnROYW1lIH0pOwogICAgICAgICAgICAgICAgb25Mb2dzKFtmb3JtYXR0ZWRdKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGxldCBldmVudE5hbWU7CiAgICAgICAgICAgICAgICBsZXQgaXNVbm5hbWVkOwogICAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIERlY29kZUxvZ0RhdGFNaXNtYXRjaCB8fCBlcnIgaW5zdGFuY2VvZiBEZWNvZGVMb2dUb3BpY3NNaXNtYXRjaCkgewogICAgICAgICAgICAgICAgICBpZiAoc3RyaWN0XykKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZSA9IGVyci5hYmlJdGVtLm5hbWU7CiAgICAgICAgICAgICAgICAgIGlzVW5uYW1lZCA9IGVyci5hYmlJdGVtLmlucHV0cz8uc29tZSgoeCkgPT4gISgibmFtZSIgaW4geCAmJiB4Lm5hbWUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZCA9IGZvcm1hdExvZyhsb2csIHsKICAgICAgICAgICAgICAgICAgYXJnczogaXNVbm5hbWVkID8gW10gOiB7fSwKICAgICAgICAgICAgICAgICAgZXZlbnROYW1lCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG9uTG9ncyhbZm9ybWF0dGVkXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkVycm9yKGVycm9yKSB7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB1bnN1YnNjcmliZSA9IHVuc3Vic2NyaWJlXzsKICAgICAgICAgIGlmICghYWN0aXZlKQogICAgICAgICAgICB1bnN1YnNjcmliZSgpOwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgb25FcnJvcj8uKGVycik7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICByZXR1cm4gZW5hYmxlUG9sbGluZyA/IHBvbGxFdmVudCgpIDogc3Vic2NyaWJlRXZlbnQoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3B1YmxpYy93YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMuanMKICBpbml0X3N0cmluZ2lmeSgpOwogIGZ1bmN0aW9uIHdhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyhjbGllbnQsIHsgYmF0Y2ggPSB0cnVlLCBvbkVycm9yLCBvblRyYW5zYWN0aW9ucywgcG9sbDogcG9sbF8sIHBvbGxpbmdJbnRlcnZhbCA9IGNsaWVudC5wb2xsaW5nSW50ZXJ2YWwgfSkgewogICAgY29uc3QgZW5hYmxlUG9sbGluZyA9IHR5cGVvZiBwb2xsXyAhPT0gInVuZGVmaW5lZCIgPyBwb2xsXyA6IGNsaWVudC50cmFuc3BvcnQudHlwZSAhPT0gIndlYlNvY2tldCI7CiAgICBjb25zdCBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucyA9ICgpID0+IHsKICAgICAgY29uc3Qgb2JzZXJ2ZXJJZCA9IHN0cmluZ2lmeShbCiAgICAgICAgIndhdGNoUGVuZGluZ1RyYW5zYWN0aW9ucyIsCiAgICAgICAgY2xpZW50LnVpZCwKICAgICAgICBiYXRjaCwKICAgICAgICBwb2xsaW5nSW50ZXJ2YWwKICAgICAgXSk7CiAgICAgIHJldHVybiBvYnNlcnZlKG9ic2VydmVySWQsIHsgb25UcmFuc2FjdGlvbnMsIG9uRXJyb3IgfSwgKGVtaXQpID0+IHsKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGNvbnN0IHVud2F0Y2ggPSBwb2xsKGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghZmlsdGVyKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZpbHRlciA9IGF3YWl0IGdldEFjdGlvbihjbGllbnQsIGNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciwgImNyZWF0ZVBlbmRpbmdUcmFuc2FjdGlvbkZpbHRlciIpKHt9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHVud2F0Y2goKTsKICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgaGFzaGVzID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0RmlsdGVyQ2hhbmdlcywgImdldEZpbHRlckNoYW5nZXMiKSh7IGZpbHRlciB9KTsKICAgICAgICAgICAgaWYgKGhhc2hlcy5sZW5ndGggPT09IDApCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoYmF0Y2gpCiAgICAgICAgICAgICAgZW1pdC5vblRyYW5zYWN0aW9ucyhoYXNoZXMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgZm9yIChjb25zdCBoYXNoMyBvZiBoYXNoZXMpCiAgICAgICAgICAgICAgICBlbWl0Lm9uVHJhbnNhY3Rpb25zKFtoYXNoM10pOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGVtaXQub25FcnJvcj8uKGVycik7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1pdE9uQmVnaW46IHRydWUsCiAgICAgICAgICBpbnRlcnZhbDogcG9sbGluZ0ludGVydmFsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGFzeW5jICgpID0+IHsKICAgICAgICAgIGlmIChmaWx0ZXIpCiAgICAgICAgICAgIGF3YWl0IGdldEFjdGlvbihjbGllbnQsIHVuaW5zdGFsbEZpbHRlciwgInVuaW5zdGFsbEZpbHRlciIpKHsgZmlsdGVyIH0pOwogICAgICAgICAgdW53YXRjaCgpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHN1YnNjcmliZVBlbmRpbmdUcmFuc2FjdGlvbnMgPSAoKSA9PiB7CiAgICAgIGxldCBhY3RpdmUgPSB0cnVlOwogICAgICBsZXQgdW5zdWJzY3JpYmUgPSAoKSA9PiBhY3RpdmUgPSBmYWxzZTsKICAgICAgKGFzeW5jICgpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgeyB1bnN1YnNjcmliZTogdW5zdWJzY3JpYmVfIH0gPSBhd2FpdCBjbGllbnQudHJhbnNwb3J0LnN1YnNjcmliZSh7CiAgICAgICAgICAgIHBhcmFtczogWyJuZXdQZW5kaW5nVHJhbnNhY3Rpb25zIl0sCiAgICAgICAgICAgIG9uRGF0YShkYXRhKSB7CiAgICAgICAgICAgICAgaWYgKCFhY3RpdmUpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYXRhLnJlc3VsdDsKICAgICAgICAgICAgICBvblRyYW5zYWN0aW9ucyhbdHJhbnNhY3Rpb25dKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIG9uRXJyb3I/LihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZV87CiAgICAgICAgICBpZiAoIWFjdGl2ZSkKICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIG9uRXJyb3I/LihlcnIpOwogICAgICAgIH0KICAgICAgfSkoKTsKICAgICAgcmV0dXJuICgpID0+IHVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIGVuYWJsZVBvbGxpbmcgPyBwb2xsUGVuZGluZ1RyYW5zYWN0aW9ucygpIDogc3Vic2NyaWJlUGVuZGluZ1RyYW5zYWN0aW9ucygpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3Npd2UvcGFyc2VTaXdlTWVzc2FnZS5qcwogIGZ1bmN0aW9uIHBhcnNlU2l3ZU1lc3NhZ2UobWVzc2FnZSkgewogICAgY29uc3QgeyBzY2hlbWUsIHN0YXRlbWVudCwgLi4ucHJlZml4IH0gPSBtZXNzYWdlLm1hdGNoKHByZWZpeFJlZ2V4KT8uZ3JvdXBzID8/IHt9OwogICAgY29uc3QgeyBjaGFpbklkLCBleHBpcmF0aW9uVGltZSwgaXNzdWVkQXQsIG5vdEJlZm9yZSwgcmVxdWVzdElkLCAuLi5zdWZmaXggfSA9IG1lc3NhZ2UubWF0Y2goc3VmZml4UmVnZXgpPy5ncm91cHMgPz8ge307CiAgICBjb25zdCByZXNvdXJjZXMgPSBtZXNzYWdlLnNwbGl0KCJSZXNvdXJjZXM6IilbMV0/LnNwbGl0KCJcbi0gIikuc2xpY2UoMSk7CiAgICByZXR1cm4gewogICAgICAuLi5wcmVmaXgsCiAgICAgIC4uLnN1ZmZpeCwKICAgICAgLi4uY2hhaW5JZCA/IHsgY2hhaW5JZDogTnVtYmVyKGNoYWluSWQpIH0gOiB7fSwKICAgICAgLi4uZXhwaXJhdGlvblRpbWUgPyB7IGV4cGlyYXRpb25UaW1lOiBuZXcgRGF0ZShleHBpcmF0aW9uVGltZSkgfSA6IHt9LAogICAgICAuLi5pc3N1ZWRBdCA/IHsgaXNzdWVkQXQ6IG5ldyBEYXRlKGlzc3VlZEF0KSB9IDoge30sCiAgICAgIC4uLm5vdEJlZm9yZSA/IHsgbm90QmVmb3JlOiBuZXcgRGF0ZShub3RCZWZvcmUpIH0gOiB7fSwKICAgICAgLi4ucmVxdWVzdElkID8geyByZXF1ZXN0SWQgfSA6IHt9LAogICAgICAuLi5yZXNvdXJjZXMgPyB7IHJlc291cmNlcyB9IDoge30sCiAgICAgIC4uLnNjaGVtZSA/IHsgc2NoZW1lIH0gOiB7fSwKICAgICAgLi4uc3RhdGVtZW50ID8geyBzdGF0ZW1lbnQgfSA6IHt9CiAgICB9OwogIH0KICB2YXIgcHJlZml4UmVnZXggPSAvXig/Oig/PHNjaGVtZT5bYS16QS1aXVthLXpBLVowLTkrLS5dKik6XC9cLyk/KD88ZG9tYWluPlthLXpBLVowLTkrLS5dKig/OjpbMC05XXsxLDV9KT8pICg/OndhbnRzIHlvdSB0byBzaWduIGluIHdpdGggeW91ciBFdGhlcmV1bSBhY2NvdW50OlxuKSg/PGFkZHJlc3M+MHhbYS1mQS1GMC05XXs0MH0pXG5cbig/Oig/PHN0YXRlbWVudD4uKilcblxuKT8vOwogIHZhciBzdWZmaXhSZWdleCA9IC8oPzpVUkk6ICg/PHVyaT4uKykpXG4oPzpWZXJzaW9uOiAoPzx2ZXJzaW9uPi4rKSlcbig/OkNoYWluIElEOiAoPzxjaGFpbklkPlxkKykpXG4oPzpOb25jZTogKD88bm9uY2U+W2EtekEtWjAtOV0rKSlcbig/Oklzc3VlZCBBdDogKD88aXNzdWVkQXQ+LispKSg/OlxuRXhwaXJhdGlvbiBUaW1lOiAoPzxleHBpcmF0aW9uVGltZT4uKykpPyg/OlxuTm90IEJlZm9yZTogKD88bm90QmVmb3JlPi4rKSk/KD86XG5SZXF1ZXN0IElEOiAoPzxyZXF1ZXN0SWQ+LispKT8vOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2l3ZS92YWxpZGF0ZVNpd2VNZXNzYWdlLmpzCiAgaW5pdF9pc0FkZHJlc3NFcXVhbCgpOwogIGZ1bmN0aW9uIHZhbGlkYXRlU2l3ZU1lc3NhZ2UocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhZGRyZXNzLCBkb21haW4sIG1lc3NhZ2UsIG5vbmNlLCBzY2hlbWUsIHRpbWUgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSB9ID0gcGFyYW1ldGVyczsKICAgIGlmIChkb21haW4gJiYgbWVzc2FnZS5kb21haW4gIT09IGRvbWFpbikKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG5vbmNlICYmIG1lc3NhZ2Uubm9uY2UgIT09IG5vbmNlKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBpZiAoc2NoZW1lICYmIG1lc3NhZ2Uuc2NoZW1lICE9PSBzY2hlbWUpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGlmIChtZXNzYWdlLmV4cGlyYXRpb25UaW1lICYmIHRpbWUgPj0gbWVzc2FnZS5leHBpcmF0aW9uVGltZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgaWYgKG1lc3NhZ2Uubm90QmVmb3JlICYmIHRpbWUgPCBtZXNzYWdlLm5vdEJlZm9yZSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgdHJ5IHsKICAgICAgaWYgKCFtZXNzYWdlLmFkZHJlc3MpCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYWRkcmVzcyAmJiAhaXNBZGRyZXNzRXF1YWwobWVzc2FnZS5hZGRyZXNzLCBhZGRyZXNzKSkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy9zaXdlL3ZlcmlmeVNpd2VNZXNzYWdlLmpzCiAgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5U2l3ZU1lc3NhZ2UoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFkZHJlc3MsIGRvbWFpbiwgbWVzc2FnZSwgbm9uY2UsIHNjaGVtZSwgc2lnbmF0dXJlLCB0aW1lID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksIC4uLmNhbGxSZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgcGFyc2VkID0gcGFyc2VTaXdlTWVzc2FnZShtZXNzYWdlKTsKICAgIGlmICghcGFyc2VkLmFkZHJlc3MpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZVNpd2VNZXNzYWdlKHsKICAgICAgYWRkcmVzcywKICAgICAgZG9tYWluLAogICAgICBtZXNzYWdlOiBwYXJzZWQsCiAgICAgIG5vbmNlLAogICAgICBzY2hlbWUsCiAgICAgIHRpbWUKICAgIH0pOwogICAgaWYgKCFpc1ZhbGlkKQogICAgICByZXR1cm4gZmFsc2U7CiAgICBjb25zdCBoYXNoMyA9IGhhc2hNZXNzYWdlKG1lc3NhZ2UpOwogICAgcmV0dXJuIHZlcmlmeUhhc2gyKGNsaWVudCwgewogICAgICBhZGRyZXNzOiBwYXJzZWQuYWRkcmVzcywKICAgICAgaGFzaDogaGFzaDMsCiAgICAgIHNpZ25hdHVyZSwKICAgICAgLi4uY2FsbFJlcXVlc3QKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvZGVjb3JhdG9ycy9wdWJsaWMuanMKICBmdW5jdGlvbiBwdWJsaWNBY3Rpb25zKGNsaWVudCkgewogICAgcmV0dXJuIHsKICAgICAgY2FsbDogKGFyZ3MpID0+IGNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlQmxvY2tGaWx0ZXI6ICgpID0+IGNyZWF0ZUJsb2NrRmlsdGVyKGNsaWVudCksCiAgICAgIGNyZWF0ZUNvbnRyYWN0RXZlbnRGaWx0ZXI6IChhcmdzKSA9PiBjcmVhdGVDb250cmFjdEV2ZW50RmlsdGVyKGNsaWVudCwgYXJncyksCiAgICAgIGNyZWF0ZUV2ZW50RmlsdGVyOiAoYXJncykgPT4gY3JlYXRlRXZlbnRGaWx0ZXIoY2xpZW50LCBhcmdzKSwKICAgICAgY3JlYXRlUGVuZGluZ1RyYW5zYWN0aW9uRmlsdGVyOiAoKSA9PiBjcmVhdGVQZW5kaW5nVHJhbnNhY3Rpb25GaWx0ZXIoY2xpZW50KSwKICAgICAgZXN0aW1hdGVDb250cmFjdEdhczogKGFyZ3MpID0+IGVzdGltYXRlQ29udHJhY3RHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUdhcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCYWxhbmNlOiAoYXJncykgPT4gZ2V0QmFsYW5jZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9iQmFzZUZlZTogKCkgPT4gZ2V0QmxvYkJhc2VGZWUoY2xpZW50KSwKICAgICAgZ2V0QmxvY2s6IChhcmdzKSA9PiBnZXRCbG9jayhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCbG9ja051bWJlcjogKGFyZ3MpID0+IGdldEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudDogKGFyZ3MpID0+IGdldEJsb2NrVHJhbnNhY3Rpb25Db3VudChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRCeXRlY29kZTogKGFyZ3MpID0+IGdldENvZGUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0Q2hhaW5JZDogKCkgPT4gZ2V0Q2hhaW5JZChjbGllbnQpLAogICAgICBnZXRDb2RlOiAoYXJncykgPT4gZ2V0Q29kZShjbGllbnQsIGFyZ3MpLAogICAgICBnZXRDb250cmFjdEV2ZW50czogKGFyZ3MpID0+IGdldENvbnRyYWN0RXZlbnRzKGNsaWVudCwgYXJncyksCiAgICAgIGdldEVpcDcxMkRvbWFpbjogKGFyZ3MpID0+IGdldEVpcDcxMkRvbWFpbihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBZGRyZXNzOiAoYXJncykgPT4gZ2V0RW5zQWRkcmVzcyhjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNBdmF0YXI6IChhcmdzKSA9PiBnZXRFbnNBdmF0YXIoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zTmFtZTogKGFyZ3MpID0+IGdldEVuc05hbWUoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RW5zUmVzb2x2ZXI6IChhcmdzKSA9PiBnZXRFbnNSZXNvbHZlcihjbGllbnQsIGFyZ3MpLAogICAgICBnZXRFbnNUZXh0OiAoYXJncykgPT4gZ2V0RW5zVGV4dChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRGZWVIaXN0b3J5OiAoYXJncykgPT4gZ2V0RmVlSGlzdG9yeShjbGllbnQsIGFyZ3MpLAogICAgICBlc3RpbWF0ZUZlZXNQZXJHYXM6IChhcmdzKSA9PiBlc3RpbWF0ZUZlZXNQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyQ2hhbmdlczogKGFyZ3MpID0+IGdldEZpbHRlckNoYW5nZXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0RmlsdGVyTG9nczogKGFyZ3MpID0+IGdldEZpbHRlckxvZ3MoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0R2FzUHJpY2U6ICgpID0+IGdldEdhc1ByaWNlKGNsaWVudCksCiAgICAgIGdldExvZ3M6IChhcmdzKSA9PiBnZXRMb2dzKGNsaWVudCwgYXJncyksCiAgICAgIGdldFByb29mOiAoYXJncykgPT4gZ2V0UHJvb2YoY2xpZW50LCBhcmdzKSwKICAgICAgZXN0aW1hdGVNYXhQcmlvcml0eUZlZVBlckdhczogKGFyZ3MpID0+IGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXMoY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0U3RvcmFnZUF0OiAoYXJncykgPT4gZ2V0U3RvcmFnZUF0KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zOiAoYXJncykgPT4gZ2V0VHJhbnNhY3Rpb25Db25maXJtYXRpb25zKGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uQ291bnQ6IChhcmdzKSA9PiBnZXRUcmFuc2FjdGlvbkNvdW50KGNsaWVudCwgYXJncyksCiAgICAgIGdldFRyYW5zYWN0aW9uUmVjZWlwdDogKGFyZ3MpID0+IGdldFRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICBtdWx0aWNhbGw6IChhcmdzKSA9PiBtdWx0aWNhbGwoY2xpZW50LCBhcmdzKSwKICAgICAgcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdDogKGFyZ3MpID0+IHByZXBhcmVUcmFuc2FjdGlvblJlcXVlc3QoY2xpZW50LCBhcmdzKSwKICAgICAgcmVhZENvbnRyYWN0OiAoYXJncykgPT4gcmVhZENvbnRyYWN0KGNsaWVudCwgYXJncyksCiAgICAgIHNlbmRSYXdUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRSYXdUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICBzaW11bGF0ZUNvbnRyYWN0OiAoYXJncykgPT4gc2ltdWxhdGVDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlNZXNzYWdlOiAoYXJncykgPT4gdmVyaWZ5TWVzc2FnZTIoY2xpZW50LCBhcmdzKSwKICAgICAgdmVyaWZ5U2l3ZU1lc3NhZ2U6IChhcmdzKSA9PiB2ZXJpZnlTaXdlTWVzc2FnZShjbGllbnQsIGFyZ3MpLAogICAgICB2ZXJpZnlUeXBlZERhdGE6IChhcmdzKSA9PiB2ZXJpZnlUeXBlZERhdGEyKGNsaWVudCwgYXJncyksCiAgICAgIHVuaW5zdGFsbEZpbHRlcjogKGFyZ3MpID0+IHVuaW5zdGFsbEZpbHRlcihjbGllbnQsIGFyZ3MpLAogICAgICB3YWl0Rm9yVHJhbnNhY3Rpb25SZWNlaXB0OiAoYXJncykgPT4gd2FpdEZvclRyYW5zYWN0aW9uUmVjZWlwdChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEJsb2NrczogKGFyZ3MpID0+IHdhdGNoQmxvY2tzKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQmxvY2tOdW1iZXI6IChhcmdzKSA9PiB3YXRjaEJsb2NrTnVtYmVyKGNsaWVudCwgYXJncyksCiAgICAgIHdhdGNoQ29udHJhY3RFdmVudDogKGFyZ3MpID0+IHdhdGNoQ29udHJhY3RFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaEV2ZW50OiAoYXJncykgPT4gd2F0Y2hFdmVudChjbGllbnQsIGFyZ3MpLAogICAgICB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnM6IChhcmdzKSA9PiB3YXRjaFBlbmRpbmdUcmFuc2FjdGlvbnMoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVB1YmxpY0NsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVB1YmxpY0NsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJwdWJsaWMiLCBuYW1lID0gIlB1YmxpYyBDbGllbnQiIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2xpZW50ID0gY3JlYXRlQ2xpZW50KHsKICAgICAgLi4ucGFyYW1ldGVycywKICAgICAga2V5LAogICAgICBuYW1lLAogICAgICB0eXBlOiAicHVibGljQ2xpZW50IgogICAgfSk7CiAgICByZXR1cm4gY2xpZW50LmV4dGVuZChwdWJsaWNBY3Rpb25zKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvZHJvcFRyYW5zYWN0aW9uLmpzCiAgYXN5bmMgZnVuY3Rpb24gZHJvcFRyYW5zYWN0aW9uKGNsaWVudCwgeyBoYXNoOiBoYXNoMyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2Ryb3BUcmFuc2FjdGlvbmAsCiAgICAgIHBhcmFtczogW2hhc2gzXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2R1bXBTdGF0ZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGR1bXBTdGF0ZShjbGllbnQpIHsKICAgIHJldHVybiBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2R1bXBTdGF0ZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRBdXRvbWluZS5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldEF1dG9taW5lKGNsaWVudCkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXRoX21pbmluZyIKICAgICAgfSk7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9nZXRBdXRvbWluZWAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9nZXRUeHBvb2xDb250ZW50LmpzCiAgYXN5bmMgZnVuY3Rpb24gZ2V0VHhwb29sQ29udGVudChjbGllbnQpIHsKICAgIHJldHVybiBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9jb250ZW50IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2dldFR4cG9vbFN0YXR1cy5qcwogIGluaXRfZnJvbUhleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGdldFR4cG9vbFN0YXR1cyhjbGllbnQpIHsKICAgIGNvbnN0IHsgcGVuZGluZywgcXVldWVkIH0gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogInR4cG9vbF9zdGF0dXMiCiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIHBlbmRpbmc6IGhleFRvTnVtYmVyKHBlbmRpbmcpLAogICAgICBxdWV1ZWQ6IGhleFRvTnVtYmVyKHF1ZXVlZCkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L2ltcGVyc29uYXRlQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIGltcGVyc29uYXRlQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X2ltcGVyc29uYXRlQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5jcmVhc2VUaW1lLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIGluY3JlYXNlVGltZShjbGllbnQsIHsgc2Vjb25kcyB9KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1faW5jcmVhc2VUaW1lIiwKICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoc2Vjb25kcyldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvaW5zcGVjdFR4cG9vbC5qcwogIGFzeW5jIGZ1bmN0aW9uIGluc3BlY3RUeHBvb2woY2xpZW50KSB7CiAgICByZXR1cm4gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ0eHBvb2xfaW5zcGVjdCIKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9sb2FkU3RhdGUuanMKICBhc3luYyBmdW5jdGlvbiBsb2FkU3RhdGUoY2xpZW50LCB7IHN0YXRlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbG9hZFN0YXRlYCwKICAgICAgcGFyYW1zOiBbc3RhdGVdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3QvbWluZS5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBtaW5lKGNsaWVudCwgeyBibG9ja3MsIGludGVydmFsIH0pIHsKICAgIGlmIChjbGllbnQubW9kZSA9PT0gImdhbmFjaGUiKQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAiZXZtX21pbmUiLAogICAgICAgIHBhcmFtczogW3sgYmxvY2tzOiBudW1iZXJUb0hleChibG9ja3MpIH1dCiAgICAgIH0pOwogICAgZWxzZQogICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fbWluZWAsCiAgICAgICAgcGFyYW1zOiBbbnVtYmVyVG9IZXgoYmxvY2tzKSwgbnVtYmVyVG9IZXgoaW50ZXJ2YWwgfHwgMCldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZW1vdmVCbG9ja1RpbWVzdGFtcEludGVydmFsLmpzCiAgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9yZXNldC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlc2V0KGNsaWVudCwgeyBibG9ja051bWJlciwganNvblJwY1VybCB9ID0ge30pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fcmVzZXRgLAogICAgICBwYXJhbXM6IFt7IGZvcmtpbmc6IHsgYmxvY2tOdW1iZXI6IE51bWJlcihibG9ja051bWJlciksIGpzb25ScGNVcmwgfSB9XQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3JldmVydC5qcwogIGFzeW5jIGZ1bmN0aW9uIHJldmVydChjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldm1fcmV2ZXJ0IiwKICAgICAgcGFyYW1zOiBbaWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24uanMKICBpbml0X2V4dHJhY3QoKTsKICBpbml0X3RyYW5zYWN0aW9uUmVxdWVzdCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncykgewogICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBkYXRhLCBmcm9tLCBnYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBub25jZSwgdG8sIHZhbHVlLCAuLi5yZXN0IH0gPSBhcmdzOwogICAgY29uc3QgY2hhaW5Gb3JtYXQgPSBjbGllbnQuY2hhaW4/LmZvcm1hdHRlcnM/LnRyYW5zYWN0aW9uUmVxdWVzdD8uZm9ybWF0OwogICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgY29uc3QgcmVxdWVzdCA9IGZvcm1hdCh7CiAgICAgIC8vIFBpY2sgb3V0IGV4dHJhIGRhdGEgdGhhdCBtaWdodCBleGlzdCBvbiB0aGUgY2hhaW4ncyB0cmFuc2FjdGlvbiByZXF1ZXN0IHR5cGUuCiAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICBhY2Nlc3NMaXN0LAogICAgICBkYXRhLAogICAgICBmcm9tLAogICAgICBnYXMsCiAgICAgIGdhc1ByaWNlLAogICAgICBtYXhGZWVQZXJHYXMsCiAgICAgIG1heFByaW9yaXR5RmVlUGVyR2FzLAogICAgICBub25jZSwKICAgICAgdG8sCiAgICAgIHZhbHVlCiAgICB9KTsKICAgIGNvbnN0IGhhc2gzID0gYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJldGhfc2VuZFVuc2lnbmVkVHJhbnNhY3Rpb24iLAogICAgICBwYXJhbXM6IFtyZXF1ZXN0XQogICAgfSk7CiAgICByZXR1cm4gaGFzaDM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEF1dG9taW5lLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0QXV0b21pbmUoY2xpZW50LCBlbmFibGVkKSB7CiAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJnYW5hY2hlIikgewogICAgICBpZiAoZW5hYmxlZCkKICAgICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIm1pbmVyX3N0YXJ0IiB9KTsKICAgICAgZWxzZQogICAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsgbWV0aG9kOiAibWluZXJfc3RvcCIgfSk7CiAgICB9IGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogImV2bV9zZXRBdXRvbWluZSIsCiAgICAgICAgcGFyYW1zOiBbZW5hYmxlZF0KICAgICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldEJhbGFuY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0QmFsYW5jZShjbGllbnQsIHsgYWRkcmVzcywgdmFsdWUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudEJhbGFuY2UiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIG51bWJlclRvSGV4KHZhbHVlKV0KICAgICAgfSk7CiAgICBlbHNlCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRCYWxhbmNlYCwKICAgICAgICBwYXJhbXM6IFthZGRyZXNzLCBudW1iZXJUb0hleCh2YWx1ZSldCiAgICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRCbG9ja0dhc0xpbWl0LmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCB7IGdhc0xpbWl0IH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NldEJsb2NrR2FzTGltaXQiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNMaW1pdCldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEJsb2NrVGltZXN0YW1wSW50ZXJ2YWwoY2xpZW50LCB7IGludGVydmFsIH0pIHsKICAgIGNvbnN0IGludGVydmFsXyA9ICgoKSA9PiB7CiAgICAgIGlmIChjbGllbnQubW9kZSA9PT0gImhhcmRoYXQiKQogICAgICAgIHJldHVybiBpbnRlcnZhbCAqIDFlMzsKICAgICAgcmV0dXJuIGludGVydmFsOwogICAgfSkoKTsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbGAsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRDb2RlLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2V0Q29kZShjbGllbnQsIHsgYWRkcmVzcywgYnl0ZWNvZGUgfSkgewogICAgaWYgKGNsaWVudC5tb2RlID09PSAiZ2FuYWNoZSIpCiAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgICBtZXRob2Q6ICJldm1fc2V0QWNjb3VudENvZGUiLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICAgIGVsc2UKICAgICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvZGVgLAogICAgICAgIHBhcmFtczogW2FkZHJlc3MsIGJ5dGVjb2RlXQogICAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0Q29pbmJhc2UuanMKICBhc3luYyBmdW5jdGlvbiBzZXRDb2luYmFzZShjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldENvaW5iYXNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzc10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRJbnRlcnZhbE1pbmluZy5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldEludGVydmFsTWluaW5nKGNsaWVudCwgeyBpbnRlcnZhbCB9KSB7CiAgICBjb25zdCBpbnRlcnZhbF8gPSAoKCkgPT4gewogICAgICBpZiAoY2xpZW50Lm1vZGUgPT09ICJoYXJkaGF0IikKICAgICAgICByZXR1cm4gaW50ZXJ2YWwgKiAxZTM7CiAgICAgIHJldHVybiBpbnRlcnZhbDsKICAgIH0pKCk7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXRJbnRlcnZhbE1pbmluZyIsCiAgICAgIHBhcmFtczogW2ludGVydmFsX10KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRMb2dnaW5nRW5hYmxlZC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgZW5hYmxlZCkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6IGAke2NsaWVudC5tb2RlfV9zZXRMb2dnaW5nRW5hYmxlZGAsCiAgICAgIHBhcmFtczogW2VuYWJsZWRdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TWluR2FzUHJpY2UuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0TWluR2FzUHJpY2UoY2xpZW50LCB7IGdhc1ByaWNlIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TWluR2FzUHJpY2VgLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleChnYXNQcmljZSldCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3Rlc3Qvc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhcy5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgeyBiYXNlRmVlUGVyR2FzIH0pIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0TmV4dEJsb2NrQmFzZUZlZVBlckdhc2AsCiAgICAgIHBhcmFtczogW251bWJlclRvSGV4KGJhc2VGZWVQZXJHYXMpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5leHRCbG9ja1RpbWVzdGFtcC5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzZXROZXh0QmxvY2tUaW1lc3RhbXAoY2xpZW50LCB7IHRpbWVzdGFtcCB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV2bV9zZXROZXh0QmxvY2tUaW1lc3RhbXAiLAogICAgICBwYXJhbXM6IFtudW1iZXJUb0hleCh0aW1lc3RhbXApXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldE5vbmNlLmpzCiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNldE5vbmNlKGNsaWVudCwgeyBhZGRyZXNzLCBub25jZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldE5vbmNlYCwKICAgICAgcGFyYW1zOiBbYWRkcmVzcywgbnVtYmVyVG9IZXgobm9uY2UpXQogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3NldFJwY1VybC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNldFJwY1VybChjbGllbnQsIGpzb25ScGNVcmwpIHsKICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiBgJHtjbGllbnQubW9kZX1fc2V0UnBjVXJsYCwKICAgICAgcGFyYW1zOiBbanNvblJwY1VybF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zZXRTdG9yYWdlQXQuanMKICBpbml0X3RvSGV4KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2V0U3RvcmFnZUF0KGNsaWVudCwgeyBhZGRyZXNzLCBpbmRleDogaW5kZXgyLCB2YWx1ZSB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3NldFN0b3JhZ2VBdGAsCiAgICAgIHBhcmFtczogWwogICAgICAgIGFkZHJlc3MsCiAgICAgICAgdHlwZW9mIGluZGV4MiA9PT0gIm51bWJlciIgPyBudW1iZXJUb0hleChpbmRleDIpIDogaW5kZXgyLAogICAgICAgIHZhbHVlCiAgICAgIF0KICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvdGVzdC9zbmFwc2hvdC5qcwogIGFzeW5jIGZ1bmN0aW9uIHNuYXBzaG90KGNsaWVudCkgewogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXZtX3NuYXBzaG90IgogICAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy90ZXN0L3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudC5qcwogIGFzeW5jIGZ1bmN0aW9uIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIHsgYWRkcmVzcyB9KSB7CiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogYCR7Y2xpZW50Lm1vZGV9X3N0b3BJbXBlcnNvbmF0aW5nQWNjb3VudGAsCiAgICAgIHBhcmFtczogW2FkZHJlc3NdCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvdGVzdC5qcwogIGZ1bmN0aW9uIHRlc3RBY3Rpb25zKHsgbW9kZTogbW9kZTIgfSkgewogICAgcmV0dXJuIChjbGllbnRfKSA9PiB7CiAgICAgIGNvbnN0IGNsaWVudCA9IGNsaWVudF8uZXh0ZW5kKCgpID0+ICh7CiAgICAgICAgbW9kZTogbW9kZTIKICAgICAgfSkpOwogICAgICByZXR1cm4gewogICAgICAgIGRyb3BUcmFuc2FjdGlvbjogKGFyZ3MpID0+IGRyb3BUcmFuc2FjdGlvbihjbGllbnQsIGFyZ3MpLAogICAgICAgIGR1bXBTdGF0ZTogKCkgPT4gZHVtcFN0YXRlKGNsaWVudCksCiAgICAgICAgZ2V0QXV0b21pbmU6ICgpID0+IGdldEF1dG9taW5lKGNsaWVudCksCiAgICAgICAgZ2V0VHhwb29sQ29udGVudDogKCkgPT4gZ2V0VHhwb29sQ29udGVudChjbGllbnQpLAogICAgICAgIGdldFR4cG9vbFN0YXR1czogKCkgPT4gZ2V0VHhwb29sU3RhdHVzKGNsaWVudCksCiAgICAgICAgaW1wZXJzb25hdGVBY2NvdW50OiAoYXJncykgPT4gaW1wZXJzb25hdGVBY2NvdW50KGNsaWVudCwgYXJncyksCiAgICAgICAgaW5jcmVhc2VUaW1lOiAoYXJncykgPT4gaW5jcmVhc2VUaW1lKGNsaWVudCwgYXJncyksCiAgICAgICAgaW5zcGVjdFR4cG9vbDogKCkgPT4gaW5zcGVjdFR4cG9vbChjbGllbnQpLAogICAgICAgIGxvYWRTdGF0ZTogKGFyZ3MpID0+IGxvYWRTdGF0ZShjbGllbnQsIGFyZ3MpLAogICAgICAgIG1pbmU6IChhcmdzKSA9PiBtaW5lKGNsaWVudCwgYXJncyksCiAgICAgICAgcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbDogKCkgPT4gcmVtb3ZlQmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQpLAogICAgICAgIHJlc2V0OiAoYXJncykgPT4gcmVzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgICByZXZlcnQ6IChhcmdzKSA9PiByZXZlcnQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZW5kVW5zaWduZWRUcmFuc2FjdGlvbjogKGFyZ3MpID0+IHNlbmRVbnNpZ25lZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QXV0b21pbmU6IChhcmdzKSA9PiBzZXRBdXRvbWluZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEJhbGFuY2U6IChhcmdzKSA9PiBzZXRCYWxhbmNlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0QmxvY2tHYXNMaW1pdDogKGFyZ3MpID0+IHNldEJsb2NrR2FzTGltaXQoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRCbG9ja1RpbWVzdGFtcEludGVydmFsOiAoYXJncykgPT4gc2V0QmxvY2tUaW1lc3RhbXBJbnRlcnZhbChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldENvZGU6IChhcmdzKSA9PiBzZXRDb2RlKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Q29pbmJhc2U6IChhcmdzKSA9PiBzZXRDb2luYmFzZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldEludGVydmFsTWluaW5nOiAoYXJncykgPT4gc2V0SW50ZXJ2YWxNaW5pbmcoY2xpZW50LCBhcmdzKSwKICAgICAgICBzZXRMb2dnaW5nRW5hYmxlZDogKGFyZ3MpID0+IHNldExvZ2dpbmdFbmFibGVkKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TWluR2FzUHJpY2U6IChhcmdzKSA9PiBzZXRNaW5HYXNQcmljZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldE5leHRCbG9ja0Jhc2VGZWVQZXJHYXM6IChhcmdzKSA9PiBzZXROZXh0QmxvY2tCYXNlRmVlUGVyR2FzKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0TmV4dEJsb2NrVGltZXN0YW1wOiAoYXJncykgPT4gc2V0TmV4dEJsb2NrVGltZXN0YW1wKGNsaWVudCwgYXJncyksCiAgICAgICAgc2V0Tm9uY2U6IChhcmdzKSA9PiBzZXROb25jZShjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFJwY1VybDogKGFyZ3MpID0+IHNldFJwY1VybChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNldFN0b3JhZ2VBdDogKGFyZ3MpID0+IHNldFN0b3JhZ2VBdChjbGllbnQsIGFyZ3MpLAogICAgICAgIHNuYXBzaG90OiAoKSA9PiBzbmFwc2hvdChjbGllbnQpLAogICAgICAgIHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudDogKGFyZ3MpID0+IHN0b3BJbXBlcnNvbmF0aW5nQWNjb3VudChjbGllbnQsIGFyZ3MpCiAgICAgIH07CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NsaWVudHMvY3JlYXRlVGVzdENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVRlc3RDbGllbnQocGFyYW1ldGVycykgewogICAgY29uc3QgeyBrZXkgPSAidGVzdCIsIG5hbWUgPSAiVGVzdCBDbGllbnQiLCBtb2RlOiBtb2RlMiB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IGNsaWVudCA9IGNyZWF0ZUNsaWVudCh7CiAgICAgIC4uLnBhcmFtZXRlcnMsCiAgICAgIGtleSwKICAgICAgbmFtZSwKICAgICAgdHlwZTogInRlc3RDbGllbnQiCiAgICB9KTsKICAgIHJldHVybiBjbGllbnQuZXh0ZW5kKChjb25maWcpID0+ICh7CiAgICAgIG1vZGU6IG1vZGUyLAogICAgICAuLi50ZXN0QWN0aW9ucyh7IG1vZGU6IG1vZGUyIH0pKGNvbmZpZykKICAgIH0pKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9kZXBsb3lDb250cmFjdC5qcwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGZ1bmN0aW9uIGRlcGxveUNvbnRyYWN0KHdhbGxldENsaWVudCwgcGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGFyZ3MsIGJ5dGVjb2RlLCAuLi5yZXF1ZXN0IH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgY2FsbGRhdGEgPSBlbmNvZGVEZXBsb3lEYXRhKHsgYWJpOiBhYmkyLCBhcmdzLCBieXRlY29kZSB9KTsKICAgIHJldHVybiBzZW5kVHJhbnNhY3Rpb24od2FsbGV0Q2xpZW50LCB7CiAgICAgIC4uLnJlcXVlc3QsCiAgICAgIGRhdGE6IGNhbGxkYXRhCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRBZGRyZXNzZXMuanMKICBpbml0X2dldEFkZHJlc3MoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBpZiAoY2xpZW50LmFjY291bnQ/LnR5cGUgPT09ICJsb2NhbCIpCiAgICAgIHJldHVybiBbY2xpZW50LmFjY291bnQuYWRkcmVzc107CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9hY2NvdW50cyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gYWRkcmVzc2VzLm1hcCgoYWRkcmVzcykgPT4gY2hlY2tzdW1BZGRyZXNzKGFkZHJlc3MpKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9nZXRQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIGdldFBlcm1pc3Npb25zKGNsaWVudCkgewogICAgY29uc3QgcGVybWlzc2lvbnMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogIndhbGxldF9nZXRQZXJtaXNzaW9ucyIgfSwgeyBkZWR1cGU6IHRydWUgfSk7CiAgICByZXR1cm4gcGVybWlzc2lvbnM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvcmVxdWVzdEFkZHJlc3Nlcy5qcwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RBZGRyZXNzZXMoY2xpZW50KSB7CiAgICBjb25zdCBhZGRyZXNzZXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7IG1ldGhvZDogImV0aF9yZXF1ZXN0QWNjb3VudHMiIH0sIHsgZGVkdXBlOiB0cnVlLCByZXRyeUNvdW50OiAwIH0pOwogICAgcmV0dXJuIGFkZHJlc3Nlcy5tYXAoKGFkZHJlc3MpID0+IGdldEFkZHJlc3MoYWRkcmVzcykpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3JlcXVlc3RQZXJtaXNzaW9ucy5qcwogIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIHBlcm1pc3Npb25zKSB7CiAgICByZXR1cm4gY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfcmVxdWVzdFBlcm1pc3Npb25zIiwKICAgICAgcGFyYW1zOiBbcGVybWlzc2lvbnNdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduTWVzc2FnZShjbGllbnQsIHsgYWNjb3VudDogYWNjb3VudF8gPSBjbGllbnQuYWNjb3VudCwgbWVzc2FnZSB9KSB7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnbk1lc3NhZ2UiCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBpZiAoYWNjb3VudC5zaWduTWVzc2FnZSkKICAgICAgcmV0dXJuIGFjY291bnQuc2lnbk1lc3NhZ2UoeyBtZXNzYWdlIH0pOwogICAgY29uc3QgbWVzc2FnZV8gPSAoKCkgPT4gewogICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICJzdHJpbmciKQogICAgICAgIHJldHVybiBzdHJpbmdUb0hleChtZXNzYWdlKTsKICAgICAgaWYgKG1lc3NhZ2UucmF3IGluc3RhbmNlb2YgVWludDhBcnJheSkKICAgICAgICByZXR1cm4gdG9IZXgobWVzc2FnZS5yYXcpOwogICAgICByZXR1cm4gbWVzc2FnZS5yYXc7CiAgICB9KSgpOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAicGVyc29uYWxfc2lnbiIsCiAgICAgIHBhcmFtczogW21lc3NhZ2VfLCBhY2NvdW50LmFkZHJlc3NdCiAgICB9LCB7IHJldHJ5Q291bnQ6IDAgfSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWN0aW9ucy93YWxsZXQvc2lnblRyYW5zYWN0aW9uLmpzCiAgaW5pdF9wYXJzZUFjY291bnQoKTsKICBpbml0X3RvSGV4KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICBhc3luYyBmdW5jdGlvbiBzaWduVHJhbnNhY3Rpb24oY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGNoYWluID0gY2xpZW50LmNoYWluLCAuLi50cmFuc2FjdGlvbiB9ID0gcGFyYW1ldGVyczsKICAgIGlmICghYWNjb3VudF8pCiAgICAgIHRocm93IG5ldyBBY2NvdW50Tm90Rm91bmRFcnJvcih7CiAgICAgICAgZG9jc1BhdGg6ICIvZG9jcy9hY3Rpb25zL3dhbGxldC9zaWduVHJhbnNhY3Rpb24iCiAgICAgIH0pOwogICAgY29uc3QgYWNjb3VudCA9IHBhcnNlQWNjb3VudChhY2NvdW50Xyk7CiAgICBhc3NlcnRSZXF1ZXN0KHsKICAgICAgYWNjb3VudCwKICAgICAgLi4ucGFyYW1ldGVycwogICAgfSk7CiAgICBjb25zdCBjaGFpbklkID0gYXdhaXQgZ2V0QWN0aW9uKGNsaWVudCwgZ2V0Q2hhaW5JZCwgImdldENoYWluSWQiKSh7fSk7CiAgICBpZiAoY2hhaW4gIT09IG51bGwpCiAgICAgIGFzc2VydEN1cnJlbnRDaGFpbih7CiAgICAgICAgY3VycmVudENoYWluSWQ6IGNoYWluSWQsCiAgICAgICAgY2hhaW4KICAgICAgfSk7CiAgICBjb25zdCBmb3JtYXR0ZXJzNCA9IGNoYWluPy5mb3JtYXR0ZXJzIHx8IGNsaWVudC5jaGFpbj8uZm9ybWF0dGVyczsKICAgIGNvbnN0IGZvcm1hdCA9IGZvcm1hdHRlcnM0Py50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdCB8fCBmb3JtYXRUcmFuc2FjdGlvblJlcXVlc3Q7CiAgICBpZiAoYWNjb3VudC5zaWduVHJhbnNhY3Rpb24pCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UcmFuc2FjdGlvbih7CiAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgY2hhaW5JZAogICAgICB9LCB7IHNlcmlhbGl6ZXI6IGNsaWVudC5jaGFpbj8uc2VyaWFsaXplcnM/LnRyYW5zYWN0aW9uIH0pOwogICAgcmV0dXJuIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UcmFuc2FjdGlvbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIC4uLmZvcm1hdCh0cmFuc2FjdGlvbiksCiAgICAgICAgICBjaGFpbklkOiBudW1iZXJUb0hleChjaGFpbklkKSwKICAgICAgICAgIGZyb206IGFjY291bnQuYWRkcmVzcwogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3NpZ25UeXBlZERhdGEuanMKICBpbml0X3BhcnNlQWNjb3VudCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNpZ25UeXBlZERhdGEoY2xpZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQsIGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUgfSA9IHBhcmFtZXRlcnM7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoewogICAgICAgIGRvY3NQYXRoOiAiL2RvY3MvYWN0aW9ucy93YWxsZXQvc2lnblR5cGVkRGF0YSIKICAgICAgfSk7CiAgICBjb25zdCBhY2NvdW50ID0gcGFyc2VBY2NvdW50KGFjY291bnRfKTsKICAgIGNvbnN0IHR5cGVzID0gewogICAgICBFSVA3MTJEb21haW46IGdldFR5cGVzRm9yRUlQNzEyRG9tYWluKHsgZG9tYWluIH0pLAogICAgICAuLi5wYXJhbWV0ZXJzLnR5cGVzCiAgICB9OwogICAgdmFsaWRhdGVUeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGlmIChhY2NvdW50LnNpZ25UeXBlZERhdGEpCiAgICAgIHJldHVybiBhY2NvdW50LnNpZ25UeXBlZERhdGEoeyBkb21haW4sIG1lc3NhZ2UsIHByaW1hcnlUeXBlLCB0eXBlcyB9KTsKICAgIGNvbnN0IHR5cGVkRGF0YSA9IHNlcmlhbGl6ZVR5cGVkRGF0YSh7IGRvbWFpbiwgbWVzc2FnZSwgcHJpbWFyeVR5cGUsIHR5cGVzIH0pOwogICAgcmV0dXJuIGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAiZXRoX3NpZ25UeXBlZERhdGFfdjQiLAogICAgICBwYXJhbXM6IFthY2NvdW50LmFkZHJlc3MsIHR5cGVkRGF0YV0KICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY3Rpb25zL3dhbGxldC9zd2l0Y2hDaGFpbi5qcwogIGluaXRfdG9IZXgoKTsKICBhc3luYyBmdW5jdGlvbiBzd2l0Y2hDaGFpbihjbGllbnQsIHsgaWQgfSkgewogICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoewogICAgICBtZXRob2Q6ICJ3YWxsZXRfc3dpdGNoRXRoZXJldW1DaGFpbiIsCiAgICAgIHBhcmFtczogWwogICAgICAgIHsKICAgICAgICAgIGNoYWluSWQ6IG51bWJlclRvSGV4KGlkKQogICAgICAgIH0KICAgICAgXQogICAgfSwgeyByZXRyeUNvdW50OiAwIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjdGlvbnMvd2FsbGV0L3dhdGNoQXNzZXQuanMKICBhc3luYyBmdW5jdGlvbiB3YXRjaEFzc2V0KGNsaWVudCwgcGFyYW1zKSB7CiAgICBjb25zdCBhZGRlZCA9IGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsKICAgICAgbWV0aG9kOiAid2FsbGV0X3dhdGNoQXNzZXQiLAogICAgICBwYXJhbXMKICAgIH0sIHsgcmV0cnlDb3VudDogMCB9KTsKICAgIHJldHVybiBhZGRlZDsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2RlY29yYXRvcnMvd2FsbGV0LmpzCiAgZnVuY3Rpb24gd2FsbGV0QWN0aW9ucyhjbGllbnQpIHsKICAgIHJldHVybiB7CiAgICAgIGFkZENoYWluOiAoYXJncykgPT4gYWRkQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgZGVwbG95Q29udHJhY3Q6IChhcmdzKSA9PiBkZXBsb3lDb250cmFjdChjbGllbnQsIGFyZ3MpLAogICAgICBnZXRBZGRyZXNzZXM6ICgpID0+IGdldEFkZHJlc3NlcyhjbGllbnQpLAogICAgICBnZXRDaGFpbklkOiAoKSA9PiBnZXRDaGFpbklkKGNsaWVudCksCiAgICAgIGdldFBlcm1pc3Npb25zOiAoKSA9PiBnZXRQZXJtaXNzaW9ucyhjbGllbnQpLAogICAgICBwcmVwYXJlVHJhbnNhY3Rpb25SZXF1ZXN0OiAoYXJncykgPT4gcHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdChjbGllbnQsIGFyZ3MpLAogICAgICByZXF1ZXN0QWRkcmVzc2VzOiAoKSA9PiByZXF1ZXN0QWRkcmVzc2VzKGNsaWVudCksCiAgICAgIHJlcXVlc3RQZXJtaXNzaW9uczogKGFyZ3MpID0+IHJlcXVlc3RQZXJtaXNzaW9ucyhjbGllbnQsIGFyZ3MpLAogICAgICBzZW5kUmF3VHJhbnNhY3Rpb246IChhcmdzKSA9PiBzZW5kUmF3VHJhbnNhY3Rpb24oY2xpZW50LCBhcmdzKSwKICAgICAgc2VuZFRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2VuZFRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25NZXNzYWdlOiAoYXJncykgPT4gc2lnbk1lc3NhZ2UoY2xpZW50LCBhcmdzKSwKICAgICAgc2lnblRyYW5zYWN0aW9uOiAoYXJncykgPT4gc2lnblRyYW5zYWN0aW9uKGNsaWVudCwgYXJncyksCiAgICAgIHNpZ25UeXBlZERhdGE6IChhcmdzKSA9PiBzaWduVHlwZWREYXRhKGNsaWVudCwgYXJncyksCiAgICAgIHN3aXRjaENoYWluOiAoYXJncykgPT4gc3dpdGNoQ2hhaW4oY2xpZW50LCBhcmdzKSwKICAgICAgd2F0Y2hBc3NldDogKGFyZ3MpID0+IHdhdGNoQXNzZXQoY2xpZW50LCBhcmdzKSwKICAgICAgd3JpdGVDb250cmFjdDogKGFyZ3MpID0+IHdyaXRlQ29udHJhY3QoY2xpZW50LCBhcmdzKQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jbGllbnRzL2NyZWF0ZVdhbGxldENsaWVudC5qcwogIGZ1bmN0aW9uIGNyZWF0ZVdhbGxldENsaWVudChwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGtleSA9ICJ3YWxsZXQiLCBuYW1lID0gIldhbGxldCBDbGllbnQiLCB0cmFuc3BvcnQgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBjbGllbnQgPSBjcmVhdGVDbGllbnQoewogICAgICAuLi5wYXJhbWV0ZXJzLAogICAgICBrZXksCiAgICAgIG5hbWUsCiAgICAgIHRyYW5zcG9ydCwKICAgICAgdHlwZTogIndhbGxldENsaWVudCIKICAgIH0pOwogICAgcmV0dXJuIGNsaWVudC5leHRlbmQod2FsbGV0QWN0aW9ucyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2xpZW50cy90cmFuc3BvcnRzL3dlYlNvY2tldC5qcwogIGluaXRfcmVxdWVzdCgpOwogIGZ1bmN0aW9uIHdlYlNvY2tldCh1cmwsIGNvbmZpZyA9IHt9KSB7CiAgICBjb25zdCB7IGtlZXBBbGl2ZSwga2V5ID0gIndlYlNvY2tldCIsIG5hbWUgPSAiV2ViU29ja2V0IEpTT04tUlBDIiwgcmVjb25uZWN0LCByZXRyeURlbGF5IH0gPSBjb25maWc7CiAgICByZXR1cm4gKHsgY2hhaW4sIHJldHJ5Q291bnQ6IHJldHJ5Q291bnRfLCB0aW1lb3V0OiB0aW1lb3V0XyB9KSA9PiB7CiAgICAgIGNvbnN0IHJldHJ5Q291bnQgPSBjb25maWcucmV0cnlDb3VudCA/PyByZXRyeUNvdW50XzsKICAgICAgY29uc3QgdGltZW91dCA9IHRpbWVvdXRfID8/IGNvbmZpZy50aW1lb3V0ID8/IDFlNDsKICAgICAgY29uc3QgdXJsXyA9IHVybCB8fCBjaGFpbj8ucnBjVXJscy5kZWZhdWx0LndlYlNvY2tldD8uWzBdOwogICAgICBpZiAoIXVybF8pCiAgICAgICAgdGhyb3cgbmV3IFVybFJlcXVpcmVkRXJyb3IoKTsKICAgICAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydCh7CiAgICAgICAga2V5LAogICAgICAgIG5hbWUsCiAgICAgICAgYXN5bmMgcmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pIHsKICAgICAgICAgIGNvbnN0IGJvZHkgPSB7IG1ldGhvZCwgcGFyYW1zIH07CiAgICAgICAgICBjb25zdCBycGNDbGllbnQgPSBhd2FpdCBnZXRXZWJTb2NrZXRScGNDbGllbnQodXJsXywgewogICAgICAgICAgICBrZWVwQWxpdmUsCiAgICAgICAgICAgIHJlY29ubmVjdAogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCB7IGVycm9yLCByZXN1bHQgfSA9IGF3YWl0IHJwY0NsaWVudC5yZXF1ZXN0QXN5bmMoewogICAgICAgICAgICBib2R5LAogICAgICAgICAgICB0aW1lb3V0CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChlcnJvcikKICAgICAgICAgICAgdGhyb3cgbmV3IFJwY1JlcXVlc3RFcnJvcih7CiAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICB1cmw6IHVybF8KICAgICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0sCiAgICAgICAgcmV0cnlDb3VudCwKICAgICAgICByZXRyeURlbGF5LAogICAgICAgIHRpbWVvdXQsCiAgICAgICAgdHlwZTogIndlYlNvY2tldCIKICAgICAgfSwgewogICAgICAgIGdldFNvY2tldCgpIHsKICAgICAgICAgIHJldHVybiBnZXRTb2NrZXQodXJsXyk7CiAgICAgICAgfSwKICAgICAgICBnZXRScGNDbGllbnQoKSB7CiAgICAgICAgICByZXR1cm4gZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgc3Vic2NyaWJlKHsgcGFyYW1zLCBvbkRhdGEsIG9uRXJyb3IgfSkgewogICAgICAgICAgY29uc3QgcnBjQ2xpZW50ID0gYXdhaXQgZ2V0V2ViU29ja2V0UnBjQ2xpZW50KHVybF8pOwogICAgICAgICAgY29uc3QgeyByZXN1bHQ6IHN1YnNjcmlwdGlvbklkIH0gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiBycGNDbGllbnQucmVxdWVzdCh7CiAgICAgICAgICAgIGJvZHk6IHsKICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfc3Vic2NyaWJlIiwKICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25FcnJvcihlcnJvcikgewogICAgICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgICAgICAgb25FcnJvcj8uKGVycm9yKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uUmVzcG9uc2UocmVzcG9uc2UpIHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHsKICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZS5lcnJvcik7CiAgICAgICAgICAgICAgICBvbkVycm9yPy4ocmVzcG9uc2UuZXJyb3IpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlLmlkID09PSAibnVtYmVyIikgewogICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChyZXNwb25zZS5tZXRob2QgIT09ICJldGhfc3Vic2NyaXB0aW9uIikKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICBvbkRhdGEocmVzcG9uc2UucGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQsCiAgICAgICAgICAgIGFzeW5jIHVuc3Vic2NyaWJlKCkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcnBjQ2xpZW50LnJlcXVlc3QoewogICAgICAgICAgICAgICAgYm9keTogewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICJldGhfdW5zdWJzY3JpYmUiLAogICAgICAgICAgICAgICAgICBwYXJhbXM6IFtzdWJzY3JpcHRpb25JZF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvblJlc3BvbnNlOiByZXNvbHZlCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hYmlzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jb25zdGFudHMvYWRkcmVzcy5qcwogIHZhciB6ZXJvQWRkcmVzcyA9ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbnRyYWN0cygpOwogIGluaXRfdW5pdCgpOwogIGluaXRfbnVtYmVyKCk7CiAgaW5pdF9hYmkoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NvbnRyYWN0KCk7CiAgaW5pdF9ycGMoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9lbmNvZGluZygpOwogIGluaXRfbm9kZSgpOwogIGluaXRfcmVxdWVzdCgpOwogIGluaXRfYWRkcmVzcygpOwogIGluaXRfdHJhbnNhY3Rpb24oKTsKICBpbml0X2RhdGEoKTsKICBpbml0X3N0YXRlT3ZlcnJpZGUoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3R5cGVzL2VpcDExOTMuanMKICB2YXIgUHJvdmlkZXJScGNFcnJvcjIgPSBjbGFzcyBleHRlbmRzIEVycm9yIHsKICAgIGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UpIHsKICAgICAgc3VwZXIobWVzc2FnZSk7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiY29kZSIsIHsKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgICB2YWx1ZTogdm9pZCAwCiAgICAgIH0pOwogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImRldGFpbHMiLCB7CiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICB9KTsKICAgICAgdGhpcy5jb2RlID0gY29kZTsKICAgICAgdGhpcy5kZXRhaWxzID0gbWVzc2FnZTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2FiaS9kZWNvZGVEZXBsb3lEYXRhLmpzCiAgaW5pdF9hYmkoKTsKICBpbml0X2RlY29kZUFiaVBhcmFtZXRlcnMoKTsKICB2YXIgZG9jc1BhdGg4ID0gIi9kb2NzL2NvbnRyYWN0L2RlY29kZURlcGxveURhdGEiOwogIGZ1bmN0aW9uIGRlY29kZURlcGxveURhdGEocGFyYW1ldGVycykgewogICAgY29uc3QgeyBhYmk6IGFiaTIsIGJ5dGVjb2RlLCBkYXRhIH0gPSBwYXJhbWV0ZXJzOwogICAgaWYgKGRhdGEgPT09IGJ5dGVjb2RlKQogICAgICByZXR1cm4geyBieXRlY29kZSB9OwogICAgY29uc3QgZGVzY3JpcHRpb24gPSBhYmkyLmZpbmQoKHgpID0+ICJ0eXBlIiBpbiB4ICYmIHgudHlwZSA9PT0gImNvbnN0cnVjdG9yIik7CiAgICBpZiAoIWRlc2NyaXB0aW9uKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGlmICghKCJpbnB1dHMiIGluIGRlc2NyaXB0aW9uKSkKICAgICAgdGhyb3cgbmV3IEFiaUNvbnN0cnVjdG9yUGFyYW1zTm90Rm91bmRFcnJvcih7IGRvY3NQYXRoOiBkb2NzUGF0aDggfSk7CiAgICBpZiAoIWRlc2NyaXB0aW9uLmlucHV0cyB8fCBkZXNjcmlwdGlvbi5pbnB1dHMubGVuZ3RoID09PSAwKQogICAgICB0aHJvdyBuZXcgQWJpQ29uc3RydWN0b3JQYXJhbXNOb3RGb3VuZEVycm9yKHsgZG9jc1BhdGg6IGRvY3NQYXRoOCB9KTsKICAgIGNvbnN0IGFyZ3MgPSBkZWNvZGVBYmlQYXJhbWV0ZXJzKGRlc2NyaXB0aW9uLmlucHV0cywgYDB4JHtkYXRhLnJlcGxhY2UoYnl0ZWNvZGUsICIiKX1gKTsKICAgIHJldHVybiB7IGFyZ3MsIGJ5dGVjb2RlIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2RlY29kZUVycm9yUmVzdWx0KCk7CiAgaW5pdF9kZWNvZGVGdW5jdGlvblJlc3VsdCgpOwogIGluaXRfZW5jb2RlQWJpUGFyYW1ldGVycygpOwogIGluaXRfZW5jb2RlRGVwbG95RGF0YSgpOwogIGluaXRfZW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF9wcmVwYXJlRW5jb2RlRnVuY3Rpb25EYXRhKCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2dldEFiaUl0ZW0oKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9jb21wYWN0U2lnbmF0dXJlVG9TaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gY29tcGFjdFNpZ25hdHVyZVRvU2lnbmF0dXJlKHsgciwgeVBhcml0eUFuZFMgfSkgewogICAgY29uc3QgeVBhcml0eUFuZFNfYnl0ZXMgPSBoZXhUb0J5dGVzKHlQYXJpdHlBbmRTKTsKICAgIGNvbnN0IHlQYXJpdHkgPSB5UGFyaXR5QW5kU19ieXRlc1swXSAmIDEyOCA/IDEgOiAwOwogICAgY29uc3QgcyA9IHlQYXJpdHlBbmRTX2J5dGVzOwogICAgaWYgKHlQYXJpdHkgPT09IDEpCiAgICAgIHNbMF0gJj0gMTI3OwogICAgcmV0dXJuIHsgciwgczogYnl0ZXNUb0hleChzKSwgeVBhcml0eSB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9wYXJzZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBwYXJzZUNvbXBhY3RTaWduYXR1cmUoc2lnbmF0dXJlSGV4KSB7CiAgICBjb25zdCB7IHIsIHMgfSA9IHNlY3AyNTZrMS5TaWduYXR1cmUuZnJvbUNvbXBhY3Qoc2lnbmF0dXJlSGV4LnNsaWNlKDIsIDEzMCkpOwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eUFuZFM6IG51bWJlclRvSGV4KHMsIHsgc2l6ZTogMzIgfSkKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3BhcnNlU2lnbmF0dXJlLmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gcGFyc2VTaWduYXR1cmUyKHNpZ25hdHVyZUhleCkgewogICAgY29uc3QgeyByLCBzIH0gPSBzZWNwMjU2azEuU2lnbmF0dXJlLmZyb21Db21wYWN0KHNpZ25hdHVyZUhleC5zbGljZSgyLCAxMzApKTsKICAgIGNvbnN0IHlQYXJpdHlPclYgPSBOdW1iZXIoYDB4JHtzaWduYXR1cmVIZXguc2xpY2UoMTMwKX1gKTsKICAgIGNvbnN0IFt2LCB5UGFyaXR5XSA9ICgoKSA9PiB7CiAgICAgIGlmICh5UGFyaXR5T3JWID09PSAwIHx8IHlQYXJpdHlPclYgPT09IDEpCiAgICAgICAgcmV0dXJuIFt2b2lkIDAsIHlQYXJpdHlPclZdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjcpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDBdOwogICAgICBpZiAoeVBhcml0eU9yViA9PT0gMjgpCiAgICAgICAgcmV0dXJuIFtCaWdJbnQoeVBhcml0eU9yViksIDFdOwogICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgeVBhcml0eU9yViB2YWx1ZSIpOwogICAgfSkoKTsKICAgIGlmICh0eXBlb2YgdiAhPT0gInVuZGVmaW5lZCIpCiAgICAgIHJldHVybiB7CiAgICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgICBzOiBudW1iZXJUb0hleChzLCB7IHNpemU6IDMyIH0pLAogICAgICAgIHYsCiAgICAgICAgeVBhcml0eQogICAgICB9OwogICAgcmV0dXJuIHsKICAgICAgcjogbnVtYmVyVG9IZXgociwgeyBzaXplOiAzMiB9KSwKICAgICAgczogbnVtYmVyVG9IZXgocywgeyBzaXplOiAzMiB9KSwKICAgICAgeVBhcml0eQogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9zaWduYXR1cmUvcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcy5qcwogIGluaXRfa2VjY2FrMjU2KCk7CiAgYXN5bmMgZnVuY3Rpb24gcmVjb3ZlclRyYW5zYWN0aW9uQWRkcmVzcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiwgc2lnbmF0dXJlOiBzaWduYXR1cmVfIH0gPSBwYXJhbWV0ZXJzOwogICAgY29uc3QgdHJhbnNhY3Rpb24gPSBwYXJzZVRyYW5zYWN0aW9uKHNlcmlhbGl6ZWRUcmFuc2FjdGlvbik7CiAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVfID8/IHsKICAgICAgcjogdHJhbnNhY3Rpb24uciwKICAgICAgczogdHJhbnNhY3Rpb24ucywKICAgICAgdjogdHJhbnNhY3Rpb24udiwKICAgICAgeVBhcml0eTogdHJhbnNhY3Rpb24ueVBhcml0eQogICAgfTsKICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBzZXJpYWxpemVUcmFuc2FjdGlvbih7CiAgICAgIC4uLnRyYW5zYWN0aW9uLAogICAgICByOiB2b2lkIDAsCiAgICAgIHM6IHZvaWQgMCwKICAgICAgdjogdm9pZCAwLAogICAgICB5UGFyaXR5OiB2b2lkIDAsCiAgICAgIHNpZGVjYXJzOiB2b2lkIDAKICAgIH0pOwogICAgcmV0dXJuIGF3YWl0IHJlY292ZXJBZGRyZXNzKHsKICAgICAgaGFzaDoga2VjY2FrMjU2KHNlcmlhbGl6ZWQpLAogICAgICBzaWduYXR1cmUKICAgIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL3NpZ25hdHVyZS9zaWduYXR1cmVUb0NvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gc2lnbmF0dXJlVG9Db21wYWN0U2lnbmF0dXJlKHNpZ25hdHVyZSkgewogICAgY29uc3QgeyByLCBzLCB2LCB5UGFyaXR5IH0gPSBzaWduYXR1cmU7CiAgICBjb25zdCB5UGFyaXR5XyA9IE51bWJlcih5UGFyaXR5ID8/IHYgLSAyN24pOwogICAgbGV0IHlQYXJpdHlBbmRTID0gczsKICAgIGlmICh5UGFyaXR5XyA9PT0gMSkgewogICAgICBjb25zdCBieXRlczIgPSBoZXhUb0J5dGVzKHMpOwogICAgICBieXRlczJbMF0gfD0gMTI4OwogICAgICB5UGFyaXR5QW5kUyA9IGJ5dGVzVG9IZXgoYnl0ZXMyKTsKICAgIH0KICAgIHJldHVybiB7IHIsIHlQYXJpdHlBbmRTIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvc2lnbmF0dXJlL3NlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUuanMKICBpbml0X3NlY3AyNTZrMSgpOwogIGluaXRfZnJvbUhleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZUNvbXBhY3RTaWduYXR1cmUoeyByLCB5UGFyaXR5QW5kUyB9KSB7CiAgICByZXR1cm4gYDB4JHtuZXcgc2VjcDI1NmsxLlNpZ25hdHVyZShoZXhUb0JpZ0ludChyKSwgaGV4VG9CaWdJbnQoeVBhcml0eUFuZFMpKS50b0NvbXBhY3RIZXgoKX1gOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2luZGV4LmpzCiAgaW5pdF9hc3NlcnRSZXF1ZXN0KCk7CiAgaW5pdF90b0J5dGVzKCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfZnJvbUJ5dGVzKCk7CiAgaW5pdF9jY2lwMigpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9zaWRlY2Fyc1RvVmVyc2lvbmVkSGFzaGVzLmpzCiAgZnVuY3Rpb24gc2lkZWNhcnNUb1ZlcnNpb25lZEhhc2hlcyhwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHNpZGVjYXJzLCB2ZXJzaW9uOiB2ZXJzaW9uMyB9ID0gcGFyYW1ldGVyczsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHNpZGVjYXJzWzBdLmJsb2IgPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGhhc2hlcyA9IFtdOwogICAgZm9yIChjb25zdCB7IGNvbW1pdG1lbnQgfSBvZiBzaWRlY2FycykgewogICAgICBoYXNoZXMucHVzaChjb21taXRtZW50VG9WZXJzaW9uZWRIYXNoKHsKICAgICAgICBjb21taXRtZW50LAogICAgICAgIHRvLAogICAgICAgIHZlcnNpb246IHZlcnNpb24zCiAgICAgIH0pKTsKICAgIH0KICAgIHJldHVybiBoYXNoZXM7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vdXRpbHMvYmxvYi9mcm9tQmxvYnMuanMKICBpbml0X2N1cnNvcjIoKTsKICBpbml0X3RvQnl0ZXMoKTsKICBpbml0X3RvSGV4KCk7CiAgZnVuY3Rpb24gZnJvbUJsb2JzKHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IHRvID0gcGFyYW1ldGVycy50byA/PyAodHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gImhleCIgOiAiYnl0ZXMiKTsKICAgIGNvbnN0IGJsb2JzID0gdHlwZW9mIHBhcmFtZXRlcnMuYmxvYnNbMF0gPT09ICJzdHJpbmciID8gcGFyYW1ldGVycy5ibG9icy5tYXAoKHgpID0+IGhleFRvQnl0ZXMoeCkpIDogcGFyYW1ldGVycy5ibG9iczsKICAgIGNvbnN0IGxlbmd0aCA9IGJsb2JzLnJlZHVjZSgobGVuZ3RoMiwgYmxvYikgPT4gbGVuZ3RoMiArIGJsb2IubGVuZ3RoLCAwKTsKICAgIGNvbnN0IGRhdGEgPSBjcmVhdGVDdXJzb3IobmV3IFVpbnQ4QXJyYXkobGVuZ3RoKSk7CiAgICBsZXQgYWN0aXZlID0gdHJ1ZTsKICAgIGZvciAoY29uc3QgYmxvYiBvZiBibG9icykgewogICAgICBjb25zdCBjdXJzb3IgPSBjcmVhdGVDdXJzb3IoYmxvYik7CiAgICAgIHdoaWxlIChhY3RpdmUgJiYgY3Vyc29yLnBvc2l0aW9uIDwgYmxvYi5sZW5ndGgpIHsKICAgICAgICBjdXJzb3IuaW5jcmVtZW50UG9zaXRpb24oMSk7CiAgICAgICAgbGV0IGNvbnN1bWUgPSAzMTsKICAgICAgICBpZiAoYmxvYi5sZW5ndGggLSBjdXJzb3IucG9zaXRpb24gPCAzMSkKICAgICAgICAgIGNvbnN1bWUgPSBibG9iLmxlbmd0aCAtIGN1cnNvci5wb3NpdGlvbjsKICAgICAgICBmb3IgKGNvbnN0IF8gaW4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29uc3VtZSB9KSkgewogICAgICAgICAgY29uc3QgYnl0ZSA9IGN1cnNvci5yZWFkQnl0ZSgpOwogICAgICAgICAgY29uc3QgaXNUZXJtaW5hdG9yID0gYnl0ZSA9PT0gMTI4ICYmICFjdXJzb3IuaW5zcGVjdEJ5dGVzKGN1cnNvci5yZW1haW5pbmcpLmluY2x1ZGVzKDEyOCk7CiAgICAgICAgICBpZiAoaXNUZXJtaW5hdG9yKSB7CiAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGRhdGEucHVzaEJ5dGUoYnl0ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjb25zdCB0cmltbWVkRGF0YSA9IGRhdGEuYnl0ZXMuc2xpY2UoMCwgZGF0YS5wb3NpdGlvbik7CiAgICByZXR1cm4gdG8gPT09ICJoZXgiID8gYnl0ZXNUb0hleCh0cmltbWVkRGF0YSkgOiB0cmltbWVkRGF0YTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS91dGlscy9remcvZGVmaW5lS3pnLmpzCiAgZnVuY3Rpb24gZGVmaW5lS3pnKHsgYmxvYlRvS3pnQ29tbWl0bWVudCwgY29tcHV0ZUJsb2JLemdQcm9vZiB9KSB7CiAgICByZXR1cm4gewogICAgICBibG9iVG9LemdDb21taXRtZW50LAogICAgICBjb21wdXRlQmxvYkt6Z1Byb29mCiAgICB9OwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3V0aWxzL2t6Zy9zZXR1cEt6Zy5qcwogIGZ1bmN0aW9uIHNldHVwS3pnKHBhcmFtZXRlcnMsIHBhdGgpIHsKICAgIHRyeSB7CiAgICAgIHBhcmFtZXRlcnMubG9hZFRydXN0ZWRTZXR1cChwYXRoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc3QgZXJyb3IgPSBlOwogICAgICBpZiAoIWVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoInRydXN0ZWQgc2V0dXAgaXMgYWxyZWFkeSBsb2FkZWQiKSkKICAgICAgICB0aHJvdyBlcnJvcjsKICAgIH0KICAgIHJldHVybiBkZWZpbmVLemcocGFyYW1ldGVycyk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vaW5kZXguanMKICBpbml0X2NvbmNhdCgpOwogIGluaXRfZ2V0Q2hhaW5Db250cmFjdEFkZHJlc3MoKTsKICBpbml0X2Zvcm1hdEV0aGVyKCk7CiAgaW5pdF9mb3JtYXRHd2VpKCk7CiAgaW5pdF9mb3JtYXRVbml0cygpOwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfZ2V0QWRkcmVzcygpOwogIGluaXRfdG9FdmVudFNlbGVjdG9yKCk7CiAgaW5pdF90b0Z1bmN0aW9uU2VsZWN0b3IoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfaXNBZGRyZXNzRXF1YWwoKTsKICBpbml0X2lzSGV4KCk7CiAgaW5pdF9rZWNjYWsyNTYoKTsKICBpbml0X3BhZCgpOwogIGluaXRfc2l6ZSgpOwogIGluaXRfc2xpY2UoKTsKICBpbml0X3N0cmluZ2lmeSgpOwogIGluaXRfdHJpbSgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2luZGV4LmpzCiAgdmFyIGNoYWluc19leHBvcnRzID0ge307CiAgX19leHBvcnQoY2hhaW5zX2V4cG9ydHMsIHsKICAgIGFic3RyYWN0VGVzdG5ldDogKCkgPT4gYWJzdHJhY3RUZXN0bmV0LAogICAgYWNhbGE6ICgpID0+IGFjYWxhLAogICAgYWxpZW54OiAoKSA9PiBhbGllbngsCiAgICBhbGllbnhIYWxUZXN0bmV0OiAoKSA9PiBhbGllbnhIYWxUZXN0bmV0LAogICAgYW5jaWVudDg6ICgpID0+IGFuY2llbnQ4LAogICAgYW5jaWVudDhTZXBvbGlhOiAoKSA9PiBhbmNpZW50OFNlcG9saWEsCiAgICBhbnZpbDogKCkgPT4gYW52aWwsCiAgICBhcGVDaGFpbjogKCkgPT4gYXBlQ2hhaW4sCiAgICBhcGV4VGVzdG5ldDogKCkgPT4gYXBleFRlc3RuZXQsCiAgICBhcmJpdHJ1bTogKCkgPT4gYXJiaXRydW0sCiAgICBhcmJpdHJ1bUdvZXJsaTogKCkgPT4gYXJiaXRydW1Hb2VybGksCiAgICBhcmJpdHJ1bU5vdmE6ICgpID0+IGFyYml0cnVtTm92YSwKICAgIGFyYml0cnVtU2Vwb2xpYTogKCkgPT4gYXJiaXRydW1TZXBvbGlhLAogICAgYXJlb25OZXR3b3JrOiAoKSA9PiBhcmVvbk5ldHdvcmssCiAgICBhcmVvbk5ldHdvcmtUZXN0bmV0OiAoKSA9PiBhcmVvbk5ldHdvcmtUZXN0bmV0LAogICAgYXJ0ZWxhVGVzdG5ldDogKCkgPT4gYXJ0ZWxhVGVzdG5ldCwKICAgIGFzc2V0Q2hhaW46ICgpID0+IGFzc2V0Q2hhaW4sCiAgICBhc3NldENoYWluVGVzdG5ldDogKCkgPT4gYXNzZXRDaGFpblRlc3RuZXQsCiAgICBhc3RhcjogKCkgPT4gYXN0YXIsCiAgICBhc3RhclprRVZNOiAoKSA9PiBhc3RhclprRVZNLAogICAgYXN0YXJaa3lvdG86ICgpID0+IGFzdGFyWmt5b3RvLAogICAgYXRsZXRhT2x5bXBpYTogKCkgPT4gYXRsZXRhT2x5bXBpYSwKICAgIGF1cm9yYTogKCkgPT4gYXVyb3JhLAogICAgYXVyb3JhVGVzdG5ldDogKCkgPT4gYXVyb3JhVGVzdG5ldCwKICAgIGF1cm9yaWE6ICgpID0+IGF1cm9yaWEsCiAgICBhdmFsYW5jaGU6ICgpID0+IGF2YWxhbmNoZSwKICAgIGF2YWxhbmNoZUZ1amk6ICgpID0+IGF2YWxhbmNoZUZ1amksCiAgICBiMzogKCkgPT4gYjMsCiAgICBiM1NlcG9saWE6ICgpID0+IGIzU2Vwb2xpYSwKICAgIGJhaGFtdXQ6ICgpID0+IGJhaGFtdXQsCiAgICBiYXNlOiAoKSA9PiBiYXNlLAogICAgYmFzZUdvZXJsaTogKCkgPT4gYmFzZUdvZXJsaSwKICAgIGJhc2VTZXBvbGlhOiAoKSA9PiBiYXNlU2Vwb2xpYSwKICAgIGJlYW06ICgpID0+IGJlYW0sCiAgICBiZWFtVGVzdG5ldDogKCkgPT4gYmVhbVRlc3RuZXQsCiAgICBiZWFyTmV0d29ya0NoYWluTWFpbm5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpbk1haW5uZXQsCiAgICBiZWFyTmV0d29ya0NoYWluVGVzdG5ldDogKCkgPT4gYmVhck5ldHdvcmtDaGFpblRlc3RuZXQsCiAgICBiZXJhY2hhaW5UZXN0bmV0OiAoKSA9PiBiZXJhY2hhaW5UZXN0bmV0LAogICAgYmVyYWNoYWluVGVzdG5ldGJBcnRpbzogKCkgPT4gYmVyYWNoYWluVGVzdG5ldGJBcnRpbywKICAgIGJldm1NYWlubmV0OiAoKSA9PiBiZXZtTWFpbm5ldCwKICAgIGJpZnJvc3Q6ICgpID0+IGJpZnJvc3QsCiAgICBiaXRUb3JyZW50OiAoKSA9PiBiaXRUb3JyZW50LAogICAgYml0VG9ycmVudFRlc3RuZXQ6ICgpID0+IGJpdFRvcnJlbnRUZXN0bmV0LAogICAgYml0a3ViOiAoKSA9PiBiaXRrdWIsCiAgICBiaXRrdWJUZXN0bmV0OiAoKSA9PiBiaXRrdWJUZXN0bmV0LAogICAgYml0bGF5ZXI6ICgpID0+IGJpdGxheWVyLAogICAgYml0bGF5ZXJUZXN0bmV0OiAoKSA9PiBiaXRsYXllclRlc3RuZXQsCiAgICBiaXRyb2NrOiAoKSA9PiBiaXRyb2NrLAogICAgYmxhc3Q6ICgpID0+IGJsYXN0LAogICAgYmxhc3RTZXBvbGlhOiAoKSA9PiBibGFzdFNlcG9saWEsCiAgICBib2I6ICgpID0+IGJvYiwKICAgIGJvYlNlcG9saWE6ICgpID0+IGJvYlNlcG9saWEsCiAgICBib2JhOiAoKSA9PiBib2JhLAogICAgYm9iYVNlcG9saWE6ICgpID0+IGJvYmFTZXBvbGlhLAogICAgYm90YW5peFRlc3RuZXQ6ICgpID0+IGJvdGFuaXhUZXN0bmV0LAogICAgYm91bmNlQml0OiAoKSA9PiBib3VuY2VCaXQsCiAgICBib3VuY2VCaXRUZXN0bmV0OiAoKSA9PiBib3VuY2VCaXRUZXN0bmV0LAogICAgYnJvbm9zOiAoKSA9PiBicm9ub3MsCiAgICBicm9ub3NUZXN0bmV0OiAoKSA9PiBicm9ub3NUZXN0bmV0LAogICAgYnNjOiAoKSA9PiBic2MsCiAgICBic2NHcmVlbmZpZWxkOiAoKSA9PiBic2NHcmVlbmZpZWxkLAogICAgYnNjVGVzdG5ldDogKCkgPT4gYnNjVGVzdG5ldCwKICAgIGJzcXVhcmVkOiAoKSA9PiBic3F1YXJlZCwKICAgIGJzcXVhcmVkVGVzdG5ldDogKCkgPT4gYnNxdWFyZWRUZXN0bmV0LAogICAgYnRyOiAoKSA9PiBidHIsCiAgICBidHJUZXN0bmV0OiAoKSA9PiBidHJUZXN0bmV0LAogICAgYnhuOiAoKSA9PiBieG4sCiAgICBieG5UZXN0bmV0OiAoKSA9PiBieG5UZXN0bmV0LAogICAgY2Fubm9uOiAoKSA9PiBjYW5ub24sCiAgICBjYW50bzogKCkgPT4gY2FudG8sCiAgICBjZWxvOiAoKSA9PiBjZWxvLAogICAgY2Vsb0FsZmFqb3JlczogKCkgPT4gY2Vsb0FsZmFqb3JlcywKICAgIGNoYW5nOiAoKSA9PiBjaGFuZywKICAgIGNoaWxpejogKCkgPT4gY2hpbGl6LAogICAgY2hpcHM6ICgpID0+IGNoaXBzLAogICAgY2xhc3NpYzogKCkgPT4gY2xhc3NpYywKICAgIGNvbmZsdXhFU3BhY2U6ICgpID0+IGNvbmZsdXhFU3BhY2UsCiAgICBjb25mbHV4RVNwYWNlVGVzdG5ldDogKCkgPT4gY29uZmx1eEVTcGFjZVRlc3RuZXQsCiAgICBjb3JlRGFvOiAoKSA9PiBjb3JlRGFvLAogICAgY3JhYjogKCkgPT4gY3JhYiwKICAgIGNyb25vczogKCkgPT4gY3Jvbm9zLAogICAgY3Jvbm9zVGVzdG5ldDogKCkgPT4gY3Jvbm9zVGVzdG5ldCwKICAgIGNyb25vc3prRVZNOiAoKSA9PiBjcm9ub3N6a0VWTSwKICAgIGNyb25vc3prRVZNVGVzdG5ldDogKCkgPT4gY3Jvbm9zemtFVk1UZXN0bmV0LAogICAgY3Jvc3NiZWxsOiAoKSA9PiBjcm9zc2JlbGwsCiAgICBjdXJ0aXM6ICgpID0+IGN1cnRpcywKICAgIGN5YmVyOiAoKSA9PiBjeWJlciwKICAgIGN5YmVyVGVzdG5ldDogKCkgPT4gY3liZXJUZXN0bmV0LAogICAgZGFyd2luaWE6ICgpID0+IGRhcndpbmlhLAogICAgZGNoYWluOiAoKSA9PiBkY2hhaW4sCiAgICBkY2hhaW5UZXN0bmV0OiAoKSA9PiBkY2hhaW5UZXN0bmV0LAogICAgZGVmaWNoYWluRXZtOiAoKSA9PiBkZWZpY2hhaW5Fdm0sCiAgICBkZWZpY2hhaW5Fdm1UZXN0bmV0OiAoKSA9PiBkZWZpY2hhaW5Fdm1UZXN0bmV0LAogICAgZGVnZW46ICgpID0+IGRlZ2VuLAogICAgZGZrOiAoKSA9PiBkZmssCiAgICBkb2RvY2hhaW5UZXN0bmV0OiAoKSA9PiBkb2RvY2hhaW5UZXN0bmV0LAogICAgZG9nZWNoYWluOiAoKSA9PiBkb2dlY2hhaW4sCiAgICBkb3NDaGFpbjogKCkgPT4gZG9zQ2hhaW4sCiAgICBkb3NDaGFpblRlc3RuZXQ6ICgpID0+IGRvc0NoYWluVGVzdG5ldCwKICAgIGRyZXllcnhNYWlubmV0OiAoKSA9PiBkcmV5ZXJ4TWFpbm5ldCwKICAgIGRyZXllcnhUZXN0bmV0OiAoKSA9PiBkcmV5ZXJ4VGVzdG5ldCwKICAgIGR1c3Rib3lJb1Q6ICgpID0+IGR1c3Rib3lJb1QsCiAgICBkeW1lbnNpb246ICgpID0+IGR5bWVuc2lvbiwKICAgIGVkZ2VsZXNzOiAoKSA9PiBlZGdlbGVzcywKICAgIGVkZ2VsZXNzVGVzdG5ldDogKCkgPT4gZWRnZWxlc3NUZXN0bmV0LAogICAgZWRnZXdhcmU6ICgpID0+IGVkZ2V3YXJlLAogICAgZWRnZXdhcmVUZXN0bmV0OiAoKSA9PiBlZGdld2FyZVRlc3RuZXQsCiAgICBla3RhOiAoKSA9PiBla3RhLAogICAgZWt0YVRlc3RuZXQ6ICgpID0+IGVrdGFUZXN0bmV0LAogICAgZWxhc3RvczogKCkgPT4gZWxhc3RvcywKICAgIGVsYXN0b3NUZXN0bmV0OiAoKSA9PiBlbGFzdG9zVGVzdG5ldCwKICAgIGVsZWN0cm9uZXVtOiAoKSA9PiBlbGVjdHJvbmV1bSwKICAgIGVsZWN0cm9uZXVtVGVzdG5ldDogKCkgPT4gZWxlY3Ryb25ldW1UZXN0bmV0LAogICAgZWx5c2l1bVRlc3RuZXQ6ICgpID0+IGVseXNpdW1UZXN0bmV0LAogICAgZW9uOiAoKSA9PiBlb24sCiAgICBlb3M6ICgpID0+IGVvcywKICAgIGVvc1Rlc3RuZXQ6ICgpID0+IGVvc1Rlc3RuZXQsCiAgICBldGhlcmxpbms6ICgpID0+IGV0aGVybGluaywKICAgIGV0aGVybGlua1Rlc3RuZXQ6ICgpID0+IGV0aGVybGlua1Rlc3RuZXQsCiAgICBldm1vczogKCkgPT4gZXZtb3MsCiAgICBldm1vc1Rlc3RuZXQ6ICgpID0+IGV2bW9zVGVzdG5ldCwKICAgIGV4Y2Vsb25NYWlubmV0OiAoKSA9PiBleGNlbG9uTWFpbm5ldCwKICAgIGZhbnRvbTogKCkgPT4gZmFudG9tLAogICAgZmFudG9tU29uaWNUZXN0bmV0OiAoKSA9PiBmYW50b21Tb25pY1Rlc3RuZXQsCiAgICBmYW50b21UZXN0bmV0OiAoKSA9PiBmYW50b21UZXN0bmV0LAogICAgZmlibzogKCkgPT4gZmlibywKICAgIGZpbGVjb2luOiAoKSA9PiBmaWxlY29pbiwKICAgIGZpbGVjb2luQ2FsaWJyYXRpb246ICgpID0+IGZpbGVjb2luQ2FsaWJyYXRpb24sCiAgICBmaWxlY29pbkh5cGVyc3BhY2U6ICgpID0+IGZpbGVjb2luSHlwZXJzcGFjZSwKICAgIGZsYXJlOiAoKSA9PiBmbGFyZSwKICAgIGZsYXJlVGVzdG5ldDogKCkgPT4gZmxhcmVUZXN0bmV0LAogICAgZmxvd01haW5uZXQ6ICgpID0+IGZsb3dNYWlubmV0LAogICAgZmxvd1ByZXZpZXduZXQ6ICgpID0+IGZsb3dQcmV2aWV3bmV0LAogICAgZmxvd1Rlc3RuZXQ6ICgpID0+IGZsb3dUZXN0bmV0LAogICAgZmx1ZW5jZTogKCkgPT4gZmx1ZW5jZSwKICAgIGZsdWVuY2VTdGFnZTogKCkgPT4gZmx1ZW5jZVN0YWdlLAogICAgZmx1ZW5jZVRlc3RuZXQ6ICgpID0+IGZsdWVuY2VUZXN0bmV0LAogICAgZm9ybWE6ICgpID0+IGZvcm1hLAogICAgZm91bmRyeTogKCkgPT4gZm91bmRyeSwKICAgIGZyYXh0YWw6ICgpID0+IGZyYXh0YWwsCiAgICBmcmF4dGFsVGVzdG5ldDogKCkgPT4gZnJheHRhbFRlc3RuZXQsCiAgICBmdW5raU1haW5uZXQ6ICgpID0+IGZ1bmtpTWFpbm5ldCwKICAgIGZ1bmtpU2Vwb2xpYTogKCkgPT4gZnVua2lTZXBvbGlhLAogICAgZnVzZTogKCkgPT4gZnVzZSwKICAgIGZ1c2VTcGFya25ldDogKCkgPT4gZnVzZVNwYXJrbmV0LAogICAgZnVzaW9uOiAoKSA9PiBmdXNpb24sCiAgICBmdXNpb25UZXN0bmV0OiAoKSA9PiBmdXNpb25UZXN0bmV0LAogICAgZ2FybmV0OiAoKSA9PiBnYXJuZXQsCiAgICBnZW5lc3lzOiAoKSA9PiBnZW5lc3lzLAogICAgZ25vc2lzOiAoKSA9PiBnbm9zaXMsCiAgICBnbm9zaXNDaGlhZG86ICgpID0+IGdub3Npc0NoaWFkbywKICAgIGdvQ2hhaW46ICgpID0+IGdvQ2hhaW4sCiAgICBnb2JpOiAoKSA9PiBnb2JpLAogICAgZ29lcmxpOiAoKSA9PiBnb2VybGksCiAgICBncmF2aXR5OiAoKSA9PiBncmF2aXR5LAogICAgZ3VydVRlc3RuZXQ6ICgpID0+IGd1cnVUZXN0bmV0LAogICAgaGFtOiAoKSA9PiBoYW0sCiAgICBoYXFxTWFpbm5ldDogKCkgPT4gaGFxcU1haW5uZXQsCiAgICBoYXFxVGVzdGVkZ2UyOiAoKSA9PiBoYXFxVGVzdGVkZ2UyLAogICAgaGFyZGhhdDogKCkgPT4gaGFyZGhhdCwKICAgIGhhcm1vbnlPbmU6ICgpID0+IGhhcm1vbnlPbmUsCiAgICBoYXNoa2V5VGVzdG5ldDogKCkgPT4gaGFzaGtleVRlc3RuZXQsCiAgICBoZWRlcmE6ICgpID0+IGhlZGVyYSwKICAgIGhlZGVyYVByZXZpZXduZXQ6ICgpID0+IGhlZGVyYVByZXZpZXduZXQsCiAgICBoZWRlcmFUZXN0bmV0OiAoKSA9PiBoZWRlcmFUZXN0bmV0LAogICAgaGVsYTogKCkgPT4gaGVsYSwKICAgIGhlbWlTZXBvbGlhOiAoKSA9PiBoZW1pU2Vwb2xpYSwKICAgIGhvbGVza3k6ICgpID0+IGhvbGVza3ksCiAgICBoeWNoYWluOiAoKSA9PiBoeWNoYWluLAogICAgaHljaGFpblRlc3RuZXQ6ICgpID0+IGh5Y2hhaW5UZXN0bmV0LAogICAgaW1tdXRhYmxlWmtFdm06ICgpID0+IGltbXV0YWJsZVprRXZtLAogICAgaW1tdXRhYmxlWmtFdm1UZXN0bmV0OiAoKSA9PiBpbW11dGFibGVaa0V2bVRlc3RuZXQsCiAgICBpbkVWTTogKCkgPT4gaW5FVk0sCiAgICBpb3RhOiAoKSA9PiBpb3RhLAogICAgaW90YVRlc3RuZXQ6ICgpID0+IGlvdGFUZXN0bmV0LAogICAgaW90ZXg6ICgpID0+IGlvdGV4LAogICAgaW90ZXhUZXN0bmV0OiAoKSA9PiBpb3RleFRlc3RuZXQsCiAgICBqYmM6ICgpID0+IGpiYywKICAgIGpiY1Rlc3RuZXQ6ICgpID0+IGpiY1Rlc3RuZXQsCiAgICBrYWlhOiAoKSA9PiBrYWlhLAogICAga2Fpcm9zOiAoKSA9PiBrYWlyb3MsCiAgICBrYWthcm90U2Vwb2xpYTogKCkgPT4ga2FrYXJvdFNlcG9saWEsCiAgICBrYWthcm90U3RhcmtuZXRTZXBvbGlhOiAoKSA9PiBrYWthcm90U3RhcmtuZXRTZXBvbGlhLAogICAga2FydXJhOiAoKSA9PiBrYXJ1cmEsCiAgICBrYXZhOiAoKSA9PiBrYXZhLAogICAga2F2YVRlc3RuZXQ6ICgpID0+IGthdmFUZXN0bmV0LAogICAga2NjOiAoKSA9PiBrY2MsCiAgICBraW50bzogKCkgPT4ga2ludG8sCiAgICBrbGF5dG46ICgpID0+IGtsYXl0biwKICAgIGtsYXl0bkJhb2JhYjogKCkgPT4ga2xheXRuQmFvYmFiLAogICAga29pOiAoKSA9PiBrb2ksCiAgICBrcm9tYTogKCkgPT4ga3JvbWEsCiAgICBrcm9tYVNlcG9saWE6ICgpID0+IGtyb21hU2Vwb2xpYSwKICAgIGwzeDogKCkgPT4gbDN4LAogICAgbDN4VGVzdG5ldDogKCkgPT4gbDN4VGVzdG5ldCwKICAgIGxhdml0YTogKCkgPT4gbGF2aXRhLAogICAgbGlnaHRsaW5rUGVnYXN1czogKCkgPT4gbGlnaHRsaW5rUGVnYXN1cywKICAgIGxpZ2h0bGlua1Bob2VuaXg6ICgpID0+IGxpZ2h0bGlua1Bob2VuaXgsCiAgICBsaW5lYTogKCkgPT4gbGluZWEsCiAgICBsaW5lYUdvZXJsaTogKCkgPT4gbGluZWFHb2VybGksCiAgICBsaW5lYVNlcG9saWE6ICgpID0+IGxpbmVhU2Vwb2xpYSwKICAgIGxpbmVhVGVzdG5ldDogKCkgPT4gbGluZWFUZXN0bmV0LAogICAgbGlzazogKCkgPT4gbGlzaywKICAgIGxpc2tTZXBvbGlhOiAoKSA9PiBsaXNrU2Vwb2xpYSwKICAgIGxvY2FsaG9zdDogKCkgPT4gbG9jYWxob3N0LAogICAgbG9vcDogKCkgPT4gbG9vcCwKICAgIGx1a3NvOiAoKSA9PiBsdWtzbywKICAgIGx1a3NvVGVzdG5ldDogKCkgPT4gbHVrc29UZXN0bmV0LAogICAgbHljYW46ICgpID0+IGx5Y2FuLAogICAgbHlyYTogKCkgPT4gbHlyYSwKICAgIG1haW5uZXQ6ICgpID0+IG1haW5uZXQsCiAgICBtYW5kYWxhOiAoKSA9PiBtYW5kYWxhLAogICAgbWFudGE6ICgpID0+IG1hbnRhLAogICAgbWFudGFTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWFudGFTZXBvbGlhVGVzdG5ldCwKICAgIG1hbnRhVGVzdG5ldDogKCkgPT4gbWFudGFUZXN0bmV0LAogICAgbWFudGxlOiAoKSA9PiBtYW50bGUsCiAgICBtYW50bGVTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWFudGxlU2Vwb2xpYVRlc3RuZXQsCiAgICBtYW50bGVUZXN0bmV0OiAoKSA9PiBtYW50bGVUZXN0bmV0LAogICAgbWFwUHJvdG9jb2w6ICgpID0+IG1hcFByb3RvY29sLAogICAgbWF0Y2hhaW46ICgpID0+IG1hdGNoYWluLAogICAgbWF0Y2hhaW5UZXN0bmV0OiAoKSA9PiBtYXRjaGFpblRlc3RuZXQsCiAgICBtZXJsaW46ICgpID0+IG1lcmxpbiwKICAgIG1ldGFjaGFpbjogKCkgPT4gbWV0YWNoYWluLAogICAgbWV0YWNoYWluSXN0YW5idWw6ICgpID0+IG1ldGFjaGFpbklzdGFuYnVsLAogICAgbWV0YWxMMjogKCkgPT4gbWV0YWxMMiwKICAgIG1ldGVyOiAoKSA9PiBtZXRlciwKICAgIG1ldGVyVGVzdG5ldDogKCkgPT4gbWV0ZXJUZXN0bmV0LAogICAgbWV0aXM6ICgpID0+IG1ldGlzLAogICAgbWV0aXNHb2VybGk6ICgpID0+IG1ldGlzR29lcmxpLAogICAgbWV2OiAoKSA9PiBtZXYsCiAgICBtZXZUZXN0bmV0OiAoKSA9PiBtZXZUZXN0bmV0LAogICAgbWludDogKCkgPT4gbWludCwKICAgIG1pbnRTZXBvbGlhVGVzdG5ldDogKCkgPT4gbWludFNlcG9saWFUZXN0bmV0LAogICAgbW9kZTogKCkgPT4gbW9kZSwKICAgIG1vZGVUZXN0bmV0OiAoKSA9PiBtb2RlVGVzdG5ldCwKICAgIG1vb25iYXNlQWxwaGE6ICgpID0+IG1vb25iYXNlQWxwaGEsCiAgICBtb29uYmVhbTogKCkgPT4gbW9vbmJlYW0sCiAgICBtb29uYmVhbURldjogKCkgPT4gbW9vbmJlYW1EZXYsCiAgICBtb29ucml2ZXI6ICgpID0+IG1vb25yaXZlciwKICAgIG1vcnBoSG9sZXNreTogKCkgPT4gbW9ycGhIb2xlc2t5LAogICAgbW9ycGhTZXBvbGlhOiAoKSA9PiBtb3JwaFNlcG9saWEsCiAgICBuYXV0aWx1czogKCkgPT4gbmF1dGlsdXMsCiAgICBuZW9uRGV2bmV0OiAoKSA9PiBuZW9uRGV2bmV0LAogICAgbmVvbk1haW5uZXQ6ICgpID0+IG5lb25NYWlubmV0LAogICAgbmV4aTogKCkgPT4gbmV4aSwKICAgIG5leGlsaXg6ICgpID0+IG5leGlsaXgsCiAgICBvYXNpc1Rlc3RuZXQ6ICgpID0+IG9hc2lzVGVzdG5ldCwKICAgIG9hc3lzOiAoKSA9PiBvYXN5cywKICAgIG9keXNzZXlUZXN0bmV0OiAoKSA9PiBvZHlzc2V5VGVzdG5ldCwKICAgIG9rYzogKCkgPT4gb2tjLAogICAgb29ydE1haW5uZXREZXY6ICgpID0+IG9vcnRNYWlubmV0RGV2LAogICAgb3BCTkI6ICgpID0+IG9wQk5CLAogICAgb3BCTkJUZXN0bmV0OiAoKSA9PiBvcEJOQlRlc3RuZXQsCiAgICBvcHRpbWlzbTogKCkgPT4gb3B0aW1pc20sCiAgICBvcHRpbWlzbUdvZXJsaTogKCkgPT4gb3B0aW1pc21Hb2VybGksCiAgICBvcHRpbWlzbVNlcG9saWE6ICgpID0+IG9wdGltaXNtU2Vwb2xpYSwKICAgIG9wdG9waWE6ICgpID0+IG9wdG9waWEsCiAgICBvcHRvcGlhVGVzdG5ldDogKCkgPT4gb3B0b3BpYVRlc3RuZXQsCiAgICBvcmRlcmx5OiAoKSA9PiBvcmRlcmx5LAogICAgb3JkZXJseVNlcG9saWE6ICgpID0+IG9yZGVybHlTZXBvbGlhLAogICAgb3RpbURldm5ldDogKCkgPT4gb3RpbURldm5ldCwKICAgIHBhbG06ICgpID0+IHBhbG0sCiAgICBwYWxtVGVzdG5ldDogKCkgPT4gcGFsbVRlc3RuZXQsCiAgICBwZ246ICgpID0+IHBnbiwKICAgIHBnblRlc3RuZXQ6ICgpID0+IHBnblRlc3RuZXQsCiAgICBwaG9lbml4OiAoKSA9PiBwaG9lbml4LAogICAgcGxheWZpQWxiaXJlbzogKCkgPT4gcGxheWZpQWxiaXJlbywKICAgIHBsaW5nYTogKCkgPT4gcGxpbmdhLAogICAgcGx1bWVUZXN0bmV0OiAoKSA9PiBwbHVtZVRlc3RuZXQsCiAgICBwb2x5Z29uOiAoKSA9PiBwb2x5Z29uLAogICAgcG9seWdvbkFtb3k6ICgpID0+IHBvbHlnb25BbW95LAogICAgcG9seWdvbk11bWJhaTogKCkgPT4gcG9seWdvbk11bWJhaSwKICAgIHBvbHlnb25aa0V2bTogKCkgPT4gcG9seWdvblprRXZtLAogICAgcG9seWdvblprRXZtQ2FyZG9uYTogKCkgPT4gcG9seWdvblprRXZtQ2FyZG9uYSwKICAgIHBvbHlnb25aa0V2bVRlc3RuZXQ6ICgpID0+IHBvbHlnb25aa0V2bVRlc3RuZXQsCiAgICBwdWxzZWNoYWluOiAoKSA9PiBwdWxzZWNoYWluLAogICAgcHVsc2VjaGFpblY0OiAoKSA9PiBwdWxzZWNoYWluVjQsCiAgICBxTWFpbm5ldDogKCkgPT4gcU1haW5uZXQsCiAgICBxVGVzdG5ldDogKCkgPT4gcVRlc3RuZXQsCiAgICBxbDE6ICgpID0+IHFsMSwKICAgIHJlYWw6ICgpID0+IHJlYWwsCiAgICByZWRiZWxseVRlc3RuZXQ6ICgpID0+IHJlZGJlbGx5VGVzdG5ldCwKICAgIHJlZHN0b25lOiAoKSA9PiByZWRzdG9uZSwKICAgIHJleWFOZXR3b3JrOiAoKSA9PiByZXlhTmV0d29yaywKICAgIHJvbGx1eDogKCkgPT4gcm9sbHV4LAogICAgcm9sbHV4VGVzdG5ldDogKCkgPT4gcm9sbHV4VGVzdG5ldCwKICAgIHJvbmluOiAoKSA9PiByb25pbiwKICAgIHJvb3Q6ICgpID0+IHJvb3QsCiAgICByb290UG9yY2luaTogKCkgPT4gcm9vdFBvcmNpbmksCiAgICByb290c3RvY2s6ICgpID0+IHJvb3RzdG9jaywKICAgIHJvb3RzdG9ja1Rlc3RuZXQ6ICgpID0+IHJvb3RzdG9ja1Rlc3RuZXQsCiAgICByc3MzOiAoKSA9PiByc3MzLAogICAgcnNzM1NlcG9saWE6ICgpID0+IHJzczNTZXBvbGlhLAogICAgc2FpZ29uOiAoKSA9PiBzYWlnb24sCiAgICBzYW5rbzogKCkgPT4gc2Fua28sCiAgICBzYXBwaGlyZTogKCkgPT4gc2FwcGhpcmUsCiAgICBzYXBwaGlyZVRlc3RuZXQ6ICgpID0+IHNhcHBoaXJlVGVzdG5ldCwKICAgIHNhdG9zaGlWTTogKCkgPT4gc2F0b3NoaVZNLAogICAgc2F0b3NoaVZNVGVzdG5ldDogKCkgPT4gc2F0b3NoaVZNVGVzdG5ldCwKICAgIHNjcm9sbDogKCkgPT4gc2Nyb2xsLAogICAgc2Nyb2xsU2Vwb2xpYTogKCkgPT4gc2Nyb2xsU2Vwb2xpYSwKICAgIHNlaTogKCkgPT4gc2VpLAogICAgc2VpRGV2bmV0OiAoKSA9PiBzZWlEZXZuZXQsCiAgICBzZWlUZXN0bmV0OiAoKSA9PiBzZWlUZXN0bmV0LAogICAgc2Vwb2xpYTogKCkgPT4gc2Vwb2xpYSwKICAgIHNoYXBlOiAoKSA9PiBzaGFwZSwKICAgIHNoYXBlU2Vwb2xpYTogKCkgPT4gc2hhcGVTZXBvbGlhLAogICAgc2hhcmRldW1TcGhpbng6ICgpID0+IHNoYXJkZXVtU3BoaW54LAogICAgc2hpYmFyaXVtOiAoKSA9PiBzaGliYXJpdW0sCiAgICBzaGliYXJpdW1UZXN0bmV0OiAoKSA9PiBzaGliYXJpdW1UZXN0bmV0LAogICAgc2hpZGVuOiAoKSA9PiBzaGlkZW4sCiAgICBzaGltbWVyOiAoKSA9PiBzaGltbWVyLAogICAgc2hpbW1lclRlc3RuZXQ6ICgpID0+IHNoaW1tZXJUZXN0bmV0LAogICAgc2lsaWNvbjogKCkgPT4gc2lsaWNvbiwKICAgIHNpbGljb25TZXBvbGlhOiAoKSA9PiBzaWxpY29uU2Vwb2xpYSwKICAgIHNrYWxlQmxvY2tCcmF3bGVyczogKCkgPT4gc2thbGVCbG9ja0JyYXdsZXJzLAogICAgc2thbGVDYWx5cHNvOiAoKSA9PiBza2FsZUNhbHlwc28sCiAgICBza2FsZUNhbHlwc29UZXN0bmV0OiAoKSA9PiBza2FsZUNhbHlwc29UZXN0bmV0LAogICAgc2thbGVDcnlwdG9CbGFkZXM6ICgpID0+IHNrYWxlQ3J5cHRvQmxhZGVzLAogICAgc2thbGVDcnlwdG9Db2xvc3NldW06ICgpID0+IHNrYWxlQ3J5cHRvQ29sb3NzZXVtLAogICAgc2thbGVFdXJvcGE6ICgpID0+IHNrYWxlRXVyb3BhLAogICAgc2thbGVFdXJvcGFUZXN0bmV0OiAoKSA9PiBza2FsZUV1cm9wYVRlc3RuZXQsCiAgICBza2FsZUV4b3JkZTogKCkgPT4gc2thbGVFeG9yZGUsCiAgICBza2FsZUh1bWFuUHJvdG9jb2w6ICgpID0+IHNrYWxlSHVtYW5Qcm90b2NvbCwKICAgIHNrYWxlTmVidWxhOiAoKSA9PiBza2FsZU5lYnVsYSwKICAgIHNrYWxlTmVidWxhVGVzdG5ldDogKCkgPT4gc2thbGVOZWJ1bGFUZXN0bmV0LAogICAgc2thbGVSYXpvcjogKCkgPT4gc2thbGVSYXpvciwKICAgIHNrYWxlVGl0YW46ICgpID0+IHNrYWxlVGl0YW4sCiAgICBza2FsZVRpdGFuVGVzdG5ldDogKCkgPT4gc2thbGVUaXRhblRlc3RuZXQsCiAgICBza2V0Y2hwYWQ6ICgpID0+IHNrZXRjaHBhZCwKICAgIHNuYXg6ICgpID0+IHNuYXgsCiAgICBzbmF4VGVzdG5ldDogKCkgPT4gc25heFRlc3RuZXQsCiAgICBzb25laXVtTWluYXRvOiAoKSA9PiBzb25laXVtTWluYXRvLAogICAgc29uZ2JpcmQ6ICgpID0+IHNvbmdiaXJkLAogICAgc29uZ2JpcmRUZXN0bmV0OiAoKSA9PiBzb25nYmlyZFRlc3RuZXQsCiAgICBzb3Bob25UZXN0bmV0OiAoKSA9PiBzb3Bob25UZXN0bmV0LAogICAgc3BpY3k6ICgpID0+IHNwaWN5LAogICAgc3RlcDogKCkgPT4gc3RlcCwKICAgIHN0b3J5VGVzdG5ldDogKCkgPT4gc3RvcnlUZXN0bmV0LAogICAgc3RyYXRpczogKCkgPT4gc3RyYXRpcywKICAgIHN1cGVybHVtaW86ICgpID0+IHN1cGVybHVtaW8sCiAgICBzdXBlcnBvc2l0aW9uOiAoKSA9PiBzdXBlcnBvc2l0aW9uLAogICAgc3dhbjogKCkgPT4gc3dhbiwKICAgIHN3YW5Qcm94aW1hVGVzdG5ldDogKCkgPT4gc3dhblByb3hpbWFUZXN0bmV0LAogICAgc3dhblNhdHVyblRlc3RuZXQ6ICgpID0+IHN3YW5TYXR1cm5UZXN0bmV0LAogICAgc3lzY29pbjogKCkgPT4gc3lzY29pbiwKICAgIHN5c2NvaW5UZXN0bmV0OiAoKSA9PiBzeXNjb2luVGVzdG5ldCwKICAgIHRhaWtvOiAoKSA9PiB0YWlrbywKICAgIHRhaWtvSGVrbGE6ICgpID0+IHRhaWtvSGVrbGEsCiAgICB0YWlrb0pvbG5pcjogKCkgPT4gdGFpa29Kb2xuaXIsCiAgICB0YWlrb0thdGxhOiAoKSA9PiB0YWlrb0thdGxhLAogICAgdGFpa29UZXN0bmV0U2Vwb2xpYTogKCkgPT4gdGFpa29UZXN0bmV0U2Vwb2xpYSwKICAgIHRhcmF4YTogKCkgPT4gdGFyYXhhLAogICAgdGFyYXhhVGVzdG5ldDogKCkgPT4gdGFyYXhhVGVzdG5ldCwKICAgIHRlbGNvaW5UZXN0bmV0OiAoKSA9PiB0ZWxjb2luVGVzdG5ldCwKICAgIHRlbG9zOiAoKSA9PiB0ZWxvcywKICAgIHRlbG9zVGVzdG5ldDogKCkgPT4gdGVsb3NUZXN0bmV0LAogICAgdGVuZXQ6ICgpID0+IHRlbmV0LAogICAgdGhhaUNoYWluOiAoKSA9PiB0aGFpQ2hhaW4sCiAgICB0aHVuZGVyQ29yZTogKCkgPT4gdGh1bmRlckNvcmUsCiAgICB0aHVuZGVyVGVzdG5ldDogKCkgPT4gdGh1bmRlclRlc3RuZXQsCiAgICB0aWt0cml4VGVzdG5ldDogKCkgPT4gdGlrdHJpeFRlc3RuZXQsCiAgICB0cm9uOiAoKSA9PiB0cm9uLAogICAgdWx0cm9uOiAoKSA9PiB1bHRyb24sCiAgICB1bHRyb25UZXN0bmV0OiAoKSA9PiB1bHRyb25UZXN0bmV0LAogICAgdW5pY2hhaW5TZXBvbGlhOiAoKSA9PiB1bmljaGFpblNlcG9saWEsCiAgICB1bmlxdWU6ICgpID0+IHVuaXF1ZSwKICAgIHVuaXF1ZU9wYWw6ICgpID0+IHVuaXF1ZU9wYWwsCiAgICB1bmlxdWVRdWFydHo6ICgpID0+IHVuaXF1ZVF1YXJ0eiwKICAgIHVucmVhbDogKCkgPT4gdW5yZWFsLAogICAgdmVjaGFpbjogKCkgPT4gdmVjaGFpbiwKICAgIHZlbGFzOiAoKSA9PiB2ZWxhcywKICAgIHZpY3Rpb246ICgpID0+IHZpY3Rpb24sCiAgICB2aWN0aW9uVGVzdG5ldDogKCkgPT4gdmljdGlvblRlc3RuZXQsCiAgICB2aXNpb246ICgpID0+IHZpc2lvbiwKICAgIHZpc2lvblRlc3RuZXQ6ICgpID0+IHZpc2lvblRlc3RuZXQsCiAgICB3YW5jaGFpbjogKCkgPT4gd2FuY2hhaW4sCiAgICB3YW5jaGFpblRlc3RuZXQ6ICgpID0+IHdhbmNoYWluVGVzdG5ldCwKICAgIHdlYXZlVk1BbHBoYW5ldDogKCkgPT4gd2VhdmVWTUFscGhhbmV0LAogICAgd2VtaXg6ICgpID0+IHdlbWl4LAogICAgd2VtaXhUZXN0bmV0OiAoKSA9PiB3ZW1peFRlc3RuZXQsCiAgICB3b3JsZGNoYWluOiAoKSA9PiB3b3JsZGNoYWluLAogICAgd29ybGRjaGFpblNlcG9saWE6ICgpID0+IHdvcmxkY2hhaW5TZXBvbGlhLAogICAgeDFUZXN0bmV0OiAoKSA9PiB4TGF5ZXJUZXN0bmV0LAogICAgeExheWVyOiAoKSA9PiB4TGF5ZXIsCiAgICB4TGF5ZXJUZXN0bmV0OiAoKSA9PiB4TGF5ZXJUZXN0bmV0LAogICAgeGFpOiAoKSA9PiB4YWksCiAgICB4YWlUZXN0bmV0OiAoKSA9PiB4YWlUZXN0bmV0LAogICAgeGRjOiAoKSA9PiB4ZGMsCiAgICB4ZGNUZXN0bmV0OiAoKSA9PiB4ZGNUZXN0bmV0LAogICAgeHJTZXBvbGlhOiAoKSA9PiB4clNlcG9saWEsCiAgICB5b29sZG9WZXJzZTogKCkgPT4geW9vbGRvVmVyc2UsCiAgICB5b29sZG9WZXJzZVRlc3RuZXQ6ICgpID0+IHlvb2xkb1ZlcnNlVGVzdG5ldCwKICAgIHplbmNoYWluVGVzdG5ldDogKCkgPT4gemVuY2hhaW5UZXN0bmV0LAogICAgemV0YWNoYWluOiAoKSA9PiB6ZXRhY2hhaW4sCiAgICB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0OiAoKSA9PiB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0LAogICAgemhlamlhbmc6ICgpID0+IHpoZWppYW5nLAogICAgemlsbGlxYTogKCkgPT4gemlsbGlxYSwKICAgIHppbGxpcWFUZXN0bmV0OiAoKSA9PiB6aWxsaXFhVGVzdG5ldCwKICAgIHppcmN1aXQ6ICgpID0+IHppcmN1aXQsCiAgICB6aXJjdWl0VGVzdG5ldDogKCkgPT4gemlyY3VpdFRlc3RuZXQsCiAgICB6a0ZhaXI6ICgpID0+IHprRmFpciwKICAgIHprRmFpclRlc3RuZXQ6ICgpID0+IHprRmFpclRlc3RuZXQsCiAgICB6a0xpbmtOb3ZhOiAoKSA9PiB6a0xpbmtOb3ZhLAogICAgemtMaW5rTm92YVNlcG9saWFUZXN0bmV0OiAoKSA9PiB6a0xpbmtOb3ZhU2Vwb2xpYVRlc3RuZXQsCiAgICB6a1N5bmM6ICgpID0+IHprc3luYywKICAgIHprU3luY0luTWVtb3J5Tm9kZTogKCkgPT4gemtzeW5jSW5NZW1vcnlOb2RlLAogICAgemtTeW5jTG9jYWxOb2RlOiAoKSA9PiB6a3N5bmNMb2NhbE5vZGUsCiAgICB6a1N5bmNTZXBvbGlhVGVzdG5ldDogKCkgPT4gemtzeW5jU2Vwb2xpYVRlc3RuZXQsCiAgICB6a3N5bmM6ICgpID0+IHprc3luYywKICAgIHprc3luY0luTWVtb3J5Tm9kZTogKCkgPT4gemtzeW5jSW5NZW1vcnlOb2RlLAogICAgemtzeW5jTG9jYWxOb2RlOiAoKSA9PiB6a3N5bmNMb2NhbE5vZGUsCiAgICB6a3N5bmNTZXBvbGlhVGVzdG5ldDogKCkgPT4gemtzeW5jU2Vwb2xpYVRlc3RuZXQsCiAgICB6b3JhOiAoKSA9PiB6b3JhLAogICAgem9yYVNlcG9saWE6ICgpID0+IHpvcmFTZXBvbGlhLAogICAgem9yYVRlc3RuZXQ6ICgpID0+IHpvcmFUZXN0bmV0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZm9ybWF0dGVycy5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdG9CeXRlcygpOwogIGluaXRfdG9IZXgoKTsKICBpbml0X3RyYW5zYWN0aW9uUmVxdWVzdCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2NvbnN0YW50cy9udW1iZXIuanMKICBpbml0X251bWJlcigpOwogIHZhciBnYXNQZXJQdWJkYXRhRGVmYXVsdCA9IDUwMDAwbjsKICB2YXIgbWF4Qnl0ZWNvZGVTaXplID0gbWF4VWludDE2ICogMzJuOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2Zvcm1hdHRlcnMuanMKICB2YXIgZm9ybWF0dGVycyA9IHsKICAgIGJsb2NrOiAvKiBAX19QVVJFX18gKi8gZGVmaW5lQmxvY2soewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGFyZ3MudHJhbnNhY3Rpb25zPy5tYXAoKHRyYW5zYWN0aW9uKSA9PiB7CiAgICAgICAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uID09PSAic3RyaW5nIikKICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uOwogICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gZm9ybWF0dGVycy50cmFuc2FjdGlvbj8uZm9ybWF0KHRyYW5zYWN0aW9uKTsKICAgICAgICAgIGlmIChmb3JtYXR0ZWQudHlwZUhleCA9PT0gIjB4NzEiKQogICAgICAgICAgICBmb3JtYXR0ZWQudHlwZSA9ICJlaXA3MTIiOwogICAgICAgICAgZWxzZSBpZiAoZm9ybWF0dGVkLnR5cGVIZXggPT09ICIweGZmIikKICAgICAgICAgICAgZm9ybWF0dGVkLnR5cGUgPSAicHJpb3JpdHkiOwogICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbDFCYXRjaE51bWJlcjogYXJncy5sMUJhdGNoTnVtYmVyID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoTnVtYmVyKSA6IG51bGwsCiAgICAgICAgICBsMUJhdGNoVGltZXN0YW1wOiBhcmdzLmwxQmF0Y2hUaW1lc3RhbXAgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hUaW1lc3RhbXApIDogbnVsbCwKICAgICAgICAgIHRyYW5zYWN0aW9ucwogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb246IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvbih7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7fTsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3MSIpCiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImVpcDcxMiI7CiAgICAgICAgZWxzZSBpZiAoYXJncy50eXBlID09PSAiMHhmZiIpCiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gInByaW9yaXR5IjsKICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBhcmdzLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hOdW1iZXIpIDogbnVsbCwKICAgICAgICAgIGwxQmF0Y2hUeEluZGV4OiBhcmdzLmwxQmF0Y2hUeEluZGV4ID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoVHhJbmRleCkgOiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlY2VpcHQ6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlY2VpcHQoewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsMUJhdGNoTnVtYmVyOiBhcmdzLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChhcmdzLmwxQmF0Y2hOdW1iZXIpIDogbnVsbCwKICAgICAgICAgIGwxQmF0Y2hUeEluZGV4OiBhcmdzLmwxQmF0Y2hUeEluZGV4ID8gaGV4VG9CaWdJbnQoYXJncy5sMUJhdGNoVHhJbmRleCkgOiBudWxsLAogICAgICAgICAgbG9nczogYXJncy5sb2dzLm1hcCgobG9nKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgLi4uZm9ybWF0TG9nKGxvZyksCiAgICAgICAgICAgICAgbDFCYXRjaE51bWJlcjogbG9nLmwxQmF0Y2hOdW1iZXIgPyBoZXhUb0JpZ0ludChsb2cubDFCYXRjaE51bWJlcikgOiBudWxsLAogICAgICAgICAgICAgIHRyYW5zYWN0aW9uTG9nSW5kZXg6IGhleFRvTnVtYmVyKGxvZy50cmFuc2FjdGlvbkxvZ0luZGV4KSwKICAgICAgICAgICAgICBsb2dUeXBlOiBsb2cubG9nVHlwZQogICAgICAgICAgICB9OwogICAgICAgICAgfSksCiAgICAgICAgICBsMlRvTDFMb2dzOiBhcmdzLmwyVG9MMUxvZ3MubWFwKChsMlRvTDFMb2cpID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBibG9ja051bWJlcjogaGV4VG9CaWdJbnQobDJUb0wxTG9nLmJsb2NrSGFzaCksCiAgICAgICAgICAgICAgYmxvY2tIYXNoOiBsMlRvTDFMb2cuYmxvY2tIYXNoLAogICAgICAgICAgICAgIGwxQmF0Y2hOdW1iZXI6IGhleFRvQmlnSW50KGwyVG9MMUxvZy5sMUJhdGNoTnVtYmVyKSwKICAgICAgICAgICAgICB0cmFuc2FjdGlvbkluZGV4OiBoZXhUb0JpZ0ludChsMlRvTDFMb2cudHJhbnNhY3Rpb25JbmRleCksCiAgICAgICAgICAgICAgc2hhcmRJZDogaGV4VG9CaWdJbnQobDJUb0wxTG9nLnNoYXJkSWQpLAogICAgICAgICAgICAgIGlzU2VydmljZTogbDJUb0wxTG9nLmlzU2VydmljZSwKICAgICAgICAgICAgICBzZW5kZXI6IGwyVG9MMUxvZy5zZW5kZXIsCiAgICAgICAgICAgICAga2V5OiBsMlRvTDFMb2cua2V5LAogICAgICAgICAgICAgIHZhbHVlOiBsMlRvTDFMb2cudmFsdWUsCiAgICAgICAgICAgICAgdHJhbnNhY3Rpb25IYXNoOiBsMlRvTDFMb2cudHJhbnNhY3Rpb25IYXNoLAogICAgICAgICAgICAgIGxvZ0luZGV4OiBoZXhUb0JpZ0ludChsMlRvTDFMb2cubG9nSW5kZXgpCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KQogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb25SZXF1ZXN0OiAvKiBAX19QVVJFX18gKi8gZGVmaW5lVHJhbnNhY3Rpb25SZXF1ZXN0KHsKICAgICAgZXhjbHVkZTogWwogICAgICAgICJjdXN0b21TaWduYXR1cmUiLAogICAgICAgICJmYWN0b3J5RGVwcyIsCiAgICAgICAgImdhc1BlclB1YmRhdGEiLAogICAgICAgICJwYXltYXN0ZXIiLAogICAgICAgICJwYXltYXN0ZXJJbnB1dCIKICAgICAgXSwKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy5nYXNQZXJQdWJkYXRhIHx8IGFyZ3MucGF5bWFzdGVyICYmIGFyZ3MucGF5bWFzdGVySW5wdXQgfHwgYXJncy5mYWN0b3J5RGVwcyB8fCBhcmdzLmN1c3RvbVNpZ25hdHVyZSkKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGVpcDcxMk1ldGE6IHsKICAgICAgICAgICAgICAuLi5hcmdzLmdhc1BlclB1YmRhdGEgPyB7IGdhc1BlclB1YmRhdGE6IHRvSGV4KGFyZ3MuZ2FzUGVyUHViZGF0YSkgfSA6IHsgZ2FzUGVyUHViZGF0YTogdG9IZXgoZ2FzUGVyUHViZGF0YURlZmF1bHQpIH0sCiAgICAgICAgICAgICAgLi4uYXJncy5wYXltYXN0ZXIgJiYgYXJncy5wYXltYXN0ZXJJbnB1dCA/IHsKICAgICAgICAgICAgICAgIHBheW1hc3RlclBhcmFtczogewogICAgICAgICAgICAgICAgICBwYXltYXN0ZXI6IGFyZ3MucGF5bWFzdGVyLAogICAgICAgICAgICAgICAgICBwYXltYXN0ZXJJbnB1dDogQXJyYXkuZnJvbShoZXhUb0J5dGVzKGFyZ3MucGF5bWFzdGVySW5wdXQpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gOiB7fSwKICAgICAgICAgICAgICAuLi5hcmdzLmZhY3RvcnlEZXBzID8gewogICAgICAgICAgICAgICAgZmFjdG9yeURlcHM6IGFyZ3MuZmFjdG9yeURlcHMubWFwKChkZXApID0+IEFycmF5LmZyb20oaGV4VG9CeXRlcyhkZXApKSkKICAgICAgICAgICAgICB9IDoge30sCiAgICAgICAgICAgICAgLi4uYXJncy5jdXN0b21TaWduYXR1cmUgPyB7CiAgICAgICAgICAgICAgICBjdXN0b21TaWduYXR1cmU6IEFycmF5LmZyb20oaGV4VG9CeXRlcyhhcmdzLmN1c3RvbVNpZ25hdHVyZSkpCiAgICAgICAgICAgICAgfSA6IHt9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHR5cGU6ICIweDcxIgogICAgICAgICAgfTsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0pCiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy9zZXJpYWxpemVycy5qcwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0hleCgpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2Fzc2VydEVpcDcxMlRyYW5zYWN0aW9uLmpzCiAgaW5pdF9hZGRyZXNzKCk7CiAgaW5pdF9iYXNlKCk7CiAgaW5pdF9jaGFpbigpOwogIGluaXRfaXNBZGRyZXNzKCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvZXJyb3JzL3RyYW5zYWN0aW9uLmpzCiAgaW5pdF9iYXNlKCk7CiAgdmFyIEludmFsaWRFaXA3MTJUcmFuc2FjdGlvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBCYXNlRXJyb3IyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcihbCiAgICAgICAgIlRyYW5zYWN0aW9uIGlzIG5vdCBhbiBFSVA3MTIgdHJhbnNhY3Rpb24uIiwKICAgICAgICAiIiwKICAgICAgICAiVHJhbnNhY3Rpb24gbXVzdDoiLAogICAgICAgICcgIC0gaW5jbHVkZSBgdHlwZTogImVpcDcxMiJgJywKICAgICAgICAiICAtIGluY2x1ZGUgb25lIG9mIHRoZSBmb2xsb3dpbmc6IGBjdXN0b21TaWduYXR1cmVgLCBgcGF5bWFzdGVyYCwgYHBheW1hc3RlcklucHV0YCwgYGdhc1BlclB1YmRhdGFgLCBgZmFjdG9yeURlcHNgIgogICAgICBdLmpvaW4oIlxuIiksIHsgbmFtZTogIkludmFsaWRFaXA3MTJUcmFuc2FjdGlvbkVycm9yIiB9KTsKICAgIH0KICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2lzRWlwNzEyVHJhbnNhY3Rpb24uanMKICBmdW5jdGlvbiBpc0VJUDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImVpcDcxMiIpCiAgICAgIHJldHVybiB0cnVlOwogICAgaWYgKCJjdXN0b21TaWduYXR1cmUiIGluIHRyYW5zYWN0aW9uICYmIHRyYW5zYWN0aW9uLmN1c3RvbVNpZ25hdHVyZSB8fCAicGF5bWFzdGVyIiBpbiB0cmFuc2FjdGlvbiAmJiB0cmFuc2FjdGlvbi5wYXltYXN0ZXIgfHwgInBheW1hc3RlcklucHV0IiBpbiB0cmFuc2FjdGlvbiAmJiB0cmFuc2FjdGlvbi5wYXltYXN0ZXJJbnB1dCB8fCAiZ2FzUGVyUHViZGF0YSIgaW4gdHJhbnNhY3Rpb24gJiYgdHlwZW9mIHRyYW5zYWN0aW9uLmdhc1BlclB1YmRhdGEgPT09ICJiaWdpbnQiIHx8ICJmYWN0b3J5RGVwcyIgaW4gdHJhbnNhY3Rpb24gJiYgdHJhbnNhY3Rpb24uZmFjdG9yeURlcHMpCiAgICAgIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9hc3NlcnRFaXA3MTJUcmFuc2FjdGlvbi5qcwogIGZ1bmN0aW9uIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGNoYWluSWQsIHRvLCBmcm9tLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0IH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmICghaXNFSVA3MTJUcmFuc2FjdGlvbih0cmFuc2FjdGlvbikpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkRWlwNzEyVHJhbnNhY3Rpb25FcnJvcigpOwogICAgaWYgKCFjaGFpbklkIHx8IGNoYWluSWQgPD0gMCkKICAgICAgdGhyb3cgbmV3IEludmFsaWRDaGFpbklkRXJyb3IoeyBjaGFpbklkIH0pOwogICAgaWYgKHRvICYmICFpc0FkZHJlc3ModG8pKQogICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHRvIH0pOwogICAgaWYgKGZyb20gJiYgIWlzQWRkcmVzcyhmcm9tKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBmcm9tIH0pOwogICAgaWYgKHBheW1hc3RlciAmJiAhaXNBZGRyZXNzKHBheW1hc3RlcikpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogcGF5bWFzdGVyIH0pOwogICAgaWYgKHBheW1hc3RlciAmJiAhcGF5bWFzdGVySW5wdXQpIHsKICAgICAgdGhyb3cgbmV3IEJhc2VFcnJvcjIoImBwYXltYXN0ZXJJbnB1dGAgbXVzdCBiZSBwcm92aWRlZCB3aGVuIGBwYXltYXN0ZXJgIGlzIGRlZmluZWQiKTsKICAgIH0KICAgIGlmICghcGF5bWFzdGVyICYmIHBheW1hc3RlcklucHV0KSB7CiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgcGF5bWFzdGVyYCBtdXN0IGJlIHByb3ZpZGVkIHdoZW4gYHBheW1hc3RlcklucHV0YCBpcyBkZWZpbmVkIik7CiAgICB9CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3NlcmlhbGl6ZXJzLmpzCiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb24yKHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGlmIChpc0VJUDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSkKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRUlQNzEyKHRyYW5zYWN0aW9uKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CiAgdmFyIHNlcmlhbGl6ZXJzID0gewogICAgdHJhbnNhY3Rpb246IHNlcmlhbGl6ZVRyYW5zYWN0aW9uMgogIH07CiAgZnVuY3Rpb24gc2VyaWFsaXplVHJhbnNhY3Rpb25FSVA3MTIodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgZ2FzLCBub25jZSwgdG8sIGZyb20sIHZhbHVlLCBtYXhGZWVQZXJHYXMsIG1heFByaW9yaXR5RmVlUGVyR2FzLCBjdXN0b21TaWduYXR1cmUsIGZhY3RvcnlEZXBzLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0LCBnYXNQZXJQdWJkYXRhLCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgbm9uY2UgPyB0b0hleChub25jZSkgOiAiMHgiLAogICAgICBtYXhQcmlvcml0eUZlZVBlckdhcyA/IHRvSGV4KG1heFByaW9yaXR5RmVlUGVyR2FzKSA6ICIweCIsCiAgICAgIG1heEZlZVBlckdhcyA/IHRvSGV4KG1heEZlZVBlckdhcykgOiAiMHgiLAogICAgICBnYXMgPyB0b0hleChnYXMpIDogIjB4IiwKICAgICAgdG8gPz8gIjB4IiwKICAgICAgdmFsdWUgPyB0b0hleCh2YWx1ZSkgOiAiMHgiLAogICAgICBkYXRhID8/ICIweDAiLAogICAgICB0b0hleChjaGFpbklkKSwKICAgICAgdG9IZXgoIiIpLAogICAgICB0b0hleCgiIiksCiAgICAgIHRvSGV4KGNoYWluSWQpLAogICAgICBmcm9tID8/ICIweCIsCiAgICAgIGdhc1BlclB1YmRhdGEgPyB0b0hleChnYXNQZXJQdWJkYXRhKSA6IHRvSGV4KGdhc1BlclB1YmRhdGFEZWZhdWx0KSwKICAgICAgZmFjdG9yeURlcHMgPz8gW10sCiAgICAgIGN1c3RvbVNpZ25hdHVyZSA/PyAiMHgiLAogICAgICAvLyBFSVA3MTIgc2lnbmF0dXJlCiAgICAgIHBheW1hc3RlciAmJiBwYXltYXN0ZXJJbnB1dCA/IFtwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0XSA6IFtdCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDcxIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL3V0aWxzL2dldEVpcDcxMkRvbWFpbi5qcwogIGluaXRfdG9IZXgoKTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL3prc3luYy91dGlscy9oYXNoQnl0ZWNvZGUuanMKICBpbml0X3BhZCgpOwogIGluaXRfdG9CeXRlcygpOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vemtzeW5jL2Vycm9ycy9ieXRlY29kZS5qcwogIGluaXRfYmFzZSgpOwogIHZhciBCeXRlY29kZUxlbmd0aEV4Y2VlZHNNYXhTaXplRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBnaXZlbkxlbmd0aCwgbWF4Qnl0ZWNvZGVTaXplOiBtYXhCeXRlY29kZVNpemUyIH0pIHsKICAgICAgc3VwZXIoYEJ5dGVjb2RlIGNhbm5vdCBiZSBsb25nZXIgdGhhbiAke21heEJ5dGVjb2RlU2l6ZTJ9IGJ5dGVzLiBHaXZlbiBsZW5ndGg6ICR7Z2l2ZW5MZW5ndGh9YCwgeyBuYW1lOiAiQnl0ZWNvZGVMZW5ndGhFeGNlZWRzTWF4U2l6ZUVycm9yIiB9KTsKICAgIH0KICB9OwogIHZhciBCeXRlY29kZUxlbmd0aEluV29yZHNNdXN0QmVPZGRFcnJvciA9IGNsYXNzIGV4dGVuZHMgQmFzZUVycm9yMiB7CiAgICBjb25zdHJ1Y3Rvcih7IGdpdmVuTGVuZ3RoSW5Xb3JkcyB9KSB7CiAgICAgIHN1cGVyKGBCeXRlY29kZSBsZW5ndGggaW4gMzItYnl0ZSB3b3JkcyBtdXN0IGJlIG9kZC4gR2l2ZW4gbGVuZ3RoIGluIHdvcmRzOiAke2dpdmVuTGVuZ3RoSW5Xb3Jkc31gLCB7IG5hbWU6ICJCeXRlY29kZUxlbmd0aEluV29yZHNNdXN0QmVPZGRFcnJvciIgfSk7CiAgICB9CiAgfTsKICB2YXIgQnl0ZWNvZGVMZW5ndGhNdXN0QmVEaXZpc2libGVCeTMyRXJyb3IgPSBjbGFzcyBleHRlbmRzIEJhc2VFcnJvcjIgewogICAgY29uc3RydWN0b3IoeyBnaXZlbkxlbmd0aCB9KSB7CiAgICAgIHN1cGVyKGBUaGUgYnl0ZWNvZGUgbGVuZ3RoIGluIGJ5dGVzIG11c3QgYmUgZGl2aXNpYmxlIGJ5IDMyLiBHaXZlbiBsZW5ndGg6ICR7Z2l2ZW5MZW5ndGh9YCwgeyBuYW1lOiAiQnl0ZWNvZGVMZW5ndGhNdXN0QmVEaXZpc2libGVCeTMyRXJyb3IiIH0pOwogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvaGFzaEJ5dGVjb2RlLmpzCiAgZnVuY3Rpb24gaGFzaEJ5dGVjb2RlKGJ5dGVjb2RlKSB7CiAgICBjb25zdCBieXRlY29kZUJ5dGVzID0gdG9CeXRlcyhieXRlY29kZSk7CiAgICBpZiAoYnl0ZWNvZGVCeXRlcy5sZW5ndGggJSAzMiAhPT0gMCkKICAgICAgdGhyb3cgbmV3IEJ5dGVjb2RlTGVuZ3RoTXVzdEJlRGl2aXNpYmxlQnkzMkVycm9yKHsKICAgICAgICBnaXZlbkxlbmd0aDogYnl0ZWNvZGVCeXRlcy5sZW5ndGgKICAgICAgfSk7CiAgICBpZiAoYnl0ZWNvZGVCeXRlcy5sZW5ndGggPiBtYXhCeXRlY29kZVNpemUpCiAgICAgIHRocm93IG5ldyBCeXRlY29kZUxlbmd0aEV4Y2VlZHNNYXhTaXplRXJyb3IoewogICAgICAgIGdpdmVuTGVuZ3RoOiBieXRlY29kZUJ5dGVzLmxlbmd0aCwKICAgICAgICBtYXhCeXRlY29kZVNpemUKICAgICAgfSk7CiAgICBjb25zdCBoYXNoU3RyID0gc2hhMjU2MihieXRlY29kZUJ5dGVzKTsKICAgIGNvbnN0IGhhc2gzID0gdG9CeXRlcyhoYXNoU3RyKTsKICAgIGNvbnN0IGJ5dGVjb2RlTGVuZ3RoSW5Xb3JkcyA9IGJ5dGVjb2RlQnl0ZXMubGVuZ3RoIC8gMzI7CiAgICBpZiAoYnl0ZWNvZGVMZW5ndGhJbldvcmRzICUgMiA9PT0gMCkgewogICAgICB0aHJvdyBuZXcgQnl0ZWNvZGVMZW5ndGhJbldvcmRzTXVzdEJlT2RkRXJyb3IoewogICAgICAgIGdpdmVuTGVuZ3RoSW5Xb3JkczogYnl0ZWNvZGVMZW5ndGhJbldvcmRzCiAgICAgIH0pOwogICAgfQogICAgY29uc3QgYnl0ZWNvZGVMZW5ndGggPSB0b0J5dGVzKGJ5dGVjb2RlTGVuZ3RoSW5Xb3Jkcyk7CiAgICBjb25zdCBieXRlY29kZUxlbmd0aFBhZGRlZCA9IHBhZChieXRlY29kZUxlbmd0aCwgeyBzaXplOiAyIH0pOwogICAgY29uc3QgY29kZUhhc2hWZXJzaW9uID0gbmV3IFVpbnQ4QXJyYXkoWzEsIDBdKTsKICAgIGhhc2gzLnNldChjb2RlSGFzaFZlcnNpb24sIDApOwogICAgaGFzaDMuc2V0KGJ5dGVjb2RlTGVuZ3RoUGFkZGVkLCAyKTsKICAgIHJldHVybiBoYXNoMzsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvdXRpbHMvZ2V0RWlwNzEyRG9tYWluLmpzCiAgdmFyIGdldEVpcDcxMkRvbWFpbjIgPSAodHJhbnNhY3Rpb24pID0+IHsKICAgIGFzc2VydEVpcDcxMlRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTsKICAgIGNvbnN0IG1lc3NhZ2UgPSB0cmFuc2FjdGlvblRvTWVzc2FnZSh0cmFuc2FjdGlvbik7CiAgICByZXR1cm4gewogICAgICBkb21haW46IHsKICAgICAgICBuYW1lOiAiemtTeW5jIiwKICAgICAgICB2ZXJzaW9uOiAiMiIsCiAgICAgICAgY2hhaW5JZDogdHJhbnNhY3Rpb24uY2hhaW5JZAogICAgICB9LAogICAgICB0eXBlczogewogICAgICAgIFRyYW5zYWN0aW9uOiBbCiAgICAgICAgICB7IG5hbWU6ICJ0eFR5cGUiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogImZyb20iLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogInRvIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJnYXNMaW1pdCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAiZ2FzUGVyUHViZGF0YUJ5dGVMaW1pdCIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAibWF4RmVlUGVyR2FzIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJtYXhQcmlvcml0eUZlZVBlckdhcyIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAicGF5bWFzdGVyIiwgdHlwZTogInVpbnQyNTYiIH0sCiAgICAgICAgICB7IG5hbWU6ICJub25jZSIsIHR5cGU6ICJ1aW50MjU2IiB9LAogICAgICAgICAgeyBuYW1lOiAidmFsdWUiLCB0eXBlOiAidWludDI1NiIgfSwKICAgICAgICAgIHsgbmFtZTogImRhdGEiLCB0eXBlOiAiYnl0ZXMiIH0sCiAgICAgICAgICB7IG5hbWU6ICJmYWN0b3J5RGVwcyIsIHR5cGU6ICJieXRlczMyW10iIH0sCiAgICAgICAgICB7IG5hbWU6ICJwYXltYXN0ZXJJbnB1dCIsIHR5cGU6ICJieXRlcyIgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgcHJpbWFyeVR5cGU6ICJUcmFuc2FjdGlvbiIsCiAgICAgIG1lc3NhZ2UKICAgIH07CiAgfTsKICBmdW5jdGlvbiB0cmFuc2FjdGlvblRvTWVzc2FnZSh0cmFuc2FjdGlvbikgewogICAgY29uc3QgeyBnYXMsIG5vbmNlLCB0bywgZnJvbSwgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGZhY3RvcnlEZXBzLCBwYXltYXN0ZXIsIHBheW1hc3RlcklucHV0LCBnYXNQZXJQdWJkYXRhLCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIHJldHVybiB7CiAgICAgIHR4VHlwZTogMTEzbiwKICAgICAgZnJvbTogQmlnSW50KGZyb20pLAogICAgICB0bzogdG8gPyBCaWdJbnQodG8pIDogMG4sCiAgICAgIGdhc0xpbWl0OiBnYXMgPz8gMG4sCiAgICAgIGdhc1BlclB1YmRhdGFCeXRlTGltaXQ6IGdhc1BlclB1YmRhdGEgPz8gZ2FzUGVyUHViZGF0YURlZmF1bHQsCiAgICAgIG1heEZlZVBlckdhczogbWF4RmVlUGVyR2FzID8/IDBuLAogICAgICBtYXhQcmlvcml0eUZlZVBlckdhczogbWF4UHJpb3JpdHlGZWVQZXJHYXMgPz8gMG4sCiAgICAgIHBheW1hc3RlcjogcGF5bWFzdGVyID8gQmlnSW50KHBheW1hc3RlcikgOiAwbiwKICAgICAgbm9uY2U6IG5vbmNlID8gQmlnSW50KG5vbmNlKSA6IDBuLAogICAgICB2YWx1ZTogdmFsdWUgPz8gMG4sCiAgICAgIGRhdGE6IGRhdGEgPyBkYXRhIDogIjB4MCIsCiAgICAgIGZhY3RvcnlEZXBzOiBmYWN0b3J5RGVwcz8ubWFwKChkZXApID0+IHRvSGV4KGhhc2hCeXRlY29kZShkZXApKSkgPz8gW10sCiAgICAgIHBheW1hc3RlcklucHV0OiBwYXltYXN0ZXJJbnB1dCA/IHBheW1hc3RlcklucHV0IDogIjB4IgogICAgfTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS96a3N5bmMvY2hhaW5Db25maWcuanMKICB2YXIgY2hhaW5Db25maWcgPSB7CiAgICBmb3JtYXR0ZXJzLAogICAgc2VyaWFsaXplcnMsCiAgICBjdXN0b206IHsKICAgICAgZ2V0RWlwNzEyRG9tYWluOiBnZXRFaXA3MTJEb21haW4yCiAgICB9CiAgfTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hYnN0cmFjdFRlc3RuZXQuanMKICB2YXIgYWJzdHJhY3RUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDExMTI0LAogICAgbmFtZTogIkFic3RyYWN0IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRVRIIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLnRlc3RuZXQuYWJzLnh5eiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFic3RyYWN0IEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuYWJzLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEY5Y2RhNjI0RkJDN2UwNTkzNTVjZTk4YTMxNjkzZDI5OUZBQ2Q5NjMiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzU4MzQ5CiAgICAgIH0sCiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZkI2ODgzMzAzNzk5NzZEQTgxZUI2NEZlNEJGNTBkNzQwMTc2M0I5QyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MzE2ODIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FjYWxhLmpzCiAgdmFyIGFjYWxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3ODcsCiAgICBuYW1lOiAiQWNhbGEiLAogICAgbmV0d29yazogImFjYWxhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBY2FsYSIsCiAgICAgIHN5bWJvbDogIkFDQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgtcnBjLWFjYWxhLmFjYS1hcGkubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ldGgtcnBjLWFjYWxhLmFjYS1hcGkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFjYWxhIEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5hY2FsYS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuYWNhbGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FsaWVuWC5qcwogIHZhciBhbGllbnggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjQxMDI0LAogICAgbmFtZTogIkFsaWVuWCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuYWxpZW54Y2hhaW4uaW8vaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFsaWVuWCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5hbGllbnhjaGFpbi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYWxpZW5YSGFsVGVzdG5ldC5qcwogIHZhciBhbGllbnhIYWxUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDI0MTAyNSwKICAgIG5hbWU6ICJBTElFTlggSGFsIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2hhbC1ycGMuYWxpZW54Y2hhaW4uaW8vaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFsaWVuWCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYWwtZXhwbG9yZXIuYWxpZW54Y2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9jb250cmFjdHMuanMKICB2YXIgY29udHJhY3RzID0gewogICAgZ2FzUHJpY2VPcmFjbGU6IHsgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwRiIgfSwKICAgIGwxQmxvY2s6IHsgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxNSIgfSwKICAgIGwyQ3Jvc3NEb21haW5NZXNzZW5nZXI6IHsKICAgICAgYWRkcmVzczogIjB4NDIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwNyIKICAgIH0sCiAgICBsMkVyYzcyMUJyaWRnZTogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDE0IiB9LAogICAgbDJTdGFuZGFyZEJyaWRnZTogeyBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwIiB9LAogICAgbDJUb0wxTWVzc2FnZVBhc3NlcjogewogICAgICBhZGRyZXNzOiAiMHg0MjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDE2IgogICAgfQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9mb3JtYXR0ZXJzLmpzCiAgaW5pdF9mcm9tSGV4KCk7CiAgdmFyIGZvcm1hdHRlcnMyID0gewogICAgYmxvY2s6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVCbG9jayh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXJncy50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24gPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7CiAgICAgICAgICBpZiAoZm9ybWF0dGVkLnR5cGVIZXggPT09ICIweDdlIikgewogICAgICAgICAgICBmb3JtYXR0ZWQuaXNTeXN0ZW1UeCA9IHRyYW5zYWN0aW9uLmlzU3lzdGVtVHg7CiAgICAgICAgICAgIGZvcm1hdHRlZC5taW50ID0gdHJhbnNhY3Rpb24ubWludCA/IGhleFRvQmlnSW50KHRyYW5zYWN0aW9uLm1pbnQpIDogdm9pZCAwOwogICAgICAgICAgICBmb3JtYXR0ZWQuc291cmNlSGFzaCA9IHRyYW5zYWN0aW9uLnNvdXJjZUhhc2g7CiAgICAgICAgICAgIGZvcm1hdHRlZC50eXBlID0gImRlcG9zaXQiOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdHJhbnNhY3Rpb25zLAogICAgICAgICAgc3RhdGVSb290OiBhcmdzLnN0YXRlUm9vdAogICAgICAgIH07CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb246IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvbih7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB7fTsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3ZSIpIHsKICAgICAgICAgIHRyYW5zYWN0aW9uLmlzU3lzdGVtVHggPSBhcmdzLmlzU3lzdGVtVHg7CiAgICAgICAgICB0cmFuc2FjdGlvbi5taW50ID0gYXJncy5taW50ID8gaGV4VG9CaWdJbnQoYXJncy5taW50KSA6IHZvaWQgMDsKICAgICAgICAgIHRyYW5zYWN0aW9uLnNvdXJjZUhhc2ggPSBhcmdzLnNvdXJjZUhhc2g7CiAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImRlcG9zaXQiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgIH0KICAgIH0pLAogICAgdHJhbnNhY3Rpb25SZWNlaXB0OiAvKiBAX19QVVJFX18gKi8gZGVmaW5lVHJhbnNhY3Rpb25SZWNlaXB0KHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbDFHYXNQcmljZTogYXJncy5sMUdhc1ByaWNlID8gaGV4VG9CaWdJbnQoYXJncy5sMUdhc1ByaWNlKSA6IG51bGwsCiAgICAgICAgICBsMUdhc1VzZWQ6IGFyZ3MubDFHYXNVc2VkID8gaGV4VG9CaWdJbnQoYXJncy5sMUdhc1VzZWQpIDogbnVsbCwKICAgICAgICAgIGwxRmVlOiBhcmdzLmwxRmVlID8gaGV4VG9CaWdJbnQoYXJncy5sMUZlZSkgOiBudWxsLAogICAgICAgICAgbDFGZWVTY2FsYXI6IGFyZ3MubDFGZWVTY2FsYXIgPyBOdW1iZXIoYXJncy5sMUZlZVNjYWxhcikgOiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgfSkKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vb3Atc3RhY2svc2VyaWFsaXplcnMuanMKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGluaXRfY29uY2F0KCk7CiAgaW5pdF90b0hleCgpOwogIGZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uMyh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKSB7CiAgICBpZiAoaXNEZXBvc2l0KHRyYW5zYWN0aW9uKSkKICAgICAgcmV0dXJuIHNlcmlhbGl6ZVRyYW5zYWN0aW9uRGVwb3NpdCh0cmFuc2FjdGlvbik7CiAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgfQogIHZhciBzZXJpYWxpemVyczIgPSB7CiAgICB0cmFuc2FjdGlvbjogc2VyaWFsaXplVHJhbnNhY3Rpb24zCiAgfTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkRlcG9zaXQodHJhbnNhY3Rpb24pIHsKICAgIGFzc2VydFRyYW5zYWN0aW9uRGVwb3NpdCh0cmFuc2FjdGlvbik7CiAgICBjb25zdCB7IHNvdXJjZUhhc2gsIGRhdGEsIGZyb20sIGdhcywgaXNTeXN0ZW1UeCwgbWludDogbWludDIsIHRvLCB2YWx1ZSB9ID0gdHJhbnNhY3Rpb247CiAgICBjb25zdCBzZXJpYWxpemVkVHJhbnNhY3Rpb24gPSBbCiAgICAgIHNvdXJjZUhhc2gsCiAgICAgIGZyb20sCiAgICAgIHRvID8/ICIweCIsCiAgICAgIG1pbnQyID8gdG9IZXgobWludDIpIDogIjB4IiwKICAgICAgdmFsdWUgPyB0b0hleCh2YWx1ZSkgOiAiMHgiLAogICAgICBnYXMgPyB0b0hleChnYXMpIDogIjB4IiwKICAgICAgaXNTeXN0ZW1UeCA/ICIweDEiIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiCiAgICBdOwogICAgcmV0dXJuIGNvbmNhdEhleChbCiAgICAgICIweDdlIiwKICAgICAgdG9SbHAoc2VyaWFsaXplZFRyYW5zYWN0aW9uKQogICAgXSk7CiAgfQogIGZ1bmN0aW9uIGlzRGVwb3NpdCh0cmFuc2FjdGlvbikgewogICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUgPT09ICJkZXBvc2l0IikKICAgICAgcmV0dXJuIHRydWU7CiAgICBpZiAodHlwZW9mIHRyYW5zYWN0aW9uLnNvdXJjZUhhc2ggIT09ICJ1bmRlZmluZWQiKQogICAgICByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gYXNzZXJ0VHJhbnNhY3Rpb25EZXBvc2l0KHRyYW5zYWN0aW9uKSB7CiAgICBjb25zdCB7IGZyb20sIHRvIH0gPSB0cmFuc2FjdGlvbjsKICAgIGlmIChmcm9tICYmICFpc0FkZHJlc3MoZnJvbSkpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogZnJvbSB9KTsKICAgIGlmICh0byAmJiAhaXNBZGRyZXNzKHRvKSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiB0byB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9vcC1zdGFjay9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZzIgPSB7CiAgICBjb250cmFjdHMsCiAgICBmb3JtYXR0ZXJzOiBmb3JtYXR0ZXJzMiwKICAgIHNlcmlhbGl6ZXJzOiBzZXJpYWxpemVyczIKICB9OwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FuY2llbnQ4LmpzCiAgdmFyIHNvdXJjZUlkID0gMTsKICB2YXIgYW5jaWVudDggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDg4ODg4ODg4OCwKICAgIG5hbWU6ICJBbmNpZW50OCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5jaWVudDguZ2ciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBbmNpZW50OCBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmFuY2llbnQ4LmdnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4uYW5jaWVudDguZ2cvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkXTogewogICAgICAgICAgYWRkcmVzczogIjB4QjA5REMwODQyOEM4YjRFRkI0ZmY5QzA4MjczODZDREYzNDI3Nzk5NiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDYzOUYyQUVDRTM5OEFhNzZiMDdlNTllRjZhYmUyY0ZlMzJiYWNiNjgiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTA3MDU3MQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ1ZTNlRGY1YjY4MTM1RDU1OUQ1NzJFMjZiRjg2M0ZCQzE5NTAwMzMiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTA3MDU3MQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYW5jaWVudDhTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMiA9IDExMTU1MTExOwogIHZhciBhbmNpZW50OFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI4MTIyMDI0LAogICAgbmFtZTogIkFuY2llbnQ4IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjdjItdGVzdG5ldC5hbmNpZW50OC5nZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFuY2llbnQ4IENlbGVzdGlhIFRlc3RuZXQgZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2NhbnYyLXRlc3RuZXQuYW5jaWVudDguZ2ciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2NhbnYyLXRlc3RuZXQuYW5jaWVudDguZ2cvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDk0MmZENTAxN2MwRjYwNTc1OTMwRDg1NzRFYWNhMTNCRWNENmUxYkIiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZmExZDlFMjZBNmFDRDdiMjIxMTVEMjc1NzJjMTIyMUI5ODAzYzk2MCIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NzI5MDgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4RjZCYzAxNDZkM2M3NEQ0ODMwNmU3OUFlMTM0QTI2MEU0MThDOTMzNSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NzI5MDgKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYW52aWwuanMKICB2YXIgYW52aWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMzM3LAogICAgbmFtZTogIkFudmlsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzOi8vMTI3LjAuMC4xOjg1NDUiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXBlQ2hhaW4uanMKICB2YXIgc291cmNlSWQzID0gNDIxNjE7CiAgdmFyIGFwZUNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMzEzOSwKICAgIG5hbWU6ICJBcGUgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkFwZUNvaW4iLAogICAgICBzeW1ib2w6ICJBUEUiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFwZWNoYWluLmNvbS9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5hcGVjaGFpbi5jb20vd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2FwZXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmFwZXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA4ODkKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcGV4VGVzdG5ldC5qcwogIHZhciBhcGV4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzk5MywKICAgIG5hbWU6ICJBUEVYIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuYXBleGxheWVyLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLXRlc3RuZXQuYXBleGxheWVyLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAtdGVzdG5ldC5hcGV4bGF5ZXIueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Zjc2NDJiZTMzYTZiMThEMTZhOTk1NjU3YWRiNWE2OENEMDQzOGFFMiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyODM3NzUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmJpdHJ1bS5qcwogIHZhciBhcmJpdHJ1bSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNjEsCiAgICBuYW1lOiAiQXJiaXRydW0gT25lIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FyYjEuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmFyYmlzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NjU0NzA3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcmJpdHJ1bUdvZXJsaS5qcwogIHZhciBhcmJpdHJ1bUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNjEzLAogICAgbmFtZTogIkFyYml0cnVtIEdvZXJsaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQXJiaXRydW0gR29lcmxpIEV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2dvZXJsaS1yb2xsdXAuYXJiaXRydW0uaW8vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQXJiaXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ29lcmxpLmFyYmlzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDg4MTE0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJiaXRydW1Ob3ZhLmpzCiAgdmFyIGFyYml0cnVtTm92YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIxNzAsCiAgICBuYW1lOiAiQXJiaXRydW0gTm92YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ub3ZhLmFyYml0cnVtLmlvL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyYmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL25vdmEuYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW5vdmEuYXJiaXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDY5NjMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FyYml0cnVtU2Vwb2xpYS5qcwogIHZhciBhcmJpdHJ1bVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyMTYxNCwKICAgIG5hbWU6ICJBcmJpdHJ1bSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBcmJpdHJ1bSBTZXBvbGlhIEV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEtcm9sbHVwLmFyYml0cnVtLmlvL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFyYmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuYXJiaXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEuYXJiaXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDgxOTMwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJlb25OZXR3b3JrLmpzCiAgdmFyIGFyZW9uTmV0d29yayA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDYzLAogICAgbmFtZTogIkFyZW9uIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiQVJFQSIsIHN5bWJvbDogIkFSRUEiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMuYXJlb24ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LXdzLmFyZW9uLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmVvbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJlb25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzNTMyODYKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXJlb25OZXR3b3JrVGVzdG5ldC5qcwogIHZhciBhcmVvbk5ldHdvcmtUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjIsCiAgICBuYW1lOiAiQXJlb24gTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIlRBUkVBIiwgc3ltYm9sOiAiVEFSRUEiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMuYXJlb24ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LXdzLmFyZW9uLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcmVvbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXJlb25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hcnRlbGFUZXN0bmV0LmpzCiAgdmFyIGFydGVsYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExODIyLAogICAgbmFtZTogIkFydGVsYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJBUlQiLCBzeW1ib2w6ICJBUlQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9iZXRhbmV0LXJwYzEuYXJ0ZWxhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBcnRlbGEiLAogICAgICAgIHVybDogImh0dHBzOi8vYmV0YW5ldC1zY2FuLmFydGVsYS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2JldGFuZXQtc2Nhbi5hcnRlbGEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGQwN2M4NjM1Zjc2ZTg3NDVFZTcwOTJmYmI2ZThmYmM1RmVGMDlERDciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzAwMTg3MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Fzc2V0Q2hhaW4uanMKICB2YXIgYXNzZXRDaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MjAsCiAgICBuYW1lOiAiQXNzZXRDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJlYWwgV29ybGQgQXNzZXQiLAogICAgICBzeW1ib2w6ICJSV0EiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5hc3NldGNoYWluLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzc2V0IENoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uYXNzZXRjaGFpbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi5hc3NldGNoYWluLm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZSwKICAgIGNvbnRyYWN0czoge30KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hc3NldENoYWluVGVzdG5ldC5qcwogIHZhciBhc3NldENoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MjEsCiAgICBuYW1lOiAiQXNzZXRDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlJlYWwgV29ybGQgQXNzZXQiLAogICAgICBzeW1ib2w6ICJSV0EiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9lbnVndS1ycGMuYXNzZXRjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBc3NldCBDaGFpbiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4tdGVzdG5ldC5hc3NldGNoYWluLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLXRlc3RuZXQuYXNzZXRjaGFpbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4OTg5RjgzMkQzNTk4OGNiNWUzZUIwMDFGYTJGZTc4OTQ2OUVDMzFFYSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNzE3NwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXN0YXIuanMKICB2YXIgYXN0YXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5MiwKICAgIG5hbWU6ICJBc3RhciIsCiAgICBuZXR3b3JrOiAiYXN0YXItbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQXN0YXIiLAogICAgICBzeW1ib2w6ICJBU1RSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hc3Rhci5hcGkub25maW5hbGl0eS5pby9wdWJsaWMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBc3RhciBTdWJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2FzdGFyLnN1YnNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzYxNzk0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2FzdGFyWmtFVk0uanMKICB2YXIgYXN0YXJaa0VWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzc3NiwKICAgIG5hbWU6ICJBc3RhciB6a0VWTSIsCiAgICBuZXR3b3JrOiAiQXN0YXJaa0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtemtldm0uYXN0YXIubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkFzdGFyIHprRVZNIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FzdGFyLXprZXZtLmV4cGxvcmVyLnN0YXJ0YWxlLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5MzUyOAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hc3RhclpreW90by5qcwogIHZhciBhc3RhclpreW90byA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAzODM2MSwKICAgIG5hbWU6ICJBc3RhciB6a0VWTSBUZXN0bmV0IHpLeW90byIsCiAgICBuZXR3b3JrOiAiekt5b3RvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5zdGFydGFsZS5jb20vemt5b3RvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiekt5b3RvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3preW90by5leHBsb3Jlci5zdGFydGFsZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTk2MTUzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXRsZXRhT2x5bXBpYS5qcwogIHZhciBhdGxldGFPbHltcGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzQwLAogICAgbmFtZTogIkF0bGV0YSBPbHltcGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIkF0bGEiLCBzeW1ib2w6ICJBVExBIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vdGVzdG5ldC1ycGMuYXRsZXRhLm5ldHdvcms6OTk0NCIsCiAgICAgICAgICAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5hdGxldGEubmV0d29yayIKICAgICAgICBdLAogICAgICAgIHdzOiBbIndzczovL3Rlc3RuZXQtcnBjLmF0bGV0YS5uZXR3b3JrOjk5NDQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdGxldGEgT2x5bXBpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LmF0bGV0YS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuYXRsZXRhLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgxNDcyZWM2MzkyMTgwZmI4NEYzNDVkMjQ1NWJDQzc1QjI2NTc3MTE1IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNzY0NzMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdXJvcmEuanMKICB2YXIgYXVyb3JhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzEzMTYxNTU0LAogICAgbmFtZTogIkF1cm9yYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuYXVyb3JhLmRldiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkF1cm9yYXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYXVyb3Jhc2Nhbi5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXVyb3Jhc2Nhbi5kZXYvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYyOTA3ODE2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdXJvcmFUZXN0bmV0LmpzCiAgdmFyIGF1cm9yYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMTMxNjE1NTUsCiAgICBuYW1lOiAiQXVyb3JhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LmF1cm9yYS5kZXYiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdXJvcmFzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYXVyb3Jhc2Nhbi5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5hdXJvcmFzY2FuLmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYXVyb3JpYS5qcwogIHZhciBhdXJvcmlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDUyMDUsCiAgICBuYW1lOiAiQXVyb3JpYSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJhdXJvcmlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJBdXJvcmlhIFN0cmF0aXMiLAogICAgICBzeW1ib2w6ICJ0U1RSQVgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXVyb3JpYS5ycGMuc3RyYXRpc2V2bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJBdXJvcmlhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXVyb3JpYS5leHBsb3Jlci5zdHJhdGlzZXZtLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdmFsYW5jaGUuanMKICB2YXIgYXZhbGFuY2hlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MzExNCwKICAgIG5hbWU6ICJBdmFsYW5jaGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQXZhbGFuY2hlIiwKICAgICAgc3ltYm9sOiAiQVZBWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5hdmF4Lm5ldHdvcmsvZXh0L2JjL0MvcnBjIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU25vd1RyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3Nub3d0cmFjZS5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuc25vd3RyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDExOTA3OTM0CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9hdmFsYW5jaGVGdWppLmpzCiAgdmFyIGF2YWxhbmNoZUZ1amkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzMTEzLAogICAgbmFtZTogIkF2YWxhbmNoZSBGdWppIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkF2YWxhbmNoZSBGdWppIiwKICAgICAgc3ltYm9sOiAiQVZBWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5hdmF4LXRlc3QubmV0d29yay9leHQvYmMvQy9ycGMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbm93VHJhY2UiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5zbm93dHJhY2UuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3RuZXQuc25vd3RyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDcwOTY5NTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iMy5qcwogIHZhciBzb3VyY2VJZDQgPSA4NDUzOwogIHZhciBiMyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODMzMywKICAgIG5hbWU6ICJCMyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMuYjMuZnVuL2h0dHAiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmIzLmZ1biIKICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iM1NlcG9saWEuanMKICB2YXIgc291cmNlSWQ1ID0gMTY4NTg3NzczOwogIHZhciBiM1NlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTMsCiAgICBuYW1lOiAiQjMgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5iMy5mdW4vaHR0cCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5iMy5mdW4iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkNQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JhaGFtdXQuanMKICB2YXIgYmFoYW11dCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTE2NSwKICAgIG5ldHdvcms6ICJiYWhhbXV0IiwKICAgIG5hbWU6ICJCYWhhbXV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJGYXN0dG9rZW4iLCBzeW1ib2w6ICJGVE4iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYzEuYmFoYW11dC5pbyIsCiAgICAgICAgICAiaHR0cHM6Ly9iYWhhbXV0LXJwYy5wdWJsaWNub2RlLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMyLmJhaGFtdXQuaW8iCiAgICAgICAgXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly93czEuc2FoYXJhLmJhaGFtdXRjaGFpbi5jb20iLAogICAgICAgICAgIndzczovL2JhaGFtdXQtcnBjLnB1YmxpY25vZGUuY29tIiwKICAgICAgICAgICJ3c3M6Ly93czIuc2FoYXJhLmJhaGFtdXRjaGFpbi5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGdG5zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5mdG5zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cuZnRuc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFzZS5qcwogIHZhciBzb3VyY2VJZDYgPSAxOwogIHZhciBiYXNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4NDUzLAogICAgbmFtZTogIkJhc2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5iYXNlLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJhc2VzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jhc2VzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuYmFzZXNjYW4ub3JnL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4NDNlZEI4OEM0QjgwZkREMkFkRkYyNDEyQTdCZWJGOWRGNDJjQjQwZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDU2MzE1YjkwYzQwNzMwOTI1ZWM1NDg1Y2YwMDRkODM1MDU4NTE4QTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MDIyCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0OTA0ODA0NEQ1N2UxQzkyQTc3Zjc5OTg4ZDIxRmE4ZkFGNzRFOTdlIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0ODIxNDMKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ2XTogewogICAgICAgICAgYWRkcmVzczogIjB4MzE1NENmMTZjY2RiNEM2ZDkyMjYyOTY2NDE3NGI5MDRkODBGMkMzNSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDgyMTQzCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jhc2VHb2VybGkuanMKICB2YXIgc291cmNlSWQ3ID0gNTsKICB2YXIgYmFzZUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogODQ1MzEsCiAgICBuYW1lOiAiQmFzZSBHb2VybGkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkdvZXJsaSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9nb2VybGkuYmFzZS5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCYXNlc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuYmFzZXNjYW4ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS5iYXNlc2Nhbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDJBMzU4OTFmZjMwMzEzQ2NGYTZDRTg4ZGNmMzg1OGJiMDc1QTIyOTgiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMzc2OTg4CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlOTNjOGNEMEQ0MDkzNDEyMDVBNTkyZjhjNEFjMUE1ZmU1NTg1Y2ZBIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhmQTZEOEVlNUJFNzcwRjg0RkMwMDFEMDk4QzRiRDYwNEZlMDEyODRhIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ3CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmFzZVNlcG9saWEuanMKICB2YXIgc291cmNlSWQ4ID0gMTExNTUxMTE7CiAgdmFyIGJhc2VTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA4NDUzMiwKICAgIG5ldHdvcms6ICJiYXNlLXNlcG9saWEiLAogICAgbmFtZTogIkJhc2UgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuYmFzZS5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCYXNlc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmJhc2VzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5iYXNlc2Nhbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkNkU2ZEJmNEY3RUEwYWM0MTJmRDhiNjVFRDI5N2U2NEJCN2EwNkUxIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ4XTogewogICAgICAgICAgYWRkcmVzczogIjB4ODQ0NTdjYTlEMDE2M0ZiQzRiYmZlNERmYmIyMGJhNDZlNDhERjI1NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0OWY1M2U0MTQ1MmM3NDU4OWU4NWNhMTY3NzQyNmJhNDI2NDU5ZTg1IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ0NjY3NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhmZDBCZjcxRjYwNjYwRTJmNjA4ZWQ1NmUxNjU5QzQ1MGVCMTEzMTIwIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ0NjY3NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA1OTY0NwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDgKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFtLmpzCiAgdmFyIGJlYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQzMzcsCiAgICBuYW1lOiAiQmVhbSIsCiAgICBuZXR3b3JrOiAiYmVhbSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCZWFtIiwKICAgICAgc3ltYm9sOiAiQkVBTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYnVpbGQub25iZWFtLmNvbS9ycGMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vYnVpbGQub25iZWFtLmNvbS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlYW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc3VibmV0cy5hdmF4Lm5ldHdvcmsvYmVhbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4NDk1NmYxNWVmZGMzZGMxNjY0NWU5MGNjMzU2ZWFmYTY1ZmZjNjVlYyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFtVGVzdG5ldC5qcwogIHZhciBiZWFtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMzMzcsCiAgICBuYW1lOiAiQmVhbSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJiZWFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJlYW0iLAogICAgICBzeW1ib2w6ICJCRUFNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9idWlsZC5vbmJlYW0uY29tL3JwYy90ZXN0bmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2J1aWxkLm9uYmVhbS5jb20vd3MvdGVzdG5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJlYW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc3VibmV0cy10ZXN0LmF2YXgubmV0d29yay9iZWFtIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg5YmY0OWI3MDRlZTJhMDk1Yjk1YzFmMmQ0ZWI5MDEwNTEwYzQxYzllIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFyTmV0d29ya0NoYWluTWFpbm5ldC5qcwogIHZhciBiZWFyTmV0d29ya0NoYWluTWFpbm5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjQxMjMwLAogICAgbmFtZTogIkJlYXIgTmV0d29yayBDaGFpbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJlYXJOZXR3b3JrQ2hhaW4iLAogICAgICBzeW1ib2w6ICJCUk5LQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JybmtjLW1haW5uZXQuYmVhcm5ldHdvcmsubmV0Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJua1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYnJua3NjYW4uYmVhcm5ldHdvcmsubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2JybmtzY2FuLmJlYXJuZXR3b3JrLm5ldC9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZWFyTmV0d29ya0NoYWluVGVzdG5ldC5qcwogIHZhciBiZWFyTmV0d29ya0NoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzUxMjMwLAogICAgbmFtZTogIkJlYXIgTmV0d29yayBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRCUk5LQyIsCiAgICAgIHN5bWJvbDogInRCUk5LQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JybmtjLXRlc3QuYmVhcm5ldHdvcmsubmV0Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJua1Rlc3RTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jybmt0ZXN0LXNjYW4uYmVhcm5ldHdvcmsubmV0IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jybmt0ZXN0LXNjYW4uYmVhcm5ldHdvcmsubmV0L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZXJhY2hhaW5UZXN0bmV0LmpzCiAgdmFyIGJlcmFjaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDg1LAogICAgbmFtZTogIkJlcmFjaGFpbiBBcnRpbyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCRVJBIFRva2VuIiwKICAgICAgc3ltYm9sOiAiQkVSQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FydGlvLnJwYy5iZXJhY2hhaW4uY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmVyYWNoYWluIiwKICAgICAgICB1cmw6ICJodHRwczovL2FydGlvLmJlcmF0cmFpbC5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iZXJhY2hhaW5UZXN0bmV0YkFydGlvLmpzCiAgdmFyIGJlcmFjaGFpblRlc3RuZXRiQXJ0aW8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDg0LAogICAgbmFtZTogIkJlcmFjaGFpbiBiQXJ0aW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQkVSQSBUb2tlbiIsCiAgICAgIHN5bWJvbDogIkJFUkEiCiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwOTI2OQogICAgICB9CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9iYXJ0aW8ucnBjLmJlcmFjaGFpbi5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZXJhY2hhaW4gYkFydGlvIEJlcmF0cmFpbCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iYXJ0aW8uYmVyYXRyYWlsLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jldm1NYWlubmV0LmpzCiAgdmFyIGJldm1NYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTUwMSwKICAgIG5hbWU6ICJCRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJpdGNvaW4iLCBzeW1ib2w6ICJCVEMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLW1haW5uZXQtMS5iZXZtLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmV2bXNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi1tYWlubmV0LmJldm0uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi1tYWlubmV0LWFwaS5iZXZtLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpZnJvc3QuanMKICB2YXIgYmlmcm9zdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzA2OCwKICAgIG5hbWU6ICJCaWZyb3N0IE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJGQyIsIHN5bWJvbDogIkJGQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3B1YmxpYy0wMS5tYWlubmV0LmJpZnJvc3RuZXR3b3JrLmNvbS9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaWZyb3N0IEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWFpbm5ldC5iaWZyb3N0bmV0d29yay5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGt1Yi5qcwogIHZhciBiaXRrdWIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk2LAogICAgbmFtZTogIkJpdGt1YiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQml0a3ViIiwgc3ltYm9sOiAiS1VCIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmJpdGt1YmNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0a3ViIENoYWluIE1haW5uZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmJrY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3d3dy5ia2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9iaXRrdWJUZXN0bmV0LmpzCiAgdmFyIGJpdGt1YlRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1OTI1LAogICAgbmFtZTogIkJpdGt1YiBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJCaXRrdWIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQml0a3ViIFRlc3QiLCBzeW1ib2w6ICJ0S1VCIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuYml0a3ViY2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRrdWIgQ2hhaW4gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmJrY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuYmtjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGxheWVyLmpzCiAgdmFyIGJpdGxheWVyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDA5MDEsCiAgICBuYW1lOiAiQml0bGF5ZXIgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQlRDIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5iaXRsYXllci5vcmciXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuYml0bGF5ZXIub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYml0bGF5ZXIgbWFpbm5ldCBzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5idHJzY2FuLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdGxheWVyVGVzdG5ldC5qcwogIHZhciBiaXRsYXllclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMDgxMCwKICAgIG5hbWU6ICJCaXRsYXllciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCVEMiLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMuYml0bGF5ZXIub3JnIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQtd3MuYml0bGF5ZXIub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYml0bGF5ZXIgdGVzdG5ldCBzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnRyc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0cm9jay5qcwogIHZhciBiaXRyb2NrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTcxLAogICAgbmFtZTogIkJpdHJvY2sgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQlJPQ0siLCBzeW1ib2w6ICJCUk9DSyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Jyb2NrcnBjLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0cm9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5iaXQtcm9jay5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYml0VG9ycmVudC5qcwogIHZhciBiaXRUb3JyZW50ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOTksCiAgICBuYW1lOiAiQml0VG9ycmVudCIsCiAgICBuZXR3b3JrOiAiYml0dG9ycmVudC1jaGFpbi1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRUb3JyZW50Iiwgc3ltYm9sOiAiQlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5iaXR0b3JyZW50Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCdHRjc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9idHRjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmJ0dGNzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzEwNzg1NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JpdFRvcnJlbnRUZXN0bmV0LmpzCiAgdmFyIGJpdFRvcnJlbnRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDI4LAogICAgbmFtZTogIkJpdFRvcnJlbnQgQ2hhaW4gVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiYml0dG9ycmVudC1jaGFpbi10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCaXRUb3JyZW50Iiwgc3ltYm9sOiAiQlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RycGMuYml0dG9ycmVudGNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnR0Y3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5idHRjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5idHRjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JsYXN0LmpzCiAgdmFyIHNvdXJjZUlkOSA9IDE7CiAgdmFyIGJsYXN0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MTQ1NywKICAgIG5hbWU6ICJCbGFzdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5ibGFzdC5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsYXN0c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibGFzdHNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmJsYXN0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjEyOTI5CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQ5CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYmxhc3RTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMTAgPSAxMTE1NTExMTsKICB2YXIgYmxhc3RTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjg1ODc3NzMsCiAgICBuYW1lOiAiQmxhc3QgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5ibGFzdC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsYXN0c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmJsYXN0c2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5ibGFzdHNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc1NjY5MAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDEwCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iLmpzCiAgdmFyIHNvdXJjZUlkMTEgPSAxOwogIHZhciBib2IgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNjA4MDgsCiAgICBuYW1lOiAiQk9CIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdvYm9iLnh5eiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ29ib2IueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdvYm9iLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMzEzMQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDExXTogewogICAgICAgICAgYWRkcmVzczogIjB4ZERhNTNFMjNmOGEzMjY0MGIwNEQ3MjU2ZTY1MUMxZGI5OGRCMTFDMSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0NjI2MTUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDExXTogewogICAgICAgICAgYWRkcmVzczogIjB4OEFkZUUxMjQ0NDc0MzVmRTAzZTNDRDI0ZEYzZjRjQUUzMkU2NWEzRSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0NjI2MTUKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQxMQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvYmEuanMKICB2YXIgYm9iYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjg4LAogICAgbmFtZTogIkJvYmEgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuYm9iYS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CQVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vYm9iYXNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ0Njg1OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iYVNlcG9saWEuanMKICB2YXIgYm9iYVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4ODgyLAogICAgbmFtZTogIkJvYmEgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NlcG9saWEuYm9iYS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CQVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5ib2Jhc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm9iU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDEyID0gMTExNTUxMTE7CiAgdmFyIGJvYlNlcG9saWEgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogODA4ODEzLAogICAgbmFtZTogIkJPQiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkVUSCIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYm9iLXNlcG9saWEucnBjLmdvYm9iLnh5eiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ib2Itc2Vwb2xpYS5ycGMuZ29ib2IueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQk9CIFNlcG9saWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYm9iLXNlcG9saWEuZXhwbG9yZXIuZ29ib2IueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM1Njc3CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxNEQwMDY5NDUyYjRBRTJiMjUwQjM5NWI4YWRBYjc3MUU0MjY3ZDJmIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg4NjdCMUFhODcyYjlDOGNCNUU5Rjc3NTVmZURDNDVCQjI0QWQwYWU0IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNDQ2MjYxNQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQxMgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvdGFuaXhUZXN0bmV0LmpzCiAgdmFyIGJvdGFuaXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjM2LAogICAgbmFtZTogIkJvdGFuaXggVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQm90YW5peCIsIHN5bWJvbDogIkJUQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3BvYS1ub2RlLmJvdGFuaXhsYWJzLmRldiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5ib3Rhbml4bGFicy5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5ib3Rhbml4bGFicy5kZXYiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYm91bmNlQml0LmpzCiAgdmFyIGJvdW5jZUJpdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAwMSwKICAgIG5hbWU6ICJCb3VuY2VCaXQgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQm91bmNlQml0Iiwgc3ltYm9sOiAiQkIiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZnVsbG5vZGUtbWFpbm5ldC5ib3VuY2ViaXRhcGkuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQkIgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9iYnNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JvdW5jZUJpdFRlc3RuZXQuanMKICB2YXIgYm91bmNlQml0VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNmUzLAogICAgbmFtZTogIkJvdW5jZUJpdCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCb3VuY2VCaXQiLCBzeW1ib2w6ICJCQiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9mdWxsbm9kZS10ZXN0bmV0LmJvdW5jZWJpdGFwaS5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCQiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYmJzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jyb25vcy5qcwogIHZhciBicm9ub3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMzksCiAgICBuYW1lOiAiQnJvbm9zIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJSTyIsCiAgICAgIHN5bWJvbDogIkJSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5icm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJvbm9TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jyb3NjYW4uYnJvbm9zLm9yZyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Jyb25vc1Rlc3RuZXQuanMKICB2YXIgYnJvbm9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAzOCwKICAgIG5hbWU6ICJCcm9ub3MgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCcm9ub3MgQ29pbiIsCiAgICAgIHN5bWJvbDogInRCUk8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldm0tdGVzdG5ldC5icm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQnJvbm9TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Ricm9zY2FuLmJyb25vcy5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNjLmpzCiAgdmFyIGJzYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTYsCiAgICBuYW1lOiAiQk5CIFNtYXJ0IENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5hbmtyLmNvbS9ic2MiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCc2NTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2JzY3NjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5ic2NzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTU5MjE0NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzY0dyZWVuZmllbGQuanMKICB2YXIgYnNjR3JlZW5maWVsZCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTAxNywKICAgIG5hbWU6ICJCTkIgR3JlZW5maWVsZCBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCTkIiLAogICAgICBzeW1ib2w6ICJCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ncmVlbmZpZWxkLWNoYWluLmJuYmNoYWluLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJOQiBHcmVlbmZpZWxkIE1haW5uZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ncmVlbmZpZWxkc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzY1Rlc3RuZXQuanMKICB2YXIgYnNjVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTcsCiAgICBuYW1lOiAiQmluYW5jZSBTbWFydCBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogInRCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9kYXRhLXNlZWQtcHJlYnNjLTEtczEuYm5iY2hhaW4ub3JnOjg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCc2NTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnNjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXRlc3RuZXQuYnNjc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE3NDIyNDgzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnNxdWFyZWQuanMKICB2YXIgYnNxdWFyZWQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMywKICAgIG5hbWU6ICJCMiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYnNxdWFyZWQubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuYnNxdWFyZWQubmV0d29yayIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2JzcXVhcmVkVGVzdG5ldC5qcwogIHZhciBic3F1YXJlZFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMjMsCiAgICBuYW1lOiAiQjIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5ic3F1YXJlZC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLmJzcXVhcmVkLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnRyLmpzCiAgdmFyIGJ0ciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAwOTAxLAogICAgbmFtZTogIkJpdGxheWVyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCaXRjb2luIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmJpdGxheWVyLm9yZyIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYml0bGF5ZXItcnBjLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ycGMuYW5rci5jb20vYml0bGF5ZXIiCiAgICAgICAgXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuYml0bGF5ZXIub3JnIiwgIndzczovL3dzLmJpdGxheWVyLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCaXRsYXllcihCVFIpIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LmJ0cnNjYW4uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnRyVGVzdG5ldC5qcwogIHZhciBidHJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDA4MTAsCiAgICBuYW1lOiAiQml0bGF5ZXIgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQml0Y29pbiIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5iaXRsYXllci5vcmciXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly90ZXN0bmV0LXdzLmJpdGxheWVyLm9yZyIsCiAgICAgICAgICAid3NzOi8vdGVzdG5ldC13cy5iaXRsYXllci1ycGMuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQml0bGF5ZXIoQlRSKSBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuYnRyc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvYnhuLmpzCiAgdmFyIGJ4biA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDk5OSwKICAgIG5hbWU6ICJCbGFja0ZvcnQgRXhjaGFuZ2UgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQmxhY2tGb3J0IFRva2VuIiwgc3ltYm9sOiAiQlhOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5ibGFja2ZvcnQubmV0d29yay9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmJsYWNrZm9ydC5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmJsYWNrZm9ydC5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2J4blRlc3RuZXQuanMKICB2YXIgYnhuVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDc3NywKICAgIG5hbWU6ICJCbGFja0ZvcnQgRXhjaGFuZ2UgTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCbGFja0ZvcnQgVGVzdG5ldCBUb2tlbiIsCiAgICAgIHN5bWJvbDogIlRCWE4iLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ibGFja2ZvcnQubmV0d29yay9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuYmxhY2tmb3J0Lm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5ibGFja2ZvcnQubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Fubm9uLmpzCiAgdmFyIGNhbm5vbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTMzNzAsCiAgICBuYW1lOiAiQ2Fubm9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHA6Ly8xMjcuMC4wLjE6ODU0NSJdIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jYW50by5qcwogIHZhciBjYW50byA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzcwMCwKICAgIG5hbWU6ICJDYW50byIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDYW50byIsCiAgICAgIHN5bWJvbDogIkNBTlRPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vY2FudG8uZ3Jhdml0eWNoYWluLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVHViZXIuQnVpbGQgKEJsb2Nrc2NvdXQpIiwKICAgICAgICB1cmw6ICJodHRwczovL3R1YmVyLmJ1aWxkIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI5MDU3ODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9mZWVzLmpzCiAgdmFyIGZlZXMgPSB7CiAgICAvKgogICAgICAgKiBFc3RpbWF0ZXMgdGhlIGZlZXMgcGVyIGdhcyBmb3IgYSB0cmFuc2FjdGlvbi4KICAgIAogICAgICAgKiBJZiB0aGUgdHJhbnNhY3Rpb24gaXMgdG8gYmUgcGFpZCBpbiBhIHRva2VuIChmZWVDdXJyZW5jeSBpcyBwcmVzZW50KSB0aGVuIHRoZSBmZWVzCiAgICAgICAqIGFyZSBlc3RpbWF0ZWQgaW4gdGhlIHZhbHVlIG9mIHRoZSB0b2tlbi4gT3RoZXJ3aXNlIGZhbGxzIGJhY2sgdG8gdGhlIGRlZmF1bHQKICAgICAgICogZXN0aW1hdGlvbiBieSByZXR1cm5pbmcgbnVsbC4KICAgICAgICoKICAgICAgICogQHBhcmFtIHBhcmFtcyBmZWUgZXN0aW1hdGlvbiBmdW5jdGlvbiBwYXJhbWV0ZXJzCiAgICAgICAqLwogICAgZXN0aW1hdGVGZWVzUGVyR2FzOiBhc3luYyAocGFyYW1zKSA9PiB7CiAgICAgIGlmICghcGFyYW1zLnJlcXVlc3Q/LmZlZUN1cnJlbmN5KQogICAgICAgIHJldHVybiBudWxsOwogICAgICBjb25zdCBbbWF4RmVlUGVyR2FzLCBtYXhQcmlvcml0eUZlZVBlckdhc10gPSBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgZXN0aW1hdGVGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KHBhcmFtcy5jbGllbnQsIHBhcmFtcy5yZXF1ZXN0LmZlZUN1cnJlbmN5KSwKICAgICAgICBlc3RpbWF0ZU1heFByaW9yaXR5RmVlUGVyR2FzSW5GZWVDdXJyZW5jeShwYXJhbXMuY2xpZW50LCBwYXJhbXMucmVxdWVzdC5mZWVDdXJyZW5jeSkKICAgICAgXSk7CiAgICAgIGNvbnN0IHN1Z2dlc3RlZE1heEZlZVBlckdhcyA9IHBhcmFtcy5tdWx0aXBseShtYXhGZWVQZXJHYXMpICsgbWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgbWF4RmVlUGVyR2FzOiBzdWdnZXN0ZWRNYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMKICAgICAgfTsKICAgIH0KICB9OwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlUGVyR2FzSW5GZWVDdXJyZW5jeShjbGllbnQsIGZlZUN1cnJlbmN5KSB7CiAgICBjb25zdCBmZWUgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9nYXNQcmljZSIsCiAgICAgIHBhcmFtczogW2ZlZUN1cnJlbmN5XQogICAgfSk7CiAgICByZXR1cm4gQmlnSW50KGZlZSk7CiAgfQogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlTWF4UHJpb3JpdHlGZWVQZXJHYXNJbkZlZUN1cnJlbmN5KGNsaWVudCwgZmVlQ3VycmVuY3kpIHsKICAgIGNvbnN0IGZlZXNQZXJHYXMgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgIG1ldGhvZDogImV0aF9tYXhQcmlvcml0eUZlZVBlckdhcyIsCiAgICAgIHBhcmFtczogW2ZlZUN1cnJlbmN5XQogICAgfSk7CiAgICByZXR1cm4gQmlnSW50KGZlZXNQZXJHYXMpOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vZm9ybWF0dGVycy5qcwogIGluaXRfZnJvbUhleCgpOwogIGluaXRfdHJhbnNhY3Rpb25SZXF1ZXN0KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL3V0aWxzLmpzCiAgaW5pdF90cmltKCk7CiAgZnVuY3Rpb24gaXNFbXB0eSh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlID09PSAwIHx8IHZhbHVlID09PSAwbiB8fCB2YWx1ZSA9PT0gdm9pZCAwIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSAiMCIgfHwgdmFsdWUgPT09ICIiIHx8IHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgKHRyaW0odmFsdWUpLnRvTG93ZXJDYXNlKCkgPT09ICIweCIgfHwgdHJpbSh2YWx1ZSkudG9Mb3dlckNhc2UoKSA9PT0gIjB4MDAiKTsKICB9CiAgZnVuY3Rpb24gaXNQcmVzZW50KHZhbHVlKSB7CiAgICByZXR1cm4gIWlzRW1wdHkodmFsdWUpOwogIH0KICBmdW5jdGlvbiBpc0VJUDE1NTkodHJhbnNhY3Rpb24pIHsKICAgIHJldHVybiB0eXBlb2YgdHJhbnNhY3Rpb24ubWF4RmVlUGVyR2FzICE9PSAidW5kZWZpbmVkIiAmJiB0eXBlb2YgdHJhbnNhY3Rpb24ubWF4UHJpb3JpdHlGZWVQZXJHYXMgIT09ICJ1bmRlZmluZWQiOwogIH0KICBmdW5jdGlvbiBpc0NJUDY0KHRyYW5zYWN0aW9uKSB7CiAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImNpcDY0IikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBpc0VJUDE1NTkodHJhbnNhY3Rpb24pICYmIGlzUHJlc2VudCh0cmFuc2FjdGlvbi5mZWVDdXJyZW5jeSk7CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2Vsby9mb3JtYXR0ZXJzLmpzCiAgdmFyIGZvcm1hdHRlcnMzID0gewogICAgYmxvY2s6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVCbG9jayh7CiAgICAgIGZvcm1hdChhcmdzKSB7CiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXJncy50cmFuc2FjdGlvbnM/Lm1hcCgodHJhbnNhY3Rpb24pID0+IHsKICAgICAgICAgIGlmICh0eXBlb2YgdHJhbnNhY3Rpb24gPT09ICJzdHJpbmciKQogICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXRUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAuLi5mb3JtYXR0ZWQsCiAgICAgICAgICAgIC4uLnRyYW5zYWN0aW9uLmdhdGV3YXlGZWUgPyB7CiAgICAgICAgICAgICAgZ2F0ZXdheUZlZTogaGV4VG9CaWdJbnQodHJhbnNhY3Rpb24uZ2F0ZXdheUZlZSksCiAgICAgICAgICAgICAgZ2F0ZXdheUZlZVJlY2lwaWVudDogdHJhbnNhY3Rpb24uZ2F0ZXdheUZlZVJlY2lwaWVudAogICAgICAgICAgICB9IDoge30sCiAgICAgICAgICAgIGZlZUN1cnJlbmN5OiB0cmFuc2FjdGlvbi5mZWVDdXJyZW5jeQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdHJhbnNhY3Rpb25zLAogICAgICAgICAgLi4uYXJncy5yYW5kb21uZXNzID8geyByYW5kb21uZXNzOiBhcmdzLnJhbmRvbW5lc3MgfSA6IHt9CiAgICAgICAgfTsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvbjogLyogQF9fUFVSRV9fICovIGRlZmluZVRyYW5zYWN0aW9uKHsKICAgICAgZm9ybWF0KGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy50eXBlID09PSAiMHg3ZSIpCiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpc1N5c3RlbVR4OiBhcmdzLmlzU3lzdGVtVHgsCiAgICAgICAgICAgIG1pbnQ6IGFyZ3MubWludCA/IGhleFRvQmlnSW50KGFyZ3MubWludCkgOiB2b2lkIDAsCiAgICAgICAgICAgIHNvdXJjZUhhc2g6IGFyZ3Muc291cmNlSGFzaCwKICAgICAgICAgICAgdHlwZTogImRlcG9zaXQiCiAgICAgICAgICB9OwogICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0geyBmZWVDdXJyZW5jeTogYXJncy5mZWVDdXJyZW5jeSB9OwogICAgICAgIGlmIChhcmdzLnR5cGUgPT09ICIweDdiIikKICAgICAgICAgIHRyYW5zYWN0aW9uLnR5cGUgPSAiY2lwNjQiOwogICAgICAgIGVsc2UgewogICAgICAgICAgaWYgKGFyZ3MudHlwZSA9PT0gIjB4N2MiKQogICAgICAgICAgICB0cmFuc2FjdGlvbi50eXBlID0gImNpcDQyIjsKICAgICAgICAgIHRyYW5zYWN0aW9uLmdhdGV3YXlGZWUgPSBhcmdzLmdhdGV3YXlGZWUgPyBoZXhUb0JpZ0ludChhcmdzLmdhdGV3YXlGZWUpIDogbnVsbDsKICAgICAgICAgIHRyYW5zYWN0aW9uLmdhdGV3YXlGZWVSZWNpcGllbnQgPSBhcmdzLmdhdGV3YXlGZWVSZWNpcGllbnQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgICAgfQogICAgfSksCiAgICB0cmFuc2FjdGlvblJlcXVlc3Q6IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVUcmFuc2FjdGlvblJlcXVlc3QoewogICAgICBmb3JtYXQoYXJncykgewogICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7fTsKICAgICAgICBpZiAoYXJncy5mZWVDdXJyZW5jeSkKICAgICAgICAgIHJlcXVlc3QuZmVlQ3VycmVuY3kgPSBhcmdzLmZlZUN1cnJlbmN5OwogICAgICAgIGlmIChpc0NJUDY0KGFyZ3MpKQogICAgICAgICAgcmVxdWVzdC50eXBlID0gIjB4N2IiOwogICAgICAgIHJldHVybiByZXF1ZXN0OwogICAgICB9CiAgICB9KQogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jZWxvL3NlcmlhbGl6ZXJzLmpzCiAgaW5pdF9udW1iZXIoKTsKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2Jhc2UoKTsKICBpbml0X2NoYWluKCk7CiAgaW5pdF9ub2RlKCk7CiAgaW5pdF9pc0FkZHJlc3MoKTsKICBpbml0X2NvbmNhdCgpOwogIGluaXRfdG9IZXgoKTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbjQodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkgewogICAgaWYgKGlzQ0lQNjQodHJhbnNhY3Rpb24pKQogICAgICByZXR1cm4gc2VyaWFsaXplVHJhbnNhY3Rpb25DSVA2NCh0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICAgIHJldHVybiBzZXJpYWxpemVUcmFuc2FjdGlvbjModHJhbnNhY3Rpb24sIHNpZ25hdHVyZSk7CiAgfQogIHZhciBzZXJpYWxpemVyczMgPSB7CiAgICB0cmFuc2FjdGlvbjogc2VyaWFsaXplVHJhbnNhY3Rpb240CiAgfTsKICBmdW5jdGlvbiBzZXJpYWxpemVUcmFuc2FjdGlvbkNJUDY0KHRyYW5zYWN0aW9uLCBzaWduYXR1cmUpIHsKICAgIGFzc2VydFRyYW5zYWN0aW9uQ0lQNjQodHJhbnNhY3Rpb24pOwogICAgY29uc3QgeyBjaGFpbklkLCBnYXMsIG5vbmNlLCB0bywgdmFsdWUsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGFjY2Vzc0xpc3QsIGZlZUN1cnJlbmN5LCBkYXRhIH0gPSB0cmFuc2FjdGlvbjsKICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IFsKICAgICAgdG9IZXgoY2hhaW5JZCksCiAgICAgIG5vbmNlID8gdG9IZXgobm9uY2UpIDogIjB4IiwKICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMgPyB0b0hleChtYXhQcmlvcml0eUZlZVBlckdhcykgOiAiMHgiLAogICAgICBtYXhGZWVQZXJHYXMgPyB0b0hleChtYXhGZWVQZXJHYXMpIDogIjB4IiwKICAgICAgZ2FzID8gdG9IZXgoZ2FzKSA6ICIweCIsCiAgICAgIHRvID8/ICIweCIsCiAgICAgIHZhbHVlID8gdG9IZXgodmFsdWUpIDogIjB4IiwKICAgICAgZGF0YSA/PyAiMHgiLAogICAgICBzZXJpYWxpemVBY2Nlc3NMaXN0KGFjY2Vzc0xpc3QpLAogICAgICBmZWVDdXJyZW5jeSwKICAgICAgLi4udG9ZUGFyaXR5U2lnbmF0dXJlQXJyYXkodHJhbnNhY3Rpb24sIHNpZ25hdHVyZSkKICAgIF07CiAgICByZXR1cm4gY29uY2F0SGV4KFsKICAgICAgIjB4N2IiLAogICAgICB0b1JscChzZXJpYWxpemVkVHJhbnNhY3Rpb24pCiAgICBdKTsKICB9CiAgdmFyIE1BWF9NQVhfRkVFX1BFUl9HQVMgPSBtYXhVaW50MjU2OwogIGZ1bmN0aW9uIGFzc2VydFRyYW5zYWN0aW9uQ0lQNjQodHJhbnNhY3Rpb24pIHsKICAgIGNvbnN0IHsgY2hhaW5JZCwgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIGdhc1ByaWNlLCBtYXhGZWVQZXJHYXMsIHRvLCBmZWVDdXJyZW5jeSB9ID0gdHJhbnNhY3Rpb247CiAgICBpZiAoY2hhaW5JZCA8PSAwKQogICAgICB0aHJvdyBuZXcgSW52YWxpZENoYWluSWRFcnJvcih7IGNoYWluSWQgfSk7CiAgICBpZiAodG8gJiYgIWlzQWRkcmVzcyh0bykpCiAgICAgIHRocm93IG5ldyBJbnZhbGlkQWRkcmVzc0Vycm9yKHsgYWRkcmVzczogdG8gfSk7CiAgICBpZiAoZ2FzUHJpY2UpCiAgICAgIHRocm93IG5ldyBCYXNlRXJyb3IyKCJgZ2FzUHJpY2VgIGlzIG5vdCBhIHZhbGlkIENJUC02NCBUcmFuc2FjdGlvbiBhdHRyaWJ1dGUuIik7CiAgICBpZiAoaXNQcmVzZW50KG1heEZlZVBlckdhcykgJiYgbWF4RmVlUGVyR2FzID4gTUFYX01BWF9GRUVfUEVSX0dBUykKICAgICAgdGhyb3cgbmV3IEZlZUNhcFRvb0hpZ2hFcnJvcih7IG1heEZlZVBlckdhcyB9KTsKICAgIGlmIChpc1ByZXNlbnQobWF4UHJpb3JpdHlGZWVQZXJHYXMpICYmIGlzUHJlc2VudChtYXhGZWVQZXJHYXMpICYmIG1heFByaW9yaXR5RmVlUGVyR2FzID4gbWF4RmVlUGVyR2FzKQogICAgICB0aHJvdyBuZXcgVGlwQWJvdmVGZWVDYXBFcnJvcih7IG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSk7CiAgICBpZiAoaXNQcmVzZW50KGZlZUN1cnJlbmN5KSAmJiAhaXNBZGRyZXNzKGZlZUN1cnJlbmN5KSkgewogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiYGZlZUN1cnJlbmN5YCBNVVNUIGJlIGEgdG9rZW4gYWRkcmVzcyBmb3IgQ0lQLTY0IHRyYW5zYWN0aW9ucy4iKTsKICAgIH0KICAgIGlmIChpc0VtcHR5KGZlZUN1cnJlbmN5KSkgewogICAgICB0aHJvdyBuZXcgQmFzZUVycm9yMigiYGZlZUN1cnJlbmN5YCBtdXN0IGJlIHByb3ZpZGVkIGZvciBDSVAtNjQgdHJhbnNhY3Rpb25zLiIpOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NlbG8vY2hhaW5Db25maWcuanMKICB2YXIgY2hhaW5Db25maWczID0gewogICAgY29udHJhY3RzLAogICAgZm9ybWF0dGVyczogZm9ybWF0dGVyczMsCiAgICBzZXJpYWxpemVyczogc2VyaWFsaXplcnMzLAogICAgZmVlcwogIH07CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Vsby5qcwogIHZhciBjZWxvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMywKICAgIGlkOiA0MjIyMCwKICAgIG5hbWU6ICJDZWxvIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNFTE8iLAogICAgICBzeW1ib2w6ICJDRUxPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZm9ybm8uY2Vsby5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDZWxvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2NlbG9zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5jZWxvc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTMxMTI1OTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2Vsb0FsZmFqb3Jlcy5qcwogIHZhciBzb3VyY2VJZDEzID0gMTdlMzsKICB2YXIgY2Vsb0FsZmFqb3JlcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzMsCiAgICBpZDogNDQ3ODcsCiAgICBuYW1lOiAiQWxmYWpvcmVzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNFTE8iLAogICAgICBzeW1ib2w6ICJBLUNFTE8iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FsZmFqb3Jlcy1mb3Juby5jZWxvLXRlc3RuZXQub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2VsbyBBbGZham9yZXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY2Vsby1hbGZham9yZXMuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vY2Vsby1hbGZham9yZXMuYmxvY2tzY291dC5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMy5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0NTY5MDAxCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4ODI1MjczNTM5MjdkOEQwNjliM0I0NTI5MDRjOTQyZEExNDlCQTM4MSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4RTI4QUFkY2Q5ODgzNzQ2YzBlNTA2OEY1OGY5ZWEwNjAyN2IyMTRjYiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg0YTI2MzVlOWU0ZjZlNDU4MTdiMUQ0MDJhYzQ5MDRjMWQxNzUyNDM4IiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxMTMyNAogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDEzXTogewogICAgICAgICAgYWRkcmVzczogIjB4RDFCMEUwNTgxOTczYzllQjdmODg2OTY3QTYwNmI5NDQxQTg5NzAzNyIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0MTEzMjQKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2hhbmcuanMKICB2YXIgY2hhbmcgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU4NTgsCiAgICBuYW1lOiAiQ2hhbmcgQ2hhaW4gRm91bmRhdGlvbiBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNUSCIsCiAgICAgIHN5bWJvbDogIkNUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmN0aHNjYW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hhbmcgQ2hhaW4gZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY3Roc2Nhbi5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jaGlsaXouanMKICB2YXIgY2hpbGl6ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODg4OCwKICAgIG5hbWU6ICJDaGlsaXogQ2hhaW4iLAogICAgbmV0d29yazogImNoaWxpei1jaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDSFoiLAogICAgICBzeW1ib2w6ICJDSFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmFua3IuY29tL2NoaWxpeiIsCiAgICAgICAgICAiaHR0cHM6Ly9jaGlsaXotcnBjLnB1YmxpY25vZGUuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hpbGl6IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uY2hpbGl6LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLmNoaWxpei5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY2hpcHMuanMKICB2YXIgY2hpcHMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4ODIsCiAgICBuYW1lOiAiQ2hpcHMgTmV0d29yayIsCiAgICBuZXR3b3JrOiAiQ0hJUFMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSU9UQSIsCiAgICAgIHN5bWJvbDogIklPVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vbm9kZS5jaGlwcy5vb28vd2FzcC9hcGkvdjEvY2hhaW5zL2lvdGExcHAzZDNtbmFwM3VmbWdxbmpzbnczNDRzcW1mNXN2amgyNnkya2hubWM4OXN2Njc4OHkzcjIwN2E4Zm4vZXZtIgogICAgICAgIF0KICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2NsYXNzaWMuanMKICB2YXIgY2xhc3NpYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjEsCiAgICBuYW1lOiAiRXRoZXJldW0gQ2xhc3NpYyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEMiLAogICAgICBzeW1ib2w6ICJFVEMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldGMucml2ZXQubGluayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5jb20vZXRjL21haW5uZXQiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb25mbHV4RVNwYWNlLmpzCiAgdmFyIGNvbmZsdXhFU3BhY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMzAsCiAgICBuYW1lOiAiQ29uZmx1eCBlU3BhY2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkNvbmZsdXgiLCBzeW1ib2w6ICJDRlgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0uY29uZmx1eHJwYy5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtLmNvbmZsdXhycGMuY29tL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ29uZmx1eFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtLmNvbmZsdXhzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhFRmYwMDc4OTEwZjYzOGNkODE5OTZjYzExN2JjY0QzZURmMkIwNzJGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY4NjAyOTM1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb25mbHV4RVNwYWNlVGVzdG5ldC5qcwogIHZhciBjb25mbHV4RVNwYWNlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzEsCiAgICBuYW1lOiAiQ29uZmx1eCBlU3BhY2UgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiY2Z4LWVzcGFjZS10ZXN0bmV0IiwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQ29uZmx1eCIsIHN5bWJvbDogIkNGWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V2bXRlc3RuZXQuY29uZmx1eHJwYy5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtdGVzdG5ldC5jb25mbHV4cnBjLmNvbS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvbmZsdXhTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bXRlc3RuZXQuY29uZmx1eHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEVGZjAwNzg5MTBmNjM4Y2Q4MTk5NmNjMTE3YmNjRDNlRGYyQjA3MkYiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE3NDk5MDUwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jb3JlRGFvLmpzCiAgdmFyIGNvcmVEYW8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTYsCiAgICBuYW1lOiAiQ29yZSBEYW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ29yZSIsCiAgICAgIHN5bWJvbDogIkNPUkUiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuY29yZWRhby5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDb3JlRGFvIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uY29yZWRhby5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE5MDc5MzQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3JhYi5qcwogIHZhciBjcmFiID0gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ0LAogICAgbmFtZTogIkNyYWIgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDcmFiIE5ldHdvcmsgTmF0aXZlIFRva2VuIiwKICAgICAgc3ltYm9sOiAiQ1JBQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vY3JhYi1ycGMuZGFyd2luaWEubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9jcmFiLXJwYy5kYXJ3aW5pYS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsgbmFtZTogIkJsb2Nrc2NvdXQiLCB1cmw6ICJodHRwczovL2NyYWItc2Nhbi5kYXJ3aW5pYS5uZXR3b3JrIiB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwMzI1OTMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb25vcy5qcwogIHZhciBjcm9ub3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1LAogICAgbmFtZTogIkNyb25vcyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyb25vcyIsCiAgICAgIHN5bWJvbDogIkNSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmNyb25vcy5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXItYXBpLmNyb25vcy5vcmcvbWFpbm5ldC9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTk2MzExMgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3Jvbm9zVGVzdG5ldC5qcwogIHZhciBjcm9ub3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMzgsCiAgICBuYW1lOiAiQ3Jvbm9zIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiQ1JPIiwKICAgICAgc3ltYm9sOiAidENSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS10My5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Nyb25vcy5vcmcvZXhwbG9yZXIvdGVzdG5ldDMiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTAxOTEyNTEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9jcm9ub3N6a0VWTS5qcwogIHZhciBjcm9ub3N6a0VWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzg4LAogICAgbmFtZTogIkNyb25vcyB6a0VWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNyb25vcyB6a0VWTSBDUk8iLAogICAgICBzeW1ib2w6ICJ6a0NSTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQuemtldm0uY3Jvbm9zLm9yZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNyb25vcyB6a0VWTSAoTWFpbm5ldCkgQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtldm0uY3Jvbm9zLm9yZyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb25vc3prRVZNVGVzdG5ldC5qcwogIHZhciBjcm9ub3N6a0VWTVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4MiwKICAgIG5hbWU6ICJDcm9ub3MgemtFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDcm9ub3MgemtFVk0gVGVzdCBDb2luIiwKICAgICAgc3ltYm9sOiAiemtUQ1JPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC56a2V2bS5jcm9ub3Mub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3Jvbm9zIHprRVZNIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtldm0uY3Jvbm9zLm9yZy90ZXN0bmV0IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Nyb3NzYmVsbC5qcwogIHZhciBjcm9zc2JlbGwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM3MzcsCiAgICBuYW1lOiAiQ3Jvc3NiZWxsIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkNTQiIsCiAgICAgIHN5bWJvbDogIkNTQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNyb3NzYmVsbC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNyb3NzU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmNyb3NzYmVsbC5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLmNyb3NzYmVsbC5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzgyNDYwMzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2N1cnRpcy5qcwogIHZhciBjdXJ0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMTExLAogICAgbmFtZTogIkN1cnRpcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiQXBlQ29pbiIsIHN5bWJvbDogIkFQRSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5jdXJ0aXMuYXBlY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ3VydGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmN1cnRpcy5hcGVjaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvY3liZXIuanMKICB2YXIgY3liZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc1NjAsCiAgICBuYW1lOiAiQ3liZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vY3liZXIuYWx0LnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2N5YmVyc2Nhbi5jbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jeWJlcnNjYW4uY28vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2N5YmVyVGVzdG5ldC5qcwogIHZhciBjeWJlclRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTU1NzU2MCwKICAgIG5hbWU6ICJDeWJlciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2N5YmVyLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuY3liZXJzY2FuLmNvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuY3liZXJzY2FuLmNvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZmZjMzkxRjAwMTgyNjlkNDc1OEFFQTFhMTQ0NzcyRThGQjk5NTQ1RSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDQ1NDUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kYXJ3aW5pYS5qcwogIHZhciBkYXJ3aW5pYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDYsCiAgICBuYW1lOiAiRGFyd2luaWEgTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJSSU5HIiwKICAgICAgc3ltYm9sOiAiUklORyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmRhcndpbmlhLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmRhcndpbmlhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiRXhwbG9yZXIiLCB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRhcndpbmlhLm5ldHdvcmsiIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjk0MjAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RjaGFpbi5qcwogIHZhciBkY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDI3MTY0NDY0Mjk4MzdlMywKICAgIG5hbWU6ICJEY2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZGNoYWluLTI3MTY0NDY0Mjk4MzcwMDAtMS5qc29ucnBjLnNhZ2FycGMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEY2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZGNoYWluLTI3MTY0NDY0Mjk4MzcwMDAtMS5zYWdhZXhwbG9yZXIuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWRjaGFpbi0yNzE2NDQ2NDI5ODM3MDAwLTEuc2FnYWV4cGxvcmVyLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzCiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZGNoYWluVGVzdG5ldC5qcwogIHZhciBkY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyNzEzMDE3OTk3NTc4ZTMsCiAgICBuYW1lOiAiRGNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly9kY2hhaW50ZXN0bmV0LTI3MTMwMTc5OTc1NzgwMDAtMS5qc29ucnBjLnRlc3RuZXQuc2FnYXJwYy5pbyIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRjaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kY2hhaW50ZXN0bmV0LTI3MTMwMTc5OTc1NzgwMDAtMS50ZXN0bmV0LnNhZ2FleHBsb3Jlci5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktZGNoYWludGVzdG5ldC0yNzEzMDE3OTk3NTc4MDAwLTEudGVzdG5ldC5zYWdhZXhwbG9yZXIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMKICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZWZpY2hhaW5Fdm0uanMKICB2YXIgZGVmaWNoYWluRXZtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTMwLAogICAgbmV0d29yazogImRlZmljaGFpbi1ldm0iLAogICAgbmFtZTogIkRlRmlDaGFpbiBFVk0gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRGVGaUNoYWluIiwKICAgICAgc3ltYm9sOiAiREZJIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2V0aC5tYWlubmV0Lm9jZWFuLmplbGx5ZmlzaHNkay5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEZUZpU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tZXRhLmRlZmlzY2FuLmxpdmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTM3ODUyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZWZpY2hhaW5Fdm1UZXN0bmV0LmpzCiAgdmFyIGRlZmljaGFpbkV2bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMzEsCiAgICBuZXR3b3JrOiAiZGVmaWNoYWluLWV2bS10ZXN0bmV0IiwKICAgIG5hbWU6ICJEZUZpQ2hhaW4gRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRlRmlDaGFpbiIsCiAgICAgIHN5bWJvbDogIkRGSSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgudGVzdG5ldC5vY2Vhbi5qZWxseWZpc2hzZGsuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRGVGaVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbWV0YS5kZWZpc2Nhbi5saXZlLz9uZXR3b3JrPVRlc3ROZXQiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTU2NDYyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZGVnZW4uanMKICB2YXIgZGVnZW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY2NjY2NjY2NiwKICAgIG5hbWU6ICJEZWdlbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJEZWdlbiIsCiAgICAgIHN5bWJvbDogIkRFR0VOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZGVnZW4udGlwcyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZGVnZW4udGlwcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRlZ2VuIENoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRlZ2VuLnRpcHMiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZGVnZW4udGlwcy9hcGkvdjIiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kZmsuanMKICB2YXIgZGZrID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MzkzNSwKICAgIG5hbWU6ICJERksgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSmV3ZWwiLAogICAgICBzeW1ib2w6ICJKRVdFTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc3VibmV0cy5hdmF4Lm5ldHdvcmsvZGVmaS1raW5nZG9tcy9kZmstY2hhaW4vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiREZLU3VibmV0U2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zdWJuZXRzLmF2YXgubmV0d29yay9kZWZpLWtpbmdkb21zIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0NzkwNTUxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kb2RvY2hhaW5UZXN0bmV0LmpzCiAgdmFyIGRvZG9jaGFpblRlc3RuZXQgPSBkZWZpbmVDaGFpbih7CiAgICBpZDogNTM0NTcsCiAgICBuYW1lOiAiRE9ET2NoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiRE9ETyIsIHN5bWJvbDogIkRPRE8iIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZG9kb2NoYWluLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZG9kb2NoYWluLXRlc3RuZXQuYWx0LnRlY2hub2xvZ3kvd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJET0RPY2hhaW4gVGVzdG5ldCAoU2Vwb2xpYSkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1zY2FuLmRvZG9jaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZG9nZWNoYWluLmpzCiAgdmFyIGRvZ2VjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMmUzLAogICAgbmFtZTogIkRvZ2VjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJXcmFwcGVkIERvZ2Vjb2luIiwKICAgICAgc3ltYm9sOiAiV0RPR0UiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZG9nZWNoYWluLmRvZyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRvZ2VDaGFpbkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmRvZ2VjaGFpbi5kb2ciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZG9nZWNoYWluLmRvZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDY4YTg2MDlhNjBhMDA4RUZBNjMzZGZkZWM1OTJjMDNCMDMwY0M1MDgiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjUzODQwMzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Rvc0NoYWluLmpzCiAgdmFyIGRvc0NoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3OTc5LAogICAgbmFtZTogIkRPUyBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJET1MgQ2hhaW4iLAogICAgICBzeW1ib2w6ICJET1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWluLmRvc2NoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRPUyBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kb3NjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmRvc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjE5MDgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Rvc0NoYWluVGVzdG5ldC5qcwogIHZhciBkb3NDaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM5MzksCiAgICBuYW1lOiAiRE9TIENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRE9TIENoYWluIFRlc3RuZXQiLAogICAgICBzeW1ib2w6ICJET1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly90ZXN0LmRvc2NoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkRPUyBDaGFpbiBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3QuZG9zY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS10ZXN0LmRvc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2OTYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2RyZXllcnhNYWlubmV0LmpzCiAgdmFyIGRyZXllcnhNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzQ1MSwKICAgIG5hbWU6ICJEcmV5ZXJYIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkRyZXllclgiLAogICAgICBzeW1ib2w6ICJEUlgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmRyZXllcnguY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRHJleWVyWCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4uZHJleWVyeC5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9kcmV5ZXJ4VGVzdG5ldC5qcwogIHZhciBkcmV5ZXJ4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjM0NTIsCiAgICBuYW1lOiAiRHJleWVyWCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJEcmV5ZXJYIiwKICAgICAgc3ltYm9sOiAiRFJYIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vdGVzdG5ldC1ycGMuZHJleWVyeC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEcmV5ZXJYIFRlc3RuZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXNjYW4uZHJleWVyeC5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZHVzdGJveUlvVC5qcwogIHZhciBkdXN0Ym95SW9UID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NTU4ODgsCiAgICBuYW1lOiAiRHVzdEJveSBJb1QiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRFNUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZHVzdGJveS1ycGMuamlibDIuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kdXN0Ym95LmppYmwyLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9kdXN0Ym95LmppYmwyLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEZGRDM0YWEyQzYyQjJENTJFMDBBMzYxZTQ2NkMyMjk3ODhmNGVENmEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTI2NTY5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2R5bWVuc2lvbi5qcwogIHZhciBkeW1lbnNpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMDAsCiAgICBuYW1lOiAiRHltZW5zaW9uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJEWU0iLAogICAgICBzeW1ib2w6ICJEWU0iLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZHltZW5zaW9uLWV2bS1ycGMucHVibGljbm9kZS5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZHltZW5zaW9uLWV2bS1ycGMucHVibGljbm9kZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJEeW0gRllJIiwKICAgICAgICB1cmw6ICJodHRwczovL2R5bS5meWkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VkZ2VsZXNzLmpzCiAgdmFyIGVkZ2VsZXNzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDI2LAogICAgbmFtZTogIkVkZ2VsZXNzIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkVkZ2VsZXNzIFdyYXBwZWQgRVRIIiwKICAgICAgc3ltYm9sOiAiRXdFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmVkZ2VsZXNzLm5ldHdvcmsvaHR0cCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZWRnZWxlc3MubmV0d29yay93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVkZ2VsZXNzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmVkZ2VsZXNzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lZGdlbGVzc1Rlc3RuZXQuanMKICB2YXIgZWRnZWxlc3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDIsCiAgICBuYW1lOiAiRWRnZWxlc3MgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRWRnZWxlc3MgV3JhcHBlZCBFVEgiLAogICAgICBzeW1ib2w6ICJFd0VUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9lZGdlbGVzcy10ZXN0bmV0LnJwYy5jYWxkZXJhLnh5ei9odHRwIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2VkZ2VsZXNzLXRlc3RuZXQucnBjLmNhbGRlcmEueHl6L3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWRnZWxlc3MgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLmVkZ2VsZXNzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lZGdld2FyZS5qcwogIHZhciBlZGdld2FyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAyMSwKICAgIG5hbWU6ICJFZGdld2FyZSBFZGdlRVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRWRnZXdhcmUiLAogICAgICBzeW1ib2w6ICJFREciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9lZGdld2FyZS1ldm0uamVsbGllZG93bC5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFZGdzY2FuIGJ5IEJoYXJhdGhjb29yZyIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9lZGdzY2FuLmxpdmUiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZWRnc2Nhbi5saXZlL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxODExNzg3MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWRnZXdhcmVUZXN0bmV0LmpzCiAgdmFyIGVkZ2V3YXJlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAyMiwKICAgIG5hbWU6ICJCZXJlc2hlZXQgQmVyZUVWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRlc3RuZXQgRURHIiwKICAgICAgc3ltYm9sOiAidEVERyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2JlcmVzaGVldC1ldm0uamVsbGllZG93bC5uZXQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFZGdzY2FuIGJ5IEJoYXJhdGhjb29yZyIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmVkZ3NjYW4ubGl2ZSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmVkZ3NjYW4ubGl2ZS9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9la3RhLmpzCiAgdmFyIGVrdGEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTQsCiAgICBuYW1lOiAiRWt0YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFS1RBIiwKICAgICAgc3ltYm9sOiAiRUtUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW4uZWt0YS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVrdGFzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2VrdGFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2VrdGFzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VrdGFUZXN0bmV0LmpzCiAgdmFyIGVrdGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDA0LAogICAgbmFtZTogIkVrdGEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFS1RBIiwKICAgICAgc3ltYm9sOiAiRUtUQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3QuZWt0YS5pbzo4NTQ1Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVzdCBFa3Rhc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0LmVrdGFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3QuZWt0YXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsYXN0b3MuanMKICB2YXIgZWxhc3RvcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAsCiAgICBuYW1lOiAiRWxhc3RvcyBTbWFydCBDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRUxBIiwgc3ltYm9sOiAiRUxBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpMi5lbGFzdG9zLmlvL2V0aCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVsYXN0b3MgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXNjLmVsYXN0b3MuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsYXN0b3NUZXN0bmV0LmpzCiAgdmFyIGVsYXN0b3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMSwKICAgIG5hbWU6ICJFbGFzdG9zIFNtYXJ0IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInRFTEEiLCBzeW1ib2w6ICJ0RUxBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLXRlc3RuZXQuZWxhc3Rvcy5pby9ldGgiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFbGFzdG9zIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VzYy10ZXN0bmV0LmVsYXN0b3MuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZWxlY3Ryb25ldW0uanMKICB2YXIgZWxlY3Ryb25ldW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMDE0LAogICAgbmFtZTogIkVsZWN0cm9uZXVtIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkVUTiIsCiAgICAgIHN5bWJvbDogIkVUTiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZWxlY3Ryb25ldW0uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWxlY3Ryb25ldW0gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tleHBsb3Jlci5lbGVjdHJvbmV1bS5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VsZWN0cm9uZXVtVGVzdG5ldC5qcwogIHZhciBlbGVjdHJvbmV1bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMDE0MjAsCiAgICBuYW1lOiAiRWxlY3Ryb25ldW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRVROIiwKICAgICAgc3ltYm9sOiAiRVROIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLmVsZWN0cm9uZXVtLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVsZWN0cm9uZXVtIEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2NrZXhwbG9yZXIudGhlc2VjdXJpdHl0ZWFtLnJvY2tzIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2VseXNpdW1UZXN0bmV0LmpzCiAgdmFyIGVseXNpdW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxMzM4LAogICAgbmFtZTogIkVseXNpdW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJMQVZBIiwKICAgICAgc3ltYm9sOiAiTEFWQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZWx5c2l1bS10ZXN0LXJwYy52dWxjYW5mb3JnZWQuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRWx5c2l1bSB0ZXN0bmV0IGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VseXNpdW0tZXhwbG9yZXIudnVsY2FuZm9yZ2VkLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9lb24uanMKICB2YXIgZW9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MzMyLAogICAgbmFtZTogIkhvcml6ZW4gRU9OIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlpFTiIsCiAgICAgIHN5bWJvbDogIlpFTiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2Vvbi1ycGMuaG9yaXplbmxhYnMuaW8vZXRodjEiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFT04gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZW9uLWV4cGxvcmVyLmhvcml6ZW5sYWJzLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Vvcy5qcwogIHZhciBlb3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3Nzc3LAogICAgbmFtZTogIkVPUyBFVk0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRU9TIiwKICAgICAgc3ltYm9sOiAiRU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLmV2bS5lb3NuZXR3b3JrLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkVPUyBFVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLmVvc25ldHdvcmsuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmV2bS5lb3NuZXR3b3JrLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzk0MzkzMwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZW9zVGVzdG5ldC5qcwogIHZhciBlb3NUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU1NywKICAgIG5hbWU6ICJFT1MgRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRU9TIiwKICAgICAgc3ltYm9sOiAiRU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vYXBpLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRU9TIEVWTSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuZXZtLmVvc25ldHdvcmsuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5MDY3OTQwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXRoZXJsaW5rLmpzCiAgdmFyIGV0aGVybGluayA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI3OTMsCiAgICBuYW1lOiAiRXRoZXJsaW5rIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRleiIsCiAgICAgIHN5bWJvbDogIlhUWiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL25vZGUubWFpbm5ldC5ldGhlcmxpbmsuY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJsaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV0aGVybGluay5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzM4OTkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2V0aGVybGlua1Rlc3RuZXQuanMKICB2YXIgZXRoZXJsaW5rVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4MTIzLAogICAgbmFtZTogIkV0aGVybGluayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlRleiIsCiAgICAgIHN5bWJvbDogIlhUWiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL25vZGUuZ2hvc3RuZXQuZXRoZXJsaW5rLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybGluayBUZXN0bmV0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuZXRoZXJsaW5rLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9ldm1vcy5qcwogIHZhciBldm1vcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTAwMSwKICAgIG5hbWU6ICJFdm1vcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdm1vcyIsCiAgICAgIHN5bWJvbDogIkVWTU9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZXRoLmJkLmV2bW9zLm9yZzo4NTQ1Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXZtb3MgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXNjYW4ubGl2ZSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2V2bW9zVGVzdG5ldC5qcwogIHZhciBldm1vc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDllMywKICAgIG5hbWU6ICJFdm1vcyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV2bW9zIiwKICAgICAgc3ltYm9sOiAiRVZNT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldGguYmQuZXZtb3MuZGV2Ojg1NDUiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdm1vcyBUZXN0bmV0IEJsb2NrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bS5ldm1vcy5kZXYvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZXhjZWxvbk1haW5uZXQuanMKICB2YXIgZXhjZWxvbk1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMDUyMDAyLAogICAgbmFtZTogIkV4Y2Vsb24gTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiWExPTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFeGNlbG9uIiwKICAgICAgc3ltYm9sOiAieGxvbiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZWRnZXdhbGxldDEueGxvbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeGNlbG9uIGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4Y2Vsb24uaW8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mYW50b20uanMKICB2YXIgZmFudG9tID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNTAsCiAgICBuYW1lOiAiRmFudG9tIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZhbnRvbSIsCiAgICAgIHN5bWJvbDogIkZUTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5hbmtyLmNvbS9mYW50b20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGVE1TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Z0bXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5mdG1zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzMwMDE5ODcKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZhbnRvbVNvbmljVGVzdG5ldC5qcwogIHZhciBmYW50b21Tb25pY1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY0MjQwLAogICAgbmFtZTogIkZhbnRvbSBTb25pYyBPcGVuIFRlc3RuZXQiLAogICAgbmV0d29yazogImZhbnRvbS1zb25pYy10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZhbnRvbSIsCiAgICAgIHN5bWJvbDogIkZUTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwY2FwaS5zb25pYy5mYW50b20ubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZhbnRvbSBTb25pYyBPcGVuIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcHVibGljLXNvbmljLmZhbnRvbS5uZXR3b3JrIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZhbnRvbVRlc3RuZXQuanMKICB2YXIgZmFudG9tVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDAwMiwKICAgIG5hbWU6ICJGYW50b20gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGYW50b20iLAogICAgICBzeW1ib2w6ICJGVE0iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5mYW50b20ubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZUTVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mdG1zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmZ0bXNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA4MzI4Njg4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmliby5qcwogIHZhciBmaWJvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMwNiwKICAgIG5hbWU6ICJGaWJvIENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogImZpYm8iLAogICAgICBzeW1ib2w6ICJGSUJPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vbmV0d29yay5oenJvYy5hcnQiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGaWJvU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmZpYm9jaGFpbi5vcmciCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9maWxlY29pbi5qcwogIHZhciBmaWxlY29pbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzE0LAogICAgbmFtZTogIkZpbGVjb2luIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiZmlsZWNvaW4iLAogICAgICBzeW1ib2w6ICJGSUwiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkubm9kZS5nbGlmLmlvL3JwYy92MSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZpbGZveCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9maWxmb3guaW5mby9lbiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzI4NTk0CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9maWxlY29pbkNhbGlicmF0aW9uLmpzCiAgdmFyIGZpbGVjb2luQ2FsaWJyYXRpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxNDE1OSwKICAgIG5hbWU6ICJGaWxlY29pbiBDYWxpYnJhdGlvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJ0ZXN0bmV0IGZpbGVjb2luIiwKICAgICAgc3ltYm9sOiAidEZJTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5jYWxpYnJhdGlvbi5ub2RlLmdsaWYuaW8vcnBjL3YxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRmlsc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jYWxpYnJhdGlvbi5maWxzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ZpbGVjb2luSHlwZXJzcGFjZS5qcwogIHZhciBmaWxlY29pbkh5cGVyc3BhY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxNDEsCiAgICBuYW1lOiAiRmlsZWNvaW4gSHlwZXJzcGFjZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJ0ZXN0bmV0IGZpbGVjb2luIiwKICAgICAgc3ltYm9sOiAidEZJTCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS5oeXBlcnNwYWNlLm5vZGUuZ2xpZi5pby9ycGMvdjEiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJGaWxmb3giLAogICAgICAgIHVybDogImh0dHBzOi8vaHlwZXJzcGFjZS5maWxmb3guaW5mby9lbiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbGFyZS5qcwogIHZhciBmbGFyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTQsCiAgICBuYW1lOiAiRmxhcmUgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGbGFyZSIsCiAgICAgIHN5bWJvbDogIkZMUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2ZsYXJlLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZsYXJlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2ZsYXJlLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZmxhcmUtZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzAwMjQ2MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmxhcmVUZXN0bmV0LmpzCiAgdmFyIGZsYXJlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTE0LAogICAgbmFtZTogIkZsYXJlIFRlc3RuZXQgQ29zdG9uMiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3N0b24yIEZsYXJlIiwKICAgICAgc3ltYm9sOiAiQzJGTFIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9jb3N0b24yLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvc3RvbjIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vY29zdG9uMi1leHBsb3Jlci5mbGFyZS5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Nvc3RvbjItZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmxvd01haW5uZXQuanMKICB2YXIgZmxvd01haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc0NywKICAgIG5hbWU6ICJGbG93RVZNIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRmxvdyIsCiAgICAgIHN5bWJvbDogIkZMT1ciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuZXZtLm5vZGVzLm9uZmxvdy5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Zsb3dkaXZlci5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Zsb3dQcmV2aWV3bmV0LmpzCiAgdmFyIGZsb3dQcmV2aWV3bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2NDYsCiAgICBuYW1lOiAiRmxvd0VWTSBQcmV2aWV3bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkZsb3ciLAogICAgICBzeW1ib2w6ICJGTE9XIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wcmV2aWV3bmV0LmV2bS5ub2Rlcy5vbmZsb3cub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUHJldmlld25ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wcmV2aWV3bmV0LmZsb3dkaXZlci5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MjA1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbG93VGVzdG5ldC5qcwogIHZhciBmbG93VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTQ1LAogICAgbmFtZTogIkZsb3dFVk0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJGbG93IiwKICAgICAgc3ltYm9sOiAiRkxPVyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ldm0ubm9kZXMub25mbG93Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZsb3cgRGl2ZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mbG93ZGl2ZXIuaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTM3NTE4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbHVlbmNlLmpzCiAgdmFyIGZsdWVuY2UgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk5OTk5OTksCiAgICBuYW1lOiAiRmx1ZW5jZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRkxUIiwgc3ltYm9sOiAiRkxUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQuZmx1ZW5jZS5kZXYiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MubWFpbm5ldC5mbHVlbmNlLmRldiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYWlubmV0LmZsdWVuY2UuZGV2IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2Nrc2NvdXQubWFpbm5ldC5mbHVlbmNlLmRldi9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mbHVlbmNlU3RhZ2UuanMKICB2YXIgZmx1ZW5jZVN0YWdlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjM0MjAwMDAyMjAsCiAgICBuYW1lOiAiRmx1ZW5jZSBTdGFnZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEZMVCIsIHN5bWJvbDogInRGTFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RhZ2UuZmx1ZW5jZS5kZXYiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3Muc3RhZ2UuZmx1ZW5jZS5kZXYiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQuc3RhZ2UuZmx1ZW5jZS5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5zdGFnZS5mbHVlbmNlLmRldi9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZmx1ZW5jZVRlc3RuZXQuanMKICB2YXIgZmx1ZW5jZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUyMTY0ODAzLAogICAgbmFtZTogIkZsdWVuY2UgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEZMVCIsIHN5bWJvbDogInRGTFQiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5mbHVlbmNlLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy50ZXN0bmV0LmZsdWVuY2UuZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnRlc3RuZXQuZmx1ZW5jZS5kZXYiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC50ZXN0bmV0LmZsdWVuY2UuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mb3JtYS5qcwogIHZhciBmb3JtYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTg0MTIyLAogICAgbmFtZTogIkZvcm1hIiwKICAgIG5ldHdvcms6ICJmb3JtYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBzeW1ib2w6ICJUSUEiLAogICAgICBuYW1lOiAiVElBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5mb3JtYS5hcnQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MuZm9ybWEuYXJ0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRm9ybWEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZm9ybWEuYXJ0IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhkNTNDNkZGQjEyM0Y3MzQ5QTMyOTgwRjg3ZmFlRDhGZkRjOWVmMDc5IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1MjcwNQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZm91bmRyeS5qcwogIHZhciBmb3VuZHJ5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMTMzNywKICAgIG5hbWU6ICJGb3VuZHJ5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkV0aGVyIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovLzEyNy4wLjAuMTo4NTQ1Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzOi8vMTI3LjAuMC4xOjg1NDUiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnJheHRhbC5qcwogIHZhciBzb3VyY2VJZDE0ID0gMTsKICB2YXIgZnJheHRhbCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjUyLAogICAgbmFtZTogIkZyYXh0YWwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZyYXggRXRoZXIiLCBzeW1ib2w6ICJmcnhFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZnJheC5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJmcmF4c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mcmF4c2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmZyYXhzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDY2Q0M5MTZFZDVDNkMyRkE5NzAxNGY3RDFjRDE0MTUyOEFlMTcxZTQiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMTRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzNmNiNjVjMTk2N0EwRmIwRUVFMTE1NjlDNTFDMmYyYUExQ2E2ZjZEIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMTkxMzUzMjMKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQxNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDM0QzBiRDU4NzdBNUVlNzA5OUQwZjU2ODhENjVGNGJCOTE1OEJERTIiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTEzNTMyMwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnJheHRhbFRlc3RuZXQuanMKICB2YXIgc291cmNlSWQxNSA9IDE3ZTM7CiAgdmFyIGZyYXh0YWxUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAyNTIyLAogICAgbmFtZTogIkZyYXh0YWwgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnJheCBFdGhlciIsIHN5bWJvbDogImZyeEVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmZyYXguY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiZnJheHNjYW4gdGVzdG5ldCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ob2xlc2t5LmZyYXhzY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktaG9sZXNreS5mcmF4c2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMTVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MTVFQTY0REExM0Y0ZDA4MzFlY2U0QWQzRThjMWFhMDEzMTY3RjMyIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDE1XTogewogICAgICAgICAgYWRkcmVzczogIjB4QjljNjRCZkE0OThkNWI5YTgzOThFZDZmNDZlYjc2ZDkwZEU1NTA1ZCIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxODQxNgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDE1XTogewogICAgICAgICAgYWRkcmVzczogIjB4MEJhYWZDMjE3MTYyZjY0OTMwOTA5YUQ5ZjJCMjcxMjUxMjFkNjMzMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxODQxNgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE1CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVua2lNYWlubmV0LmpzCiAgdmFyIHNvdXJjZUlkMTYgPSAxOwogIHZhciBmdW5raU1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDMzOTc5LAogICAgbmFtZTogIkZ1bmtpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy1tYWlubmV0LmZ1bmtpY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRnVua2kgTWFpbm5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mdW5raXNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cwogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE2CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVua2lTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMTcgPSAxMTE1NTExMTsKICB2YXIgZnVua2lTZXBvbGlhID0gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDMzOTc5MDEsCiAgICBuZXR3b3JrOiAiZnVua2lTZXBvbGlhIiwKICAgIG5hbWU6ICJGdW5raSBTZXBvbGlhIFNhbmRib3giLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZnVua2ktdGVzdG5ldC5hbHQudGVjaG5vbG9neSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZ1bmtpIFNlcG9saWEgU2FuZGJveCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLXNhbmRib3guZnVua2ljaGFpbi5jb20vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjIwMjA0CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQxNwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2Z1c2UuanMKICB2YXIgZnVzZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIyLAogICAgbmFtZTogIkZ1c2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZ1c2UiLCBzeW1ib2w6ICJGVVNFIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5mdXNlLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRnVzZSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5mdXNlLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmZ1c2UuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MTQ2NjI4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdXNlU3BhcmtuZXQuanMKICB2YXIgZnVzZVNwYXJrbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMsCiAgICBuYW1lOiAiRnVzZSBTcGFya25ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3BhcmsiLCBzeW1ib2w6ICJTUEFSSyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZnVzZXNwYXJrLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3BhcmtlbnQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZnVzZXNwYXJrLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmZ1c2VzcGFyay5pby9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9mdXNpb24uanMKICB2YXIgZnVzaW9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjY1OSwKICAgIG5hbWU6ICJGdXNpb24gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnVzaW9uIiwgc3ltYm9sOiAiRlNOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5mdXNpb25uZXR3b3JrLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuZnVzaW9ubmV0d29yay5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZTTnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZnNuc2Nhbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTA0NDE2MDUKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZnVzaW9uVGVzdG5ldC5qcwogIHZhciBmdXNpb25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjY4OCwKICAgIG5hbWU6ICJGdXNpb24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRnVzaW9uIiwgc3ltYm9sOiAiRlNOIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5mdXNpb25uZXR3b3JrLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQuZnVzaW9ubmV0d29yay5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZTTnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5mc25zY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQyODMwOQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dhcm5ldC5qcwogIHZhciBzb3VyY2VJZDE4ID0gMTdlMzsKICB2YXIgZ2FybmV0ID0gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgbmFtZTogIkdhcm5ldCBUZXN0bmV0IiwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBpZDogMTcwNjksCiAgICBzb3VyY2VJZDogc291cmNlSWQxOCwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5nYXJuZXRjaGFpbi5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmdhcm5ldGNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZ2FybmV0Y2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDU3ZWU0MDU4NmZiRTI4NkFmQzc1RTY3Y2I2OTUxMUE2RDlhRjU5MDkiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjc0Njg0CiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDE4XTogewogICAgICAgICAgYWRkcmVzczogIjB4Q2I4RTdBQzU2MWI4RUYwNEYyYTE1ODY1ZTlmYmMwNzY2RkVGNTY5QiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDEyNzQ2ODQKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQxOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDA5YmNEZDMxMUZFMzk4RjgwYTc4QkUzN0U0ODlmNUQ0NDBEQjk1REUiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjc0Njg0CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ2VuZXN5cy5qcwogIHZhciBnZW5lc3lzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjUwNywKICAgIG5hbWU6ICJHZW5lc3lzIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR1NZUyIsCiAgICAgIHN5bWJvbDogIkdTWVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ2VuZXN5cy5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR2VuZXN5cyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nY2hhaW5leHBsb3Jlci5nZW5lc3lzLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npcy5qcwogIHZhciBnbm9zaXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMCwKICAgIG5hbWU6ICJHbm9zaXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdub3Npc2NoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ25vc2lzY2hhaW4uY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkdub3Npc3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZ25vc2lzc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkuZ25vc2lzc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjEwMjI0OTEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dub3Npc0NoaWFkby5qcwogIHZhciBnbm9zaXNDaGlhZG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAwLAogICAgbmFtZTogIkdub3NpcyBDaGlhZG8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiR25vc2lzIiwKICAgICAgc3ltYm9sOiAieERBSSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNoaWFkb2NoYWluLm5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuY2hpYWRvY2hhaW4ubmV0L3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5jaGlhZG9jaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5NjczMTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9nb2JpLmpzCiAgdmFyIGdvYmkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NjMsCiAgICBuYW1lOiAiSG9yaXplbiBHb2JpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVzdCBaRU4iLAogICAgICBzeW1ib2w6ICJ0WkVOIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZ29iaS10ZXN0bmV0Lmhvcml6ZW5sYWJzLmlvL2V0aHYxIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiR29iaSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2JpLWV4cGxvcmVyLmhvcml6ZW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvQ2hhaW4uanMKICB2YXIgZ29DaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjAsCiAgICBuYW1lOiAiR29DaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJHTyIsCiAgICAgIHN5bWJvbDogIkdPIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmdvY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHb0NoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdvY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2dvZXJsaS5qcwogIHZhciBnb2VybGkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUsCiAgICBuYW1lOiAiR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJHb2VybGkgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vZXRoX2dvZXJsaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1nb2VybGkuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZmM0QUM3NUM0NkM5MTRhRjU4OTJkNmQzZUZGY2ViRDc5MTcyOTNGMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMzOTIwNgogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2NTA3NjcwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3Jhdml0eS5qcwogIHZhciBncmF2aXR5ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjI1LAogICAgbmFtZTogIkdyYXZpdHkgQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRyIsIHN5bWJvbDogIkciLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3Jhdml0eS54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHcmF2aXR5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmdyYXZpdHkueHl6L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZjhhYzRCRUIyRjc1ZDJjRkZiNTg4YzYzMjUxMzQ3ZmRENjI5QjkyYyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjg1MQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvZ3VydVRlc3RuZXQuanMKICB2YXIgZ3VydVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI2MSwKICAgIG5hbWU6ICJHdXJ1IE5ldHdvcmsgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAidGVzdEdVUlUiLAogICAgICBzeW1ib2w6ICJ0R1VSVSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuZ3VydW5ldHdvcmsuYWkvYXJjaGl2ZS8yNjEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJHdXJ1c2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLmd1cnVuZXR3b3JrLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhbS5qcwogIHZhciBoYW0gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUxMTIsCiAgICBuYW1lOiAiSGFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkhhbSIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmhhbS5mdW4iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmhhbS5mdW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIYW0gQ2hhaW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFtLmZ1biIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYW0uZnVuL2FwaS92MiIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcXFNYWlubmV0LmpzCiAgdmFyIGhhcXFNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTIzNSwKICAgIG5hbWU6ICJIQVFRIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmV0aC5oYXFxLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJIQVFRIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oYXFxLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFxcVRlc3RlZGdlMi5qcwogIHZhciBoYXFxVGVzdGVkZ2UyID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NDIxMSwKICAgIG5hbWU6ICJIQVFRIFRlc3RlZGdlIDIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSXNsYW1pYyBDb2luIiwKICAgICAgc3ltYm9sOiAiSVNMTVQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5ldGgudGVzdGVkZ2UyLmhhcXEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhBUVEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdGVkZ2UyLmhhcXEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0ZWRnZTIuaGFxcS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhcmRoYXQuanMKICB2YXIgaGFyZGhhdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEzMzcsCiAgICBuYW1lOiAiSGFyZGhhdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGFybW9ueU9uZS5qcwogIHZhciBoYXJtb255T25lID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjY2NmU1LAogICAgbmFtZTogIkhhcm1vbnkgT25lIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJIYXJtb255IiwKICAgICAgc3ltYm9sOiAiT05FIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuYW5rci5jb20vaGFybW9ueSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhcm1vbnkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuaGFybW9ueS5vbmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQxODU3NTMKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hhc2hrZXlDaGFpblRlc3RuZXQuanMKICB2YXIgaGFzaGtleVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMywKICAgIG5hbWU6ICJIYXNoS2V5IENoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSGFzaEtleSBFY29Qb2ludHMiLAogICAgICBzeW1ib2w6ICJIU0siCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2hhc2hrZXljaGFpbi10ZXN0bmV0LmFsdC50ZWNobm9sb2d5Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaEtleSBDaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXNoa2V5Y2hhaW4tdGVzdG5ldC1leHBsb3Jlci5hbHQudGVjaG5vbG9neSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYS5qcwogIHZhciBoZWRlcmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NSwKICAgIG5hbWU6ICJIZWRlcmEgTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLW1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL21haW5uZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hlZGVyYVByZXZpZXduZXQuanMKICB2YXIgaGVkZXJhUHJldmlld25ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjk3LAogICAgbmFtZTogIkhlZGVyYSBQcmV2aWV3bmV0IiwKICAgIG5ldHdvcms6ICJoZWRlcmEtcHJldmlld25ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBzeW1ib2w6ICJIQkFSIiwKICAgICAgbmFtZTogIkhCQVIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcHJldmlld25ldC5oYXNoaW8uaW8vYXBpIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGFzaHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGFzaHNjYW4uaW8vcHJldmlld25ldCIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oZWRlcmFUZXN0bmV0LmpzCiAgdmFyIGhlZGVyYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5NiwKICAgIG5hbWU6ICJIZWRlcmEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiaGVkZXJhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiSEJBUiIsCiAgICAgIG5hbWU6ICJIQkFSIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuaGFzaGlvLmlvL2FwaSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhhc2hzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2hhc2hzY2FuLmlvL3Rlc3RuZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVsYS5qcwogIHZhciBoZWxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NjY4LAogICAgbmFtZTogIkhlbGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiSExVU0QiLAogICAgICBzeW1ib2w6ICJITFVTRCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LXJwYy5oZWxhY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSGVsYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tYWlubmV0LWJsb2NrZXhwbG9yZXIuaGVsYWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaGVtaVNlcG9saWEuanMKICB2YXIgaGVtaVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc0MzExMSwKICAgIG5hbWU6ICJIZW1pIFNlcG9saWEiLAogICAgbmV0d29yazogIkhlbWkgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ycGMuaGVtaS5uZXR3b3JrL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkhlbWkgU2Vwb2xpYSBleHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLmhlbWkueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2hvbGVza3kuanMKICB2YXIgaG9sZXNreSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTdlMywKICAgIG5hbWU6ICJIb2xlc2t5IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJIb2xlc2t5IEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoZXJldW0taG9sZXNreS1ycGMucHVibGljbm9kZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaG9sZXNreS5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWhvbGVza3kuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3NwogICAgICB9LAogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogODAxNjEzCiAgICAgIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YTZBQzkzNUQ0OTcxRTNDRDEzM2I5NTBhRTA1M2JFQ0QxNmZFN2YzYiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA5NzM0ODQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9oeWNoYWluLmpzCiAgdmFyIGh5Y2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEsCiAgICBuYW1lOiAiSFlDSEFJTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5oeWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaHljaGFpblRlc3RuZXQuanMKICB2YXIgaHljaGFpblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI5MTEyLAogICAgbmFtZTogIkhZQ0hBSU4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSFlUT1BJQSIsIHN5bWJvbDogIlRPUElBIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5oeWNoYWluLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSFlDSEFJTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXJwYy5oeWNoYWluLmNvbS9odHRwIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2ltbXV0YWJsZVprRXZtLmpzCiAgdmFyIGltbXV0YWJsZVprRXZtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3MSwKICAgIG5hbWU6ICJJbW11dGFibGUgemtFVk0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5pbW11dGFibGUuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiSW1tdXRhYmxlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmltbXV0YWJsZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuaW1tdXRhYmxlLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDIzNmJkQTQ1ODllNDRlNjg1MGY1YUM2YTc0QmZDYTM5OGE4NmM2YzAiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDMzNTk3MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvaW1tdXRhYmxlWmtFdm1UZXN0bmV0LmpzCiAgdmFyIGltbXV0YWJsZVprRXZtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTM0NzMsCiAgICBuYW1lOiAiSW1tdXRhYmxlIHprRVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW1tdXRhYmxlIENvaW4iLAogICAgICBzeW1ib2w6ICJJTVgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LmltbXV0YWJsZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJJbW11dGFibGUgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LmltbXV0YWJsZS5jb20vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgyQ0M3ODdFZDM2NDYwMEIwMjIyMzYxQzQxODgzMDhGYThFNjhiQTYwIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU5NzczOTEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pbkVWTS5qcwogIHZhciBpbkVWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjUyNSwKICAgIG5hbWU6ICJpbkVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkluamVjdGl2ZSIsCiAgICAgIHN5bWJvbDogIklOSiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQucnBjLmluZXZtLmNvbS9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiaW5FVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaW5ldm0uY2FsZGVyYWV4cGxvcmVyLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9pbmV2bS5jYWxkZXJhZXhwbG9yZXIueHl6L2FwaS92MiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTg2MDYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGEuanMKICB2YXIgaW90YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODgyMiwKICAgIG5hbWU6ICJJT1RBIEVWTSIsCiAgICBuZXR3b3JrOiAiaW90YWV2bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJJT1RBIiwKICAgICAgc3ltYm9sOiAiSU9UQSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vanNvbi1ycGMuZXZtLmlvdGFsZWRnZXIubmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLmpzb24tcnBjLmV2bS5pb3RhbGVkZ2VyLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV2bS5pb3RhLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uaW90YS5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1MDIyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pb3RhVGVzdG5ldC5qcwogIHZhciBpb3RhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTA3NSwKICAgIG5hbWU6ICJJT1RBIEVWTSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJpb3RhZXZtLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSU9UQSIsCiAgICAgIHN5bWJvbDogIklPVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS50ZXN0bmV0LmlvdGFsZWRnZXIubmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLmpzb24tcnBjLmV2bS50ZXN0bmV0LmlvdGFsZWRnZXIubmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuaW90YWxlZGdlci5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2lvdGV4LmpzCiAgdmFyIGlvdGV4ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Njg5LAogICAgbmFtZTogIklvVGVYIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIklvVGVYIiwKICAgICAgc3ltYm9sOiAiSU9UWCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYmFiZWwtYXBpLm1haW5uZXQuaW90ZXguaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vYmFiZWwtYXBpLm1haW5uZXQuaW90ZXguaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJJb1RlWFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaW90ZXhzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyMTYzNjcwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9pb3RleFRlc3RuZXQuanMKICB2YXIgaW90ZXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0NjkwLAogICAgbmFtZTogIklvVGVYIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSW9UZVgiLAogICAgICBzeW1ib2w6ICJJT1RYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9iYWJlbC1hcGkudGVzdG5ldC5pb3RleC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9iYWJlbC1hcGkudGVzdG5ldC5pb3RleC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIklvVGVYU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmlvdGV4c2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YjVjZWNENjg5NGM2ZjQ3M0VjNzI2QTE3NmYxNTEyMzk5QTJlMzU1ZCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNDM0NzU5MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2piYy5qcwogIHZhciBqYmMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4OTksCiAgICBuYW1lOiAiSklCQ0hBSU4gTDEiLAogICAgbmV0d29yazogImpiYyIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiSkJDIiwgc3ltYm9sOiAiSkJDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLWwxLmppYmNoYWluLm5ldCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLWwxLmppYmNoYWluLm5ldCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAtbDEuamliY2hhaW4ubmV0L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzBDOEM0ODZEMTQ2NkM1N0VmZTEzQzJiZjAwMGQ0YzU2RjQ3Q0JkQyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMjk5MDQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2piY1Rlc3RuZXQuanMKICB2YXIgamJjVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg5OTEsCiAgICBuYW1lOiAiSmliY2hhaW4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAidEpCQyIsIHN5bWJvbDogInRKQkMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5qaWJjaGFpbi5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cC50ZXN0bmV0LmppYmNoYWluLm5ldCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHAudGVzdG5ldC5qaWJjaGFpbi5uZXQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhhMWE4NThhZDkwNDFCNDc0MWU2MjAzNTVhM0Y5NkIzYzc4ZTcwZWNFIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMyODQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2FydXJhLmpzCiAgdmFyIGthcnVyYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjg2LAogICAgbmFtZTogIkthcnVyYSIsCiAgICBuZXR3b3JrOiAia2FydXJhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJLYXJ1cmEiLAogICAgICBzeW1ib2w6ICJLQVIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXRoLXJwYy1rYXJ1cmEuYWNhLWFwaS5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V0aC1ycGMta2FydXJhLmFjYS1hcGkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthcnVyYSBCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQua2FydXJhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5rYXJ1cmEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2tha2Fyb3RTZXBvbGlhLmpzCiAgdmFyIGtha2Fyb3RTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxODAyMjAzNzY0LAogICAgbmFtZTogIktha2Fyb3QgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS1ycGMua2FrYXJvdC5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJLYWthcm90IFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5rYWthcm90c2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2FrYXJvdFN0YXJrbmV0U2Vwb2xpYS5qcwogIHZhciBrYWthcm90U3RhcmtuZXRTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5MjA2Mzc5MDcyODgxNjUsCiAgICBuYW1lOiAiS2FrYXJvdCBTdGFya25ldCBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5rYWthcm90Lm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktha2Fyb3QgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmtha2Fyb3RzY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYXZhLmpzCiAgdmFyIGthdmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyMjIsCiAgICBuYW1lOiAiS2F2YSBFVk0iLAogICAgbmV0d29yazogImthdmEtbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiS2F2YSIsCiAgICAgIHN5bWJvbDogIktBVkEiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2V2bS5rYXZhLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2F2YSBFVk0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8va2F2YXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2thdmFzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzY2MTE2NQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rYXZhVGVzdG5ldC5qcwogIHZhciBrYXZhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjIyMSwKICAgIG5hbWU6ICJLYXZhIEVWTSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJrYXZhLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkthdmEiLAogICAgICBzeW1ib2w6ICJLQVZBIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ldm0udGVzdG5ldC5rYXZhLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2F2YSBFVk0gVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmthdmFzY2FuLmNvbS8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdGVzdG5ldC5rYXZhc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhEZjFENzI0QTcxNjYyNjFlRUIwMTU0MThmZThjNzY3OUJCRWE3ZmQ2IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDcyNDIxNzkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rY2MuanMKICB2YXIga2NjID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjEsCiAgICBuYW1lOiAiS0NDIE1haW5uZXQiLAogICAgbmV0d29yazogIktDQyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIktDUyIsCiAgICAgIHN5bWJvbDogIktDUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8va2NjLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiS0NDIEV4cGxvcmVyIiwgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rY2MuaW8iIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE3NjA0MzAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva2ludG8uanMKICB2YXIga2ludG8gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc4ODcsCiAgICBuYW1lOiAiS2ludG8gTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAiS2ludG8gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLmtpbnRvLnh5ei9odHRwIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS2ludG8gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIua2ludG8ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rbGF5dG4uanMKICB2YXIga2xheXRuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MjE3LAogICAgbmFtZTogIktsYXl0biIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLbGF5dG4iLAogICAgICBzeW1ib2w6ICJLTEFZIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLWVuLWN5cHJlc3Mua2xheXRuLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktsYXl0blNjb3BlIiwKICAgICAgICB1cmw6ICJodHRwczovL3Njb3BlLmtsYXl0bi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTYwMDI0MTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2thaWEuanMKICB2YXIga2FpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODIxNywKICAgIG5hbWU6ICJLYWlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkthaWEiLAogICAgICBzeW1ib2w6ICJLQUlBIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLWVuLm5vZGUua2FpYS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthaWFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2thaWFzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1jeXByZXNzLmtsYXl0bnNjb3BlLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTYwMDI0MTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2thaXJvcy5qcwogIHZhciBrYWlyb3MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMDEsCiAgICBuYW1lOiAiS2Fpcm9zIFRlc3RuZXQiLAogICAgbmV0d29yazogImthaXJvcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJLYWlyb3MgS0FJQSIsCiAgICAgIHN5bWJvbDogIktBSUEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wdWJsaWMtZW4ta2Fpcm9zLm5vZGUua2FpYS5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkthaWFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2thaXJvcy5rYWlhc2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjMzOTA1OTMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rbGF5dG5CYW9iYWIuanMKICB2YXIga2xheXRuQmFvYmFiID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDAxLAogICAgbmFtZTogIktsYXl0biBCYW9iYWIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAia2xheXRuLWJhb2JhYiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJCYW9iYWIgS2xheXRuIiwKICAgICAgc3ltYm9sOiAiS0xBWSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1lbi1iYW9iYWIua2xheXRuLm5ldCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktsYXl0blNjb3BlIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jhb2JhYi5rbGF5dG5zY29wZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTIzMzkwNTkzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMva29pLmpzCiAgdmFyIGtvaSA9IGRlZmluZUNoYWluKHsKICAgIGlkOiA3MDEsCiAgICBuYW1lOiAiS29pIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiS29pIE5ldHdvcmsgTmF0aXZlIFRva2VuIiwKICAgICAgc3ltYm9sOiAiS1JJTkciCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2tvaS1ycGMuZGFyd2luaWEubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9rb2ktcnBjLmRhcndpbmlhLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogeyBuYW1lOiAiQmxvY2tzY291dCIsIHVybDogImh0dHBzOi8va29pLXNjYW4uZGFyd2luaWEubmV0d29yayIgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxODAwMDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rcm9tYS5qcwogIHZhciBrcm9tYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjU1LAogICAgbmFtZTogIktyb21hIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFVEgiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkua3JvbWEubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIktyb21hIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2Jsb2Nrc2NvdXQua3JvbWEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lmtyb21hLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9rcm9tYVNlcG9saWEuanMKICB2YXIga3JvbWFTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMzU4LAogICAgbmFtZTogIktyb21hIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkuc2Vwb2xpYS5rcm9tYS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiS3JvbWEgU2Vwb2xpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnNlcG9saWEua3JvbWEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0LnNlcG9saWEua3JvbWEubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbDN4LmpzCiAgdmFyIGwzeCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMjQsCiAgICBuYW1lOiAiTDNYIFByb3RvY29sIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy1tYWlubmV0LmwzeC5jb20iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLW1haW5uZXQubDN4LmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkwzWCBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmwzeC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIubDN4LmNvbS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2wzeFRlc3RuZXQuanMKICB2YXIgbDN4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMjUsCiAgICBuYW1lOiAiTDNYIFByb3RvY29sIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQubDN4LmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtdGVzdG5ldC5sM3guY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTDNYIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItdGVzdG5ldC5sM3guY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQubDN4LmNvbS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGF2aXRhLmpzCiAgdmFyIGxhdml0YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzYwODkwLAogICAgbmFtZTogIkxBVklUQSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJ2VEZVRUwiLCBzeW1ib2w6ICJ2VEZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90c3ViMzYwODkwLWV0aC1ycGMudGhldGF0b2tlbi5vcmcvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTEFWSVRBIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3RzdWIzNjA4OTAtZXhwbG9yZXIudGhldGF0b2tlbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpZ2h0bGlua1BlZ2FzdXMuanMKICB2YXIgbGlnaHRsaW5rUGVnYXN1cyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTg5MSwKICAgIG5hbWU6ICJMaWdodExpbmsgUGVnYXN1cyBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJsaWdodGxpbmstcGVnYXN1cyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcmVwbGljYXRvci5wZWdhc3VzLmxpZ2h0bGluay5pby9ycGMvdjEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMaWdodExpbmsgUGVnYXN1cyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wZWdhc3VzLmxpZ2h0bGluay5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saWdodGxpbmtQaG9lbml4LmpzCiAgdmFyIGxpZ2h0bGlua1Bob2VuaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4OTAsCiAgICBuYW1lOiAiTGlnaHRMaW5rIFBob2VuaXggTWFpbm5ldCIsCiAgICBuZXR3b3JrOiAibGlnaHRsaW5rLXBob2VuaXgiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JlcGxpY2F0b3IucGhvZW5peC5saWdodGxpbmsuaW8vcnBjL3YxIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTGlnaHRMaW5rIFBob2VuaXggRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGhvZW5peC5saWdodGxpbmsuaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vbGluZWEvYWN0aW9ucy9lc3RpbWF0ZUdhcy5qcwogIGluaXRfcGFyc2VBY2NvdW50KCk7CiAgaW5pdF90b0hleCgpOwogIGluaXRfZ2V0Q2FsbEVycm9yKCk7CiAgaW5pdF9leHRyYWN0KCk7CiAgaW5pdF90cmFuc2FjdGlvblJlcXVlc3QoKTsKICBpbml0X2Fzc2VydFJlcXVlc3QoKTsKICBhc3luYyBmdW5jdGlvbiBlc3RpbWF0ZUdhczIoY2xpZW50LCBhcmdzKSB7CiAgICBjb25zdCB7IGFjY291bnQ6IGFjY291bnRfID0gY2xpZW50LmFjY291bnQgfSA9IGFyZ3M7CiAgICBpZiAoIWFjY291bnRfKQogICAgICB0aHJvdyBuZXcgQWNjb3VudE5vdEZvdW5kRXJyb3IoKTsKICAgIGNvbnN0IGFjY291bnQgPSBwYXJzZUFjY291bnQoYWNjb3VudF8pOwogICAgdHJ5IHsKICAgICAgY29uc3QgeyBhY2Nlc3NMaXN0LCBibG9ja051bWJlciwgYmxvY2tUYWcsIGRhdGEsIGdhcywgZ2FzUHJpY2UsIG1heEZlZVBlckdhcywgbWF4UHJpb3JpdHlGZWVQZXJHYXMsIG5vbmNlLCB0bywgdmFsdWUsIC4uLnJlc3QgfSA9IGFyZ3M7CiAgICAgIGNvbnN0IGJsb2NrTnVtYmVySGV4ID0gYmxvY2tOdW1iZXIgPyBudW1iZXJUb0hleChibG9ja051bWJlcikgOiB2b2lkIDA7CiAgICAgIGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXJIZXggfHwgYmxvY2tUYWc7CiAgICAgIGFzc2VydFJlcXVlc3QoYXJncyk7CiAgICAgIGNvbnN0IGNoYWluRm9ybWF0ID0gY2xpZW50LmNoYWluPy5mb3JtYXR0ZXJzPy50cmFuc2FjdGlvblJlcXVlc3Q/LmZvcm1hdDsKICAgICAgY29uc3QgZm9ybWF0ID0gY2hhaW5Gb3JtYXQgfHwgZm9ybWF0VHJhbnNhY3Rpb25SZXF1ZXN0OwogICAgICBjb25zdCByZXF1ZXN0ID0gZm9ybWF0KHsKICAgICAgICAvLyBQaWNrIG91dCBleHRyYSBkYXRhIHRoYXQgbWlnaHQgZXhpc3Qgb24gdGhlIGNoYWluJ3MgdHJhbnNhY3Rpb24gcmVxdWVzdCB0eXBlLgogICAgICAgIC4uLmV4dHJhY3QocmVzdCwgeyBmb3JtYXQ6IGNoYWluRm9ybWF0IH0pLAogICAgICAgIGZyb206IGFjY291bnQ/LmFkZHJlc3MsCiAgICAgICAgYWNjZXNzTGlzdCwKICAgICAgICBkYXRhLAogICAgICAgIGdhcywKICAgICAgICBnYXNQcmljZSwKICAgICAgICBtYXhGZWVQZXJHYXMsCiAgICAgICAgbWF4UHJpb3JpdHlGZWVQZXJHYXMsCiAgICAgICAgbm9uY2UsCiAgICAgICAgdG8sCiAgICAgICAgdmFsdWUKICAgICAgfSk7CiAgICAgIGNvbnN0IHsgYmFzZUZlZVBlckdhcywgZ2FzTGltaXQsIHByaW9yaXR5RmVlUGVyR2FzIH0gPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7CiAgICAgICAgbWV0aG9kOiAibGluZWFfZXN0aW1hdGVHYXMiLAogICAgICAgIHBhcmFtczogYmxvY2sgPyBbcmVxdWVzdCwgYmxvY2tdIDogW3JlcXVlc3RdCiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGJhc2VGZWVQZXJHYXM6IEJpZ0ludChiYXNlRmVlUGVyR2FzKSwKICAgICAgICBnYXNMaW1pdDogQmlnSW50KGdhc0xpbWl0KSwKICAgICAgICBwcmlvcml0eUZlZVBlckdhczogQmlnSW50KHByaW9yaXR5RmVlUGVyR2FzKQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHRocm93IGdldENhbGxFcnJvcihlcnIsIHsKICAgICAgICAuLi5hcmdzLAogICAgICAgIGFjY291bnQsCiAgICAgICAgY2hhaW46IGNsaWVudC5jaGFpbgogICAgICB9KTsKICAgIH0KICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9saW5lYS9jaGFpbkNvbmZpZy5qcwogIHZhciBjaGFpbkNvbmZpZzQgPSB7CiAgICBmZWVzOiB7CiAgICAgIGVzdGltYXRlRmVlc1BlckdhczogZXN0aW1hdGVGZWVzUGVyR2FzMiwKICAgICAgYXN5bmMgbWF4UHJpb3JpdHlGZWVQZXJHYXMoeyBibG9jaywgY2xpZW50LCByZXF1ZXN0IH0pIHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVzdGltYXRlRmVlc1BlckdhczIoewogICAgICAgICAgYmxvY2ssCiAgICAgICAgICBjbGllbnQsCiAgICAgICAgICBtdWx0aXBseTogKHgpID0+IHgsCiAgICAgICAgICByZXF1ZXN0LAogICAgICAgICAgdHlwZTogImVpcDE1NTkiCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFyZXNwb25zZT8ubWF4UHJpb3JpdHlGZWVQZXJHYXMpCiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gcmVzcG9uc2UubWF4UHJpb3JpdHlGZWVQZXJHYXM7CiAgICAgIH0KICAgIH0KICB9OwogIGFzeW5jIGZ1bmN0aW9uIGVzdGltYXRlRmVlc1BlckdhczIoeyBjbGllbnQsIG11bHRpcGx5LCByZXF1ZXN0LCB0eXBlIH0pIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZXN0aW1hdGVHYXMyKGNsaWVudCwgewogICAgICAgIC4uLnJlcXVlc3QsCiAgICAgICAgYWNjb3VudDogcmVxdWVzdD8uYWNjb3VudAogICAgICB9KTsKICAgICAgY29uc3QgeyBwcmlvcml0eUZlZVBlckdhczogbWF4UHJpb3JpdHlGZWVQZXJHYXMgfSA9IHJlc3BvbnNlOwogICAgICBjb25zdCBiYXNlRmVlUGVyR2FzID0gbXVsdGlwbHkoQmlnSW50KHJlc3BvbnNlLmJhc2VGZWVQZXJHYXMpKTsKICAgICAgY29uc3QgbWF4RmVlUGVyR2FzID0gYmFzZUZlZVBlckdhcyArIG1heFByaW9yaXR5RmVlUGVyR2FzOwogICAgICBpZiAodHlwZSA9PT0gImxlZ2FjeSIpCiAgICAgICAgcmV0dXJuIHsgZ2FzUHJpY2U6IG1heEZlZVBlckdhcyB9OwogICAgICByZXR1cm4gewogICAgICAgIG1heEZlZVBlckdhcywKICAgICAgICBtYXhQcmlvcml0eUZlZVBlckdhcwogICAgICB9OwogICAgfSBjYXRjaCB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYS5qcwogIHZhciBsaW5lYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzQsCiAgICBpZDogNTkxNDQsCiAgICBuYW1lOiAiTGluZWEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTGluZWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmxpbmVhLmJ1aWxkIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2xpbmVhc2Nhbi5idWlsZCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkubGluZWFzY2FuLmJ1aWxkL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9saW5lYUdvZXJsaS5qcwogIHZhciBsaW5lYUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTkxNDAsCiAgICBuYW1lOiAiTGluZWEgR29lcmxpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkxpbmVhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmdvZXJsaS5saW5lYS5idWlsZCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuZ29lcmxpLmxpbmVhLmJ1aWxkIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS5saW5lYXNjYW4uYnVpbGQiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLWdvZXJsaS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5ODYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpbmVhU2Vwb2xpYS5qcwogIHZhciBsaW5lYVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWc0LAogICAgaWQ6IDU5MTQxLAogICAgbmFtZTogIkxpbmVhIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTGluZWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2Vwb2xpYS5saW5lYS5idWlsZCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuc2Vwb2xpYS5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmxpbmVhc2Nhbi5idWlsZCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktc2Vwb2xpYS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIyNzQyNwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpbmVhVGVzdG5ldC5qcwogIHZhciBsaW5lYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU5MTQwLAogICAgbmFtZTogIkxpbmVhIEdvZXJsaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJMaW5lYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5nb2VybGkubGluZWEuYnVpbGQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcnBjLmdvZXJsaS5saW5lYS5idWlsZCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkubGluZWFzY2FuLmJ1aWxkIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2dvZXJsaS5saW5lYXNjYW4uYnVpbGQvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ5ODYyMwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2xpc2suanMKICB2YXIgc291cmNlSWQxOSA9IDE7CiAgdmFyIGxpc2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMzUsCiAgICBuYW1lOiAiTGlzayIsCiAgICBuZXR3b3JrOiAibGlzayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFwaS5saXNrLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5saXNrLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ibG9ja3Njb3V0Lmxpc2suY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4QTlkNzFFMWRkN2NhMjZGMjZlNjU2RTY2ZDZBQTgxZWQ3Zjc0NWJmMCIKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQxOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDExM2NCOTkyODNBRjI0MkRhMEEwQzU0MzQ3NjY3ZWRGNTMxQWE3ZDYiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQxOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDI2ZEI5M0Y4YjhiNGY3MDE2MjQwYWY2MkY3NzMwOTc5ZDM1M2Y5QTciCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMTldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNjU4NzIzQmY3MGM3NjY3RGU2QjI1Rjk5ZmNjZTEzQTE2RDI1ZDA4IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDE5CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbGlza1NlcG9saWEuanMKICB2YXIgc291cmNlSWQyMCA9IDExMTU1MTExOwogIHZhciBsaXNrU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDIwMiwKICAgIG5ldHdvcms6ICJsaXNrLXNlcG9saWEiLAogICAgbmFtZTogIkxpc2sgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5zZXBvbGlhLWFwaS5saXNrLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS1ibG9ja3Njb3V0Lmxpc2suY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NlcG9saWEtYmxvY2tzY291dC5saXNrLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEEwRTM1RjU2QzMxOERFMWJENUQ5Y2E2QTk0RmU3ZTM3QzU2NjMzNDgiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlM2Q5MEYyMTQ5MDY4NkVjN2VGMzdCRTc4OEUwMmRmQzEyNzg3MjY0IgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIwXTogewogICAgICAgICAgYWRkcmVzczogIjB4MUZiMzBlNDQ2ZUE3OTFjZDFmMDExNjc1RTVGM2Y1MzExYjcwZmFGNSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjAKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9sb2NhbGhvc3QuanMKICB2YXIgbG9jYWxob3N0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3LAogICAgbmFtZTogIkxvY2FsaG9zdCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjg1NDUiXSB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbG9vcC5qcwogIHZhciBsb29wID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU1MSwKICAgIG5hbWU6ICJMb29wTmV0d29yayBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJMT09QIiwKICAgICAgc3ltYm9sOiAiTE9PUCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9hcGkubWFpbm5ldGxvb3AuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTG9vcE5ldHdvcmsgQmxvY2tjaGFpbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0bG9vcC5jb20vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9sdWtzby5qcwogIHZhciBsdWtzbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIsCiAgICBuZXR3b3JrOiAibHVrc28iLAogICAgbmFtZTogIkxVS1NPIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJMVUtTTyIsCiAgICAgIHN5bWJvbDogIkxZWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWFpbm5ldC5sdWtzby5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLXJwYy5tYWlubmV0Lmx1a3NvLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMVUtTTyBNYWlubmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4ZWN1dGlvbi5tYWlubmV0Lmx1a3NvLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV4cGxvcmVyLmV4ZWN1dGlvbi5tYWlubmV0Lmx1a3NvLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ2ODE4MwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbHVrc29UZXN0bmV0LmpzCiAgdmFyIGx1a3NvVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDIwMSwKICAgIG5hbWU6ICJMVUtTTyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkxVS1NPIFRlc3RuZXQiLAogICAgICBzeW1ib2w6ICJMWVh0IgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5sdWtzby5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLXJwYy50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMVUtTTyBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmV4ZWN1dGlvbi50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV4cGxvcmVyLmV4ZWN1dGlvbi50ZXN0bmV0Lmx1a3NvLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYwNTM0OAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2x5Y2FuLmpzCiAgdmFyIGx5Y2FuID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MjEsCiAgICBuYW1lOiAiTHljYW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTHljYW4iLAogICAgICBzeW1ib2w6ICJMWUMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJodHRwczovL3VzLWVhc3QubHljYW5jaGFpbi5jb20iLAogICAgICAgICAgImh0dHBzOi8vdXMtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ldS1ub3J0aC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly9ldS13ZXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJodHRwczovL2FzaWEtc291dGhlYXN0Lmx5Y2FuY2hhaW4uY29tIgogICAgICAgIF0sCiAgICAgICAgd2ViU29ja2V0OiBbCiAgICAgICAgICAid3NzOi8vcnBjLmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly91cy1lYXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly91cy13ZXN0Lmx5Y2FuY2hhaW4uY29tIiwKICAgICAgICAgICJ3c3M6Ly9ldS1ub3J0aC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vZXUtd2VzdC5seWNhbmNoYWluLmNvbSIsCiAgICAgICAgICAid3NzOi8vYXNpYS1zb3V0aGVhc3QubHljYW5jaGFpbi5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJMeWNhbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5seWNhbmNoYWluLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL2x5cmEuanMKICB2YXIgbHlyYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTU3LAogICAgbmFtZTogIkx5cmEgQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmx5cmEuZmluYW5jZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkx5cmEgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubHlyYS5maW5hbmNlIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLmx5cmEuZmluYW5jZS9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTkzNTE5OAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFpbm5ldC5qcwogIHZhciBtYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxLAogICAgbmFtZTogIkV0aGVyZXVtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Nsb3VkZmxhcmUtZXRoLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVyc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgZW5zUmVnaXN0cnk6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMDAwMDAwMDAwMEMyRTA3NGVDNjlBMGRGYjI5OTdCQTZDN2QyZTFlIgogICAgICB9LAogICAgICBlbnNVbml2ZXJzYWxSZXNvbHZlcjogewogICAgICAgIGFkZHJlc3M6ICIweGNlMDFmOGVlZTdFNDc5QzkyOEY4OTE5YWJENTNFNTUzYTM2Q2VGNjciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTkyNTgyMTMKICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQzNTM2MDEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbmRhbGEuanMKICB2YXIgbWFuZGFsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTk1LAogICAgbmFtZTogIk1hbmRhbGEgVEM5IiwKICAgIG5ldHdvcms6ICJtYW5kYWxhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJNYW5kYWxhIiwKICAgICAgc3ltYm9sOiAibUFDQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldGgtcnBjLXRjOS5hY2Etc3RhZ2luZy5uZXR3b3JrIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V0aC1ycGMtdGM5LmFjYS1zdGFnaW5nLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW5kYWxhIEJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYW5kYWxhLmFjYS1zdGFnaW5nLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYmxvY2tzY291dC5tYW5kYWxhLmFjYS1zdGFnaW5nLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRhLmpzCiAgdmFyIG1hbnRhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjksCiAgICBuYW1lOiAiTWFudGEgUGFjaWZpYyBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJtYW50YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9wYWNpZmljLXJwYy5tYW50YS5uZXR3b3JrL2h0dHAiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wYWNpZmljLWV4cGxvcmVyLm1hbnRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5tYW50YS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMzI4OTAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRhU2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgbWFudGFTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzQ0MTAwNiwKICAgIG5hbWU6ICJNYW50YSBQYWNpZmljIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAibWFudGEtc2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3BhY2lmaWMtcnBjLnNlcG9saWEtdGVzdG5ldC5tYW50YS5uZXR3b3JrL2h0dHAiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50YSBTZXBvbGlhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci5zZXBvbGlhLXRlc3RuZXQubWFudGEubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9wYWNpZmljLWV4cGxvcmVyLnNlcG9saWEtdGVzdG5ldC5tYW50YS5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2E1NDkxOGY3QjUyNUM4ZGY4OTQ2Njg4NDY1MDY3Njc0MTJiNTNFMyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0Nzk1ODQKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50YVRlc3RuZXQuanMKICB2YXIgbWFudGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNDQxMDA1LAogICAgbmFtZTogIk1hbnRhIFBhY2lmaWMgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAibWFudGEtdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYW50YS10ZXN0bmV0LmNhbGRlcmFjaGFpbi54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1hbnRhIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci50ZXN0bmV0Lm1hbnRhLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGFjaWZpYy1leHBsb3Jlci50ZXN0bmV0Lm1hbnRhLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgyMTFCMTY0M2I5NUZlNzZmMTFlRDg4ODBFRTgxMEFCRDlBNGNmNTZDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQxOTkxNQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRsZS5qcwogIHZhciBtYW50bGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDVlMywKICAgIG5hbWU6ICJNYW50bGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTU5UIiwKICAgICAgc3ltYm9sOiAiTU5UIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLm1hbnRsZS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50bGUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vbWFudGxlc2Nhbi54eXovIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5tYW50bGVzY2FuLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzA0NzE3CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYW50bGVTZXBvbGlhVGVzdG5ldC5qcwogIHZhciBtYW50bGVTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAwMywKICAgIG5hbWU6ICJNYW50bGUgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1OVCIsCiAgICAgIHN5bWJvbDogIk1OVCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5zZXBvbGlhLm1hbnRsZS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYW50bGUgVGVzdG5ldCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zZXBvbGlhLm1hbnRsZS54eXovIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnNlcG9saWEubWFudGxlLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNDU4NDAxMgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21hbnRsZVRlc3RuZXQuanMKICB2YXIgbWFudGxlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAwMSwKICAgIG5hbWU6ICJNYW50bGUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNTlQiLAogICAgICBzeW1ib2w6ICJNTlQiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5tYW50bGUueHl6Il0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWFudGxlIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5tYW50bGUueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQubWFudGxlLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTYxMzMzCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWFwUHJvdG9jb2wuanMKICB2YXIgbWFwUHJvdG9jb2wgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIyNzc2LAogICAgbmFtZTogIk1BUCBQcm90b2NvbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJNQVBPIiwKICAgICAgc3ltYm9sOiAiTUFQTyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tYXBsYWJzLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTUFQTyBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21hcG9zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tYXRjaGFpbi5qcwogIHZhciBtYXRjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjk4LAogICAgbmFtZTogIk1hdGNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCTkIiLAogICAgICBzeW1ib2w6ICJCTkIiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tYXRjaGFpbi5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1hdGNoYWluIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbWF0Y2hzY2FuLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWF0Y2hhaW5UZXN0bmV0LmpzCiAgdmFyIG1hdGNoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjk5LAogICAgbmFtZTogIk1hdGNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJOQiIsCiAgICAgIHN5bWJvbDogIkJOQiIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMubWF0Y2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNYXRjaGFpbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQubWF0Y2hzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21lcmxpbi5qcwogIHZhciBtZXJsaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyMDAsCiAgICBuYW1lOiAiTWVybGluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJCVEMiLAogICAgICBzeW1ib2w6ICJCVEMiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5tZXJsaW5jaGFpbi5pbyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5tZXJsaW5jaGFpbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLm1lcmxpbmNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFjaGFpbi5qcwogIHZhciBtZXRhY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MSwKICAgIG5hbWU6ICJNZXRhQ2hhaW4gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTWV0YXRpbWUgQ29pbiIsIHN5bWJvbDogIk1UQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXRhdGltZS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRhRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWV0YXRpbWUuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAzMDAxIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFjaGFpbklzdGFuYnVsLmpzCiAgdmFyIG1ldGFjaGFpbklzdGFuYnVsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDUzLAogICAgbmFtZTogIk1ldGFDaGFpbiBJc3RhbmJ1bCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTWV0YXRpbWUgQ29pbiIsIHN5bWJvbDogIk1UQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2lzdGFuYnVsLXJwYy5tZXRhY2hhaW4uZGV2Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWV0YUV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2lzdGFuYnVsLWV4cGxvcmVyLm1ldGFjaGFpbi5kZXYiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDMwMDEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGFsTDIuanMKICB2YXIgc291cmNlSWQyMSA9IDE7CiAgdmFyIG1ldGFsTDIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDE3NTAsCiAgICBuYW1lOiAiTWV0YWwgTDIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXRhbGwyLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMubWV0YWxsMi5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRhbGwyLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRhbGwyLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDNCMUY3YURhMEZjYzI2QjEzNTE1YWY3NTJEZDA3ZkIxQ0FjMTE0MjYiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDIxXTogewogICAgICAgICAgYWRkcmVzczogIjB4M0YzN2FCZEUyQzZiNUIyZWQ2RjgwNDU3ODdEZjFFRDFFMzc1Mzk1NiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyMV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZkMGY2NUQ1OWI1NUIwRkVDNWQyZDE1MzY1MTU0RGNBREMxNDBCRjMiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjEKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXRlci5qcwogIHZhciBtZXRlciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODIsCiAgICBuYW1lOiAiTWV0ZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTVRSIiwKICAgICAgc3ltYm9sOiAiTVRSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLm1ldGVyLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTWV0ZXJTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ubWV0ZXIuaW8iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXRlclRlc3RuZXQuanMKICB2YXIgbWV0ZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MywKICAgIG5hbWU6ICJNZXRlciBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1UUiIsCiAgICAgIHN5bWJvbDogIk1UUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwY3Rlc3QubWV0ZXIuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRlclRlc3RuZXRTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4td2FycmluZ3N0YWtlcy5tZXRlci5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGlzLmpzCiAgdmFyIG1ldGlzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDg4LAogICAgbmFtZTogIk1ldGlzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1ldGlzIiwKICAgICAgc3ltYm9sOiAiTUVUSVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hbmRyb21lZGEubWV0aXMuaW8vP293bmVyPTEwODgiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNZXRpcyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tZXRpcy5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkucm91dGVzY2FuLmlvL3YyL25ldHdvcmsvbWFpbm5ldC9ldm0vMTA4OC9ldGhlcnNjYW4vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIzMzg1NTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21ldGlzR29lcmxpLmpzCiAgdmFyIG1ldGlzR29lcmxpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1OTksCiAgICBuYW1lOiAiTWV0aXMgR29lcmxpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1ldGlzIEdvZXJsaSIsCiAgICAgIHN5bWJvbDogIk1FVElTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZ29lcmxpLmdhdGV3YXkubWV0aXNkZXZvcHMubGluayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1ldGlzIEdvZXJsaSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9nb2VybGkuZXhwbG9yZXIubWV0aXNkZXZvcHMubGluayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9nb2VybGkuZXhwbG9yZXIubWV0aXNkZXZvcHMubGluay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTAwNjIwNwogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWV2LmpzCiAgdmFyIG1ldiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzUxOCwKICAgIG5hbWU6ICJNRVZlcnNlIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTUVWZXJzZSIsCiAgICAgIHN5bWJvbDogIk1FViIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1ldmVyc2VtYWlubmV0LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm1ldmVyc2VzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDg2ODgxMzQwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tZXZUZXN0bmV0LmpzCiAgdmFyIG1ldlRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ3NTksCiAgICBuYW1lOiAiTUVWZXJzZSBDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk1FVmVyc2UiLAogICAgICBzeW1ib2w6ICJNRVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tZXZlcnNldGVzdG5ldC5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQubWV2ZXJzZXNjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDY0MzcxMTE1CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbWludC5qcwogIHZhciBtaW50ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxODUsCiAgICBuYW1lOiAiTWludCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5taW50Y2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNaW50Y2hhaW4gZXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIubWludGNoYWluLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9taW50U2Vwb2xpYVRlc3RuZXQuanMKICB2YXIgbWludFNlcG9saWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjg2LAogICAgbmFtZTogIk1pbnQgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3Rlc3RuZXQtcnBjLm1pbnRjaGFpbi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1pbnRjaGFpbiBUZXN0bmV0IGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIubWludGNoYWluLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vZGUuanMKICB2YXIgc291cmNlSWQyMiA9IDE7CiAgdmFyIG1vZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDM0NDQzLAogICAgbmFtZTogIk1vZGUgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0Lm1vZGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vZGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21vZGVzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0NjU4ODIKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQzMTdiYTE0NkQ0OTMzRDg4OTUxOGEzZTVFMTFGZTdhNTMxOTliMDQiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDhCMzRiMTRjN2M3MTIzNDU5Q2YzMDc2YjhDYjkyOUJFMDk3ZDBDMDciCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjJdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MzVhREJiRTcyMjI2QkQ1MmU4MThFNzE4MTk1M2Y0MkUzYjBGRjIxIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDIyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9kZVRlc3RuZXQuanMKICB2YXIgc291cmNlSWQyMyA9IDExMTU1MTExOwogIHZhciBtb2RlVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogOTE5LAogICAgbmFtZTogIk1vZGUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLm1vZGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5tb2RlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci5tb2RlLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgyNjM0QkQ2NWJhMjdBQjYzODExYzc0QTYzMTE4QUNiMzEyNzAxQmZhIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzc3ODM5MwogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjNdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgzMjBlMTU4MGVmZkYzN0UwMDhGMUM5MjcwMGQxZUJhNDdjMUIyM2ZEIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogMzc3ODM5NQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDIzXTogewogICAgICAgICAgYWRkcmVzczogIjB4YkM1QzY3OTg3OUIyOTY1Mjk2NzU2Q0Q5NTlDM0M3Mzk3Njk5OTVFMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDM3NzgzOTIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhCQWJhODM3MzExM0ZiN2E2OGYxOTVkZUYxODczMmUwMWFGOGVEZkNGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMwMTkwMDcKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyMwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vb25iYXNlQWxwaGEuanMKICB2YXIgbW9vbmJhc2VBbHBoYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4NywKICAgIG5hbWU6ICJNb29uYmFzZSBBbHBoYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJERVYiLAogICAgICBzeW1ib2w6ICJERVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5hcGkubW9vbmJhc2UubW9vbmJlYW0ubmV0d29yayJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93c3MuYXBpLm1vb25iYXNlLm1vb25iZWFtLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJNb29uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9tb29uYmFzZS5tb29uc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9tb29uYmFzZS5tb29uc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTg1MDY4NgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vb25iZWFtLmpzCiAgdmFyIG1vb25iZWFtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjg0LAogICAgbmFtZTogIk1vb25iZWFtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkdMTVIiLAogICAgICBzeW1ib2w6ICJHTE1SIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tb29uYmVhbS5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbW9vbmJlYW0ucHVibGljLmJsYXN0YXBpLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTW9vbnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbW9vbnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW1vb25iZWFtLm1vb25zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA2MDkwMDIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbmJlYW1EZXYuanMKICB2YXIgbW9vbmJlYW1EZXYgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEyODEsCiAgICBuYW1lOiAiTW9vbmJlYW0gRGV2ZWxvcG1lbnQgTm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJERVYiLAogICAgICBzeW1ib2w6ICJERVYiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vMTI3LjAuMC4xOjk5NDQiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vMTI3LjAuMC4xOjk5NDQiXQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbW9vbnJpdmVyLmpzCiAgdmFyIG1vb25yaXZlciA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTI4NSwKICAgIG5hbWU6ICJNb29ucml2ZXIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiTU9WUiIsCiAgICAgIHN5bWJvbDogIk1PVlIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21vb25yaXZlci5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbW9vbnJpdmVyLnB1YmxpYy5ibGFzdGFwaS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL21vb25yaXZlci5tb29uc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktbW9vbnJpdmVyLm1vb25zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNTk3OTA0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL21vcnBoSG9sZXNreS5qcwogIHZhciBtb3JwaEhvbGVza3kgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI4MTAsCiAgICBuYW1lOiAiTW9ycGggSG9sZXNreSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtcXVpY2tub2RlLWhvbGVza3kubW9ycGhsMi5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtcXVpY2tub2RlLWhvbGVza3kubW9ycGhsMi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vcnBoIEhvbGVza3kgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItaG9sZXNreS5tb3JwaGwyLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLWFwaS1ob2xlc2t5Lm1vcnBobDIuaW8vYXBpPyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9tb3JwaFNlcG9saWEuanMKICB2YXIgbW9ycGhTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNzEwLAogICAgbmFtZTogIk1vcnBoIFNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQubW9ycGhsMi5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk1vcnBoIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItdGVzdG5ldC5tb3JwaGwyLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLWFwaS10ZXN0bmV0Lm1vcnBobDIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25hdXRpbHVzLmpzCiAgdmFyIG5hdXRpbHVzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMjIyMiwKICAgIG5hbWU6ICJOYXV0aWx1cyBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaQkMiLCBzeW1ib2w6ICJaQkMiLCBkZWNpbWFsczogOSB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FwaS5uYXV0aWx1cy5uYXV0Y2hhaW4ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiTmF1dFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbmF1dHNjYW4uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbmVvbkRldm5ldC5qcwogIHZhciBuZW9uRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDUwMjI5MjYsCiAgICBuYW1lOiAiTmVvbiBFVk0gRGV2TmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJORU9OIiwgc3ltYm9sOiAiTkVPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2Rldm5ldC5uZW9uZXZtLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk5lb25zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2Rldm5ldC5uZW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA1MjA2MTEyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvbmVvbk1haW5uZXQuanMKICB2YXIgbmVvbk1haW5uZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0NTAyMjkzNCwKICAgIG5ldHdvcms6ICJuZW9uTWFpbm5ldCIsCiAgICBuYW1lOiAiTmVvbiBFVk0gTWFpbk5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiTkVPTiIsIHN5bWJvbDogIk5FT04iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9uZW9uLXByb3h5LW1haW5uZXQuc29sYW5hLnAycC5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZW9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9uZW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjA2NTQ1NTI0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL25leGkuanMKICB2YXIgbmV4aSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDI0MiwKICAgIG5hbWU6ICJOZXhpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJOZXhpIiwgc3ltYm9sOiAiTkVYSSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5jaGFpbi5uZXhpLnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJOZXhpU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cubmV4aXNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3d3dy5uZXhpc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwMjc3QTQ2Q2M2OUE1N2VFM0E2QzhjMTU4YkE4NzQ4MzJGNzE4QjhFIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1NzcwMTYwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9uZXhpbGl4LmpzCiAgdmFyIG5leGlsaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0MCwKICAgIG5hbWU6ICJOZXhpbGl4IFNtYXJ0IENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk5leGlsaXgiLAogICAgICBzeW1ib2w6ICJORVhJTElYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjdXJsLnBvcy5uZXhpbGl4LmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk5leGlsaXhTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4ubmV4aWxpeC5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDU4MzgxYzhlMkJGOWQwQzJDNDI1OWNBMTRCZEE5QWZlMDI4MzEyNDQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzQ0NDgKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29hc2lzVGVzdG5ldC5qcwogIHZhciBvYXNpc1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQwOTAsCiAgICBuZXR3b3JrOiAib2FzaXMtdGVzdG5ldCIsCiAgICBuYW1lOiAiT2FzaXMgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRmFzdHRva2VuIiwgc3ltYm9sOiAiRlROIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYzEub2FzaXMuYmFoYW11dGNoYWluLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkZ0bnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vb2FzaXMuZnRuc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vb2FzaXMuZnRuc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29hc3lzLmpzCiAgdmFyIG9hc3lzID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyNDgsCiAgICBuYW1lOiAiT2FzeXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk9hc3lzIiwgc3ltYm9sOiAiT0FTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQub2FzeXMuZ2FtZXMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPYXN5c1NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5vYXN5cy5nYW1lcyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLm9hc3lzLmdhbWVzL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29keXNzZXlUZXN0bmV0LmpzCiAgdmFyIG9keXNzZXlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5MTE4NjcsCiAgICBuYW1lOiAiT2R5c3NleSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vZHlzc2V5Lml0aGFjYS54eXoiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPZHlzc2V5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL29keXNzZXktZXhwbG9yZXIuaXRoYWNhLnh5eiIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9vZHlzc2V5LWV4cGxvcmVyLml0aGFjYS54eXovYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29rYy5qcwogIHZhciBva2MgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDY2LAogICAgbmFtZTogIk9LQyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPS1QiLAogICAgICBzeW1ib2w6ICJPS1QiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9leGNoYWlucnBjLm9rZXgub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAib2tsaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5va2xpbmsuY29tL29rYyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDM2NDc5MgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb29ydG1haW5uZXREZXYuanMKICB2YXIgb29ydE1haW5uZXREZXYgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDk3MDAsCiAgICBuYW1lOiAiT09SVCBNYWlubmV0RGV2IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIk9PUlQiLAogICAgICBzeW1ib2w6ICJPT1JUIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vZGV2LXJwYy5vb3J0ZWNoLmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9PUlQgTWFpbm5ldERldiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9kZXYtc2Nhbi5vb3J0ZWNoLmNvbSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wQk5CLmpzCiAgdmFyIHNvdXJjZUlkMjQgPSA1NjsKICB2YXIgb3BCTkIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwNCwKICAgIG5hbWU6ICJvcEJOQiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQk5CIiwKICAgICAgc3ltYm9sOiAiQk5CIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vcGJuYi1tYWlubmV0LXJwYy5ibmJjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJvcEJOQiAoQlNDU2NhbikiLAogICAgICAgIHVybDogImh0dHBzOi8vb3BibmIuYnNjc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW9wYm5iLmJzY3NjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MTI4ODEKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE1M0NBQjc5ZjQ3NjdFMmZmODYyQzk0YWE0OTU3MzI5NEIxM0QxNjkiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDE4NzZFQTc3MDJDMGFkMEM2QTJhZTYwMzZERTc3MzNlZGZCY2E1MTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGMDVGMGU0MzYyODU5YzMzMzFDYjkzOTVDQkMyMDFFM0ZhNjc1N0VhIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDI0CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3BCTkJUZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMjUgPSA5NzsKICB2YXIgb3BCTkJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NjExLAogICAgbmFtZTogIm9wQk5CIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAidEJOQiIsCiAgICAgIHN5bWJvbDogInRCTkIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9vcGJuYi10ZXN0bmV0LXJwYy5ibmJjaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJvcGJuYnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC5vcGJuYnNjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM3MDUxMDgKICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEZmMjM5NEJiODQzMDEyNTYyZjQzNDlDNjYzMmEwRWNCOTJmQzg4MTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQzODZDOEFCZjIwMDlhQzBjMjYzNDYyRGE1NjhERDlkNDZlNTJhMzEiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjVdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NzczMTFGZDJjQ2M1MTFCYmMwZjU4MUU4ZDlhMDdCMDMzRDVFODQwIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyNQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtLmpzCiAgdmFyIHNvdXJjZUlkMjYgPSAxOwogIHZhciBvcHRpbWlzbSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTAsCiAgICBuYW1lOiAiT1AgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0Lm9wdGltaXNtLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3B0aW1pc20gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vb3B0aW1pc3RpYy5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLW9wdGltaXN0aWMuZXRoZXJzY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQyNl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGU1OTY1QWI1OTYyZURjNzQ3N0M4NTIwMjQzQTk1NTE3Q0QyNTJmQTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDI2XTogewogICAgICAgICAgYWRkcmVzczogIjB4ZGZlOTc4NjgyMzNkMWFhMjJlODE1YTI2Njk4MmYyY2YxNzY4NWEyNyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQyODYyNjMKICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMjZdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiRWI1RmM1NzkxMTUwNzE3NjRjNzQyM0E0ZjEyZURkZTQxZjEwNkVkIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDI2XTogewogICAgICAgICAgYWRkcmVzczogIjB4OTlDOWZjNDZmOTJFOGExYzBkZUMxYjE3NDdkMDEwOTAzRTg4NGJFMSIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQyNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtR29lcmxpLmpzCiAgdmFyIHNvdXJjZUlkMjcgPSA1OwogIHZhciBvcHRpbWlzbUdvZXJsaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDIwLAogICAgbmFtZTogIk9wdGltaXNtIEdvZXJsaSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiR29lcmxpIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ29lcmxpLm9wdGltaXNtLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2dvZXJsaS1vcHRpbWlzbS5ldGhlcnNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZ29lcmxpLW9wdGltaXNtLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEU2RGZiYTA5NTM2MTZCYWNhYjBjOUE4ZWNiM2E5QkJhNzdGQzE1YzAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0OTQ2MQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDViNDdFMUEwOEVhNmQ5ODVENjY0OTMwMDU4NGU2NzIyRWM0QjEzODMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2MzZBZjE2YmYyZjY4MmREMzEwOWU2MDEwMmI4RTFBMDg5RmVkQWE4IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQyNwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdGltaXNtU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDI4ID0gMTExNTUxMTE7CiAgdmFyIG9wdGltaXNtU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTExNTU0MjAsCiAgICBuYW1lOiAiT1AgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEub3B0aW1pc20uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL29wdGltaXNtLXNlcG9saWEuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vb3B0aW1pc20tc2Vwb2xpYS5ibG9ja3Njb3V0LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkMjhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgwNUY5NjEzYURCMzAwMjZGRmQ2MzRmMzhlNUM0ZEZkMzBhMTk3RmExIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQyOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDkwRTljNGY4YTk5NGEyNTBGNmFFZmQ2MUNBRmI0RjJlODk1RDQ1OEYiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNjIwMjA0CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDI4XTogewogICAgICAgICAgYWRkcmVzczogIjB4MTZGYzUwNThGMjU2NDgxOTQ0NzE5MzlkZjc1Q0YyN0EyZmRDNDhCQyIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQyOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEZCYjA2MjFFMEIyM2I1NDc4QjYzMEJENTVhNWYyMWY2NzczMEIwRjEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDI4CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3B0b3BpYS5qcwogIHZhciBvcHRvcGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MjA1MCwKICAgIG5hbWU6ICJPcHRvcGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtbWFpbm5ldC5vcHRvcGlhLmFpIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT3B0b3BpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLm9wdG9waWEuYWkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29wdG9waWFUZXN0bmV0LmpzCiAgdmFyIG9wdG9waWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA2MjA0OSwKICAgIG5hbWU6ICJPcHRvcGlhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0Lm9wdG9waWEuYWkiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPcHRvcGlhIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4tdGVzdG5ldC5vcHRvcGlhLmFpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL29yZGVybHkuanMKICB2YXIgb3JkZXJseSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjkxLAogICAgbmFtZTogIk9yZGVybHkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5vcmRlcmx5Lm5ldHdvcmsiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPcmRlcmx5IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm9yZGVybHkubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3JkZXJseVNlcG9saWEuanMKICB2YXIgb3JkZXJseVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ0NjAsCiAgICBuYW1lOiAiT3JkZXJseSBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2wyLW9yZGVybHktbDItNDQ2MC1zZXBvbGlhLTh0YzNzZDdkdnkudC5jb25kdWl0Lnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9yZGVybHkgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXJsMm5ldy1vcmRlcmx5LWwyLTQ0NjAtc2Vwb2xpYS04dGMzc2Q3ZHZ5LnQuY29uZHVpdC54eXoiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvb3RpbURldm5ldC5qcwogIHZhciBvdGltRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MTE0NDExNCwKICAgIG5hbWU6ICJPdGltIERldm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwOi8vZGV2bmV0Lm90aW0ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBiYXRjaEludm9rZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHg1RmJEQjIzMTU2NzhhZmVjYjM2N2YwMzJkOTNGNjQyZjY0MTgwYWEzIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGFsbS5qcwogIHZhciBwYWxtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTI5NzEwODEwOSwKICAgIG5hbWU6ICJQYWxtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlBBTE0iLAogICAgICBzeW1ib2w6ICJQQUxNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3BhbG0tbWFpbm5ldC5wdWJsaWMuYmxhc3RhcGkuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGFpbmxlbnMiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFsbS5jaGFpbmxlbnMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NDI5MjQ4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wYWxtVGVzdG5ldC5qcwogIHZhciBwYWxtVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEyOTcxMDgwOTksCiAgICBuYW1lOiAiUGFsbSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlBBTE0iLAogICAgICBzeW1ib2w6ICJQQUxNIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wYWxtLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3BhbG0tbWFpbm5ldC5wdWJsaWMuYmxhc3RhcGkuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJDaGFpbmxlbnMiLAogICAgICAgIHVybDogImh0dHBzOi8vcGFsbS5jaGFpbmxlbnMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NDI5MjQ4CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGduLmpzCiAgdmFyIHNvdXJjZUlkMjkgPSAxOwogIHZhciBwZ24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyNCwKICAgIG5ldHdvcms6ICJwZ24iLAogICAgbmFtZTogIlBHTiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucHVibGljZ29vZHMubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBHTiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5wdWJsaWNnb29kcy5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnB1YmxpY2dvb2RzLm5ldHdvcmsvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg5RTYyMDRGNzUwY0Q4NjZiMjk5NTk0ZTJhQzllQTgyNEUyZTVmOTVjIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzM4MDIwOQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQyOV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGIyNkZkOTg1YzU5NTliQkIzODJCQUZkRDBiODc5RTE0OWU0ODExNmMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMjldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhEMDIwNEI5NTI3QzFiQTdiRDc2NUZhNUNDRDkzNTVkMzgzMzgyNzJiIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGZvcm1hdHRlcnM6IGZvcm1hdHRlcnMyLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMjkKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wZ25UZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMzAgPSAxMTE1NTExMTsKICB2YXIgcGduVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTgwMDgsCiAgICBuZXR3b3JrOiAicGduLXRlc3RuZXQiLAogICAgbmFtZTogIlBHTiAiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS5wdWJsaWNnb29kcy5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUEdOIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Vwb2xpYS5wdWJsaWNnb29kcy5uZXR3b3JrIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnNlcG9saWEucHVibGljZ29vZHMubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEQ1YkFjMzE1MmZmQzI1MzE4Rjg0OEIzREQ1ZEE2Qzg1MTcxQmFFRWUiCiAgICAgICAgfQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzMF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEYwNEJkRDUzNTNCYjBFRkY2Q0E2MENmY0M3ODU5NDI3OGVCZkUxNzkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhGYUU2YWJDQUYzMEQyM2UyMzNBQzdmYUY3NDdGMmZDM2E1YTZCZmEzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMzc1NDkyNQogICAgICB9CiAgICB9LAogICAgZm9ybWF0dGVyczogZm9ybWF0dGVyczIsCiAgICBzb3VyY2VJZDogc291cmNlSWQzMCwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9waG9lbml4LmpzCiAgdmFyIHBob2VuaXggPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzMzgxLAogICAgbmFtZTogIlBob2VuaXggQmxvY2tjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUGhvZW5peCIsIHN5bWJvbDogIlBIWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5waG9lbml4cGxvcmVyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBob2VuaXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcGhvZW5peHBsb3Jlci5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcGhvZW5peHBsb3Jlci5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg0OThjRjc1N2E1NzVjRkYyYzJFZDlmNTMyZjU2RWZhNzk3Zjg2NDQyIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDU2MjAxOTIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BsYXlmaUFsYmlyZW8uanMKICB2YXIgcGxheWZpQWxiaXJlbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAxNjEyMTI3LAogICAgbmFtZTogIlBsYXlGaSBBbGJpcmVvIFRlc3RuZXQiLAogICAgbmV0d29yazogImFsYmlyZW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYWxiaXJlby1ycGMucGxheWZpLmFpIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2FsYmlyZW8tcnBjLXdzLnBsYXlmaS5haS93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBsYXlGaSBBbGJpcmVvIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FsYmlyZW8tZXhwbG9yZXIucGxheWZpLmFpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhGOWNkYTYyNEZCQzdlMDU5MzU1Y2U5OGEzMTY5M2QyOTlGQUNkOTYzIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BsaW5nYS5qcwogIHZhciBwbGluZ2EgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI0MiwKICAgIG5hbWU6ICJQbGluZ2EiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlBsaW5nYSIsIHN5bWJvbDogIlBMSU5HQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwY3VybC5tYWlubmV0LnBsZ2NoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBsZ3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3LnBsZ3NjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwOTg5NTc2MTYwZjJlNzA5MjkwOEJCOTQ3OTYzMWI5MDEwNjBiNmU0IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwNDQ4OQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcGx1bWVUZXN0bmV0LmpzCiAgdmFyIHNvdXJjZUlkMzEgPSAxMTE1NTExMTsKICB2YXIgcGx1bWVUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjEyMjExMzUsCiAgICBuYW1lOiAiUGx1bWUgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiUGx1bWUgU2Vwb2xpYSBFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy5wbHVtZW5ldHdvcmsueHl6L2h0dHAiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC1ycGMucGx1bWVuZXR3b3JrLnh5ei93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1leHBsb3Jlci5wbHVtZW5ldHdvcmsueHl6IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIucGx1bWVuZXR3b3JrLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzEKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uLmpzCiAgdmFyIHBvbHlnb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzNywKICAgIG5hbWU6ICJQb2x5Z29uIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJQT0wiLCBzeW1ib2w6ICJQT0wiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wb2x5Z29uLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjU3NzAxNjAKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BvbHlnb25BbW95LmpzCiAgdmFyIHBvbHlnb25BbW95ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDAwMiwKICAgIG5hbWU6ICJQb2x5Z29uIEFtb3kiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk1BVElDIiwgc3ltYm9sOiAiTUFUSUMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMtYW1veS5wb2x5Z29uLnRlY2hub2xvZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hbW95LnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktYW1veS5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxMjczODgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uTXVtYmFpLmpzCiAgdmFyIHBvbHlnb25NdW1iYWkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgwMDAxLAogICAgbmFtZTogIlBvbHlnb24gTXVtYmFpIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJNQVRJQyIsIHN5bWJvbDogIk1BVElDIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmFua3IuY29tL3BvbHlnb25fbXVtYmFpIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUG9seWdvblNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vbXVtYmFpLnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktdGVzdG5ldC5wb2x5Z29uc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI1NzcwMTYwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcG9seWdvblprRXZtLmpzCiAgdmFyIHBvbHlnb25aa0V2bSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTEwMSwKICAgIG5hbWU6ICJQb2x5Z29uIHprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3prZXZtLXJwYy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly96a2V2bS5wb2x5Z29uc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXprZXZtLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTc3NDYKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3BvbHlnb25aa0V2bUNhcmRvbmEuanMKICB2YXIgcG9seWdvblprRXZtQ2FyZG9uYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjQ0MiwKICAgIG5hbWU6ICJQb2x5Z29uIHprRVZNIENhcmRvbmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmNhcmRvbmEuemtldm0tcnBjLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlBvbHlnb25TY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2NhcmRvbmEtemtldm0ucG9seWdvbnNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2NhcmRvbmEtemtldm0ucG9seWdvbnNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE0MDkxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wb2x5Z29uWmtFdm1UZXN0bmV0LmpzCiAgdmFyIHBvbHlnb25aa0V2bVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0NDIsCiAgICBuYW1lOiAiUG9seWdvbiB6a0VWTSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5wdWJsaWMuemtldm0tdGVzdC5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJQb2x5Z29uU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXprZXZtLnBvbHlnb25zY2FuLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LXprZXZtLnBvbHlnb25zY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDUyNTY4NgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcHVsc2VjaGFpbi5qcwogIHZhciBwdWxzZWNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNjksCiAgICBuYW1lOiAiUHVsc2VDaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiUHVsc2UiLCBzeW1ib2w6ICJQTFMiLCBkZWNpbWFsczogMTggfSwKICAgIHRlc3RuZXQ6IGZhbHNlLAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5wdWxzZWNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy5wdWxzZWNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlB1bHNlU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnB1bHNlY2hhaW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS5zY2FuLnB1bHNlY2hhaW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBlbnNSZWdpc3RyeTogewogICAgICAgIGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiCiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE0MzUzNjAxCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9wdWxzZWNoYWluVjQuanMKICB2YXIgcHVsc2VjaGFpblY0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NDMsCiAgICBuYW1lOiAiUHVsc2VDaGFpbiBWNCIsCiAgICB0ZXN0bmV0OiB0cnVlLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlY0IFB1bHNlIiwgc3ltYm9sOiAidjRQTFMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudjQudGVzdG5ldC5wdWxzZWNoYWluLmNvbSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93cy52NC50ZXN0bmV0LnB1bHNlY2hhaW4uY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUHVsc2VTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NjYW4udjQudGVzdG5ldC5wdWxzZWNoYWluLmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnY0LnRlc3RuZXQucHVsc2VjaGFpbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIGVuc1JlZ2lzdHJ5OiB7CiAgICAgICAgYWRkcmVzczogIjB4MDAwMDAwMDAwMDBDMkUwNzRlQzY5QTBkRmIyOTk3QkE2QzdkMmUxZSIKICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTQzNTM2MDEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3FsMS5qcwogIHZhciBxbDEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc2NiwKICAgIG5hbWU6ICJRTDEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUU9NIiwKICAgICAgc3ltYm9sOiAiUU9NIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMucW9tLm9uZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlFsMSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnFvbS5vbmUiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDdBNTIzNzA3MTZlYTczMDU4NTg4NEY1QkRCMGY2RTYwQzM5YjhDNjQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3FNYWlubmV0LmpzCiAgdmFyIHFNYWlubmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNTQ0MSwKICAgIG5hbWU6ICJRIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUSIsCiAgICAgIHN5bWJvbDogIlEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMucS5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJRIE1haW5uZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucS5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIucS5vcmcvYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcVRlc3RuZXQuanMKICB2YXIgcVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM1NDQzLAogICAgbmFtZTogIlEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJRIiwKICAgICAgc3ltYm9sOiAiUSIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5xdGVzdG5ldC5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJRIFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucXRlc3RuZXQub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLnF0ZXN0bmV0Lm9yZy9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmVhbC5qcwogIHZhciByZWFsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTExODgsCiAgICBuYW1lOiAicmUuYWwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogInJlRVRIIiwKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBzeW1ib2w6ICJyZUVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JlYWwuZHJwYy5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJyZS5hbCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yZS5hbCIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5yZS5hbC9hcGkvdjIiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjk1CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yZWRiZWxseVRlc3RuZXQuanMKICB2YXIgcmVkYmVsbHlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTMsCiAgICBuYW1lOiAiUmVkYmVsbHkgTmV0d29yayBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJSZWRiZWxseSBOYXRpdmUgQ29pbiIsCiAgICAgIHN5bWJvbDogIlJCTlQiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZ292ZXJub3JzLnRlc3RuZXQucmVkYmVsbHkubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybmFsIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQucmVkYmVsbHkubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9ldGhlcm5hbC5mbHkuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yZWRzdG9uZS5qcwogIHZhciBzb3VyY2VJZDMyID0gMTsKICB2YXIgcmVkc3RvbmUgPSBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBuYW1lOiAiUmVkc3RvbmUiLAogICAgaWQ6IDY5MCwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDMyLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgZGVjaW1hbHM6IDE4LCBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnJlZHN0b25lY2hhaW4uY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5yZWRzdG9uZWNoYWluLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIucmVkc3RvbmUueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEM3YkNiMGU4ODM5YTI4QTFjRmFkZDFDRjcxNmRlOTAxNkNkQTUxYWUiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTU3ODMyOQogICAgICAgIH0KICAgICAgfSwKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzMl06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGE0MjZBMDUyZjY1N0FFRWVmYzI5OGIzQjVjMzVhNDcwZTQ3MzlkNjkiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTU3ODMzNwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMyXTogewogICAgICAgICAgYWRkcmVzczogIjB4YzQ3M2NhN0UwMmFmMjRjMTI5YzJlRWY1MUYyYURmMDQxMWMxRGY2OSIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDE5NTc4MzMxCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcmV5YU5ldHdvcmsuanMKICB2YXIgcmV5YU5ldHdvcmsgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3MjksCiAgICBuYW1lOiAiUmV5YSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IGRlY2ltYWxzOiAxOCwgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yZXlhLm5ldHdvcmsiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vd3MucmV5YS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUmV5YSBOZXR3b3JrIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJleWEubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9sbHV4LmpzCiAgdmFyIHJvbGx1eCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTcwLAogICAgbmFtZTogIlJvbGx1eCBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlN5c2NvaW4iLAogICAgICBzeW1ib2w6ICJTWVMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5yb2xsdXguY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5yb2xsdXguY29tL3dzcyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlJvbGx1eEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJvbGx1eC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIucm9sbHV4LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTE5MjIyCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb2xsdXhUZXN0bmV0LmpzCiAgdmFyIHJvbGx1eFRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3ZTMsCiAgICBuYW1lOiAiUm9sbHV4IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiU3lzY29pbiIsCiAgICAgIHN5bWJvbDogIlNZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRhbmVuYmF1bS5yb2xsdXguY29tLyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMtdGFuZW5iYXVtLnJvbGx1eC5jb20vd3NzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9sbHV4VGVzdG5ldEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3JvbGx1eC50YW5lbmJhdW0uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vcm9sbHV4LnRhbmVuYmF1bS5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTgxMzY3NQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9uaW4uanMKICB2YXIgcm9uaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjAsCiAgICBuYW1lOiAiUm9uaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJPTiIsIHN5bWJvbDogIlJPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2FwaS5yb25pbmNoYWluLmNvbS9ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSb25pbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcHAucm9uaW5jaGFpbi5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjYwMjM1MzUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Jvb3QuanMKICB2YXIgcm9vdCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNzY2OCwKICAgIG5hbWU6ICJUaGUgUm9vdCBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlhSUCIsCiAgICAgIHN5bWJvbDogIlhSUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcm9vdC5yb290bmV0LmxpdmUvYXJjaGl2ZSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9yb290LnJvb3RuZXQubGl2ZS9hcmNoaXZlL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9vdHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcm9vdHNjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGM5QzJFMjQyOUFlQzM1NDkxNmM0NzZCMzBkNzI5ZGVEZEM5NDk4OGQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogOTIxODMzOAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvcm9vdFBvcmNpbmkuanMKICB2YXIgcm9vdFBvcmNpbmkgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDc2NzIsCiAgICBuYW1lOiAiVGhlIFJvb3QgTmV0d29yayAtIFBvcmNpbmkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWFJQIiwKICAgICAgc3ltYm9sOiAiWFJQIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9wb3JjaW5pLnJvb3RuZXQuYXBwL2FyY2hpdmUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vcG9yY2luaS5yb290bmV0LmFwcC9hcmNoaXZlL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUm9vdHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vcG9yY2luaS5yb290c2Nhbi5pbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzlDMkUyNDI5QWVDMzU0OTE2YzQ3NkIzMGQ3MjlkZURkQzk0OTg4ZCIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDU1NTY5MgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Jvb3RzdG9jay5qcwogIHZhciByb290c3RvY2sgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMwLAogICAgbmFtZTogIlJvb3RzdG9jayBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJyb290c3RvY2siLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUm9vdHN0b2NrIEJpdGNvaW4iLAogICAgICBzeW1ib2w6ICJSQlRDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVibGljLW5vZGUucnNrLmNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNLIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnJzay5jbyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0MjQ5NTQwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9yb290c3RvY2tUZXN0bmV0LmpzCiAgdmFyIHJvb3RzdG9ja1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxLAogICAgbmFtZTogIlJvb3RzdG9jayBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJyb290c3RvY2siLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUm9vdHN0b2NrIEJpdGNvaW4iLAogICAgICBzeW1ib2w6ICJ0UkJUQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3B1YmxpYy1ub2RlLnRlc3RuZXQucnNrLmNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiUlNLIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQucm9vdHN0b2NrLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JzczMuanMKICB2YXIgc291cmNlSWQzMyA9IDE7CiAgdmFyIHJzczMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEyNTUzLAogICAgbmFtZTogIlJTUzMgVlNMIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJTUzMiLCBzeW1ib2w6ICJSU1MzIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnJzczMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSU1MzIFZTTCBNYWlubmV0IFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi5yc3MzLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3NjYW4ucnNzMy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEU2ZjI0ZDJDMzJCMzEwOUIxOGVkMzNjRjA4ZUZiNDkwYjFlMDlDMTAiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNDE5MwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzM106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZBMTI0MzI0OTFiYmJFOGQzYmFiZjc1Rjc1OTc2Njc3NEM3NzhEYjQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAxOTM4NzA1NwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDMzXTogewogICAgICAgICAgYWRkcmVzczogIjB4NGNiYWI2OTEwOEFhNzIxNTFFRGE1QTNjMTY0ZUE4Njg0NWYxODQzOCIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzb3VyY2VJZDogc291cmNlSWQzMwogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3JzczNTZXBvbGlhLmpzCiAgdmFyIHNvdXJjZUlkMzQgPSAxMTE1NTExMTsKICB2YXIgcnNzM1NlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDIzMzEsCiAgICBuYW1lOiAiUlNTMyBWU0wgU2Vwb2xpYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJSU1MzIiwgc3ltYm9sOiAiUlNTMyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LnJzczMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJSU1MzIFZTTCBTZXBvbGlhIFRlc3RuZXQgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY2FuLnRlc3RuZXQucnNzMy5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zY2FuLnRlc3RuZXQucnNzMy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweERiNWM0NkMzRWFhNkVkNmFFOGIyMzc5Nzg1REY3ZGQwMjlDMGRDODEiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1NTY5NwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzNF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGNCRDc3RThFMUU3RjA2QjI1YmFEZTY3MTQyY2RFODI2NTJEYTdiNTciLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiA1MzQ1MDM1CiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzRdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkREQyOWJiNjNCMDgzOUZCMWNFMGVFNDM5RmYwMjc3Mzg1OTVEMDdCIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzNAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhaWdvbi5qcwogIHZhciBzYWlnb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjEsCiAgICBuYW1lOiAiU2FpZ29uIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlJPTiIsIHN5bWJvbDogIlJPTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhaWdvbi10ZXN0bmV0LnJvbmluY2hhaW4uY29tL3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNhaWdvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zYWlnb24tYXBwLnJvbmluY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4NzM2ODcxCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2Fua28uanMKICB2YXIgc2Fua28gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5OTYsCiAgICBuYW1lOiAiU2Fua28iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkRNVCIsIHN5bWJvbDogIkRNVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2Fua28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2Fua28gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc2Fua28ueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXBwaGlyZS5qcwogIHZhciBzYXBwaGlyZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjMyOTQsCiAgICBuYW1lOiAiT2FzaXMgU2FwcGhpcmUiLAogICAgbmV0d29yazogInNhcHBoaXJlIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTYXBwaGlyZSBSb3NlIiwgc3ltYm9sOiAiUk9TRSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NhcHBoaXJlLm9hc2lzLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NhcHBoaXJlLm9hc2lzLmlvL3dzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT2FzaXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIub2FzaXMuaW8vbWFpbm5ldC9zYXBwaGlyZSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA3MzQ1MzEKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NhcHBoaXJlVGVzdG5ldC5qcwogIHZhciBzYXBwaGlyZVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzMjk1LAogICAgbmFtZTogIk9hc2lzIFNhcHBoaXJlIFRlc3RuZXQiLAogICAgbmV0d29yazogInNhcHBoaXJlLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNhcHBoaXJlIFRlc3QgUm9zZSIsIHN5bWJvbDogIlRFU1QiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNhcHBoaXJlLm9hc2lzLmRldi93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9hc2lzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLm9hc2lzLmlvL3Rlc3RuZXQvc2FwcGhpcmUiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2F0b3NoaXZtLmpzCiAgdmFyIHNhdG9zaGlWTSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzEwOSwKICAgIG5hbWU6ICJTYXRvc2hpVk0gQWxwaGEgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiQlRDIiwKICAgICAgc3ltYm9sOiAiQlRDIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hbHBoYS1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3N2bXNjYW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc3Ztc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zYXRvc2hpdm1UZXN0bmV0LmpzCiAgdmFyIHNhdG9zaGlWTVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMxMTAsCiAgICBuYW1lOiAiU2F0b3NoaVZNIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIkJUQyIsCiAgICAgIHN5bWJvbDogIkJUQyIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdC1ycGMtbm9kZS1odHRwLnN2bXNjYW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3Ztc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly90ZXN0bmV0LnN2bXNjYW4uaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Njcm9sbC5qcwogIHZhciBzY3JvbGwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MiwKICAgIG5hbWU6ICJTY3JvbGwiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNjcm9sbC5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly93c3MtcnBjLnNjcm9sbC5pby93cyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNjcm9sbHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLnNjcm9sbHNjYW4uY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxNAogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zY3JvbGxTZXBvbGlhLmpzCiAgdmFyIHNjcm9sbFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUzNDM1MSwKICAgIG5hbWU6ICJTY3JvbGwgU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLXJwYy5zY3JvbGwuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTY3JvbGxzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuc2Nyb2xsc2Nhbi5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEuc2Nyb2xsc2Nhbi5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDk0NzMKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWkuanMKICB2YXIgc2VpID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI5LAogICAgbmFtZTogIlNlaSBOZXR3b3JrIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLnNlaS1hcGlzLmNvbS8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vZXZtLXdzLnNlaS1hcGlzLmNvbS8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2VpdHJhY2UuY29tL3BhY2lmaWMtMS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZWlEZXZuZXQuanMKICB2YXIgc2VpRGV2bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MTM3MTUsCiAgICBuYW1lOiAiU2VpIERldm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2VpIiwgc3ltYm9sOiAiU0VJIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZXZtLXJwYy1hcmN0aWMtMS5zZWktYXBpcy5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTZWl0cmFjZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZWl0cmFjZS5jb20iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2VpVGVzdG5ldC5qcwogIHZhciBzZWlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzI4LAogICAgbmFtZTogIlNlaSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZWkiLCBzeW1ib2w6ICJTRUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm0tcnBjLXRlc3RuZXQuc2VpLWFwaXMuY29tIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL2V2bS13cy10ZXN0bmV0LnNlaS1hcGlzLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNlaXRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlaXRyYWNlLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zZXBvbGlhLmpzCiAgdmFyIHNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDExMTU1MTExLAogICAgbmFtZTogIlNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMyLnNlcG9saWEub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEuZXRoZXJzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLmV0aGVyc2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzUxNTMyCiAgICAgIH0sCiAgICAgIGVuc1JlZ2lzdHJ5OiB7IGFkZHJlc3M6ICIweDAwMDAwMDAwMDAwQzJFMDc0ZUM2OUEwZEZiMjk5N0JBNkM3ZDJlMWUiIH0sCiAgICAgIGVuc1VuaXZlcnNhbFJlc29sdmVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4YzhBZjk5OWUzODI3M0Q2NThCRTFiOTIxYjg4QTlEZGYwMDU3NjljQyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1MzE3MDgwCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hhcGUuanMKICB2YXIgc291cmNlSWQzNSA9IDE7CiAgdmFyIHNoYXBlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAzNjAsCiAgICBuYW1lOiAiU2hhcGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5zaGFwZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAic2hhcGVzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoYXBlc2Nhbi54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2hhcGVzY2FuLnh5ei9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQzNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDZFZjhjNjlDZkU0NjM1ZDg2NmUzRTAyNzMyMDY4MDIyYzA2ZTcyNEQiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTk0MAogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMQogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzNV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweEVCMDZmRmExNjAxMUI1NjI4QmFCOThFMjk3NzYzNjFjODM3NDFkZDMiLAogICAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDM2OTkzMwogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM1XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjJFZGQ1ZjQ5MzBFYTkyZENhM2ZCODE2ODliREQ5YjlkMDc2YjU3QiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDIwMzY5OTM1CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkMzUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGFwZVNlcG9saWEuanMKICB2YXIgc291cmNlSWQzNiA9IDExMTU1MTExOwogIHZhciBzaGFwZVNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDExMDExLAogICAgbmFtZTogIlNoYXBlIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU2Vwb2xpYSBFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NlcG9saWEuc2hhcGUubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogImJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc2Vwb2xpYS5zaGFwZS5uZXR3b3JrLyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci1zZXBvbGlhLnNoYXBlLm5ldHdvcmsvYXBpL3YyIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzNgogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoYXJkZXVtU3BoaW54LmpzCiAgdmFyIHNoYXJkZXVtU3BoaW54ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4MDgyLAogICAgbmFtZTogIlNoYXJkZXVtIFNwaGlueCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU0hBUkRFVU0iLCBzeW1ib2w6ICJTSE0iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zcGhpbnguc2hhcmRldW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2hhcmRldW0gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXItc3BoaW54LnNoYXJkZXVtLm9yZyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGliYXJpdW0uanMKICB2YXIgc2hpYmFyaXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDksCiAgICBuYW1lOiAiU2hpYmFyaXVtIiwKICAgIG5ldHdvcms6ICJzaGliYXJpdW0iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkJvbmUiLCBzeW1ib2w6ICJCT05FIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnNoaWJycGMuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zaGliYXJpdW1zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4NjRCZjY4MUFERDYwNTIzOTUxODhBODkxMDFBMUIzN2QzQjRDOTYxIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI2NTkwMAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpYmFyaXVtVGVzdG5ldC5qcwogIHZhciBzaGliYXJpdW1UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTcsCiAgICBuYW1lOiAiUHVwcHluZXQgU2hpYmFyaXVtIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIkJvbmUiLAogICAgICBzeW1ib2w6ICJCT05FIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcHVwcHluZXQuc2hpYnJwYy5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCbG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3B1cHB5c2Nhbi5zaGliLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4QTQwMjliNzRGQkEzNjZjOTI2ZURGQTdEZDEwQjIxQzYyMTE3MGE0YyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMDM1NzY5CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2hpZGVuLmpzCiAgdmFyIHNoaWRlbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzM2LAogICAgbmFtZTogIlNoaWRlbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTRE4iLAogICAgICBzeW1ib2w6ICJTRE4iCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3NoaWRlbi5wdWJsaWMuYmxhc3RhcGkuaW8iXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vc2hpZGVuLXJwYy5kd2VsbGlyLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaWRlbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NoaWRlbi5zdWJzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaGltbWVyLmpzCiAgdmFyIHNoaW1tZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE0OCwKICAgIG5hbWU6ICJTaGltbWVyIiwKICAgIG5ldHdvcms6ICJzaGltbWVyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS5zaGltbWVyLm5ldHdvcmsiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaGltbWVyIE5ldHdvcmsgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnNoaW1tZXIubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0uc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NoaW1tZXJUZXN0bmV0LmpzCiAgdmFyIHNoaW1tZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDczLAogICAgbmFtZTogIlNoaW1tZXIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAic2hpbW1lci10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogIlNoaW1tZXIiLAogICAgICBzeW1ib2w6ICJTTVIiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2pzb24tcnBjLmV2bS50ZXN0bmV0LnNoaW1tZXIubmV0d29yayJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNoaW1tZXIgTmV0d29yayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5ldm0udGVzdG5ldC5zaGltbWVyLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuZXZtLnRlc3RuZXQuc2hpbW1lci5uZXR3b3JrL2FwaSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zaWxpY29uLmpzCiAgdmFyIHNpbGljb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIzNTUsCiAgICBuYW1lOiAiU2lsaWNvbiB6a0VWTSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3JwYy5zaWxpY29uLm5ldHdvcmsiLAogICAgICAgICAgImh0dHBzOi8vc2lsaWNvbi1tYWlubmV0Lm5vZGVpbmZyYS5jb20iCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTaWxpY29uU2NvcGUiLAogICAgICAgIHVybDogImh0dHBzOi8vc2NvcGUuc2lsaWNvbi5uZXR3b3JrIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2lsaWNvblNlcG9saWEuanMKICB2YXIgc2lsaWNvblNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE3MjI2NDExNjAsCiAgICBuYW1lOiAiU2lsaWNvbiBTZXBvbGlhIHprRVZNIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vcnBjLXNlcG9saWEuc2lsaWNvbi5uZXR3b3JrIiwKICAgICAgICAgICJodHRwczovL3NpbGljb24tdGVzdG5ldC5ub2RlaW5mcmEuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU2lsaWNvblNlcG9saWFTY29wZSIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zY29wZS1zZXBvbGlhLnNpbGljb24ubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9icmF3bC5qcwogIHZhciBza2FsZUJsb2NrQnJhd2xlcnMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDM5MTg0NTg5NCwKICAgIG5hbWU6ICJTS0FMRSB8IEJsb2NrIEJyYXdsZXJzIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJCUkFXTCIsIHN5bWJvbDogIkJSQVdMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9mcmF5ZWQtZGVjZW50LWFudGFyZXMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9mcmF5ZWQtZGVjZW50LWFudGFyZXMuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czoge30KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvLmpzCiAgdmFyIHNrYWxlQ2FseXBzbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTU2NDgzMDgxOCwKICAgIG5hbWU6ICJTS0FMRSB8IENhbHlwc28gTkZUIEh1YiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsKICAgICAgICAgICJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hvbm9yYWJsZS1zdGVlbC1yYXNhbGhhZ3VlIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vaG9ub3JhYmxlLXN0ZWVsLXJhc2FsaGFndWUuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAzMTA3NjI2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jYWx5cHNvVGVzdG5ldC5qcwogIHZhciBza2FsZUNhbHlwc29UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NzQzOTkxMzEsCiAgICBuYW1lOiAiU0tBTEUgQ2FseXBzbyBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9naWFudC1oYWxmLWR1YWwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dpYW50LWhhbGYtZHVhbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ2lhbnQtaGFsZi1kdWFsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDMyMjAKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9jcnlwdG9CbGFkZXMuanMKICB2YXIgc2thbGVDcnlwdG9CbGFkZXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjYwNjIxNTcsCiAgICBuYW1lOiAiU0tBTEUgfCBDcnlwdG9CbGFkZXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4Il0sCiAgICAgICAgd2ViU29ja2V0OiBbCiAgICAgICAgICAid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9hZmZlY3Rpb25hdGUtaW1tZWRpYXRlLXBvbGx1eCIKICAgICAgICBdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2FmZmVjdGlvbmF0ZS1pbW1lZGlhdGUtcG9sbHV4LmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvY3J5cHRvQ29sb3NzZXVtLmpzCiAgdmFyIHNrYWxlQ3J5cHRvQ29sb3NzZXVtID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDMyOTQyMTcyLAogICAgbmFtZTogIlNLQUxFIHwgQ3J5cHRvIENvbG9zc2V1bSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic0ZVRUwiLCBzeW1ib2w6ICJzRlVFTCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvaGF1bnRpbmctZGV2b3RlZC1kZW5lYiJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2hhdW50aW5nLWRldm90ZWQtZGVuZWIiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9oYXVudGluZy1kZXZvdGVkLWRlbmViLmV4cGxvcmVyLm1haW5uZXQuc2thbGVub2Rlcy5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHt9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc2thbGUvZXVyb3BhLmpzCiAgdmFyIHNrYWxlRXVyb3BhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDQ2Mzk5MTI2LAogICAgbmFtZTogIlNLQUxFIHwgRXVyb3BhIExpcXVpZGl0eSBIdWIiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2VsYXRlZC10YW4tc2thdCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2VsYXRlZC10YW4tc2thdCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNLQUxFIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2VsYXRlZC10YW4tc2thdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDMxMTM0OTUKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2V1cm9wYVRlc3RuZXQuanMKICB2YXIgc2thbGVFdXJvcGFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNDQ0NjczNDE5LAogICAgbmFtZTogIlNLQUxFIEV1cm9wYSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9qdWljeS1sb3ctc21hbGwtdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2p1aWN5LWxvdy1zbWFsbC10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vanVpY3ktbG93LXNtYWxsLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMTA4NTgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9leG9yZGUuanMKICB2YXIgc2thbGVFeG9yZGUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIxMzk5Mjc1NTIsCiAgICBuYW1lOiAiU0tBTEUgfCBFeG9yZGUiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL2xpZ2h0LXZhc3QtZGlwaGRhIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGlnaHQtdmFzdC1kaXBoZGEiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9saWdodC12YXN0LWRpcGhkYS5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL2h1bWFuUHJvdG9jb2wuanMKICB2YXIgc2thbGVIdW1hblByb3RvY29sID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjczMjI3NDUzLAogICAgbmFtZTogIlNLQUxFIHwgSHVtYW4gUHJvdG9jb2wiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dhbi1yZWQtYWluIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3Mvd2FuLXJlZC1haW4iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW4tcmVkLWFpbi5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL25lYnVsYS5qcwogIHZhciBza2FsZU5lYnVsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTQ4MjYwMTY0OSwKICAgIG5hbWU6ICJTS0FMRSB8IE5lYnVsYSBHYW1pbmcgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9ncmVlbi1naWRkeS1kZW5lYm9sYSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2dyZWVuLWdpZGR5LWRlbmVib2xhIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZ3JlZW4tZ2lkZHktZGVuZWJvbGEuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMzcyOTg2CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS9uZWJ1bGFUZXN0bmV0LmpzCiAgdmFyIHNrYWxlTmVidWxhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMzcwODQ2MjQsCiAgICBuYW1lOiAiU0tBTEUgTmVidWxhIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL2xhbmt5LWlsbC1mdW5ueS10ZXN0bmV0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3Rlc3RuZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvbGFua3ktaWxsLWZ1bm55LXRlc3RuZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9sYW5reS1pbGwtZnVubnktdGVzdG5ldC5leHBsb3Jlci50ZXN0bmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEwNTE0MQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3Jhem9yLmpzCiAgdmFyIHNrYWxlUmF6b3IgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI3ODYxMTM1MSwKICAgIG5hbWU6ICJTS0FMRSB8IFJhem9yIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogInNGVUVMIiwgc3ltYm9sOiAic0ZVRUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnNrYWxlbm9kZXMuY29tL3YxL3R1cmJ1bGVudC11bmlxdWUtc2NoZWF0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL21haW5uZXQuc2thbGVub2Rlcy5jb20vdjEvd3MvdHVyYnVsZW50LXVuaXF1ZS1zY2hlYXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90dXJidWxlbnQtdW5pcXVlLXNjaGVhdC5leHBsb3Jlci5tYWlubmV0LnNrYWxlbm9kZXMuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7fQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NrYWxlL3RpdGFuLmpzCiAgdmFyIHNrYWxlVGl0YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEzNTAyMTYyMzQsCiAgICBuYW1lOiAiU0tBTEUgfCBUaXRhbiBDb21tdW5pdHkgSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vbWFpbm5ldC5za2FsZW5vZGVzLmNvbS92MS93cy9wYXJhbGxlbC1zdG9ybXktc3BpY2EiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTS0FMRSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9wYXJhbGxlbC1zdG9ybXktc3BpY2EuZXhwbG9yZXIubWFpbm5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMDc2NDU4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2FsZS90aXRhblRlc3RuZXQuanMKICB2YXIgc2thbGVUaXRhblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwMjAzNTIyMjAsCiAgICBuYW1lOiAiU0tBTEUgVGl0YW4gSHViIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJzRlVFTCIsIHN5bWJvbDogInNGVUVMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5za2FsZW5vZGVzLmNvbS92MS9hd2FyZS1mYWtlLXRyaW0tdGVzdG5ldCJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly90ZXN0bmV0LnNrYWxlbm9kZXMuY29tL3YxL3dzL2F3YXJlLWZha2UtdHJpbS10ZXN0bmV0Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU0tBTEUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vYXdhcmUtZmFrZS10cmltLXRlc3RuZXQuZXhwbG9yZXIudGVzdG5ldC5za2FsZW5vZGVzLmNvbSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMDQwNzIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9za2V0Y2hwYWQuanMKICB2YXIgc2tldGNocGFkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5ODQxMjMsCiAgICBuYW1lOiAiRm9ybWEgU2tldGNocGFkIiwKICAgIG5ldHdvcms6ICJza2V0Y2hwYWQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgc3ltYm9sOiAiVElBIiwKICAgICAgbmFtZTogIlRJQSIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc2tldGNocGFkLTEuZm9ybWEuYXJ0Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLnNrZXRjaHBhZC0xLmZvcm1hLmFydCJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNrZXRjaHBhZCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5za2V0Y2hwYWQtMS5mb3JtYS5hcnQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heC5qcwogIHZhciBzb3VyY2VJZDM3ID0gMTsKICB2YXIgc25heCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMjE5MiwKICAgIG5ldHdvcms6ICJzbmF4Y2hhaW4tbWFpbm5ldCIsCiAgICBuYW1lOiAiU25heENoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuc25heGNoYWluLmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU25heCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zbmF4Y2hhaW4uaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDQ3MjU2MkZjZjI2RDZiMjc5M2Y4RTBiMGZCNjYwYmEwRTVlMDhBNDYiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM3XTogewogICAgICAgICAgYWRkcmVzczogIjB4MjE3MmU0OTJGYzgwN0Y1ZDU2NDVEMEUzNTQzZjEzOUVDRjUzOTI5NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzN106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDc5ZjQ0NkQwMjRkNzREMEJiNkU2OTlDMTMxYzcwMzQ2M2M1RDY1RTkiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzddOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NTM0QmRiNmI1YzA2MGQzZTZhYTgzMzQzMzMzMzEzNWVGRThFMGFBIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDM3CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc25heFRlc3RuZXQuanMKICB2YXIgc291cmNlSWQzOCA9IDExMTU1MTExOwogIHZhciBzbmF4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogMTMwMDEsCiAgICBuZXR3b3JrOiAic25heGNoYWluLXRlc3RuZXQiLAogICAgbmFtZTogIlNuYXhDaGFpbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJTZXBvbGlhIEV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5zbmF4Y2hhaW4uaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTbmF4IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQtZXhwbG9yZXIuc25heGNoYWluLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDIwNmE3NWQ4OWQ0NUYxNDZDNTQwMjBGMTMyRkY5M2JFREQwOWY1NUUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDM4XTogewogICAgICAgICAgYWRkcmVzczogIjB4NjBlM0EzNjhhNGNkQ0VmODVmZkI5NjRlMzcyNzI2RjU2QTQ2MjIxZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIgogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQzOF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGI1YWZkZDBFOGRERjA4MUVmOTBlOEEzZTBjN2I1Nzk4ZTY2RTk1NEUiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkMzhdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhiZDM3RTFhNTlENEMwMEM5QTQ2Rjc1MDE4ZGZmZDg0MDYxYkM1Zjc0IgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzOAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmVpdW1NaW5hdG8uanMKICB2YXIgc291cmNlSWQzOSA9IDExMTU1MTExOwogIHZhciBzb25laXVtTWluYXRvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiAxOTQ2LAogICAgbmFtZTogIlNvbmVpdW0gTWluYXRvIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlNlcG9saWEgRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMubWluYXRvLnNvbmVpdW0ub3JnIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci10ZXN0bmV0LnNvbmVpdW0ub3JnIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2V4cGxvcmVyLXRlc3RuZXQuc29uZWl1bS5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDM5XTogewogICAgICAgICAgYWRkcmVzczogIjB4RjY5ZEI2Y0E1NTlDNTJkOUE0QkI2ZTJCMjkwMWY0OTBDYTM1RmJmNiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkMzldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg3MTBlNTI4NkM3NDZlQzM4YmVlQjc1MzhkMDE0NmY2MEQyN2JlMzQzIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkMzldOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHg2NWVhMTQ4OTc0MUE1RDcyZkZkRDhlNjQ4NUIyMTZiQmRjQzE1QWYzIiwKICAgICAgICAgIGJsb2NrQ3JlYXRlZDogNjQ2NjEzNgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDM5XTogewogICAgICAgICAgYWRkcmVzczogIjB4NWY1YTQwNEE1ZWRhYmNERDgwREIwNUU4ZTU0QTc4YzlFQkYwMDBDMiIsCiAgICAgICAgICBibG9ja0NyZWF0ZWQ6IDY0NjYxMzYKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDEKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQzOQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3NvbmdiaXJkLmpzCiAgdmFyIHNvbmdiaXJkID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOSwKICAgIG5hbWU6ICJTb25nYmlyZCBDYW5hcnktTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb25nYmlyZCIsCiAgICAgIHN5bWJvbDogIlNHQiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3NvbmdiaXJkLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlNvbmdiaXJkIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NvbmdiaXJkLWV4cGxvcmVyLmZsYXJlLm5ldHdvcmsiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc29uZ2JpcmQtZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zb25nYmlyZFRlc3RuZXQuanMKICB2YXIgc29uZ2JpcmRUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNiwKICAgIG5hbWU6ICJTb25nYmlyZCBUZXN0bmV0IENvc3RvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDb3N0b24gRmxhcmUiLAogICAgICBzeW1ib2w6ICJDRkxSIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vY29zdG9uLWFwaS5mbGFyZS5uZXR3b3JrL2V4dC9DL3JwYyJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkNvc3RvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yayIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9jb3N0b24tZXhwbG9yZXIuZmxhcmUubmV0d29yay9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc29waG9uVGVzdG5ldC5qcwogIHZhciBzb3Bob25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDUzMTA1MDEwNCwKICAgIG5hbWU6ICJTb3Bob24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTb3Bob24iLAogICAgICBzeW1ib2w6ICJTT1BIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdG5ldC5zb3Bob24ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50ZXN0bmV0LnNvcGhvbi54eXovd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTb3Bob24gQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudGVzdG5ldC5zb3Bob24ueHl6IgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHg4M2MwNGQxMTJhZGVkQTJDNkQ5MDM3YmI2ZWNiNDJFN2YwYjEwOEFmIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE1NjQyCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3BpY3kuanMKICB2YXIgc3BpY3kgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODgyLAogICAgbmFtZTogIkNoaWxpeiBTcGljeSBUZXN0bmV0IiwKICAgIG5ldHdvcms6ICJjaGlsaXotc3BpY3ktVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJDSFoiLAogICAgICBzeW1ib2w6ICJDSFoiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vc3BpY3ktcnBjLmNoaWxpei5jb20iLAogICAgICAgICAgImh0dHBzOi8vY2hpbGl6LXNwaWN5LXJwYy5wdWJsaWNub2RlLmNvbSIKICAgICAgICBdLAogICAgICAgIHdlYlNvY2tldDogWwogICAgICAgICAgIndzczovL3NwaWN5LXJwYy13cy5jaGlsaXouY29tIiwKICAgICAgICAgICJ3c3M6Ly9jaGlsaXotc3BpY3ktcnBjLnB1YmxpY25vZGUuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQ2hpbGl6IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwOi8vc3BpY3ktZXhwbG9yZXIuY2hpbGl6LmNvbSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cDovL3NwaWN5LWV4cGxvcmVyLmNoaWxpei5jb20vYXBpIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3N0ZXAuanMKICB2YXIgc3RlcCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzNCwKICAgIG5hbWU6ICJTdGVwIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkZJVEZJIiwgc3ltYm9sOiAiRklURkkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RlcC5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3RlcCBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3N0ZXBzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdG9yeVRlc3RuZXQuanMKICB2YXIgc3RvcnlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTEzLAogICAgbmFtZTogIlN0b3J5IFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiSVAiLAogICAgICBzeW1ib2w6ICJJUCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3Rlc3RuZXQuc3RvcnlycGMuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdG9yeSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQuc3RvcnlzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdHJhdGlzLmpzCiAgdmFyIHN0cmF0aXMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwNTEwNSwKICAgIG5hbWU6ICJTdHJhdGlzIE1haW5uZXQiLAogICAgbmV0d29yazogInN0cmF0aXMiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgbmFtZTogIlN0cmF0aXMiLAogICAgICBzeW1ib2w6ICJTVFJBWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuc3RyYXRpc2V2bS5jb20iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTdHJhdGlzIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnN0cmF0aXNldm0uY29tIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3VwZXJsdW1pby5qcwogIHZhciBzdXBlcmx1bWlvID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODY2LAogICAgbmFtZTogIlN1cGVyTHVtaW8iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC5sdW1pby5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkx1bWlvIGV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmx1bWlvLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zdXBlcnBvc2l0aW9uLmpzCiAgdmFyIHN1cGVycG9zaXRpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU1MjQ0LAogICAgbmFtZTogIlN1cGVycG9zaXRpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3JwYy5zdXBlcnBvc2l0aW9uLnNvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3VwZXJwb3NpdGlvbiBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5zdXBlcnBvc2l0aW9uLnNvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuLmpzCiAgdmFyIHN3YW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDI1NCwKICAgIG5hbWU6ICJTd2FuIENoYWluIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL21haW5uZXQtcnBjLnN3YW5jaGFpbi5vcmciXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3N3YW5zY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy9zd2FuUHJveGltYVRlc3RuZXQuanMKICB2YXIgc3dhblByb3hpbWFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAyMDI0MTEzMywKICAgIG5hbWU6ICJTd2FuIFByb3hpbWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLXByb3hpbWEuc3dhbmNoYWluLmlvCSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlN3YW4gRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vcHJveGltYS1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3dhblNhdHVyblRlc3RuZXQuanMKICB2YXIgc3dhblNhdHVyblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDIwMjQsCiAgICBuYW1lOiAiU3dhbiBTYXR1cm4gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiU3dhbiBFdGhlciIsIHN5bWJvbDogInNFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vc2F0dXJuLXJwYy5zd2FuY2hhaW4uaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTd2FuIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL3NhdHVybi1leHBsb3Jlci5zd2FuY2hhaW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pbi5qcwogIHZhciBzeXNjb2luID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1NywKICAgIG5hbWU6ICJTeXNjb2luIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiU3lzY29pbiIsCiAgICAgIHN5bWJvbDogIlNZUyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnN5c2NvaW4ub3JnIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy5zeXNjb2luLm9yZy93c3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJTeXNjb2luRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwbG9yZXIuc3lzY29pbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI4NzEzOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvc3lzY29pblRlc3RuZXQuanMKICB2YXIgc3lzY29pblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDU3MDAsCiAgICBuYW1lOiAiU3lzY29pbiBUYW5lbmJhdW0gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJTeXNjb2luIiwKICAgICAgc3ltYm9sOiAiU1lTIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGFuZW5iYXVtLmlvIl0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3JwYy50YW5lbmJhdW0uaW8vd3NzIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiU3lzY29pblRlc3RuZXRFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90YW5lbmJhdW0uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjcxMjg4CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrby5qcwogIHZhciB0YWlrbyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3ZTMsCiAgICBuYW1lOiAiVGFpa28gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLm1haW5uZXQudGFpa28ueHl6Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3dzLm1haW5uZXQudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGFpa29zY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3RhaWtvc2Nhbi5pbyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkudGFpa29zY2FuLmlvL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2IyNDM2Nzc0QzNlMTkxYzg1MDU2ZDI0OEVGNDI2MGNlNWYyN0E5RCIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhaWtvSGVrbGEuanMKICB2YXIgdGFpa29IZWtsYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTY3MDA5LAogICAgbmFtZTogIlRhaWtvIEhla2xhIEwyIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5oZWtsYS50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUYWlrb3NjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vaGVrbGEudGFpa29zY2FuLm5ldHdvcmsiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29Kb2xuaXIuanMKICB2YXIgdGFpa29Kb2xuaXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNywKICAgIG5hbWU6ICJUYWlrbyBKb2xuaXIgKEFscGhhLTUgVGVzdG5ldCkiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLmpvbG5pci50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLmpvbG5pci50YWlrby54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNzMyNzA2CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFpa29LYXRsYS5qcwogIHZhciB0YWlrb0thdGxhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNjcwMDgsCiAgICBuYW1lOiAiVGFpa28gS2F0bGEgKEFscGhhLTYgVGVzdG5ldCkiLAogICAgbmV0d29yazogInRrby1rYXRsYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMua2F0bGEudGFpa28ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiYmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5rYXRsYS50YWlrby54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90YWlrb1Rlc3RuZXRTZXBvbGlhLmpzCiAgdmFyIHRhaWtvVGVzdG5ldFNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE2NzAwNSwKICAgIG5hbWU6ICJUYWlrbyAoQWxwaGEtMyBUZXN0bmV0KSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVzdC50YWlrby54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJibG9ja3Njb3V0IiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3QudGFpa28ueHl6IgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGFyYXhhLmpzCiAgdmFyIHRhcmF4YSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQxLAogICAgbmFtZTogIlRhcmF4YSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy5tYWlubmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci5tYWlubmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RhcmF4YVRlc3RuZXQuanMKICB2YXIgdGFyYXhhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODQyLAogICAgbmFtZTogIlRhcmF4YSBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUYXJhIiwgc3ltYm9sOiAiVEFSQSIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy50ZXN0bmV0LnRhcmF4YS5pbyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlRhcmF4YSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci50ZXN0bmV0LnRhcmF4YS5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90ZWxjb2luVGVzdG5ldC5qcwogIHZhciB0ZWxjb2luVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjAxNywKICAgIG5hbWU6ICJUZWxjb2luIEFkaXJpIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRlbGNvaW4iLCBzeW1ib2w6ICJURUwiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVsY29pbi5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAidGVsc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZWxzY2FuLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbG9zLmpzCiAgdmFyIHRlbG9zID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0MCwKICAgIG5hbWU6ICJUZWxvcyIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJUZWxvcyIsCiAgICAgIHN5bWJvbDogIlRMT1MiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9tYWlubmV0LnRlbG9zLm5ldC9ldm0iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUZWxvc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93d3cudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDI0NjUzMDcwOQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGVsb3NUZXN0bmV0LmpzCiAgdmFyIHRlbG9zVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDEsCiAgICBuYW1lOiAiVGVsb3MiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVGVsb3MiLAogICAgICBzeW1ib2w6ICJUTE9TIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC50ZWxvcy5uZXQvZXZtIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVsb3NjYW4gKHRlc3RuZXQpIiwKICAgICAgICB1cmw6ICJodHRwczovL3Rlc3RuZXQudGVsb3NjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RlbmV0LmpzCiAgdmFyIHRlbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxNTU5LAogICAgbmFtZTogIlRlbmV0IiwKICAgIG5ldHdvcms6ICJ0ZW5ldC1tYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJURU5FVCIsCiAgICAgIHN5bWJvbDogIlRFTkVUIiwKICAgICAgZGVjaW1hbHM6IDE4CiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMudGVuZXQub3JnIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGVuZXRTY2FuIE1haW5uZXQiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVuZXRzY2FuLmlvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3RlbmV0c2Nhbi5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3RoYWlDaGFpbi5qcwogIHZhciB0aGFpQ2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDcsCiAgICBuYW1lOiAiVGhhaUNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUQ0giLCBzeW1ib2w6ICJUQ0giLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudGhhaWNoYWluLm9yZyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vZXhwLnRoYWljaGFpbi5vcmcvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwRGFENjEzMGU4MzJjMjE3MTlDNUNFM2JhZTkzNDU0RTE2QTg0ODI2IiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDQ4MDYzODYKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdGh1bmRlckNvcmUuanMKICB2YXIgdGh1bmRlckNvcmUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDEwOCwKICAgIG5hbWU6ICJUaHVuZGVyQ29yZSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJUVCIsIHN5bWJvbDogIlRUIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vbWFpbm5ldC1ycGMudGh1bmRlcmNvcmUuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVGh1bmRlckNvcmUgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdmlld2Jsb2NrLmlvL3RodW5kZXJjb3JlIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aHVuZGVyVGVzdG5ldC5qcwogIHZhciB0aHVuZGVyVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTk3LAogICAgbmFtZTogIjVpcmVDaGFpbiBUaHVuZGVyIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIjVpcmUgVG9rZW4iLCBzeW1ib2w6ICI1SVJFIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLXRlc3RuZXQuNWlyZS5uZXR3b3JrIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiNWlyZUNoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLjVpcmUubmV0d29yayIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy90aWt0cml4VGVzdG5ldC5qcwogIHZhciB0aWt0cml4VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjIwOTIsCiAgICBuYW1lOiAiVGlrVHJpeCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIG5hbWU6ICJ0VFRYIiwKICAgICAgc3ltYm9sOiAidFRUWCIsCiAgICAgIGRlY2ltYWxzOiAxOAogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90aWt0cml4LXJwYy54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUaWtUcml4IFRlc3RuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGlrdHJpeC54eXoiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdHJvbi5qcwogIHZhciB0cm9uID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MjgxMjY0MjgsCiAgICBuYW1lOiAiVHJvbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVFJPTiIsIHN5bWJvbDogIlRSWCIsIGRlY2ltYWxzOiA2IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLnRyb25ncmlkLmlvL2pzb25ycGMiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJUcm9uc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90cm9uc2Nhbi5vcmciLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpbGlzdC50cm9uc2NhbmFwaS5jb20vYXBpIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdWx0cm9uLmpzCiAgdmFyIHVsdHJvbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTIzMSwKICAgIG5hbWU6ICJVbHRyb24gTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVUxYIiwgc3ltYm9sOiAiVUxYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdWx0cm9uLXJwYy5uZXQiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbHRyb24gU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly91bHhzY2FuLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdWx0cm9uVGVzdG5ldC5qcwogIHZhciB1bHRyb25UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMjMwLAogICAgbmFtZTogIlVsdHJvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJVTFgiLCBzeW1ib2w6ICJVTFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly91bHRyb24tZGV2LmlvIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVWx0cm9uIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIudWx0cm9uLWRldi5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy91bmljaGFpblNlcG9saWEuanMKICB2YXIgc291cmNlSWQ0MCA9IDExMTU1MTExOwogIHZhciB1bmljaGFpblNlcG9saWEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcyLAogICAgaWQ6IDEzMDEsCiAgICBuYW1lOiAiVW5pY2hhaW4gU2Vwb2xpYSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiLAogICAgICBkZWNpbWFsczogMTgKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vc2Vwb2xpYS51bmljaGFpbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJVbmlzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3NlcG9saWEudW5pc2Nhbi54eXoiLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vYXBpLXNlcG9saWEudW5pc2Nhbi54eXoiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQ0MF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDBkODNkYWI2MjlmMGUwRjlkMzZjMENiYzg5QjY5YTQ4OWYwNzUxYkQiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMVN0YW5kYXJkQnJpZGdlOiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlYTU4ZmNBNjg0OWQ3OUVBZDFmMjY2MDg4NTVjMkQ2NDA3ZDU0Q2UyIgogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlzcHV0ZUdhbWVGYWN0b3J5OiB7CiAgICAgICAgW3NvdXJjZUlkNDBdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhlZmY3M2U1YWEzQjlBRUMzMmM2NTlBYTNFMDA0NDRkMjBhODQzOTRiIgogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBzb3VyY2VJZDogc291cmNlSWQ0MAogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VuaXF1ZS5qcwogIHZhciB1bmlxdWUgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODAsCiAgICBuYW1lOiAiVW5pcXVlIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVU5RIiwKICAgICAgc3ltYm9sOiAiVU5RIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnVuaXF1ZS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVW5pcXVlIFN1YnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdW5pcXVlLnN1YnNjYW4uaW8vIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdW5pcXVlT3BhbC5qcwogIHZhciB1bmlxdWVPcGFsID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4ODgyLAogICAgbmFtZTogIk9wYWwgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPUEwiLAogICAgICBzeW1ib2w6ICJPUEwiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMtb3BhbC51bmlxdWUubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIk9wYWwgU3Vic2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9vcGFsLnN1YnNjYW4uaW8vIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VuaXF1ZVF1YXJ0ei5qcwogIHZhciB1bmlxdWVRdWFydHogPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODEsCiAgICBuYW1lOiAiUXVhcnR6IE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiUVRaIiwKICAgICAgc3ltYm9sOiAiUVRaIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLXF1YXJ0ei51bmlxdWUubmV0d29yayJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlF1YXJ0eiBTdWJzY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3F1YXJ0ei5zdWJzY2FuLmlvLyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3VucmVhbC5qcwogIHZhciB1bnJlYWwgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE4MjMzLAogICAgbmFtZTogIlVucmVhbCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBuYW1lOiAicmVFVEgiLAogICAgICBkZWNpbWFsczogMTgsCiAgICAgIHN5bWJvbDogInJlRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnVucmVhbC1vcmJpdC5nZWxhdG8uZGlnaXRhbCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlVucmVhbCBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly91bnJlYWwuYmxvY2tzY291dC5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vdW5yZWFsLmJsb2Nrc2NvdXQuY29tL2FwaS92MiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUsCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDhiNkIwZTYwRDhDRDg0ODk4RWE4Yjk4MTA2NUExMkY4NzZlQTU2NzciLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMTc0NQogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmVjaGFpbi5qcwogIHZhciB2ZWNoYWluID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMDAwMDksCiAgICBuYW1lOiAiVmVjaGFpbiIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVmVDaGFpbiIsIHN5bWJvbDogIlZFVCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQudmVjaGFpbi5vcmciXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWZWNoYWluIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmUudmVjaGFpbi5vcmciCiAgICAgIH0sCiAgICAgIHZlY2hhaW5TdGF0czogewogICAgICAgIG5hbWU6ICJWZWNoYWluIFN0YXRzIiwKICAgICAgICB1cmw6ICJodHRwczovL3ZlY2hhaW5zdGF0cy5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92ZWxhcy5qcwogIHZhciB2ZWxhcyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTA2LAogICAgbmFtZTogIlZlbGFzIEVWTSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWTFgiLCBzeW1ib2w6ICJWTFgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ldm1leHBsb3Jlci52ZWxhcy5jb20vcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVmVsYXMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZtZXhwbG9yZXIudmVsYXMuY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy92aWN0aW9uLmpzCiAgdmFyIHZpY3Rpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4LAogICAgbmFtZTogIlZpY3Rpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZpY3Rpb24iLCBzeW1ib2w6ICJWSUMiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMudmljdGlvbi54eXoiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJWSUMgU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly92aWNzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvdmljdGlvblRlc3RuZXQuanMKICB2YXIgdmljdGlvblRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg5LAogICAgbmFtZTogIlZpY3Rpb24gVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiVmljdGlvbiIsIHN5bWJvbDogIlZJQyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy10ZXN0bmV0LnZpY3Rpb24ueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVklDIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC52aWNzY2FuLnh5eiIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAxMjE3MDE3OQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Zpc2lvbi5qcwogIHZhciB2aXNpb24gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDg4ODg4OCwKICAgIG5hbWU6ICJWaXNpb24iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlZJU0lPTiIsIHN5bWJvbDogIlZTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vaW5mcmFncmlkLnYubmV0d29yay9ldGhlcmV1bS9jb21wYXRpYmxlIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiVmlzaW9uIFNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vdmlzaW9uc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3Zpc2lvblRlc3RuZXQuanMKICB2YXIgdmlzaW9uVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjY2NjY2LAogICAgbmFtZTogIlZpc2lvbiBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJWSVNJT04iLCBzeW1ib2w6ICJWUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3ZwaW9uZWVyLmluZnJhZ3JpZC52Lm5ldHdvcmsvZXRoZXJldW0vY29tcGF0aWJsZSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlZpc2lvbiBTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3Zpc2lvbnNjYW4ub3JnLz9jaGFpbj12cGlvbmVlciIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93YW5jaGFpbi5qcwogIHZhciB3YW5jaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODg4LAogICAgbmFtZTogIldhbmNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJXQU5DSEFJTiIsIHN5bWJvbDogIldBTiIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWwogICAgICAgICAgImh0dHBzOi8vZ3dhbi1zc2wud2FuZGV2cy5vcmc6NTY4OTEiLAogICAgICAgICAgImh0dHBzOi8vZ3dhbjItc3NsLndhbmRldnMub3JnIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV2FuU2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93YW5zY2FuLm9yZyIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0RGNkExNTY2ZTc4RUI0NTk0Yzg2RmU3M0ZjZGM4MjQyOWU5N2ZiQiIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNTMxMjM5MAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd2FuY2hhaW5UZXN0bmV0LmpzCiAgdmFyIHdhbmNoYWluVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogOTk5LAogICAgbmFtZTogIldhbmNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIldBTkNIQUlOIiwgc3ltYm9sOiAiV0FOdCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL2d3YW4tc3NsLndhbmRldnMub3JnOjQ2ODkxIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV2FuU2NhblRlc3QiLAogICAgICAgIHVybDogImh0dHBzOi8vd2Fuc2Nhbi5vcmciCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweDExYzg5YkY0NDk2YzM5RkI4MDUzNUZmYjRjOTI3MTU4MzlDQzUzMjQiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjQ3NDM0NDgKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZWF2ZXZtQWxwaGFuZXQuanMKICB2YXIgd2VhdmVWTUFscGhhbmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA5NDk2LAogICAgbmFtZTogIldlYXZlVk0gQWxwaGFuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIlRlc3RuZXQgV2VhdmVWTSIsIHN5bWJvbDogInRXVk0iLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC1ycGMud3ZtLmRldiJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIldlYXZlVk0gQWxwaGFuZXQgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIud3ZtLmRldiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZW1peC5qcwogIHZhciB3ZW1peCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMTExMSwKICAgIG5hbWU6ICJXRU1JWCIsCiAgICBuZXR3b3JrOiAid2VtaXgtbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiV0VNSVgiLCBzeW1ib2w6ICJXRU1JWCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9hcGkud2VtaXguY29tIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAid2VtaXhFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci53ZW1peC5jb20iCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy93ZW1peFRlc3RuZXQuanMKICB2YXIgd2VtaXhUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMTEyLAogICAgbmFtZTogIldFTUlYIFRlc3RuZXQiLAogICAgbmV0d29yazogIndlbWl4LXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIldFTUlYIiwgc3ltYm9sOiAidFdFTUlYIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2FwaS50ZXN0LndlbWl4LmNvbSJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIndlbWl4RXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC53ZW1peHNjYW4uY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQud2VtaXhzY2FuLmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd29ybGRjaGFpbi5qcwogIHZhciBzb3VyY2VJZDQxID0gMTsKICB2YXIgd29ybGRjaGFpbiA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDgwLAogICAgbmFtZTogIldvcmxkIENoYWluIiwKICAgIG5ldHdvcms6ICJ3b3JsZGNoYWluIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFdGhlciIsIHN5bWJvbDogIkVUSCIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly93b3JsZGNoYWluLW1haW5uZXQuZy5hbGNoZW15LmNvbS9wdWJsaWMiXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJXb3JsZHNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vd29ybGRzY2FuLm9yZyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGkud29ybGRzY2FuLm9yZy9hcGkiCiAgICAgIH0sCiAgICAgIGJsb2Nrc2NvdXQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly93b3JsZGNoYWluLW1haW5uZXQuZXhwbG9yZXIuYWxjaGVteS5jb20iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vd29ybGRjaGFpbi1tYWlubmV0LmV4cGxvcmVyLmFsY2hlbXkuY29tL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAwCiAgICAgIH0sCiAgICAgIGRpc3B1dGVHYW1lRmFjdG9yeTogewogICAgICAgIFtzb3VyY2VJZDQxXTogewogICAgICAgICAgYWRkcmVzczogIjB4MEU5MGRDQUZCQzI0MkQyQzg2MUEyMEJiMjBFQzhFNzE4Mjk2NWE1MiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwyT3V0cHV0T3JhY2xlOiB7CiAgICAgICAgW3NvdXJjZUlkNDFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHgxOUE2ZDFFOTAzNDU5NjE5NjI5NUNGMTQ4NTA5Nzk2OTc4MzQzYzVEIgogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ydGFsOiB7CiAgICAgICAgW3NvdXJjZUlkNDFdOiB7CiAgICAgICAgICBhZGRyZXNzOiAiMHhkNWVjMTRhODNCN2Q5NUJFMUUyQWMxMjUyM2UyZEVFMTJDYmVlYTZDIgogICAgICAgIH0KICAgICAgfSwKICAgICAgbDFTdGFuZGFyZEJyaWRnZTogewogICAgICAgIFtzb3VyY2VJZDQxXTogewogICAgICAgICAgYWRkcmVzczogIjB4NDcwNDU4QzkxOTc4RDJkOTI5NzA0NDg5QWQ3MzBEQzNFMzAwMTExMyIKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiBmYWxzZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQxCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvd29ybGRjaGFpblNlcG9saWEuanMKICB2YXIgc291cmNlSWQ0MiA9IDExMTU1MTExOwogIHZhciB3b3JsZGNoYWluU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZzIsCiAgICBpZDogNDgwMSwKICAgIG5hbWU6ICJXb3JsZCBDaGFpbiBTZXBvbGlhIiwKICAgIG5ldHdvcms6ICJ3b3JsZGNoYWluLXNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIkV0aGVyIiwgc3ltYm9sOiAiRVRIIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3dvcmxkY2hhaW4tc2Vwb2xpYS5nLmFsY2hlbXkuY29tL3B1YmxpYyJdIH0sCiAgICAgIHB1YmxpYzogeyBodHRwOiBbImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmcuYWxjaGVteS5jb20vcHVibGljIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiV29ybGRzY2FuIFNlcG9saWEiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS53b3JsZHNjYW4ub3JnIgogICAgICB9LAogICAgICBibG9ja3Njb3V0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vd29ybGRjaGFpbi1zZXBvbGlhLmV4cGxvcmVyLmFsY2hlbXkuY29tIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3dvcmxkY2hhaW4tc2Vwb2xpYS5leHBsb3Jlci5hbGNoZW15LmNvbS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMAogICAgICB9LAogICAgICBkaXNwdXRlR2FtZUZhY3Rvcnk6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDhjRjk3RWU2MTZDOTg2YTA3MEY1MDIwZDk3M2I0NTZEMDEyMEMyNTMiCiAgICAgICAgfQogICAgICB9LAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4Yzg4ODZmOEJBYjZFYWViMjE1YURCNWYxYzY4NkJGNjk5MjQ4MzAwZSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQyXTogewogICAgICAgICAgYWRkcmVzczogIjB4RmY2RUJhMTA5MjcxZmU2ZDQyMzdFZWVENGJBYjFkRDlBNzdkRDFBNCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0Ml06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweGQ3REY1NGIzOTg5ODU1ZWI2NjQ5NzMwMWE0YUFFYzMzRGJiM0Y4REUiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZSwKICAgIHNvdXJjZUlkOiBzb3VyY2VJZDQyCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGFpLmpzCiAgdmFyIHhhaSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNjYwMjc5LAogICAgbmFtZTogIlhhaSBNYWlubmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJYYWkiLCBzeW1ib2w6ICJYQUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly94YWktY2hhaW4ubmV0L3JwYyJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIueGFpLWNoYWluLm5ldCIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y2ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiZTJhMTczOTc2Y2ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyMjI1NDkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGFpVGVzdG5ldC5qcwogIHZhciB4YWlUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzNzcxNDU1NTQyOSwKICAgIG5hbWU6ICJYYWkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAic1hhaSIsIHN5bWJvbDogInNYQUkiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXYyLnhhaS1jaGFpbi5uZXQvcnBjIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzY291dCIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LWV4cGxvcmVyLXYyLnhhaS1jaGFpbi5uZXQiCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveGRjLmpzCiAgdmFyIHhkYyA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNTAsCiAgICBuYW1lOiAiWGluRmluIE5ldHdvcmsiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWERDIiwKICAgICAgc3ltYm9sOiAiWERDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnhkY3JwYy5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJYRENTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL3hkY3NjYW4uY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHgwQjE3OTVjY0E4RTRlQzRkZjAyMzQ2YTA4MmRmNTRENDM3RjhEOWFGIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDc1ODg0MDIwCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy94ZGNUZXN0bmV0LmpzCiAgdmFyIHhkY1Rlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDUxLAogICAgbmFtZTogIkFwb3RoZW0gTmV0d29yayIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJUWERDIiwKICAgICAgc3ltYm9sOiAiVFhEQyIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL2VycGMuYXBvdGhlbS5uZXR3b3JrIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiQmxvY2tzc2NhbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9hcG90aGVtLmJsb2Nrc3NjYW4uaW8iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNTk3NjUzODkKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3hMYXllci5qcwogIHZhciB4TGF5ZXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDE5NiwKICAgIG5hbWU6ICJYIExheWVyIE1haW5uZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiT0tCIiwKICAgICAgc3ltYm9sOiAiT0tCIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogeyBodHRwOiBbImh0dHBzOi8vcnBjLnhsYXllci50ZWNoIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiT0tMaW5rIiwKICAgICAgICB1cmw6ICJodHRwczovL3d3dy5va2xpbmsuY29tL3hsYXllciIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly93d3cub2tsaW5rLmNvbS9hcGkvdjUvZXhwbG9yZXIveGxheWVyL2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NzQxNgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveExheWVyVGVzdG5ldC5qcwogIHZhciB4TGF5ZXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxOTUsCiAgICBuYW1lOiAiWDEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJPS0IiLAogICAgICBzeW1ib2w6ICJPS0IiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly94bGF5ZXJ0ZXN0cnBjLm9reC5jb20iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJPS0xpbmsiLAogICAgICAgIHVybDogImh0dHBzOi8vd3d3Lm9rbGluay5jb20veGxheWVyLXRlc3QiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNhMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYmUyYTE3Mzk3NmNhMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjI0MzQ0CiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMveHJTZXBvbGlhLmpzCiAgdmFyIHhyU2Vwb2xpYSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogMjczMCwKICAgIG5hbWU6ICJYUiBTZXBvbGlhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7CiAgICAgIGRlY2ltYWxzOiAxOCwKICAgICAgbmFtZTogInRYUiIsCiAgICAgIHN5bWJvbDogInRYUiIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsgaHR0cDogWyJodHRwczovL3hyLXNlcG9saWEtdGVzdG5ldC5ycGMuY2FsZGVyYS54eXovaHR0cCJdIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkJsb2Nrc2NvdXQiLAogICAgICAgIHVybDogImh0dHBzOi8veHItc2Vwb2xpYS10ZXN0bmV0LmV4cGxvcmVyLmNhbGRlcmEueHl6IgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3lvb2xkb1ZlcnNlLmpzCiAgdmFyIHlvb2xkb1ZlcnNlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNSwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsgbmFtZTogIk9BUyIsIHN5bWJvbDogIk9BUyIsIGRlY2ltYWxzOiAxOCB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy55b29sZG8tdmVyc2UueHl6Il0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWW9vbGRvIFZlcnNlIEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnlvb2xkby12ZXJzZS54eXoiCiAgICAgIH0KICAgIH0KICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy95b29sZG9WZXJzZVRlc3RuZXQuanMKICB2YXIgeW9vbGRvVmVyc2VUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA1MDAwNiwKICAgIG5hbWU6ICJZb29sZG8gVmVyc2UgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiT0FTIiwgc3ltYm9sOiAiT0FTIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vcnBjLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIllvb2xkbyBWZXJzZSBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQueW9vbGRvLXZlcnNlLnh5eiIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96ZW5jaGFpblRlc3RuZXQuanMKICB2YXIgemVuY2hhaW5UZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA4NDA4LAogICAgbmFtZTogIlplbmNoYWluIFRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWkNYIiwKICAgICAgc3ltYm9sOiAiWkNYIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly96ZW5jaGFpbi10ZXN0bmV0LmFwaS5vbmZpbmFsaXR5LmlvL3B1YmxpYy13cyJdCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogMjMwMDE5CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlplbnRyYWNlIiwKICAgICAgICB1cmw6ICJodHRwczovL3plbnRyYWNlLmlvIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3pldGFjaGFpbi5qcwogIHZhciB6ZXRhY2hhaW4gPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDdlMywKICAgIG5hbWU6ICJaZXRhQ2hhaW4iLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWmV0YSIsCiAgICAgIHN5bWJvbDogIlpFVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3pldGFjaGFpbi1ldm0uYmxvY2twaS5uZXR3b3JrL3YxL3JwYy9wdWJsaWMiXQogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE2MzI3ODEKICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmV0YVNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemV0YWNoYWluLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemV0YWNoYWluQXRoZW5zVGVzdG5ldC5qcwogIHZhciB6ZXRhY2hhaW5BdGhlbnNUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA3MDAxLAogICAgbmFtZTogIlpldGFDaGFpbiBBdGhlbnMgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJaZXRhIiwKICAgICAgc3ltYm9sOiAiYVpFVEEiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3pldGFjaGFpbi1hdGhlbnMtZXZtLmJsb2NrcGkubmV0d29yay92MS9ycGMvcHVibGljIl0KICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiAyNzE1MjE3CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlpldGFTY2FuIiwKICAgICAgICB1cmw6ICJodHRwczovL2F0aGVucy5leHBsb3Jlci56ZXRhY2hhaW4uY29tIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3poZWppYW5nLmpzCiAgdmFyIHpoZWppYW5nID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAxMzM3ODAzLAogICAgbmFtZTogIlpoZWppYW5nIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaGVqaWFuZyBFdGhlciIsIHN5bWJvbDogIlpoZWpFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9ycGMuemhlamlhbmcuZXRocGFuZGFvcHMuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJCZWFjb25jaGFpbiIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly96aGVqaWFuZy5iZWFjb25jaGEuaW4iCiAgICAgIH0KICAgIH0sCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemlsbGlxYS5qcwogIHZhciB6aWxsaXFhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiAzMjc2OSwKICAgIG5hbWU6ICJaaWxsaXFhIiwKICAgIG5ldHdvcms6ICJ6aWxsaXFhIiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaWxsaXFhIiwgc3ltYm9sOiAiWklMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vYXBpLnppbGxpcWEuY29tIl0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiRXRoZXJuYWwiLAogICAgICAgIHVybDogImh0dHBzOi8vZXZteC56aWxsaXFhLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemlsbGlxYVRlc3RuZXQuanMKICB2YXIgemlsbGlxYVRlc3RuZXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDMzMTAxLAogICAgbmFtZTogIlppbGxpcWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemlsbGlxYS10ZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJaaWxsaXFhIiwgc3ltYm9sOiAiWklMIiwgZGVjaW1hbHM6IDE4IH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vZGV2LWFwaS56aWxsaXFhLmNvbSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIkV0aGVybmFsIiwKICAgICAgICB1cmw6ICJodHRwczovL2V2bXgudGVzdG5ldC56aWxsaXFhLmNvbSIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aXJjdWl0LmpzCiAgdmFyIHppcmN1aXQgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQ4OTAwLAogICAgbmFtZTogIlppcmN1aXQgTWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFdGhlciIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0MS1tYWlubmV0LnAycGlmeS5jb20iLAogICAgICAgICAgImh0dHBzOi8vemlyY3VpdDEtbWFpbm5ldC5saXF1aWZ5LmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0LW1haW5uZXQuZHJwYy5vcmciCiAgICAgICAgXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJaaXJjdWl0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnppcmN1aXQuY29tIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIgogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogZmFsc2UKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96aXJjdWl0VGVzdG5ldC5qcwogIHZhciB6aXJjdWl0VGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogNDg4OTksCiAgICBuYW1lOiAiWmlyY3VpdCBUZXN0bmV0IiwKICAgIG5hdGl2ZUN1cnJlbmN5OiB7IG5hbWU6ICJFVEgiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsKICAgICAgICAgICJodHRwczovL3ppcmN1aXQxLXRlc3RuZXQucDJwaWZ5LmNvbSIsCiAgICAgICAgICAiaHR0cHM6Ly96aXJjdWl0MS10ZXN0bmV0LmxpcXVpZnkuY29tIgogICAgICAgIF0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiWmlyY3VpdCBUZXN0bmV0IEV4cGxvcmVyIiwKICAgICAgICB1cmw6ICJodHRwczovL2V4cGxvcmVyLnRlc3RuZXQuemlyY3VpdC5jb20iCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweGNBMTFiZGUwNTk3N2IzNjMxMTY3MDI4ODYyYkUyYTE3Mzk3NkNBMTEiLAogICAgICAgIGJsb2NrQ3JlYXRlZDogNjA0MDI4NwogICAgICB9CiAgICB9LAogICAgdGVzdG5ldDogdHJ1ZQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prRmFpci5qcwogIHZhciB6a0ZhaXIgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDQyNzY2LAogICAgbmFtZTogIlpLRmFpciBNYWlubmV0IiwKICAgIG5ldHdvcms6ICJ6a2ZhaXItbWFpbm5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJVU0QgQ29pbiIsCiAgICAgIHN5bWJvbDogIlVTREMiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy56a2ZhaXIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0ZhaXIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Nhbi56a2ZhaXIuaW8iLAogICAgICAgIGFwaVVybDogImh0dHBzOi8vc2Nhbi56a2ZhaXIuaW8vYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjYTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJlMmExNzM5NzZjYTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDYwOTA5NTkKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IGZhbHNlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtGYWlyVGVzdG5ldC5qcwogIHZhciB6a0ZhaXJUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIGlkOiA0Mzg1MSwKICAgIG5hbWU6ICJaS0ZhaXIgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemtmYWlyLXRlc3RuZXQiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiVVNEIENvaW4iLAogICAgICBzeW1ib2w6ICJVU0RDIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly90ZXN0bmV0LXJwYy56a2ZhaXIuaW8iXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0ZhaXIgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vdGVzdG5ldC1zY2FuLnprZmFpci5pbyIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a0xpbmtOb3ZhLmpzCiAgdmFyIHprTGlua05vdmEgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgaWQ6IDgxMDE4MCwKICAgIG5hbWU6ICJ6a0xpbmsgTm92YSIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9ycGMuemtsaW5rLmlvIl0gfQogICAgfSwKICAgIGJsb2NrRXhwbG9yZXJzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBuYW1lOiAiemtMaW5rIE5vdmEgQmxvY2sgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vZXhwbG9yZXIuemtsaW5rLmlvIgogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtMaW5rTm92YVNlcG9saWFUZXN0bmV0LmpzCiAgdmFyIHprTGlua05vdmFTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICBpZDogODEwMTgxLAogICAgbmFtZTogInprTGluayBOb3ZhIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJFVEgiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7IGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLnJwYy56a2xpbmsuaW8iXSB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJ6a0xpbmsgTm92YSBCbG9jayBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnprbGluay5pbyIKICAgICAgfQogICAgfQogIH0pOwoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vY2hhaW5zL2RlZmluaXRpb25zL3prc3luYy5qcwogIHZhciB6a3N5bmMgPSAvKiBAX19QVVJFX18gKi8gZGVmaW5lQ2hhaW4oewogICAgLi4uY2hhaW5Db25maWcsCiAgICBpZDogMzI0LAogICAgbmFtZTogIlpLc3luYyBFcmEiLAogICAgbmV0d29yazogInprc3luYy1lcmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL21haW5uZXQuZXJhLnprc3luYy5pbyJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9tYWlubmV0LmVyYS56a3N5bmMuaW8vd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vZXJhLnprc3luYy5uZXR3b3JrLyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9hcGktZXJhLnprc3luYy5uZXR3b3JrL2FwaSIKICAgICAgfSwKICAgICAgbmF0aXZlOiB7CiAgICAgICAgbmFtZTogIlpLc3luYyBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56a3N5bmMuaW8vIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2Jsb2NrLWV4cGxvcmVyLWFwaS5tYWlubmV0Lnprc3luYy5pby9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgbXVsdGljYWxsMzogewogICAgICAgIGFkZHJlc3M6ICIweEY5Y2RhNjI0RkJDN2UwNTkzNTVjZTk4YTMxNjkzZDI5OUZBQ2Q5NjMiCiAgICAgIH0sCiAgICAgIHVuaXZlcnNhbFNpZ25hdHVyZVZlcmlmaWVyOiB7CiAgICAgICAgYWRkcmVzczogIjB4ZkI2ODgzMzAzNzk5NzZEQTgxZUI2NEZlNEJGNTBkNzQwMTc2M0I5QyIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA0NTY1OTM4OAogICAgICB9CiAgICB9CiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvemtzeW5jSW5NZW1vcnlOb2RlLmpzCiAgdmFyIHprc3luY0luTWVtb3J5Tm9kZSA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAyNjAsCiAgICBuYW1lOiAiWktzeW5jIEluTWVtb3J5IE5vZGUiLAogICAgbmV0d29yazogInprc3luYy1pbi1tZW1vcnktbm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovL2xvY2FsaG9zdDo4MDExIl0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a3N5bmNMb2NhbE5vZGUuanMKICB2YXIgemtzeW5jTG9jYWxOb2RlID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnLAogICAgaWQ6IDI3MCwKICAgIG5hbWU6ICJaS3N5bmMgQ0xJIExvY2FsIE5vZGUiLAogICAgbmV0d29yazogInprc3luYy1jbGktbG9jYWwtbm9kZSIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cDovL2xvY2FsaG9zdDozMDUwIl0KICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96a3N5bmNTZXBvbGlhVGVzdG5ldC5qcwogIHZhciB6a3N5bmNTZXBvbGlhVGVzdG5ldCA9IC8qIEBfX1BVUkVfXyAqLyBkZWZpbmVDaGFpbih7CiAgICAuLi5jaGFpbkNvbmZpZywKICAgIGlkOiAzMDAsCiAgICBuYW1lOiAiWktzeW5jIFNlcG9saWEgVGVzdG5ldCIsCiAgICBuZXR3b3JrOiAiemtzeW5jLXNlcG9saWEtdGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogeyBuYW1lOiAiRXRoZXIiLCBzeW1ib2w6ICJFVEgiLCBkZWNpbWFsczogMTggfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLmVyYS56a3N5bmMuZGV2Il0sCiAgICAgICAgd2ViU29ja2V0OiBbIndzczovL3NlcG9saWEuZXJhLnprc3luYy5kZXYvd3MiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFdGhlcnNjYW4iLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS1lcmEuemtzeW5jLm5ldHdvcmsvIiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL2FwaS1zZXBvbGlhLWVyYS56a3N5bmMubmV0d29yay9hcGkiCiAgICAgIH0sCiAgICAgIG5hdGl2ZTogewogICAgICAgIG5hbWU6ICJaS3N5bmMgRXhwbG9yZXIiLAogICAgICAgIHVybDogImh0dHBzOi8vc2Vwb2xpYS5leHBsb3Jlci56a3N5bmMuaW8vIiwKICAgICAgICBibG9ja0V4cGxvcmVyQXBpOiAiaHR0cHM6Ly9ibG9jay1leHBsb3Jlci1hcGkuc2Vwb2xpYS56a3N5bmMuZGV2L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4RjljZGE2MjRGQkM3ZTA1OTM1NWNlOThhMzE2OTNkMjk5RkFDZDk2MyIKICAgICAgfSwKICAgICAgdW5pdmVyc2FsU2lnbmF0dXJlVmVyaWZpZXI6IHsKICAgICAgICBhZGRyZXNzOiAiMHhmQjY4ODMzMDM3OTk3NkRBODFlQjY0RmU0QkY1MGQ3NDAxNzYzQjlDIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDM4NTU3MTIKICAgICAgfQogICAgfSwKICAgIHRlc3RuZXQ6IHRydWUKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96b3JhLmpzCiAgdmFyIHNvdXJjZUlkNDMgPSAxOwogIHZhciB6b3JhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA3Nzc3Nzc3LAogICAgbmFtZTogIlpvcmEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiRXRoZXIiLAogICAgICBzeW1ib2w6ICJFVEgiCiAgICB9LAogICAgcnBjVXJsczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgaHR0cDogWyJodHRwczovL3JwYy56b3JhLmVuZXJneSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9ycGMuem9yYS5lbmVyZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56b3JhLmVuZXJneSIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9leHBsb3Jlci56b3JhLmVuZXJneS9hcGkiCiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdHM6IHsKICAgICAgLi4uY2hhaW5Db25maWcyLmNvbnRyYWN0cywKICAgICAgbDJPdXRwdXRPcmFjbGU6IHsKICAgICAgICBbc291cmNlSWQ0M106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDlFNjIwNEY3NTBjRDg2NmIyOTk1OTRlMmFDOWVBODI0RTJlNWY5NWMiCiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aWNhbGwzOiB7CiAgICAgICAgYWRkcmVzczogIjB4Y0ExMWJkZTA1OTc3YjM2MzExNjcwMjg4NjJiRTJhMTczOTc2Q0ExMSIsCiAgICAgICAgYmxvY2tDcmVhdGVkOiA1ODgyCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQzXTogewogICAgICAgICAgYWRkcmVzczogIjB4MWEwYWQwMTE5MTNBMTUwZjY5ZjZBMTlERjQ0N0EwQ2ZEOTU1MTA1NCIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0M106IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDNlMkVhOUI5MkI3RTQ4QTUyMjk2ZkQyNjFkYzI2ZmQ5OTUyODQ2MzEiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDMKICB9KTsKCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2NoYWlucy9kZWZpbml0aW9ucy96b3JhU2Vwb2xpYS5qcwogIHZhciBzb3VyY2VJZDQ0ID0gMTExNTUxMTE7CiAgdmFyIHpvcmFTZXBvbGlhID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA5OTk5OTk5OTksCiAgICBuYW1lOiAiWm9yYSBTZXBvbGlhIiwKICAgIG5ldHdvcms6ICJ6b3JhLXNlcG9saWEiLAogICAgbmF0aXZlQ3VycmVuY3k6IHsKICAgICAgZGVjaW1hbHM6IDE4LAogICAgICBuYW1lOiAiWm9yYSBTZXBvbGlhIiwKICAgICAgc3ltYm9sOiAiRVRIIgogICAgfSwKICAgIHJwY1VybHM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIGh0dHA6IFsiaHR0cHM6Ly9zZXBvbGlhLnJwYy56b3JhLmVuZXJneSJdLAogICAgICAgIHdlYlNvY2tldDogWyJ3c3M6Ly9zZXBvbGlhLnJwYy56b3JhLmVuZXJneSJdCiAgICAgIH0KICAgIH0sCiAgICBibG9ja0V4cGxvcmVyczogewogICAgICBkZWZhdWx0OiB7CiAgICAgICAgbmFtZTogIlpvcmEgU2Vwb2xpYSBFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnpvcmEuZW5lcmd5LyIsCiAgICAgICAgYXBpVXJsOiAiaHR0cHM6Ly9zZXBvbGlhLmV4cGxvcmVyLnpvcmEuZW5lcmd5L2FwaSIKICAgICAgfQogICAgfSwKICAgIGNvbnRyYWN0czogewogICAgICAuLi5jaGFpbkNvbmZpZzIuY29udHJhY3RzLAogICAgICBsMk91dHB1dE9yYWNsZTogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4MjYxNUI0ODFCZDNFNUExQzBDN0NhM0RhMWJkYzY2M0U4NjE1QWRlOSIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDgzMTYwCiAgICAgIH0sCiAgICAgIHBvcnRhbDogewogICAgICAgIFtzb3VyY2VJZDQ0XTogewogICAgICAgICAgYWRkcmVzczogIjB4ZWZmRTJDNmNBOUFiNzk3RDQxOGYwRDkxZUE2MDgwNzcxM2YzNTM2ZiIKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGwxU3RhbmRhcmRCcmlkZ2U6IHsKICAgICAgICBbc291cmNlSWQ0NF06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweDUzNzZmMUQ1NDNkY2JCNUJENDE2YzU2QzE4OWU0Y0I3Mzk5ZkNjQ0IiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDQsCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9jaGFpbnMvZGVmaW5pdGlvbnMvem9yYVRlc3RuZXQuanMKICB2YXIgc291cmNlSWQ0NSA9IDU7CiAgdmFyIHpvcmFUZXN0bmV0ID0gLyogQF9fUFVSRV9fICovIGRlZmluZUNoYWluKHsKICAgIC4uLmNoYWluQ29uZmlnMiwKICAgIGlkOiA5OTksCiAgICBuYW1lOiAiWm9yYSBHb2VybGkgVGVzdG5ldCIsCiAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICBkZWNpbWFsczogMTgsCiAgICAgIG5hbWU6ICJab3JhIEdvZXJsaSIsCiAgICAgIHN5bWJvbDogIkVUSCIKICAgIH0sCiAgICBycGNVcmxzOiB7CiAgICAgIGRlZmF1bHQ6IHsKICAgICAgICBodHRwOiBbImh0dHBzOi8vdGVzdG5ldC5ycGMuem9yYS5lbmVyZ3kiXSwKICAgICAgICB3ZWJTb2NrZXQ6IFsid3NzOi8vdGVzdG5ldC5ycGMuem9yYS5lbmVyZ3kiXQogICAgICB9CiAgICB9LAogICAgYmxvY2tFeHBsb3JlcnM6IHsKICAgICAgZGVmYXVsdDogewogICAgICAgIG5hbWU6ICJFeHBsb3JlciIsCiAgICAgICAgdXJsOiAiaHR0cHM6Ly90ZXN0bmV0LmV4cGxvcmVyLnpvcmEuZW5lcmd5IiwKICAgICAgICBhcGlVcmw6ICJodHRwczovL3Rlc3RuZXQuZXhwbG9yZXIuem9yYS5lbmVyZ3kvYXBpIgogICAgICB9CiAgICB9LAogICAgY29udHJhY3RzOiB7CiAgICAgIC4uLmNoYWluQ29uZmlnMi5jb250cmFjdHMsCiAgICAgIG11bHRpY2FsbDM6IHsKICAgICAgICBhZGRyZXNzOiAiMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExIiwKICAgICAgICBibG9ja0NyZWF0ZWQ6IDE4OTEyMwogICAgICB9LAogICAgICBwb3J0YWw6IHsKICAgICAgICBbc291cmNlSWQ0NV06IHsKICAgICAgICAgIGFkZHJlc3M6ICIweERiOUY1MTc5MDM2NWU3ZGMxOTZlN0QwNzI3MjhkZjM5QmU5NThBQ2UiCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc291cmNlSWQ6IHNvdXJjZUlkNDUsCiAgICB0ZXN0bmV0OiB0cnVlCiAgfSk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy9wcml2YXRlS2V5VG9BY2NvdW50LmpzCiAgaW5pdF9zZWNwMjU2azEoKTsKICBpbml0X3RvSGV4KCk7CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy90b0FjY291bnQuanMKICBpbml0X2FkZHJlc3MoKTsKICBpbml0X2lzQWRkcmVzcygpOwogIGZ1bmN0aW9uIHRvQWNjb3VudChzb3VyY2UpIHsKICAgIGlmICh0eXBlb2Ygc291cmNlID09PSAic3RyaW5nIikgewogICAgICBpZiAoIWlzQWRkcmVzcyhzb3VyY2UsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEFkZHJlc3NFcnJvcih7IGFkZHJlc3M6IHNvdXJjZSB9KTsKICAgICAgcmV0dXJuIHsKICAgICAgICBhZGRyZXNzOiBzb3VyY2UsCiAgICAgICAgdHlwZTogImpzb24tcnBjIgogICAgICB9OwogICAgfQogICAgaWYgKCFpc0FkZHJlc3Moc291cmNlLmFkZHJlc3MsIHsgc3RyaWN0OiBmYWxzZSB9KSkKICAgICAgdGhyb3cgbmV3IEludmFsaWRBZGRyZXNzRXJyb3IoeyBhZGRyZXNzOiBzb3VyY2UuYWRkcmVzcyB9KTsKICAgIHJldHVybiB7CiAgICAgIGFkZHJlc3M6IHNvdXJjZS5hZGRyZXNzLAogICAgICBub25jZU1hbmFnZXI6IHNvdXJjZS5ub25jZU1hbmFnZXIsCiAgICAgIHNpZ246IHNvdXJjZS5zaWduLAogICAgICBleHBlcmltZW50YWxfc2lnbkF1dGhvcml6YXRpb246IHNvdXJjZS5leHBlcmltZW50YWxfc2lnbkF1dGhvcml6YXRpb24sCiAgICAgIHNpZ25NZXNzYWdlOiBzb3VyY2Uuc2lnbk1lc3NhZ2UsCiAgICAgIHNpZ25UcmFuc2FjdGlvbjogc291cmNlLnNpZ25UcmFuc2FjdGlvbiwKICAgICAgc2lnblR5cGVkRGF0YTogc291cmNlLnNpZ25UeXBlZERhdGEsCiAgICAgIHNvdXJjZTogImN1c3RvbSIsCiAgICAgIHR5cGU6ICJsb2NhbCIKICAgIH07CiAgfQoKICAvLyBub2RlX21vZHVsZXMvLmRlbm8vdmllbUAyLjIxLjM1L25vZGVfbW9kdWxlcy92aWVtL19lc20vYWNjb3VudHMvdXRpbHMvc2lnbi5qcwogIGluaXRfc2VjcDI1NmsxKCk7CiAgaW5pdF90b0hleCgpOwogIGFzeW5jIGZ1bmN0aW9uIHNpZ24oeyBoYXNoOiBoYXNoMywgcHJpdmF0ZUtleSwgdG8gPSAib2JqZWN0IiB9KSB7CiAgICBjb25zdCB7IHIsIHMsIHJlY292ZXJ5IH0gPSBzZWNwMjU2azEuc2lnbihoYXNoMy5zbGljZSgyKSwgcHJpdmF0ZUtleS5zbGljZSgyKSk7CiAgICBjb25zdCBzaWduYXR1cmUgPSB7CiAgICAgIHI6IG51bWJlclRvSGV4KHIsIHsgc2l6ZTogMzIgfSksCiAgICAgIHM6IG51bWJlclRvSGV4KHMsIHsgc2l6ZTogMzIgfSksCiAgICAgIHY6IHJlY292ZXJ5ID8gMjhuIDogMjduLAogICAgICB5UGFyaXR5OiByZWNvdmVyeQogICAgfTsKICAgIHJldHVybiAoKCkgPT4gewogICAgICBpZiAodG8gPT09ICJieXRlcyIgfHwgdG8gPT09ICJoZXgiKQogICAgICAgIHJldHVybiBzZXJpYWxpemVTaWduYXR1cmUoeyAuLi5zaWduYXR1cmUsIHRvIH0pOwogICAgICByZXR1cm4gc2lnbmF0dXJlOwogICAgfSkoKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduQXV0aG9yaXphdGlvbi5qcwogIGFzeW5jIGZ1bmN0aW9uIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbihwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IGNvbnRyYWN0QWRkcmVzcywgY2hhaW5JZCwgbm9uY2UsIHByaXZhdGVLZXksIHRvID0gIm9iamVjdCIgfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBzaWduKHsKICAgICAgaGFzaDogaGFzaEF1dGhvcml6YXRpb24oeyBjb250cmFjdEFkZHJlc3MsIGNoYWluSWQsIG5vbmNlIH0pLAogICAgICBwcml2YXRlS2V5LAogICAgICB0bwogICAgfSk7CiAgICBpZiAodG8gPT09ICJvYmplY3QiKQogICAgICByZXR1cm4gewogICAgICAgIGNvbnRyYWN0QWRkcmVzcywKICAgICAgICBjaGFpbklkLAogICAgICAgIG5vbmNlLAogICAgICAgIC4uLnNpZ25hdHVyZQogICAgICB9OwogICAgcmV0dXJuIHNpZ25hdHVyZTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduTWVzc2FnZS5qcwogIGFzeW5jIGZ1bmN0aW9uIHNpZ25NZXNzYWdlMih7IG1lc3NhZ2UsIHByaXZhdGVLZXkgfSkgewogICAgcmV0dXJuIGF3YWl0IHNpZ24oeyBoYXNoOiBoYXNoTWVzc2FnZShtZXNzYWdlKSwgcHJpdmF0ZUtleSwgdG86ICJoZXgiIH0pOwogIH0KCiAgLy8gbm9kZV9tb2R1bGVzLy5kZW5vL3ZpZW1AMi4yMS4zNS9ub2RlX21vZHVsZXMvdmllbS9fZXNtL2FjY291bnRzL3V0aWxzL3NpZ25UcmFuc2FjdGlvbi5qcwogIGluaXRfa2VjY2FrMjU2KCk7CiAgYXN5bmMgZnVuY3Rpb24gc2lnblRyYW5zYWN0aW9uMihwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCB7IHByaXZhdGVLZXksIHRyYW5zYWN0aW9uLCBzZXJpYWxpemVyID0gc2VyaWFsaXplVHJhbnNhY3Rpb24gfSA9IHBhcmFtZXRlcnM7CiAgICBjb25zdCBzaWduYWJsZVRyYW5zYWN0aW9uID0gKCgpID0+IHsKICAgICAgaWYgKHRyYW5zYWN0aW9uLnR5cGUgPT09ICJlaXA0ODQ0IikKICAgICAgICByZXR1cm4gewogICAgICAgICAgLi4udHJhbnNhY3Rpb24sCiAgICAgICAgICBzaWRlY2FyczogZmFsc2UKICAgICAgICB9OwogICAgICByZXR1cm4gdHJhbnNhY3Rpb247CiAgICB9KSgpOwogICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgc2lnbih7CiAgICAgIGhhc2g6IGtlY2NhazI1NihzZXJpYWxpemVyKHNpZ25hYmxlVHJhbnNhY3Rpb24pKSwKICAgICAgcHJpdmF0ZUtleQogICAgfSk7CiAgICByZXR1cm4gc2VyaWFsaXplcih0cmFuc2FjdGlvbiwgc2lnbmF0dXJlKTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy91dGlscy9zaWduVHlwZWREYXRhLmpzCiAgYXN5bmMgZnVuY3Rpb24gc2lnblR5cGVkRGF0YTIocGFyYW1ldGVycykgewogICAgY29uc3QgeyBwcml2YXRlS2V5LCAuLi50eXBlZERhdGEgfSA9IHBhcmFtZXRlcnM7CiAgICByZXR1cm4gYXdhaXQgc2lnbih7CiAgICAgIGhhc2g6IGhhc2hUeXBlZERhdGEodHlwZWREYXRhKSwKICAgICAgcHJpdmF0ZUtleSwKICAgICAgdG86ICJoZXgiCiAgICB9KTsKICB9CgogIC8vIG5vZGVfbW9kdWxlcy8uZGVuby92aWVtQDIuMjEuMzUvbm9kZV9tb2R1bGVzL3ZpZW0vX2VzbS9hY2NvdW50cy9wcml2YXRlS2V5VG9BY2NvdW50LmpzCiAgZnVuY3Rpb24gcHJpdmF0ZUtleVRvQWNjb3VudChwcml2YXRlS2V5LCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IHsgbm9uY2VNYW5hZ2VyOiBub25jZU1hbmFnZXIyIH0gPSBvcHRpb25zOwogICAgY29uc3QgcHVibGljS2V5ID0gdG9IZXgoc2VjcDI1NmsxLmdldFB1YmxpY0tleShwcml2YXRlS2V5LnNsaWNlKDIpLCBmYWxzZSkpOwogICAgY29uc3QgYWRkcmVzcyA9IHB1YmxpY0tleVRvQWRkcmVzcyhwdWJsaWNLZXkpOwogICAgY29uc3QgYWNjb3VudCA9IHRvQWNjb3VudCh7CiAgICAgIGFkZHJlc3MsCiAgICAgIG5vbmNlTWFuYWdlcjogbm9uY2VNYW5hZ2VyMiwKICAgICAgYXN5bmMgc2lnbih7IGhhc2g6IGhhc2gzIH0pIHsKICAgICAgICByZXR1cm4gc2lnbih7IGhhc2g6IGhhc2gzLCBwcml2YXRlS2V5LCB0bzogImhleCIgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbihhdXRob3JpemF0aW9uKSB7CiAgICAgICAgcmV0dXJuIGV4cGVyaW1lbnRhbF9zaWduQXV0aG9yaXphdGlvbih7IC4uLmF1dGhvcml6YXRpb24sIHByaXZhdGVLZXkgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25NZXNzYWdlKHsgbWVzc2FnZSB9KSB7CiAgICAgICAgcmV0dXJuIHNpZ25NZXNzYWdlMih7IG1lc3NhZ2UsIHByaXZhdGVLZXkgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0cmFuc2FjdGlvbiwgeyBzZXJpYWxpemVyIH0gPSB7fSkgewogICAgICAgIHJldHVybiBzaWduVHJhbnNhY3Rpb24yKHsgcHJpdmF0ZUtleSwgdHJhbnNhY3Rpb24sIHNlcmlhbGl6ZXIgfSk7CiAgICAgIH0sCiAgICAgIGFzeW5jIHNpZ25UeXBlZERhdGEodHlwZWREYXRhKSB7CiAgICAgICAgcmV0dXJuIHNpZ25UeXBlZERhdGEyKHsgLi4udHlwZWREYXRhLCBwcml2YXRlS2V5IH0pOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiB7CiAgICAgIC4uLmFjY291bnQsCiAgICAgIHB1YmxpY0tleSwKICAgICAgc291cmNlOiAicHJpdmF0ZUtleSIKICAgIH07CiAgfQoKICAvLyBsaWJzL3NoaW5rYWktdmllbS9zcmMvaW5kZXgudHMKICB3aW5kb3cudmllbSA9IGVzbV9leHBvcnRzOwogIHdpbmRvdy5jaGFpbnMgPSBjaGFpbnNfZXhwb3J0czsKICB2YXIgVmllbVByb3ZpZGVyID0gY2xhc3MgewogICAgY2xpZW50OwogICAgc2VsZWN0ZWRBZGRyZXNzOwogICAgY29uc3RydWN0b3IoY2hhaW4sIHNrKSB7CiAgICAgIGNvbnN0IHByaXZhdGVLZXkgPSBzayB8fCAiMHhmNGMxYzZkOTIzMWE1ZjA4YWE4ZDk4MjRhMTQyYzRmYzVhNjYzY2ExYTZlY2Q2MTEyNmU1NGEwZDc1MDFkZjgyIjsKICAgICAgY29uc3QgYWNjb3VudCA9IHByaXZhdGVLZXlUb0FjY291bnQocHJpdmF0ZUtleSk7CiAgICAgIHRoaXMuY2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHsKICAgICAgICBhY2NvdW50LAogICAgICAgIGNoYWluOiBjaGFpbiB8fCBhcmJpdHJ1bVNlcG9saWEsCiAgICAgICAgdHJhbnNwb3J0OiBodHRwKAogICAgICAgICAgImh0dHBzOi8vYXJiaXRydW0tc2Vwb2xpYS5ibG9ja3BpLm5ldHdvcmsvdjEvcnBjL3B1YmxpYyIKICAgICAgICApCiAgICAgIH0pLmV4dGVuZChwdWJsaWNBY3Rpb25zKTsKICAgICAgdGhpcy5jbGllbnQuZ2V0QWRkcmVzc2VzKCkudGhlbigoYWRkcmVzc2VzKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coImFkZHJlc3NlcyIsIGFkZHJlc3Nlcyk7CiAgICAgICAgdGhpcy5zZWxlY3RlZEFkZHJlc3MgPSBhZGRyZXNzZXNbMF07CiAgICAgIH0pOwogICAgfQogICAgYXN5bmMgZW5hYmxlKCkgewogICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0QWNjb3VudHMoKTsKICAgIH0KICAgIGFzeW5jIHJlcXVlc3QoeyBtZXRob2QsIHBhcmFtcyB9KSB7CiAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0IiwgbWV0aG9kLCBwYXJhbXMpOwogICAgICBzd2l0Y2ggKG1ldGhvZCkgewogICAgICAgIGNhc2UgImV0aF9yZXF1ZXN0QWNjb3VudHMiOgogICAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdEFjY291bnRzKCk7CiAgICAgICAgY2FzZSAiZXRoX2FjY291bnRzIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldEFjY291bnRzKCk7CiAgICAgICAgY2FzZSAiZXRoX3NlbmRUcmFuc2FjdGlvbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kVHJhbnNhY3Rpb24ocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfc2lnbiI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaWduKHBhcmFtc1swXSwgcGFyYW1zWzFdKTsKICAgICAgICBjYXNlICJwZXJzb25hbF9zaWduIjoKICAgICAgICAgIHJldHVybiB0aGlzLnBlcnNvbmFsU2lnbihwYXJhbXNbMF0sIHBhcmFtc1sxXSk7CiAgICAgICAgY2FzZSAiZXRoX3NpZ25UeXBlZERhdGEiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2lnblR5cGVkRGF0YShwYXJhbXNbMF0sIHBhcmFtc1sxXSk7CiAgICAgICAgY2FzZSAiZXRoX2NoYWluSWQiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2hhaW5JZCgpOwogICAgICAgIGNhc2UgIm5ldF92ZXJzaW9uIjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldE5ldHdvcmtJZCgpOwogICAgICAgIGNhc2UgImV0aF9ibG9ja051bWJlciI6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCbG9ja051bWJlcigpOwogICAgICAgIGNhc2UgImV0aF9nZXRUcmFuc2FjdGlvbkNvdW50IjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zYWN0aW9uQ291bnQocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfZ2V0VHJhbnNhY3Rpb25CeUhhc2giOgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VHJhbnNhY3Rpb24ocGFyYW1zWzBdKTsKICAgICAgICBjYXNlICJldGhfZ2V0VHJhbnNhY3Rpb25SZWNlaXB0IjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zYWN0aW9uUmVjZWlwdChwYXJhbXNbMF0pOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG1ldGhvZDogJHttZXRob2R9YCk7CiAgICAgIH0KICAgIH0KICAgIGFzeW5jIGdldFRyYW5zYWN0aW9uKGhhc2gzKSB7CiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VHJhbnNhY3Rpb24oeyBoYXNoOiBoYXNoMyB9KTsKICAgICAgY29uc29sZS5sb2coImdldFRyYW5zYWN0aW9uIiwgdHJhbnNhY3Rpb24pOwogICAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgICAgdHJhbnNhY3Rpb24udHlwZSA9ICIweDIiOwogICAgICB9CiAgICAgIHJldHVybiB0cmFuc2FjdGlvbjsKICAgIH0KICAgIGFzeW5jIGdldFRyYW5zYWN0aW9uUmVjZWlwdChoYXNoMykgewogICAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0VHJhbnNhY3Rpb25SZWNlaXB0KHsgaGFzaDogaGFzaDMgfSk7CiAgICAgIGNvbnNvbGUubG9nKCJnZXRUcmFuc2FjdGlvblJlY2VpcHQiLCByZWNlaXB0KTsKICAgICAgaWYgKHJlY2VpcHQudHlwZSA9PT0gImVpcDE1NTkiKSB7CiAgICAgICAgcmVjZWlwdC50eXBlID0gIjB4MiI7CiAgICAgIH0KICAgICAgaWYgKHJlY2VpcHQuc3RhdHVzID09PSAic3VjY2VzcyIpIHsKICAgICAgICByZWNlaXB0LnN0YXR1cyA9ICIweDEiOwogICAgICB9CiAgICAgIHJldHVybiByZWNlaXB0OwogICAgfQogICAgYXN5bmMgZ2V0VHJhbnNhY3Rpb25Db3VudChhZGRyZXNzKSB7CiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uQ291bnQgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXRUcmFuc2FjdGlvbkNvdW50KHsgYWRkcmVzcyB9KTsKICAgICAgY29uc29sZS5sb2coInRyYW5zYWN0aW9uQ291bnQiLCB0cmFuc2FjdGlvbkNvdW50KTsKICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uQ291bnQ7CiAgICB9CiAgICBhc3luYyBnZXRCbG9ja051bWJlcigpIHsKICAgICAgY29uc3QgYmxvY2tOdW1iZXIgPSBhd2FpdCB0aGlzLmNsaWVudC5nZXRCbG9ja051bWJlcigpOwogICAgICBjb25zb2xlLmxvZygiYmxvY2tOdW1iZXIiLCBibG9ja051bWJlcik7CiAgICAgIHJldHVybiBibG9ja051bWJlcjsKICAgIH0KICAgIGFzeW5jIHJlcXVlc3RBY2NvdW50cygpIHsKICAgICAgY29uc3QgW2FkZHJlc3NdID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0QWRkcmVzc2VzKCk7CiAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0QWNjb3VudHMiLCBhZGRyZXNzKTsKICAgICAgdGhpcy5zZWxlY3RlZEFkZHJlc3MgPSBhZGRyZXNzOwogICAgICByZXR1cm4gW2FkZHJlc3NdOwogICAgfQogICAgYXN5bmMgZ2V0QWNjb3VudHMoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkQWRkcmVzcyA/IFt0aGlzLnNlbGVjdGVkQWRkcmVzc10gOiBbXTsKICAgIH0KICAgIGFzeW5jIHNlbmRUcmFuc2FjdGlvbih0eCkgewogICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRBZGRyZXNzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyBhY2NvdW50cyBhdmFpbGFibGUiKTsKICAgICAgfQogICAgICBpZiAoIXR4LnRvIHx8ICF0eC52YWx1ZSB8fCAhdHguZ2FzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIHJlcXVpcmVkIHRyYW5zYWN0aW9uIHBhcmFtZXRlcnMiKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygic2VuZFRyYW5zYWN0aW9uIHR4OiAiLCB0eCk7CiAgICAgIGNvbnNvbGUubG9nKCJUcmFuc2FjdGlvbiBnYXNQcmljZTogIiwgdHguZ2FzUHJpY2UpOwogICAgICBjb25zb2xlLmxvZygiVHJhbnNhY3Rpb24gZ2FzOiAiLCB0eC5nYXMpOwogICAgICBjb25zdCB2YWx1ZSA9IEJpZ0ludCh0eC52YWx1ZSk7CiAgICAgIGNvbnN0IHZhbHVlSW5FdGggPSBOdW1iZXIodmFsdWUpIC8gMTAgKiogMTg7CiAgICAgIGNvbnNvbGUubG9nKGBUcmFuc2FjdGlvbiB2YWx1ZSBpbiBFVEg6ICR7dmFsdWVJbkV0aH1gKTsKICAgICAgY29uc3QgdHJhbnNhY3Rpb25Db250ZW50ID0gewogICAgICAgIHRvOiB0eC50bywKICAgICAgICB2YWx1ZSwKICAgICAgICBkYXRhOiB0eC5kYXRhLAogICAgICAgIGNoYWluOiB0aGlzLmNsaWVudC5jaGFpbgogICAgICB9OwogICAgICBjb25zb2xlLmxvZygic2VuZFRyYW5zYWN0aW9uIiwgdHJhbnNhY3Rpb25Db250ZW50KTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgdGhpcy5jbGllbnQucHJlcGFyZVRyYW5zYWN0aW9uUmVxdWVzdCh0cmFuc2FjdGlvbkNvbnRlbnQpOwogICAgICAgIGNvbnNvbGUubG9nKCJQcmVwYXJlZCB0cmFuc2FjdGlvbiByZXF1ZXN0OiIsIHJlcXVlc3QpOwogICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbiA9IGF3YWl0IHRoaXMuY2xpZW50LnNpZ25UcmFuc2FjdGlvbihyZXF1ZXN0KTsKICAgICAgICBjb25zb2xlLmxvZygiU2VyaWFsaXplZCB0cmFuc2FjdGlvbjoiLCBzZXJpYWxpemVkVHJhbnNhY3Rpb24pOwogICAgICAgIGNvbnN0IGhhc2gzID0gYXdhaXQgdGhpcy5jbGllbnQuc2VuZFJhd1RyYW5zYWN0aW9uKHsKICAgICAgICAgIHNlcmlhbGl6ZWRUcmFuc2FjdGlvbgogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCJzZW5kVHJhbnNhY3Rpb24gaGFzaCIsIGhhc2gzKTsKICAgICAgICByZXR1cm4gaGFzaDM7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigic2VuZFRyYW5zYWN0aW9uIGVycm9yIiwgZXJyb3IpOwogICAgICAgIHRocm93IGVycm9yOwogICAgICB9CiAgICB9CiAgICBhc3luYyBzaWduKGFkZHJlc3MsIG1lc3NhZ2UpIHsKICAgICAgaWYgKGFkZHJlc3MgIT09IHRoaXMuc2VsZWN0ZWRBZGRyZXNzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBZGRyZXNzIG1pc21hdGNoIik7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY2xpZW50LnNpZ25NZXNzYWdlKHsgYWNjb3VudDogYWRkcmVzcywgbWVzc2FnZSB9KTsKICAgIH0KICAgIGFzeW5jIHBlcnNvbmFsU2lnbihtZXNzYWdlLCBhZGRyZXNzKSB7CiAgICAgIGlmIChhZGRyZXNzICE9PSB0aGlzLnNlbGVjdGVkQWRkcmVzcykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQWRkcmVzcyBtaXNtYXRjaCIpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmNsaWVudC5zaWduTWVzc2FnZSh7IGFjY291bnQ6IGFkZHJlc3MsIG1lc3NhZ2UgfSk7CiAgICB9CiAgICBhc3luYyBzaWduVHlwZWREYXRhKGFkZHJlc3MsIHR5cGVkRGF0YSkgewogICAgICBpZiAoYWRkcmVzcyAhPT0gdGhpcy5zZWxlY3RlZEFkZHJlc3MpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkFkZHJlc3MgbWlzbWF0Y2giKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jbGllbnQuc2lnblR5cGVkRGF0YSh7CiAgICAgICAgYWNjb3VudDogYWRkcmVzcywKICAgICAgICBkb21haW46IHR5cGVkRGF0YS5kb21haW4sCiAgICAgICAgdHlwZXM6IHR5cGVkRGF0YS50eXBlcywKICAgICAgICBtZXNzYWdlOiB0eXBlZERhdGEubWVzc2FnZSwKICAgICAgICBwcmltYXJ5VHlwZTogdHlwZWREYXRhLnByaW1hcnlUeXBlCiAgICAgIH0pOwogICAgfQogICAgYXN5bmMgZ2V0Q2hhaW5JZCgpIHsKICAgICAgY29uc3QgY2hhaW5JZCA9IGF3YWl0IHRoaXMuY2xpZW50LmdldENoYWluSWQoKTsKICAgICAgY29uc29sZS5sb2coImdldENoYWluSWQiLCBjaGFpbklkKTsKICAgICAgcmV0dXJuIGNoYWluSWQ7CiAgICB9CiAgICBhc3luYyBnZXROZXR3b3JrSWQoKSB7CiAgICAgIGNvbnN0IGNoYWluSWQgPSBhd2FpdCB0aGlzLmdldENoYWluSWQoKTsKICAgICAgcmV0dXJuIGNoYWluSWQudG9TdHJpbmcoKTsKICAgIH0KICB9OwogIGZ1bmN0aW9uIGFkZEVpcDY5NjNMaXN0ZW5lcihpbmZvLCBwcm92aWRlcikgewogICAgY29uc3QgYW5ub3VuY2VFdmVudCA9IG5ldyBDdXN0b21FdmVudCgKICAgICAgImVpcDY5NjM6YW5ub3VuY2VQcm92aWRlciIsCiAgICAgIHsKICAgICAgICBkZXRhaWw6IE9iamVjdC5mcmVlemUoeyBpbmZvLCBwcm92aWRlciB9KQogICAgICB9CiAgICApOwogICAgd2luZG93LmRpc3BhdGNoRXZlbnQoYW5ub3VuY2VFdmVudCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiZWlwNjk2MzpyZXF1ZXN0UHJvdmlkZXIiLCAoKSA9PiB7CiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGFubm91bmNlRXZlbnQpOwogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGluaXRpYWxpemVWaWVtUHJvdmlkZXIoY2hhaW4sIHByb3ZpZGVySW5mbykgewogICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgVmllbVByb3ZpZGVyKGNoYWluLCBudWxsKTsKICAgIHdpbmRvdy5ldGhlcmV1bSA9IHsKICAgICAgcmVxdWVzdDogcHJvdmlkZXIucmVxdWVzdC5iaW5kKHByb3ZpZGVyKSwKICAgICAgZW5hYmxlOiBwcm92aWRlci5lbmFibGUuYmluZChwcm92aWRlciksCiAgICAgIG9uOiAoZXZlbnROYW1lLCBjYWxsYmFjaykgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGBFdmVudCBsaXN0ZW5lciBmb3IgJHtldmVudE5hbWV9IGFkZGVkLmApOwogICAgICB9LAogICAgICByZW1vdmVMaXN0ZW5lcjogKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhgRXZlbnQgbGlzdGVuZXIgZm9yICR7ZXZlbnROYW1lfSByZW1vdmVkLmApOwogICAgICB9LAogICAgICBpc0Nvbm5lY3RlZDogKCkgPT4gewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBzZW5kOiAobWV0aG9kLCBwYXJhbXMpID0+IHsKICAgICAgICBjb25zb2xlLndhcm4oInNlbmQgaXMgZGVwcmVjYXRlZC4gVXNlIHJlcXVlc3QgaW5zdGVhZC4iKTsKICAgICAgICByZXR1cm4gcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZCwgcGFyYW1zIH0pOwogICAgICB9LAogICAgICBzZW5kQXN5bmM6IChwYXlsb2FkLCBjYWxsYmFjaykgPT4gewogICAgICAgIGNvbnNvbGUud2Fybigic2VuZEFzeW5jIGlzIGRlcHJlY2F0ZWQuIFVzZSByZXF1ZXN0IGluc3RlYWQuIik7CiAgICAgICAgcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZDogcGF5bG9hZC5tZXRob2QsIHBhcmFtczogcGF5bG9hZC5wYXJhbXMgfSkudGhlbigocmVzdWx0KSA9PiBjYWxsYmFjayhudWxsLCB7IHJlc3VsdCB9KSkuY2F0Y2goKGVycm9yKSA9PiBjYWxsYmFjayhlcnJvciwgbnVsbCkpOwogICAgICB9LAogICAgICBpc01ldGFNYXNrOiB0cnVlLAogICAgICAvLyBTZXQgdG8gdHJ1ZSBpZiBtaW1pY2tpbmcgTWV0YU1hc2sKICAgICAgc2VsZWN0ZWRBZGRyZXNzOiBwcm92aWRlci5zZWxlY3RlZEFkZHJlc3MsCiAgICAgIGNoYWluSWQ6IGNoYWluPy5pZCB8fCAiMHgxIgogICAgICAvLyBEZWZhdWx0IHRvIG1haW5uZXQgaWYgY2hhaW4gaXMgbm90IHByb3ZpZGVkCiAgICB9OwogICAgYWRkRWlwNjk2M0xpc3RlbmVyKHByb3ZpZGVySW5mbywgcHJvdmlkZXIpOwogICAgY29uc29sZS5sb2coIlZpZW0gcHJvdmlkZXIgaW5pdGlhbGl6ZWQiKTsKICB9CiAgdmFyIHZpZW1Qcm92aWRlckluZm8gPSB7CiAgICB1dWlkOiAiZDY5YmM0YzQtZTQzYS00ZDBhLTgzZDctYjZlN2I3NTA0YmViIiwKICAgIG5hbWU6ICJTaGlua2FpIFZpZW0gUHJvdmlkZXIiLAogICAgaWNvbjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU16WTNJaUJvWldsbmFIUTlJak0yTnlJZ2RtbGxkMEp2ZUQwaU1DQXdJRE0yTnlBek5qY2lJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4amFYSmpiR1VnWTNnOUlqRTRNeTQxSWlCamVUMGlNVGd6TGpVaUlISTlJakU0TXk0MUlpQm1hV3hzUFNJalJrVTJNVFl5SWk4K0NqeHdZWFJvSUdROUlrMHlOekl1TWprMUlESTNOQzQyTmpoRE1qY3dMamMxT0NBeU5qZ3VPVGMxSURJMk5pNDJNVGtnTWpZMkxqSXhOU0F5TmpBdU9EUTBJREkyTmk0M056bERNalE1TGpZMk5DQXlOamN1T0RZeklESTBOUzQ1TlRJZ01qWTBMakkzT1NBeU5EQXVOalEySURJMU5pNDBNRFJETWpVMExqWXlPQ0F5TlRrdU16WTNJREkyTXk0Mk5EWWdNalUxTGpjeU5TQXlOall1TkRZeklESTFOQzR4TURkRE1qY3dMakE1SURJMU1pNHdNVElnTWpjekxqYzJJREkwT1M0ek1qUWdNamN5TGpNd09TQXlORFF1TlRnMVF6STNNQzQ0T0RZZ01qTTVMamswTnlBeU5qWXVOakU1SURJek9TNHdNaklnTWpZeUxqSXpPQ0F5TXprdU9EWkRNalUyTGpBeU1pQXlOREV1TURRMUlESTFNQzR3TmpJZ01qUXhMamN6T0NBeU5EVXVNakkySURJek5TNDJPRFJETWpRMkxqSTFJREl6TkM0M05Ua2dNalEzTGpJM05DQXlNek11T0RBMklESTBPQzR6TWpjZ01qTXlMamc1TlVNeU5UQXVPVEF5SURJek1DNDJPRFVnTWpVeUxqZzVNeUF5TWpndU1EZzBJREkxTVM0MU9EUWdNakkwTGpVM00wTXlOVEF1TXpNeklESXlNUzR5TWlBeU5EY3VNVFl4SURJeE9TNHlPVGtnTWpRekxqa3pNaUF5TVRrdU9Ea3hRekkwTVM0eklESXlNQzR6T0RJZ01qTTJMakF5TXlBeU1qSXVNRE1nTWpNMExqUXhOaUF5TVRrdU16UXlUREl6TkM0ME9EY2dNakU1TGpNeE0wTXlNek11T0RjMUlESXhPUzR4TmprZ01qTXlMamt6TnlBeU1UWXVOalUwSURJek1pNDNNemNnTWpFMExqZ3hPVU15TXpFdU56azVJREl3TlM0NE5EWWdNak0xTGpZNE1pQXhPVGN1TWpNMUlESTBNQzQ1TVRZZ01Ua3dMakE0TWtNeU5EY3VORFExSURFNE1TNHhPVFlnTWpVeExqa3lOaUF4TnpFdU16azVJREkxTXk0NU1UY2dNVFl3TGpVek0wTXlOVGN1TURNeUlERTBNeTQwT0RNZ01qVXpMamN6TWlBeE1qY3VOakU0SURJME5DNDFNVFVnTVRFekxqQXpPVU15TXpNdU5UYzNJRGsxTGpjeU9ETWdNakU0TGpFMU9DQTROQzR6TWpjNElERTVOeTQ0TmlBNE1DNHhNemMxUXpFNU15NHdPVFVnTnprdU1UVTFJREU0T0M0ME5EUWdOemd1TmpNME9DQXhPRE11T1RNMUlEYzRMalUwT0RGRE1UYzVMalF4TVNBM09DNDJNelE0SURFM05DNDNOelFnTnprdU1UVTFJREUzTUM0d01Ea2dPREF1TVRNM05VTXhORGt1TnpJMklEZzBMak15TnpnZ01UTTBMakk1TXlBNU5TNDNNamd6SURFeU15NHpOVFFnTVRFekxqQXpPVU14TVRRdU1UVXhJREV5Tnk0Mk1UZ2dNVEV3TGpnMU1TQXhORE11TkRneklERXhNeTQ1TlRJZ01UWXdMalV6TTBNeE1UVXVPVEk1SURFM01TNDBNVFFnTVRJd0xqUXlOQ0F4T0RFdU1UazJJREV5Tmk0NU5UTWdNVGt3TGpBNE1rTXhNekl1TWpBeUlERTVOeTR5TXpVZ01UTTJMakE0TlNBeU1EVXVPRE15SURFek5TNHhNeklnTWpFMExqZ3hPVU14TXpRdU9UTXpJREl4Tmk0Mk5UUWdNVE16TGprNU5DQXlNVGt1TVRZNUlERXpNeTR6T0RJZ01qRTVMak14TTB3eE16TXVORFV6SURJeE9TNHpOREpETVRNeExqZzBOaUF5TWpJdU1ERTFJREV5Tmk0MU9ETWdNakl3TGpNNE1pQXhNak11T1RNNElESXhPUzQ0T1RGRE1USXdMamN5TXlBeU1Ua3VNams1SURFeE55NDFNemNnTWpJeExqSXlJREV4Tmk0eU9EVWdNakkwTGpVM00wTXhNVFF1T1RjMklESXlPQzR3T0RRZ01URTJMamsxTkNBeU16QXVOamcxSURFeE9TNDFORElnTWpNeUxqZzVOVU14TWpBdU5UazFJREl6TXk0NE1EWWdNVEl4TGpZeE9TQXlNelF1TnpVNUlERXlNaTQyTkRNZ01qTTFMalk0TkVNeE1UY3VPREEzSURJME1TNDNNemdnTVRFeExqZ3pNeUF5TkRFdU1EUTFJREV3TlM0Mk16RWdNak01TGpnMlF6RXdNUzR5TlNBeU16a3VNREl5SURrMkxqazRNamtnTWpNNUxqazBOeUE1TlM0MU5qQTFJREkwTkM0MU9EVkRPVFF1TVRBNU55QXlORGt1TXpJMElEazNMamMzT1RVZ01qVXlMakF4TWlBeE1ERXVOREEzSURJMU5DNHhNRGRETVRBMExqSXdPU0F5TlRVdU56STFJREV4TXk0eU5ERWdNalU1TGpNMU1pQXhNamN1TWpJeklESTFOaTQwTURSRE1USXhMamt4T0NBeU5qUXVNamM1SURFeE9DNHlNRFVnTWpZM0xqZzJNeUF4TURjdU1ESTFJREkyTmk0M056bERNVEF4TGpJMUlESTJOaTR5TVRVZ09UY3VNRGsyTnlBeU5qZ3VPVGMxSURrMUxqVTNORGNnTWpjMExqWTJPRU01TkM0d09ERXlJREk0TUM0eU16RWdPVGN1TURJMU5pQXlPRFF1TWpFNUlERXdNUzQyT1RFZ01qZzJMamczT0VNeE1EUXVOelE1SURJNE9DNDJNVElnTVRBNExqRTJNeUF5T0RrdU1qa3hJREV4TVM0M056WWdNamc1TGpNME9VTXhNekV1TlRZeUlESTRPUzQyTWpNZ01UUTNMamc1TVNBeU9ERXVORFU1SURFMk1pNDFPVGtnTWpZNUxqRTNPRU14TnpBdU5qa3lJREkyTWk0ME1UVWdNVGMzTGpNME9TQXlOVGd1T1RreElERTRNeTQ1TkRrZ01qVTRMamt3TkVNeE9UQXVOVFE1SURJMU9DNDVPVEVnTVRrM0xqRTVNU0F5TmpJdU5ERTFJREl3TlM0eU9Ua2dNalk1TGpFM09FTXlNakF1TURBM0lESTRNUzQwTlRrZ01qTTJMak16TmlBeU9Ea3VOakl6SURJMU5pNHhNaklnTWpnNUxqTTBPVU15TlRrdU56TTFJREk0T1M0ek1EVWdNall6TGpFME9DQXlPRGd1TmpFeUlESTJOaTR5TURjZ01qZzJMamczT0VNeU56QXVPRGcySURJNE5DNHlNVGtnTWpjekxqZ3hOeUF5T0RBdU1qTXhJREkzTWk0ek1qTWdNamMwTGpZMk9FZ3lOekl1TWprMVdrMHhOVFl1TmpJMElESXdOeTR5TmpKRE1UVXdMalV3T0NBeU1EY3VNalE0SURFME5TNDBOVGtnTWpBeUxqRXpNeUF4TkRVdU5EUTBJREU1TlM0NU5qTkRNVFExTGpRME5DQXhPRGt1TmpjNElERTFNQzQxTlRFZ01UZzBMalV6TkNBeE5UWXVPRFV5SURFNE5DNDBOelpETVRZeUxqZzBJREU0TkM0ME1UZ2dNVFk0TGpFM05DQXhPVEF1TURrM0lERTJPQzR4TVRjZ01UazJMalEyT1VNeE5qZ3VNRFl4SURJd01pNDNPRE1nTVRZekxqSTFNeUF5TURjdU1qa3hJREUxTmk0Mk1qUWdNakEzTGpJMk1scE5NakV4TGpJek1TQXlNRGN1TWpZeVF6SXdOQzQxT0RnZ01qQTNMakk1TVNBeE9Ua3VOemsxSURJd01pNDNOamtnTVRrNUxqY3pPQ0F4T1RZdU5EWTVRekU1T1M0Mk9ERWdNVGt3TGpBNU55QXlNRFV1TURJNUlERTROQzQwTVRnZ01qRXhMakF3TXlBeE9EUXVORGMyUXpJeE55NHpNRFFnTVRnMExqVTBPQ0F5TWpJdU5ERXhJREU0T1M0Mk9USWdNakl5TGpReE1TQXhPVFV1T1RZelF6SXlNaTQwTVRFZ01qQXlMakV6TXlBeU1UY3VNelEzSURJd055NHlORGdnTWpFeExqSXpNU0F5TURjdU1qWXlXaUlnWm1sc2JEMGlkMmhwZEdVaUx6NEtQQzl6ZG1jK0NnPT0iLAogICAgLy8gQmFzZTY0IGVuY29kZWQgaWNvbgogICAgcmRuczogImNvbS5zaGlua2FpLmRlc2t0b3AiCiAgfTsKICBpbml0aWFsaXplVmllbVByb3ZpZGVyKGFyYml0cnVtU2Vwb2xpYSwgdmllbVByb3ZpZGVySW5mbyk7Cn0pKCk7Ci8qISBCdW5kbGVkIGxpY2Vuc2UgaW5mb3JtYXRpb246CgpAbm9ibGUvaGFzaGVzL2VzbS91dGlscy5qczoKICAoKiEgbm9ibGUtaGFzaGVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC91dGlscy5qczoKICAoKiEgbm9ibGUtY3VydmVzIC0gTUlUIExpY2Vuc2UgKGMpIDIwMjIgUGF1bCBNaWxsZXIgKHBhdWxtaWxsci5jb20pICopCgpAbm9ibGUvY3VydmVzL2VzbS9hYnN0cmFjdC9tb2R1bGFyLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L2N1cnZlLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL2Fic3RyYWN0L3dlaWVyc3RyYXNzLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKCkBub2JsZS9jdXJ2ZXMvZXNtL19zaG9ydHdfdXRpbHMuanM6CiAgKCohIG5vYmxlLWN1cnZlcyAtIE1JVCBMaWNlbnNlIChjKSAyMDIyIFBhdWwgTWlsbGVyIChwYXVsbWlsbHIuY29tKSAqKQoKQG5vYmxlL2N1cnZlcy9lc20vc2VjcDI1NmsxLmpzOgogICgqISBub2JsZS1jdXJ2ZXMgLSBNSVQgTGljZW5zZSAoYykgMjAyMiBQYXVsIE1pbGxlciAocGF1bG1pbGxyLmNvbSkgKikKKi8K');
