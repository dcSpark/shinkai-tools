{"type":"Python","content":[{"version":"1.0.0","name":"arxiv-download","homepage":null,"author":"@@official.shinkai","py_code":"# /// script\n# dependencies = [\n#   \"requests\",\n#   \"arxiv>=1.4.7\",\n#   \"pymupdf4llm\",\n#   \"pathlib\"\n# ]\n# ///\n\nimport arxiv\nimport requests\nimport json\nimport pymupdf4llm\nfrom pathlib import Path\nfrom typing import Dict, Any\n\nclass CONFIG:\n    storage_folder: str = \"arxiv_papers\"\n\nclass INPUTS:\n    paper_id: str  # e.g. \"2101.00001\"\n    convert_to_md: bool = True\n\nclass OUTPUT:\n    status: str\n    message: str\n    md_file: str\n\nasync def run(c: CONFIG, p: INPUTS) -> OUTPUT:\n    \"\"\"\n    Download a paper from arXiv by ID, store as PDF in the storage folder, optionally convert to .md\n    \"\"\"\n    folder = Path(c.storage_folder)\n    folder.mkdir(parents=True, exist_ok=True)\n\n    # if we already have .md for that paper, skip\n    md_path = folder / f\"{p.paper_id}.md\"\n    if md_path.exists():\n        out = OUTPUT()\n        out.status = \"exists\"\n        out.message = f\"Paper {p.paper_id} already downloaded/converted.\"\n        out.md_file = str(md_path)\n        return out\n\n    # otherwise, we do the download\n    search = arxiv.Search(id_list=[p.paper_id])\n    client = arxiv.Client()\n    try:\n        paper = next(client.results(search))\n    except StopIteration:\n        out = OUTPUT()\n        out.status = \"error\"\n        out.message = f\"Paper not found: {p.paper_id}\"\n        out.md_file = \"\"\n        return out\n\n    # Download PDF\n    pdf_path = folder / f\"{p.paper_id}.pdf\"\n    if not pdf_path.exists():\n        paper.download_pdf(dirpath=str(folder), filename=pdf_path.name)\n\n    # Optionally convert\n    if p.convert_to_md:\n        # Convert using pymupdf4llm\n        try:\n            markdown_text = pymupdf4llm.to_markdown(str(pdf_path), show_progress=False)\n            md_path.write_text(markdown_text, encoding='utf-8')\n            # remove pdf if you want\n            # pdf_path.unlink()\n        except Exception as e:\n            out = OUTPUT()\n            out.status = \"error\"\n            out.message = f\"Conversion failed: {str(e)}\"\n            out.md_file = \"\"\n            return out\n\n    out = OUTPUT()\n    out.status = \"success\"\n    out.message = f\"Paper {p.paper_id} downloaded successfully.\"\n    out.md_file = str(md_path) if p.convert_to_md else \"\"\n    return out ","tools":[],"config":[{"BasicConfig":{"key_name":"storage_folder","description":"Where to store PDFs/MD outputs","required":false,"type":null,"key_value":null}}],"description":"Download an arXiv paper PDF and optionally convert it to Markdown","keywords":["arxiv","pdf","download","markdown","research","paper"],"input_args":{"type":"object","properties":{"convert_to_md":{"type":"boolean","description":"Whether to convert the downloaded PDF to .md"},"paper_id":{"type":"string","description":"ArXiv paper ID to download"}},"required":["paper_id"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.06772009,0.33074895,-0.12433264,-0.055927545,0.09624629,-0.12388899,-0.71083736,-0.3618617,0.10271849,-0.8440084,0.5556332,0.55765307,0.3625208,0.35818374,0.42076993,-0.68175757,-0.115849614,-0.74241465,-0.6022908,0.18148008,-0.049271327,1.1281248,0.14197966,0.14113511,0.48362833,-0.19575952,0.23364326,-0.437007,-1.2430946,-2.2457132,0.3783815,0.16859254,-0.5481903,-0.090724036,0.30787995,-0.86067104,-0.11666481,0.22927448,0.12952995,-0.16315632,0.14190437,-0.1897714,0.42679283,-0.2632755,0.9500502,-0.25022757,0.0298271,0.039278306,0.6473044,0.070573956,-0.5418029,-0.12828816,0.09704277,-0.22622198,-0.3254506,0.019293204,0.4580627,0.033716645,0.04554349,0.33572453,0.28695026,0.59874475,-4.281266,0.43372402,0.5776784,0.59592384,0.3208925,-0.06429759,-0.12958783,-0.15205355,0.24863602,-0.104167335,-0.27816,0.0016052015,-0.50114995,-0.54733145,-0.18057136,0.29124182,-0.19310378,-0.23886481,-0.437409,0.27079862,0.42258355,0.22533771,-0.57201606,0.50246143,-0.3832505,-0.5628334,0.7944239,-0.035965882,-0.046965446,-0.28912395,-0.21649215,0.3692323,-0.26799268,0.35802346,0.17145126,0.06583945,-0.41364226,3.3612483,0.41108125,-0.13293199,1.170197,-0.56670916,-0.40315762,-0.54664934,-0.30528918,-0.26310351,-0.15721942,0.2900381,0.5113967,-0.9446422,-0.4114693,-0.108598545,-0.21903737,-0.091914244,-0.41363305,-0.14384334,0.05311441,0.25706697,-1.1712787,0.5694138,-0.44011515,-0.43747523,0.3661413,0.08051382,-0.25502595,0.3159434,0.42088762,-0.16219096,-0.16146418,-0.18206616,-0.25271896,0.19235066,0.065700546,0.04299907,0.95749205,-0.36959967,0.17073585,-0.1140331,0.13210365,-0.8657535,0.7602873,0.2573825,0.6513539,0.14940584,-0.19946343,0.68404925,-0.53199345,-0.10830405,-0.067399174,0.007347025,-0.099279076,-0.27195817,0.9186075,-0.14061287,-0.119402714,0.066054106,-0.017029323,0.47632283,0.11573829,-0.6110352,0.30140185,0.9487582,0.0013287663,0.018905332,0.16431758,-0.07871211,0.77877986,0.313329,0.36769348,-0.35382083,0.36676982,-0.14401965,0.303029,0.444213,-0.08598235,-0.6011994,0.17401975,-0.633597,0.53721094,0.3046455,-0.04384352,-0.30939847,0.22511028,0.47177783,0.32312715,-0.020245794,0.63887334,0.5815079,-0.4591998,1.8242875,-1.6826007,-0.63111514,-0.46525353,0.049148753,0.24241935,0.27208704,0.5969246,-0.5733497,-0.67277235,-0.12470095,0.54242986,0.44272786,0.2653585,-0.5881211,0.43370715,0.17412254,-0.092196986,-0.38453522,-0.13758329,-0.3040964,0.9313191,0.7411672,0.08223746,0.0749369,-0.11820951,0.08241235,0.20786884,0.30508548,0.007237643,0.1384644,-0.52654344,-0.50662273,-0.483865,0.15936537,0.10304559,0.003170129,-0.20125444,-0.24802543,0.296281,0.16812082,0.6309372,1.0705671,0.3381907,-0.2609965,-0.43840575,0.26710033,0.011027411,-0.71286404,0.6916328,-0.04688865,-0.105023734,-0.5047826,-0.07493542,-0.84578335,-0.13567328,0.47130805,-0.1308145,1.6273332,0.39326164,-0.5048349,0.7160495,0.06862165,-0.109315954,0.27021915,-1.8295172,-0.04794021,-0.024705894,0.4504594,-0.07260375,0.44587356,0.36690506,0.3875241,-0.1434882,-0.41276056,-0.76968247,-0.33724308,0.0024902895,-0.15620635,-0.11287923,0.48406887,0.40559518,0.24793443,-0.02829522,0.46180364,0.981828,-0.30582544,-0.46393213,-0.7084347,-0.1316689,0.052845255,0.24334338,0.037883535,-0.49104986,0.07941584,0.35554042,0.007393047,0.056695815,-0.32162595,-0.09060878,0.042034656,0.13000086,0.18264228,1.926402,0.04121549,0.03346231,0.19649933,-0.7543767,0.6176141,-0.011706315,-0.10913884,-0.20472036,-0.054269843,-1.0272176,0.11338819,0.30252743,-0.5999712,0.074522674,0.408844,-0.29486153,-0.5803827,-0.035178546,-0.17542776,0.47810194,-0.6029544,-0.24997126,0.29132655,-0.35446957,-1.5702441,-0.6800717,0.015752247,0.50049007,-0.46064997,-0.59031856,0.865307,0.28391632,0.21349448,-0.23197974,1.715747,0.4794465,0.1617654,-0.51702493,-0.050501943,0.7516259,-0.24805821,0.77039766,-0.44998118,-0.8785668,0.012401135,0.581763,1.636462,-0.14743578,-0.33823237,-0.22904876,-0.028672434,-1.53263,-0.871168,0.074743755,-0.06351489,-0.15739936,0.40022105,-0.42450187,-0.11895325,1.098501,1.005978,-0.23876546,0.104689986,-0.17724875,2.3204203,-0.43574765,-0.31134295,0.09102308,-0.0021279864,-0.2569486,0.17781231,-0.3419927,-0.8080248,-0.24101713,-0.017459534,0.25798306,-0.5684905,0.7051594,0.20335832,0.25227988,0.07262878,-0.27239957,0.8793398,0.77965456,0.06566863,0.26809794,-0.5473861,-0.65845394,-0.06537734],"result":{"type":"object","properties":{"md_file":{"type":"string"},"message":{"type":"string"},"status":{"type":"string"}},"required":["status","message"]},"sql_tables":null,"sql_queries":null,"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}