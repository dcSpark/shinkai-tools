{"type":"Python","content":[{"version":"1.0.0","name":"macos-iterm","homepage":null,"author":"@@official.shinkai","mcp_enabled":null,"py_code":"# /// script\n# dependencies = [\n#   \"requests\",\n# ]\n# ///\n\nfrom typing import Dict, Any, Optional, List\nimport subprocess\n\nclass CONFIG:\n    pass\n\nclass INPUTS:\n    command: str\n    cmd: Optional[str] = None  # for runCommand\n    new_window: Optional[bool] = False  # for runCommand\n\nclass OUTPUT:\n    result: str\n\nasync def run_applescript(script: str) -> str:\n    \"\"\"Helper function to run AppleScript and return its output.\"\"\"\n    try:\n        result = subprocess.run(['osascript', '-e', script], \n                              capture_output=True, \n                              text=True, \n                              check=True)\n        return result.stdout.strip()\n    except subprocess.CalledProcessError as e:\n        return f\"Error: {e.stderr.strip()}\"\n\nasync def ensure_iterm_window() -> str:\n    \"\"\"Ensures iTerm is running and has at least one window open.\"\"\"\n    script = \"\"\"\n        tell application \"iTerm2\"\n            activate\n            if windows count = 0 then\n                create window with default profile\n            end if\n            return \"Window ready\"\n        end tell\n    \"\"\"\n    return await run_applescript(script)\n\nasync def run(config: CONFIG, inputs: INPUTS) -> OUTPUT:\n    output = OUTPUT()\n    \n    # First ensure iTerm is running with a window\n    await ensure_iterm_window()\n    \n    script = \"\"\n\n    if inputs.command == \"pasteClipboard\":\n        script = \"\"\"\n            tell application \"iTerm2\"\n                tell current window\n                    tell current session\n                        write contents of the clipboard\n                    end tell\n                end tell\n            end tell\n            return \"Pasted clipboard to iTerm\"\n        \"\"\"\n\n    elif inputs.command == \"runCommand\":\n        if not inputs.cmd:\n            raise ValueError('Missing \"cmd\" for runCommand')\n            \n        # Escape double quotes in the command\n        escaped_cmd = inputs.cmd.replace('\"', '\\\\\"')\n        \n        if inputs.new_window:\n            script = f'''\n                tell application \"iTerm2\"\n                    create window with default profile\n                    tell current window\n                        tell current session\n                            write text \"{escaped_cmd}\"\n                        end tell\n                    end tell\n                    return \"Ran '{escaped_cmd}' in new iTerm window\"\n                end tell\n            '''\n        else:\n            script = f'''\n                tell application \"iTerm2\"\n                    tell current window\n                        tell current session\n                            write text \"{escaped_cmd}\"\n                        end tell\n                    end tell\n                    return \"Ran '{escaped_cmd}' in existing iTerm window\"\n                end tell\n            '''\n\n    else:\n        raise ValueError(f\"Unknown command: {inputs.command}\")\n\n    output.result = await run_applescript(script)\n    return output ","tools":[],"config":[],"description":"Control iTerm via AppleScript","keywords":["macos","iterm","terminal","automation","applescript"],"input_args":{"type":"object","properties":{"cmd":{"type":"string","description":"Command to run if using runCommand"},"command":{"type":"string","description":"Command to execute: pasteClipboard to paste clipboard content, runCommand to execute shell command"},"new_window":{"type":"boolean","description":"Whether to run command in a new window (default false)"}},"required":["command"]},"output_arg":{"json":""},"activated":false,"embedding":[-0.61744976,-0.102796406,0.010231398,-0.318429,-0.08139155,0.19493628,-0.092507586,0.047156796,0.29312512,0.30447704,-0.012543908,0.037213504,-0.40107828,0.26431847,0.0012193248,-0.7081255,-0.31369594,-0.6681645,-0.70857084,-0.385602,0.25702366,0.28643352,-0.19607115,-0.04036028,0.11437222,0.38433668,-0.19042291,0.22293235,-1.379738,-2.1068754,-0.25824836,0.39922914,-0.035334177,0.138653,-0.19048658,-1.1225842,-0.38088304,-0.13454907,-0.686425,-0.6474817,0.45752817,0.35642222,-0.051889807,-0.26052597,0.68731624,-0.098735906,0.8206928,-0.5063034,0.60096186,0.568452,-0.5475082,-0.52433485,0.1700073,-0.01902258,-0.585479,0.31533298,0.079414755,-0.05535584,-0.09172244,-0.16867438,-0.033261895,0.35683587,-4.1161847,-0.14906603,1.1199782,-0.035495803,0.15406713,0.23657918,-0.118504174,0.07291354,0.40648466,0.30896693,-0.06999904,0.47199327,0.41449004,-0.9803793,-0.30691922,0.47898316,0.58517826,-0.56922674,-0.0625589,0.7127119,-0.17015938,-0.03176004,-0.92461157,0.5124266,-0.6095985,-0.45382228,-0.045256346,0.08163203,0.088314086,-0.07278727,0.10939603,-0.21331197,0.039386638,0.5097442,-0.19747566,0.14477688,-0.102933176,3.10924,0.58525693,-0.015134864,0.17567372,-0.44378197,-0.51622844,-0.25448117,0.011545498,-0.0051114857,-0.4329335,0.2728276,-0.18777569,0.46735132,-0.120750755,0.09368101,0.5409537,0.16127414,0.15186483,-0.037949223,-0.049319886,0.48874712,-0.41664493,0.1972357,-0.8039819,-0.4980482,-1.1090932,-0.1140679,-0.4692555,0.31140617,0.30588284,-0.38706183,0.40443435,-0.3222617,-0.3274514,0.34685296,0.5112766,0.45164478,-0.07856621,-0.59379625,0.013789222,-0.005048804,0.25768805,-1.7854584,0.8946826,0.018105973,0.46639746,0.26802218,0.63304675,-0.24897191,-0.22473134,0.08679441,-0.5710653,0.3852095,-0.39790243,-0.037580185,0.90648055,0.17779545,-0.26919132,0.21417597,-0.40359676,0.62234986,-0.008044029,-0.3376613,1.0695806,0.80410236,0.2777519,-0.665548,0.09185585,-0.34976608,0.36619803,-0.3904403,0.08856249,-0.4489012,0.24642773,0.3764618,-0.69378275,0.27156156,-0.5563296,0.13203594,0.25016356,-0.4141716,0.18955362,0.3556011,-0.92354333,-0.04386215,0.1105918,0.36792144,0.3978016,0.24743474,0.054467134,0.4030439,-0.4683387,2.0453002,-0.5983105,0.034857497,-0.42503455,0.45044345,0.37625027,0.91577995,-0.23688377,0.0037868805,-0.68589795,-0.35146704,-0.37584063,0.34249076,0.3233421,-0.23860994,1.0435004,0.20554224,0.129908,0.33367845,-0.11670259,-0.4814742,0.14461035,0.49635565,0.48693123,0.2086311,-0.2636636,-0.019520339,-0.056619845,0.65660024,0.5634018,-0.1725466,-0.8600935,-0.2879475,-0.28202462,-0.33920926,-0.06789329,-0.1621771,-0.34848168,-0.08077791,0.5067481,0.47950754,0.5087319,0.03910983,0.42305383,-0.17164111,-0.06598685,0.42642802,0.3116503,-0.41102302,0.07161434,-0.2464656,0.3914621,-0.26129276,0.4254254,-0.3101646,-0.40934485,-0.3650949,-0.3202941,1.3852189,0.20972371,0.7021979,0.2767242,0.16968952,-0.51480395,0.3989107,-1.2689868,0.19264436,-0.4485665,0.47357076,0.7382048,-0.15082362,0.4833641,0.5796154,-0.7889788,-0.16831331,0.016835056,-0.44144198,0.14251265,0.16762117,-0.85837966,1.1228708,0.21418025,-0.2770078,-0.086159386,-0.22683124,-0.06618537,-0.4066967,0.01390072,-0.8132445,-0.38420764,0.009362377,0.1916669,0.13106774,-0.07391176,-0.31749398,-0.39065439,-0.39206603,0.13944228,-0.63271356,0.064031936,-0.79151016,0.42041945,0.21853623,2.4865456,0.69764054,-0.2166415,0.69859904,0.006874182,0.121454164,0.19883648,-0.16735289,-0.33733675,-0.27385867,-1.0052731,-0.13770853,0.87614685,-0.5206296,-0.54212636,0.66159385,-0.72372234,0.4629079,0.47010052,-0.15585984,1.859511,0.3874945,0.22715199,0.46440306,-0.052228488,-2.048976,-0.9042867,-0.37610203,0.18713294,-0.14488152,-0.05109724,0.7053386,0.56669897,0.37355295,-0.20947593,0.9365336,0.8309683,0.09310265,0.02033915,0.12206962,0.5680406,0.5421748,0.27987465,0.3241895,-0.84468126,-0.43607473,0.7327666,1.8568959,-0.2641552,0.044406634,0.63779926,-0.17063302,-1.0803813,-1.4622319,0.12056316,-0.008701526,-0.08606822,0.7736508,0.13716528,-0.38232762,0.43034706,1.092376,-0.66143227,-0.030285656,-0.75259656,1.431676,0.15672421,0.42046794,-0.61392117,0.21361105,0.25262007,-0.117219165,0.8360089,-0.65492386,-0.082396135,0.36652648,0.23206024,-0.1535363,0.39893135,0.44125646,0.36569896,0.44435465,-0.5700334,0.20595858,0.14943652,-0.18170878,0.14223394,-0.33893773,-0.7665984,-0.0007346943],"result":{"type":"object","properties":{"result":{"description":"Message describing what happened","type":"string"}},"required":["result"]},"sql_tables":null,"sql_queries":null,"file_inbox":null,"oauth":null,"assets":null,"runner":"any","operating_system":["linux","macos","windows"],"tool_set":""},false]}